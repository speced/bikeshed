<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>CSS Layout API Level 1</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="DREAM" name="w3c-status">
  <link href="../default.css" rel="stylesheet" type="text/css">
  <link href="../csslogo.ico" rel="shortcut icon" type="image/x-icon">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-DREAM" rel="stylesheet" type="text/css">
  <link href="https://drafts.css-houdini.org/css-layout-api-1/" rel="canonical">
<style>
/* Put nice boxes around each algorithm. */
[data-algorithm]:not(.heading) {
    padding: .5em;
    border: thin solid #ddd; border-radius: .5em;
    margin: .5em calc(-0.5em - 1px);
}
[data-algorithm]:not(.heading) > :first-child {
    margin-top: 0;
}
[data-algorithm]:not(.heading) > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">CSS Layout API Level 1</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">A Collection of Interesting Ideas, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://drafts.css-houdini.org/css-layout-api-1/">https://drafts.css-houdini.org/css-layout-api-1/</a>
     <dt>Feedback:
     <dd><span><a href="mailto:public-houdini@w3.org?subject=%5Bcss-layout-api%5D%20YOUR%20TOPIC%20HERE">public-houdini@w3.org</a> with subject line “<kbd>[css-layout-api] <i data-lt="">… message topic …</i></kbd>” (<a href="http://lists.w3.org/Archives/Public/public-houdini/" rel="discussion">archives</a>)</span>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard" data-editor-id="69511"><a class="p-name fn u-email email" href="mailto:gwhit@microsoft.com">Greg Whitworth</a>
     <dd class="editor p-author h-card vcard" data-editor-id="73001"><a class="p-name fn u-email email" href="mailto:ikilpatrick@chromium.org">Ian Kilpatrick</a>
     <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url" href="http://xanthir.com/contact/">Tab Atkins-Bittner</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard" data-editor-id="47691"><a class="p-name fn u-email email" href="mailto:shanestephens@google.com">Shane Stephens</a>
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:robert@ocallahan.org">Robert O'Callahan</a>
     <dd class="editor p-author h-card vcard" data-editor-id="49885"><a class="p-name fn u-email email" href="mailto:rossen.atanassov@microsoft.com">Rossen Atanassov</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#layout-api-containers"><span class="secno">2</span> <span class="content">Layout API Containers</span></a>
     <ol class="toc">
      <li><a href="#painting"><span class="secno">2.1</span> <span class="content">Layout API Container Painting</span></a>
      <li><a href="#layout-api-box-tree"><span class="secno">2.2</span> <span class="content">Box Tree Transformations</span></a>
     </ol>
    <li>
     <a href="#layout-api-model-and-terminology"><span class="secno">3</span> <span class="content">Layout API Model and Terminology</span></a>
     <ol class="toc">
      <li><a href="#layout-children"><span class="secno">3.1</span> <span class="content">Layout Children</span></a>
      <li><a href="#layout-fragments"><span class="secno">3.2</span> <span class="content">Layout Fragments</span></a>
      <li><a href="#layout-constraints"><span class="secno">3.3</span> <span class="content">Layout Constraints</span></a>
      <li><a href="#breaking-and-fragmentation"><span class="secno">3.4</span> <span class="content">Breaking and Fragmentation</span></a>
      <li><a href="#edges"><span class="secno">3.5</span> <span class="content">Edges</span></a>
     </ol>
    <li>
     <a href="#interactions-with-other-modules"><span class="secno">4</span> <span class="content">Interactions with other Modules</span></a>
     <ol class="toc">
      <li>
       <a href="#interaction-sizing"><span class="secno">4.1</span> <span class="content">Sizing</span></a>
       <ol class="toc">
        <li><a href="#interaction-sizing-positiong-layout"><span class="secno">4.1.1</span> <span class="content">Positioned layout sizing</span></a>
       </ol>
      <li><a href="#interaction-positioning"><span class="secno">4.2</span> <span class="content">Positioning</span></a>
      <li><a href="#interaction-overflow"><span class="secno">4.3</span> <span class="content">Overflow</span></a>
      <li><a href="#interaction-fragmentation"><span class="secno">4.4</span> <span class="content">Fragmentation</span></a>
      <li><a href="#interaction-alignment"><span class="secno">4.5</span> <span class="content">Alignment</span></a>
     </ol>
    <li>
     <a href="#layout"><span class="secno">5</span> <span class="content">Layout</span></a>
     <ol class="toc">
      <li><a href="#layout-invalidation"><span class="secno">5.1</span> <span class="content">Layout Invalidation</span></a>
      <li><a href="#concepts"><span class="secno">5.2</span> <span class="content">Concepts</span></a>
      <li><a href="#layout-worklet"><span class="secno">5.3</span> <span class="content">Layout Worklet</span></a>
      <li><a href="#registering-layout"><span class="secno">5.4</span> <span class="content">Registering A Layout</span></a>
      <li><a href="#layout-engine"><span class="secno">5.5</span> <span class="content">Layout Engine</span></a>
      <li>
       <a href="#performing-layout"><span class="secno">5.6</span> <span class="content">Performing Layout</span></a>
       <ol class="toc">
        <li><a href="#determining-intrinsic-sizes"><span class="secno">5.6.1</span> <span class="content">Determining Intrinsic Sizes</span></a>
        <li><a href="#generating-fragments"><span class="secno">5.6.2</span> <span class="content">Generating Fragments</span></a>
        <li><a href="#utility-algorithms"><span class="secno">5.6.3</span> <span class="content">Utility Algorithms</span></a>
       </ol>
     </ol>
    <li>
     <a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
     <ol class="toc">
      <li><a href="#conventions"><span class="secno"></span> <span class="content"> Document conventions</span></a>
      <li><a href="#conformance-classes"><span class="secno"></span> <span class="content"> Conformance classes</span></a>
      <li>
       <a href="#partial"><span class="secno"></span> <span class="content"> Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#conform-future-proofing"><span class="secno"></span> <span class="content"> Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#testing"><span class="secno"></span> <span class="content"> Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>The layout stage of CSS is responsible for generating and positioning <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment">fragments</a> from the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box-tree" id="ref-for-css-box-tree">box tree</a>.</p>
   <p>This specification describes an API which allows developers to layout a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box">box</a> in response to
computed style and <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box-tree" id="ref-for-css-box-tree①">box tree</a> changes.</p>
   <h2 class="heading settled" data-level="2" id="layout-api-containers"><span class="secno">2. </span><span class="content">Layout API Containers</span><a class="self-link" href="#layout-api-containers"></a></h2>
   <p>A new <a href="https://www.w3.org/TR/css-values-3/#comb-one">alternative</a> value is added
to the <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-inside" id="ref-for-typedef-display-inside" title="Expands to: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a> production: <code>layout(<a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-ident" id="ref-for-typedef-ident">&lt;ident></a>)</code>.</p>
   <dl>
    <dt><dfn class="dfn-paneled css" data-dfn-for="display" data-dfn-type="value" data-export="" id="valdef-display-layout">layout()</dfn> 
    <dd> This value causes an element to generate a <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container">layout API container</a> box. 
   </dl>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-api-container">layout API container</dfn> is the box generated by an element with a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-inside" id="ref-for-typedef-display-inside①" title="Expands to: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value">computed value</a> <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout">layout()</a>.</p>
   <p>A <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①">layout API container</a> establishes a new <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-api-formatting-context">layout API formatting context</dfn> for its
contents. This is the same as establishing a block formatting context, except that the layout
provided by the author is used instead of the block layout.
For example, floats do not intrude into the layout API container, and the layout API container’s
margins do not collapse with the margins of its contents.</p>
   <p>All inflow children of a <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container②">layout API container</a> are called <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-api-children">layout API children</dfn> and
are laid out using the auther defined layout.</p>
   <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container③">Layout API containers</a> form a containing block for their contents <a href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">exactly like block
containers do</a>. <a data-link-type="biblio" href="#biblio-css21">[CSS21]</a></p>
   <p class="note" role="note"><span>Note:</span> In a future level of the specification there may be a way to override the containing block
    behaviour.</p>
   <p>The <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow" id="ref-for-propdef-overflow">overflow</a> property applies to <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container④">layout API containers</a>. This is discussed in <a href="#interaction-overflow">§4.3 Overflow</a>.</p>
   <p>As the layout is entirely up to the author, properties which are used in other layout modes (e.g.
flex, block) may not apply. For example an author may not repect the <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/box.html#propdef-margin" id="ref-for-propdef-margin">margin</a> property on children.</p>
   <h3 class="heading settled" data-level="2.1" id="painting"><span class="secno">2.1. </span><span class="content">Layout API Container Painting</span><a class="self-link" href="#painting"></a></h3>
   <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑤">Layout API Container</a> children paint exactly the same as inline blocks <a data-link-type="biblio" href="#biblio-css21">[CSS21]</a>, except that
the order in which they are returned from the layout method (via <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments">childFragments</a></code>) is used in place of raw document order, and <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-position-3/#propdef-z-index" id="ref-for-propdef-z-index">z-index</a> values other than <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-position-3/#valdef-z-index-auto" id="ref-for-valdef-z-index-auto">auto</a> create a stacking context even if <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-position-3/#propdef-position" id="ref-for-propdef-position">position</a> is <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-position-3/#valdef-position-static" id="ref-for-valdef-position-static">static</a>.</p>
   <h3 class="heading settled" data-level="2.2" id="layout-api-box-tree"><span class="secno">2.2. </span><span class="content">Box Tree Transformations</span><a class="self-link" href="#layout-api-box-tree"></a></h3>
   <p>The <a data-link-type="dfn" href="#layout-api-children" id="ref-for-layout-api-children">layout API children</a> can act in different ways depending on the value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay">childDisplay</a></code> (set by <code>layoutOptions</code> on the class).</p>
   <p>If the value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options①">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay①">childDisplay</a></code> is <code>"block"</code> the <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-3/#propdef-display" id="ref-for-propdef-display">display</a> value of that child is <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#blockify" id="ref-for-blockify">blockified</a>. This is similar to children of <a data-link-type="dfn" href="https://drafts.csswg.org/css-flexbox-1/#flex-container" id="ref-for-flex-container">flex containers</a> or <a data-link-type="dfn" href="https://drafts.csswg.org/css-grid-1/#grid-container" id="ref-for-grid-container">grid containers</a>.
See <a data-link-type="biblio" href="#biblio-css3-display">[css3-display]</a>.</p>
   <p>If the value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options②">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay②">childDisplay</a></code> is <code>"normal"</code>, no <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#blockify" id="ref-for-blockify①">blockification</a> occurs. Instead
children with a <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-outside" id="ref-for-typedef-display-outside" title="Expands to: inline | run-in | block">&lt;display-outside></a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value①">computed value</a> of <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-3/#valdef-display-inline" id="ref-for-valdef-display-inline">inline</a> (a <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box">root inline box</a>)
will produce a single <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment">LayoutFragment</a></code> representing each line when <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment">layoutNextFragment()</a></code> is called.</p>
   <p class="note" role="note"><span>Note:</span> This allows authors to adjust the available inline size of each line, and position each line
    separately.</p>
   <p>Children of a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild">LayoutChild</a></code> which represents <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box①">root inline box</a> also have some additional
transformations.</p>
   <ul>
    <li data-md="">
     <p>A <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-level" id="ref-for-block-level">block-level</a> box inside a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-level" id="ref-for-inline-level">inline-level</a> box is <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inlinify" id="ref-for-inlinify">inlinified</a> I.e. its <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-outside" id="ref-for-typedef-display-outside①" title="Expands to: inline | run-in | block">&lt;display-outside></a> is set to <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-3/#valdef-display-inline" id="ref-for-valdef-display-inline①">inline</a>.</p>
    <li data-md="">
     <p>A <a data-link-type="dfn" href="https://drafts.csswg.org/css-page-floats-3/#float" id="ref-for-float">float</a> inside a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-level" id="ref-for-inline-level①">inline-level</a> box is not taken out of flow. Instead it must be
 treated as inflow, and be <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inlinify" id="ref-for-inlinify①">inlinified</a>.</p>
   </ul>
   <p>In both of the above cases the children become <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#atomic-inline" id="ref-for-atomic-inline">atomic inlines</a>.</p>
   <p class="note" role="note"><span>Note:</span> User agents would not perform any "inline splitting" or fragmenting when they encounter a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-level" id="ref-for-block-level①">block-level</a> box.</p>
   <div class="note" role="note">
     Note: In the example below "inline-span" would be represented as a single <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①">LayoutChild</a></code> with
    both "block" and "float" being <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#atomic-inline" id="ref-for-atomic-inline①">atomic inlines</a>. 
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">"inline-span"</span><span class="p">></span>
  Text
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"block"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"float"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  Text
<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span>
</pre>
   </div>
   <h2 class="heading settled" data-level="3" id="layout-api-model-and-terminology"><span class="secno">3. </span><span class="content">Layout API Model and Terminology</span><a class="self-link" href="#layout-api-model-and-terminology"></a></h2>
   <p>This section gives an overview of the Layout API given to authors.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="current-layout">current layout</dfn> is the layout algorithm for the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①">box</a> we are currently performing
layout for.</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="parent-layout">parent layout</dfn> is the layout algorithm for the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box②">box’s</a> direct parent, (the layout
algorithm which is requesting the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout">current layout</a> to be performed).</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="child-layout">child layout</dfn> is the layout algorithm for a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②">LayoutChild</a></code> of the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①">current layout</a>.</p>
   <h3 class="heading settled" data-level="3.1" id="layout-children"><span class="secno">3.1. </span><span class="content">Layout Children</span><a class="self-link" href="#layout-children"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutchild"><code>LayoutChild</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly">StylePropertyMapReadOnly</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="attribute" data-export="" data-readonly="" data-type="StylePropertyMapReadOnly" id="dom-layoutchild-stylemap"><code>styleMap</code></dfn>;

    <a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest">IntrinsicSizesRequest</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="method" data-export="" data-lt="intrinsicSizes()" id="dom-layoutchild-intrinsicsizes"><code>intrinsicSizes</code></dfn>();
    <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest">LayoutFragmentRequest</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutChild" data-dfn-type="method" data-export="" data-lt="layoutNextFragment(constraints, breakToken)" id="dom-layoutchild-layoutnextfragment"><code>layoutNextFragment</code></dfn>(<a class="n" data-link-type="idl-name" href="#layoutconstraints" id="ref-for-layoutconstraints">LayoutConstraints</a> <dfn class="nv idl-code" data-dfn-for="LayoutChild/layoutNextFragment(constraints, breakToken)" data-dfn-type="argument" data-export="" id="dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"><code>constraints</code><a class="self-link" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"></a></dfn>, <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken">ChildBreakToken</a> <dfn class="nv idl-code" data-dfn-for="LayoutChild/layoutNextFragment(constraints, breakToken)" data-dfn-type="argument" data-export="" id="dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"><code>breakToken</code><a class="self-link" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"></a></dfn>);
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③">LayoutChild</a></code> represents either a CSS generated <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box③">box</a> before layout has occured. (The box
or boxes will all have a computed value of <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-3/#propdef-display" id="ref-for-propdef-display①">display</a> that is not <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-3/#valdef-display-none" id="ref-for-valdef-display-none">none</a>).</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild④">LayoutChild</a></code> does not contain any layout information itself (like inline or block size) but
can be used to generate <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①">LayoutFragment</a></code>s which do contain layout information.</p>
   <p>An author cannot construct a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑤">LayoutChild</a></code> with this API, this happens at a separate stage of the
rendering engine (post style resolution).</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑥">LayoutChild</a></code> has computed style which can be accessed by <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap">styleMap</a></code>. The <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap①">styleMap</a></code> will only contain properties which are listed in the child input properties
array.</p>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑦">LayoutChild</a></code> could be generated by:</p>
   <ul>
    <li data-md="">
     <p>An <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-element" id="ref-for-concept-element">element</a>.</p>
    <li data-md="">
     <p>A <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box②">root inline box</a>.</p>
    <li data-md="">
     <p>A <a class="css" data-link-type="selector" href="https://drafts.csswg.org/css-pseudo-4/#selectordef-before" id="ref-for-selectordef-before">::before</a> or <a class="css" data-link-type="selector" href="https://drafts.csswg.org/css-pseudo-4/#selectordef-after" id="ref-for-selectordef-after">::after</a> pseudo-element.</p>
     <p class="note" role="note"><span>Note:</span> Other pseudo-elements such as <a class="css" data-link-type="selector" href="https://drafts.csswg.org/css-pseudo-4/#selectordef-first-letter" id="ref-for-selectordef-first-letter">::first-letter</a> or <a class="css" data-link-type="selector" href="https://drafts.csswg.org/css-pseudo-4/#selectordef-first-line" id="ref-for-selectordef-first-line">::first-line</a> do not generate
    a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑧">LayoutChild</a></code> for layout purposes. They are additional styling information for a text
    node.</p>
    <li data-md="">
     <p>An <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-anonymous" id="ref-for-css-anonymous">anonymous box</a>. For example an anonymous box may be inserted as a result of:</p>
     <ul>
      <li data-md="">
       <p>A text node which has undergone <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#blockify" id="ref-for-blockify②">blockification</a>. (Or more generally a <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box③">root inline
box</a> which has undergone <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#blockify" id="ref-for-blockify③">blockification</a>).</p>
      <li data-md="">
       <p>An element with <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-3/#propdef-display" id="ref-for-propdef-display②">display: table-cell</a> which doesn’t have a parent with <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-3/#propdef-display" id="ref-for-propdef-display③">display: table</a>.</p>
     </ul>
   </ul>
   <div class="note" role="note">
     Note: As an example the following would be placed into three <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild⑨">LayoutChild</a></code>ren: 
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">box</span><span class="p">::</span><span class="nd">before</span> <span class="p">{</span> <span class="k">content</span><span class="p">:</span> <span class="s1">'hello!'</span><span class="p">;</span> <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"box"</span><span class="p">></span>A block level box with text.<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">"..."</span> <span class="p">/></span>
</pre>
   </div>
   <div class="note" role="note">
     Note: As an example the following would be placed into a single <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⓪">LayoutChild</a></code> as they share a <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box④">root inline box</a>: 
<pre class="lang-html highlight">This is a next node, <span class="p">&lt;</span><span class="nt">span</span><span class="p">></span>with some additional styling,
that may<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span> break over<span class="p">&lt;</span><span class="nt">br</span><span class="p">></span>multiple lines.
</pre>
   </div>
   <p>Multiple non-<a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#atomic-inline" id="ref-for-atomic-inline②">atomic inlines</a> are placed within the same <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①①">LayoutChild</a></code> to allow rendering
engines to perform text shaping across element boundaries.</p>
   <div class="note" role="note">
     Note: As an example the following should produce one <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②">LayoutFragment</a></code> but is from
    three non-<a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#atomic-inline" id="ref-for-atomic-inline③">atomic inlines</a>: 
<pre class="lang-html highlight">ع<span class="p">&lt;</span><span class="nt">span</span> <span class="na">style</span><span class="o">=</span><span class="s">"color: blue"</span><span class="p">></span>ع<span class="p">&lt;/</span><span class="nt">span</span><span class="p">></span>ع
</pre>
   </div>
   <p class="note" role="note"><span>Note:</span> In a future level of the specification there may be a way to query the computed style
      of <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-box" id="ref-for-inline-box">inline boxes</a> inside a <a data-link-type="dfn" href="https://drafts.csswg.org/css-inline-3/#root-inline-box" id="ref-for-root-inline-box⑤">root inline box</a> represented by a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①②">LayoutChild</a></code>.</p>
   <p>An array of <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①③">LayoutChild</a></code>ren is passed into the layout method which represents the children of the
current box which is being laid out.</p>
   <p>To perform layout on a box the author can invoke the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment①">layoutNextFragment()</a></code> method.
This will produce a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment③">LayoutFragment</a></code> which contains layout information.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment②">layoutNextFragment()</a></code> method may be invoked multiple times with different
arguments to query the <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①④">LayoutChild</a></code> for different layout information.</p>
   <h3 class="heading settled" data-level="3.2" id="layout-fragments"><span class="secno">3.2. </span><span class="content">Layout Fragments</span><a class="self-link" href="#layout-fragments"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutfragment"><code>LayoutFragment</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutfragment-inlinesize"><code>inlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutfragment-blocksize"><code>blockSize</code></dfn>;

    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-type="double" id="dom-layoutfragment-inlineoffset"><code>inlineOffset</code></dfn>;
    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-type="double" id="dom-layoutfragment-blockoffset"><code>blockOffset</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-layoutfragment-data"><code>data</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken①">ChildBreakToken</a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutFragment" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ChildBreakToken?" id="dom-layoutfragment-breaktoken"><code>breakToken</code></dfn>;
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment④">LayoutFragment</a></code> represents a CSS <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment①">fragment</a> of a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑤">LayoutChild</a></code> after layout has occurred
on that child. This is produced by the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment③">layoutNextFragment()</a></code> method.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑤">LayoutFragment</a></code> has <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize">inlineSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize">blockSize</a></code> attributes, which are set by the respective child’s layout algorithm. They cannot be changed. If the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout②">current layout</a> requires a different <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize①">inlineSize</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize①">blockSize</a></code> the author must perform <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment④">layoutNextFragment()</a></code> again with
different arguments in order to get different results.</p>
   <p>The author inside the current layout can position a resulting <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑥">LayoutFragment</a></code> by setting its <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset">inlineOffset</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset">blockOffset</a></code> attributes. If not set by the
author they default to zero. The <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset①">inlineOffset</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset①">blockOffset</a></code> attributes represent the position of the <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑦">LayoutFragment</a></code> relative to its parent’s border box,
before transform or positioning (e.g. if a fragment is <a data-link-type="dfn" href="https://drafts.csswg.org/css-position-3/#relative-position" id="ref-for-relative-position">relatively positioned</a>) has been
applied.</p>
   <div class="example" id="example-e0032c74">
    <a class="self-link" href="#example-e0032c74"></a> The layout algorithm performs a block-like layout (positioning fragments sequentially in the block
direction), while centering its children in the inline direction. 
<pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'block-like'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> childrenSizes <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> child<span class="p">.</span>intrinsicSizes<span class="p">();</span>
      <span class="p">});</span>

      <span class="kr">const</span> maxContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> Math<span class="p">.</span>max<span class="p">(</span>max<span class="p">,</span> childSizes<span class="p">.</span>maxContentContribution<span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="kr">const</span> minContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> Math<span class="p">.</span>max<span class="p">(</span>max<span class="p">,</span> childSizes<span class="p">.</span>minContentContribution<span class="p">);</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="k">return</span> <span class="p">{</span>maxContentSize<span class="p">,</span> minContentSize<span class="p">};</span>
    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> availableInlineSize <span class="o">=</span> constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span> <span class="p">(</span>constraints<span class="p">.</span>fixedBlockSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span> availableInlineSize<span class="p">,</span> availableBlockSize <span class="p">};</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">);</span>
        <span class="p">});</span>

        <span class="kd">let</span> blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> fragment <span class="k">of</span> childFragments<span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Position the fragment in a block like manner, centering it in the</span>
<span class="c1"></span>            <span class="c1">// inline direction.</span>
<span class="c1"></span>            fragment<span class="p">.</span>blockOffset <span class="o">=</span> blockOffset<span class="p">;</span>
            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span>
                edges<span class="p">.</span>all<span class="p">.</span>inlineStart<span class="p">,</span>
                <span class="p">(</span>availableInlineSize <span class="o">-</span> fragment<span class="p">.</span>inlineSize<span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>

            blockOffset <span class="o">+=</span> fragment<span class="p">.</span>blockSize<span class="p">;</span>
        <span class="p">}</span>

        <span class="kr">const</span> autoBlockSize <span class="o">=</span> blockOffset <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>blockEnd<span class="p">;</span>

        <span class="k">return</span> <span class="p">{</span>
            autoBlockSize<span class="p">,</span>
            childFragments<span class="p">,</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
   </div>
   <p>A <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑥">layout API container</a> can communicate with other <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑦">layout API containers</a> by using the <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-data" id="ref-for-dom-layoutfragment-data">data</a></code> attribute. This is set by the <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-data" id="ref-for-dom-fragmentresultoptions-data">data</a></code> member in the <code class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions">FragmentResultOptions</a></code> dictionary.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑧">LayoutFragment</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken">breakToken</a></code> specifies where the <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑥">LayoutChild</a></code> last
fragmented. If the <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken①">breakToken</a></code> is null the <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑦">LayoutChild</a></code> wont produce any more <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment⑨">LayoutFragment</a></code>s for that token chain. The <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken②">breakToken</a></code> can be passed to the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑤">layoutNextFragment()</a></code> function to produce the next <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⓪">LayoutFragment</a></code> for a
particular child. The <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken③">breakToken</a></code> cannot be changed.
If the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout③">current layout</a> requires a different <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken④">breakToken</a></code> the author must perform <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑥">layoutNextFragment()</a></code> again with different arguments.</p>
   <p class="note" role="note"><span>Note:</span> In a future level of the specification there may be a way to query for additional baseline
      information, for example where the alphabetic or center baseline is positioned.</p>
   <h3 class="heading settled" data-level="3.3" id="layout-constraints"><span class="secno">3.3. </span><span class="content">Layout Constraints</span><a class="self-link" href="#layout-constraints"></a></h3>
<pre class="idl highlight def">[<dfn class="nv idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="constructor" data-export="" data-lt="LayoutConstraints(options)|LayoutConstraints()" id="dom-layoutconstraints-layoutconstraints"><code>Constructor</code><a class="self-link" href="#dom-layoutconstraints-layoutconstraints"></a></dfn>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-layoutconstraintsoptions" id="ref-for-dictdef-layoutconstraintsoptions">LayoutConstraintsOptions</a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraints/LayoutConstraints(options)" data-dfn-type="argument" data-export="" id="dom-layoutconstraints-layoutconstraints-options-options"><code>options</code><a class="self-link" href="#dom-layoutconstraints-layoutconstraints-options-options"></a></dfn>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutconstraints"><code>LayoutConstraints</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double④"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-availableinlinesize"><code>availableInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑤"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-availableblocksize"><code>availableBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑥"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-fixedinlinesize"><code>fixedInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑦"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-fixedblocksize"><code>fixedBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑧"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-percentageinlinesize"><code>percentageInlineSize</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑨"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutconstraints-percentageblocksize"><code>percentageBlockSize</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⓪"><span class="kt">double</span></a>? <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double?" id="dom-layoutconstraints-blockfragmentationoffset"><code>blockFragmentationOffset</code></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype">BlockFragmentationType</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="BlockFragmentationType" id="dom-layoutconstraints-blockfragmentationtype"><code>blockFragmentationType</code></dfn>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="LayoutConstraints" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-layoutconstraints-data"><code>data</code><a class="self-link" href="#dom-layoutconstraints-data"></a></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-layoutconstraintsoptions"><code>LayoutConstraintsOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①"><span class="kt">double</span></a> <dfn class="nv idl-code" data-default="0" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-availableinlinesize"><code>availableInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-availableinlinesize"></a></dfn> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①②"><span class="kt">double</span></a> <dfn class="nv idl-code" data-default="0" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-availableblocksize"><code>availableBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-availableblocksize"></a></dfn> = 0;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①③"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-fixedinlinesize"><code>fixedInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-fixedinlinesize"></a></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①④"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-fixedblocksize"><code>fixedBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-fixedblocksize"></a></dfn>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑤"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-percentageinlinesize"><code>percentageInlineSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-percentageinlinesize"></a></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑥"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-percentageblocksize"><code>percentageBlockSize</code><a class="self-link" href="#dom-layoutconstraintsoptions-percentageblocksize"></a></dfn>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑦"><span class="kt">double</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-layoutconstraintsoptions-blockfragmentationoffset"><code>blockFragmentationOffset</code><a class="self-link" href="#dom-layoutconstraintsoptions-blockfragmentationoffset"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype①">BlockFragmentationType</a> <dfn class="nv idl-code" data-default="&quot;none&quot;" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="BlockFragmentationType " id="dom-layoutconstraintsoptions-blockfragmentationtype"><code>blockFragmentationType</code><a class="self-link" href="#dom-layoutconstraintsoptions-blockfragmentationtype"></a></dfn> = "none";

    <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="LayoutConstraintsOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-layoutconstraintsoptions-data"><code>data</code><a class="self-link" href="#dom-layoutconstraintsoptions-data"></a></dfn>;
};

<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-blockfragmentationtype"><code>BlockFragmentationType</code></dfn> { <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;none&quot;|none" id="dom-blockfragmentationtype-none"><code>"none"</code><a class="self-link" href="#dom-blockfragmentationtype-none"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;page&quot;|page" id="dom-blockfragmentationtype-page"><code>"page"</code><a class="self-link" href="#dom-blockfragmentationtype-page"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;column&quot;|column" id="dom-blockfragmentationtype-column"><code>"column"</code><a class="self-link" href="#dom-blockfragmentationtype-column"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BlockFragmentationType" data-dfn-type="enum-value" data-export="" data-lt="&quot;region&quot;|region" id="dom-blockfragmentationtype-region"><code>"region"</code><a class="self-link" href="#dom-blockfragmentationtype-region"></a></dfn> };
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints①">LayoutConstraints</a></code> object is passed into the layout method which represents the all the
constraints for the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout④">current layout</a> to perform layout inside. It is also used to pass
information about the available space into a <a data-link-type="dfn" href="#child-layout" id="ref-for-child-layout">child layout</a>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints②">LayoutConstraints</a></code> object has <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableinlinesize" id="ref-for-dom-layoutconstraints-availableinlinesize">availableInlineSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-availableblocksize" id="ref-for-dom-layoutconstraints-availableblocksize">availableBlockSize</a></code> attributes. This represents the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#available" id="ref-for-available">available space</a> for
a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①①">LayoutFragment</a></code> which the layout should respect.</p>
   <p class="note" role="note"><span>Note:</span> Some layouts may need to produce a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①②">LayoutFragment</a></code> which exceed this size. For example a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#replaced-element" id="ref-for-replaced-element">replaced element</a>. The <a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout">parent layout</a> should expect this to occur and deal with it
    appropriately.</p>
   <p>A <a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout①">parent layout</a> may require the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑤">current layout</a> to be exactly a particular size. If
the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize">fixedInlineSize</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize">fixedBlockSize</a></code> are specified the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑥">current layout</a> should produce a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①③">LayoutFragment</a></code> with a the specified size in the
appropriate direction.</p>
   <div class="example" id="example-dd852390">
    <a class="self-link" href="#example-dd852390"></a> The layout algorithm performs a flexbox-like distribution of spare space in the inline direction. It
creates child layout constraints which specify that a child should be a fixed inline size. 
<pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'flex-distribution-like'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
      <span class="kr">const</span> childrenSizes <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> child<span class="p">.</span>intrinsicSizes<span class="p">();</span>
      <span class="p">});</span>

      <span class="kr">const</span> maxContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>sum<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> sum <span class="o">+</span> childSizes<span class="p">.</span>maxContentContribution<span class="p">;</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="kr">const</span> minContentSize <span class="o">=</span> childrenSizes<span class="p">.</span>reduce<span class="p">((</span>max<span class="p">,</span> childSizes<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
          <span class="k">return</span> sum <span class="o">+</span> childSizes<span class="p">.</span>minContentContribution<span class="p">;</span>
      <span class="p">},</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>

      <span class="k">return</span> <span class="p">{</span>maxContentSize<span class="p">,</span> minContentSize<span class="p">};</span>
    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>

        <span class="kr">const</span> availableInlineSize <span class="o">=</span>
            constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span>
            <span class="p">(</span>constraints<span class="p">.</span>fixedInlineSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span> availableInlineSize<span class="p">,</span> availableBlockSize <span class="p">};</span>

        <span class="kr">const</span> unconstrainedChildFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">);</span>
        <span class="p">});</span>

        <span class="kr">const</span> unconstrainedSizes <span class="o">=</span> <span class="p">[];</span>
        <span class="kr">const</span> totalSize <span class="o">=</span> unconstrainedChildFragments<span class="p">.</span>reduce<span class="p">((</span>sum<span class="p">,</span> fragment<span class="p">,</span> i<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            unconstrainedSizes<span class="p">[</span>i<span class="p">]</span> <span class="o">=</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
            <span class="k">return</span> sum <span class="o">+</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
        <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>

        <span class="c1">// Distribute spare space between children.</span>
<span class="c1"></span>        <span class="kr">const</span> remainingSpace <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span><span class="mi">0</span><span class="p">,</span> inlineSize <span class="o">-</span> totalSize<span class="p">);</span>
        <span class="kr">const</span> extraSpace <span class="o">=</span> remainingSpace <span class="o">/</span> children<span class="p">.</span>length<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="k">yield</span> children<span class="p">.</span>map<span class="p">((</span>child<span class="p">,</span> i<span class="p">)</span> <span class="p">=></span> <span class="p">{</span>
            <span class="k">return</span> child<span class="p">.</span>layoutNextFragment<span class="p">({</span>
                fixedInlineSize<span class="o">:</span> unconstrainedSizes<span class="p">[</span>i<span class="p">]</span> <span class="o">+</span> extraSpace<span class="p">,</span>
                availableBlockSize
            <span class="p">});</span>
        <span class="p">});</span>

        <span class="c1">// Position the fragments.</span>
<span class="c1"></span>        <span class="kd">let</span> inlineOffset <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="kd">let</span> maxChildBlockSize <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> fragment <span class="k">of</span> childFragments<span class="p">)</span> <span class="p">{</span>
            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> inlineOffset<span class="p">;</span>
            fragment<span class="p">.</span>blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>

            inlineOffset <span class="o">+=</span> fragment<span class="p">.</span>inlineSize<span class="p">;</span>
            maxChildBlockSize <span class="o">=</span> Math<span class="p">.</span>max<span class="p">(</span>maxChildBlockSize<span class="p">,</span> fragment<span class="p">.</span>blockSize<span class="p">);</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="p">{</span>
            autoBlockSize<span class="o">:</span> maxChildBlockSize <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">,</span>
            childFragments<span class="p">,</span>
        <span class="p">};</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints③">LayoutConstraints</a></code> object has <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageinlinesize" id="ref-for-dom-layoutconstraints-percentageinlinesize">percentageInlineSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-percentageblocksize" id="ref-for-dom-layoutconstraints-percentageblocksize">percentageBlockSize</a></code> attributes. These represent the size that a layout
percentages should be resolved against while performing layout.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints④">LayoutConstraints</a></code> has a <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype">blockFragmentationType</a></code> attribute. The <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑦">current layout</a> should produce a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①④">LayoutFragment</a></code> which fragments at the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset">blockFragmentationOffset</a></code> if possible.</p>
   <p>The <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑧">current layout</a> can choose not to fragment a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild①⑧">LayoutChild</a></code> based on the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype①">blockFragmentationType</a></code>, for example if the child has a property like <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-break-3/#propdef-break-inside" id="ref-for-propdef-break-inside">break-inside: avoid-page;</a>.</p>
   <h3 class="heading settled" data-level="3.4" id="breaking-and-fragmentation"><span class="secno">3.4. </span><span class="content">Breaking and Fragmentation</span><a class="self-link" href="#breaking-and-fragmentation"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="childbreaktoken"><code>ChildBreakToken</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-breaktype" id="ref-for-enumdef-breaktype">BreakType</a> <dfn class="nv idl-code" data-dfn-for="ChildBreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="BreakType" id="dom-childbreaktoken-breaktype"><code>breakType</code><a class="self-link" href="#dom-childbreaktoken-breaktype"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutchild" id="ref-for-layoutchild①⑨">LayoutChild</a> <dfn class="nv idl-code" data-dfn-for="ChildBreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutChild" id="dom-childbreaktoken-child"><code>child</code><a class="self-link" href="#dom-childbreaktoken-child"></a></dfn>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="breaktoken"><code>BreakToken</code></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken②">ChildBreakToken</a>> <dfn class="nv idl-code" data-dfn-for="BreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="sequence<ChildBreakToken>" id="dom-breaktoken-childbreaktokens"><code>childBreakTokens</code><a class="self-link" href="#dom-breaktoken-childbreaktokens"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <dfn class="nv idl-code" data-dfn-for="BreakToken" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-breaktoken-data"><code>data</code><a class="self-link" href="#dom-breaktoken-data"></a></dfn>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-breaktokenoptions"><code>BreakTokenOptions</code></dfn> {
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken③">ChildBreakToken</a>> <dfn class="nv idl-code" data-dfn-for="BreakTokenOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<ChildBreakToken> " id="dom-breaktokenoptions-childbreaktokens"><code>childBreakTokens</code><a class="self-link" href="#dom-breaktokenoptions-childbreaktokens"></a></dfn>;
    <span class="kt">any</span> <dfn class="nv idl-code" data-default="null" data-dfn-for="BreakTokenOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-breaktokenoptions-data"><code>data</code><a class="self-link" href="#dom-breaktokenoptions-data"></a></dfn> = <span class="kt">null</span>;
};

<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-breaktype"><code>BreakType</code></dfn> { <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;none&quot;|none" id="dom-breaktype-none"><code>"none"</code><a class="self-link" href="#dom-breaktype-none"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;line&quot;|line" id="dom-breaktype-line"><code>"line"</code><a class="self-link" href="#dom-breaktype-line"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;column&quot;|column" id="dom-breaktype-column"><code>"column"</code><a class="self-link" href="#dom-breaktype-column"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;page&quot;|page" id="dom-breaktype-page"><code>"page"</code><a class="self-link" href="#dom-breaktype-page"></a></dfn>, <dfn class="s idl-code" data-dfn-for="BreakType" data-dfn-type="enum-value" data-export="" data-lt="&quot;region&quot;|region" id="dom-breaktype-region"><code>"region"</code><a class="self-link" href="#dom-breaktype-region"></a></dfn> };
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⓪">LayoutChild</a></code> can produce multiple <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑤">LayoutFragment</a></code>s. A <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②①">LayoutChild</a></code> may fragment in the
block direction if a <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype②">blockFragmentationType</a></code> is not none.  Additionally <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②②">LayoutChild</a></code> which represents <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-level" id="ref-for-inline-level②">inline-level</a> content, may fragment line by line if the <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options③">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-childdisplay" id="ref-for-dom-layoutoptions-childdisplay③">childDisplay</a></code> (set by <code>layoutOptions</code>) is <code>"normal"</code>.</p>
   <p>A subsequent <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑥">LayoutFragment</a></code> is produced by using the previous <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑦">LayoutFragment</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑤">breakToken</a></code>. This tells the <a data-link-type="dfn" href="#child-layout" id="ref-for-child-layout①">child layout</a> to produce a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑧">LayoutFragment</a></code> starting at the point encoded in the <code class="idl"><a data-link-type="idl" href="#childbreaktoken" id="ref-for-childbreaktoken④">ChildBreakToken</a></code>.</p>
   <p class="issue" id="issue-288b5e83"><a class="self-link" href="#issue-288b5e83"></a> Explain resuming the author defined layout.</p>
   <div class="example" id="example-735a547f">
    <a class="self-link" href="#example-735a547f"></a> This example shows a simple layout which indents child fragments for a certain number of
lines. 
    <p>This example also demonstrates using the previous <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑥">breakToken</a></code> of a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment①⑨">LayoutFragment</a></code> to produce the next fragment for the <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②③">LayoutChild</a></code>.</p>
    <p>It also demonstrates using the <code class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken">BreakToken</a></code> to respect the <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑤">LayoutConstraints</a></code>' <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype③">blockFragmentationType</a></code>, it resumes it layout from the previous <code class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken①">BreakToken</a></code>.
It returns a <code class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions①">FragmentResultOptions</a></code> with a <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-breaktoken" id="ref-for-dom-fragmentresultoptions-breaktoken">breakToken</a></code> which is used to
resume the layout.</p>
<pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'indent-lines'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="kr">static</span> layoutOptions <span class="o">=</span> <span class="p">{</span>childDisplay<span class="o">:</span> <span class="s1">'normal'</span><span class="p">};</span>
    <span class="kr">static</span> inputProperties <span class="o">=</span> <span class="p">[</span><span class="s1">'--indent'</span><span class="p">,</span> <span class="s1">'--indent-lines'</span><span class="p">];</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>

        <span class="c1">// Determine our (inner) available size.</span>
<span class="c1"></span>        <span class="kr">const</span> availableInlineSize <span class="o">=</span>
            constraints<span class="p">.</span>fixedInlineSize <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>inline<span class="p">;</span>
        <span class="kr">const</span> availableBlockSize <span class="o">=</span>
            <span class="p">(</span>constraints<span class="p">.</span>fixedBlockSize <span class="o">||</span> <span class="kc">Infinity</span><span class="p">)</span> <span class="o">-</span> edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span>

        <span class="c1">// Detrermine the number of lines to indent, and the indent amount.</span>
<span class="c1"></span>        <span class="kr">const</span> indent <span class="o">=</span> resolveLength<span class="p">(</span>constraints<span class="p">,</span> styleMap<span class="p">.</span>get<span class="p">(</span><span class="s1">'--indent'</span><span class="p">));</span>
        <span class="kd">let</span> lines <span class="o">=</span> styleMap<span class="p">.</span>get<span class="p">(</span><span class="s1">'--indent-lines'</span><span class="p">).</span>value<span class="p">;</span>

        <span class="kr">const</span> childFragments <span class="o">=</span> <span class="p">[];</span>

        <span class="kd">let</span> childBreakToken <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">(</span>breakToken<span class="p">)</span> <span class="p">{</span>
            childBreakToken <span class="o">=</span> breakToken<span class="p">.</span>childBreakTokens<span class="p">[</span><span class="mi">0</span><span class="p">];</span>

            <span class="c1">// Remove all the children we have already produced fragments for.</span>
<span class="c1"></span>            children<span class="p">.</span>splice<span class="p">(</span><span class="mi">0</span><span class="p">,</span> children<span class="p">.</span>indexOf<span class="p">(</span>childBreakToken<span class="p">.</span>child<span class="p">));</span>
        <span class="p">}</span>

        <span class="kd">let</span> blockOffset <span class="o">=</span> edges<span class="p">.</span>all<span class="p">.</span>blockStart<span class="p">;</span>
        <span class="kd">let</span> child <span class="o">=</span> children<span class="p">.</span>shift<span class="p">();</span>
        <span class="k">while</span> <span class="p">(</span>child<span class="p">)</span> <span class="p">{</span>
            <span class="kr">const</span> shouldIndent <span class="o">=</span> lines<span class="o">--</span> <span class="o">></span> <span class="mi">0</span><span class="p">;</span>

            <span class="c1">// Adjust the inline size for the indent.</span>
<span class="c1"></span>            <span class="kr">const</span> childAvailableInlineSize <span class="o">=</span> shouldIndent <span class="o">?</span>
                availableInlineSize <span class="o">-</span> indent <span class="o">:</span> availableInlineSize<span class="p">;</span>

            <span class="kr">const</span> childConstraints <span class="o">=</span> <span class="p">{</span>
                availableInlineSize<span class="o">:</span> childAvailableInlineSize<span class="p">,</span>
                availableBlockSize<span class="p">,</span>
                percentageInlineSize<span class="o">:</span> availableInlineSize<span class="p">,</span>
                blockFragmentationType<span class="o">:</span> constraints<span class="p">.</span>blockFragmentationType<span class="p">,</span>
            <span class="p">};</span>

            <span class="kr">const</span> fragment <span class="o">=</span> <span class="k">yield</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>childConstraints<span class="p">,</span>
                                                            childBreakToken<span class="p">);</span>
            childFragments<span class="p">.</span>push<span class="p">(</span>fragment<span class="p">);</span>

            <span class="c1">// Position the fragment.</span>
<span class="c1"></span>            fragment<span class="p">.</span>inlineOffset <span class="o">=</span> shouldIndent <span class="o">?</span>
                edges<span class="p">.</span>all<span class="p">.</span>inlineStart <span class="o">+</span> indent <span class="o">:</span> edges<span class="p">.</span>all<span class="p">.</span>inlineStart<span class="p">;</span>
            fragment<span class="p">.</span>blockOffset <span class="o">=</span> blockOffset<span class="p">;</span>
            blockOffset <span class="o">+=</span> fragment<span class="p">.</span>blockSize<span class="p">;</span>

            <span class="c1">// Check if we have gone over the block fragmentation limit.</span>
<span class="c1"></span>            <span class="k">if</span> <span class="p">(</span>constraints<span class="p">.</span>blockFragmentationType <span class="o">!=</span> <span class="s1">'none'</span> <span class="o">&amp;&amp;</span>
                blockOffset <span class="o">></span> constraints<span class="p">.</span>blockSize<span class="p">)</span> <span class="p">{</span>
                <span class="k">break</span><span class="p">;</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span>fragment<span class="p">.</span>breakToken<span class="p">)</span> <span class="p">{</span>
                childBreakToken <span class="o">=</span> fragment<span class="p">.</span>breakToken<span class="p">;</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                <span class="c1">// If a fragment doesn’t have a break token, we move onto the</span>
<span class="c1"></span>                <span class="c1">// next child.</span>
<span class="c1"></span>                child <span class="o">=</span> children<span class="p">.</span>shift<span class="p">();</span>
                childBreakToken <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="kr">const</span> autoBlockSize <span class="o">=</span> blockOffset <span class="o">+</span> edges<span class="p">.</span>all<span class="p">.</span>blockEnd<span class="p">;</span>

        <span class="c1">// Return our fragment.</span>
<span class="c1"></span>        <span class="kr">const</span> result <span class="o">=</span> <span class="p">{</span>
            autoBlockSize<span class="p">,</span>
            childFragments<span class="o">:</span> childFragments<span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span>childBreakToken<span class="p">)</span> <span class="p">{</span>
            result<span class="p">.</span>breakToken <span class="o">=</span> <span class="p">{</span>
                childBreakTokens<span class="o">:</span> <span class="p">[</span>childBreakToken<span class="p">],</span>
            <span class="p">};</span>
        <span class="p">}</span>

        <span class="k">return</span> result<span class="p">;</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre>
   </div>
   <h3 class="heading settled" data-level="3.5" id="edges"><span class="secno">3.5. </span><span class="content">Edges</span><a class="self-link" href="#edges"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutedgesizes"><code>LayoutEdgeSizes</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑧"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inlinestart"><code>inlineStart</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑨"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inlineend"><code>inlineEnd</code></dfn>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⓪"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-blockstart"><code>blockStart</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-blockend"><code>blockEnd</code></dfn>;

  // Convenience attributes for the sum in one direction.
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②②"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-inline"><code>inline</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②③"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdgeSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-layoutedgesizes-block"><code>block</code></dfn>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutedges"><code>LayoutEdges</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-border"><code>border</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes①">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-scrollbar"><code>scrollbar</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes②">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-padding"><code>padding</code></dfn>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes③">LayoutEdgeSizes</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="LayoutEdges" data-dfn-type="attribute" data-export="" data-readonly="" data-type="LayoutEdgeSizes" id="dom-layoutedges-all"><code>all</code></dfn>;
};
</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges">LayoutEdges</a></code> object is passed into the layout method. This represents the size of the <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/box.html#box-dimensions" id="ref-for-box-dimensions">box
model edges</a> for the current box which is being laid out.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges①">LayoutEdges</a></code> has <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-border" id="ref-for-dom-layoutedges-border">border</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-scrollbar" id="ref-for-dom-layoutedges-scrollbar">scrollbar</a></code>, and <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-padding" id="ref-for-dom-layoutedges-padding">padding</a></code> attributes. Each of these represent the width of their respective edge.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges②">LayoutEdges</a></code> has the <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-all" id="ref-for-dom-layoutedges-all">all</a></code> attribute. This is a convenience attribute which
represents the sum of the <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-border" id="ref-for-dom-layoutedges-border①">border</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-scrollbar" id="ref-for-dom-layoutedges-scrollbar①">scrollbar</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedges-padding" id="ref-for-dom-layoutedges-padding①">padding</a></code> edges.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes④">LayoutEdgeSizes</a></code> object represents the width in CSS pixels of an edge in each of the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#abstract-dimensions" id="ref-for-abstract-dimensions">abstract dimensions</a> (<code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inlinestart" id="ref-for-dom-layoutedgesizes-inlinestart">inlineStart</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inlineend" id="ref-for-dom-layoutedgesizes-inlineend">inlineEnd</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-blockstart" id="ref-for-dom-layoutedgesizes-blockstart">blockStart</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-blockend" id="ref-for-dom-layoutedgesizes-blockend">blockEnd</a></code>).</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-inline" id="ref-for-dom-layoutedgesizes-inline">inline</a></code>, and <code class="idl"><a data-link-type="idl" href="#dom-layoutedgesizes-block" id="ref-for-dom-layoutedgesizes-block">block</a></code> on the <code class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑤">LayoutEdgeSizes</a></code> object are
convenience attributes which represent the sum in that direction.</p>
   <div class="example" id="example-6da26aef">
    <a class="self-link" href="#example-6da26aef"></a> This example shows an node styled by CSS, and what its respective <code class="idl"><a data-link-type="idl" href="#layoutedges" id="ref-for-layoutedges③">LayoutEdges</a></code> could contain. 
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
<span class="p">.</span><span class="nc">container</span> <span class="p">{</span>
  <span class="k">width</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">height</span><span class="p">:</span> <span class="mi">50</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="p">.</span><span class="nc">box</span> <span class="p">{</span>
  <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">box</span><span class="o">-</span><span class="kc">edges</span><span class="p">);</span>

  <span class="k">padding</span><span class="p">:</span> <span class="mi">10</span><span class="kt">%</span><span class="p">;</span>
  <span class="k">border</span><span class="p">:</span> <span class="kc">solid</span> <span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">overflow-y</span><span class="p">:</span> <span class="kc">scroll</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>

<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"box"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
<pre class="lang-javascript highlight">registerLayout<span class="p">(</span><span class="s1">'box-edges'</span><span class="p">,</span> <span class="kr">class</span> <span class="p">{</span>
    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
        edges<span class="p">.</span>padding<span class="p">.</span>inlineStart<span class="p">;</span> <span class="c1">// 5 (as 10% * 50px = 5px).</span>
<span class="c1"></span>        edges<span class="p">.</span>border<span class="p">.</span>blockEnd<span class="p">;</span> <span class="c1">// 2</span>
<span class="c1"></span>        edges<span class="p">.</span>scrollbar<span class="p">.</span>inlineEnd<span class="p">;</span> <span class="c1">// UA-dependent, may be 0 or >0 (e.g. 16).</span>
<span class="c1"></span>        edges<span class="p">.</span>all<span class="p">.</span>block<span class="p">;</span> <span class="c1">// 14 (2 + 5 + 5 + 2).</span>
<span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</pre>
   </div>
   <h2 class="heading settled" data-level="4" id="interactions-with-other-modules"><span class="secno">4. </span><span class="content">Interactions with other Modules</span><a class="self-link" href="#interactions-with-other-modules"></a></h2>
   <p>This section describes how other CSS modules interact with the CSS Layout API.</p>
   <h3 class="heading settled" data-level="4.1" id="interaction-sizing"><span class="secno">4.1. </span><span class="content">Sizing</span><a class="self-link" href="#interaction-sizing"></a></h3>
   <p>User agents must use the <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑥">LayoutConstraints</a></code> object to communicate to the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout⑨">current layout</a> the size they would like the fragment to be.</p>
   <p>If the user agent wishes to force a size on the box, it can use the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize①">fixedInlineSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize①">fixedBlockSize</a></code> attributes to do so.</p>
   <p>The <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑧">layout API container</a> can be passed size information in different ways depending on the
value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options④">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing">sizing</a></code> (set by <code>layoutOptions</code> on the class).</p>
   <p>If the value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options⑤">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing①">sizing</a></code> is <code>"block-like"</code>, then the <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑦">LayoutConstraints</a></code> passed to the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container⑨">layout API container</a>:</p>
   <ul>
    <li data-md="">
     <p><em>Must</em> calculate and set <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize②">fixedInlineSize</a></code> based off the rules
specified in <a data-link-type="biblio" href="#biblio-css-sizing-3">[css-sizing-3]</a> and the formatting context in which it participates, e.g.</p>
     <ul>
      <li data-md="">
       <p>As a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-level" id="ref-for-block-level②">block-level</a> box in a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-formatting-context" id="ref-for-block-formatting-context">block formatting context</a>, it is sized like a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-box" id="ref-for-block-box">block box</a> that establishes a formatting context, with an <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-sizing-3/#valdef-width-auto" id="ref-for-valdef-width-auto">auto</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-size" id="ref-for-inline-size">inline
size</a> calculated as for non-replaced block boxes.</p>
      <li data-md="">
       <p>As an <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-level" id="ref-for-inline-level③">inline-level</a> box in an <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#inline-formatting-context" id="ref-for-inline-formatting-context">inline formatting context</a>, it is sized as an
atomic inline-level box (such as an inline-block).</p>
     </ul>
    <li data-md="">
     <p><em>Must</em> calculate and set <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize②">fixedBlockSize</a></code> based off the rules
specified in <a data-link-type="biblio" href="#biblio-css-sizing-3">[css-sizing-3]</a>, and the formatting context in which it participates. If the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⓪">layout API container</a> has an <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-sizing-3/#valdef-width-auto" id="ref-for-valdef-width-auto①">auto</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-size" id="ref-for-block-size">block size</a>, and cannot be determined
ahead of time, <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize③">fixedBlockSize</a></code> must be set to <code>null</code>.</p>
   </ul>
   <p>If the value of <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options⑥">layout options'</a> <code class="idl"><a data-link-type="idl" href="#dom-layoutoptions-sizing" id="ref-for-dom-layoutoptions-sizing②">sizing</a></code> is <code>"manual"</code>, then the user-agent shouldn’t pre-calculate <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize③">fixedInlineSize</a></code> and/or <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize④">fixedBlockSize</a></code> ahead of time,
except when it is being forced to a particular size by the formatting context in which it
participates, for example:</p>
   <ul>
    <li data-md="">
     <p>If the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①①">layout API container</a> is within a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#block-formatting-context" id="ref-for-block-formatting-context①">block formatting context</a>, is inflow, and
has an <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-sizing-3/#valdef-width-auto" id="ref-for-valdef-width-auto②">auto</a> inline size, the user agent <em>must</em> set the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize④">fixedInlineSize</a></code> to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#stretch-fit-inline-size" id="ref-for-stretch-fit-inline-size">stretch-fit inline size</a>.</p>
   </ul>
   <div class="note" role="note">
     Note: In the example below the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①②">layout API container</a> has its inline size set to 50. 
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">box-sizing</span><span class="p">:</span> <span class="kc">border-box</span><span class="p">;</span>
    <span class="k">padding</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">layout-api</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"layout-api"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
   </div>
   <h4 class="heading settled" data-level="4.1.1" id="interaction-sizing-positiong-layout"><span class="secno">4.1.1. </span><span class="content">Positioned layout sizing</span><a class="self-link" href="#interaction-sizing-positiong-layout"></a></h4>
   <p>If a <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①③">layout API container</a> is out-of-flow positioned the user agent <em>must</em> solve the
positioned size equations (<a href="https://www.w3.org/TR/css3-positioning/#abs-non-replaced-width">CSS Positioned Layout 3 §8.1 The width of absolute or fixed positioned, non-replaced elements</a>, <a href="https://www.w3.org/TR/css3-positioning/#abs-non-replaced-height">CSS Positioned Layout 3 §8.3 The height of absolute or fixed positioned, non-replaced elements</a>), and set the appropriate <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedinlinesize" id="ref-for-dom-layoutconstraints-fixedinlinesize⑤">fixedInlineSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-fixedblocksize" id="ref-for-dom-layoutconstraints-fixedblocksize⑤">fixedBlockSize</a></code>.</p>
   <div class="note" role="note">
     Note: In the example below the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①④">layout API container</a> has its inline and block size fixed
        to 80. 
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">layout-api</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">top</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">bottom</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">left</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">right</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">absolute</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"layout-api"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
   </div>
   <h3 class="heading settled" data-level="4.2" id="interaction-positioning"><span class="secno">4.2. </span><span class="content">Positioning</span><a class="self-link" href="#interaction-positioning"></a></h3>
   <p>All positioning in this level of the specification is handled by the user agent.</p>
   <p>As a result:</p>
   <ul>
    <li data-md="">
     <p>Out-of-flow children do not appear as <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②④">LayoutChild</a></code>ren.</p>
    <li data-md="">
     <p><a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑤">Layout API containers</a> establish <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#containing-block" id="ref-for-containing-block">containing blocks</a> <a href="https://www.w3.org/TR/CSS2/visudet.html#containing-block-details">exactly like block
  containers do</a>. <a data-link-type="biblio" href="#biblio-css21">[CSS21]</a></p>
    <li data-md="">
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset②">inlineOffset</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset②">blockOffset</a></code> represent the position of
  the fragment before any positioning and transforms have occured.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/visudet.html#static-position" id="ref-for-static-position">static position</a> of an absolutely-positioned child of a <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑥">layout API container</a> is
  set to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-start" id="ref-for-inline-start">inline-start</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-start" id="ref-for-block-start">block-start</a> padding edge of the <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑦">layout API
  container</a>. Auto margins are treated as zero for the child.</p>
   </ul>
   <div class="note" role="note">
     Note: In the example below: 
    <ul>
     <li data-md="">
      <p>"child-relative" would be the only child passed to the author’s layout. If it was positioned
  at (<code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset③">inlineOffset</a></code> <code>= 20</code>, <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset③">blockOffset</a></code> <code> = 30</code>), its final position would be (<code>25</code>, <code>40</code>) as the
  relative positioning was handled by the user agent.</p>
     <li data-md="">
      <p>"child-absolute" would not appear as a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑤">LayoutChild</a></code>, and instead would be laid out and
  positioned by the user agent.</p>
     <li data-md="">
      <p>The examples above also apply in a similar way to sticky and fixed positioned children.</p>
    </ul>
<pre class="lang-html highlight"><span class="p">&lt;</span><span class="nt">style</span><span class="p">></span>
  <span class="p">#</span><span class="nn">container</span> <span class="p">{</span>
    <span class="k">display</span><span class="p">:</span> <span class="nf">layout</span><span class="p">(</span><span class="n">foo</span><span class="p">);</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span> <span class="c">/* container is a containing block */</span>
    <span class="k">width</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">height</span><span class="p">:</span> <span class="mi">100</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">#</span><span class="nn">child-relative</span> <span class="p">{</span>
    <span class="k">position</span><span class="p">:</span> <span class="kc">relative</span><span class="p">;</span>
    <span class="k">left</span><span class="p">:</span> <span class="mi">5</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">top</span><span class="p">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">&lt;/</span><span class="nt">style</span><span class="p">></span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"container"</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"child-relative"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"child-absolute"</span><span class="p">>&lt;/</span><span class="nt">div</span><span class="p">></span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">></span>
</pre>
   </div>
   <h3 class="heading settled" data-level="4.3" id="interaction-overflow"><span class="secno">4.3. </span><span class="content">Overflow</span><a class="self-link" href="#interaction-overflow"></a></h3>
   <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollable-overflow" id="ref-for-scrollable-overflow">scrollable overflow</a> for a <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑧">layout API container</a> is handled by the user agent in
this level of the specification.</p>
   <p>A <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container①⑨">layout API container</a> should calculate its scrollable overflow exactly like block
containers do.</p>
   <p>Even if the author’s <a data-link-type="dfn" href="#layout-api-container" id="ref-for-layout-api-container②⓪">layout API container</a> positions a fragment into the <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollable-overflow" id="ref-for-scrollable-overflow①">scrollable
overflow</a> region, relative positioning or transforms may cause the fragment to shift such that
its <a data-link-type="dfn" href="https://drafts.csswg.org/css-overflow-3/#scrollable-overflow" id="ref-for-scrollable-overflow②">scrollable overflow</a> region, causing no overflow to occur.</p>
   <h3 class="heading settled" data-level="4.4" id="interaction-fragmentation"><span class="secno">4.4. </span><span class="content">Fragmentation</span><a class="self-link" href="#interaction-fragmentation"></a></h3>
   <p>A <a data-link-type="dfn" href="#parent-layout" id="ref-for-parent-layout②">parent layout</a> can ask the <a data-link-type="dfn" href="#current-layout" id="ref-for-current-layout①⓪">current layout</a> to <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment②">fragment</a> by setting the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype④">blockFragmentationType</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset①">blockFragmentationOffset</a></code>.</p>
   <p>E.g. <a data-link-type="biblio" href="#biblio-css-multicol-1">[css-multicol-1]</a> layout would set a <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationtype" id="ref-for-dom-layoutconstraints-blockfragmentationtype⑤">blockFragmentationType</a></code> to <code>"column"</code> and set the <code class="idl"><a data-link-type="idl" href="#dom-layoutconstraints-blockfragmentationoffset" id="ref-for-dom-layoutconstraints-blockfragmentationoffset②">blockFragmentationOffset</a></code> to where it needs the
child to fragment.</p>
   <h3 class="heading settled" data-level="4.5" id="interaction-alignment"><span class="secno">4.5. </span><span class="content">Alignment</span><a class="self-link" href="#interaction-alignment"></a></h3>
   <div class="issue" id="issue-baada617">
    <a class="self-link" href="#issue-baada617"></a> Issue: We need to add the ability to request baselines on the input layout constraints, and have a
    fragment returned what was asked. E.g. 
<pre class="lang-javascript highlight"><span class="kr">const</span> constraints <span class="o">=</span> <span class="p">{</span>
    inlineSize<span class="o">:</span> availableInlineSize<span class="p">,</span>
    baselines<span class="o">:</span> <span class="p">[</span><span class="s1">'alphabetic'</span><span class="p">,</span> <span class="s1">'middle'</span><span class="p">],</span>
<span class="p">};</span>

<span class="kr">const</span> fragment <span class="o">=</span> <span class="k">yield</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>constraints<span class="p">);</span>
fragment<span class="p">.</span>baselines<span class="p">.</span>get<span class="p">(</span><span class="s1">'alphabetic'</span><span class="p">)</span> <span class="o">==</span> <span class="cm">/* something */</span><span class="p">;</span>
</pre>
    <p>Do we want this in level 1? E.g. is it better to wait for implementations of <a data-link-type="biblio" href="#biblio-css-align-3">[css-align-3]</a> before
doing this?</p>
   </div>
   <h2 class="heading settled" data-level="5" id="layout"><span class="secno">5. </span><span class="content">Layout</span><a class="self-link" href="#layout"></a></h2>
   <p>This section describes how the CSS Layout API interacts with the user agent’s layout engine.</p>
   <h3 class="heading settled" data-level="5.1" id="layout-invalidation"><span class="secno">5.1. </span><span class="content">Layout Invalidation</span><a class="self-link" href="#layout-invalidation"></a></h3>
   <p>A <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document">document</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-name-to-input-properties-map">layout name to input properties map</dfn> and a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="layout name to child input properties map" data-noexport="" id="layout-name-to-child-input-properties-map">layout
name to child input properties map</dfn>. Initially these maps are empty and are populated when <code class="idl"><a data-link-type="idl" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout">registerLayout(name, layoutCtor)</a></code> is called.</p>
   <p>Each <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box④">box</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-valid-flag">layout valid flag</dfn>. It may be either <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-valid">layout-valid</dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-invalid">layout-invalid</dfn>. It is initially set to <a data-link-type="dfn" href="#layout-invalid" id="ref-for-layout-invalid">layout-invalid</a>.</p>
   <p>Each <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box⑤">box</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="intrinsic-sizes-valid-flag">intrinsic sizes valid flag</dfn>. If may be either <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="intrinsic-sizes-valid">intrinsic-sizes-valid</dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="intrinsic-sizes-invalid">intrinsic-sizes-invalid</dfn>. It is initially set to <a data-link-type="dfn" href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid">intrinsic-sizes-invalid</a>.</p>
   <p>When the computed style for a <var>box</var> changes, the user agent must run the following steps:</p>
   <ol>
    <li data-md="">
     <p>Let <var>layoutFunction</var> be the <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout①">layout()</a> function of the <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-display-3/#propdef-display" id="ref-for-propdef-display④">display</a> property on the computed
style for the <var>box</var> if it exists. If it is a different type of value (e.g. <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-3/#valdef-display-grid" id="ref-for-valdef-display-grid">grid</a>) then
abort all these steps.</p>
    <li data-md="">
     <p>Let <var>name</var> be the first argument of the <var>layoutFunction</var>.</p>
    <li data-md="">
     <p>Let <var>inputProperties</var> be the result of looking up <var>name</var> on <a data-link-type="dfn" href="#layout-name-to-input-properties-map" id="ref-for-layout-name-to-input-properties-map">layout name to input
properties map</a>.</p>
    <li data-md="">
     <p>Let <var>childInputProperties</var> be the result of looking up <var>name</var> on <a data-link-type="dfn" href="#layout-name-to-child-input-properties-map" id="ref-for-layout-name-to-child-input-properties-map">layout name to child
input properties map</a>.</p>
    <li data-md="">
     <p>For each <var>property</var> in <var>inputProperties</var>, if the <var>property</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value②">computed value</a> has
changed, set the <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag">layout valid flag</a> on the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box⑥">box</a> to <a data-link-type="dfn" href="#layout-invalid" id="ref-for-layout-invalid①">layout-invalid</a>, and
set the <a data-link-type="dfn" href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag">intrinsic sizes valid flag</a> to <a data-link-type="dfn" href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid①">intrinsic-sizes-invalid</a>.</p>
    <li data-md="">
     <p>For each <var>property</var> in <var>childInputProperties</var>, if the <var>property</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value③">computed value</a> has
changed, set the <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag①">layout valid flag</a> on the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box⑦">box</a> to <a data-link-type="dfn" href="#layout-invalid" id="ref-for-layout-invalid②">layout-invalid</a>, and
set the <a data-link-type="dfn" href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag①">intrinsic sizes valid flag</a> to <a data-link-type="dfn" href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid②">intrinsic-sizes-invalid</a>.</p>
   </ol>
   <p>When a child <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box⑧">box</a> represented by a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑥">LayoutChild</a></code> is added or removed from the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box-tree" id="ref-for-css-box-tree②">box
tree</a> or has its layout invalidated (from a computed style change, or a descentdant change). Set
the <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag②">layout valid flag</a> on the current <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box⑨">box</a> to <a data-link-type="dfn" href="#layout-invalid" id="ref-for-layout-invalid③">layout-invalid</a> and set the <a data-link-type="dfn" href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag②">intrinsic sizes valid flag</a> on the current <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①⓪">box</a> to <a data-link-type="dfn" href="#intrinsic-sizes-invalid" id="ref-for-intrinsic-sizes-invalid③">intrinsic-sizes-invalid</a>.</p>
   <p class="note" role="note"><span>Note:</span> This only describes layout invalidation as it relates to the CSS Layout API. All <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①①">boxes</a> conceptually have a <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag③">layout valid flag</a> and these changes are propagated
    through the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box-tree" id="ref-for-css-box-tree③">box tree</a>.</p>
   <p class="issue" id="issue-307874b3"><a class="self-link" href="#issue-307874b3"></a> We also want to implcitly invalidate on size and edge properties, i.e.</p>
   <ul>
    <li data-md="">
     <p><a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-width" id="ref-for-propdef-width">width</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-min-width" id="ref-for-propdef-min-width">min-width</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-max-width" id="ref-for-propdef-max-width">max-width</a></p>
    <li data-md="">
     <p><a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-height" id="ref-for-propdef-height">height</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-min-height" id="ref-for-propdef-min-height">min-height</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/visudet.html#propdef-max-height" id="ref-for-propdef-max-height">max-height</a></p>
    <li data-md="">
     <p><a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/box.html#propdef-padding-top" id="ref-for-propdef-padding-top">padding-top</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/box.html#propdef-padding-bottom" id="ref-for-propdef-padding-bottom">padding-bottom</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/box.html#propdef-padding-left" id="ref-for-propdef-padding-left">padding-left</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css2/box.html#propdef-padding-right" id="ref-for-propdef-padding-right">padding-right</a></p>
    <li data-md="">
     <p><a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-top-width" id="ref-for-propdef-border-top-width">border-top-width</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-bottom-width" id="ref-for-propdef-border-bottom-width">border-bottom-width</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-left-width" id="ref-for-propdef-border-left-width">border-left-width</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-right-width" id="ref-for-propdef-border-right-width">border-right-width</a></p>
    <li data-md="">
     <p><a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow" id="ref-for-propdef-overflow①">overflow</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-x" id="ref-for-propdef-overflow-x">overflow-x</a>, <a class="property" data-link-type="propdesc" href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-y" id="ref-for-propdef-overflow-y">overflow-y</a></p>
   </ul>
   <h3 class="heading settled" data-level="5.2" id="concepts"><span class="secno">5.2. </span><span class="content">Concepts</span><a class="self-link" href="#concepts"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-definition">layout definition</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> which describes the information needed by the <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope">LayoutWorkletGlobalScope</a></code> about hte author defined layout (which can be referenced by the <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout②">layout()</a> function). It consists of:</p>
   <ul>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-class-constructor">class constructor</dfn> which is the class <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-constructor" id="ref-for-sec-constructor">constructor</a>.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-layout-generator-function">layout generator function</dfn> which is the layout <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-generatorfunction" id="ref-for-sec-generatorfunction">generator
 function</a> callback.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-intrinsic-sizes-generator-function">intrinsic sizes generator function</dfn> which is the intrinsic sizes <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-generatorfunction" id="ref-for-sec-generatorfunction①">generator function</a> callback.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-constructor-valid-flag">constructor valid flag</dfn>.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-input-properties">input properties</dfn> which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <code>DOMStrings</code></p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-child-input-properties">child input properties</dfn> which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <code>DOMStrings</code>.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="layout definition" data-dfn-type="dfn" data-noexport="" id="layout-definition-layout-options">layout options</dfn> a <code class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions">LayoutOptions</a></code>.</p>
   </ul>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="document-layout-definition">document layout definition</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> which describes the information needed by
the <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document①">document</a> about the author defined layout (which can be referenced by the <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout③">layout()</a> function). It consists of:</p>
   <ul>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn" data-noexport="" id="document-layout-definition-input-properties">input properties</dfn> which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a> of <code>DOMStrings</code></p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn" data-noexport="" id="document-layout-definition-child-input-properties">child input properties</dfn> which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a> of <code>DOMStrings</code>.</p>
    <li data-md="">
     <p><dfn class="dfn-paneled" data-dfn-for="document layout definition" data-dfn-type="dfn" data-noexport="" id="document-layout-definition-layout-options">layout options</dfn> a <code class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions①">LayoutOptions</a></code>.</p>
   </ul>
   <h3 class="heading settled" data-level="5.3" id="layout-worklet"><span class="secno">5.3. </span><span class="content">Layout Worklet</span><a class="self-link" href="#layout-worklet"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet">layoutWorklet</a></code> attribute allows access to the <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet">Worklet</a></code> responsible for all the classes
which are related to layout.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet①">layoutWorklet</a></code>'s <a data-link-type="dfn" href="https://drafts.css-houdini.org/worklets/#worklet-global-scope-type" id="ref-for-worklet-global-scope-type">worklet global scope type</a> is <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope①">LayoutWorkletGlobalScope</a></code>.</p>
<pre class="idl highlight def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://drafts.csswg.org/cssom-1/#css" id="ref-for-css">CSS</a> {
    [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SameObject" id="ref-for-SameObject">SameObject</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet①">Worklet</a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="CSS" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Worklet" id="dom-css-layoutworklet"><code>layoutWorklet</code></dfn>;
};
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope②">LayoutWorkletGlobalScope</a></code> is the global execution context of the <code class="idl"><a data-link-type="idl" href="#dom-css-layoutworklet" id="ref-for-dom-css-layoutworklet②">layoutWorklet</a></code>.</p>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global">Global</a>=(<a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet②">Worklet</a>,<a class="n" data-link-type="idl-name">LayoutWorklet</a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutworkletglobalscope"><code>LayoutWorkletGlobalScope</code></dfn> : <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#workletglobalscope" id="ref-for-workletglobalscope">WorkletGlobalScope</a> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout①">registerLayout</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><span class="kt">DOMString</span></a> <dfn class="nv idl-code" data-dfn-for="LayoutWorkletGlobalScope/registerLayout(name, layoutCtor)" data-dfn-type="argument" data-export="" id="dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"><code>name</code><a class="self-link" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"></a></dfn>, <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#VoidFunction" id="ref-for-VoidFunction">VoidFunction</a> <dfn class="nv idl-code" data-dfn-for="LayoutWorkletGlobalScope/registerLayout(name, layoutCtor)" data-dfn-type="argument" data-export="" id="dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"><code>layoutCtor</code><a class="self-link" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"></a></dfn>);
};
</pre>
   <h3 class="heading settled" data-level="5.4" id="registering-layout"><span class="secno">5.4. </span><span class="content">Registering A Layout</span><a class="self-link" href="#registering-layout"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-layoutoptions"><code>LayoutOptions</code></dfn> {
  <a class="n" data-link-type="idl-name" href="#enumdef-childdisplaytype" id="ref-for-enumdef-childdisplaytype">ChildDisplayType</a> <dfn class="nv dfn-paneled idl-code" data-default="&quot;block&quot;" data-dfn-for="LayoutOptions" data-dfn-type="dict-member" data-export="" data-type="ChildDisplayType " id="dom-layoutoptions-childdisplay"><code>childDisplay</code></dfn> = "block";
  <a class="n" data-link-type="idl-name" href="#enumdef-layoutsizingmode" id="ref-for-enumdef-layoutsizingmode">LayoutSizingMode</a> <dfn class="nv dfn-paneled idl-code" data-default="&quot;block-like&quot;" data-dfn-for="LayoutOptions" data-dfn-type="dict-member" data-export="" data-type="LayoutSizingMode " id="dom-layoutoptions-sizing"><code>sizing</code></dfn> = "block-like";
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-childdisplaytype"><code>ChildDisplayType</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="ChildDisplayType" data-dfn-type="enum-value" data-export="" data-lt="&quot;block&quot;|block" id="dom-childdisplaytype-block"><code>"block"</code><a class="self-link" href="#dom-childdisplaytype-block"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="ChildDisplayType" data-dfn-type="enum-value" data-export="" data-lt="&quot;normal&quot;|normal" id="dom-childdisplaytype-normal"><code>"normal"</code><a class="self-link" href="#dom-childdisplaytype-normal"></a></dfn>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⓪">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-layoutsizingmode"><code>LayoutSizingMode</code></dfn> {
    <dfn class="s idl-code" data-dfn-for="LayoutSizingMode" data-dfn-type="enum-value" data-export="" data-lt="&quot;block-like&quot;|block-like" id="dom-layoutsizingmode-block-like"><code>"block-like"</code><a class="self-link" href="#dom-layoutsizingmode-block-like"></a></dfn>,
    <dfn class="s idl-code" data-dfn-for="LayoutSizingMode" data-dfn-type="enum-value" data-export="" data-lt="&quot;manual&quot;|manual" id="dom-layoutsizingmode-manual"><code>"manual"</code><a class="self-link" href="#dom-layoutsizingmode-manual"></a></dfn>,
};
</pre>
   <p class="issue" id="issue-f1731294"><a class="self-link" href="#issue-f1731294"></a> "normal" is a bad name?</p>
   <p>The <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document②">document</a> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a> of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="document-layout-definitions">document layout definitions</dfn>. Initially this map
is empty; it is populated when <code class="idl"><a data-link-type="idl" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout②">registerLayout(name, layoutCtor)</a></code> is called.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope③">LayoutWorkletGlobalScope</a></code> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map①">map</a> of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-definitions">layout definitions</dfn>. Initially this
map is empty; it is populated when <code class="idl"><a data-link-type="idl" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout③">registerLayout(name, layoutCtor)</a></code> is called.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope④">LayoutWorkletGlobalScope</a></code> has a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map②">map</a> of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="layout-class-instances">layout class instances</dfn>. Initially
this map is empty; it is populated when the user agent calls either <a data-link-type="dfn" href="#determine-the-intrinsic-sizes" id="ref-for-determine-the-intrinsic-sizes">determine the intrinsic
sizes</a> or <a data-link-type="dfn" href="#generate-a-fragment" id="ref-for-generate-a-fragment">generate a fragment</a> for a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①②">box</a>.</p>
   <div class="algorithm" data-algorithm="registerLayout(name, layoutCtor)">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="LayoutWorkletGlobalScope" data-dfn-type="method" data-export="" id="dom-layoutworkletglobalscope-registerlayout"><code>registerLayout(<var>name</var>, <var>layoutCtor</var>)</code></dfn> method
is called, the user agent <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>If the <var>name</var> is an empty string, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror">TypeError</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layoutDefinitionMap</var> be <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑤">LayoutWorkletGlobalScope</a></code>'s <a data-link-type="dfn" href="#layout-definitions" id="ref-for-layout-definitions">layout definitions</a> map.</p>
     <li data-md="">
      <p>If <var>layoutDefinitionMap</var>[<var>name</var>] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①">throw</a> a
"<a data-link-type="dfn" href="https://heycam.github.io/webidl/#invalidmodificationerror" id="ref-for-invalidmodificationerror">InvalidModificationError</a>" <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-domexception" id="ref-for-idl-domexception">DOMException</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>inputProperties</var> be an empty <code>sequence&lt;DOMString></code>.</p>
     <li data-md="">
      <p>Let <var>inputPropertiesIterable</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p">Get</a>(<var>layoutCtor</var>, "inputProperties").</p>
     <li data-md="">
      <p>If <var>inputPropertiesIterable</var> is not undefined, then set <var>inputProperties</var> to the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping">converting</a> <var>inputPropertiesIterable</var> to a <code>sequence&lt;DOMString></code>. If an
exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw②">thrown</a>, rethrow the exception and abort all these steps.</p>
      <p class="note" role="note"><span>Note:</span> The list of CSS properties provided by the input properties getter can either be
    custom or native CSS properties.</p>
      <p class="note" role="note"><span>Note:</span> The list of CSS properties may contain shorthands.</p>
      <p class="note" role="note"><span>Note:</span> In order for a layout class to be forwards compatible, the list of CSS properties can
    also contains currently invalid properties for the user agent. For example <code>margin-bikeshed-property</code>.</p>
     <li data-md="">
      <p>Let <var>childInputProperties</var> be an empty <code>sequence&lt;DOMString></code>.</p>
     <li data-md="">
      <p>Let <var>childInputPropertiesIterable</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p①">Get</a>(<var>layoutCtor</var>,
"childInputProperties").</p>
     <li data-md="">
      <p>If <var>childInputPropertiesIterable</var> is not undefined, then set <var>childInputProperties</var> to the
result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping①">converting</a> <var>childInputPropertiesIterable</var> to a <code>sequence&lt;DOMString></code>. If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw③">thrown</a>, rethrow the exception
and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layoutOptionsValue</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p②">Get</a>(<var>layoutCtor</var>, "layoutOptions").</p>
     <li data-md="">
      <p>Let <var>layoutOptions</var> be the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping②">converting</a> <var>layoutOptionsValue</var> to a <code class="idl"><a data-link-type="idl" href="#dictdef-layoutoptions" id="ref-for-dictdef-layoutoptions②">LayoutOptions</a></code>. If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw④">thrown</a>, rethrow the exception and abort all
these steps.</p>
     <li data-md="">
      <p>If the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-isconstructor" id="ref-for-sec-isconstructor">IsConstructor</a>(<var>layoutCtor</var>) is false, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw⑤">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①">TypeError</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>prototype</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p③">Get</a>(<var>layoutCtor</var>, "prototype").</p>
     <li data-md="">
      <p>If the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values">Type</a>(<var>prototype</var>) is not Object, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw⑥">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②">TypeError</a> and
abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layout</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p④">Get</a>(<var>prototype</var>, <code>"layout"</code>).</p>
     <li data-md="">
      <p>If the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-iscallable" id="ref-for-sec-iscallable">IsCallable</a>(<var>layout</var>) is false, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw⑦">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③">TypeError</a> and
abort all these steps.</p>
     <li data-md="">
      <p>If <var>layout</var>’s <code>[[FunctionKind]]</code> internal slot is not <code>"generator"</code>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw⑧">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④">TypeError</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>intrinsicSizes</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p⑤">Get</a>(<var>prototype</var>, <code>"intrinsicSizes"</code>).</p>
     <li data-md="">
      <p>If the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-iscallable" id="ref-for-sec-iscallable①">IsCallable</a>(<var>intrinsicSizes</var>) is false, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw⑨">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤">TypeError</a> and abort all these steps.</p>
     <li data-md="">
      <p>If <var>intrinsicSizes</var>’s <code>[[FunctionKind]]</code> internal slot is not <code>"generator"</code>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①⓪">throw</a> a <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑥">TypeError</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>definition</var> be a new <a data-link-type="dfn" href="#layout-definition" id="ref-for-layout-definition">layout definition</a> with:</p>
      <ul>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-class-constructor" id="ref-for-layout-definition-class-constructor">class constructor</a> being <var>layoutCtor</var>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-layout-generator-function" id="ref-for-layout-definition-layout-generator-function">layout generator function</a> being <var>layout</var>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-intrinsic-sizes-generator-function" id="ref-for-layout-definition-intrinsic-sizes-generator-function">intrinsic sizes generator function</a> being <var>intrinsicSizes</var>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-constructor-valid-flag" id="ref-for-layout-definition-constructor-valid-flag">constructor valid flag</a> being <b>true</b>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-input-properties" id="ref-for-layout-definition-input-properties">input properties</a> being <var>inputProperties</var>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-child-input-properties" id="ref-for-layout-definition-child-input-properties">child input properties</a> being <var>childInputProperties</var>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="#layout-definition-layout-options" id="ref-for-layout-definition-layout-options">layout options</a> being <var>layoutOptions</var>.</p>
      </ul>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> <var>layoutDefinitionMap</var>[<var>name</var>] to <var>definition</var>.</p>
     <li data-md="">
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to run the following steps:</p>
      <ol>
       <li data-md="">
        <p>Let <var>documentLayoutDefinitionMap</var> be the associated <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document③">document’s</a> <a data-link-type="dfn" href="#document-layout-definitions" id="ref-for-document-layout-definitions">document layout
definitions</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map③">map</a>.</p>
       <li data-md="">
        <p>Let <var>documentDefinition</var> be a new <a data-link-type="dfn" href="#document-layout-definition" id="ref-for-document-layout-definition">document layout definition</a> with:</p>
        <ul>
         <li data-md="">
          <p><a data-link-type="dfn" href="#document-layout-definition-input-properties" id="ref-for-document-layout-definition-input-properties">input properties</a> being <var>inputProperties</var>.</p>
         <li data-md="">
          <p><a data-link-type="dfn" href="#document-layout-definition-child-input-properties" id="ref-for-document-layout-definition-child-input-properties">child input properties</a> being <var>childInputProperties</var>.</p>
         <li data-md="">
          <p><a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options⑦">layout options</a> being <var>layoutOptions</var>.</p>
        </ul>
       <li data-md="">
        <p>If <var>documentLayoutDefinitionMap</var>[<var>name</var>] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exists</a>, run the following steps:</p>
        <ol>
         <li data-md="">
          <p>Let <var>existingDocumentDefinition</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-get" id="ref-for-map-get">get</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>].</p>
         <li data-md="">
          <p>If <var>existingDocumentDefinition</var> is <code>"invalid"</code>, abort all these steps.</p>
         <li data-md="">
          <p>If <var>existingDocumentDefinition</var> and <var>documentDefinition</var> are not equivalent, (that is <a data-link-type="dfn" href="#document-layout-definition-input-properties" id="ref-for-document-layout-definition-input-properties①">input properties</a>, <a data-link-type="dfn" href="#document-layout-definition-child-input-properties" id="ref-for-document-layout-definition-child-input-properties①">child input properties</a>, and <a data-link-type="dfn" href="#document-layout-definition-layout-options" id="ref-for-document-layout-definition-layout-options⑧">layout options</a> are different), then:</p>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set①">Set</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>] to <code>"invalid"</code>.</p>
          <p>Log an error to the debugging console stating that the same class was registered
with different <code>inputProperties</code>, <code>childInputProperties</code>, or <code>layoutOptions</code>.</p>
        </ol>
       <li data-md="">
        <p>Otherwise, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set②">set</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>] to <var>documentDefinition</var>.</p>
      </ol>
    </ol>
    <div class="note" role="note">
      Note: The shape of the class should be: 
<pre class="lang-javascript highlight"><span class="kr">class</span> MyLayout <span class="p">{</span>
    <span class="kr">static</span> get inputProperties<span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[</span><span class="s1">'--foo'</span><span class="p">];</span> <span class="p">}</span>
    <span class="kr">static</span> get childrenInputProperties<span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="p">[</span><span class="s1">'--bar'</span><span class="p">];</span> <span class="p">}</span>
    <span class="kr">static</span> get layoutOptions<span class="p">()</span> <span class="p">{</span>
      <span class="k">return</span> <span class="p">{</span>childDisplay<span class="o">:</span> <span class="s1">'normal'</span><span class="p">,</span> sizing<span class="o">:</span> <span class="s1">'block-like'</span><span class="p">}</span>
    <span class="p">}</span>

    <span class="o">*</span>intrinsicSizes<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> styleMap<span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Intrinsic sizes code goes here.</span>
<span class="c1"></span>    <span class="p">}</span>

    <span class="o">*</span>layout<span class="p">(</span>children<span class="p">,</span> edges<span class="p">,</span> constraints<span class="p">,</span> styleMap<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Layout code goes here.</span>
<span class="c1"></span>    <span class="p">}</span>
<span class="p">}</span>
</pre>
    </div>
   </div>
   <h3 class="heading settled" data-level="5.5" id="layout-engine"><span class="secno">5.5. </span><span class="content">Layout Engine</span><a class="self-link" href="#layout-engine"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="layoutfragmentrequest"><code>LayoutFragmentRequest</code></dfn> {
  // Has internal slots:
  // [[layoutChild]] - The layout child to generate the fragment for.
  // [[layoutConstraints]] - The layout constraints object to perform layout in.
  // [[breakToken]] - The break token to resume the layout with.
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①②">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intrinsicsizesrequest"><code>IntrinsicSizesRequest</code></dfn> {
  // Has internal slots:
  // [[layoutChild]] - The layout child to calculate the intrinsic sizes for.
};
</pre>
   <p>The layout method and intrinsic sizes method on the author supplied layout class is a generator
function instead of a regular javascript function. This is for user-agents to be able to support
asynchronous and parallel layout engines.</p>
   <p>When an author invokes the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑦">layoutNextFragment()</a></code> method on a <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑦">LayoutChild</a></code> the
user-agent doesn’t synchronously generate a <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②⓪">LayoutFragment</a></code> to return to the author’s code.
Instead it returns a <code class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest①">LayoutFragmentRequest</a></code>. This is a completely opaque object to the author but
contains internal slots which encapsulates the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-layoutnextfragment" id="ref-for-dom-layoutchild-layoutnextfragment⑧">layoutNextFragment()</a></code> method call.</p>
   <p>When a <code class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest②">LayoutFragmentRequest</a></code>(s) are yielded from a layout generator object the user-agent’s
layout engine may run the algorithm asynchronously with other work, and/or on a different thread of
execution. When <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②①">LayoutFragment</a></code>(s) have been produced by the engine, the user-agent will "tick"
the generator object with the resulting <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②②">LayoutFragment</a></code>(s).</p>
   <p>The same applies for the <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-intrinsicsizes" id="ref-for-dom-layoutchild-intrinsicsizes">intrinsicSizes()</a></code> method.</p>
   <div class="example" id="example-9f9fbdd6">
    <a class="self-link" href="#example-9f9fbdd6"></a> An example layout engine written in javascript is shown below. 
<pre class="lang-javascript highlight"><span class="kr">class</span> LayoutEngine <span class="p">{</span>
  <span class="c1">// This function takes the root of the box-tree, a LayoutConstraints object, and a</span>
<span class="c1"></span>  <span class="c1">// BreakToken to (if paginating for printing for example) and generates a</span>
<span class="c1"></span>  <span class="c1">// LayoutFragment.</span>
<span class="c1"></span>  layoutEntry<span class="p">(</span>rootBox<span class="p">,</span> rootPageConstraints<span class="p">,</span> breakToken<span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> layoutFragment<span class="p">({</span>
      box<span class="o">:</span> rootBox<span class="p">,</span>
      layoutConstraints<span class="o">:</span> rootPageConstraints<span class="p">,</span>
      breakToken<span class="o">:</span> breakToken<span class="p">,</span>
    <span class="p">});</span>
  <span class="p">}</span>

  <span class="c1">// This function takes a LayoutFragmentRequest and calls the appropriate</span>
<span class="c1"></span>  <span class="c1">// layout algorithm to generate the a LayoutFragment.</span>
<span class="c1"></span>  layoutFragment<span class="p">(</span>fragmentRequest<span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> box <span class="o">=</span> fragmentRequest<span class="p">.</span>layoutChild<span class="p">;</span>
    <span class="kr">const</span> algorithm <span class="o">=</span> selectLayoutAlgorithmForBox<span class="p">(</span>box<span class="p">);</span>
    <span class="kr">const</span> fragmentRequestGenerator <span class="o">=</span> algorithm<span class="p">.</span>layout<span class="p">(</span>
        fragmentRequest<span class="p">.</span>layoutConstraints<span class="p">,</span>
        box<span class="p">.</span>children<span class="p">,</span>
        box<span class="p">.</span>styleMap<span class="p">,</span>
        fragmentRequest<span class="p">.</span>breakToken<span class="p">);</span>

    <span class="kd">let</span> nextFragmentRequest <span class="o">=</span> fragmentRequestGenerator<span class="p">.</span>next<span class="p">();</span>

    <span class="k">while</span> <span class="p">(</span><span class="o">!</span>nextFragmentRequest<span class="p">.</span>done<span class="p">)</span> <span class="p">{</span>
      <span class="c1">// A user-agent may decide to perform layout to generate the fragments in</span>
<span class="c1"></span>      <span class="c1">// parallel on separate threads. This example performs them synchronously</span>
<span class="c1"></span>      <span class="c1">// in order.</span>
<span class="c1"></span>      <span class="kd">let</span> fragments <span class="o">=</span> nextFragmentRequest<span class="p">.</span>value<span class="p">.</span>map<span class="p">(</span>layoutFragment<span class="p">);</span>

      <span class="c1">// A user-agent may decide to yield for other work (garbage collection for</span>
<span class="c1"></span>      <span class="c1">// example) before resuming this layout work. This example just performs</span>
<span class="c1"></span>      <span class="c1">// layout synchronously without any ability to yield.</span>
<span class="c1"></span>      nextFragmentRequest <span class="o">=</span> fragmentRequestGenerator<span class="p">.</span>next<span class="p">(</span>fragments<span class="p">);</span>
    <span class="p">}</span>

    <span class="k">return</span> nextFragmentRequest<span class="p">.</span>value<span class="p">;</span> <span class="c1">// Return the final LayoutFragment.</span>
<span class="c1"></span>  <span class="p">}</span>
<span class="p">}</span>
</pre>
   </div>
   <h3 class="heading settled" data-level="5.6" id="performing-layout"><span class="secno">5.6. </span><span class="content">Performing Layout</span><a class="self-link" href="#performing-layout"></a></h3>
<pre class="idl highlight def">// This is the final return value from the author defined layout() method.
<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-fragmentresultoptions"><code>FragmentResultOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②④"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-default="0" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-fragmentresultoptions-inlinesize"><code>inlineSize</code></dfn> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑤"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-default="0" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-fragmentresultoptions-blocksize"><code>blockSize</code></dfn> = 0;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#layoutfragment" id="ref-for-layoutfragment②③">LayoutFragment</a>> <dfn class="nv dfn-paneled idl-code" data-default="None" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="sequence<LayoutFragment> " id="dom-fragmentresultoptions-childfragments"><code>childFragments</code></dfn> = [];
    <span class="kt">any</span> <dfn class="nv dfn-paneled idl-code" data-default="null" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="any " id="dom-fragmentresultoptions-data"><code>data</code></dfn> = <span class="kt">null</span>;
    <a class="n" data-link-type="idl-name" href="#dictdef-breaktokenoptions" id="ref-for-dictdef-breaktokenoptions">BreakTokenOptions</a> <dfn class="nv dfn-paneled idl-code" data-default="null" data-dfn-for="FragmentResultOptions" data-dfn-type="dict-member" data-export="" data-type="BreakTokenOptions " id="dom-fragmentresultoptions-breaktoken"><code>breakToken</code></dfn> = <span class="kt">null</span>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-intrinsicsizesresultoptions"><code>IntrinsicSizesResultOptions</code></dfn> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑥"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizesResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-intrinsicsizesresultoptions-maxcontentsize"><code>maxContentSize</code></dfn>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑦"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizesResultOptions" data-dfn-type="dict-member" data-export="" data-type="double " id="dom-intrinsicsizesresultoptions-mincontentsize"><code>minContentSize</code></dfn>;
};

<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="intrinsicsizes"><code>IntrinsicSizes</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑧"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-intrinsicsizes-mincontentsize"><code>minContentSize</code></dfn>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑨"><span class="kt">double</span></a> <dfn class="nv dfn-paneled idl-code" data-dfn-for="IntrinsicSizes" data-dfn-type="attribute" data-export="" data-readonly="" data-type="double" id="dom-intrinsicsizes-maxcontentsize"><code>maxContentSize</code></dfn>;
};
</pre>
   <p class="issue" id="issue-eb78ed00"><a class="self-link" href="#issue-eb78ed00"></a> Should <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize" id="ref-for-dom-intrinsicsizes-mincontentsize">minContentSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize" id="ref-for-dom-intrinsicsizes-maxcontentsize">maxContentSize</a></code> be content
    contributions instead? E.g.  minContentContribution, maxContentContribution. Should <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-mincontentsize" id="ref-for-dom-intrinsicsizesresultoptions-mincontentsize">minContentSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-maxcontentsize" id="ref-for-dom-intrinsicsizesresultoptions-maxcontentsize">maxContentSize</a></code> be content contributions as well?</p>
   <h4 class="heading settled" data-level="5.6.1" id="determining-intrinsic-sizes"><span class="secno">5.6.1. </span><span class="content">Determining Intrinsic Sizes</span><a class="self-link" href="#determining-intrinsic-sizes"></a></h4>
   <p>The <a data-link-type="dfn" href="#determine-the-intrinsic-sizes" id="ref-for-determine-the-intrinsic-sizes①">determine the intrinsic sizes</a> algorithm defines how a user agent is to query the author
defined layout for a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①③">box’s</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes" id="ref-for-intrinsic-sizes">intrinsic sizes</a> information.</p>
   <p class="note" role="note"><span>Note:</span> The <a data-link-type="dfn" href="#determine-the-intrinsic-sizes" id="ref-for-determine-the-intrinsic-sizes②">determine the intrinsic sizes</a> algorithm allows for user agents to cache an arbitary
    number of previous invocations to reuse.</p>
   <div class="algorithm" data-algorithm="determine the intrinsic sizes">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="determine-the-intrinsic-sizes">determine the intrinsic sizes</dfn> of a <a data-link-type="dfn" href="#layout-api-formatting-context" id="ref-for-layout-api-formatting-context">layout API formatting
context</a> for a given <var>box</var>, <var>childBoxes</var> it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>layoutFunction</var> be the <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout④">layout()</a> for the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value④">computed value</a> of <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-inside" id="ref-for-typedef-display-inside②" title="Expands to: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a> for <var>box</var>.</p>
     <li data-md="">
      <p>If the <a data-link-type="dfn" href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag③">intrinsic sizes valid flag</a> for the <var>layoutFunction</var> is <a data-link-type="dfn" href="#intrinsic-sizes-valid" id="ref-for-intrinsic-sizes-valid">intrinsic-sizes-valid</a> the user agent <em>may</em> use the intrinsic sizes from the
previous invocation. If so it <em>may</em> abort all these steps and use the previous value
for the intrinsic sizes.</p>
     <li data-md="">
      <p>Set the <a data-link-type="dfn" href="#intrinsic-sizes-valid-flag" id="ref-for-intrinsic-sizes-valid-flag④">intrinsic sizes valid flag</a> for the <var>layoutFunction</var> to <a data-link-type="dfn" href="#intrinsic-sizes-valid" id="ref-for-intrinsic-sizes-valid①">intrinsic-sizes-valid</a>.</p>
     <li data-md="">
      <p>Let <var>name</var> be the first argument of the <var>layoutFunction</var>.</p>
     <li data-md="">
      <p>Let <var>documentDefinition</var> be the result of <a data-link-type="dfn" href="#get-a-document-layout-definition" id="ref-for-get-a-document-layout-definition">get a document layout definition</a>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-document-layout-definition" id="ref-for-get-a-document-layout-definition①">get a document layout definition</a> returned failure, or if <var>documentDefinition</var> is <code>"invalid"</code>, then let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout">flow layout</a> and abort all
these steps.</p>
     <li data-md="">
      <p>Let <var>workletGlobalScope</var> be a <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑥">LayoutWorkletGlobalScope</a></code> from the list of <a data-link-type="dfn" href="https://drafts.css-houdini.org/worklets/#worklets-workletglobalscopes" id="ref-for-worklets-workletglobalscopes">worklet’s
WorkletGlobalScopes</a> from the layout <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet③">Worklet</a></code>.</p>
      <p>The user agent <em>must</em> have, and select from at least two <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑦">LayoutWorkletGlobalScope</a></code>s in the <a data-link-type="dfn" href="https://drafts.css-houdini.org/worklets/#worklets-workletglobalscopes" id="ref-for-worklets-workletglobalscopes①">worklet’s WorkletGlobalScopes</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a>,
unless the user agent is under memory constraints.</p>
      <p class="note" role="note"><span>Note:</span> This is to ensure that authers do not rely on being able to store state on the global
    object or non-regeneratable state on the class.</p>
      <p>The user agent <em>may</em> also <a data-link-type="dfn">create a WorkletGlobalScope</a> at this time, given the
layout <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet④">Worklet</a></code>.</p>
     <li data-md="">
      <p>Run <a data-link-type="dfn" href="#invoke-a-intrinsic-sizes-callback" id="ref-for-invoke-a-intrinsic-sizes-callback">invoke a intrinsic sizes callback</a> given <var>name</var>, <var>box</var>, <var>childBoxes</var>, and <var>workletGlobalScope</var> optionally <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>.</p>
      <p class="note" role="note"><span>Note:</span> If the user agent runs <a data-link-type="dfn" href="#invoke-a-intrinsic-sizes-callback" id="ref-for-invoke-a-intrinsic-sizes-callback①">invoke a intrinsic sizes callback</a> on a thread <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①">in
    parallel</a>, it should select a layout worklet global scope which can be used on that
    thread.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="invoke a intrinsic sizes callback">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="invoke-a-intrinsic-sizes-callback">invoke a intrinsic sizes callback</dfn> given <var>name</var>, <var>box</var>, <var>childBoxes</var>, and <var>workletGlobalScope</var>, it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>definition</var> be the result of <a data-link-type="dfn" href="#get-a-layout-definition" id="ref-for-get-a-layout-definition">get a layout definition</a> given <var>name</var>, and <var>workletGlobalScope</var>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-layout-definition" id="ref-for-get-a-layout-definition①">get a layout definition</a> returned failure, let the <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout①">flow
layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layoutInstance</var> be the result of <a data-link-type="dfn" href="#get-a-layout-class-instance" id="ref-for-get-a-layout-class-instance">get a layout class instance</a> given <var>name</var>, <var>box</var>, <var>definition</var>, <var>workletGlobalScope</var>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-layout-class-instance" id="ref-for-get-a-layout-class-instance①">get a layout class instance</a> returned failure, let the <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout②">flow layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>inputProperties</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-input-properties" id="ref-for-layout-definition-input-properties①">input properties</a>.</p>
     <li data-md="">
      <p>Let <var>childInputProperties</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-child-input-properties" id="ref-for-layout-definition-child-input-properties①">child input
properties</a>.</p>
     <li data-md="">
      <p>Let <var>children</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">list</a> populated with new <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑧">LayoutChild</a></code> objects which
represent <var>childBoxes</var>.</p>
      <p>The <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap②">styleMap</a></code> on each <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild②⑨">LayoutChild</a></code> should be a new <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly①">StylePropertyMapReadOnly</a></code> populated with <em>only</em> the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value⑤">computed values</a> for
properties listed in <var>childInputProperties</var>.</p>
     <li data-md="">
      <p>Let <var>edges</var> be a new <code class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑥">LayoutEdgeSizes</a></code> populated with the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value⑥">computed value</a> for all the <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/box.html#box-dimensions" id="ref-for-box-dimensions①">box model edges</a> for <var>box</var>.</p>
     <li data-md="">
      <p>Let <var>styleMap</var> be a new <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly②">StylePropertyMapReadOnly</a></code> populated with <em>only</em> the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value⑦">computed values</a> for properties listed in <var>inputProperties</var> for <var>box</var>.</p>
     <li data-md="">
      <p>At this stage the user agent may re-use the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes" id="ref-for-intrinsic-sizes①">intrinsic sizes</a> from a previous invocation
if <var>children</var>, <var>styleMap</var> are equivalent to that previous invocation. If so let the
intrinsic sizes the cached intrinsic sizes and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>intrinsicSizesGeneratorFunction</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-intrinsic-sizes-generator-function" id="ref-for-layout-definition-intrinsic-sizes-generator-function①">intrinsic sizes generator
function</a>.</p>
     <li data-md="">
      <p>Let <var>intrinsicSizesGenerator</var> be the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-invoking-callback-functions" id="ref-for-es-invoking-callback-functions">Invoke</a>(<var>intrinsicSizesGeneratorFunction</var>, <var>layoutInstance</var>, «<var>children</var>, <var>edges</var>, <var>styleMap</var>»).</p>
      <p>If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①①">thrown</a> the let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout③">flow layout</a> and abort
all these steps.</p>
     <li data-md="">
      <p>Let <var>intrinsicSizesValue</var> be the result of <a data-link-type="dfn" href="#run-a-generator" id="ref-for-run-a-generator">run a generator</a> given <var>intrinsicSizesGenerator</var>, and <code>"intrinsic-sizes"</code>.</p>
      <p>If <a data-link-type="dfn" href="#run-a-generator" id="ref-for-run-a-generator①">run a generator</a> returned failure, then let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout④">flow
layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>intrinsicSizes</var> be the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping③">converting</a> <var>intrinsicSizesValue</var> to a <code class="idl"><a data-link-type="idl" href="#dictdef-intrinsicsizesresultoptions" id="ref-for-dictdef-intrinsicsizesresultoptions">IntrinsicSizesResultOptions</a></code>. If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①②">thrown</a>, let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout⑤">flow layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Set the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing/#intrinsic-sizes" id="ref-for-intrinsic-sizes②">intrinsic sizes</a> of <var>box</var>:</p>
      <ul>
       <li data-md="">
        <p>Let <var>intrinsicSizes</var>’s <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-mincontentsize" id="ref-for-dom-intrinsicsizesresultoptions-mincontentsize①">minContentSize</a></code> be the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#min-content" id="ref-for-min-content">min-content size</a> of <var>box</var>.</p>
       <li data-md="">
        <p>Let <var>intrinsicSizes</var>’s <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-maxcontentsize" id="ref-for-dom-intrinsicsizesresultoptions-maxcontentsize①">maxContentSize</a></code> be the <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#max-content" id="ref-for-max-content">max-content size</a> of <var>box</var>.</p>
      </ul>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.6.2" id="generating-fragments"><span class="secno">5.6.2. </span><span class="content">Generating Fragments</span><a class="self-link" href="#generating-fragments"></a></h4>
   <p>The <a data-link-type="dfn" href="#generate-a-fragment" id="ref-for-generate-a-fragment①">generate a fragment</a> algorithm defines how a user agent is to generate a <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#css-box" id="ref-for-css-box①④">box’s</a> <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment③">fragment</a> for an author defined layout.</p>
   <p class="note" role="note"><span>Note:</span> The <a data-link-type="dfn" href="#generate-a-fragment" id="ref-for-generate-a-fragment②">generate a fragment</a> algorithm allows for user agents to cache an arbitary number of
    previous invocations to reuse.</p>
   <div class="algorithm" data-algorithm="generate a fragment">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="generate-a-fragment">generate a fragment</dfn> of a <a data-link-type="dfn" href="#layout-api-formatting-context" id="ref-for-layout-api-formatting-context①">layout API formatting
context</a> for a given <var>box</var>, <var>childBoxes</var>, <var>internalLayoutConstraints</var>, and an optional <var>internalBreakToken</var> it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>layoutFunction</var> be the <a class="css" data-link-type="maybe" href="#valdef-display-layout" id="ref-for-valdef-display-layout⑤">layout()</a> for the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value⑧">computed value</a> of <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-display-3/#typedef-display-inside" id="ref-for-typedef-display-inside③" title="Expands to: flex | flow | grid | flow-root | table | ruby">&lt;display-inside></a> for <var>box</var>.</p>
     <li data-md="">
      <p>If the <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag④">layout valid flag</a> for the <var>layoutFunction</var> is <a data-link-type="dfn" href="#layout-valid" id="ref-for-layout-valid">layout-valid</a> the user
agent <em>may</em> use the intrinsic sizes from the previous invocation. If so it <em>may</em> abort all these steps and use the previous value for the intrinsic sizes.</p>
     <li data-md="">
      <p>Set the <a data-link-type="dfn" href="#layout-valid-flag" id="ref-for-layout-valid-flag⑤">layout valid flag</a> for the <var>layoutFunction</var> to <a data-link-type="dfn" href="#layout-valid" id="ref-for-layout-valid①">layout-valid</a>.</p>
     <li data-md="">
      <p>Let <var>name</var> be the first argument of the <var>layoutFunction</var>.</p>
     <li data-md="">
      <p>Let <var>documentDefinition</var> be the result of <a data-link-type="dfn" href="#get-a-document-layout-definition" id="ref-for-get-a-document-layout-definition②">get a document layout definition</a>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-document-layout-definition" id="ref-for-get-a-document-layout-definition③">get a document layout definition</a> returned failure, or if <var>documentDefinition</var> is <code>"invalid"</code>, then let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout⑥">flow layout</a> and abort all
these steps.</p>
     <li data-md="">
      <p>Let <var>workletGlobalScope</var> be a <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑧">LayoutWorkletGlobalScope</a></code> from the list of <a data-link-type="dfn" href="https://drafts.css-houdini.org/worklets/#worklets-workletglobalscopes" id="ref-for-worklets-workletglobalscopes②">worklet’s
WorkletGlobalScopes</a> from the layout <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet⑤">Worklet</a></code>.</p>
      <p>The user agent <em>must</em> have, and select from at least two <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope⑨">LayoutWorkletGlobalScope</a></code>s in the <a data-link-type="dfn" href="https://drafts.css-houdini.org/worklets/#worklets-workletglobalscopes" id="ref-for-worklets-workletglobalscopes③">worklet’s WorkletGlobalScopes</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a>,
unless the user agent is under memory constraints.</p>
      <p class="note" role="note"><span>Note:</span> This is to ensure that authers do not rely on being able to store state on the global
    object or non-regeneratable state on the class.</p>
      <p>The user agent <em>may</em> also <a data-link-type="dfn">create a WorkletGlobalScope</a> at this time, given the
layout <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet⑥">Worklet</a></code>.</p>
     <li data-md="">
      <p>Run <a data-link-type="dfn" href="#invoke-a-layout-callback" id="ref-for-invoke-a-layout-callback">invoke a layout callback</a> given <var>name</var>, <var>box</var>, <var>childBoxes</var>, <var>internalLayoutConstraints</var>, <var>internalBreakToken</var>, and <var>workletGlobalScope</var> optionally <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel②">in
parallel</a>.</p>
      <p class="note" role="note"><span>Note:</span> If the user agent runs <a data-link-type="dfn" href="#invoke-a-intrinsic-sizes-callback" id="ref-for-invoke-a-intrinsic-sizes-callback②">invoke a intrinsic sizes callback</a> on a thread <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel③">in
    parallel</a>, it should select a layout worklet global scope which can be used on that
    thread.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="invoke a layout callback">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="invoke-a-layout-callback">invoke a layout callback</dfn> given <var>name</var>, <var>box</var>, <var>childBoxes</var>, <var>internalLayoutConstraints</var>, <var>internalBreakToken</var>, and <var>workletGlobalScope</var>, it <em>must</em> run the
following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>definition</var> be the result of <a data-link-type="dfn" href="#get-a-layout-definition" id="ref-for-get-a-layout-definition②">get a layout definition</a> given <var>name</var>, and <var>workletGlobalScope</var>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-layout-definition" id="ref-for-get-a-layout-definition③">get a layout definition</a> returned failure, let the <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout⑦">flow
layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layoutInstance</var> be the result of <a data-link-type="dfn" href="#get-a-layout-class-instance" id="ref-for-get-a-layout-class-instance②">get a layout class instance</a> given <var>name</var>, <var>box</var>, <var>definition</var>, <var>workletGlobalScope</var>.</p>
      <p>If <a data-link-type="dfn" href="#get-a-layout-class-instance" id="ref-for-get-a-layout-class-instance③">get a layout class instance</a> returned failure, let the <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout⑧">flow layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>inputProperties</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-input-properties" id="ref-for-layout-definition-input-properties②">input properties</a>.</p>
     <li data-md="">
      <p>Let <var>childInputProperties</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-child-input-properties" id="ref-for-layout-definition-child-input-properties②">child input
properties</a>.</p>
     <li data-md="">
      <p>Let <var>children</var> be a new <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑦">list</a> populated with new <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③⓪">LayoutChild</a></code> objects which
represent <var>childBoxes</var>.</p>
      <p>The <code class="idl"><a data-link-type="idl" href="#dom-layoutchild-stylemap" id="ref-for-dom-layoutchild-stylemap③">styleMap</a></code> on each <code class="idl"><a data-link-type="idl" href="#layoutchild" id="ref-for-layoutchild③①">LayoutChild</a></code> should be a new <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly③">StylePropertyMapReadOnly</a></code> populated with <em>only</em> the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value⑨">computed values</a> for
properties listed in <var>childInputProperties</var>.</p>
     <li data-md="">
      <p>Let <var>edges</var> be a new <code class="idl"><a data-link-type="idl" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑦">LayoutEdgeSizes</a></code> populated with the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value①⓪">computed value</a> for all the <a data-link-type="dfn" href="https://www.w3.org/TR/CSS21/box.html#box-dimensions" id="ref-for-box-dimensions②">box model edges</a> for <var>box</var>.</p>
     <li data-md="">
      <p>Let <var>layoutConstraints</var> be a new <code class="idl"><a data-link-type="idl" href="#layoutconstraints" id="ref-for-layoutconstraints⑧">LayoutConstraints</a></code> object populated with the appropriate
information from <var>internalLayoutConstraints</var>.</p>
     <li data-md="">
      <p>Let <var>styleMap</var> be a new <code class="idl"><a data-link-type="idl" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly④">StylePropertyMapReadOnly</a></code> populated with <em>only</em> the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-4/#computed-value" id="ref-for-computed-value①①">computed values</a> for properties listed in <var>inputProperties</var> for <var>box</var>.</p>
     <li data-md="">
      <p>Let <var>breakToken</var> be a new <code class="idl"><a data-link-type="idl" href="#breaktoken" id="ref-for-breaktoken②">BreakToken</a></code> populated with the appropriate information from <var>internalBreakToken</var>.</p>
      <p>If <var>internalBreakToken</var> is null, let <var>breakToken</var> be null.</p>
     <li data-md="">
      <p>At this stage the user agent may re-use a <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment④">fragment</a> from a previous invocation if <var>children</var>, <var>styleMap</var>, <var>layoutConstraints</var>, <var>breakToken</var> are equivalent to that previous
invocation. If so let the fragment output be that cached fragment and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>layoutGeneratorFunction</var> be <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-layout-generator-function" id="ref-for-layout-definition-layout-generator-function①">layout generator function</a>.</p>
     <li data-md="">
      <p>Let <var>layoutGenerator</var> be the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-invoking-callback-functions" id="ref-for-es-invoking-callback-functions①">Invoke</a>(<var>layoutGeneratorFunction</var>, <var>layoutInstance</var>, «<var>children</var>, <var>edges</var>, <var>layoutConstraints</var>, <var>styleMap</var>, <var>breakToken</var>»).</p>
      <p>If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①③">thrown</a> the let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout⑨">flow layout</a> and abort
all these steps.</p>
     <li data-md="">
      <p>Let <var>fragmentValue</var> be the result of <a data-link-type="dfn" href="#run-a-generator" id="ref-for-run-a-generator②">run a generator</a> given <var>layoutGenerator</var>, and <code>"layout"</code>.</p>
      <p>If <a data-link-type="dfn" href="#run-a-generator" id="ref-for-run-a-generator③">run a generator</a> returned failure, then let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout①⓪">flow
layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Let <var>fragment</var> be the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-type-mapping" id="ref-for-es-type-mapping④">converting</a> <var>fragmentValue</var> to a <code class="idl"><a data-link-type="idl" href="#dictdef-fragmentresultoptions" id="ref-for-dictdef-fragmentresultoptions②">FragmentResultOptions</a></code>. If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①④">thrown</a>, let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout①①">flow layout</a> and abort all these steps.</p>
     <li data-md="">
      <p>Create a <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment⑤">fragment</a> for <var>box</var> with:</p>
      <ul>
       <li data-md="">
        <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-size" id="ref-for-inline-size①">inline size</a> set to <var>fragment</var>’s <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-inlinesize" id="ref-for-dom-fragmentresultoptions-inlinesize">inlineSize</a></code>.</p>
       <li data-md="">
        <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-size" id="ref-for-block-size①">block size</a> set to <var>fragment</var>’s <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-blocksize" id="ref-for-dom-fragmentresultoptions-blocksize">blockSize</a></code>.</p>
       <li data-md="">
        <p>The child fragments set to <var>fragment</var>’s <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-childfragments" id="ref-for-dom-fragmentresultoptions-childfragments①">childFragments</a></code> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑧">list</a>. The ordering <em>is</em> important as this dictates their paint order
(described in <a href="#layout-api-containers">§2 Layout API Containers</a>). Their position relative to the <b>border
box</b> of the <var>fragment</var> should be based off the author specified <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset④">inlineOffset</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset④">blockOffset</a></code>.</p>
       <li data-md="">
        <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-break/#fragmentation-break" id="ref-for-fragmentation-break">fragmentation break</a> information set to <var>fragment</var>’s <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-breaktoken" id="ref-for-dom-fragmentresultoptions-breaktoken①">breakToken</a></code>.</p>
       <li data-md="">
        <p>Let <var>clonedData</var> be the result of invoking <a data-link-type="dfn" href="https://html.spec.whatwg.org/#structuredserializeforstorage" id="ref-for-structuredserializeforstorage">StructuredSerializeForStorage</a> on <var>fragment</var>’s <code class="idl"><a data-link-type="idl" href="#dom-fragmentresultoptions-data" id="ref-for-dom-fragmentresultoptions-data①">data</a></code>.</p>
        <p>The user agent must store <var>clonedData</var> with the <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment⑥">fragment</a>.</p>
      </ul>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.6.3" id="utility-algorithms"><span class="secno">5.6.3. </span><span class="content">Utility Algorithms</span><a class="self-link" href="#utility-algorithms"></a></h4>
   <p>The section specifies algorithms common to the <a data-link-type="dfn" href="#determine-the-intrinsic-sizes" id="ref-for-determine-the-intrinsic-sizes③">determine the intrinsic sizes</a> and <a data-link-type="dfn" href="#generate-a-fragment" id="ref-for-generate-a-fragment③">generate
a fragment</a> algorithms.</p>
   <div class="algorithm" data-algorithm="get a document layout definition">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="get-a-document-layout-definition">get a document layout definition</dfn> given <var>name</var>, it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>documentLayoutDefinitionMap</var> be the associated <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document④">document’s</a> <a data-link-type="dfn" href="#document-layout-definitions" id="ref-for-document-layout-definitions①">document layout
definitions</a> map.</p>
     <li data-md="">
      <p>If <var>documentLayoutDefinitionMap</var>[<var>name</var>] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">exist</a>, return failure and
abort all these steps.</p>
     <li data-md="">
      <p>Return the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-get" id="ref-for-map-get①">get</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get a layout definition">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="get-a-layout-definition">get a layout definition</dfn> given <var>name</var>, and <var>workletGlobalScope</var>, it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>layoutDefinitionMap</var> be <var>workletGlobalScope</var>’s <a data-link-type="dfn" href="#layout-definitions" id="ref-for-layout-definitions①">layout definitions</a> map.</p>
     <li data-md="">
      <p>If <var>layoutDefinitionMap</var>[<var>name</var>] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">exist</a>, run the following steps:</p>
      <ol>
       <li data-md="">
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task①">Queue a task</a> to run the following steps:</p>
        <ol>
         <li data-md="">
          <p>Let <var>documentLayoutDefinitionMap</var> be the associated <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document⑤">document’s</a> <a data-link-type="dfn" href="#document-layout-definition" id="ref-for-document-layout-definition①">document
layout definition</a> map.</p>
         <li data-md="">
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set③">Set</a> <var>documentLayoutDefinitionMap</var>[<var>name</var>] to <code>"invalid"</code>.</p>
         <li data-md="">
          <p>The user agent <em>should</em> log an error to the debugging console stating that a
class wasn’t registered in all <code class="idl"><a data-link-type="idl" href="#layoutworkletglobalscope" id="ref-for-layoutworkletglobalscope①⓪">LayoutWorkletGlobalScope</a></code>s.</p>
        </ol>
       <li data-md="">
        <p>Return failure, and abort all these steps.</p>
      </ol>
     <li data-md="">
      <p>Return the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p⑥">get</a> <var>layoutDefinitionMap</var>[<var>name</var>].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="get a layout class instance">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="get-a-layout-class-instance">get a layout class instance</dfn> given <var>name</var>, <var>box</var>, <var>definition</var>, and <var>workletGlobalScope</var>, it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>layoutClassInstanceMap</var> be <var>workletGlobalScope</var>’s <a data-link-type="dfn" href="#layout-class-instances" id="ref-for-layout-class-instances">layout class instances</a> map.</p>
     <li data-md="">
      <p>Let <var>key</var> be a stable <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-key" id="ref-for-map-key">key</a> which is unique to <var>box</var> and <var>name</var>.</p>
     <li data-md="">
      <p>Let <var>layoutInstance</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p⑦">get</a> <var>layoutClassInstanceMap</var>[<var>key</var>]. If <var>layoutInstance</var> is null, run the following steps:</p>
      <ol>
       <li data-md="">
        <p>If the <a data-link-type="dfn" href="#layout-definition-constructor-valid-flag" id="ref-for-layout-definition-constructor-valid-flag①">constructor valid flag</a> on <var>definition</var> is false, let <var>box</var> fallback to the <a data-link-type="dfn" href="https://drafts.csswg.org/css-display-3/#flow-layout" id="ref-for-flow-layout①②">flow layout</a> and a abort all these steps.</p>
       <li data-md="">
        <p>Let <var>layoutCtor</var> be the <a data-link-type="dfn" href="#layout-definition-class-constructor" id="ref-for-layout-definition-class-constructor①">class constructor</a> on <var>definition</var>.</p>
       <li data-md="">
        <p>Let <var>layoutInstance</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-construct" id="ref-for-sec-construct">Construct</a>(<var>layoutCtor</var>).</p>
        <p>If <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-construct" id="ref-for-sec-construct①">construct</a> throws an exception, set the <var>definition</var>’s <a data-link-type="dfn" href="#layout-definition-constructor-valid-flag" id="ref-for-layout-definition-constructor-valid-flag②">constructor valid
flag</a> to false, then return failure and abort all these steps.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set④">Set</a> <var>layoutClassInstanceMap</var>[<var>key</var>] to <var>layoutInstance</var>.</p>
      </ol>
     <li data-md="">
      <p>Return <var>layoutInstance</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="run a generator">
     When the user agent wants to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="run-a-generator">run a generator</dfn> given <var>generator</var>, and <var>generatorType</var>, it <em>must</em> run the following steps: 
    <ol>
     <li data-md="">
      <p>Let <var>nextResult</var> be the result of calling <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-invoking-callback-functions" id="ref-for-es-invoking-callback-functions②">Invoke</a>(<code>next</code>, <var>generator</var>).</p>
      <p>If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①⑤">thrown</a> return failure, and abort all these steps.</p>
     <li data-md="">
      <p>Perform the following substeps until the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p⑧">Get</a>(<var>nextResult</var>, <code>"done"</code>) is <code>true</code>.</p>
      <ol>
       <li data-md="">
        <p>Let <var>requests</var> be the result of <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p⑨">Get</a>(<var>nextResult</var>, <code>"value"</code>).</p>
       <li data-md="">
        <p>Let <var>results</var> be an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑨">list</a>.</p>
       <li data-md="">
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>request</var> in <var>requests</var> perform the following substeps:</p>
        <ol>
         <li data-md="">
          <p>Let <var>result</var> be null.</p>
         <li data-md="">
          <p>If <var>request</var> is a <code class="idl"><a data-link-type="idl" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest①">IntrinsicSizesRequest</a></code> then:</p>
          <ol>
           <li data-md="">
            <p>Let <var>layoutChild</var> be the result of looking up the internal slot <code>[[layoutChild]]</code> on <var>request</var>.</p>
           <li data-md="">
            <p>Let <var>result</var> be a new <code class="idl"><a data-link-type="idl" href="#intrinsicsizes" id="ref-for-intrinsicsizes">IntrinsicSizes</a></code> with:</p>
            <ul>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize" id="ref-for-dom-intrinsicsizes-mincontentsize①">minContentSize</a></code> being <var>layoutChild</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#min-content" id="ref-for-min-content①">min-content
size</a>.</p>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize" id="ref-for-dom-intrinsicsizes-maxcontentsize①">maxContentSize</a></code> being <var>layoutChild</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-sizing-3/#max-content" id="ref-for-max-content①">max-content
size</a>.</p>
            </ul>
          </ol>
         <li data-md="">
          <p>If <var>request</var> is a <code class="idl"><a data-link-type="idl" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest③">LayoutFragmentRequest</a></code> and <var>generatorType</var> is <code>"layout"</code> then:</p>
          <ol>
           <li data-md="">
            <p>Let <var>layoutChild</var> be result of looking up the internal slot <code>[[layoutChild]]</code> on <var>request</var>.</p>
           <li data-md="">
            <p>Let <var>childLayoutConstraints</var> be the result of looking up the internal slot <code>[[childLayoutConstraints]]</code> on <var>request</var>.</p>
           <li data-md="">
            <p>Let <var>childBreakToken</var> be the result of looking up the internal slot <code>[[childBreakToken]]</code> on <var>request</var>.</p>
           <li data-md="">
            <p>Let <var>internalFragment</var> be the result of the user agent producing a <a data-link-type="dfn" href="https://drafts.csswg.org/css-break-3/#fragment" id="ref-for-fragment⑦">fragment</a> based on <var>layoutChild</var>, <var>childLayoutConstraints</var>, and <var>childBreakToken</var>.</p>
           <li data-md="">
            <p>Let <var>targetRealm</var> be <var>generator</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm" id="ref-for-concept-global-object-realm">Realm</a>.</p>
           <li data-md="">
            <p>Let <var>result</var> be a new <code class="idl"><a data-link-type="idl" href="#layoutfragment" id="ref-for-layoutfragment②④">LayoutFragment</a></code> with:</p>
            <ul>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlinesize" id="ref-for-dom-layoutfragment-inlinesize②">inlineSize</a></code> being <var>internalFragment</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#inline-size" id="ref-for-inline-size②">inline size</a>.</p>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blocksize" id="ref-for-dom-layoutfragment-blocksize②">blockSize</a></code> being <var>internalFragment</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css-writing-modes-4/#block-size" id="ref-for-block-size②">block size</a>.</p>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-inlineoffset" id="ref-for-dom-layoutfragment-inlineoffset⑤">inlineOffset</a></code> initially set to 0.</p>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-blockoffset" id="ref-for-dom-layoutfragment-blockoffset⑤">blockOffset</a></code> initially set to 0.</p>
             <li data-md="">
              <p><code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-breaktoken" id="ref-for-dom-layoutfragment-breaktoken⑦">breakToken</a></code> being a new <code class="idl"><a data-link-type="idl" href="#childbreaktoken" id="ref-for-childbreaktoken⑤">ChildBreakToken</a></code> representing <var>layoutChild</var>’s internal break token.</p>
             <li data-md="">
              <p>If <var>internalFragment</var> has a <var>clonedData</var> object stored with it, let <code class="idl"><a data-link-type="idl" href="#dom-layoutfragment-data" id="ref-for-dom-layoutfragment-data①">data</a></code> being the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/#structureddeserialize" id="ref-for-structureddeserialize">StructuredDeserialize</a>(<var>clonedData</var>, <var>targetRealm</var>), otherwise null.</p>
            </ul>
          </ol>
         <li data-md="">
          <p>If <var>result</var> is null (that is neither of the above branches was taken), return
failure, and abort all these steps.</p>
         <li data-md="">
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>result</var> to <var>results</var>.</p>
        </ol>
      </ol>
      <p>The user agent may perform the above loop out of order, and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel④">in parallel</a>. The ordering
for <var>requests</var> and <var>results</var> however <em>must</em> be consistent.</p>
      <p class="note" role="note"><span>Note:</span> This is to allow user agents to run the appropriate layout algorithm on a different
    thread, or asynchronously (e.g. time slicing layout work with other work). If the user
    agent performs the loop in parallel, the outside loop has to wait until all the cross
    thread tasks are complete before calling the generator again. It cannot return partial
    results to the author.</p>
      <ol start="4">
       <li data-md="">
        <p>Let <var>nextResult</var> be the result of calling <a data-link-type="dfn" href="https://heycam.github.io/webidl/#es-invoking-callback-functions" id="ref-for-es-invoking-callback-functions③">Invoke</a>(<code>next</code>, <var>generator</var>, <var>results</var>).</p>
        <p>If an exception is <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw" id="ref-for-dfn-throw①⑥">thrown</a> then return failure, and abort all these steps.</p>
      </ol>
     <li data-md="">
      <p>Return the result of calling <a data-link-type="dfn" href="https://tc39.github.io/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p①⓪">Get</a>(<var>nextResult</var>, <code>"value"</code>).</p>
    </ol>
   </div>
  </main>
  <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
  <h3 class="no-ref heading settled" id="conventions"><span class="content"> Document conventions</span><a class="self-link" href="#conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-f839f6c8">
   <a class="self-link" href="#example-f839f6c8"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
    this: <strong class="advisement"> UAs MUST provide an accessible alternative. </strong> </p>
  <h3 class="no-ref heading settled" id="conformance-classes"><span class="content"> Conformance classes</span><a class="self-link" href="#conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes: </p>
  <dl>
   <dt>style sheet 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>. 
   <dt>renderer 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that interprets the semantics of a style sheet and renders
            documents that use them. 
   <dt>authoring tool 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that writes a style sheet. 
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module. </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.) </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module. </p>
  <h3 class="no-ref heading settled" id="partial"><span class="content"> Partial implementations</span><a class="self-link" href="#partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong> treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="conform-future-proofing"><span class="content"> Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS. </p>
  <h3 class="no-ref heading settled" id="testing"><span class="content"> Non-experimental implementations</span><a class="self-link" href="#testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec. </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group. </p>
  <p>
   Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> mailing list. 
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  </p>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-layoutedges-all">all</a><span>, in §3.5</span>
   <li>
    availableBlockSize
    <ul>
     <li><a href="#dom-layoutconstraints-availableblocksize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-availableblocksize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    availableInlineSize
    <ul>
     <li><a href="#dom-layoutconstraints-availableinlinesize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-availableinlinesize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    block
    <ul>
     <li><a href="#dom-layoutedgesizes-block">attribute for LayoutEdgeSizes</a><span>, in §3.5</span>
     <li><a href="#dom-childdisplaytype-block">enum-value for ChildDisplayType</a><span>, in §5.4</span>
    </ul>
   <li><a href="#dom-childdisplaytype-block">"block"</a><span>, in §5.4</span>
   <li><a href="#dom-layoutedgesizes-blockend">blockEnd</a><span>, in §3.5</span>
   <li>
    blockFragmentationOffset
    <ul>
     <li><a href="#dom-layoutconstraints-blockfragmentationoffset">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-blockfragmentationoffset">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    blockFragmentationType
    <ul>
     <li><a href="#dom-layoutconstraints-blockfragmentationtype">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-blockfragmentationtype">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li><a href="#enumdef-blockfragmentationtype">BlockFragmentationType</a><span>, in §3.3</span>
   <li><a href="#dom-layoutsizingmode-block-like">block-like</a><span>, in §5.4</span>
   <li><a href="#dom-layoutsizingmode-block-like">"block-like"</a><span>, in §5.4</span>
   <li><a href="#dom-layoutfragment-blockoffset">blockOffset</a><span>, in §3.2</span>
   <li>
    blockSize
    <ul>
     <li><a href="#dom-layoutfragment-blocksize">attribute for LayoutFragment</a><span>, in §3.2</span>
     <li><a href="#dom-fragmentresultoptions-blocksize">dict-member for FragmentResultOptions</a><span>, in §5.6</span>
    </ul>
   <li><a href="#dom-layoutedgesizes-blockstart">blockStart</a><span>, in §3.5</span>
   <li><a href="#dom-layoutedges-border">border</a><span>, in §3.5</span>
   <li>
    breakToken
    <ul>
     <li><a href="#dom-layoutfragment-breaktoken">attribute for LayoutFragment</a><span>, in §3.2</span>
     <li><a href="#dom-fragmentresultoptions-breaktoken">dict-member for FragmentResultOptions</a><span>, in §5.6</span>
    </ul>
   <li><a href="#breaktoken">BreakToken</a><span>, in §3.4</span>
   <li><a href="#dictdef-breaktokenoptions">BreakTokenOptions</a><span>, in §3.4</span>
   <li><a href="#enumdef-breaktype">BreakType</a><span>, in §3.4</span>
   <li><a href="#dom-childbreaktoken-breaktype">breakType</a><span>, in §3.4</span>
   <li><a href="#dom-childbreaktoken-child">child</a><span>, in §3.4</span>
   <li><a href="#childbreaktoken">ChildBreakToken</a><span>, in §3.4</span>
   <li>
    childBreakTokens
    <ul>
     <li><a href="#dom-breaktoken-childbreaktokens">attribute for BreakToken</a><span>, in §3.4</span>
     <li><a href="#dom-breaktokenoptions-childbreaktokens">dict-member for BreakTokenOptions</a><span>, in §3.4</span>
    </ul>
   <li><a href="#dom-layoutoptions-childdisplay">childDisplay</a><span>, in §5.4</span>
   <li><a href="#enumdef-childdisplaytype">ChildDisplayType</a><span>, in §5.4</span>
   <li><a href="#dom-fragmentresultoptions-childfragments">childFragments</a><span>, in §5.6</span>
   <li>
    child input properties
    <ul>
     <li><a href="#document-layout-definition-child-input-properties">dfn for document layout definition</a><span>, in §5.2</span>
     <li><a href="#layout-definition-child-input-properties">dfn for layout definition</a><span>, in §5.2</span>
    </ul>
   <li><a href="#child-layout">child layout</a><span>, in §3</span>
   <li><a href="#layout-definition-class-constructor">class constructor</a><span>, in §5.2</span>
   <li>
    "column"
    <ul>
     <li><a href="#dom-blockfragmentationtype-column">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-column">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li>
    column
    <ul>
     <li><a href="#dom-blockfragmentationtype-column">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-column">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li><a href="#layout-definition-constructor-valid-flag">constructor valid flag</a><span>, in §5.2</span>
   <li><a href="#current-layout">current layout</a><span>, in §3</span>
   <li>
    data
    <ul>
     <li><a href="#dom-breaktoken-data">attribute for BreakToken</a><span>, in §3.4</span>
     <li><a href="#dom-layoutconstraints-data">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutfragment-data">attribute for LayoutFragment</a><span>, in §3.2</span>
     <li><a href="#dom-breaktokenoptions-data">dict-member for BreakTokenOptions</a><span>, in §3.4</span>
     <li><a href="#dom-fragmentresultoptions-data">dict-member for FragmentResultOptions</a><span>, in §5.6</span>
     <li><a href="#dom-layoutconstraintsoptions-data">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li><a href="#determine-the-intrinsic-sizes">determine the intrinsic sizes</a><span>, in §5.6.1</span>
   <li><a href="#document-layout-definition">document layout definition</a><span>, in §5.2</span>
   <li><a href="#document-layout-definitions">document layout definitions</a><span>, in §5.4</span>
   <li>
    fixedBlockSize
    <ul>
     <li><a href="#dom-layoutconstraints-fixedblocksize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-fixedblocksize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    fixedInlineSize
    <ul>
     <li><a href="#dom-layoutconstraints-fixedinlinesize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-fixedinlinesize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li><a href="#dictdef-fragmentresultoptions">FragmentResultOptions</a><span>, in §5.6</span>
   <li><a href="#generate-a-fragment">generate a fragment</a><span>, in §5.6.2</span>
   <li><a href="#get-a-document-layout-definition">get a document layout definition</a><span>, in §5.6.3</span>
   <li><a href="#get-a-layout-class-instance">get a layout class instance</a><span>, in §5.6.3</span>
   <li><a href="#get-a-layout-definition">get a layout definition</a><span>, in §5.6.3</span>
   <li><a href="#dom-layoutedgesizes-inline">inline</a><span>, in §3.5</span>
   <li><a href="#dom-layoutedgesizes-inlineend">inlineEnd</a><span>, in §3.5</span>
   <li><a href="#dom-layoutfragment-inlineoffset">inlineOffset</a><span>, in §3.2</span>
   <li>
    inlineSize
    <ul>
     <li><a href="#dom-layoutfragment-inlinesize">attribute for LayoutFragment</a><span>, in §3.2</span>
     <li><a href="#dom-fragmentresultoptions-inlinesize">dict-member for FragmentResultOptions</a><span>, in §5.6</span>
    </ul>
   <li><a href="#dom-layoutedgesizes-inlinestart">inlineStart</a><span>, in §3.5</span>
   <li>
    input properties
    <ul>
     <li><a href="#document-layout-definition-input-properties">dfn for document layout definition</a><span>, in §5.2</span>
     <li><a href="#layout-definition-input-properties">dfn for layout definition</a><span>, in §5.2</span>
    </ul>
   <li><a href="#intrinsicsizes">IntrinsicSizes</a><span>, in §5.6</span>
   <li><a href="#dom-layoutchild-intrinsicsizes">intrinsicSizes()</a><span>, in §3.1</span>
   <li><a href="#layout-definition-intrinsic-sizes-generator-function">intrinsic sizes generator function</a><span>, in §5.2</span>
   <li><a href="#intrinsic-sizes-invalid">intrinsic-sizes-invalid</a><span>, in §5.1</span>
   <li><a href="#intrinsicsizesrequest">IntrinsicSizesRequest</a><span>, in §5.5</span>
   <li><a href="#dictdef-intrinsicsizesresultoptions">IntrinsicSizesResultOptions</a><span>, in §5.6</span>
   <li><a href="#intrinsic-sizes-valid">intrinsic-sizes-valid</a><span>, in §5.1</span>
   <li><a href="#intrinsic-sizes-valid-flag">intrinsic sizes valid flag</a><span>, in §5.1</span>
   <li><a href="#invoke-a-intrinsic-sizes-callback">invoke a intrinsic sizes callback</a><span>, in §5.6.1</span>
   <li><a href="#invoke-a-layout-callback">invoke a layout callback</a><span>, in §5.6.2</span>
   <li><a href="#valdef-display-layout">layout()</a><span>, in §2</span>
   <li><a href="#layout-api-children">layout API children</a><span>, in §2</span>
   <li><a href="#layout-api-container">layout API container</a><span>, in §2</span>
   <li><a href="#layout-api-formatting-context">layout API formatting context</a><span>, in §2</span>
   <li><a href="#layoutchild">LayoutChild</a><span>, in §3.1</span>
   <li><a href="#layout-class-instances">layout class instances</a><span>, in §5.4</span>
   <li><a href="#dom-layoutconstraints-layoutconstraints">LayoutConstraints()</a><span>, in §3.3</span>
   <li><a href="#layoutconstraints">LayoutConstraints</a><span>, in §3.3</span>
   <li><a href="#dictdef-layoutconstraintsoptions">LayoutConstraintsOptions</a><span>, in §3.3</span>
   <li><a href="#dom-layoutconstraints-layoutconstraints">LayoutConstraints(options)</a><span>, in §3.3</span>
   <li><a href="#layout-definition">layout definition</a><span>, in §5.2</span>
   <li><a href="#layout-definitions">layout definitions</a><span>, in §5.4</span>
   <li><a href="#layoutedges">LayoutEdges</a><span>, in §3.5</span>
   <li><a href="#layoutedgesizes">LayoutEdgeSizes</a><span>, in §3.5</span>
   <li><a href="#layoutfragment">LayoutFragment</a><span>, in §3.2</span>
   <li><a href="#layoutfragmentrequest">LayoutFragmentRequest</a><span>, in §5.5</span>
   <li><a href="#layout-definition-layout-generator-function">layout generator function</a><span>, in §5.2</span>
   <li><a href="#layout-invalid">layout-invalid</a><span>, in §5.1</span>
   <li><a href="#layout-name-to-child-input-properties-map">layout name to child input properties map</a><span>, in §5.1</span>
   <li><a href="#layout-name-to-input-properties-map">layout name to input properties map</a><span>, in §5.1</span>
   <li><a href="#dom-layoutchild-layoutnextfragment">layoutNextFragment(constraints, breakToken)</a><span>, in §3.1</span>
   <li>
    layout options
    <ul>
     <li><a href="#document-layout-definition-layout-options">dfn for document layout definition</a><span>, in §5.2</span>
     <li><a href="#layout-definition-layout-options">dfn for layout definition</a><span>, in §5.2</span>
    </ul>
   <li><a href="#dictdef-layoutoptions">LayoutOptions</a><span>, in §5.4</span>
   <li><a href="#enumdef-layoutsizingmode">LayoutSizingMode</a><span>, in §5.4</span>
   <li><a href="#layout-valid">layout-valid</a><span>, in §5.1</span>
   <li><a href="#layout-valid-flag">layout valid flag</a><span>, in §5.1</span>
   <li><a href="#dom-css-layoutworklet">layoutWorklet</a><span>, in §5.3</span>
   <li><a href="#layoutworkletglobalscope">LayoutWorkletGlobalScope</a><span>, in §5.3</span>
   <li><a href="#dom-breaktype-line">"line"</a><span>, in §3.4</span>
   <li><a href="#dom-breaktype-line">line</a><span>, in §3.4</span>
   <li><a href="#dom-layoutsizingmode-manual">"manual"</a><span>, in §5.4</span>
   <li><a href="#dom-layoutsizingmode-manual">manual</a><span>, in §5.4</span>
   <li>
    maxContentSize
    <ul>
     <li><a href="#dom-intrinsicsizes-maxcontentsize">attribute for IntrinsicSizes</a><span>, in §5.6</span>
     <li><a href="#dom-intrinsicsizesresultoptions-maxcontentsize">dict-member for IntrinsicSizesResultOptions</a><span>, in §5.6</span>
    </ul>
   <li>
    minContentSize
    <ul>
     <li><a href="#dom-intrinsicsizes-mincontentsize">attribute for IntrinsicSizes</a><span>, in §5.6</span>
     <li><a href="#dom-intrinsicsizesresultoptions-mincontentsize">dict-member for IntrinsicSizesResultOptions</a><span>, in §5.6</span>
    </ul>
   <li>
    "none"
    <ul>
     <li><a href="#dom-blockfragmentationtype-none">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-none">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li>
    none
    <ul>
     <li><a href="#dom-blockfragmentationtype-none">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-none">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li><a href="#dom-childdisplaytype-normal">"normal"</a><span>, in §5.4</span>
   <li><a href="#dom-childdisplaytype-normal">normal</a><span>, in §5.4</span>
   <li><a href="#dom-layoutedges-padding">padding</a><span>, in §3.5</span>
   <li>
    page
    <ul>
     <li><a href="#dom-blockfragmentationtype-page">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-page">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li>
    "page"
    <ul>
     <li><a href="#dom-blockfragmentationtype-page">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-page">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li><a href="#parent-layout">parent layout</a><span>, in §3</span>
   <li>
    percentageBlockSize
    <ul>
     <li><a href="#dom-layoutconstraints-percentageblocksize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-percentageblocksize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    percentageInlineSize
    <ul>
     <li><a href="#dom-layoutconstraints-percentageinlinesize">attribute for LayoutConstraints</a><span>, in §3.3</span>
     <li><a href="#dom-layoutconstraintsoptions-percentageinlinesize">dict-member for LayoutConstraintsOptions</a><span>, in §3.3</span>
    </ul>
   <li>
    "region"
    <ul>
     <li><a href="#dom-blockfragmentationtype-region">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-region">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li>
    region
    <ul>
     <li><a href="#dom-blockfragmentationtype-region">enum-value for BlockFragmentationType</a><span>, in §3.3</span>
     <li><a href="#dom-breaktype-region">enum-value for BreakType</a><span>, in §3.4</span>
    </ul>
   <li><a href="#dom-layoutworkletglobalscope-registerlayout">registerLayout(name, layoutCtor)</a><span>, in §5.4</span>
   <li><a href="#run-a-generator">run a generator</a><span>, in §5.6.3</span>
   <li><a href="#dom-layoutedges-scrollbar">scrollbar</a><span>, in §3.5</span>
   <li><a href="#dom-layoutoptions-sizing">sizing</a><span>, in §5.4</span>
   <li><a href="#dom-layoutchild-stylemap">styleMap</a><span>, in §3.1</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[css-backgrounds-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-bottom-width">border-bottom-width</a>
     <li><a href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-left-width">border-left-width</a>
     <li><a href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-right-width">border-right-width</a>
     <li><a href="https://drafts.csswg.org/css-backgrounds-3/#propdef-border-top-width">border-top-width</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-break-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-break-3/#propdef-break-inside">break-inside</a>
     <li><a href="https://drafts.csswg.org/css-break-3/#fragment">fragment</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-cascade-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-cascade-4/#computed-value">computed value</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-flexbox-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-flexbox-1/#flex-container">flex container</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-grid-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-grid-1/#grid-container">grid container</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-inline-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-inline-3/#root-inline-box">root inline box</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-overflow-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow">overflow</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-x">overflow-x</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#propdef-overflow-y">overflow-y</a>
     <li><a href="https://drafts.csswg.org/css-overflow-3/#scrollable-overflow">scrollable overflow</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-page-floats-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-page-floats-3/#float">float</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-position-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-position-3/#valdef-z-index-auto">auto</a>
     <li><a href="https://drafts.csswg.org/css-position-3/#propdef-position">position</a>
     <li><a href="https://drafts.csswg.org/css-position-3/#relative-position">relatively position</a>
     <li><a href="https://drafts.csswg.org/css-position-3/#valdef-position-static">static</a>
     <li><a href="https://drafts.csswg.org/css-position-3/#propdef-z-index">z-index</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-pseudo-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-pseudo-4/#selectordef-after">::after</a>
     <li><a href="https://drafts.csswg.org/css-pseudo-4/#selectordef-before">::before</a>
     <li><a href="https://drafts.csswg.org/css-pseudo-4/#selectordef-first-letter">::first-letter</a>
     <li><a href="https://drafts.csswg.org/css-pseudo-4/#selectordef-first-line">::first-line</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-sizing-3]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-sizing-3/#valdef-width-auto">auto</a>
     <li><a href="https://drafts.csswg.org/css-sizing-3/#available">available space</a>
     <li><a href="https://drafts.csswg.org/css-sizing-3/#max-content">max-content size</a>
     <li><a href="https://drafts.csswg.org/css-sizing-3/#min-content">min-content size</a>
     <li><a href="https://drafts.csswg.org/css-sizing-3/#stretch-fit-inline-size">stretch-fit inline size</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-typed-om-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly">StylePropertyMapReadOnly</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-values-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-values-4/#typedef-ident">&lt;ident></a>
    </ul>
   <li>
    <a data-link-type="biblio">[css-writing-modes-4]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-writing-modes-4/#abstract-dimensions">abstract dimensions</a>
     <li><a href="https://drafts.csswg.org/css-writing-modes-4/#block-size">block size</a>
     <li><a href="https://drafts.csswg.org/css-writing-modes-4/#block-start">block-start</a>
     <li><a href="https://drafts.csswg.org/css-writing-modes-4/#inline-size">inline size</a>
     <li><a href="https://drafts.csswg.org/css-writing-modes-4/#inline-start">inline-start</a>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS22]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-height">height</a>
     <li><a href="https://drafts.csswg.org/css2/box.html#propdef-margin">margin</a>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-max-height">max-height</a>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-max-width">max-width</a>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-min-height">min-height</a>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-min-width">min-width</a>
     <li><a href="https://drafts.csswg.org/css2/box.html#propdef-padding-bottom">padding-bottom</a>
     <li><a href="https://drafts.csswg.org/css2/box.html#propdef-padding-left">padding-left</a>
     <li><a href="https://drafts.csswg.org/css2/box.html#propdef-padding-right">padding-right</a>
     <li><a href="https://drafts.csswg.org/css2/box.html#propdef-padding-top">padding-top</a>
     <li><a href="https://drafts.csswg.org/css2/visudet.html#propdef-width">width</a>
    </ul>
   <li>
    <a data-link-type="biblio">[css3-display]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/css-display-3/#typedef-display-inside">&lt;display-inside></a>
     <li><a href="https://drafts.csswg.org/css-display-3/#typedef-display-outside">&lt;display-outside></a>
     <li><a href="https://drafts.csswg.org/css-display-3/#css-anonymous">anonymous box</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#atomic-inline">atomic inline</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#block-box">block box</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#block-formatting-context">block formatting context</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#block-level">block-level</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#blockify">blockification</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#blockify">blockify</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#css-box">box</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#css-box-tree">box tree</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#containing-block">containing block</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#propdef-display">display</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#valdef-display-grid">grid</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#valdef-display-inline">inline</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#inline-box">inline box</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#inline-formatting-context">inline formatting context</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#inline-level">inline-level</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#inlinify">inlinify</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#valdef-display-none">none</a>
     <li><a href="https://drafts.csswg.org/css-display-3/#replaced-element">replaced element</a>
    </ul>
   <li>
    <a data-link-type="biblio">[cssom-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.csswg.org/cssom-1/#css">CSS</a>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><a href="https://dom.spec.whatwg.org/#concept-document">document</a>
     <li><a href="https://dom.spec.whatwg.org/#concept-element">element</a>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">in parallel</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">queue a task</a>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-global-object-realm">realm</a>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><a href="https://infra.spec.whatwg.org/#list-append">append</a>
     <li><a href="https://infra.spec.whatwg.org/#list-empty">empty</a>
     <li><a href="https://infra.spec.whatwg.org/#map-exists">exist</a>
     <li><a href="https://infra.spec.whatwg.org/#list-iterate">for each</a>
     <li><a href="https://infra.spec.whatwg.org/#map-get">get</a>
     <li><a href="https://infra.spec.whatwg.org/#map-key">key</a>
     <li><a href="https://infra.spec.whatwg.org/#list">list</a>
     <li><a href="https://infra.spec.whatwg.org/#ordered-map">map</a>
     <li><a href="https://infra.spec.whatwg.org/#map-set">set</a>
     <li><a href="https://infra.spec.whatwg.org/#struct">struct</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#idl-DOMString">DOMString</a>
     <li><a href="https://heycam.github.io/webidl/#Exposed">Exposed</a>
     <li><a href="https://heycam.github.io/webidl/#Global">Global</a>
     <li><a href="https://heycam.github.io/webidl/#SameObject">SameObject</a>
     <li><a href="https://heycam.github.io/webidl/#VoidFunction">VoidFunction</a>
     <li><a href="https://heycam.github.io/webidl/#idl-double">double</a>
     <li><a href="https://heycam.github.io/webidl/#dfn-throw">throw</a>
    </ul>
   <li>
    <a data-link-type="biblio">[worklets-1]</a> defines the following terms:
    <ul>
     <li><a href="https://drafts.css-houdini.org/worklets/#worklet">Worklet</a>
     <li><a href="https://drafts.css-houdini.org/worklets/#workletglobalscope">WorkletGlobalScope</a>
     <li><a href="https://drafts.css-houdini.org/worklets/#worklet-global-scope-type">worklet global scope type</a>
     <li><a href="https://drafts.css-houdini.org/worklets/#worklets-workletglobalscopes">worklet's workletglobalscopes</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-backgrounds-3">[CSS-BACKGROUNDS-3]
   <dd>Bert Bos; Elika Etemad; Brad Kemper. <a href="https://www.w3.org/TR/css-backgrounds-3/">CSS Backgrounds and Borders Module Level 3</a>. 17 October 2017. CR. URL: <a href="https://www.w3.org/TR/css-backgrounds-3/">https://www.w3.org/TR/css-backgrounds-3/</a>
   <dt id="biblio-css-break-3">[CSS-BREAK-3]
   <dd>Rossen Atanassov; Elika Etemad. <a href="https://www.w3.org/TR/css-break-3/">CSS Fragmentation Module Level 3</a>. 9 February 2017. CR. URL: <a href="https://www.w3.org/TR/css-break-3/">https://www.w3.org/TR/css-break-3/</a>
   <dt id="biblio-css-cascade-4">[CSS-CASCADE-4]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-4/">CSS Cascading and Inheritance Level 4</a>. 14 January 2016. CR. URL: <a href="https://www.w3.org/TR/css-cascade-4/">https://www.w3.org/TR/css-cascade-4/</a>
   <dt id="biblio-css-flexbox-1">[CSS-FLEXBOX-1]
   <dd>Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. <a href="https://www.w3.org/TR/css-flexbox-1/">CSS Flexible Box Layout Module Level 1</a>. 19 October 2017. CR. URL: <a href="https://www.w3.org/TR/css-flexbox-1/">https://www.w3.org/TR/css-flexbox-1/</a>
   <dt id="biblio-css-grid-1">[CSS-GRID-1]
   <dd>Tab Atkins Jr.; Elika Etemad; Rossen Atanassov. <a href="https://www.w3.org/TR/css-grid-1/">CSS Grid Layout Module Level 1</a>. 14 December 2017. CR. URL: <a href="https://www.w3.org/TR/css-grid-1/">https://www.w3.org/TR/css-grid-1/</a>
   <dt id="biblio-css-inline-3">[CSS-INLINE-3]
   <dd>Dave Cramer; Elika Etemad; Steve Zilles. <a href="https://www.w3.org/TR/css-inline-3/">CSS Inline Layout Module Level 3</a>. 24 May 2016. WD. URL: <a href="https://www.w3.org/TR/css-inline-3/">https://www.w3.org/TR/css-inline-3/</a>
   <dt id="biblio-css-overflow-3">[CSS-OVERFLOW-3]
   <dd>David Baron; Florian Rivoal. <a href="https://www.w3.org/TR/css-overflow-3/">CSS Overflow Module Level 3</a>. 31 May 2016. WD. URL: <a href="https://www.w3.org/TR/css-overflow-3/">https://www.w3.org/TR/css-overflow-3/</a>
   <dt id="biblio-css-page-floats-3">[CSS-PAGE-FLOATS-3]
   <dd>Johannes Wilm. <a href="https://www.w3.org/TR/css-page-floats-3/">CSS Page Floats</a>. 15 September 2015. WD. URL: <a href="https://www.w3.org/TR/css-page-floats-3/">https://www.w3.org/TR/css-page-floats-3/</a>
   <dt id="biblio-css-position-3">[CSS-POSITION-3]
   <dd>Rossen Atanassov; Arron Eicholz. <a href="https://www.w3.org/TR/css-position-3/">CSS Positioned Layout Module Level 3</a>. 17 May 2016. WD. URL: <a href="https://www.w3.org/TR/css-position-3/">https://www.w3.org/TR/css-position-3/</a>
   <dt id="biblio-css-pseudo-4">[CSS-PSEUDO-4]
   <dd>Daniel Glazman; Elika Etemad; Alan Stearns. <a href="https://www.w3.org/TR/css-pseudo-4/">CSS Pseudo-Elements Module Level 4</a>. 7 June 2016. WD. URL: <a href="https://www.w3.org/TR/css-pseudo-4/">https://www.w3.org/TR/css-pseudo-4/</a>
   <dt id="biblio-css-sizing-3">[CSS-SIZING-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-sizing-3/">CSS Intrinsic &amp; Extrinsic Sizing Module Level 3</a>. 4 March 2018. WD. URL: <a href="https://www.w3.org/TR/css-sizing-3/">https://www.w3.org/TR/css-sizing-3/</a>
   <dt id="biblio-css-typed-om-1">[CSS-TYPED-OM-1]
   <dd>Shane Stephens; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-typed-om-1/">CSS Typed OM Level 1</a>. 1 August 2017. WD. URL: <a href="https://www.w3.org/TR/css-typed-om-1/">https://www.w3.org/TR/css-typed-om-1/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>CSS Values and Units Module Level 4 URL: <a href="https://drafts.csswg.org/css-values-4/">https://drafts.csswg.org/css-values-4/</a>
   <dt id="biblio-css-writing-modes-4">[CSS-WRITING-MODES-4]
   <dd>Elika Etemad; Koji Ishii. <a href="https://www.w3.org/TR/css-writing-modes-4/">CSS Writing Modes Level 4</a>. 7 December 2017. WD. URL: <a href="https://www.w3.org/TR/css-writing-modes-4/">https://www.w3.org/TR/css-writing-modes-4/</a>
   <dt id="biblio-css21">[CSS21]
   <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS2/">Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. REC. URL: <a href="https://www.w3.org/TR/CSS2/">https://www.w3.org/TR/CSS2/</a>
   <dt id="biblio-css22">[CSS22]
   <dd>Bert Bos. <a href="https://www.w3.org/TR/CSS22/">Cascading Style Sheets Level 2 Revision 2 (CSS 2.2) Specification</a>. 12 April 2016. WD. URL: <a href="https://www.w3.org/TR/CSS22/">https://www.w3.org/TR/CSS22/</a>
   <dt id="biblio-css3-display">[CSS3-DISPLAY]
   <dd>Elika Etemad. <a href="https://www.w3.org/TR/css-display-3/">CSS Display Module Level 3</a>. 20 July 2017. WD. URL: <a href="https://www.w3.org/TR/css-display-3/">https://www.w3.org/TR/css-display-3/</a>
   <dt id="biblio-cssom-1">[CSSOM-1]
   <dd>Simon Pieters; Glenn Adams. <a href="https://www.w3.org/TR/cssom-1/">CSS Object Model (CSSOM)</a>. 17 March 2016. WD. URL: <a href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-worklets-1">[WORKLETS-1]
   <dd>Ian Kilpatrick. <a href="https://www.w3.org/TR/worklets-1/">Worklets Level 1</a>. 7 June 2016. WD. URL: <a href="https://www.w3.org/TR/worklets-1/">https://www.w3.org/TR/worklets-1/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css-align-3">[CSS-ALIGN-3]
   <dd>Elika Etemad; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-align-3/">CSS Box Alignment Module Level 3</a>. 6 September 2017. WD. URL: <a href="https://www.w3.org/TR/css-align-3/">https://www.w3.org/TR/css-align-3/</a>
   <dt id="biblio-css-multicol-1">[CSS-MULTICOL-1]
   <dd>Håkon Wium Lie; Florian Rivoal; Rachel Andrew. <a href="https://www.w3.org/TR/css-multicol-1/">CSS Multi-column Layout Module Level 1</a>. 5 October 2017. WD. URL: <a href="https://www.w3.org/TR/css-multicol-1/">https://www.w3.org/TR/css-multicol-1/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①③">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutchild"><code>LayoutChild</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/css-typed-om-1/#stylepropertymapreadonly" id="ref-for-stylepropertymapreadonly⑤">StylePropertyMapReadOnly</a> <a class="nv" data-readonly="" data-type="StylePropertyMapReadOnly" href="#dom-layoutchild-stylemap"><code>styleMap</code></a>;

    <a class="n" data-link-type="idl-name" href="#intrinsicsizesrequest" id="ref-for-intrinsicsizesrequest②">IntrinsicSizesRequest</a> <a class="nv" href="#dom-layoutchild-intrinsicsizes"><code>intrinsicSizes</code></a>();
    <a class="n" data-link-type="idl-name" href="#layoutfragmentrequest" id="ref-for-layoutfragmentrequest④">LayoutFragmentRequest</a> <a class="nv" href="#dom-layoutchild-layoutnextfragment"><code>layoutNextFragment</code></a>(<a class="n" data-link-type="idl-name" href="#layoutconstraints" id="ref-for-layoutconstraints⑨">LayoutConstraints</a> <a class="nv" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-constraints"><code>constraints</code></a>, <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken⑥">ChildBreakToken</a> <a class="nv" href="#dom-layoutchild-layoutnextfragment-constraints-breaktoken-breaktoken"><code>breakToken</code></a>);
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①④">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutfragment"><code>LayoutFragment</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③⓪"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutfragment-inlinesize"><code>inlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①⓪"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutfragment-blocksize"><code>blockSize</code></a>;

    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①⓪"><span class="kt">double</span></a> <a class="nv" data-type="double" href="#dom-layoutfragment-inlineoffset"><code>inlineOffset</code></a>;
    <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double③①"><span class="kt">double</span></a> <a class="nv" data-type="double" href="#dom-layoutfragment-blockoffset"><code>blockOffset</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-layoutfragment-data"><code>data</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken①①">ChildBreakToken</a>? <a class="nv" data-readonly="" data-type="ChildBreakToken?" href="#dom-layoutfragment-breaktoken"><code>breakToken</code></a>;
};

[<a class="nv" href="#dom-layoutconstraints-layoutconstraints"><code>Constructor</code></a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-layoutconstraintsoptions" id="ref-for-dictdef-layoutconstraintsoptions①">LayoutConstraintsOptions</a> <a class="nv" href="#dom-layoutconstraints-layoutconstraints-options-options"><code>options</code></a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutconstraints"><code>LayoutConstraints</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double④①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-availableinlinesize"><code>availableInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑤①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-availableblocksize"><code>availableBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑥①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-fixedinlinesize"><code>fixedInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑦①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-fixedblocksize"><code>fixedBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑧①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-percentageinlinesize"><code>percentageInlineSize</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double⑨①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutconstraints-percentageblocksize"><code>percentageBlockSize</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⓪①"><span class="kt">double</span></a>? <a class="nv" data-readonly="" data-type="double?" href="#dom-layoutconstraints-blockfragmentationoffset"><code>blockFragmentationOffset</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype②">BlockFragmentationType</a> <a class="nv" data-readonly="" data-type="BlockFragmentationType" href="#dom-layoutconstraints-blockfragmentationtype"><code>blockFragmentationType</code></a>;

    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-layoutconstraints-data"><code>data</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-layoutconstraintsoptions"><code>LayoutConstraintsOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①①①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-layoutconstraintsoptions-availableinlinesize"><code>availableInlineSize</code></a> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①②①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-layoutconstraintsoptions-availableblocksize"><code>availableBlockSize</code></a> = 0;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①③①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-fixedinlinesize"><code>fixedInlineSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①④①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-fixedblocksize"><code>fixedBlockSize</code></a>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑤①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-percentageinlinesize"><code>percentageInlineSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑥①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-percentageblocksize"><code>percentageBlockSize</code></a>;

    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑦①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-layoutconstraintsoptions-blockfragmentationoffset"><code>blockFragmentationOffset</code></a>;
    <a class="n" data-link-type="idl-name" href="#enumdef-blockfragmentationtype" id="ref-for-enumdef-blockfragmentationtype①①">BlockFragmentationType</a> <a class="nv" data-default="&quot;none&quot;" data-type="BlockFragmentationType " href="#dom-layoutconstraintsoptions-blockfragmentationtype"><code>blockFragmentationType</code></a> = "none";

    <span class="kt">any</span> <a class="nv" data-type="any " href="#dom-layoutconstraintsoptions-data"><code>data</code></a>;
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-blockfragmentationtype"><code>BlockFragmentationType</code></a> { <a class="s" href="#dom-blockfragmentationtype-none"><code>"none"</code></a>, <a class="s" href="#dom-blockfragmentationtype-page"><code>"page"</code></a>, <a class="s" href="#dom-blockfragmentationtype-column"><code>"column"</code></a>, <a class="s" href="#dom-blockfragmentationtype-region"><code>"region"</code></a> };

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#childbreaktoken"><code>ChildBreakToken</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-breaktype" id="ref-for-enumdef-breaktype①">BreakType</a> <a class="nv" data-readonly="" data-type="BreakType" href="#dom-childbreaktoken-breaktype"><code>breakType</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutchild" id="ref-for-layoutchild①⑨①">LayoutChild</a> <a class="nv" data-readonly="" data-type="LayoutChild" href="#dom-childbreaktoken-child"><code>child</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#breaktoken"><code>BreakToken</code></a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken②①">ChildBreakToken</a>> <a class="nv" data-readonly="" data-type="sequence<ChildBreakToken>" href="#dom-breaktoken-childbreaktokens"><code>childBreakTokens</code></a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">any</span> <a class="nv" data-readonly="" data-type="any" href="#dom-breaktoken-data"><code>data</code></a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-breaktokenoptions"><code>BreakTokenOptions</code></a> {
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#childbreaktoken" id="ref-for-childbreaktoken③①">ChildBreakToken</a>> <a class="nv" data-type="sequence<ChildBreakToken> " href="#dom-breaktokenoptions-childbreaktokens"><code>childBreakTokens</code></a>;
    <span class="kt">any</span> <a class="nv" data-default="null" data-type="any " href="#dom-breaktokenoptions-data"><code>data</code></a> = <span class="kt">null</span>;
};

<span class="kt">enum</span> <a class="nv" href="#enumdef-breaktype"><code>BreakType</code></a> { <a class="s" href="#dom-breaktype-none"><code>"none"</code></a>, <a class="s" href="#dom-breaktype-line"><code>"line"</code></a>, <a class="s" href="#dom-breaktype-column"><code>"column"</code></a>, <a class="s" href="#dom-breaktype-page"><code>"page"</code></a>, <a class="s" href="#dom-breaktype-region"><code>"region"</code></a> };

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutedgesizes"><code>LayoutEdgeSizes</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑧①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inlinestart"><code>inlineStart</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double①⑨①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inlineend"><code>inlineEnd</code></a>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⓪①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-blockstart"><code>blockStart</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②①①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-blockend"><code>blockEnd</code></a>;

  // Convenience attributes for the sum in one direction.
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②②①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-inline"><code>inline</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②③①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-layoutedgesizes-block"><code>block</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutedges"><code>LayoutEdges</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes⑧">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-border"><code>border</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes①①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-scrollbar"><code>scrollbar</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes②①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-padding"><code>padding</code></a>;

  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#layoutedgesizes" id="ref-for-layoutedgesizes③①">LayoutEdgeSizes</a> <a class="nv" data-readonly="" data-type="LayoutEdgeSizes" href="#dom-layoutedges-all"><code>all</code></a>;
};

<span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://drafts.csswg.org/cssom-1/#css" id="ref-for-css①">CSS</a> {
    [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SameObject" id="ref-for-SameObject①">SameObject</a>] <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet①①">Worklet</a> <a class="nv" data-readonly="" data-type="Worklet" href="#dom-css-layoutworklet"><code>layoutWorklet</code></a>;
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Global" id="ref-for-Global①">Global</a>=(<a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#worklet" id="ref-for-worklet②①">Worklet</a>,<a class="n" data-link-type="idl-name">LayoutWorklet</a>),<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutworkletglobalscope"><code>LayoutWorkletGlobalScope</code></a> : <a class="n" data-link-type="idl-name" href="https://drafts.css-houdini.org/worklets/#workletglobalscope" id="ref-for-workletglobalscope①">WorkletGlobalScope</a> {
    <span class="kt">void</span> <a class="nv idl-code" data-link-type="method" href="#dom-layoutworkletglobalscope-registerlayout" id="ref-for-dom-layoutworkletglobalscope-registerlayout①①">registerLayout</a>(<a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><span class="kt">DOMString</span></a> <a class="nv" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-name"><code>name</code></a>, <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#VoidFunction" id="ref-for-VoidFunction①">VoidFunction</a> <a class="nv" href="#dom-layoutworkletglobalscope-registerlayout-name-layoutctor-layoutctor"><code>layoutCtor</code></a>);
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">dictionary</span> <a class="nv" href="#dictdef-layoutoptions"><code>LayoutOptions</code></a> {
  <a class="n" data-link-type="idl-name" href="#enumdef-childdisplaytype" id="ref-for-enumdef-childdisplaytype①">ChildDisplayType</a> <a class="nv" data-default="&quot;block&quot;" data-type="ChildDisplayType " href="#dom-layoutoptions-childdisplay"><code>childDisplay</code></a> = "block";
  <a class="n" data-link-type="idl-name" href="#enumdef-layoutsizingmode" id="ref-for-enumdef-layoutsizingmode①">LayoutSizingMode</a> <a class="nv" data-default="&quot;block-like&quot;" data-type="LayoutSizingMode " href="#dom-layoutoptions-sizing"><code>sizing</code></a> = "block-like";
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <a class="nv" href="#enumdef-childdisplaytype"><code>ChildDisplayType</code></a> {
    <a class="s" href="#dom-childdisplaytype-block"><code>"block"</code></a>,
    <a class="s" href="#dom-childdisplaytype-normal"><code>"normal"</code></a>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⓪①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">enum</span> <a class="nv" href="#enumdef-layoutsizingmode"><code>LayoutSizingMode</code></a> {
    <a class="s" href="#dom-layoutsizingmode-block-like"><code>"block-like"</code></a>,
    <a class="s" href="#dom-layoutsizingmode-manual"><code>"manual"</code></a>,
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#layoutfragmentrequest"><code>LayoutFragmentRequest</code></a> {
  // Has internal slots:
  // [[layoutChild]] - The layout child to generate the fragment for.
  // [[layoutConstraints]] - The layout constraints object to perform layout in.
  // [[breakToken]] - The break token to resume the layout with.
};

[<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①②①">Exposed</a>=<span class="n">LayoutWorklet</span>]
<span class="kt">interface</span> <a class="nv" href="#intrinsicsizesrequest"><code>IntrinsicSizesRequest</code></a> {
  // Has internal slots:
  // [[layoutChild]] - The layout child to calculate the intrinsic sizes for.
};

// This is the final return value from the author defined layout() method.
<span class="kt">dictionary</span> <a class="nv" href="#dictdef-fragmentresultoptions"><code>FragmentResultOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②④①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-fragmentresultoptions-inlinesize"><code>inlineSize</code></a> = 0;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑤①"><span class="kt">double</span></a> <a class="nv" data-default="0" data-type="double " href="#dom-fragmentresultoptions-blocksize"><code>blockSize</code></a> = 0;
    <span class="kt">sequence</span>&lt;<a class="n" data-link-type="idl-name" href="#layoutfragment" id="ref-for-layoutfragment②③①">LayoutFragment</a>> <a class="nv" data-default="None" data-type="sequence<LayoutFragment> " href="#dom-fragmentresultoptions-childfragments"><code>childFragments</code></a> = [];
    <span class="kt">any</span> <a class="nv" data-default="null" data-type="any " href="#dom-fragmentresultoptions-data"><code>data</code></a> = <span class="kt">null</span>;
    <a class="n" data-link-type="idl-name" href="#dictdef-breaktokenoptions" id="ref-for-dictdef-breaktokenoptions①">BreakTokenOptions</a> <a class="nv" data-default="null" data-type="BreakTokenOptions " href="#dom-fragmentresultoptions-breaktoken"><code>breakToken</code></a> = <span class="kt">null</span>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-intrinsicsizesresultoptions"><code>IntrinsicSizesResultOptions</code></a> {
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑥①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-intrinsicsizesresultoptions-maxcontentsize"><code>maxContentSize</code></a>;
    <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑦①"><span class="kt">double</span></a> <a class="nv" data-type="double " href="#dom-intrinsicsizesresultoptions-mincontentsize"><code>minContentSize</code></a>;
};

<span class="kt">interface</span> <a class="nv" href="#intrinsicsizes"><code>IntrinsicSizes</code></a> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑧①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-intrinsicsizes-mincontentsize"><code>minContentSize</code></a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-double" id="ref-for-idl-double②⑨①"><span class="kt">double</span></a> <a class="nv" data-readonly="" data-type="double" href="#dom-intrinsicsizes-maxcontentsize"><code>maxContentSize</code></a>;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Explain resuming the author defined layout.<a href="#issue-288b5e83"> ↵ </a></div>
   <div class="issue">
     Issue: We need to add the ability to request baselines on the input layout constraints, and have a
    fragment returned what was asked. E.g. 
<pre class="lang-javascript highlight"><span class="kr">const</span> constraints <span class="o">=</span> <span class="p">{</span>
    inlineSize<span class="o">:</span> availableInlineSize<span class="p">,</span>
    baselines<span class="o">:</span> <span class="p">[</span><span class="s1">'alphabetic'</span><span class="p">,</span> <span class="s1">'middle'</span><span class="p">],</span>
<span class="p">};</span>

<span class="kr">const</span> fragment <span class="o">=</span> <span class="k">yield</span> child<span class="p">.</span>layoutNextFragment<span class="p">(</span>constraints<span class="p">);</span>
fragment<span class="p">.</span>baselines<span class="p">.</span>get<span class="p">(</span><span class="s1">'alphabetic'</span><span class="p">)</span> <span class="o">==</span> <span class="cm">/* something */</span><span class="p">;</span>
</pre>
    <p>Do we want this in level 1? E.g. is it better to wait for implementations of <a data-link-type="biblio" href="#biblio-css-align-3">[css-align-3]</a> before
doing this?</p>
     <a href="#issue-baada617"> ↵ </a>
   </div>
   <div class="issue"> We also want to implcitly invalidate on size and edge properties, i.e.<a href="#issue-307874b3"> ↵ </a></div>
   <div class="issue"> "normal" is a bad name?<a href="#issue-f1731294"> ↵ </a></div>
   <div class="issue"> Should <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-mincontentsize">minContentSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizes-maxcontentsize">maxContentSize</a></code> be content
    contributions instead? E.g.  minContentContribution, maxContentContribution. Should <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-mincontentsize">minContentSize</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-intrinsicsizesresultoptions-maxcontentsize">maxContentSize</a></code> be content contributions as well?<a href="#issue-eb78ed00"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="valdef-display-layout">
   <b><a href="#valdef-display-layout">#valdef-display-layout</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-valdef-display-layout">2. Layout API Containers</a>
    <li><a href="#ref-for-valdef-display-layout①">5.1. Layout Invalidation</a>
    <li><a href="#ref-for-valdef-display-layout②">5.2. Concepts</a> <a href="#ref-for-valdef-display-layout③">(2)</a>
    <li><a href="#ref-for-valdef-display-layout④">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-valdef-display-layout⑤">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-api-container">
   <b><a href="#layout-api-container">#layout-api-container</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-api-container">2. Layout API Containers</a> <a href="#ref-for-layout-api-container①">(2)</a> <a href="#ref-for-layout-api-container②">(3)</a> <a href="#ref-for-layout-api-container③">(4)</a> <a href="#ref-for-layout-api-container④">(5)</a>
    <li><a href="#ref-for-layout-api-container⑤">2.1. Layout API Container Painting</a>
    <li><a href="#ref-for-layout-api-container⑥">3.2. Layout Fragments</a> <a href="#ref-for-layout-api-container⑦">(2)</a>
    <li><a href="#ref-for-layout-api-container⑧">4.1. Sizing</a> <a href="#ref-for-layout-api-container⑨">(2)</a> <a href="#ref-for-layout-api-container①⓪">(3)</a> <a href="#ref-for-layout-api-container①①">(4)</a> <a href="#ref-for-layout-api-container①②">(5)</a>
    <li><a href="#ref-for-layout-api-container①③">4.1.1. Positioned layout sizing</a> <a href="#ref-for-layout-api-container①④">(2)</a>
    <li><a href="#ref-for-layout-api-container①⑤">4.2. Positioning</a> <a href="#ref-for-layout-api-container①⑥">(2)</a> <a href="#ref-for-layout-api-container①⑦">(3)</a>
    <li><a href="#ref-for-layout-api-container①⑧">4.3. Overflow</a> <a href="#ref-for-layout-api-container①⑨">(2)</a> <a href="#ref-for-layout-api-container②⓪">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-api-formatting-context">
   <b><a href="#layout-api-formatting-context">#layout-api-formatting-context</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-api-formatting-context">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-layout-api-formatting-context①">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-api-children">
   <b><a href="#layout-api-children">#layout-api-children</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-api-children">2.2. Box Tree Transformations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="current-layout">
   <b><a href="#current-layout">#current-layout</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-current-layout">3. Layout API Model and Terminology</a> <a href="#ref-for-current-layout①">(2)</a>
    <li><a href="#ref-for-current-layout②">3.2. Layout Fragments</a> <a href="#ref-for-current-layout③">(2)</a>
    <li><a href="#ref-for-current-layout④">3.3. Layout Constraints</a> <a href="#ref-for-current-layout⑤">(2)</a> <a href="#ref-for-current-layout⑥">(3)</a> <a href="#ref-for-current-layout⑦">(4)</a> <a href="#ref-for-current-layout⑧">(5)</a>
    <li><a href="#ref-for-current-layout⑨">4.1. Sizing</a>
    <li><a href="#ref-for-current-layout①⓪">4.4. Fragmentation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="parent-layout">
   <b><a href="#parent-layout">#parent-layout</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-parent-layout">3.3. Layout Constraints</a> <a href="#ref-for-parent-layout①">(2)</a>
    <li><a href="#ref-for-parent-layout②">4.4. Fragmentation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="child-layout">
   <b><a href="#child-layout">#child-layout</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-child-layout">3.3. Layout Constraints</a>
    <li><a href="#ref-for-child-layout①">3.4. Breaking and Fragmentation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutchild">
   <b><a href="#layoutchild">#layoutchild</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutchild">2.2. Box Tree Transformations</a> <a href="#ref-for-layoutchild①">(2)</a>
    <li><a href="#ref-for-layoutchild②">3. Layout API Model and Terminology</a>
    <li><a href="#ref-for-layoutchild③">3.1. Layout Children</a> <a href="#ref-for-layoutchild④">(2)</a> <a href="#ref-for-layoutchild⑤">(3)</a> <a href="#ref-for-layoutchild⑥">(4)</a> <a href="#ref-for-layoutchild⑦">(5)</a> <a href="#ref-for-layoutchild⑧">(6)</a> <a href="#ref-for-layoutchild⑨">(7)</a> <a href="#ref-for-layoutchild①⓪">(8)</a> <a href="#ref-for-layoutchild①①">(9)</a> <a href="#ref-for-layoutchild①②">(10)</a> <a href="#ref-for-layoutchild①③">(11)</a> <a href="#ref-for-layoutchild①④">(12)</a>
    <li><a href="#ref-for-layoutchild①⑤">3.2. Layout Fragments</a> <a href="#ref-for-layoutchild①⑥">(2)</a> <a href="#ref-for-layoutchild①⑦">(3)</a>
    <li><a href="#ref-for-layoutchild①⑧">3.3. Layout Constraints</a>
    <li><a href="#ref-for-layoutchild①⑨">3.4. Breaking and Fragmentation</a> <a href="#ref-for-layoutchild②⓪">(2)</a> <a href="#ref-for-layoutchild②①">(3)</a> <a href="#ref-for-layoutchild②②">(4)</a> <a href="#ref-for-layoutchild②③">(5)</a>
    <li><a href="#ref-for-layoutchild②④">4.2. Positioning</a> <a href="#ref-for-layoutchild②⑤">(2)</a>
    <li><a href="#ref-for-layoutchild②⑥">5.1. Layout Invalidation</a>
    <li><a href="#ref-for-layoutchild②⑦">5.5. Layout Engine</a>
    <li><a href="#ref-for-layoutchild②⑧">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-layoutchild②⑨">(2)</a>
    <li><a href="#ref-for-layoutchild③⓪">5.6.2. Generating Fragments</a> <a href="#ref-for-layoutchild③①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutchild-stylemap">
   <b><a href="#dom-layoutchild-stylemap">#dom-layoutchild-stylemap</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutchild-stylemap">3.1. Layout Children</a> <a href="#ref-for-dom-layoutchild-stylemap①">(2)</a>
    <li><a href="#ref-for-dom-layoutchild-stylemap②">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-dom-layoutchild-stylemap③">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutchild-intrinsicsizes">
   <b><a href="#dom-layoutchild-intrinsicsizes">#dom-layoutchild-intrinsicsizes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutchild-intrinsicsizes">5.5. Layout Engine</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutchild-layoutnextfragment">
   <b><a href="#dom-layoutchild-layoutnextfragment">#dom-layoutchild-layoutnextfragment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutchild-layoutnextfragment">2.2. Box Tree Transformations</a>
    <li><a href="#ref-for-dom-layoutchild-layoutnextfragment①">3.1. Layout Children</a> <a href="#ref-for-dom-layoutchild-layoutnextfragment②">(2)</a>
    <li><a href="#ref-for-dom-layoutchild-layoutnextfragment③">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutchild-layoutnextfragment④">(2)</a> <a href="#ref-for-dom-layoutchild-layoutnextfragment⑤">(3)</a> <a href="#ref-for-dom-layoutchild-layoutnextfragment⑥">(4)</a>
    <li><a href="#ref-for-dom-layoutchild-layoutnextfragment⑦">5.5. Layout Engine</a> <a href="#ref-for-dom-layoutchild-layoutnextfragment⑧">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutfragment">
   <b><a href="#layoutfragment">#layoutfragment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutfragment">2.2. Box Tree Transformations</a>
    <li><a href="#ref-for-layoutfragment①">3.1. Layout Children</a> <a href="#ref-for-layoutfragment②">(2)</a> <a href="#ref-for-layoutfragment③">(3)</a>
    <li><a href="#ref-for-layoutfragment④">3.2. Layout Fragments</a> <a href="#ref-for-layoutfragment⑤">(2)</a> <a href="#ref-for-layoutfragment⑥">(3)</a> <a href="#ref-for-layoutfragment⑦">(4)</a> <a href="#ref-for-layoutfragment⑧">(5)</a> <a href="#ref-for-layoutfragment⑨">(6)</a> <a href="#ref-for-layoutfragment①⓪">(7)</a>
    <li><a href="#ref-for-layoutfragment①①">3.3. Layout Constraints</a> <a href="#ref-for-layoutfragment①②">(2)</a> <a href="#ref-for-layoutfragment①③">(3)</a> <a href="#ref-for-layoutfragment①④">(4)</a>
    <li><a href="#ref-for-layoutfragment①⑤">3.4. Breaking and Fragmentation</a> <a href="#ref-for-layoutfragment①⑥">(2)</a> <a href="#ref-for-layoutfragment①⑦">(3)</a> <a href="#ref-for-layoutfragment①⑧">(4)</a> <a href="#ref-for-layoutfragment①⑨">(5)</a>
    <li><a href="#ref-for-layoutfragment②⓪">5.5. Layout Engine</a> <a href="#ref-for-layoutfragment②①">(2)</a> <a href="#ref-for-layoutfragment②②">(3)</a>
    <li><a href="#ref-for-layoutfragment②③">5.6. Performing Layout</a>
    <li><a href="#ref-for-layoutfragment②④">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-inlinesize">
   <b><a href="#dom-layoutfragment-inlinesize">#dom-layoutfragment-inlinesize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-inlinesize">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutfragment-inlinesize①">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-inlinesize②">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-blocksize">
   <b><a href="#dom-layoutfragment-blocksize">#dom-layoutfragment-blocksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-blocksize">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutfragment-blocksize①">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-blocksize②">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-inlineoffset">
   <b><a href="#dom-layoutfragment-inlineoffset">#dom-layoutfragment-inlineoffset</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-inlineoffset">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutfragment-inlineoffset①">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-inlineoffset②">4.2. Positioning</a> <a href="#ref-for-dom-layoutfragment-inlineoffset③">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-inlineoffset④">5.6.2. Generating Fragments</a>
    <li><a href="#ref-for-dom-layoutfragment-inlineoffset⑤">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-blockoffset">
   <b><a href="#dom-layoutfragment-blockoffset">#dom-layoutfragment-blockoffset</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-blockoffset">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutfragment-blockoffset①">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-blockoffset②">4.2. Positioning</a> <a href="#ref-for-dom-layoutfragment-blockoffset③">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-blockoffset④">5.6.2. Generating Fragments</a>
    <li><a href="#ref-for-dom-layoutfragment-blockoffset⑤">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-data">
   <b><a href="#dom-layoutfragment-data">#dom-layoutfragment-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-data">3.2. Layout Fragments</a>
    <li><a href="#ref-for-dom-layoutfragment-data①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutfragment-breaktoken">
   <b><a href="#dom-layoutfragment-breaktoken">#dom-layoutfragment-breaktoken</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutfragment-breaktoken">3.2. Layout Fragments</a> <a href="#ref-for-dom-layoutfragment-breaktoken①">(2)</a> <a href="#ref-for-dom-layoutfragment-breaktoken②">(3)</a> <a href="#ref-for-dom-layoutfragment-breaktoken③">(4)</a> <a href="#ref-for-dom-layoutfragment-breaktoken④">(5)</a>
    <li><a href="#ref-for-dom-layoutfragment-breaktoken⑤">3.4. Breaking and Fragmentation</a> <a href="#ref-for-dom-layoutfragment-breaktoken⑥">(2)</a>
    <li><a href="#ref-for-dom-layoutfragment-breaktoken⑦">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutconstraints">
   <b><a href="#layoutconstraints">#layoutconstraints</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutconstraints">3.1. Layout Children</a>
    <li><a href="#ref-for-layoutconstraints①">3.3. Layout Constraints</a> <a href="#ref-for-layoutconstraints②">(2)</a> <a href="#ref-for-layoutconstraints③">(3)</a> <a href="#ref-for-layoutconstraints④">(4)</a>
    <li><a href="#ref-for-layoutconstraints⑤">3.4. Breaking and Fragmentation</a>
    <li><a href="#ref-for-layoutconstraints⑥">4.1. Sizing</a> <a href="#ref-for-layoutconstraints⑦">(2)</a>
    <li><a href="#ref-for-layoutconstraints⑧">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-availableinlinesize">
   <b><a href="#dom-layoutconstraints-availableinlinesize">#dom-layoutconstraints-availableinlinesize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-availableinlinesize">3.3. Layout Constraints</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-availableblocksize">
   <b><a href="#dom-layoutconstraints-availableblocksize">#dom-layoutconstraints-availableblocksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-availableblocksize">3.3. Layout Constraints</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-fixedinlinesize">
   <b><a href="#dom-layoutconstraints-fixedinlinesize">#dom-layoutconstraints-fixedinlinesize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize">3.3. Layout Constraints</a>
    <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize①">4.1. Sizing</a> <a href="#ref-for-dom-layoutconstraints-fixedinlinesize②">(2)</a> <a href="#ref-for-dom-layoutconstraints-fixedinlinesize③">(3)</a> <a href="#ref-for-dom-layoutconstraints-fixedinlinesize④">(4)</a>
    <li><a href="#ref-for-dom-layoutconstraints-fixedinlinesize⑤">4.1.1. Positioned layout sizing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-fixedblocksize">
   <b><a href="#dom-layoutconstraints-fixedblocksize">#dom-layoutconstraints-fixedblocksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize">3.3. Layout Constraints</a>
    <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize①">4.1. Sizing</a> <a href="#ref-for-dom-layoutconstraints-fixedblocksize②">(2)</a> <a href="#ref-for-dom-layoutconstraints-fixedblocksize③">(3)</a> <a href="#ref-for-dom-layoutconstraints-fixedblocksize④">(4)</a>
    <li><a href="#ref-for-dom-layoutconstraints-fixedblocksize⑤">4.1.1. Positioned layout sizing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-percentageinlinesize">
   <b><a href="#dom-layoutconstraints-percentageinlinesize">#dom-layoutconstraints-percentageinlinesize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-percentageinlinesize">3.3. Layout Constraints</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-percentageblocksize">
   <b><a href="#dom-layoutconstraints-percentageblocksize">#dom-layoutconstraints-percentageblocksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-percentageblocksize">3.3. Layout Constraints</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-blockfragmentationoffset">
   <b><a href="#dom-layoutconstraints-blockfragmentationoffset">#dom-layoutconstraints-blockfragmentationoffset</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationoffset">3.3. Layout Constraints</a>
    <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationoffset①">4.4. Fragmentation</a> <a href="#ref-for-dom-layoutconstraints-blockfragmentationoffset②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutconstraints-blockfragmentationtype">
   <b><a href="#dom-layoutconstraints-blockfragmentationtype">#dom-layoutconstraints-blockfragmentationtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype">3.3. Layout Constraints</a> <a href="#ref-for-dom-layoutconstraints-blockfragmentationtype①">(2)</a>
    <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype②">3.4. Breaking and Fragmentation</a> <a href="#ref-for-dom-layoutconstraints-blockfragmentationtype③">(2)</a>
    <li><a href="#ref-for-dom-layoutconstraints-blockfragmentationtype④">4.4. Fragmentation</a> <a href="#ref-for-dom-layoutconstraints-blockfragmentationtype⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-layoutconstraintsoptions">
   <b><a href="#dictdef-layoutconstraintsoptions">#dictdef-layoutconstraintsoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-layoutconstraintsoptions">3.3. Layout Constraints</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-blockfragmentationtype">
   <b><a href="#enumdef-blockfragmentationtype">#enumdef-blockfragmentationtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-blockfragmentationtype">3.3. Layout Constraints</a> <a href="#ref-for-enumdef-blockfragmentationtype①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="childbreaktoken">
   <b><a href="#childbreaktoken">#childbreaktoken</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-childbreaktoken">3.1. Layout Children</a>
    <li><a href="#ref-for-childbreaktoken①">3.2. Layout Fragments</a>
    <li><a href="#ref-for-childbreaktoken②">3.4. Breaking and Fragmentation</a> <a href="#ref-for-childbreaktoken③">(2)</a> <a href="#ref-for-childbreaktoken④">(3)</a>
    <li><a href="#ref-for-childbreaktoken⑤">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="breaktoken">
   <b><a href="#breaktoken">#breaktoken</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-breaktoken">3.4. Breaking and Fragmentation</a> <a href="#ref-for-breaktoken①">(2)</a>
    <li><a href="#ref-for-breaktoken②">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-breaktokenoptions">
   <b><a href="#dictdef-breaktokenoptions">#dictdef-breaktokenoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-breaktokenoptions">5.6. Performing Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-breaktype">
   <b><a href="#enumdef-breaktype">#enumdef-breaktype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-breaktype">3.4. Breaking and Fragmentation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutedgesizes">
   <b><a href="#layoutedgesizes">#layoutedgesizes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutedgesizes">3.5. Edges</a> <a href="#ref-for-layoutedgesizes①">(2)</a> <a href="#ref-for-layoutedgesizes②">(3)</a> <a href="#ref-for-layoutedgesizes③">(4)</a> <a href="#ref-for-layoutedgesizes④">(5)</a> <a href="#ref-for-layoutedgesizes⑤">(6)</a>
    <li><a href="#ref-for-layoutedgesizes⑥">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-layoutedgesizes⑦">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-inlinestart">
   <b><a href="#dom-layoutedgesizes-inlinestart">#dom-layoutedgesizes-inlinestart</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-inlinestart">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-inlineend">
   <b><a href="#dom-layoutedgesizes-inlineend">#dom-layoutedgesizes-inlineend</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-inlineend">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-blockstart">
   <b><a href="#dom-layoutedgesizes-blockstart">#dom-layoutedgesizes-blockstart</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-blockstart">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-blockend">
   <b><a href="#dom-layoutedgesizes-blockend">#dom-layoutedgesizes-blockend</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-blockend">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-inline">
   <b><a href="#dom-layoutedgesizes-inline">#dom-layoutedgesizes-inline</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-inline">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedgesizes-block">
   <b><a href="#dom-layoutedgesizes-block">#dom-layoutedgesizes-block</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedgesizes-block">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutedges">
   <b><a href="#layoutedges">#layoutedges</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutedges">3.5. Edges</a> <a href="#ref-for-layoutedges①">(2)</a> <a href="#ref-for-layoutedges②">(3)</a> <a href="#ref-for-layoutedges③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedges-border">
   <b><a href="#dom-layoutedges-border">#dom-layoutedges-border</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedges-border">3.5. Edges</a> <a href="#ref-for-dom-layoutedges-border①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedges-scrollbar">
   <b><a href="#dom-layoutedges-scrollbar">#dom-layoutedges-scrollbar</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedges-scrollbar">3.5. Edges</a> <a href="#ref-for-dom-layoutedges-scrollbar①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedges-padding">
   <b><a href="#dom-layoutedges-padding">#dom-layoutedges-padding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedges-padding">3.5. Edges</a> <a href="#ref-for-dom-layoutedges-padding①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutedges-all">
   <b><a href="#dom-layoutedges-all">#dom-layoutedges-all</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutedges-all">3.5. Edges</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-name-to-input-properties-map">
   <b><a href="#layout-name-to-input-properties-map">#layout-name-to-input-properties-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-name-to-input-properties-map">5.1. Layout Invalidation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-name-to-child-input-properties-map">
   <b><a href="#layout-name-to-child-input-properties-map">#layout-name-to-child-input-properties-map</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-name-to-child-input-properties-map">5.1. Layout Invalidation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-valid-flag">
   <b><a href="#layout-valid-flag">#layout-valid-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-valid-flag">5.1. Layout Invalidation</a> <a href="#ref-for-layout-valid-flag①">(2)</a> <a href="#ref-for-layout-valid-flag②">(3)</a> <a href="#ref-for-layout-valid-flag③">(4)</a>
    <li><a href="#ref-for-layout-valid-flag④">5.6.2. Generating Fragments</a> <a href="#ref-for-layout-valid-flag⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-valid">
   <b><a href="#layout-valid">#layout-valid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-valid">5.6.2. Generating Fragments</a> <a href="#ref-for-layout-valid①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-invalid">
   <b><a href="#layout-invalid">#layout-invalid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-invalid">5.1. Layout Invalidation</a> <a href="#ref-for-layout-invalid①">(2)</a> <a href="#ref-for-layout-invalid②">(3)</a> <a href="#ref-for-layout-invalid③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intrinsic-sizes-valid-flag">
   <b><a href="#intrinsic-sizes-valid-flag">#intrinsic-sizes-valid-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intrinsic-sizes-valid-flag">5.1. Layout Invalidation</a> <a href="#ref-for-intrinsic-sizes-valid-flag①">(2)</a> <a href="#ref-for-intrinsic-sizes-valid-flag②">(3)</a>
    <li><a href="#ref-for-intrinsic-sizes-valid-flag③">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-intrinsic-sizes-valid-flag④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intrinsic-sizes-valid">
   <b><a href="#intrinsic-sizes-valid">#intrinsic-sizes-valid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intrinsic-sizes-valid">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-intrinsic-sizes-valid①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intrinsic-sizes-invalid">
   <b><a href="#intrinsic-sizes-invalid">#intrinsic-sizes-invalid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intrinsic-sizes-invalid">5.1. Layout Invalidation</a> <a href="#ref-for-intrinsic-sizes-invalid①">(2)</a> <a href="#ref-for-intrinsic-sizes-invalid②">(3)</a> <a href="#ref-for-intrinsic-sizes-invalid③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition">
   <b><a href="#layout-definition">#layout-definition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition">5.4. Registering A Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-class-constructor">
   <b><a href="#layout-definition-class-constructor">#layout-definition-class-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-class-constructor">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-class-constructor①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-layout-generator-function">
   <b><a href="#layout-definition-layout-generator-function">#layout-definition-layout-generator-function</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-layout-generator-function">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-layout-generator-function①">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-intrinsic-sizes-generator-function">
   <b><a href="#layout-definition-intrinsic-sizes-generator-function">#layout-definition-intrinsic-sizes-generator-function</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-intrinsic-sizes-generator-function">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-intrinsic-sizes-generator-function①">5.6.1. Determining Intrinsic Sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-constructor-valid-flag">
   <b><a href="#layout-definition-constructor-valid-flag">#layout-definition-constructor-valid-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-constructor-valid-flag">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-constructor-valid-flag①">5.6.3. Utility Algorithms</a> <a href="#ref-for-layout-definition-constructor-valid-flag②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-input-properties">
   <b><a href="#layout-definition-input-properties">#layout-definition-input-properties</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-input-properties">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-input-properties①">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-layout-definition-input-properties②">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-child-input-properties">
   <b><a href="#layout-definition-child-input-properties">#layout-definition-child-input-properties</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-child-input-properties">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definition-child-input-properties①">5.6.1. Determining Intrinsic Sizes</a>
    <li><a href="#ref-for-layout-definition-child-input-properties②">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definition-layout-options">
   <b><a href="#layout-definition-layout-options">#layout-definition-layout-options</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definition-layout-options">5.4. Registering A Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-layout-definition">
   <b><a href="#document-layout-definition">#document-layout-definition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-layout-definition">5.4. Registering A Layout</a>
    <li><a href="#ref-for-document-layout-definition①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-layout-definition-input-properties">
   <b><a href="#document-layout-definition-input-properties">#document-layout-definition-input-properties</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-layout-definition-input-properties">5.4. Registering A Layout</a> <a href="#ref-for-document-layout-definition-input-properties①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-layout-definition-child-input-properties">
   <b><a href="#document-layout-definition-child-input-properties">#document-layout-definition-child-input-properties</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-layout-definition-child-input-properties">5.4. Registering A Layout</a> <a href="#ref-for-document-layout-definition-child-input-properties①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-layout-definition-layout-options">
   <b><a href="#document-layout-definition-layout-options">#document-layout-definition-layout-options</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-layout-definition-layout-options">2.2. Box Tree Transformations</a> <a href="#ref-for-document-layout-definition-layout-options①">(2)</a> <a href="#ref-for-document-layout-definition-layout-options②">(3)</a>
    <li><a href="#ref-for-document-layout-definition-layout-options③">3.4. Breaking and Fragmentation</a>
    <li><a href="#ref-for-document-layout-definition-layout-options④">4.1. Sizing</a> <a href="#ref-for-document-layout-definition-layout-options⑤">(2)</a> <a href="#ref-for-document-layout-definition-layout-options⑥">(3)</a>
    <li><a href="#ref-for-document-layout-definition-layout-options⑦">5.4. Registering A Layout</a> <a href="#ref-for-document-layout-definition-layout-options⑧">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-css-layoutworklet">
   <b><a href="#dom-css-layoutworklet">#dom-css-layoutworklet</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-css-layoutworklet">5.3. Layout Worklet</a> <a href="#ref-for-dom-css-layoutworklet①">(2)</a> <a href="#ref-for-dom-css-layoutworklet②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutworkletglobalscope">
   <b><a href="#layoutworkletglobalscope">#layoutworkletglobalscope</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutworkletglobalscope">5.2. Concepts</a>
    <li><a href="#ref-for-layoutworkletglobalscope①">5.3. Layout Worklet</a> <a href="#ref-for-layoutworkletglobalscope②">(2)</a>
    <li><a href="#ref-for-layoutworkletglobalscope③">5.4. Registering A Layout</a> <a href="#ref-for-layoutworkletglobalscope④">(2)</a> <a href="#ref-for-layoutworkletglobalscope⑤">(3)</a>
    <li><a href="#ref-for-layoutworkletglobalscope⑥">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-layoutworkletglobalscope⑦">(2)</a>
    <li><a href="#ref-for-layoutworkletglobalscope⑧">5.6.2. Generating Fragments</a> <a href="#ref-for-layoutworkletglobalscope⑨">(2)</a>
    <li><a href="#ref-for-layoutworkletglobalscope①⓪">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-layoutoptions">
   <b><a href="#dictdef-layoutoptions">#dictdef-layoutoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-layoutoptions">5.2. Concepts</a> <a href="#ref-for-dictdef-layoutoptions①">(2)</a>
    <li><a href="#ref-for-dictdef-layoutoptions②">5.4. Registering A Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutoptions-childdisplay">
   <b><a href="#dom-layoutoptions-childdisplay">#dom-layoutoptions-childdisplay</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutoptions-childdisplay">2.2. Box Tree Transformations</a> <a href="#ref-for-dom-layoutoptions-childdisplay①">(2)</a> <a href="#ref-for-dom-layoutoptions-childdisplay②">(3)</a>
    <li><a href="#ref-for-dom-layoutoptions-childdisplay③">3.4. Breaking and Fragmentation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutoptions-sizing">
   <b><a href="#dom-layoutoptions-sizing">#dom-layoutoptions-sizing</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutoptions-sizing">4.1. Sizing</a> <a href="#ref-for-dom-layoutoptions-sizing①">(2)</a> <a href="#ref-for-dom-layoutoptions-sizing②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-childdisplaytype">
   <b><a href="#enumdef-childdisplaytype">#enumdef-childdisplaytype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-childdisplaytype">5.4. Registering A Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-layoutsizingmode">
   <b><a href="#enumdef-layoutsizingmode">#enumdef-layoutsizingmode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-layoutsizingmode">5.4. Registering A Layout</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="document-layout-definitions">
   <b><a href="#document-layout-definitions">#document-layout-definitions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document-layout-definitions">5.4. Registering A Layout</a>
    <li><a href="#ref-for-document-layout-definitions①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-definitions">
   <b><a href="#layout-definitions">#layout-definitions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-definitions">5.4. Registering A Layout</a>
    <li><a href="#ref-for-layout-definitions①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layout-class-instances">
   <b><a href="#layout-class-instances">#layout-class-instances</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layout-class-instances">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-layoutworkletglobalscope-registerlayout">
   <b><a href="#dom-layoutworkletglobalscope-registerlayout">#dom-layoutworkletglobalscope-registerlayout</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-layoutworkletglobalscope-registerlayout">5.1. Layout Invalidation</a>
    <li><a href="#ref-for-dom-layoutworkletglobalscope-registerlayout①">5.3. Layout Worklet</a>
    <li><a href="#ref-for-dom-layoutworkletglobalscope-registerlayout②">5.4. Registering A Layout</a> <a href="#ref-for-dom-layoutworkletglobalscope-registerlayout③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="layoutfragmentrequest">
   <b><a href="#layoutfragmentrequest">#layoutfragmentrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-layoutfragmentrequest">3.1. Layout Children</a>
    <li><a href="#ref-for-layoutfragmentrequest①">5.5. Layout Engine</a> <a href="#ref-for-layoutfragmentrequest②">(2)</a>
    <li><a href="#ref-for-layoutfragmentrequest③">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intrinsicsizesrequest">
   <b><a href="#intrinsicsizesrequest">#intrinsicsizesrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intrinsicsizesrequest">3.1. Layout Children</a>
    <li><a href="#ref-for-intrinsicsizesrequest①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-fragmentresultoptions">
   <b><a href="#dictdef-fragmentresultoptions">#dictdef-fragmentresultoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-fragmentresultoptions">3.2. Layout Fragments</a>
    <li><a href="#ref-for-dictdef-fragmentresultoptions①">3.4. Breaking and Fragmentation</a>
    <li><a href="#ref-for-dictdef-fragmentresultoptions②">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fragmentresultoptions-inlinesize">
   <b><a href="#dom-fragmentresultoptions-inlinesize">#dom-fragmentresultoptions-inlinesize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fragmentresultoptions-inlinesize">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fragmentresultoptions-blocksize">
   <b><a href="#dom-fragmentresultoptions-blocksize">#dom-fragmentresultoptions-blocksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fragmentresultoptions-blocksize">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fragmentresultoptions-childfragments">
   <b><a href="#dom-fragmentresultoptions-childfragments">#dom-fragmentresultoptions-childfragments</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fragmentresultoptions-childfragments">2.1. Layout API Container Painting</a>
    <li><a href="#ref-for-dom-fragmentresultoptions-childfragments①">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fragmentresultoptions-data">
   <b><a href="#dom-fragmentresultoptions-data">#dom-fragmentresultoptions-data</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fragmentresultoptions-data">3.2. Layout Fragments</a>
    <li><a href="#ref-for-dom-fragmentresultoptions-data①">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-fragmentresultoptions-breaktoken">
   <b><a href="#dom-fragmentresultoptions-breaktoken">#dom-fragmentresultoptions-breaktoken</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fragmentresultoptions-breaktoken">3.4. Breaking and Fragmentation</a>
    <li><a href="#ref-for-dom-fragmentresultoptions-breaktoken①">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-intrinsicsizesresultoptions">
   <b><a href="#dictdef-intrinsicsizesresultoptions">#dictdef-intrinsicsizesresultoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-intrinsicsizesresultoptions">5.6.1. Determining Intrinsic Sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intrinsicsizesresultoptions-maxcontentsize">
   <b><a href="#dom-intrinsicsizesresultoptions-maxcontentsize">#dom-intrinsicsizesresultoptions-maxcontentsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intrinsicsizesresultoptions-maxcontentsize">5.6. Performing Layout</a>
    <li><a href="#ref-for-dom-intrinsicsizesresultoptions-maxcontentsize①">5.6.1. Determining Intrinsic Sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intrinsicsizesresultoptions-mincontentsize">
   <b><a href="#dom-intrinsicsizesresultoptions-mincontentsize">#dom-intrinsicsizesresultoptions-mincontentsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intrinsicsizesresultoptions-mincontentsize">5.6. Performing Layout</a>
    <li><a href="#ref-for-dom-intrinsicsizesresultoptions-mincontentsize①">5.6.1. Determining Intrinsic Sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="intrinsicsizes">
   <b><a href="#intrinsicsizes">#intrinsicsizes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-intrinsicsizes">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intrinsicsizes-mincontentsize">
   <b><a href="#dom-intrinsicsizes-mincontentsize">#dom-intrinsicsizes-mincontentsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intrinsicsizes-mincontentsize">5.6. Performing Layout</a>
    <li><a href="#ref-for-dom-intrinsicsizes-mincontentsize①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-intrinsicsizes-maxcontentsize">
   <b><a href="#dom-intrinsicsizes-maxcontentsize">#dom-intrinsicsizes-maxcontentsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-intrinsicsizes-maxcontentsize">5.6. Performing Layout</a>
    <li><a href="#ref-for-dom-intrinsicsizes-maxcontentsize①">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="determine-the-intrinsic-sizes">
   <b><a href="#determine-the-intrinsic-sizes">#determine-the-intrinsic-sizes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-determine-the-intrinsic-sizes">5.4. Registering A Layout</a>
    <li><a href="#ref-for-determine-the-intrinsic-sizes①">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-determine-the-intrinsic-sizes②">(2)</a>
    <li><a href="#ref-for-determine-the-intrinsic-sizes③">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="invoke-a-intrinsic-sizes-callback">
   <b><a href="#invoke-a-intrinsic-sizes-callback">#invoke-a-intrinsic-sizes-callback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invoke-a-intrinsic-sizes-callback">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-invoke-a-intrinsic-sizes-callback①">(2)</a>
    <li><a href="#ref-for-invoke-a-intrinsic-sizes-callback②">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generate-a-fragment">
   <b><a href="#generate-a-fragment">#generate-a-fragment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generate-a-fragment">5.4. Registering A Layout</a>
    <li><a href="#ref-for-generate-a-fragment①">5.6.2. Generating Fragments</a> <a href="#ref-for-generate-a-fragment②">(2)</a>
    <li><a href="#ref-for-generate-a-fragment③">5.6.3. Utility Algorithms</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="invoke-a-layout-callback">
   <b><a href="#invoke-a-layout-callback">#invoke-a-layout-callback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invoke-a-layout-callback">5.6.2. Generating Fragments</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-a-document-layout-definition">
   <b><a href="#get-a-document-layout-definition">#get-a-document-layout-definition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-a-document-layout-definition">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-get-a-document-layout-definition①">(2)</a>
    <li><a href="#ref-for-get-a-document-layout-definition②">5.6.2. Generating Fragments</a> <a href="#ref-for-get-a-document-layout-definition③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-a-layout-definition">
   <b><a href="#get-a-layout-definition">#get-a-layout-definition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-a-layout-definition">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-get-a-layout-definition①">(2)</a>
    <li><a href="#ref-for-get-a-layout-definition②">5.6.2. Generating Fragments</a> <a href="#ref-for-get-a-layout-definition③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-a-layout-class-instance">
   <b><a href="#get-a-layout-class-instance">#get-a-layout-class-instance</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-a-layout-class-instance">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-get-a-layout-class-instance①">(2)</a>
    <li><a href="#ref-for-get-a-layout-class-instance②">5.6.2. Generating Fragments</a> <a href="#ref-for-get-a-layout-class-instance③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="run-a-generator">
   <b><a href="#run-a-generator">#run-a-generator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-run-a-generator">5.6.1. Determining Intrinsic Sizes</a> <a href="#ref-for-run-a-generator①">(2)</a>
    <li><a href="#ref-for-run-a-generator②">5.6.2. Generating Fragments</a> <a href="#ref-for-run-a-generator③">(2)</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>