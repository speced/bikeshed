<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Content Security Policy Level 2</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <link href="http://www.w3.org/TR/CSP2/" rel="canonical">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
      table {
        text-align: left;
        margin: 20px;
        width: 100%;
        border-collapse: collapse;
      }

      tbody tr:nth-child(odd) {
        background-color: #EEE;
      }

      th {
        border-bottom: 1px solid #999;
        padding: 0.5em;
      }

      td:first-child {
        width: 30%;
        padding-right: 1em;
      }

      td {
        vertical-align: top;
        padding: 0.5em;
      }

      tbody th {
        border: 0;
        background-color: #FFF;
      }

      tr.section {
        border-top: 1px solid #999;
        vertical-align: top;
      }
    </style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1>Content Security Policy Level 2</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/webappsec/specs/CSP2/">https://w3c.github.io/webappsec/specs/CSP2/</a>
      <dt>Latest published version:
      <dd><a href="http://www.w3.org/TR/CSP2/">http://www.w3.org/TR/CSP2/</a>
      <dt>Previous Versions:
      <dd><a href="http://www.w3.org/TR/2014/WD-CSP2-20140703/" rel="prev">http://www.w3.org/TR/2014/WD-CSP2-20140703/</a>
      <dd><a href="http://www.w3.org/TR/2014/WD-CSP11-20140211/" rel="prev">http://www.w3.org/TR/2014/WD-CSP11-20140211/</a>
      <dd><a href="http://www.w3.org/TR/2012/CR-CSP-20121115/" rel="prev">http://www.w3.org/TR/2012/CR-CSP-20121115/</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCSP2%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[CSP2] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="39502"><a class="p-name fn u-email email" href="mailto:w3c@adambarth.com">Adam Barth</a> (<span class="p-org org">Google Inc.</span>)
      <dd class="editor p-author h-card vcard" data-editor-id="41156"><a class="p-name fn u-email email" href="mailto:dveditz@mozilla.com">Dan Veditz</a> (<span class="p-org org">Mozilla Corporation</span>)
      <dt class="editor">Former Editor:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:brandon@hackmill.com">Brandon Sterne</a> (<span class="p-org org">formerly of Mozilla Corporation</span>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 1970 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a policy language used to declare a set of content restrictions for a web resource, and a mechanism for transmitting the policy from a server to a client where the policy is enforced.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> <strong>Changes to this document may be tracked at <a href="https://github.com/w3c/webappsec">https://github.com/w3c/webappsec</a>.</strong> </p>
   <p> The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BCSP2%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP2” in the subject,
	preferably like this:
	“[CSP2] <em>…summary of comment…</em>” </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/policies/patent-policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#changes-from-level-1"><span class="secno">1.1</span> <span class="content">Changes from Level 1</span></a>
     </ol>
    <li>
     <a href="#key-concepts"><span class="secno">2</span> <span class="content">Key Concepts and Terminology</span></a>
     <ol class="toc">
      <li><a href="#terms-defined-here"><span class="secno">2.1</span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#terms-defined-by-reference"><span class="secno">2.2</span> <span class="content">Terms defined by reference</span></a>
      <li><a href="#html-concepts"><span class="secno">2.3</span> <span class="content">Relevant Concepts from HTML</span></a>
      <li><a href="#grammar"><span class="secno">2.4</span> <span class="content">Grammatical Concepts</span></a>
     </ol>
    <li>
     <a href="#policy-delivery"><span class="secno">3</span> <span class="content">Policy Delivery</span></a>
     <ol class="toc">
      <li><a href="#content-security-policy-header-field"><span class="secno">3.1</span> <span class="content"> <code>Content-Security-Policy</code> Header Field </span></a>
      <li><a href="#content-security-policy-report-only-header-field"><span class="secno">3.2</span> <span class="content"> <code>Content-Security-Policy-Report-Only</code> Header Field </span></a>
      <li><a href="#delivery-html-meta-element"><span class="secno">3.3</span> <span class="content"> HTML <code><span>meta</span></code> Element </span></a>
      <li><a href="#enforcing-multiple-policies"><span class="secno">3.4</span> <span class="content">Enforcing multiple policies</span></a>
      <li><a href="#which-policy-applies"><span class="secno">3.5</span> <span class="content">Policy applicability</span></a>
     </ol>
    <li>
     <a href="#syntax-and-algorithms"><span class="secno">4</span> <span class="content">Syntax and Algorithms</span></a>
     <ol class="toc">
      <li>
       <a href="#policy-syntax"><span class="secno">4.1</span> <span class="content">Policy Syntax</span></a>
       <ol class="toc">
        <li><a href="#policy-parsing"><span class="secno">4.1.1</span> <span class="content">Parsing Policies</span></a>
       </ol>
      <li>
       <a href="#source-list-syntax"><span class="secno">4.2</span> <span class="content">Source List Syntax</span></a>
       <ol class="toc">
        <li><a href="#source-list-parsing"><span class="secno">4.2.1</span> <span class="content">Parsing Source Lists</span></a>
        <li>
         <a href="#match-source-expression"><span class="secno">4.2.2</span> <span class="content">Matching Source Expressions</span></a>
         <ol class="toc">
          <li><a href="#source-list-guid-matching"><span class="secno">4.2.2.1</span> <span class="content"> Security Considerations for GUID URL schemes </span></a>
          <li><a href="#source-list-path-patching"><span class="secno">4.2.2.2</span> <span class="content">Path Matching</span></a>
          <li><a href="#source-list-paths-and-redirects"><span class="secno">4.2.2.3</span> <span class="content">Paths and Redirects</span></a>
         </ol>
        <li><a href="#script-src-the-nonce-attribute"><span class="secno">4.2.3</span> <span class="content"> The <code>nonce</code> attribute </span></a>
        <li><a href="#source-list-valid-nonces"><span class="secno">4.2.4</span> <span class="content">Valid Nonces</span></a>
        <li><a href="#source-list-valid-hashes"><span class="secno">4.2.5</span> <span class="content">Valid Hashes</span></a>
       </ol>
      <li>
       <a href="#media-type-list-syntax"><span class="secno">4.3</span> <span class="content">Media Type List Syntax</span></a>
       <ol class="toc">
        <li><a href="#media-type-list-parsing"><span class="secno">4.3.1</span> <span class="content">Parsing</span></a>
        <li><a href="#media-type-list-matching"><span class="secno">4.3.2</span> <span class="content">Matching</span></a>
       </ol>
      <li><a href="#violation-reports"><span class="secno">4.4</span> <span class="content">Reporting</span></a>
     </ol>
    <li>
     <a href="#processing-model"><span class="secno">5</span> <span class="content">Processing Model</span></a>
     <ol class="toc">
      <li><a href="#processing-model-workers"><span class="secno">5.1</span> <span class="content">Workers</span></a>
      <li><a href="#processing-model-iframe-srcdoc"><span class="secno">5.2</span> <span class="content"><code>srcdoc</code> iframes</span></a>
     </ol>
    <li>
     <a href="#script-interfaces"><span class="secno">6</span> <span class="content">Script Interfaces</span></a>
     <ol class="toc">
      <li><a href="#securitypolicyviolationevent-interface"><span class="secno">6.1</span> <span class="content"> <code>SecurityPolicyViolationEvent</code> Interface </span></a>
      <li><a href="#securitypolicyviolationeventinit-interface"><span class="secno">6.2</span> <span class="content"> <code>SecurityPolicyViolationEventInit</code> Interface </span></a>
      <li><a href="#firing-securitypolicyviolationevent-events"><span class="secno">6.3</span> <span class="content">Firing Violation Events</span></a>
     </ol>
    <li>
     <a href="#directives"><span class="secno">7</span> <span class="content">Directives</span></a>
     <ol class="toc">
      <li><a href="#directive-base-uri"><span class="secno">7.1</span> <span class="content"><code>base-uri</code></span></a>
      <li>
       <a href="#directive-child-src"><span class="secno">7.2</span> <span class="content"><code>child-src</code></span></a>
       <ol class="toc">
        <li><a href="#directive-child-src-nested"><span class="secno">7.2.1</span> <span class="content">Nested Browsing Contexts</span></a>
        <li><a href="#directive-child-src-workers"><span class="secno">7.2.2</span> <span class="content">Workers</span></a>
       </ol>
      <li>
       <a href="#directive-connect-src"><span class="secno">7.3</span> <span class="content"><code>connect-src</code></span></a>
       <ol class="toc">
        <li><a href="#connect-src-usage"><span class="secno">7.3.1</span> <span class="content">Usage</span></a>
       </ol>
      <li>
       <a href="#directive-default-src"><span class="secno">7.4</span> <span class="content"><code>default-src</code></span></a>
       <ol class="toc">
        <li><a href="#default-src-usage"><span class="secno">7.4.1</span> <span class="content">Usage</span></a>
       </ol>
      <li><a href="#directive-font-src"><span class="secno">7.5</span> <span class="content"><code>font-src</code></span></a>
      <li><a href="#directive-form-action"><span class="secno">7.6</span> <span class="content"><code>form-action</code></span></a>
      <li>
       <a href="#directive-frame-ancestors"><span class="secno">7.7</span> <span class="content"><code>frame-ancestors</code></span></a>
       <ol class="toc">
        <li><a href="#frame-ancestors-and-frame-options"><span class="secno">7.7.1</span> <span class="content"> Relation to <code>X-Frame-Options</code> </span></a>
        <li><a href="#frame-ancestors-multiple-source-values"><span class="secno">7.7.2</span> <span class="content">Multiple Host Source Values</span></a>
       </ol>
      <li><a href="#directive-frame-src"><span class="secno">7.8</span> <span class="content"><code>frame-src</code></span></a>
      <li><a href="#directive-img-src"><span class="secno">7.9</span> <span class="content"><code>img-src</code></span></a>
      <li><a href="#directive-media-src"><span class="secno">7.10</span> <span class="content"><code>media-src</code></span></a>
      <li><a href="#directive-object-src"><span class="secno">7.11</span> <span class="content"><code>object-src</code></span></a>
      <li>
       <a href="#directive-plugin-types"><span class="secno">7.12</span> <span class="content"><code>plugin-types</code></span></a>
       <ol class="toc">
        <li><a href="#plugin-types-usage"><span class="secno">7.12.1</span> <span class="content">Usage</span></a>
        <li><a href="#plugin-types-predeclaration"><span class="secno">7.12.2</span> <span class="content"> Predeclaration of expected media types </span></a>
       </ol>
      <li><a href="#directive-report-uri"><span class="secno">7.13</span> <span class="content"><code>report-uri</code></span></a>
      <li>
       <a href="#directive-sandbox"><span class="secno">7.14</span> <span class="content"><code>sandbox</code></span></a>
       <ol class="toc">
        <li><a href="#sandboxing-and-workers"><span class="secno">7.14.1</span> <span class="content">Sandboxing and Workers</span></a>
        <li><a href="#sandbox-usage"><span class="secno">7.14.2</span> <span class="content">Usage</span></a>
       </ol>
      <li>
       <a href="#directive-script-src"><span class="secno">7.15</span> <span class="content"><code>script-src</code></span></a>
       <ol class="toc">
        <li><a href="#script-src-nonce-usage"><span class="secno">7.15.1</span> <span class="content"> Nonce usage for <code><span>script</span></code> elements </span></a>
        <li><a href="#script-src-hash-usage"><span class="secno">7.15.2</span> <span class="content"> Hash usage for <code><span>script</span></code> elements </span></a>
       </ol>
      <li>
       <a href="#directive-style-src"><span class="secno">7.16</span> <span class="content"><code>style-src</code></span></a>
       <ol class="toc">
        <li><a href="#style-src-nonce-usage"><span class="secno">7.16.1</span> <span class="content"> Nonce usage for <code><span>style</span></code> elements </span></a>
        <li><a href="#style-src-hash-usage"><span class="secno">7.16.2</span> <span class="content"> Hash usage for <code><span>style</span></code> elements </span></a>
       </ol>
     </ol>
    <li>
     <a href="#examples"><span class="secno">8</span> <span class="content">Examples</span></a>
     <ol class="toc">
      <li><a href="#example-policies"><span class="secno">8.1</span> <span class="content">Sample Policy Definitions</span></a>
      <li><a href="#example-violation-report"><span class="secno">8.2</span> <span class="content">Sample Violation Report</span></a>
     </ol>
    <li>
     <a href="#security-considerations"><span class="secno">9</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#security-css-parsing"><span class="secno">9.1</span> <span class="content">Cascading Style Sheet (CSS) Parsing</span></a>
      <li><a href="#security-redirects"><span class="secno">9.2</span> <span class="content">Redirect Information Leakage</span></a>
     </ol>
    <li>
     <a href="#implementation-considerations"><span class="secno">10</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#complications"><span class="secno">10.1</span> <span class="content">Processing Complications</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">11</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-content-security-policy"><span class="secno">11.1</span> <span class="content">Content-Security-Policy</span></a>
      <li><a href="#iana-content-security-policy-report-only"><span class="secno">11.2</span> <span class="content">Content-Security-Policy-Report-Only</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">12</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>This document defines Content Security Policy, a mechanism web applications
  can use to mitigate a broad class of content injection vulnerabilities, such
  as cross-site scripting (XSS). Content Security Policy is a declarative policy
  that lets the authors (or server administrators) of a web application inform
  the client about the sources from which the application expects to load
  resources.</p>
    <p>To mitigate XSS attacks, for example, a web application can declare that it
  only expects to load script from specific, trusted sources. This declaration
  allows the client to detect and block malicious scripts injected into the
  application by an attacker.</p>
    <p>Content Security Policy (CSP) is not intended as a first line of defense
  against content injection vulnerabilities. Instead, CSP is best used as
  defense-in-depth, to reduce the harm caused by content injection attacks. As
  a first line of defense against content injection, server operators should
  validate their input and encode their output.</p>
    <p>There is often a non-trivial amount of work required to apply CSP to an
  existing web application. To reap the greatest benefit, authors will need to
  move all inline script and style out-of-line, for example into external
  scripts, because the user agent cannot determine whether an inline script
  was injected by an attacker.</p>
    <p>To take advantage of CSP, a web application opts into using CSP by supplying a <code>Content-Security-Policy</code> HTTP header. Such policies apply to the
  current resource representation only. To supply a policy for an entire site,
  the server needs to supply a policy with each resource representation.</p>
    <h3 class="heading settled" data-level="1.1" id="changes-from-level-1"><span class="secno">1.1. </span><span class="content">Changes from Level 1</span><a class="self-link" href="#changes-from-level-1"></a></h3>
    <p>This document describes an evolution of the <a href="http://www.w3.org/TR/CSP/">Content Security Policy specification</a>.
  Level 2 makes two breaking changes from Level 1, and adds support for a number
  of new directives and capabilities which are summarized below:</p>
    <ol>
     <li>
       The following changes are backwards incompatible with the majority of
      user agent’s implementations of Level 2: 
      <ol>
       <li>
         The path component of a source expression is now ignored if the
          resource being loaded is the result of a redirect, as described in <a href="#source-list-paths-and-redirects">§ 4.2.2.3 Paths and Redirects</a>. 
        <p class="note" role="note"><span class="marker">Note:</span> Paths are technically new in Level 2, but they were already
          implemented in many user agents before this revision of CSP was
          completed, so noting the change here seems reasonable.</p>
       <li> A <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource">protected resource</a>’s ability to load Workers <a data-link-type="biblio" href="#biblio-workers" title="Web Workers">[WORKERS]</a> is now controlled via <a data-link-type="dfn" href="#child-src" id="ref-for-child-src"><code>child-src</code></a> rather than <a data-link-type="dfn" href="#script-src" id="ref-for-script-src"><code>script-src</code></a>. 
       <li> Workers now have their own policy, separate from the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①">protected
          resource</a> which loaded them. This is described in <a href="#processing-model-workers">§ 5.1 Workers</a>. 
      </ol>
     <li>
       The following directives are brand new in this revision: 
      <ol>
       <li> <a data-link-type="dfn" href="#base-uri" id="ref-for-base-uri"><code>base-uri</code></a> controls the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource②">protected
          resource</a>’s ability to specify the <a data-link-type="dfn">document base
          URL</a>. 
       <li> <a data-link-type="dfn" href="#child-src" id="ref-for-child-src①"><code>child-src</code></a> deprecates and replaces <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src"><code>frame-src</code></a>, controlling the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource③">protected
          resource</a>’s ability to embed frames, and to load Workers. 
       <li> <a data-link-type="dfn" href="#form-action" id="ref-for-form-action"><code>form-action</code></a> controls the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource④">protected
          resource</a>’s ability to submit forms. 
       <li> <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors"><code>frame-ancestors</code></a> controls the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource⑤">protected
          resource</a>’s ability be embedded in other documents. It is meant
          to supplant the <code>X-Frame-Options</code> HTTP request header. <a data-link-type="biblio" href="#biblio-rfc7034" title="HTTP Header Field X-Frame-Options">[RFC7034]</a> 
       <li> <a data-link-type="dfn" href="#plugin-types" id="ref-for-plugin-types"><code>plugin-types</code></a> controls the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource⑥">protected
          resource</a>’s ability to load specific types of plugins. 
      </ol>
     <li> Individual inline scripts and stylesheets may be whitelisted via nonces
      (as described in <a href="#source-list-valid-nonces">§ 4.2.4 Valid Nonces</a>) and hashes (as described
      in <a href="#source-list-valid-hashes">§ 4.2.5 Valid Hashes</a>). 
     <li> A <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent">SecurityPolicyViolationEvent</a></code> is fired upon violations, as described
      in <a href="#firing-securitypolicyviolationevent-events">§ 6.3 Firing Violation Events</a>. 
     <li> A number of new fields were added to violation reports (both those POSTED
      via <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri"><code>report-uri</code></a>, and those handed to the DOM via <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent①">SecurityPolicyViolationEvent</a></code> events. These include <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-statuscode" id="ref-for-dom-securitypolicyviolationevent-statuscode">statusCode</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sourcefile" id="ref-for-dom-securitypolicyviolationevent-sourcefile">sourceFile</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-linenumber" id="ref-for-dom-securitypolicyviolationevent-linenumber">lineNumber</a></code>, and <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-columnnumber" id="ref-for-dom-securitypolicyviolationevent-columnnumber">columnNumber</a></code>. 
     <li> Certain flags present in the <code><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox">sandbox</a></code> directive now
      affect Worker creation, as described in <a href="#sandboxing-and-workers">§ 7.14.1 Sandboxing and Workers</a>. 
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="key-concepts"><span class="secno">2. </span><span class="content">Key Concepts and Terminology</span><a class="self-link" href="#key-concepts"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="terms-defined-here"><span class="secno">2.1. </span><span class="content">Terms defined by this specification</span><a class="self-link" href="#terms-defined-here"></a></h3>
    <dl>
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="policy" id="security-policy">security policy</dfn> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="directive" id="security-policy-directive">security policy directive</dfn> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="directive name" id="security-policy-directive-name">security policy directive name</dfn> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="directive value" id="security-policy-directive-value">security policy directive value</dfn> 
     <dd>
       A <strong>security policy</strong> refers to both a set of security
      preferences for restrictions within which content can operate, and
      to a fragment of text that codifies or transmits these preferences.
      For example, the following string is a policy which restricts script
      and object content: 
      <div class="example" id="example-1b2ae255"><a class="self-link" href="#example-1b2ae255"></a> <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①">script-src</a> 'self'; <a data-link-type="dfn" href="#object-src" id="ref-for-object-src">object-src</a> 'none'</code> </div>
      <p>Security policies contain a set of <strong>security policy
      directives</strong> (<code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src②">script-src</a></code> and <code><a data-link-type="dfn" href="#object-src" id="ref-for-object-src①">object-src</a></code> in the example above), each responsible
      for declaring the restrictions for a particular resource type, or
      manipulating a specific aspect of the policy’s restrictions. The list
      of directives defined by this specification can be found in <a href="#directives">§ 7 Directives</a>.</p>
      <p>Each directives has a <strong>name</strong> and a <strong>value</strong>; <strong>value</strong> may be optional for some directives.
      A detailed grammar can be found in <a href="#syntax-and-algorithms">§ 4 Syntax and Algorithms</a>.</p>
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="protected-resource">protected resource</dfn> 
     <dd> A <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy">security policy</a> is applied by a user agent to a specific <a data-link-type="dfn" href="#resource-representation" id="ref-for-resource-representation">resource representation</a>, known as the <strong>protected
      resource</strong>. See <a href="#policy-delivery">§ 3 Policy Delivery</a> for details regarding
      the mechanisms by which policies may be applied to a protected
      resource. 
    </dl>
    <h3 class="heading settled" data-level="2.2" id="terms-defined-by-reference"><span class="secno">2.2. </span><span class="content">Terms defined by reference</span><a class="self-link" href="#terms-defined-by-reference"></a></h3>
    <dl>
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="globally-unique-identifier">globally unique identifier</dfn> 
     <dd>
       Defined in <a href="https://tools.ietf.org/html/rfc6454#section-2.3">Section 2.3 of
      the Origin specification</a>. <a data-link-type="biblio" href="#biblio-rfc6454" title="The Web Origin Concept">[RFC6454]</a> 
      <p class="note" role="note"><span class="marker">NOTE:</span> URLs which do not use hierarchical elements as naming authorities
      (<code>data:</code>, for instance) have <a data-link-type="dfn" href="#origin" id="ref-for-origin">origins</a> which are globally
      unique identifiers.</p>
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="http-200-response">HTTP 200 response</dfn> 
     <dd> Defined in <a href="https://tools.ietf.org/html/rfc7231#section-6.3.1">Section
      6.3.1 of HTTP/1.1 -- Semantics and Content</a>. <a data-link-type="biblio" href="#biblio-rfc7231" title="HTTP Semantics">[RFC7231]</a> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="json-object">JSON object</dfn> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="json-stringification">JSON stringification</dfn> 
     <dd> Defined in the JSON specification. <a data-link-type="biblio" href="#biblio-rfc4627" title="The JavaScript Object Notation (JSON) Data Interchange Format">[RFC4627]</a> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="origin">origin</dfn> 
     <dd> Defined by the Origin specification. <a data-link-type="biblio" href="#biblio-rfc6454" title="The Web Origin Concept">[RFC6454]</a> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-local-lt="representation" data-noexport id="resource-representation">resource representation</dfn> 
     <dd> Defined in <a href="https://tools.ietf.org/html/rfc7231#section-3">Section
      3 of HTTP/1.1 -- Semantics and Content</a>. <a data-link-type="biblio" href="#biblio-rfc7231" title="HTTP Semantics">[RFC7231]</a> 
     <dt> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="url">URL</dfn> 
     <dd> Defined by <a data-link-type="biblio" href="#biblio-url" title="URL">[URL]</a>. 
     <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sha-256">SHA-256</dfn>
     <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sha-384">SHA-384</dfn>
     <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sha-512">SHA-512</dfn>
     <dd> These digest algorithms are defined by the NIST. <a data-link-type="biblio" href="#biblio-fips180" title="FIPS-180-4">[FIPS180]</a> 
    </dl>
    <h3 class="heading settled" data-level="2.3" id="html-concepts"><span class="secno">2.3. </span><span class="content">Relevant Concepts from HTML</span><a class="self-link" href="#html-concepts"></a></h3>
    <p>The <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element" id="ref-for-the-applet-element">applet</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element" id="ref-for-the-audio-element">audio</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element">embed</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element" id="ref-for-the-img-element">img</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element" id="ref-for-the-link-element">link</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element">object</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element">script</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element" id="ref-for-the-source-element">source</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element" id="ref-for-the-track-element">track</a></code>, and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element" id="ref-for-the-video-element">video</a></code> are defined in <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a>.</p>
    <p>The terms <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#auxiliary-browsing-context" id="ref-for-auxiliary-browsing-context">auxiliary browsing contexts</a>, <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#opener-browsing-context" id="ref-for-opener-browsing-context">opener browsing context</a>, and <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context">nested browsing contexts</a> are
  defined in the HTML5 specification. <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a></p>
    <p>A <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#plugin" id="ref-for-plugin">plugin</a> is defined in the HTML5 specification. <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a></p>
    <p>The <code>&lt;&lt;@font-face>></code> Cascading Style Sheets (CSS) rule is defined
  in the CSS Fonts Module Level 3 specification. <a data-link-type="biblio" href="#biblio-css3-fonts" title="CSS Fonts Module Level 3">[CSS3-FONTS]</a></p>
    <p>The <code>XMLHttpRequest</code> object is defined in the <code>XMLHttpRequest</code> specification. <a data-link-type="biblio" href="#biblio-xmlhttprequest" title="XMLHttpRequest Level 1">[XMLHTTPREQUEST]</a></p>
    <p>The <code>WebSocket</code> object is defined in the <code>WebSocket</code> specification. <a data-link-type="biblio" href="#biblio-websockets" title="WebSockets Standard">[WEBSOCKETS]</a></p>
    <p>The <code>EventSource</code> object is defined in the <code>EventSource</code> specification. <a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a></p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="runs-a-worker">runs a worker</dfn> algorithm is <a href="http://www.w3.org/TR/workers/#run-a-worker">defined in the Web
  Workers spec</a>. <a data-link-type="biblio" href="#biblio-workers" title="Web Workers">[WORKERS]</a></p>
    <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="callable">callable</dfn> refers to an object whose interface
  has one or more <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="callers">callers</dfn> as defined in the <a href="http://www.w3.org/TR/2010/WD-WebIDL-20101021/#idl-callers">Web
  IDL</a> specification <a data-link-type="biblio" href="#biblio-webidl" title="Web IDL Standard">[WEBIDL]</a>.</p>
    <h3 class="heading settled" data-level="2.4" id="grammar"><span class="secno">2.4. </span><span class="content">Grammatical Concepts</span><a class="self-link" href="#grammar"></a></h3>
    <p>The Augmented Backus-Naur Form (ABNF) notation used in this document is
  specified in RFC5234. <a data-link-type="biblio" href="#biblio-abnf" title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</a></p>
    <p>This document also uses the ABNF extension "#rule" as defined in <a href="https://tools.ietf.org/html/rfc7230#section-7">Section 7</a> of HTTP/1.1 -- Message Syntax and Routing. <a data-link-type="biblio" href="#biblio-rfc7230" title="HTTP/1.1">[RFC7230]</a></p>
    <p>The following core rules are included by reference, as defined in <a href="https://tools.ietf.org/html/rfc5234#appendix-B.1">Appendix B.1</a> of <a data-link-type="biblio" href="#biblio-abnf" title="Augmented BNF for Syntax Specifications: ABNF">[ABNF]</a>: <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="alpha">ALPHA</dfn></code> (letters), <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="digit">DIGIT</dfn></code> (decimal 0-9), <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="wsp">WSP</dfn></code> (white space) and <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="vchar">VCHAR</dfn></code> (printing characters).</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span class="content">Policy Delivery</span><a class="self-link" href="#policy-delivery"></a></h2>
    <p>The server delivers a <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy①">policy</a> to the user agent via an HTTP response
  header (defined in <a href="#content-security-policy-header-field">§ 3.1 Content-Security-Policy Header Field</a> and <a href="#content-security-policy-report-only-header-field">§ 3.2 Content-Security-Policy-Report-Only Header Field</a>) or an HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element">meta</a></code> element (defined in <a href="#delivery-html-meta-element">§ 3.3 HTML meta Element</a>).</p>
    <section>
     <h3 class="heading settled" data-level="3.1" id="content-security-policy-header-field"><span class="secno">3.1. </span><span class="content"> <code>Content-Security-Policy</code> Header Field </span><a class="self-link" href="#content-security-policy-header-field"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="content-security-policy">Content-Security-Policy</dfn></code> header field is
    the preferred mechanism for delivering a policy. The grammar is as follows:</p>
<pre>"Content-Security-Policy:" 1#<a data-link-type="dfn" href="#policy-token" id="ref-for-policy-token">policy-token</a>
</pre>
     <p>For example, a response might include the following header field:</p>
     <div class="example" id="example-44487605"><a class="self-link" href="#example-44487605"></a> <code>Content-Security-Policy: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src③">script-src</a> 'self'</code> </div>
     <p>A server MUST NOT send more than one HTTP header field named <code>Content-Security-Policy</code> with a given <a data-link-type="dfn" href="#resource-representation" id="ref-for-resource-representation①">resource
    representation</a>.</p>
     <p>A server MAY send different <code>Content-Security-Policy</code> header field values with different <a data-link-type="dfn" href="#resource-representation" id="ref-for-resource-representation②">representations</a> of the same
    resource or with different resources.</p>
     <p>Upon receiving an HTTP response containing at least one <code>Content-Security-Policy</code> header field, the user agent
    MUST <a data-link-type="dfn" href="#enforce" id="ref-for-enforce">enforce</a> each of the policies contained in each such
    header field.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.2" id="content-security-policy-report-only-header-field"><span class="secno">3.2. </span><span class="content"> <code>Content-Security-Policy-Report-Only</code> Header Field </span><a class="self-link" href="#content-security-policy-report-only-header-field"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="content-security-policy-report-only">Content-Security-Policy-Report-Only</dfn></code> header field lets servers experiment with policies by monitoring (rather
    than enforcing) a policy. The grammar is as follows:</p>
<pre>"Content-Security-Policy-Report-Only:" 1#<a data-link-type="dfn" href="#policy-token" id="ref-for-policy-token①">policy-token</a>
</pre>
     <p>For example, server operators might wish to develop their
    security policy iteratively. The operators can deploy a report-only
    policy based on their best estimate of how their site behaves:</p>
     <div class="example" id="example-d7c1f11b">
      <a class="self-link" href="#example-d7c1f11b"></a> 
<pre>Content-Security-Policy-Report-Only: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src④">script-src</a> 'self';
                                     <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri①">report-uri</a> /csp-report-endpoint/
</pre>
     </div>
     <p>If their site violates this policy the user agent will <a data-link-type="dfn" href="#send-violation-reports" id="ref-for-send-violation-reports">send violation
    reports</a> to the URL specified in the policy’s <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri②">report-uri</a> directive, but allow the violating resources to load regardless. Once a site
    has confidence that the policy is appropriate, they can start enforcing the
    policy using the <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy">Content-Security-Policy</a></code> header field.</p>
     <p>A server MUST NOT send more than one HTTP header field named <code>Content-Security-Policy-Report-Only</code> with a given <a data-link-type="dfn" href="#resource-representation" id="ref-for-resource-representation③">resource representation</a>.</p>
     <p>A server MAY send different <code>Content-Security-Policy-Report-Only</code> header field values
    with different <a data-link-type="dfn" href="#resource-representation" id="ref-for-resource-representation④">representations</a> of the same resource or with different
    resources.</p>
     <p>Upon receiving an HTTP response containing at least one <code>Content-Security-Policy-Report-Only</code> header field, the
    user agent MUST <a data-link-type="dfn" href="#monitor" id="ref-for-monitor">monitor</a> each of the policies
    contained in each such header field.</p>
     <p class="note" role="note"><span class="marker">Note:</span> The <code><a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only">Content-Security-Policy-Report-Only</a></code> header is <em>not</em> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①">meta</a></code> element.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.3" id="delivery-html-meta-element"><span class="secno">3.3. </span><span class="content"> HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element②">meta</a></code> Element </span><a class="self-link" href="#delivery-html-meta-element"></a></h3>
     <p>The server MAY supply policy via one or more HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element③">meta</a></code> elements
    with <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv">http-equiv</a></code> attributes that are an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII case-insensitive
    match</a> for the string "<code>Content-Security-Policy</code>". For
    example:</p>
<pre class="example" id="example-5b9d2837"><a class="self-link" href="#example-5b9d2837"></a>&lt;meta http-equiv="Content-Security-Policy" content="<a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑤">script-src</a> 'self'">
</pre>
     <p>Add the following entry to the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/document-metadata.html#pragma-directives" id="ref-for-pragma-directives">pragma directives</a> for the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element④">meta</a></code> element:</p>
     <dl>
      <dt> Content security policy
        (<code>http-equiv="content-security-policy"</code>) 
      <dd>
       <ol>
        <li>If the Document’s <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-head-element" id="ref-for-the-head-element">head</a></code> element is not an ancestor of the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element⑤">meta</a></code> element, abort these steps.
        <li>If the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element⑥">meta</a></code> element lacks a <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content" id="ref-for-attr-meta-content">content</a></code> attribute, abort
          these steps.
        <li>Let <var>policy</var> be the value of the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content" id="ref-for-attr-meta-content①">content</a></code> attribute of the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element⑦">meta</a></code> element.
        <li>Let <var>directive-set</var> be the result of <a data-link-type="dfn" href="#parse-the-policy" id="ref-for-parse-the-policy">parsing <var>policy</var></a>.
        <li>
          Remove all occurrences of <code><a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri③">report-uri</a></code>, <code><a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors①">frame-ancestors</a></code>, and <code><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox①">sandbox</a></code> directives from <var>directive-set</var>. 
         <p class="note" role="note"><span class="marker">Note:</span> User agents are encouraged to issue a warning to developers
            if one or more of these directives are included in a policy
            delivered via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element⑧">meta</a></code>.</p>
        <li>Enforce each of the <a data-link-type="dfn" href="#security-policy-directive" id="ref-for-security-policy-directive">directives</a> in <var>directive-set</var>,
          as <a href="#directives">defined for each directive type</a>.
       </ol>
     </dl>
     <p>Authors are <em>strongly encouraged</em> to place <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element⑨">meta</a></code> elements as early
    in the document as possible, because policies in <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①⓪">meta</a></code> elements are not
    applied to content which precedes them. In particular, note that resources
    fetched or prefetched using the <code>Link</code> HTTP response header
    field, and resources fetched or prefetched using <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element" id="ref-for-the-link-element①">link</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element①">script</a></code> elements which precede a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①①">meta</a></code>-delivered policy will not be blocked.</p>
     <p class="note" role="note"><span class="marker">Note:</span> A <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy②">policy</a> specified via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①②">meta</a></code> element will be enforced
    along with any other policies active for the protected resource, regardless
    of where they’re specified. The general impact of enforcing multiple
    policies is described in <a href="#enforcing-multiple-policies">§ 3.4 Enforcing multiple policies</a>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> Modifications to the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content" id="ref-for-attr-meta-content②">content</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①③">meta</a></code> element
    after the element has been parsed will be ignored.</p>
     <p class="note" role="note"><span class="marker">Note:</span> The <code><a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only①">Content-Security-Policy-Report-Only</a></code> header is <em>not</em> supported inside a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①④">meta</a></code> element.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.4" id="enforcing-multiple-policies"><span class="secno">3.4. </span><span class="content">Enforcing multiple policies</span><a class="self-link" href="#enforcing-multiple-policies"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>The above sections note that when multiple policies are present,
    each must be enforced or reported, according to its type. An example
    will help clarify how that ought to work in practice. The behavior of
    an <code>XMLHttpRequest</code> might seem unclear given a site
    that, for whatever reason, delivered the following HTTP headers:</p>
<pre class="example" id="example-7bb4ce67"><a class="self-link" href="#example-7bb4ce67"></a>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src">default-src</a> 'self' http://example.com http://example.net;
                         <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src">connect-src</a> 'none';
Content-Security-Policy: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src①">connect-src</a> http://example.com/;
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑥">script-src</a> http://example.com/
</pre>
     <p>Is a connection to <code>example.com</code> allowed or not? The
    short answer is that the connection is not allowed. Enforcing both
    policies means that a potential connection would have to pass through
    both unscathed. Even though the second policy would allow this
    connection, the first policy contains <code><a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src②">connect-src</a> 'none'</code>, so its enforcement blocks the connection. The impact is
    that adding additional policies to the list of policies to enforce can
    only further restrict the capabilities of the protected resource.</p>
     <p>To demonstrate that further, consider a script tag on this page.
    The first policy would lock scripts down to <code>'self'</code>, <code>http://example.com</code> and <code>http://example.net</code> via the <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src①">default-src</a></code> directive. The second, however,
    would only allow script from <code>http://example.com/</code>. Script
    will only load if it meets both policy’s criteria: in this case, the only
    origin that can match is <code>http://example.com</code>, as both
    policies allow it.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="3.5" id="which-policy-applies"><span class="secno">3.5. </span><span class="content">Policy applicability</span><a class="self-link" href="#which-policy-applies"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>Policies are associated with an <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource⑦">protected resource</a>, and <a data-link-type="dfn" href="#enforce" id="ref-for-enforce①">enforced</a> or <a data-link-type="dfn" href="#monitor" id="ref-for-monitor①">monitored</a> for that resource.
    If a resource does not create a new execution context (for example, when
    including a script, image, or stylesheet into a document), then any policies
    delivered with that resource are discarded without effect. Its execution is
    subject to the policy or policies of the including context. The following
    table outlines examples of these relationships:</p>
     <table>
      <thead>
       <tr>
        <th colspan="2">Resource Type
        <th>What <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy③">policy</a> applies?
      <tbody>
       <tr class="section">
        <th rowspan="2">Top-level Contexts
        <td>HTML as a new, top-level browsing context
        <td>The policy delivered with the resource applies.
       <tr>
        <td>SVG, as a top-level document
        <td>The policy delivered with the resource applies.
       <tr class="section">
        <th rowspan="3">Embedded Contexts
        <td> Any resource included via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element①">object</a></code>, or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element①">embed</a></code> 
        <td> Unless the embedded resource is a globally unique identifier (or a
            srcdoc iframe), the embedded resource is controlled by the policy
            delivered with the resource. If the embedded resource is a globally
            unique identifier or srcdoc iframe, it inherits the policy of the
            context creating it.  (The frame-src and
            child-src directives of the embedding context only control
            what resources are eligible for embedding in that context, not the
            behavior of the resource once embedded.) 
       <tr>
        <td>SVG, as an embedded document
        <td> Unless the resource is a globally unique identifier,
            it is controlled by the policy
            delivered with the resource. If a globally
            unique identifier, it inherits the policy of the
            context creating it. 
       <tr>
        <td> JavaScript, as a Worker, Shared Worker, or Service Worker 
        <td> Unless the resource is a globally unique identifier,
            it is controlled by the
            policy delivered with the resource. If a globally
            unique identifier, it inherits the policy of the
            context creating it. 
       <tr class="section">
        <th rowspan="7">Subresources
        <td>SVG, inlined via <code><a data-link-type="element" href="http://www.w3.org/TR/SVG2/struct.html#SVGElement" id="ref-for-SVGElement">svg</a></code>
        <td>The policy of the including context applies.
       <tr>
        <td>SVG, as a resource document
        <td>The policy of the including context applies.
       <tr>
        <td>HTML via XMLHttpRequest
        <td>The policy of the context that performed the fetch applies.
       <tr>
        <td>Image via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element" id="ref-for-the-img-element①">img</a></code> element
        <td>The policy of the including context applies.
       <tr>
        <td>JavaScript via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element②">script</a></code> element
        <td>The policy of the including context applies.
       <tr>
        <td>SVG, via <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element" id="ref-for-the-img-element②">img</a></code>
        <td>No policy applies; this should be just as safe as JPG
       <tr>
        <td>SVG, as a WebFont
        <td>No policy applies; this should be just as safe as WOFF
     </table>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="syntax-and-algorithms"><span class="secno">4. </span><span class="content">Syntax and Algorithms</span><a class="self-link" href="#syntax-and-algorithms"></a></h2>
    <section>
     <h3 class="heading settled" data-level="4.1" id="policy-syntax"><span class="secno">4.1. </span><span class="content">Policy Syntax</span><a class="self-link" href="#policy-syntax"></a></h3>
     <p>A Content Security Policy consists of a U+003B SEMICOLON
    (<code>;</code>) delimited list of directives. Each <a data-link-type="dfn" href="#security-policy-directive" id="ref-for-security-policy-directive①">directive</a> consists of a <a data-link-type="dfn" href="#security-policy-directive-name" id="ref-for-security-policy-directive-name">directive name</a> and (optionally) a <a data-link-type="dfn" href="#security-policy-directive-value" id="ref-for-security-policy-directive-value">directive value</a>, defined by the following ABNF:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="policy-token">policy-token</dfn>    = [ <a data-link-type="dfn" href="#directive-token" id="ref-for-directive-token">directive-token</a> *( ";" [ <a data-link-type="dfn" href="#directive-token" id="ref-for-directive-token①">directive-token</a> ] ) ]
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="directive-token">directive-token</dfn> = *WSP [ <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name">directive-name</a> [ WSP <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value">directive-value</a> ] ]
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="directive-name">directive-name</dfn>  = 1*( ALPHA / DIGIT / "-" )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="directive-value">directive-value</dfn> = *( WSP / &lt;VCHAR except ";" and ","> )
</pre>
     <section>
      <h4 class="heading settled" data-level="4.1.1" id="policy-parsing"><span class="secno">4.1.1. </span><span class="content">Parsing Policies</span><a class="self-link" href="#policy-parsing"></a></h4>
      <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-the-policy">parse the policy</dfn> <var>policy</var>, the user agent MUST
      use an algorithm equivalent to the following:</p>
      <ol>
       <li>Let the <var>set of directives</var> be the empty set.
       <li>
        For each non-empty token returned by <a data-link-type="dfn">strictly splitting</a> the string <var>policy</var> on the character U+003B SEMICOLON
        (<code>;</code>): 
        <ol>
         <li><a data-link-type="dfn">Skip whitespace</a>.
         <li><a data-link-type="dfn">Collect a sequence of characters</a> that are
            not <a data-link-type="dfn">space characters</a>. The collected characters
            are the <var>directive name</var>.
         <li>If there are characters remaining in <var>token</var>,
            skip ahead exactly one character (which must be a <a data-link-type="dfn">space character</a>).
         <li>The remaining characters in <var>token</var> (if any) are
            the <var>directive value</var>.
         <li>If the <var>set of directives</var> already contains a
            directive whose name is a case insensitive match for <var>directive name</var>, ignore this instance of the directive
            and continue to the next token.
         <li>Add a <var>directive</var> to the <var>set of
            directives</var> with name <var>directive name</var> and value <var>directive value</var>.
        </ol>
       <li>Return the <var>set of directives</var>. 
      </ol>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.2" id="source-list-syntax"><span class="secno">4.2. </span><span class="content">Source List Syntax</span><a class="self-link" href="#source-list-syntax"></a></h3>
     <p>Many CSP directives use a value consisting of a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="source list" data-noexport id="source-list">source
    list</dfn>, defined in the ABNF grammar below.</p>
     <p>Each <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-expression">source expression</dfn> in the source list represents a
    location from which content of the specified type can be retrieved.
    For example, the source expression <code>'none'</code> represents
    the empty set of URLs, and the source expression <code>'unsafe-inline'</code> represents content supplied inline in the
    resource itself.</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-list①">source-list</dfn>       = *WSP [ <a data-link-type="dfn" href="#source-expression①" id="ref-for-source-expression①">source-expression</a> *( 1*WSP <a data-link-type="dfn" href="#source-expression①" id="ref-for-source-expression①①">source-expression</a> ) *WSP ]
                  / *WSP "'none'" *WSP
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-expression①">source-expression</dfn> = <a data-link-type="dfn" href="#scheme-source" id="ref-for-scheme-source">scheme-source</a> / <a data-link-type="dfn" href="#host-source" id="ref-for-host-source">host-source</a> / <a data-link-type="dfn" href="#keyword-source" id="ref-for-keyword-source">keyword-source</a> / <a data-link-type="dfn" href="#nonce-source" id="ref-for-nonce-source">nonce-source</a> / <a data-link-type="dfn" href="#hash-source" id="ref-for-hash-source">hash-source</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scheme-source">scheme-source</dfn>     = <a data-link-type="dfn" href="#scheme-part" id="ref-for-scheme-part">scheme-part</a> ":"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="host-source">host-source</dfn>       = [ <a data-link-type="dfn" href="#scheme-part" id="ref-for-scheme-part①">scheme-part</a> "://" ] <a data-link-type="dfn" href="#host-part" id="ref-for-host-part">host-part</a> [ <a data-link-type="dfn" href="#port-part" id="ref-for-port-part">port-part</a> ] [ <a data-link-type="dfn" href="#path-part" id="ref-for-path-part">path-part</a> ]
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="keyword-source">keyword-source</dfn>    = "'self'" / "'unsafe-inline'" / "'unsafe-eval'"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="base64-value">base64-value</dfn>      = 1*( ALPHA / DIGIT / "+" / "/" )*2( "=" )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="nonce-value">nonce-value</dfn>       = <a data-link-type="dfn" href="#base64-value" id="ref-for-base64-value">base64-value</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hash-value">hash-value</dfn>        = <a data-link-type="dfn" href="#base64-value" id="ref-for-base64-value①">base64-value</a>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="nonce-source">nonce-source</dfn>      = "'nonce-" <a data-link-type="dfn" href="#nonce-value" id="ref-for-nonce-value">nonce-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hash-algo">hash-algo</dfn>         = "sha256" / "sha384" / "sha512"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="hash-source">hash-source</dfn>       = "'" <a data-link-type="dfn" href="#hash-algo" id="ref-for-hash-algo">hash-algo</a> "-" <a data-link-type="dfn" href="#hash-value" id="ref-for-hash-value">hash-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="scheme-part">scheme-part</dfn>       = &lt;scheme production from <a href="https://tools.ietf.org/html/rfc3986#section-3.1">RFC 3986, section 3.1</a>>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="host-part">host-part</dfn>         = "*" / [ "*." ] 1*<a data-link-type="dfn" href="#host-char" id="ref-for-host-char">host-char</a> *( "." 1*<a data-link-type="dfn" href="#host-char" id="ref-for-host-char①">host-char</a> )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="host-char">host-char</dfn>         = ALPHA / DIGIT / "-"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="path-part">path-part</dfn>         = &lt;path production from <a href="https://tools.ietf.org/html/rfc3986#section-3.3">RFC 3986, section 3.3</a>>
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="port-part">port-part</dfn>         = ":" ( 1*DIGIT / "*" )
</pre>
     <p>If the policy contains a <code><a data-link-type="dfn" href="#nonce-source" id="ref-for-nonce-source①">nonce-source</a></code> expression, the
    server MUST generate a fresh value for the <code><a data-link-type="dfn" href="#nonce-value" id="ref-for-nonce-value①">nonce-value</a></code> directive at random and independently each time it transmits a policy.
    The generated value SHOULD be at least 128 bits long (before encoding),
    and generated via a cryptographically secure random number generator.
    This requirement ensures that the <code><a data-link-type="dfn" href="#nonce-value" id="ref-for-nonce-value②">nonce-value</a></code> is
    difficult for an attacker to predict.</p>
     <p class="note" role="note"><span class="marker">Note:</span> Using a nonce to whitelist inline script or style is less secure than
    not using a nonce, as nonces override the restrictions in the directive in
    which they are present. An attacker who can gain access to the nonce can
    execute whatever script they like, whenever they like. That said, nonces
    provide a substantial improvement over <code>'unsafe-inline'</code> when
    layering a content security policy on top of old code. When considering <code>'unsafe-inline'</code>, authors are encouraged to consider nonces (or
    hashes) instead.</p>
     <p>The <code><a data-link-type="dfn" href="#host-char" id="ref-for-host-char②">host-char</a></code> production intentionally contains only
    ASCII characters; internationalized domain names cannot be entered
    directly into a policy string, but instead MUST be Punycode-encoded <a data-link-type="biblio" href="#biblio-rfc3492" title="Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)">[RFC3492]</a>. For example, the domain <code>üüüüüü.de</code> would be
    encoded as <code>xn--tdaaaaaa.de</code>.</p>
     <p class="note" role="note"><span class="marker">NOTE:</span> Though IP addresses do match the grammar above, only <code>127.0.0.1</code> will actually match a URL when used in a source
    expression (see <a href="#match-source-expression">§ 4.2.2 Matching Source Expressions</a> for details). The security
    properties of IP addresses are suspect, and authors ought to prefer
    hostnames to IP addresses whenever possible.</p>
     <section>
      <h4 class="heading settled" data-level="4.2.1" id="source-list-parsing"><span class="secno">4.2.1. </span><span class="content">Parsing Source Lists</span><a class="self-link" href="#source-list-parsing"></a></h4>
      <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-a-source-list">parse a source list</dfn> <var>source list</var>, the user agent MUST use an algorithm
      equivalent to the following:</p>
      <ol>
       <li><a data-link-type="dfn">Strip leading and trailing whitespace</a> from <var>source list</var>.
       <li>If <var>source list</var> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①">ASCII case-insensitive match</a> for the string <code>'none'</code> (including the quotation
        marks), return the empty set.
       <li>Let <var>set of source expressions</var> be the empty
        set.
       <li>For each token returned by <a data-link-type="dfn">splitting <var>source
        list</var> on spaces</a>, if the token matches the grammar for <code><a data-link-type="dfn" href="#source-expression①" id="ref-for-source-expression①②">source-expression</a></code>, add the token to the <var>set
        of source expressions</var>.
       <li>Return the <var>set of source expressions</var>.
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> Characters like U+003B SEMICOLON (<code>;</code>) and
      U+002C COMMA (<code>,</code>) cannot appear in source expressions
      directly: if you’d like to include these characters in a source
      expression, they must be <a data-link-type="dfn">percent
      encoded</a> as <code>%3B</code> and <code>%2C</code> respectively.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.2.2" id="match-source-expression"><span class="secno">4.2.2. </span><span class="content">Matching Source Expressions</span><a class="self-link" href="#match-source-expression"></a></h4>
      <p>A URL <var>url</var> is said to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-a-source-expression">match a source expression</dfn> for
      a <var>protected resource</var> if the following algorithm returns <em>does match</em>:</p>
      <ol>
       <li> Let <var>url</var> be the result of processing the URL through the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a>. 
       <li> If the source expression consists of a single U+002A ASTERISK
          character (<code>*</code>), and <var>url</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is not
          one of <code>blob</code>, <code>data</code>, <code>filesystem</code>,
          then return <em>does match</em>. 
       <li>
         If the source expression matches the grammar for <code><a data-link-type="dfn" href="#scheme-source" id="ref-for-scheme-source①">scheme-source</a></code>: 
        <ol>
         <li> If <var>url</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②">ASCII case-insensitive
              match</a> for the source expression’s <code><a data-link-type="dfn" href="#scheme-part" id="ref-for-scheme-part②">scheme-part</a></code>, return <em>does match</em>. 
         <li> Otherwise, return <em>does not match</em>. 
        </ol>
       <li>
         If the source expression matches the grammar for <code><a data-link-type="dfn" href="#host-source" id="ref-for-host-source①">host-source</a></code>: 
        <ol>
         <li> If <var>url</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-host" id="ref-for-concept-url-host">host</a> is <code>null</code>,
              return <em>does not match</em>. 
         <li>
           Let <var>url-scheme</var>, <var>url-host</var>, and <var>url-port</var> be the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-scheme" id="ref-for-concept-url-scheme②">scheme</a>, <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-host" id="ref-for-concept-url-host①">host</a>, and <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-port" id="ref-for-concept-url-port">port</a> of <var>url</var>’s origin, respectively. 
          <p class="note" role="note"><span class="marker">Note:</span> If <var>url</var> doesn’t specify a port, then its origin’s
              port will be the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#default-port" id="ref-for-default-port">default port</a> for <var>url</var>’s <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-scheme" id="ref-for-concept-url-scheme③">scheme</a>.</p>
         <li> Let <var>url-path-list</var> be the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-path" id="ref-for-concept-url-path">path</a> of <var>url</var>. 
         <li> If the source expression has a <code><a data-link-type="dfn" href="#scheme-part" id="ref-for-scheme-part③">scheme-part</a></code> that is not a case insensitive match for <var>url-scheme</var>,
              then return <em>does not match</em>. 
         <li>
           If the source expression does <strong>not</strong> have a
              scheme, return <em>does not match</em> if any of the following
              are true: 
          <ol>
           <li> The scheme of the protected resource’s URL is a case
                  insensitive match for <code>HTTP</code>, and <var>url-scheme</var> is <strong>not</strong> a case
                  insensitive match for either <code>HTTP</code> or <code>HTTPS</code>. 
           <li> The scheme of the protected resource’s URL is <strong>not</strong> a case insensitive match for <code>HTTP</code>, and <var>url-scheme</var> is <strong>not</strong> a case insensitive match
                  for the scheme of the protected resource’s URL. 
          </ol>
         <li> If the first character of the source expression’s <code><a data-link-type="dfn" href="#host-part" id="ref-for-host-part①">host-part</a></code> is an U+002A ASTERISK character
              (<code>*</code>) and the remaining characters, including the
              leading U+002E FULL STOP character (<code>.</code>), are not a
              case insensitive match for the rightmost characters of <var>url-host</var>, then return <em>does not match</em>. 
         <li> If the first character of the source expression’s <code><a data-link-type="dfn" href="#host-part" id="ref-for-host-part②">host-part</a></code> is <em>not</em> an U+002A ASTERISK
              character (<code>*</code>) and <var>url-host</var> is not a
              case insensitive match for the source expression’s <code><a data-link-type="dfn" href="#host-part" id="ref-for-host-part③">host-part</a></code>, then return <em>does not
              match</em>. 
         <li>
           If the source expression’s <code><a data-link-type="dfn" href="#host-part" id="ref-for-host-part④">host-part</a></code> matches
              the <code><a data-link-type="dfn" href="https://tools.ietf.org/html/rfc3986#section-3.2.2" id="ref-for-section-3.2.2">IPv4address</a></code> production from <a data-link-type="biblio" href="#biblio-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">[RFC3986]</a>,
              and is not <code>127.0.0.1</code>, or is an <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-ipv6" id="ref-for-concept-ipv6">IPv6 address</a>,
              return <em>does not match</em>. 
          <p class="note" role="note"><span class="marker">Note:</span> A future version of this specification may allow literal
              IPv6 and IPv4 addresses, depending on usage and demand. Given the
              weak security properties of IP addresses in relation to named
              hosts, however, authors are encouraged to prefer the latter
              whenever possible.</p>
         <li> If the source expression does <strong>not</strong> contain
              a <code>port-part</code> and <var>url-port</var> is not the <a data-link-type="dfn" href="http://www.w3.org/TR/url/#default-port" id="ref-for-default-port①">default port</a> for <var>url-scheme</var>, then return <em>does not match</em>. 
         <li>
           If the source expression does contain a <code>port-part</code>,
              then return <em>does not match</em> if both of the following
              are true: 
          <ol>
           <li> The <code><a data-link-type="dfn" href="#port-part" id="ref-for-port-part①">port-part</a></code> does <strong>not</strong> contain an U+002A ASTERISK character. (<code>*</code>) 
           <li> The <code><a data-link-type="dfn" href="#port-part" id="ref-for-port-part②">port-part</a></code> does <strong>not</strong> represent the same number as <var>url-port</var>. 
          </ol>
         <li>
           If the source expression contains a non-empty <code><a data-link-type="dfn" href="#path-part" id="ref-for-path-part①">path-part</a></code>, and the URL is <em>not</em> the
              result of a redirect, then: 
          <ol>
           <li> Let <var>exact-match</var> be <code>true</code> if the final
                  character of <var>path-part</var> is not the U+002F SOLIDUS
                  character (<code>/</code>), and <code>false</code> otherwise. 
           <li> Let <var>source-expression-path-list</var> be the result of
                  splitting <var>path-part</var> on the U+002F SOLIDUS character
                  (<code>/</code>). 
           <li> If <var>source-expression-path-list</var>’s length is greater
                  than <var>url-path-list</var>’s length, return <em>does not
                  match</em>. 
           <li>
             For each <var>entry</var> in <var>source-expression-path-list</var>: 
            <ol>
             <li> <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode" id="ref-for-percent-decode">Percent decode</a> <var>entry</var>. 
             <li> <a data-link-type="dfn" href="http://www.w3.org/TR/url/#percent-decode" id="ref-for-percent-decode①">Percent decode</a> the first item in <var>url-path-list</var>. 
             <li> If <var>entry</var> is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive③">ASCII case-insensitive
                      match</a> for the first item in <var>url-path-list</var>,
                      return <em>does not match</em>. 
             <li> Pop the first item in <var>url-path-list</var> off the
                      list. 
            </ol>
           <li> If <var>exact-match</var> is <code>true</code>, and <var>url-path-list</var> is not empty, return <em>does not
                  match</em>. 
          </ol>
         <li> Otherwise, return <em>does match</em>. 
        </ol>
       <li>
         If the source expression is a case insensitive match for <code>'self'</code> (including the quotation marks), then: 
        <ol>
         <li>
           Return <em>does match</em> if <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-origin" id="ref-for-concept-url-origin">the
              origin of <var>url</var></a> matches <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-origin" id="ref-for-concept-url-origin①">the origin of <var>protected
              resource</var>’s URL</a>. 
          <p class="note" role="note"><span class="marker">Note:</span> This includes IP addresses. That is, a document at <code>https://111.111.111.111/</code> with a <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy④">policy</a> of <code>img-src 'self'</code> can load the image <code>https://111.111.111.111/image.png</code>, as the origins
              match.</p>
        </ol>
       <li> Otherwise, return <em>does not match</em>. 
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> This algorithm treats the URLs <code>https://example.com/</code> and <code>https://example.com./</code> as <em>non-matching</em>. This
      is consistent with browser behavior which treats documents served from
      these URLs as existing in distinct origins.</p>
      <p>A URL <var>url</var> is said to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="match-a-source-list">match a source list</dfn> for <var>protected resource</var> if at least one source expression in the set
      of source expressions obtained by <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list">parsing the
      source list</a> <a data-link-type="dfn" href="#match-a-source-expression" id="ref-for-match-a-source-expression">matches <var>url</var> for <var>protected resource</var></a>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> No URLs match an empty set of source expressions, such as the set
      obtained by parsing the source list <code>'none'</code>.</p>
      <section class="informative">
       <h5 class="heading settled" data-level="4.2.2.1" id="source-list-guid-matching"><span class="secno">4.2.2.1. </span><span class="content"> Security Considerations for GUID URL schemes </span><a class="self-link" href="#source-list-guid-matching"></a></h5>
       <p><em>This section is not normative.</em></p>
       <p>As defined above, special URL schemes that refer to specific pieces of
        unique content, such as "data:", "blob:" and "filesystem:" are
        excluded from matching a policy of <code>*</code> and must be
        explicitly listed. Policy authors should note that the content of
        such URLs is often derived from a response body or execution in a
        Document context, which may be unsafe. Especially for the <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src②">default-src</a></code> and <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑦">script-src</a></code> directives, policy authors should be aware that allowing "data:" URLs
        is equivalent to <code>unsafe-inline</code> and allowing "blob:" or
        "filesystem:" URLs is equivalent to <code>unsafe-eval</code>.</p>
      </section>
      <section class="informative">
       <h5 class="heading settled" data-level="4.2.2.2" id="source-list-path-patching"><span class="secno">4.2.2.2. </span><span class="content">Path Matching</span><a class="self-link" href="#source-list-path-patching"></a></h5>
       <p><em>This section is not normative.</em></p>
       <p>The rules for matching source expressions that contain paths
        are simpler than they look: paths that end with the <code>'/'</code> character match all files in a directory and its subdirectories. Paths
        that do not end with the <code>'/'</code> character match only one
        specific file. A few examples should make this clear:</p>
       <ol>
        <li>The source expression <code>example.com</code> has no path,
          and therefore matches any file served from that host.
        <li>The source expression <code>example.com/scripts/</code> matches any file in the <code>scripts</code> directory of <code>example.com</code>, and any of its subdirectories. For
          example, both <code>https://example.com/scripts/file.js</code> and <code>https://example.com/scripts/js/file.js</code> would
          match.
        <li>The source expression <code>example.com/scripts/file.js</code> matches only the file
          named <code>file.js</code> in the <code>scripts</code> directory
          of <code>example.com</code>.
        <li>Likewise, the source expression <code>example.com/js</code> matches only the file named <code>js</code>. In particular, note
          that it would not match files inside a directory named <code>js</code>. Files like <code>example.com/js/file.js</code> would be matched only if the source expression ended with a
          trailing "/", as in <code>example.com/js/</code>.
       </ol>
       <p class="note" role="note"><span class="marker">Note:</span> Query strings have no impact on matching: the source
        expression <code>example.com/file</code> matches each of <code>https://example.com/file</code>, <code>https://example.com/file?key=value</code>, <code>https://example.com/file?key=notvalue</code>, and <code>https://example.com/file?notkey=notvalue</code>.</p>
      </section>
      <section class="informative">
       <h5 class="heading settled" data-level="4.2.2.3" id="source-list-paths-and-redirects"><span class="secno">4.2.2.3. </span><span class="content">Paths and Redirects</span><a class="self-link" href="#source-list-paths-and-redirects"></a></h5>
       <p>To avoid leaking path information cross-origin (as discussed
        in Egor Homakov’s <a href="http://homakov.blogspot.de/2014/01/using-content-security-policy-for-evil.html">Using Content-Security-Policy for Evil</a>),
        the matching algorithm ignores the path component of a source
        expression if the resource being loaded is the result of a
        redirect. For example, given a page with an active policy of <code><a data-link-type="dfn" href="#img-src" id="ref-for-img-src">img-src</a> example.com not-example.com/path</code>:</p>
       <ul>
        <li>Directly loading <code>https://not-example.com/not-path</code> would fail, as it doesn’t match the policy.
        <li>Directly loading <code>https://example.com/redirector</code> would pass, as it matches <code>example.com</code>.
        <li>Assuming that <code>https://example.com/redirector</code> delivered a redirect response pointing to <code>https://not-example.com/not-path</code>,
          the load would succeed, as the initial URL matches <code>example.com</code>,
          and the redirect target matches <code>not-example.com/path</code> if we ignore its path component.
       </ul>
       <p>This restriction reduces the granularity of a document’s
        policy when redirects are in play, a necessary compromise to
        avoid brute-forced information leaks of this type.</p>
       <p>The relatively long thread <a href="http://lists.w3.org/Archives/Public/public-webappsec/2014Feb/0036.html">"Remove paths from CSP?"</a> from public-webappsec@w3.org has more detailed discussion around
        alternate proposals.</p>
      </section>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.2.3" id="script-src-the-nonce-attribute"><span class="secno">4.2.3. </span><span class="content"> The <code>nonce</code> attribute </span><a class="self-link" href="#script-src-the-nonce-attribute"></a></h4>
      <p>Nonce sources require a new <code>nonce</code> attribute to be added to
      both <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element③">script</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element">style</a></code> elements.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="http://www.w3.org/TR/html5/scripting-1.html#htmlscriptelement" id="ref-for-htmlscriptelement"><c- g>HTMLScriptElement</c-></a> {
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-type="DOMString" href="#dom-htmlscriptelement-nonce" id="ref-for-dom-htmlscriptelement-nonce"><c- g>nonce</c-></a>;
};
</pre>
      <dl>
       <dt><dfn class="dfn-paneled idl-code" data-dfn-for="HTMLScriptElement" data-dfn-type="attribute" data-export id="dom-htmlscriptelement-nonce"><code>nonce</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①">DOMString</a></span>
       <dd>This attribute <a data-link-type="dfn">reflects</a> the value of the
        element’s <code><dfn class="dfn-paneled" data-dfn-for="script" data-dfn-type="element-attr" data-export id="element-attrdef-script-nonce"><code>nonce</code></dfn></code> content attribute.
      </dl>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="http://www.w3.org/TR/html5/document-metadata.html#htmlstyleelement" id="ref-for-htmlstyleelement"><c- g>HTMLStyleElement</c-></a> {
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-type="DOMString" href="#dom-htmlstyleelement-nonce" id="ref-for-dom-htmlstyleelement-nonce"><c- g>nonce</c-></a>;
};
</pre>
      <dl>
       <dt><dfn class="dfn-paneled idl-code" data-dfn-for="HTMLStyleElement" data-dfn-type="attribute" data-export id="dom-htmlstyleelement-nonce"><code>nonce</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③">DOMString</a></span>
       <dd>This attribute <a data-link-type="dfn">reflects</a> the value of the
        element’s <code><dfn class="dfn-paneled" data-dfn-for="style" data-dfn-type="element-attr" data-export id="element-attrdef-style-nonce"><code>nonce</code></dfn></code> content attribute.
      </dl>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.2.4" id="source-list-valid-nonces"><span class="secno">4.2.4. </span><span class="content">Valid Nonces</span><a class="self-link" href="#source-list-valid-nonces"></a></h4>
      <p>An element has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="valid-nonce">valid nonce</dfn> for a <var>set of source
      expressions</var> if the value of the element’s <code><a data-link-type="element-sub" href="#element-attrdef-script-nonce" id="ref-for-element-attrdef-script-nonce">nonce</a></code> attribute
      after <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace" id="ref-for-strip-leading-and-trailing-whitespace">stripping leading
      and trailing whitespace</a> is a case-sensitive match for the <code><a data-link-type="dfn" href="#nonce-value" id="ref-for-nonce-value③">nonce-value</a></code> component of at least one <code><a data-link-type="dfn" href="#nonce-source" id="ref-for-nonce-source②">nonce-source</a></code> expression in <var>set of source
      expressions</var>.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.2.5" id="source-list-valid-hashes"><span class="secno">4.2.5. </span><span class="content">Valid Hashes</span><a class="self-link" href="#source-list-valid-hashes"></a></h4>
      <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="elements-content">element’s content</dfn> is <a data-link-type="dfn">the script block’s
      source</a> for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element④">script</a></code> elements, or the value of the element’s <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#dom-node-textcontent" id="ref-for-dom-node-textcontent">textContent</a></code> IDL attribute for non-<code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element⑤">script</a></code> elements such as <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element①">style</a></code>.</p>
      <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="digest-of-elements-content">digest of <var>element</var>’s content</dfn> for is the result
      of applying an <var>hashing algorithm</var> to the <a data-link-type="dfn" href="#elements-content" id="ref-for-elements-content">element’s content</a>.</p>
      <p>To determine whether <var>element</var> has a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="valid-hash">valid hash</dfn> for
      a <var>set of source expressions</var>, execute the following steps:</p>
      <ol>
       <li>Let <var>hashes</var> be a list of all <code><a data-link-type="dfn" href="#hash-source" id="ref-for-hash-source①">hash-source</a></code> expressions in <var>set of source
        expressions</var>.
       <li>
        For each <var>hash</var> in <var>hashes</var>: 
        <ol>
         <li>
          Let <var>hashing algorithm</var> be: 
          <ul>
           <li><a data-link-type="dfn" href="#sha-256" id="ref-for-sha-256">SHA-256</a> if the <code><a data-link-type="dfn" href="#hash-algo" id="ref-for-hash-algo①">hash-algo</a></code> component of <var>hash</var> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive④">ASCII case-insensitive
                match</a> for the string "sha256".
           <li><a data-link-type="dfn" href="#sha-384" id="ref-for-sha-384">SHA-384</a> if the <code><a data-link-type="dfn" href="#hash-algo" id="ref-for-hash-algo②">hash-algo</a></code> component of <var>hash</var> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑤">ASCII case-insensitive
                match</a> for the string "sha384".
           <li><a data-link-type="dfn" href="#sha-512" id="ref-for-sha-512">SHA-512</a> if the <code><a data-link-type="dfn" href="#hash-algo" id="ref-for-hash-algo③">hash-algo</a></code> component of <var>hash</var> is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑥">ASCII case-insensitive
                match</a> for the string "sha512".
          </ul>
         <li>Let <var>expected</var> be the <code><a data-link-type="dfn" href="#hash-value" id="ref-for-hash-value①">hash-value</a></code> component of <var>hash</var>.
         <li>Let <var>actual</var> be the <a href="https://tools.ietf.org/html/rfc4648#section-4">base64
            encoding</a> of the binary <a data-link-type="dfn" href="#digest-of-elements-content" id="ref-for-digest-of-elements-content">digest of <var>element</var>’s
            content</a> using the <var>hashing algorithm</var>.
         <li>If <var>actual</var> is a case-sensitive match for <var>expected</var>, return <strong>true</strong> and abort these
            steps.
        </ol>
       <li>Return <strong>false</strong>.
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> If an element has an invalid hash, it would be helpful
      if the user agent reported the failure to the author by adding
      a warning message containing the <var>actual</var> hash value.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.3" id="media-type-list-syntax"><span class="secno">4.3. </span><span class="content">Media Type List Syntax</span><a class="self-link" href="#media-type-list-syntax"></a></h3>
     <p>The <code><a data-link-type="dfn" href="#plugin-types" id="ref-for-plugin-types①">plugin-types</a></code> directive uses a value consisting
    of a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="media-type-list">media type list</dfn>.</p>
     <p>Each <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="media-type">media type</dfn> in the media type list represents a specific
    type of resource that can be retrieved and used to instantiate a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#plugin" id="ref-for-plugin①">plugin</a> in the protected resource.</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="media-type-list①">media-type-list</dfn>   = <a data-link-type="dfn" href="#media-type①" id="ref-for-media-type①">media-type</a> *( 1*WSP <a data-link-type="dfn" href="#media-type①" id="ref-for-media-type①①">media-type</a> )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="media-type①">media-type</dfn>        = &lt;type from RFC 2045> "/" &lt;subtype from RFC 2045>
</pre>
     <section>
      <h4 class="heading settled" data-level="4.3.1" id="media-type-list-parsing"><span class="secno">4.3.1. </span><span class="content">Parsing</span><a class="self-link" href="#media-type-list-parsing"></a></h4>
      <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parse-a-media-type-list">parse a media type list</dfn> <var>media type list</var>, the
      user agent MUST use an algorithm equivalent to the following:</p>
      <ol>
       <li>Let the <var>set of media types</var> be the empty set.
       <li>For each token returned by <a data-link-type="dfn">splitting <var>media type list</var> on spaces</a>, if the token matches the
        grammar for <code><a data-link-type="dfn" href="#media-type①" id="ref-for-media-type①②">media-type</a></code>, add the token to the <var>set of media types</var>. Otherwise ignore the token.
       <li>Return the <var>set of media types</var>.
      </ol>
     </section>
     <section>
      <h4 class="heading settled" data-level="4.3.2" id="media-type-list-matching"><span class="secno">4.3.2. </span><span class="content">Matching</span><a class="self-link" href="#media-type-list-matching"></a></h4>
      <p>A media type <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="match a media type list" data-noexport id="match-a-media-type-list">matches a media type
      list</dfn> if, and only if, the media type is an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑦">ASCII
      case-insensitive match</a> for at least one token in the set of media
      types obtained by <a data-link-type="dfn" href="#parse-a-media-type-list" id="ref-for-parse-a-media-type-list">parsing the media
      type list</a>.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="4.4" id="violation-reports"><span class="secno">4.4. </span><span class="content">Reporting</span><a class="self-link" href="#violation-reports"></a></h3>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="strip uri for reporting|stripped for reporting" data-noexport id="strip-uri-for-reporting">strip <var>uri</var> for reporting</dfn>, the user agent MUST use an
    algorithm equivalent to the following:</p>
     <ol>
      <li>If the <a data-link-type="dfn" href="#origin" id="ref-for-origin①">origin</a> of <var>uri</var> is a <a data-link-type="dfn" href="#globally-unique-identifier" id="ref-for-globally-unique-identifier">globally unique
      identifier</a> (for example, <var>uri</var> has a scheme of <code>data</code>, <code>blob</code>, or <code>filesystem</code>), then
      abort these steps, and return the ASCII serialization of <var>uri</var>’s scheme.
      <li>If the <a data-link-type="dfn" href="#origin" id="ref-for-origin②">origin</a> of <var>uri</var> is not the same as the <a data-link-type="dfn" href="#origin" id="ref-for-origin③">origin</a> of the protected resource, then abort these steps, and
      return the <a data-link-type="dfn">ASCII
      serialization of <var>uri</var>’s origin</a>.
      <li>Return <var>uri</var>, with any <a data-link-type="dfn">fragment</a> component removed.
     </ol>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="generate a violation report object|generating a violation report object" data-noexport id="generate-a-violation-report-object">generate a violation report object</dfn>,
    the user agent MUST use an algorithm equivalent to the following:</p>
     <ol>
      <li>
       Prepare a JSON object <var>violation</var> with the
      following keys and values: 
       <dl>
        <dt id="violation-report-blocked-uri"><a class="self-link" href="#violation-report-blocked-uri"></a>blocked-uri
        <dd>The originally requested URL of the resource that was
          prevented from loading, <a data-link-type="dfn" href="#strip-uri-for-reporting" id="ref-for-strip-uri-for-reporting">stripped for reporting</a>,
          or the empty string if the resource has no URL (inline script and
          inline style, for example).
        <dt id="violation-report-document-uri"><a class="self-link" href="#violation-report-document-uri"></a>document-uri
        <dd>The <a data-link-type="dfn">address</a> of the protected resource, <a data-link-type="dfn" href="#strip-uri-for-reporting" id="ref-for-strip-uri-for-reporting①">stripped for reporting</a>.
        <dt id="violation-report-effective-directive"><a class="self-link" href="#violation-report-effective-directive"></a>effective-directive
        <dd>The name of the policy directive that was violated. This will
          contain the <a data-link-type="dfn" href="#security-policy-directive" id="ref-for-security-policy-directive②">directive</a> whose enforcement triggered the
          violation (e.g. "<code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑧">script-src</a></code>") even if that
          directive does not explicitly appear in the policy, but is
          implicitly activated via the <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src③">default-src</a></code> directive.
        <dt id="violation-report-original-policy"><a class="self-link" href="#violation-report-original-policy"></a>original-policy
        <dd>The original <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy⑤">policy</a>, as received by the user agent.
        <dt id="violation-report-referrer"><a class="self-link" href="#violation-report-referrer"></a>referrer
        <dd>The <a class="idl-code" data-link-type="attribute" href="http://www.w3.org/TR/html5/dom.html#dom-document-referrer" id="ref-for-dom-document-referrer">referrer</a> attribute of the protected
          resource, or the empty string if the protected resource has no
          referrer.
        <dt id="violation-report-status-code"><a class="self-link" href="#violation-report-status-code"></a>status-code
        <dd>The <code>status-code</code> of the HTTP response that
          contained the protected resource, if the protected resource was
          obtained over HTTP. Otherwise, the number 0.
        <dt id="violation-report-violated-directive"><a class="self-link" href="#violation-report-violated-directive"></a>violated-directive
        <dd>The policy directive that was violated, as it appears in the
          policy. This will contain the <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src④">default-src</a></code> directive
          in the case of violations caused by falling back to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources">default sources</a> when enforcing
          a directive.
       </dl>
      <li>
       If a specific line or a specific file can be identified as the
      cause of the violation (for example, script execution that violates
      the <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑨">script-src</a></code> directive), the user agent MAY add the
      following keys and values to <var>violation</var>: 
       <dl>
        <dt id="violation-report-source-file"><a class="self-link" href="#violation-report-source-file"></a><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="source-file">source-file</dfn>
        <dd>The URL of the resource where the violation occurred, <a data-link-type="dfn" href="#strip-uri-for-reporting" id="ref-for-strip-uri-for-reporting②">stripped for reporting</a>.
        <dt id="violation-report-line-number"><a class="self-link" href="#violation-report-line-number"></a>line-number
        <dd>The line number in <code><a data-link-type="dfn" href="#source-file" id="ref-for-source-file">source-file</a></code> on which
          the violation occurred.
        <dt id="violation-report-column-number"><a class="self-link" href="#violation-report-column-number"></a>column-number
        <dd>The column number in <code><a data-link-type="dfn" href="#source-file" id="ref-for-source-file①">source-file</a></code> on which
          the violation occurred.
       </dl>
      <li>Return <var>violation</var>.
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> <code>blocked-uri</code> will not contain the final location of a
    resource that was blocked after one or more redirects. It instead will
    contain only the location that the protected resource requested, before
    any redirects were followed.</p>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="send-violation-reports">send violation reports</dfn>, the user agent MUST use an
    algorithm equivalent to the following:</p>
     <ol>
      <li>Prepare a <a data-link-type="dfn" href="#json-object" id="ref-for-json-object">JSON object</a> <var>report object</var> with a single
      key, <code>csp-report</code>, whose value is the result of <a data-link-type="dfn" href="#generate-a-violation-report-object" id="ref-for-generate-a-violation-report-object">generating
      a violation report object</a>.
      <li>Let <var>report body</var> be the <a data-link-type="dfn" href="#json-stringification" id="ref-for-json-stringification">JSON stringification</a> of <var>report object</var>.
      <li>
       For each <var>report URL</var> in the <a data-link-type="dfn" href="#set-of-report-urls" id="ref-for-set-of-report-urls">set of report URLs</a>: 
       <ol>
        <li>If the user agent has already sent a violation report for
          the protected resource to <var>report URL</var>, and that report
          contained an entity body that exactly matches <var>report body</var>, the user agent MAY abort these
          steps and continue to the next <var>report URL</var>.
        <li><a data-link-type="dfn">Queue a task</a> to <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch">fetch</a> <var>report URL</var> from the origin of the protected resource,
          with the synchronous flag <em>not</em> set, using HTTP method <code>POST</code>, with a <code>Content-Type</code> header field
          of <code>application/csp-report</code>, and an entity body
          consisting of <var>report body</var>. If the origin of <var>report URL</var> is <strong>not</strong> the same as the
          origin of the protected resource, the block cookies flag MUST also
          be set. The user agent MUST NOT follow redirects when fetching this
          resource. (Note: The user agent ignores the fetched resource.)
          The <a data-link-type="dfn">task source</a> for these <a data-link-type="dfn">tasks</a> is the <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="Content Security Policy task source" data-noexport id="content-security-policy-task-source">Content Security Policy task
          source</dfn>.
       </ol>
     </ol>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="report-a-violation">report a violation</dfn>, the user agent MUST:</p>
     <ol>
      <li><a data-link-type="dfn" href="#fire-a-violation-event" id="ref-for-fire-a-violation-event">Fire a violation event</a> at the protected resource’s <code><a class="idl-code" data-link-type="interface">Document</a></code>.
      <li>If the <a data-link-type="dfn" href="#set-of-report-urls" id="ref-for-set-of-report-urls①">set of report URLs</a> is non-empty, <a data-link-type="dfn" href="#send-violation-reports" id="ref-for-send-violation-reports①">send violation
      reports</a> to each.
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> This section of the specification should not be interpreted
    as limiting user agents' ability to apply restrictions to violation
    reports in order to limit data leakage above and beyond what these
    algorithms specify. For example, a user agent might offer users the
    option of disabling reporting entirely.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="processing-model"><span class="secno">5. </span><span class="content">Processing Model</span><a class="self-link" href="#processing-model"></a></h2>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="enforce">enforce</dfn> a policy, the user agent MUST <a data-link-type="dfn" href="#parse-the-policy" id="ref-for-parse-the-policy①">parse the policy</a> and enforce each of the directives contained in the policy, where the
  specific requirements for enforcing each directive are defined separately
  for each directive (See <a href="#directives">§ 7 Directives</a>, below).</p>
    <p>Generally speaking, enforcing a directive prevents the protected
  resource from performing certain actions, such as loading scripts from
  URLs other than those indicated in a source list. These restrictions
  make it more difficult for an attacker to abuse an injection
  vulnerability in the resource because the attacker will be unable to
  usurp the resource’s privileges that have been restricted in this
  way.</p>
    <p class="note" role="note"><span class="marker">Note:</span> User agents may allow users to modify or bypass policy enforcement
  through user preferences, bookmarklets, third-party additions to the user
  agent, and other such mechanisms.</p>
    <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="monitor">monitor</dfn> a policy, the user agent MUST <a data-link-type="dfn" href="#parse-the-policy" id="ref-for-parse-the-policy②">parse the policy</a> and monitor each of the directives contained in the policy.</p>
    <p>Monitoring a directive does not prevent the protected resource from
  undertaking any actions. Instead, any actions that would have been
  prevented by the directives are allowed, but a violation report is <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation">generated and reported</a> to the
  developer of the web application. Monitoring a policy is useful for
  testing whether enforcing the policy will cause the web application to
  malfunction.</p>
    <p>A server MAY cause user agents to monitor one policy while enforcing
  another policy by returning both <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy①">Content-Security-Policy</a></code> and <code><a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only②">Content-Security-Policy-Report-Only</a></code> header fields.
  For example, if a server operator may wish to <a data-link-type="dfn" href="#enforce" id="ref-for-enforce②">enforce</a> one policy but
  experiment with a stricter policy, she can monitor the stricter policy while
  enforcing the original policy. Once the server operator is satisfied that
  the stricter policy does not break the web application, the server operator
  can start enforcing the stricter policy.</p>
    <p>If the user agent monitors or enforces a policy that does not contain any
  directives, the user agent SHOULD report a warning message in the
  developer console.</p>
    <p>If the user agent <a data-link-type="dfn" href="#monitor" id="ref-for-monitor②">monitors</a> or <a data-link-type="dfn" href="#enforce" id="ref-for-enforce③">enforces</a> a policy that contains
  an unrecognized directive, the user agent SHOULD report a warning message
  in the developer console indicating the name of the unrecognized directive.</p>
    <section>
     <h3 class="heading settled" data-level="5.1" id="processing-model-workers"><span class="secno">5.1. </span><span class="content">Workers</span><a class="self-link" href="#processing-model-workers"></a></h3>
     <p>Whenever a user agent <a data-link-type="dfn" href="#runs-a-worker" id="ref-for-runs-a-worker">runs a worker</a>:</p>
     <ul>
      <li>
       If the worker’s script’s origin is a <a data-link-type="dfn" href="#globally-unique-identifier" id="ref-for-globally-unique-identifier①">globally unique identifier</a> (for example, the worker’s script’s URL has a scheme of <code>data</code>, <code>blob</code>, or <code>filesystem</code>), then: 
       <ul>
        <li>If the user agent is enforcing a CSP policy for the <var>owner
        document</var> or <var>parent worker</var>, the user agent MUST enforce
        the CSP policy for the worker.
        <li>If the user agent is monitoring a CSP policy for the <var>owner
        document</var> or <var>parent worker</var>, the user agent MUST monitor
        the CSP policy for the worker.
       </ul>
      <li>
       Otherwise: 
       <ul>
        <li>If the worker’s script is delivered with a <code>Content-Security-Policy</code> HTTP header containing the
          value <var>policy</var>, the user agent MUST <a data-link-type="dfn" href="#enforce" id="ref-for-enforce④">enforce</a> <var>policy</var> for the worker.
        <li>If the worker’s script is delivered with a <code>Content-Security-Policy-Report-Only</code> HTTP header
          containing the value <var>policy</var>, the user agent MUST <a data-link-type="dfn" href="#monitor" id="ref-for-monitor③">monitor</a> <var>policy</var> for the worker.
       </ul>
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="5.2" id="processing-model-iframe-srcdoc"><span class="secno">5.2. </span><span class="content"><code>srcdoc</code> iframes</span><a class="self-link" href="#processing-model-iframe-srcdoc"></a></h3>
     <p>Whenever a user agent creates <a data-link-type="dfn">an <code>iframe</code> <code>srcdoc</code> document</a> in a browsing context nested in the
    protected resource, if the user agent is <a data-link-type="dfn" href="#enforce" id="ref-for-enforce⑤">enforcing</a> any <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy⑥">policies</a> for the protected resource, the user agent MUST <a data-link-type="dfn" href="#enforce" id="ref-for-enforce⑥">enforce</a> those <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy⑦">policies</a> on the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element②">iframe</a></code> <code>srcdoc</code> document as well.</p>
     <p>Whenever a user agent creates <a data-link-type="dfn">an <code>iframe</code> <code>srcdoc</code> document</a> in a browsing context nested in the
    protected resource, if the user agent is monitoring any policies for the
    protected resource, the user agent MUST <a data-link-type="dfn" href="#monitor" id="ref-for-monitor④">monitor</a> those policies on
    the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element③">iframe</a></code> <code>srcdoc</code> document as well.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="script-interfaces"><span class="secno">6. </span><span class="content">Script Interfaces</span><a class="self-link" href="#script-interfaces"></a></h2>
    <section>
     <h3 class="heading settled" data-level="6.1" id="securitypolicyviolationevent-interface"><span class="secno">6.1. </span><span class="content"> <code>SecurityPolicyViolationEvent</code> Interface </span><a class="self-link" href="#securitypolicyviolationevent-interface"></a></h3>
<pre class="idl highlight def">[<c- g>Constructor</c->(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <c- g>type</c->, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit" id="ref-for-dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <c- g>eventInitDict</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></dfn> : <a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#event" id="ref-for-event"><c- n>Event</c-></a> {
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-documenturi" id="ref-for-dom-securitypolicyviolationevent-documenturi"><c- g>documentURI</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-referrer" id="ref-for-dom-securitypolicyviolationevent-referrer"><c- g>referrer</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-blockeduri" id="ref-for-dom-securitypolicyviolationevent-blockeduri"><c- g>blockedURI</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective"><c- g>violatedDirective</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective①"><c- g>effectiveDirective</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-originalpolicy" id="ref-for-dom-securitypolicyviolationevent-originalpolicy"><c- g>originalPolicy</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-sourcefile" id="ref-for-dom-securitypolicyviolationevent-sourcefile①"><c- g>sourceFile</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①②"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-statuscode" id="ref-for-dom-securitypolicyviolationevent-statuscode①"><c- g>statusCode</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long"><c- b>long</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="long" href="#dom-securitypolicyviolationevent-linenumber" id="ref-for-dom-securitypolicyviolationevent-linenumber①"><c- g>lineNumber</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long①"><c- b>long</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="long" href="#dom-securitypolicyviolationevent-columnnumber" id="ref-for-dom-securitypolicyviolationevent-columnnumber①"><c- g>columnNumber</c-></a>;
};
</pre>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-documenturi"><code>documentURI</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①③">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-document-uri"><code>document-uri</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-referrer"><code>referrer</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①④">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-referrer"><code>referrer</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-blockeduri"><code>blockedURI</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑤">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-blocked-uri"><code>blocked-uri</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-violateddirective"><code>violatedDirective</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑥">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-violated-directive"><code>violated-directive</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-effectivedirective"><code>effectiveDirective</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑦">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-effective-directive"><code>effective-directive</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-originalpolicy"><code>originalPolicy</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑧">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-original-policy"><code>original-policy</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-statuscode"><code>statusCode</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⑨">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-status-code"><code>status-code</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-sourcefile"><code>sourceFile</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⓪">DOMString</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-source-file"><code>source-file</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-linenumber"><code>lineNumber</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long②">long</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-line-number"><code>line-number</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-columnnumber"><code>columnNumber</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long③">long</a>, readonly</span>
      <dd>Refer to the <a href="#violation-report-column-number"><code>column-number</code></a> property of violation reports for a description of this property.
     </dl>
    </section>
    <section>
     <h3 class="heading settled" data-level="6.2" id="securitypolicyviolationeventinit-interface"><span class="secno">6.2. </span><span class="content"> <code>SecurityPolicyViolationEventInit</code> Interface </span><a class="self-link" href="#securitypolicyviolationeventinit-interface"></a></h3>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#eventinit" id="ref-for-eventinit"><c- n>EventInit</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②①"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-documenturi" id="ref-for-dom-securitypolicyviolationeventinit-documenturi"><c- g>documentURI</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②②"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-referrer" id="ref-for-dom-securitypolicyviolationeventinit-referrer"><c- g>referrer</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②③"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-blockeduri" id="ref-for-dom-securitypolicyviolationeventinit-blockeduri"><c- g>blockedURI</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②④"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-violateddirective" id="ref-for-dom-securitypolicyviolationeventinit-violateddirective"><c- g>violatedDirective</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⑤"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-effectivedirective" id="ref-for-dom-securitypolicyviolationeventinit-effectivedirective"><c- g>effectiveDirective</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⑥"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-originalpolicy" id="ref-for-dom-securitypolicyviolationeventinit-originalpolicy"><c- g>originalPolicy</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⑦"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-sourcefile" id="ref-for-dom-securitypolicyviolationeventinit-sourcefile"><c- g>sourceFile</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long④"><c- b>long</c-></a>      <a class="idl-code" data-link-type="dict-member" data-type="long" href="#dom-securitypolicyviolationeventinit-linenumber" id="ref-for-dom-securitypolicyviolationeventinit-linenumber"><c- g>lineNumber</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long⑤"><c- b>long</c-></a>      <a class="idl-code" data-link-type="dict-member" data-type="long" href="#dom-securitypolicyviolationeventinit-columnnumber" id="ref-for-dom-securitypolicyviolationeventinit-columnnumber"><c- g>columnNumber</c-></a>;
};
</pre>
     <dl>
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-documenturi"><code>documentURI</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⑧">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-document-uri"><code>document-uri</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-referrer"><code>referrer</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②⑨">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-referrer"><code>referrer</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-blockeduri"><code>blockedURI</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③⓪">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-blocked-uri"><code>blocked-uri</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-violateddirective"><code>violatedDirective</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③①">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-violated-directive"><code>violated-directive</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-effectivedirective"><code>effectiveDirective</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③②">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-effective-directive"><code>effective-directive</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-originalpolicy"><code>originalPolicy</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③③">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-original-policy"><code>original-policy</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-sourcefile"><code>sourceFile</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③④">DOMString</a></span>
      <dd>Refer to the <a href="#violation-report-source-file"><code>source-file</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-linenumber"><code>lineNumber</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long⑥">long</a></span>
      <dd>Refer to the <a href="#violation-report-line-number"><code>line-number</code></a> property of violation reports for a description of this property.
      <dt><dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export id="dom-securitypolicyviolationeventinit-columnnumber"><code>columnNumber</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-long" id="ref-for-idl-long⑦">long</a></span>
      <dd>Refer to the <a href="#violation-report-column-number"><code>column-number</code></a> property of violation reports for a description of this property.
     </dl>
    </section>
    <section>
     <h3 class="heading settled" data-level="6.3" id="firing-securitypolicyviolationevent-events"><span class="secno">6.3. </span><span class="content">Firing Violation Events</span><a class="self-link" href="#firing-securitypolicyviolationevent-events"></a></h3>
     <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="fire-a-violation-event">fire a violation event</dfn>, the user agent MUST use an algorithm
    equivalent to the following:</p>
     <ol>
      <li>Let <var>report object</var> be the result of <a data-link-type="dfn" href="#generate-a-violation-report-object" id="ref-for-generate-a-violation-report-object①">generating a
      violation report object</a>.
      <li>
       <a data-link-type="dfn">Queue a task</a> to <a data-link-type="dfn">fire an event</a> named <code>securitypolicyviolation</code> using the <code><a class="idl-code" data-link-type="interface" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent②">SecurityPolicyViolationEvent</a></code> interface
      with the following initializations: 
       <ul>
        <li><code>blockedURI</code> MUST be initialized to the value of <var>report object</var>’s <code>blocked-uri</code> key.
        <li><code>documentURI</code> MUST be initialized to the value of <var>report object</var>’s <code>document-uri</code> key.
        <li><code>effectiveDirective</code> MUST be initialized to the value of <var>report object</var>’s <code>effective-directive</code> key.
        <li><code>originalPolicy</code> MUST be initialized to the value of <var>report object</var>’s <code>original-policy</code> key.
        <li><code>referrer</code> MUST be initialized to the value of <var>report object</var>’s <code>referrer</code> key.
        <li><code>violatedDirective</code> MUST be initialized to the value of <var>report object</var>’s <code>violated-directive</code> key.
        <li><code>sourceFile</code> MUST be initialized to the value of <var>report object</var>’s <code>source-file</code> key.
        <li><code>lineNumber</code> MUST be initialized to the value of <var>report object</var>’s <code>line-number</code> key.
        <li><code>columnNumber</code> MUST be initialized to the value of <var>report object</var>’s <code>column-number</code> key.
       </ul>
     </ol>
     <p>The <a data-link-type="dfn">task source</a> for these <a data-link-type="dfn">tasks</a> is the <a data-link-type="dfn" href="#content-security-policy-task-source" id="ref-for-content-security-policy-task-source">Content Security Policy task source</a>.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="directives"><span class="secno">7. </span><span class="content">Directives</span><a class="self-link" href="#directives"></a></h2>
    <p>This section describes the content security policy directives
  introduced in this specification. Directive names are case insensitive.</p>
    <p>In order to protect against Cross-Site Scripting (XSS), web
  application authors SHOULD include:</p>
    <ul>
     <li>both the <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⓪">script-src</a></code> and <code><a data-link-type="dfn" href="#object-src" id="ref-for-object-src②">object-src</a></code> directives, or
     <li>include a <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑤">default-src</a></code> directive, which covers both
    scripts and plugins.
    </ul>
    <p>In either case, authors SHOULD NOT include either <code>'unsafe-inline'</code> or <code>data:</code> as valid sources in
  their policies. Both enable XSS attacks by allowing code to be included
  directly in the document itself; they are best avoided completely.</p>
    <section>
     <h3 class="heading settled" data-level="7.1" id="directive-base-uri"><span class="secno">7.1. </span><span class="content"><code>base-uri</code></span><a class="self-link" href="#directive-base-uri"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="base-uri">base-uri</dfn></code> directive restricts the URLs that can
    be used to specify the <a data-link-type="dfn">document base URL</a>. The syntax for
    the name and value of the directive are described by the following ABNF
    grammar:</p>
<pre>directive-name    = "base-uri"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-base-urls">allowed base URLs</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list①">parsing the <code>base-uri</code> directive’s
    value as a source list</a>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> <code>base-uri</code> does not fall back to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources①">default
    sources</a>.</p>
     <p>Step 4 of the algorithm defined in HTML5 to obtain a <em>document’s base URL</em> (resolution of the <code>href</code> attribute
    of the <code>base</code> element) MUST be changed to:</p>
     <ol start="4">
      <li>If the previous step was not successful, or the result of the
      previous step does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list">match</a> the <a data-link-type="dfn" href="#allowed-base-urls" id="ref-for-allowed-base-urls">allowed base URLs</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource⑧">protected resource</a>, then the <a data-link-type="dfn">document base URL</a> is <var>fallback base URL</var>.
      Otherwise, it is the result of the previous step.
     </ol>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.2" id="directive-child-src"><span class="secno">7.2. </span><span class="content"><code>child-src</code></span><a class="self-link" href="#directive-child-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="child-src">child-src</dfn></code> directive governs the creation of <a data-link-type="dfn">nested browsing contexts</a> as well as Worker execution
    contexts. The syntax for the name and value of the directive are described
    by the following ABNF grammar:</p>
<pre>directive-name    = "child-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①①">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-child-sources">allowed child sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list②">parsing the <code>child-src</code> directive’s value as a source list</a> if a <code>child-src</code> directive is explicitly specified, and otherwise to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources②">default sources</a>.</p>
     <section>
      <h4 class="heading settled" data-level="7.2.1" id="directive-child-src-nested"><span class="secno">7.2.1. </span><span class="content">Nested Browsing Contexts</span><a class="self-link" href="#directive-child-src-nested"></a></h4>
      <p>To enforce the <code>child-src</code> directive the user agent MUST
      enforce the <code><a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src①">frame-src</a></code> directive.</p>
     </section>
     <section>
      <h4 class="heading settled" data-level="7.2.2" id="directive-child-src-workers"><span class="secno">7.2.2. </span><span class="content">Workers</span><a class="self-link" href="#directive-child-src-workers"></a></h4>
      <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch①">fetches</a> a URL while processing the <code>Worker</code> or <code>SharedWorker</code> constructors <a data-link-type="biblio" href="#biblio-workers" title="Web Workers">[WORKERS]</a>, the user agent MUST act as if there was a fatal network
      error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①">report a violation</a> if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list①">match</a> the <a data-link-type="dfn" href="#allowed-child-sources" id="ref-for-allowed-child-sources">allowed child sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource⑨">protected resource</a>.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.3" id="directive-connect-src"><span class="secno">7.3. </span><span class="content"><code>connect-src</code></span><a class="self-link" href="#directive-connect-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="connect-src">connect-src</dfn></code> directive restricts which URLs the
    protected resource can load using script interfaces. The syntax for the name
    and value of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "connect-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①②">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-connection-targets">allowed connection targets</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list③">parsing the <code>connect-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>connect-src</code> directive, or otherwise to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources③">default sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch②">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list②">match</a> the <a data-link-type="dfn" href="#allowed-connection-targets" id="ref-for-allowed-connection-targets">allowed connection
    targets</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⓪">protected resource</a>, the user agent MUST act as
    if there was a fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation②">report a violation</a>:</p>
     <ul>
      <li>Processing the <a href="http://www.w3.org/TR/XMLHttpRequest/#the-send()-method"><code>send()</code> method</a> of an <code>XMLHttpRequest</code> object.
      <li>Processing the <a href="http://dev.w3.org/html5/websockets/#websocket"><code>WebSocket</code> constructor</a>.
      <li>Processing the <a href="http://dev.w3.org/html5/eventsource/#eventsource"><code>EventSource</code> constructor</a>.
      <li>Pinging an endpoint during <a href="https://html.spec.whatwg.org/multipage/semantics.html#hyperlink-auditing">hyperlink auditing</a>.
      <li>Sending a beacon via the <a href="http://www.w3.org/TR/beacon/#sec-sendBeacon-method"><code>sendBeacon()</code></a> method. <a data-link-type="biblio" href="#biblio-beacon" title="Beacon">[BEACON]</a>
     </ul>
     <section class="informative">
      <h4 class="heading settled" data-level="7.3.1" id="connect-src-usage"><span class="secno">7.3.1. </span><span class="content">Usage</span><a class="self-link" href="#connect-src-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>JavaScript offers a few mechanisms that directly connect to an
      external server to send or receive information. <code>EventSource</code> maintains an open HTTP connection to a server in order to receive push
      notifications, <code>WebSockets</code> open a bidirectional communication
      channel between your browser and a server, and <code>XMLHttpRequest</code> allows arbitrary HTTP requests. These are powerful APIs that
      enable useful functionality, but also provide tempting avenues for data
      exfiltration.</p>
      <p>The <code>connect-src</code> directive allows restricting these sorts of
      connections to the those matching the source expressions list.
      Sending a policy that defines a list of source expressions for this
      directive is straightforward. For example, to limit connections to
      only <code>example.com</code>, send the following header:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src③">connect-src</a> example.com</pre>
      <p>Each of the following will fail with the preceding directive in
      place:</p>
      <ul>
       <li><code>new WebSocket("wss://evil.com/");</code>
       <li><code>(new XMLHttpRequest()).open("GET", "https://evil.com/", true);</code>
       <li><code>new EventSource("https://evil.com");</code>
      </ul>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.4" id="directive-default-src"><span class="secno">7.4. </span><span class="content"><code>default-src</code></span><a class="self-link" href="#directive-default-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-src">default-src</dfn></code> directive sets a default
    source list for a number of directives. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "default-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①③">source-list</a>
</pre>
     <p>Let the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-sources">default sources</dfn> be the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list④">parsing the <code>default-src</code> directive’s value as a source list</a> if a <code>default-src</code> directive is explicitly specified, and otherwise a list including all
    possible sources.</p>
     <p>To enforce the <code>default-src</code> directive, the user agent
    MUST enforce the following directives:</p>
     <ul>
      <li><code><a data-link-type="dfn" href="#child-src" id="ref-for-child-src②">child-src</a></code>
      <li><code><a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src④">connect-src</a></code>
      <li><code><a data-link-type="dfn" href="#font-src" id="ref-for-font-src">font-src</a></code>
      <li><code><a data-link-type="dfn" href="#img-src" id="ref-for-img-src①">img-src</a></code>
      <li><code><a data-link-type="dfn" href="#media-src" id="ref-for-media-src">media-src</a></code>
      <li><code><a data-link-type="dfn" href="#object-src" id="ref-for-object-src③">object-src</a></code>
      <li><code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①①">script-src</a></code>
      <li><code><a data-link-type="dfn" href="#style-src" id="ref-for-style-src">style-src</a></code>
     </ul>
     <p>If not specified explicitly in the policy, the directives listed
    above will use the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources④">default sources</a> as their source list.</p>
     <section>
      <h4 class="heading settled" data-level="7.4.1" id="default-src-usage"><span class="secno">7.4.1. </span><span class="content">Usage</span><a class="self-link" href="#default-src-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p><code>default-src</code>, as the name implies, serves as a default
      source list which the other source list-style directives will use as
      a fallback if they’re not otherwise explicitly set. That is, consider
      the following policy declaration:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑥">default-src</a> 'self'</pre>
      <p>Under this policy, fonts, frames, images, media, objects, scripts,
      and styles will all only load from the same origin as the protected
      resource, and connections will only be made to the same origin. Adding
      a more specific declaration to the policy would completely override
      the default source list for that resource type.</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑦">default-src</a> 'self'; <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①②">script-src</a> example.com</pre>
      <p>Under this new policy, fonts, frames, and etc. continue to be load
      from the same origin, but scripts will <em>only</em> load from <code>example.com</code>. There’s no inheritance; the <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①③">script-src</a></code> directive sets the allowed sources of
      script, and the default list is not used for that resource type.</p>
      <p>Given this behavior, one good way of building a policy for a site
      would be to begin with a <code>default-src</code> of <code>'none'</code>, and to build up a policy from there that contains
      only those resource types which are actually in use for the page you’d
      like to protect. If you don’t use webfonts, for instance, there’s no
      reason to specify a source list for <code><a data-link-type="dfn" href="#font-src" id="ref-for-font-src①">font-src</a></code>;
      specifying only those resource types a page uses ensures that the
      possible attack surface for that page remains as small as possible.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.5" id="directive-font-src"><span class="secno">7.5. </span><span class="content"><code>font-src</code></span><a class="self-link" href="#directive-font-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="font-src">font-src</dfn></code> directive restricts from where the
    protected resource can load fonts. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "font-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①④">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-font-sources">allowed font sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list⑤">parsing the <code>font-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>font-src</code>, or otherwise to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources⑤">default sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch③">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list③">match</a> the <a data-link-type="dfn" href="#allowed-font-sources" id="ref-for-allowed-font-sources">allowed font sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①①">protected resource</a>, the user agent MUST act as if there was
    a fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation③">report
    a violation</a>:</p>
     <ul>
      <li>Requesting data for display in a font, such as when processing
      the &lt;&lt;@font-face>> Cascading Style Sheets (CSS) rule.
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.6" id="directive-form-action"><span class="secno">7.6. </span><span class="content"><code>form-action</code></span><a class="self-link" href="#directive-form-action"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="form-action">form-action</dfn></code> restricts which URLs can be used as
    the action of HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/forms.html#the-form-element" id="ref-for-the-form-element">form</a></code> elements. The syntax for the name and value of
    the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "form-action"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①⑤">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-form-actions">allowed form actions</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list⑥">parsing the <code>form-action</code> directive’s value as a source list</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch④">fetches</a> a URL in the course of processing
    an HTML <code><a data-link-type="element" href="http://www.w3.org/TR/html5/forms.html#the-form-element" id="ref-for-the-form-element①">form</a></code> element, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list④">match</a> the <a data-link-type="dfn" href="#allowed-form-actions" id="ref-for-allowed-form-actions">allowed form actions</a> for
    the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①②">protected resource</a>, the user agent MUST act as if there was a
    fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation④">report a
    violation</a>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> <code>form-action</code> does not fall back to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources⑥">default
    sources</a> when the directive is not defined. That is, a policy that
    defines <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑧">default-src</a> 'none'</code> but not <code>form-action</code> will still allow form submissions to any
    target.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.7" id="directive-frame-ancestors"><span class="secno">7.7. </span><span class="content"><code>frame-ancestors</code></span><a class="self-link" href="#directive-frame-ancestors"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="frame-ancestors">frame-ancestors</dfn></code> directive indicates whether the
    user agent should allow embedding the resource using a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame" id="ref-for-frame">frame</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element④">iframe</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element②">object</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element②">embed</a></code> or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element" id="ref-for-the-applet-element①">applet</a></code> element, or equivalent
    functionality in non-HTML resources. Resources can use this directive to
    avoid many UI Redressing attacks by avoiding being embedded
    into potentially hostile contexts.</p>
     <p>The syntax for the name and value of the directive are described by the
    following ABNF grammar:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ancestor-source-list">ancestor-source-list</dfn> = [ <a data-link-type="dfn" href="#ancestor-source" id="ref-for-ancestor-source">ancestor-source</a> *( 1*WSP <a data-link-type="dfn" href="#ancestor-source" id="ref-for-ancestor-source①">ancestor-source</a> ) ] / "'none'"
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ancestor-source">ancestor-source</dfn>      = <a data-link-type="dfn" href="#scheme-source" id="ref-for-scheme-source②">scheme-source</a> / <a data-link-type="dfn" href="#host-source" id="ref-for-host-source②">host-source</a> / "'self'"

directive-name  = "frame-ancestors"
directive-value = <a data-link-type="dfn" href="#ancestor-source-list" id="ref-for-ancestor-source-list">ancestor-source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-frame-ancestors">allowed frame ancestors</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list⑦">parsing the <code>frame-ancestors</code> directive’s value as a source list</a>. If a <code>frame-ancestors</code> directive is not explicitly included in the policy, then <a data-link-type="dfn" href="#allowed-frame-ancestors" id="ref-for-allowed-frame-ancestors">allowed frame
    ancestors</a> is "<code>*</code>".</p>
     <p>To enforce the <code>frame-ancestors</code> directive, whenever the
    user agent would load the protected resource into a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context①">nested browsing
    context</a>, the user agent MUST perform the following steps:</p>
     <ol>
      <li>Let <var>nestedContext</var> be the nested browsing context into
      which the protected resource is being loaded.
      <li>Let <var>ancestorList</var> be the list of all <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#ancestor-browsing-context" id="ref-for-ancestor-browsing-context">ancestors</a> of <var>nestedContext</var>.
      <li>
       For each <var>ancestorContext</var> in <var>ancestorList</var>: 
       <ol>
        <li>Let <var>document</var> be <var>ancestorContext</var>’s <a data-link-type="dfn">active document</a>.
        <li>
         If <var>document</var>’s URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list⑤">match</a> the <a data-link-type="dfn" href="#allowed-frame-ancestors" id="ref-for-allowed-frame-ancestors①">allowed frame
          ancestors</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①③">protected resource</a>, the user agent MUST: 
         <ol>
          <li>Abort loading the protected resource.
          <li>
           Take one of the following actions: 
           <ul>
            <li> Act as if it received an empty <a data-link-type="dfn" href="#http-200-response" id="ref-for-http-200-response">HTTP 200 response</a>. 
            <li> Redirect the user to a friendly error page which provides
                    the option of opening the blocked page in a new <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level
                    browsing context</a>. 
           </ul>
          <li> <a data-link-type="dfn">Parse a sandboxing directive</a> using the
                empty string as the <em>input</em> and the newly created
                document’s <a data-link-type="dfn">forced sandboxing flag set</a> as the <em>output</em>. 
          <li><a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation⑤">Report a violation</a>.
          <li>Abort these steps.
         </ol>
       </ol>
     </ol>
     <p>Steps 3.2.2 and 3.2.3 ensure that the blocked frame appears to be a
    normal cross-origin document’s load. If these steps are ignored,
    leakage of a document’s policy state is possible.</p>
     <p>The <code>frame-ancestors</code> directive MUST be ignored
    when <a data-link-type="dfn" href="#monitor" id="ref-for-monitor⑤">monitoring</a> a policy, and when a contained in a
    policy defined via a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-meta-element" id="ref-for-the-meta-element①⑤">meta</a></code> element.</p>
     <p class="note" role="note"><span class="marker">Note:</span> <code><a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors②">frame-ancestors</a></code> does not fall back to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources⑦">default sources</a> when the directive is not defined. That is, a policy
    that defines <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑨">default-src</a> 'none'</code> but not <code>frame-ancestors</code> will still allow the resource to be framed from
    anywhere.</p>
     <p>When generating a violation report for a <code>frame-ancestors</code> violation, the user agent MUST NOT include the value of the embedding
    ancestor as a <code>blocked-uri</code> value unless it is same-origin with
    the protected resource, as disclosing the value of cross-origin ancestors
    is a violation of the Same-Origin Policy.</p>
     <section>
      <h4 class="heading settled" data-level="7.7.1" id="frame-ancestors-and-frame-options"><span class="secno">7.7.1. </span><span class="content"> Relation to <code>X-Frame-Options</code> </span><a class="self-link" href="#frame-ancestors-and-frame-options"></a></h4>
      <p>This directive is similar to the <code>X-Frame-Options</code> header that
      several user agents have implemented. The <code>'none'</code> source
      expression is roughly equivalent to that header’s <code>DENY</code>, <code>'self'</code> to <code>SAMEORIGIN</code>, and so on. The major
      difference is that many user agents implement <code>SAMEORIGIN</code> such
      that it only matches against the top-level document’s location. This
      directive checks each ancestor. If any ancestor doesn’t match, the load
      is cancelled. <a data-link-type="biblio" href="#biblio-rfc7034" title="HTTP Header Field X-Frame-Options">[RFC7034]</a></p>
      <p>The <code>frame-ancestors</code> directive <em>obsoletes</em> the <code>X-Frame-Options</code> header.  If a resource has both policies,
      the <code>frame-ancestors</code> policy SHOULD be enforced and the <code>X-Frame-Options</code> policy SHOULD be ignored.</p>
     </section>
     <section class="informative" id="multiple-host-source-values">
      <h4 class="heading settled" data-level="7.7.2" id="frame-ancestors-multiple-source-values"><span class="secno">7.7.2. </span><span class="content">Multiple Host Source Values</span><a class="self-link" href="#frame-ancestors-multiple-source-values"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>Multiple source-list expressions are allowed in a single policy (in contrast
      to <code>X-Frame-Options</code>, which allows only one) to enable
      scenarios involving embedded application components that are multiple levels
      below the top-level browsing context.</p>
      <p>Many common scenarios for embedding (e.g. embeddable payment,
      sharing or social apps) involve potentially many hundreds or thousands of
      valid <code>source-list</code> expressions, but it is strongly recommended
      against accommodating such scenarios with a static <code>frame-ancestors</code> directive listing multiple values. In such
      cases it is beneficial to generate this value dynamically, based on an
      HTTP Referer header or an explicitly passed-in value, to allow only the
      sources necessary for each given embedding of the resource.</p>
      <p>Consider a service providing a payments application at <code>https://payments/makeEmbedded</code>. The service allows this resource
      to be embedded by both merchant Alice and merchant Bob, who compete with each
      other. Sending:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors③">frame-ancestors</a> https://alice https://bob
</pre>
      <p>would allow Bob to re-frame Alice’s resource and create fraudulent clicks,
      perhaps discrediting Alice with her customers or the payments service. If the
      payments service used additional information (e.g. as part of a URL like <code>https://payments/makeEmbedded?merchant=alice</code>) to send
      individually-tailored headers listing only the source-list expressions
      needed by each merchant, this attack would be eliminated.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.8" id="directive-frame-src"><span class="secno">7.8. </span><span class="content"><code>frame-src</code></span><a class="self-link" href="#directive-frame-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="frame-src">frame-src</dfn></code> directive is <em>deprecated</em>.
    Authors who wish to govern nested browsing contexts SHOULD use the <code>child-src</code> directive instead.</p>
     <p>The <code>frame-src</code> directive restricts from where the
    protected resource can embed frames. The syntax for the name
    and value of the directive are described by the following ABNF
    grammar:</p>
<pre>directive-name    = "frame-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①⑥">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-frame-sources">allowed frame sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list⑧">parsing the <code>frame-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>frame-src</code>, or otherwise to the list of <a data-link-type="dfn" href="#allowed-child-sources" id="ref-for-allowed-child-sources①">allowed child sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch⑤">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list⑥">match</a> the <a data-link-type="dfn" href="#allowed-frame-sources" id="ref-for-allowed-frame-sources">allowed frame sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①④">protected resource</a>, the user agent MUST act as if there was a
    fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation⑥">report a
    violation</a>:</p>
     <ul>
      <li>Requesting data for display in a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context②">nested browsing context</a> in the
      protected resource created by an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element⑤">iframe</a></code> or a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#frame" id="ref-for-frame①">frame</a></code> element. 
      <li><a data-link-type="dfn">Navigated</a> such a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context③">nested browsing context</a>.
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.9" id="directive-img-src"><span class="secno">7.9. </span><span class="content"><code>img-src</code></span><a class="self-link" href="#directive-img-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="img-src">img-src</dfn></code> directive restricts from where the
    protected resource can load images. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "img-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①⑦">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-image-sources">allowed image sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list⑨">parsing the <code>img-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>img-src</code>, or otherwise to the list of <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources⑧">default sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch⑥">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list⑦">match</a> the <a data-link-type="dfn" href="#allowed-image-sources" id="ref-for-allowed-image-sources">allowed image sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⑤">protected resource</a>, the user agent MUST act as if there was a
    fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation⑦">report a
    violation</a>:</p>
     <ul>
      <li>Requesting data for an image, such as when processing the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-img-src" id="ref-for-attr-img-src">src</a></code> or <code>srcset</code> attributes of an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element" id="ref-for-the-img-element③">img</a></code> element, the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/forms.html#attr-input-src" id="ref-for-attr-input-src">src</a></code> attribute of an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/forms.html#the-input-element" id="ref-for-the-input-element">input</a></code> element with a type of <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/forms.html#attr-input-type-image-keyword" id="ref-for-attr-input-type-image-keyword">image</a></code>, the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-video-poster" id="ref-for-attr-video-poster">poster</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element" id="ref-for-the-video-element①">video</a></code> element,
      the <a data-link-type="functionish" href="http://www.w3.org/TR/CSS21/syndata.html#uri" id="ref-for-uri">url()</a>, <a data-link-type="functionish" href="https://drafts.csswg.org/css-images-4/#funcdef-image" id="ref-for-funcdef-image">image()</a> or <a data-link-type="functionish" href="https://drafts.csswg.org/css-images-4/#funcdef-image-set" id="ref-for-funcdef-image-set">image-set()</a> values on any
      Cascading Style Sheets (CSS) property that is capable of loading an image <a data-link-type="biblio" href="#biblio-css4-images" title="CSS Images Module Level 4">[CSS4-IMAGES]</a>, or the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-link-href" id="ref-for-attr-link-href">href</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element" id="ref-for-the-link-element②">link</a></code> element
      with an image-related <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/document-metadata.html#attr-link-rel" id="ref-for-attr-link-rel">rel</a></code> attribute, such as <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/links.html#rel-icon" id="ref-for-rel-icon">icon</a></code>.
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.10" id="directive-media-src"><span class="secno">7.10. </span><span class="content"><code>media-src</code></span><a class="self-link" href="#directive-media-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="media-src">media-src</dfn></code> directive restricts from where the
    protected resource can load video, audio, and associated text tracks.
    The syntax for the name and value of the directive are described by the
    following ABNF grammar:</p>
<pre>directive-name    = "media-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①⑧">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-media-sources">allowed media sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list①⓪">parsing the <code>media-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>media-src</code>, or otherwise to the list of <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources⑨">default sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch⑦">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list⑧">match</a> the <a data-link-type="dfn" href="#allowed-media-sources" id="ref-for-allowed-media-sources">allowed media sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⑥">protected resource</a>, the user agent MUST act as if there was
    a fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation⑧">report
    a violation</a>:</p>
     <ul>
      <li>Requesting data for a video or audio clip, such as when processing the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-media-src" id="ref-for-attr-media-src">src</a></code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element" id="ref-for-the-video-element②">video</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element" id="ref-for-the-audio-element①">audio</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element" id="ref-for-the-source-element①">source</a></code>, or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element" id="ref-for-the-track-element①">track</a></code> element.
     </ul>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.11" id="directive-object-src"><span class="secno">7.11. </span><span class="content"><code>object-src</code></span><a class="self-link" href="#directive-object-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="object-src">object-src</dfn></code> directive restricts from where
    the protected resource can load plugins. The syntax for the name and value
    of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "object-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①⑨">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-object-sources">allowed object sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list①①">parsing the <code>object-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>object-src</code>, or otherwise to the list of <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources①⓪">default sources</a>.</p>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch⑧">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list⑨">match</a> the <a data-link-type="dfn" href="#allowed-object-sources" id="ref-for-allowed-object-sources">allowed object sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⑦">protected resource</a>, the user agent MUST act as if there was a
    fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation⑨">report a
    violation</a>:</p>
     <ul>
      <li>Requesting data for a plugin, such as when processing the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-data" id="ref-for-attr-object-data">data</a></code> attribute of an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element③">object</a></code> element, the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-embed-src" id="ref-for-attr-embed-src">src</a></code> attribute of an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element③">embed</a></code> element, or the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/obsolete.html#dom-applet-code" id="ref-for-dom-applet-code">code</a></code> or <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/obsolete.html#dom-applet-archive" id="ref-for-dom-applet-archive">archive</a></code> attributes of an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element" id="ref-for-the-applet-element②">applet</a></code> element.
      <li>Requesting data for display in a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context④">nested browsing context</a> in the protected resource created by an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element④">object</a></code> or an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element④">embed</a></code> element.
      <li>Navigating such a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context⑤">nested browsing context</a>.
     </ul>
     <p>It is not required that the consumer of the element’s data be a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#plugin" id="ref-for-plugin②">plugin</a> in order for the <code>object-src</code> directive to be
    enforced. Data for any <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element⑤">object</a></code>, <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element⑤">embed</a></code>, or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element" id="ref-for-the-applet-element③">applet</a></code> element MUST
    match the <a data-link-type="dfn" href="#allowed-object-sources" id="ref-for-allowed-object-sources①">allowed object sources</a> in order to be fetched. This is true
    even when the element data is semantically equivalent to content which would
    otherwise be restricted by one of the other <a href="#directives">§ 7 Directives</a>, such as an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element⑥">object</a></code> element with a <code>text/html</code> MIME type.</p>
     <p>Whenever the user agent would load a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#plugin" id="ref-for-plugin③">plugin</a> without an associated
    URL (e.g., because the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element⑦">object</a></code> element lacked a <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-data" id="ref-for-attr-object-data①">data</a></code> attribute), if the protected resource’s URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list①⓪">match</a> the <a data-link-type="dfn" href="#allowed-object-sources" id="ref-for-allowed-object-sources②">allowed object sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⑧">protected resource</a>, the user agent MUST NOT load the plugin.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.12" id="directive-plugin-types"><span class="secno">7.12. </span><span class="content"><code>plugin-types</code></span><a class="self-link" href="#directive-plugin-types"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="plugin-types">plugin-types</dfn></code> directive restricts the set
    of plugins that can be invoked by the protected resource by limiting
    the types of resources that can be embedded. The syntax for the name
    and value of the directive are described by the following ABNF
    grammar:</p>
<pre>directive-name    = "plugin-types"
directive-value   = media-type-list
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-plugin-media-types">allowed plugin media types</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-media-type-list" id="ref-for-parse-a-media-type-list①">parsing the <code>plugin-types</code> directive’s value as a media type list</a>.</p>
     <p>Whenever the user agent would instantiate a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#plugin" id="ref-for-plugin④">plugin</a> to handle <var>resource</var> while enforcing the <code>plugin-types</code> directive, the user agent MUST instead act as though the plugin reported an
    error <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①⓪">report a violation</a> if any of the following
    conditions hold:</p>
     <ul>
      <li>The plugin is embedded into the protected resource via an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element⑧">object</a></code> or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element⑥">embed</a></code> element that does not explicitly
        declare a <a data-link-type="dfn">MIME type</a> via a <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type" id="ref-for-attr-object-type">type</a></code> attribute.
      <li><var>resource</var>’s media type does not <a data-link-type="dfn" href="#match-a-media-type-list" id="ref-for-match-a-media-type-list">match</a> the list of <a data-link-type="dfn" href="#allowed-plugin-media-types" id="ref-for-allowed-plugin-media-types">allowed
        plugin media types</a>.
      <li>The plugin is embedded into the protected resource via an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element⑨">object</a></code> or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element⑦">embed</a></code> element, and the media type declared
        in the element’s <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type" id="ref-for-attr-object-type①">type</a></code> attribute is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑧">ASCII
        case-insensitive match</a> for the <var>resource</var>’s media
        type.
      <li>The plugin is embedded into the protected resource via an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/obsolete.html#the-applet-element" id="ref-for-the-applet-element④">applet</a></code> element, and <var>resource</var>’s media type is not an <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑨">ASCII case-insensitive match</a> for <code>application/x-java-applet</code>.
     </ul>
     <p class="note" role="note"><span class="marker">Note:</span> In any of these cases, acting as though the plugin reported an
    error will cause the user agent to display the <a data-link-type="dfn">fallback
    content</a>.</p>
     <p>Whenever the user agent creates a <a data-link-type="dfn">plugin document</a> as the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#active-document" id="ref-for-active-document">active document</a> of a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#child-browsing-context" id="ref-for-child-browsing-context">child browsing context</a> of the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource①⑨">protected resource</a>, if the user agent is enforcing any <code>plugin-types</code> directives for the protected resource, the user
    agent MUST <a data-link-type="dfn" href="#enforce" id="ref-for-enforce⑦">enforce</a> those <code>plugin-types</code> directives on the
    plugin document as well.</p>
     <p>Whenever the user agent creates a <a data-link-type="dfn">plugin document</a> as the <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#active-document" id="ref-for-active-document①">active document</a> of a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#child-browsing-context" id="ref-for-child-browsing-context①">child browsing context</a> of the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource②⓪">protected resource</a>, if the user agent is monitoring any <code>plugin-types</code> directives for the protected resource, the user
    agent MUST <a data-link-type="dfn" href="#monitor" id="ref-for-monitor⑥">monitor</a> those <code>plugin-types</code> directives on the
    plugin document as well.</p>
     <section class="informative">
      <h4 class="heading settled" data-level="7.12.1" id="plugin-types-usage"><span class="secno">7.12.1. </span><span class="content">Usage</span><a class="self-link" href="#plugin-types-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>The <code>plugin-types</code> directive whitelists a certain set
      of MIME types that can be embedded in a protected resource. For
      example, a site might want to ensure that PDF content loads, but that
      no other plugins can be instantiated. The following directive would
      satisfy that requirement:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#plugin-types" id="ref-for-plugin-types②">plugin-types</a> application/pdf</pre>
      <p>Resources embedded via an <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element⑧">embed</a></code> or <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element①⓪">object</a></code> element delivered with an <code>application/pdf</code> content type would be rendered in the
      appropriate plugin; resources delivered with some other content type
      would be blocked. Multiple types can be specified, in any order. If the
      site decided to additionally allow Flash at some point in the future, it
      could do so with the following directive:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#plugin-types" id="ref-for-plugin-types③">plugin-types</a> application/pdf application/x-shockwave-flash</pre>
      <p class="note" role="note"><span class="marker">Note:</span> Wildcards are not accepted in the <code>plugin-types</code> directive. Only the resource types explicitly listed in the directive
      will be allowed.</p>
     </section>
     <section class="informative">
      <h4 class="heading settled" data-level="7.12.2" id="plugin-types-predeclaration"><span class="secno">7.12.2. </span><span class="content"> Predeclaration of expected media types </span><a class="self-link" href="#plugin-types-predeclaration"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>Enforcing the <code>plugin-types</code> directive requires that <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element" id="ref-for-the-object-element①①">object</a></code> and <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element" id="ref-for-the-embed-element⑨">embed</a></code> elements declare the expected media type of the resource they include via
      the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type" id="ref-for-attr-object-type②">type</a></code> attribute. If an author expects
      to load a PDF, she could specify this as follows:</p>
<pre>&lt;object data="<var>resource</var>" type="application/pdf">&lt;/object></pre>
      <p>If <var>resource</var> isn’t actually a PDF file, it won’t
      load. This prevents certain types of attacks that rely on serving
      content that unexpectedly invokes a plugin other than that which the
      author intended.</p>
      <p class="note" role="note"><span class="marker">Note:</span> <var>resource</var> will not load in this scenario even
      if its media type is otherwise whitelisted: resources will only load
      when their media type is whitelisted <em>and</em> matches the
      declared type in their containing element.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.13" id="directive-report-uri"><span class="secno">7.13. </span><span class="content"><code>report-uri</code></span><a class="self-link" href="#directive-report-uri"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="report-uri">report-uri</dfn></code> directive specifies a URL to
    which the user agent sends reports about policy violation. The syntax
    for the name and value of the directive are described by the following
    ABNF grammar:</p>
<pre>directive-name    = "report-uri"
directive-value   = <a data-link-type="dfn" href="#uri-reference" id="ref-for-uri-reference">uri-reference</a> *( 1*WSP <a data-link-type="dfn" href="#uri-reference" id="ref-for-uri-reference①">uri-reference</a> )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="uri-reference">uri-reference</dfn>     = &lt;URI-reference from RFC 3986>
</pre>
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="set-of-report-urls">set of report URLs</dfn> is the value of the <code>report-uri</code> directive, each resolved relative to the
    protected resource’s URL.</p>
     <p>The process of sending violation reports to the URLs specified in
    this directive’s value is defined in this document’s <a href="#violation-reports">§ 4.4 Reporting</a> section.</p>
     <p class="note" role="note"><span class="marker">Note:</span> The <code>report-uri</code> directive will be ignored if contained
    within a <a href="#delivery-html-meta-element"><code>meta</code> element</a>.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.14" id="directive-sandbox"><span class="secno">7.14. </span><span class="content"><code>sandbox</code></span><a class="self-link" href="#directive-sandbox"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sandbox">sandbox</dfn></code> directive specifies an HTML
    sandbox policy that the user agent applies to the protected resource.
    The syntax for the name and value of the directive are described by
    the following ABNF grammar:</p>
<pre>directive-name    = "sandbox"
directive-value   = "" / sandbox-token *( 1*WSP <a data-link-type="dfn" href="#sandbox-token" id="ref-for-sandbox-token">sandbox-token</a> )
<dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="sandbox-token">sandbox-token</dfn>     = &lt;token from RFC 7230>
</pre>
     <p>When enforcing the <code>sandbox</code> directive, the user agent
    MUST <a data-link-type="dfn">parse a sandboxing directive</a> using the <code>directive-value</code> as the <em>input</em> and protected
    resource’s <a data-link-type="dfn">forced sandboxing flag set</a> as the output. <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a></p>
     <p>The <code>sandbox</code> directive will be ignored when <a data-link-type="dfn" href="#monitor" id="ref-for-monitor⑦">monitoring</a> a policy, and when contained in a policy defined via a <a href="#delivery-html-meta-element"><code>meta</code> element</a>.
    Moreover, this directive has no effect when <a data-link-type="dfn" href="#monitor" id="ref-for-monitor⑧">monitored</a>, and has no
    reporting requirements.</p>
     <h4 class="heading settled" data-level="7.14.1" id="sandboxing-and-workers"><span class="secno">7.14.1. </span><span class="content">Sandboxing and Workers</span><a class="self-link" href="#sandboxing-and-workers"></a></h4>
     <p>When delivered via an HTTP header, a Content Security Policy may indicate
    that sandboxing flags ought to be applied to a JavaScript execution
    environment that is not a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-document" id="ref-for-interface-document">Document</a></code>. Of particular interest is the
    script content intended for use as a Worker, Shared Worker, or Service
    Worker. Many of the sandboxing flags do not apply to such environments, but <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts" id="ref-for-attr-iframe-sandbox-allow-scripts">allow-scripts</a> and <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin" id="ref-for-attr-iframe-sandbox-allow-same-origin">allow-same-origin</a> have special
    requirements.</p>
     <p>When a resource is loaded while executing the <a data-link-type="dfn" href="#runs-a-worker" id="ref-for-runs-a-worker①">runs a <code>Worker</code></a> algorithm, the user agent MUST act as if there was
    a fatal network error and no resource could be obtained if either of the
    following conditions holds:</p>
     <ol>
      <li> The <code><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox②">sandbox</a></code> directive delivered with the resource
        does <em>not</em> contain the <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts" id="ref-for-attr-iframe-sandbox-allow-scripts①">allow-scripts</a> flag. 
      <li> The <code><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox③">sandbox</a></code> directive delivered with the resource
        does <em>not</em> contain the <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin" id="ref-for-attr-iframe-sandbox-allow-same-origin①">allow-same-origin</a> flag, <em>and</em> the creation of the new execution context requires it to be same-origin
        with its creating context. 
     </ol>
     <section class="informative">
      <h4 class="heading settled" data-level="7.14.2" id="sandbox-usage"><span class="secno">7.14.2. </span><span class="content">Usage</span><a class="self-link" href="#sandbox-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>HTML5 defines a <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox">sandbox</a></code> attribute for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element⑥">iframe</a></code> elements, intended to allow web authors
      to reduce the risk of including potentially untrusted content by imposing
      restrictions on that content’s abilities. When the attribute is set,
      the content is forced into a unique origin, prevented from submitting
      forms, running script, creating or navigating other browsing contexts,
      and prevented from running plugins. These restrictions can be loosened
      by setting certain flags as the attribute’s value. </p>
      <p>The <code>sandbox</code> directive allows any resource, framed or
      not, to ask for the same sorts of restrictions to be applied to
      itself.</p>
      <p>For example, a message board or email system might provide
      downloads of arbitrary attachments provided by other users. Attacks
      that rely on tricking a client into rendering one of these attachments
      could be mitigated by requesting that resources only be rendered in a
      very restrictive sandbox. Sending the <code>sandbox</code> directive
      with an empty value establishes such an environment:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox④">sandbox</a></pre>
      <p>More trusted resources might be allowed to run in an environment
      with fewer restrictions by adding <code>allow-*</code> flags to the
      directive’s value. For example, you can allow a page that you trust
      to run script, while ensuring that it isn’t treated as same-origin
      with the rest of your site. This can be accomplished by sending the <code>sandbox</code> directive with the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts" id="ref-for-attr-iframe-sandbox-allow-scripts②">allow-scripts</a></code> flag:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox⑤">sandbox</a> <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts" id="ref-for-attr-iframe-sandbox-allow-scripts③">allow-scripts</a></pre>
      <p>The set of flags available to the CSP directive should match those
      available to the <code><a data-link-type="element" href="http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element" id="ref-for-the-iframe-element⑦">iframe</a></code> attribute.
      Currently, those include:</p>
      <ul>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-forms" id="ref-for-attr-iframe-sandbox-allow-forms">allow-forms</a></code>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-pointer-lock" id="ref-for-attr-iframe-sandbox-allow-pointer-lock">allow-pointer-lock</a></code>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-popups" id="ref-for-attr-iframe-sandbox-allow-popups">allow-popups</a></code>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin" id="ref-for-attr-iframe-sandbox-allow-same-origin②">allow-same-origin</a></code>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts" id="ref-for-attr-iframe-sandbox-allow-scripts④">allow-scripts</a></code>
       <li><code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-top-navigation" id="ref-for-attr-iframe-sandbox-allow-top-navigation">allow-top-navigation</a></code>
      </ul>
      <p class="note" role="note"><span class="marker">Note:</span> Like the rest of Content Security Policy, the <code>sandbox</code> directive is meant as a defense-in-depth. Web authors would be well-served
      to use it <em>in addition to</em> standard sniffing-mitigation and
      privilege-reduction techniques.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.15" id="directive-script-src"><span class="secno">7.15. </span><span class="content"><code>script-src</code></span><a class="self-link" href="#directive-script-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="script-src">script-src</dfn></code> directive restricts which scripts the
    protected resource can execute. The directive also controls other resources,
    such as XSLT style sheets <a data-link-type="biblio" href="#biblio-xslt" title="XSL Transformations (XSLT) Version 1.0">[XSLT]</a>, which can cause the user agent to
    execute script. The syntax for the name and value of the directive are
    described by the following ABNF grammar:</p>
<pre>directive-name    = "script-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①①⓪">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-script-sources">allowed script sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list①②">parsing the <code>script-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>script-src</code>, or otherwise to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources①①">default
    sources</a>.</p>
     <p>If <code>'unsafe-inline'</code> is <strong>not</strong> in the
    list of <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources">allowed script sources</a>, or if at least one <code><a data-link-type="dfn" href="#nonce-source" id="ref-for-nonce-source③">nonce-source</a></code> or <code><a data-link-type="dfn" href="#hash-source" id="ref-for-hash-source②">hash-source</a></code> is
    present in the list of <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources①">allowed script sources</a>:</p>
     <ul>
      <li>Whenever the user agent would execute an inline script from a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element⑥">script</a></code> element that lacks a <a data-link-type="dfn" href="#valid-nonce" id="ref-for-valid-nonce">valid nonce</a> <em>and</em> lacks a <a data-link-type="dfn" href="#valid-hash" id="ref-for-valid-hash">valid hash</a> for the <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources②">allowed script
      sources</a>, instead the user agent MUST NOT execute script, <em>and</em> MUST <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①①">report a violation</a>.
      <li>Whenever the user agent would execute an inline script from an
      inline event handler, instead the user agent MUST NOT execute script, <em>and</em> MUST <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①②">report a violation</a>.
      <li>Whenever the user agent would execute script contained in a <code>javascript</code> URL, instead the user agent MUST NOT execute
      the script, <em>and</em> MUST <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①③">report a violation</a>.
     </ul>
     <p>If <code>'unsafe-eval'</code> is <strong>not</strong> in <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources③">allowed script
    sources</a>:</p>
     <ul>
      <li>Instead of evaluating their arguments, both operator <code>eval</code> and function <code>eval</code> <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> MUST throw an <code>EvalError</code> exception.
      <li>When called as a constructor, the function <code>Function</code> <a data-link-type="biblio" href="#biblio-ecma-262" title="ECMAScript Language Specification">[ECMA-262]</a> MUST throw an <code>EvalError</code> exception.
      <li>When called with a first argument that is not <a data-link-type="dfn" href="#callable" id="ref-for-callable">callable</a> (a
      string, for example), the <code><a class="idl-code" data-link-type="method" href="http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-settimeout" id="ref-for-dom-windowtimers-settimeout">setTimeout()</a></code> function MUST
      return zero without creating a timer.
      <li>When called with a first argument that is not <a data-link-type="dfn" href="#callable" id="ref-for-callable①">callable</a> (a
      string, for example), the <code><a class="idl-code" data-link-type="method" href="http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-setinterval" id="ref-for-dom-windowtimers-setinterval">setInterval()</a></code> function MUST
      return zero without creating a timer.
     </ul>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch⑨">fetches</a> a URL (including when following
    redirects) in the course of one of the following activities, if the URL does
    not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list①①">match</a> the <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources④">allowed script
    sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource②①">protected resource</a>, the user agent MUST act as if
    there was a fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①④">report a violation</a>:</p>
     <ul>
      <li>Requesting a script while processing the <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/scripting-1.html#attr-script-src" id="ref-for-attr-script-src">src</a></code> attribute of
      a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element⑦">script</a></code> element that lacks a <a data-link-type="dfn" href="#valid-nonce" id="ref-for-valid-nonce①">valid nonce</a> for the <a data-link-type="dfn" href="#allowed-script-sources" id="ref-for-allowed-script-sources⑤">allowed
      script sources</a>.
      <li>Requesting a script while invoking the <code>importScripts</code> method on a WorkerGlobalScope object. <a data-link-type="biblio" href="#biblio-workers" title="Web Workers">[WORKERS]</a>
      <li>Requesting an HTML component, such as
      when processing the <code>href</code> attribute of a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element" id="ref-for-the-link-element③">link</a></code> element with a <code>rel</code> attribute containing the token <code>import</code>. <a data-link-type="biblio" href="#biblio-html-imports" title="HTML Imports">[HTML-IMPORTS]</a>
      <li>Requesting an Extensible Stylesheet Language Transformations
      (XSLT) <a data-link-type="biblio" href="#biblio-xslt" title="XSL Transformations (XSLT) Version 1.0">[XSLT]</a>, such as when processing the <code>&lt;?xml-stylesheet?></code> processing directive in an XML
      document <a data-link-type="biblio" href="#biblio-xml11" title="Extensible Markup Language (XML) 1.1 (Second Edition)">[XML11]</a>, the <code><a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-link-href" id="ref-for-attr-link-href①">href</a></code> attributes
      on <code>&lt;xsl:include></code> and <code>&lt;xsl:import></code> elements.
     </ul>
     <section class="informative">
      <h4 class="heading settled" data-level="7.15.1" id="script-src-nonce-usage"><span class="secno">7.15.1. </span><span class="content"> Nonce usage for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element⑧">script</a></code> elements </span><a class="self-link" href="#script-src-nonce-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>The <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①④">script-src</a></code> directive lets developers specify
      exactly which script elements on a page were intentionally included
      for execution. Ideally, developers would avoid inline script entirely
      and whitelist scripts by URL. However, in some cases, removing inline
      scripts can be difficult or impossible. For those cases, developers can
      whitelist scripts using a randomly generated nonce.</p>
      <p>Usage is straightforward. For <em>each</em> request, the server
      generates a unique value at random, and includes it in the <code>Content-Security-Policy</code> header:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⓪">default-src</a> 'self';
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⑤">script-src</a> 'self' https://example.com 'nonce-<em>$RANDOM</em>'
</pre>
      <p>This same value is then applied as a <code>nonce</code> attribute
      to each <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element⑨">script</a></code> element that ought to be
      executed. For example, if the server generated the random value <code>Nc3n83cnSAd3wc3Sasdfn939hc3</code>,  the server would send the
      following policy:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①①">default-src</a> 'self';
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⑥">script-src</a> 'self' https://example.com 'nonce-Nc3n83cnSAd3wc3Sasdfn939hc3'
</pre>
      <p>Script elements can then execute either because their <code><a data-link-type="element-sub" href="http://www.w3.org/TR/html5/scripting-1.html#attr-script-src" id="ref-for-attr-script-src①">src</a></code> URLs
      are whitelisted or because they have a <a data-link-type="dfn" href="#valid-nonce" id="ref-for-valid-nonce②">valid nonce</a>:</p>
<pre>&lt;script>
alert("Blocked because the policy doesn’t have 'unsafe-inline'.")
&lt;/script>

&lt;script nonce="EDNnf03nceIOfn39fn3e9h3sdfa">
alert("Still blocked because nonce is wrong.")
&lt;/script>

&lt;script nonce="Nc3n83cnSAd3wc3Sasdfn939hc3">
alert("Allowed because nonce is valid.")
&lt;/script>

&lt;script src="https://example.com/allowed-because-of-src.js">&lt;/script>

&lt;script nonce="EDNnf03nceIOfn39fn3e9h3sdfa"
    src="https://elsewhere.com/blocked-because-nonce-is-wrong.js">&lt;/script>

&lt;script nonce="Nc3n83cnSAd3wc3Sasdfn939hc3"
    src="https://elsewhere.com/allowed-because-nonce-is-valid.js">&lt;/script>
</pre>
      <p>Note that the nonce’s value is <em>not</em> a hash or signature
      that verifies the contents of the script resources. It’s quite simply
      a random string that informs the user agent which scripts were
      intentionally included in the page.</p>
      <p>Script elements with the proper nonce execute, regardless of
      whether they’re inline or external. Script elements without the
      proper nonce don’t execute unless their URLs are whitelisted.
      Even if an attacker is able to inject markup into the protected
      resource, the attack will be blocked by the attacker’s inability
      to guess the random value.</p>
     </section>
     <section class="informative">
      <h4 class="heading settled" data-level="7.15.2" id="script-src-hash-usage"><span class="secno">7.15.2. </span><span class="content"> Hash usage for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element①⓪">script</a></code> elements </span><a class="self-link" href="#script-src-hash-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>The <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⑦">script-src</a></code> directive lets developers whitelist a
      particular inline script by specifying its hash as an allowed source
      of script.</p>
      <p>Usage is straightforward. The server computes the hash of a
      particular script block’s contents, and includes the base64 encoding
      of that value in the <code>Content-Security-Policy</code> header:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①②">default-src</a> 'self';
                         <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⑧">script-src</a> 'self' https://example.com 'sha256-<var>base64 encoded hash</var>’
</pre>
      <p>Each inline script block’s contents are hashed, and compared against
      the whitelisted value. If there’s a match, the script is executed. For
      example, the SHA-256 digest of <code>alert('Hello, world.');</code> is <code>qznLcsROx4GACP2dm0UCKCzCG+HiZ1guq6ZZDob/Tng=</code>.</p>
      <div class="example" id="example-d401cd7b">
       <a class="self-link" href="#example-d401cd7b"></a> You can obtain the digest of a string on the command line simply
        via the <code>openssl</code> program. For example: 
<pre>echo -n "alert('Hello, world.');" | openssl dgst -sha256 -binary | openssl enc -base64
</pre>
      </div>
      <p>If the server sent the following header:</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①⑨">script-src</a> 'sha512-YWIzOWNiNzJjNDRlYzc4MTgwMDhmZDlkOWI0NTAyMjgyY2MyMWJlMWUyNjc1ODJlYWJhNjU5MGU4NmZmNGU3OAo='
</pre>
      <p>Then the following script tag would result in script execution:</p>
<pre>&lt;script>alert('Hello, world.');&lt;/script>
</pre>
      <p>Whitespace is significant. The following scripts blocks would not hash to
      the same value, and would therefore <em>not</em> execute:</p>
<pre>&lt;script> alert('Hello, world.');&lt;/script>
&lt;script>alert('Hello, world.'); &lt;/script>
&lt;script> alert('Hello, world.'); &lt;/script>
&lt;script>
alert('Hello, world.');
&lt;/script>
</pre>
      <p>Note also that the hash applies <em>only</em> to inline script. An
      externalized script containing the value <code>alert('Hello, world.');</code> would <em>not</em> execute if its
      origin was not whitelisted as a valid source of script.</p>
     </section>
    </section>
    <section>
     <h3 class="heading settled" data-level="7.16" id="directive-style-src"><span class="secno">7.16. </span><span class="content"><code>style-src</code></span><a class="self-link" href="#directive-style-src"></a></h3>
     <p>The <code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="style-src">style-src</dfn></code> directive restricts which styles the
    user agent applies to the protected resource. The syntax for the name and
    value of the directive are described by the following ABNF grammar:</p>
<pre>directive-name    = "style-src"
directive-value   = <a data-link-type="dfn" href="#source-list①" id="ref-for-source-list①①①">source-list</a>
</pre>
     <p>The term <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="allowed-style-sources">allowed style sources</dfn> refers to the result of <a data-link-type="dfn" href="#parse-a-source-list" id="ref-for-parse-a-source-list①③">parsing the <code>style-src</code> directive’s value as a source list</a> if the policy contains an
    explicit <code>style-src</code>, or otherwise to the <a data-link-type="dfn" href="#default-sources" id="ref-for-default-sources①②">default sources</a>.</p>
     <p>If <code>'unsafe-inline'</code> is <strong>not</strong> in the
    list of <a data-link-type="dfn" href="#allowed-style-sources" id="ref-for-allowed-style-sources">allowed style sources</a>, or if at least one <code><a data-link-type="dfn" href="#nonce-source" id="ref-for-nonce-source④">nonce-source</a></code> or <code><a data-link-type="dfn" href="#hash-source" id="ref-for-hash-source③">hash-source</a></code> is present in the list of <a data-link-type="dfn" href="#allowed-style-sources" id="ref-for-allowed-style-sources①">allowed style sources</a>:</p>
     <ul>
      <li>Whenever the user agent would apply style from a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element②">style</a></code> element that lacks a <a data-link-type="dfn" href="#valid-nonce" id="ref-for-valid-nonce③">valid nonce</a> <em>and</em> lacks a <a data-link-type="dfn" href="#valid-hash" id="ref-for-valid-hash①">valid hash</a> for the <a data-link-type="dfn" href="#allowed-style-sources" id="ref-for-allowed-style-sources②">allowed style sources</a>, instead the user agent <code>MUST</code> ignore the style, <em>and</em> MUST <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①⑤">report a violation</a>.
      <li>Whenever the user agent would apply style from a <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element③">style</a></code> attribute, instead the user agent <code>MUST</code> ignore the style, <em>and</em> MUST <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①⑥">report a
      violation</a>.
     </ul>
     <p class="note" role="note"><span class="marker">Note:</span> These restrictions on inline do not prevent the user agent
    from applying style from an external stylesheet (e.g., found via <code>&lt;link rel="stylesheet" ...></code>).</p>
     <p>If <code>'unsafe-eval'</code> is <strong>not</strong> in <a data-link-type="dfn" href="#allowed-style-sources" id="ref-for-allowed-style-sources③">allowed style
    sources</a>, then:</p>
     <ul>
      <li>Whenever the user agent would invoke the Cascading Style Sheets
      Object Model algorithms <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#insert-a-css-rule" id="ref-for-insert-a-css-rule">insert a CSS rule</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#parse-a-css-rule" id="ref-for-parse-a-css-rule">parse a CSS rule</a>, <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#parse-a-css-declaration-block" id="ref-for-parse-a-css-declaration-block">parse a CSS declaration block</a>, or <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#parse-a-group-of-selectors" id="ref-for-parse-a-group-of-selectors">parse a group of selectors</a> instead the user agent MUST throw a <a data-link-type="dfn">SecurityError</a> exception <em>and</em> terminate the algorithm. This would include,
      for example, all invocations of CSSOM’s various <code>cssText</code> setters and <code>insertRule</code> methods. <a data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> <a data-link-type="biblio" href="#biblio-html5" title="HTML5">[HTML5]</a>
     </ul>
     <p>Whenever the user agent <a data-link-type="dfn" href="http://www.w3.org/TR/html5/infrastructure.html#fetch" id="ref-for-fetch①⓪">fetches</a> a URL in the course of one of the
    following activities, if the URL does not <a data-link-type="dfn" href="#match-a-source-list" id="ref-for-match-a-source-list①②">match</a> the <a data-link-type="dfn" href="#allowed-style-sources" id="ref-for-allowed-style-sources④">allowed style sources</a> for the <a data-link-type="dfn" href="#protected-resource" id="ref-for-protected-resource②②">protected resource</a>, the user agent MUST act as if there was
    a fatal network error and no resource was obtained, <em>and</em> <a data-link-type="dfn" href="#report-a-violation" id="ref-for-report-a-violation①⑦">report
    a violation</a>:</p>
     <ul>
      <li> Requesting an external stylesheet when processing the <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-link-href" id="ref-for-attr-link-href②">href</a> of a <a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-link-element" id="ref-for-the-link-element④">link</a> element
        whose <a data-link-type="element-attr" href="http://www.w3.org/TR/html5/document-metadata.html#attr-link-rel" id="ref-for-attr-link-rel①">rel</a> attribute contains the token <code><a data-link-type="dfn" href="http://www.w3.org/TR/html5/links.html#link-type-stylesheet" id="ref-for-link-type-stylesheet">stylesheet</a></code>. 
      <li> Requesting an external stylesheet when processing the &lt;&lt;@import>>
        directive. 
      <li>
        Requesting an external stylesheet when processing a <code>Link</code> HTTP response header field. <a data-link-type="biblio" href="#biblio-rfc5988" title="Web Linking">[RFC5988]</a> 
       <p class="note" role="note"><span class="marker">Note:</span> As this stylesheet might be prefetched before a <code class="idl"><a data-link-type="idl" href="http://www.w3.org/TR/dom/#interface-document" id="ref-for-interface-document①">Document</a></code> actually exists, user agents will need to carefully consider how to
        instantiate a meaningful <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy⑧">policy</a> against which to compare this
        request. See <a href="#complications">§ 10.1 Processing Complications</a> for more detail.</p>
     </ul>
     <p class="note" role="note"><span class="marker">Note:</span> The <code>style-src</code> directive does not restrict the
    use of XSLT. XSLT is restricted by the <code><a data-link-type="dfn" href="#script-src" id="ref-for-script-src②⓪">script-src</a></code> directive because the security consequences of including an untrusted
    XSLT stylesheet are similar to those incurred by including an
    untrusted script.</p>
     <section class="informative">
      <h4 class="heading settled" data-level="7.16.1" id="style-src-nonce-usage"><span class="secno">7.16.1. </span><span class="content"> Nonce usage for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element④">style</a></code> elements </span><a class="self-link" href="#style-src-nonce-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>See the <a href="#script-src-nonce-usage"><code>script-src</code> nonce usage information</a> for detail; the application of nonces
      to <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element⑤">style</a></code> elements is similar enough to avoid
      repetition here.</p>
     </section>
     <section class="informative">
      <h4 class="heading settled" data-level="7.16.2" id="style-src-hash-usage"><span class="secno">7.16.2. </span><span class="content"> Hash usage for <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element⑥">style</a></code> elements </span><a class="self-link" href="#style-src-hash-usage"></a></h4>
      <p><em>This section is not normative.</em></p>
      <p>See the <a href="#script-src-hash-usage"><code>script-src</code> hash usage information</a> for detail; the application of hashes
      to <code><a data-link-type="element" href="http://www.w3.org/TR/html5/document-metadata.html#the-style-element" id="ref-for-the-style-element⑦">style</a></code> elements is similar enough to avoid
      repetition here.</p>
     </section>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="examples"><span class="secno">8. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
    <section class="informative">
     <h3 class="heading settled" data-level="8.1" id="example-policies"><span class="secno">8.1. </span><span class="content">Sample Policy Definitions</span><a class="self-link" href="#example-policies"></a></h3>
     <p>This section provides some sample use cases and supporting <a data-link-type="dfn" href="#security-policy" id="ref-for-security-policy⑨">policies</a>.</p>
     <div class="example" id="example-f9265a16">
      <a class="self-link" href="#example-f9265a16"></a> A server wishes to load resources only from its own origin: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①③">default-src</a> 'self'</pre>
     </div>
     <div class="example" id="example-9fb4df6f">
      <a class="self-link" href="#example-9fb4df6f"></a> An auction site wishes to load images from any URL, plugin content from a
      list of trusted media providers (including a content distribution network),
      and scripts only from a server under its control hosting sanitized
      ECMAScript: 
<pre>Content-Security-Policy:
    <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①④">default-src</a> 'self'; img-src *;
    <a data-link-type="dfn" href="#object-src" id="ref-for-object-src④">object-src</a> media1.example.com media2.example.com *.cdn.example.com;
    <a data-link-type="dfn" href="#script-src" id="ref-for-script-src②①">script-src</a> trustedscripts.example.com
</pre>
     </div>
     <div class="example" id="example-d59a1963">
      <a class="self-link" href="#example-d59a1963"></a> An online banking site wishes to ensure that all of the content in its pages
      is loaded over TLS to prevent attackers from eavesdropping on insecure
      content requests: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⑤">default-src</a> https: 'unsafe-inline' 'unsafe-eval'</pre>
      <p>This policy allows inline content (such as inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element①①">script</a></code> elements), use of <code>eval</code>,
      and loading resources over <code>https</code>. Note: This policy does
      not provide any protection from cross-site scripting vulnerabilities.</p>
     </div>
     <div class="example" id="example-a77fd40c">
      <a class="self-link" href="#example-a77fd40c"></a> A website that relies on inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element①②">script</a></code> elements
      wishes to ensure that script is only executed from its own origin, and those
      elements it intentionally inserted inline: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src②②">script-src</a> 'self' 'nonce-<em>$RANDOM</em>';</pre>
      <p>The inline <code><a data-link-type="element" href="http://www.w3.org/TR/html5/scripting-1.html#the-script-element" id="ref-for-the-script-element①③">script</a></code> elements would then only
      execute if they contained a matching <code><a data-link-type="element-attr" href="#element-attrdef-script-nonce" id="ref-for-element-attrdef-script-nonce①">nonce</a></code> attribute:</p>
<pre>&lt;script nonce="<em>$RANDOM</em>">...&lt;/script></pre>
     </div>
    </section>
    <section class="informative">
     <h3 class="heading settled" data-level="8.2" id="example-violation-report"><span class="secno">8.2. </span><span class="content">Sample Violation Report</span><a class="self-link" href="#example-violation-report"></a></h3>
     <p>This section contains an example violation report the user agent
    might sent to a server when the protected resource violations a sample
    policy.</p>
     <p>In the following example, the user agent rendered a representation
    of the resource <code>http://example.org/page.html</code> with the
    following policy:</p>
<pre><a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⑥">default-src</a> 'self'; <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri④">report-uri</a> http://example.org/csp-report.cgi</pre>
     <p>The protected resource loaded an image from <code>http://evil.example.com/image.png</code>, violating the
    policy.</p>
<pre>{
  "csp-report": {
    "document-uri": "http://example.org/page.html",
    "referrer": "http://evil.example.com/haxor.html",
    "blocked-uri": "http://evil.example.com/image.png",
    "violated-directive": "default-src 'self'",
    "effective-directive": "img-src",
    "original-policy": "default-src 'self'; report-uri http://example.org/csp-report.cgi"
  }
}
</pre>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="security-considerations"><span class="secno">9. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    <section>
     <h3 class="heading settled" data-level="9.1" id="security-css-parsing"><span class="secno">9.1. </span><span class="content">Cascading Style Sheet (CSS) Parsing</span><a class="self-link" href="#security-css-parsing"></a></h3>
     <p>The <code><a data-link-type="dfn" href="#style-src" id="ref-for-style-src①">style-src</a></code> directive restricts the locations from
    which the protected resource can load styles. However, if the user agent uses a
    lax CSS parsing algorithm, an attacker might be able to trick the user
    agent into accepting malicious "stylesheets" hosted by an otherwise
    trustworthy origin.</p>
     <p>These attacks are similar to the <a href="http://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html">CSS
    cross-origin data leakage</a> attack described by Chris Evans in 2009.
    User agents SHOULD defend against both attacks using the same
    mechanism: stricter CSS parsing rules for style sheets with improper
    MIME types.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="9.2" id="security-redirects"><span class="secno">9.2. </span><span class="content">Redirect Information Leakage</span><a class="self-link" href="#security-redirects"></a></h3>
     <p>The violation reporting mechanism in this document has been
    designed to mitigate the risk that a malicious web site could use
    violation reports to probe the behavior of other servers. For example,
    consider a malicious web site that white lists <code>https://example.com</code> as a source of images. If the malicious site attempts to load <code>https://example.com/login</code> as an image, and the <code>example.com</code> server redirects to an identity provider (e.g., <code>identityprovider.example.net</code>), CSP will block the request.
    If violation reports contained the full blocked URL, the violation
    report might contain sensitive information contained in the redirected URL,
    such as session identifiers or purported identities. For this reason, the
    user agent includes only the origin of the blocked URL.</p>
     <p>The mitigations are not complete, however: redirects which are blocked will
    produce side-effects which may be visible to JavaScript (via <code>img.naturalHeight</code>, for instance). An earlier version of this
    specification defined a <a href="http://www.w3.org/TR/2015/CR-CSP2-20150721/#csp-request-header"><code>CSP</code> request header</a> which servers could use (in conjunction with the <code>referer</code> and <code>origin</code> headers) to determine whether
    or not it was completely safe to redirect a user. This header caused some
    issues with CORS processing (tracked in <a href="https://github.com/whatwg/fetch/issues/52">whatwg/fetch#52</a>),
    and has been punted to the next version of this document.</p>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="implementation-considerations"><span class="secno">10. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
    <p>The <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy②">Content-Security-Policy</a></code> header is an end-to-end
  header. It is processed and enforced at the client and, therefore,
  SHOULD NOT be modified or removed by proxies or other intermediaries not
  in the same administrative domain as the resource.</p>
    <p>The originating administrative domain for a resource might wish to
  apply a <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy③">Content-Security-Policy</a></code> header outside of the
  immediate context of an application. For example, a large organization
  might have many resources and applications managed by different
  individuals or teams but all subject to a uniform organizational
  standard. In such situations, a <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy④">Content-Security-Policy</a></code> header might be added or combined with an existing one at a network-edge
  security gateway device or web application firewall. To enforce multiple
  policies, the administrator SHOULD combine the policy into a single header.
  An administrator might wish to use different combination algorithms
  depending on his or her intended semantics.</p>
    <p>One sensible policy combination algorithm is to start by allowing a
  default set of sources and then letting individual upstream resource
  owners expand the set of allowed sources by including additional origins.
  In this approach, the resultant policy is the union of all allowed
  origins in the input policies.</p>
    <p>Another sensible policy combination algorithm is to intersect the
  given policies. This approach enforces that content comes from a certain
  whitelist of origins, for example, preventing developers from including
  third-party scripts or content in violation of organizational standards
  and practices. In this approach, the combination algorithm forms the
  combined policy by removing disallowed hosts from the policies supplied
  by upstream resource owners.</p>
    <p>Interactions between the <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⑦">default-src</a></code> and other directives
  SHOULD be given special consideration when combining policies. If none
  of the policies contains a <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⑧">default-src</a></code> directive, adding new
  src directives results in a more restrictive policy. However, if one or
  more of the input policies contain a <code><a data-link-type="dfn" href="#default-src" id="ref-for-default-src①⑨">default-src</a></code> directive,
  adding new src directives might result in a less restrictive policy, for
  example, if the more specific directive contains a more permissive set of
  allowed origins.</p>
    <p>Using a more restrictive policy than the input policy authored by the
  resource owner might prevent the resource from rendering or operating as
  intended.</p>
    <p class="note" role="note"><span class="marker">Note:</span> Migration to <code>HTTPS</code> from <code>HTTP</code> may require updates to the policy in order to keep things running as
  before. Source expressions like <code>http://example.com</code> do <em>not</em> match <code>HTTPS</code> resources. For example,
  administrators SHOULD carefully examine existing policies before rolling
  out <a href="https://tools.ietf.org/html/rfc6797">HTTP Strict Transport Security</a> headers for an application. <a data-link-type="biblio" href="#biblio-rfc6797" title="HTTP Strict Transport Security (HSTS)">[RFC6797]</a></p>
    <div class="note" role="note">
      Server administrators MAY wish to send multiple policies if different
    reporting options are desired for subsets of an overall policy. For instance,
    the following headers: 
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors④">frame-ancestors</a> https://example.com/ 
Content-Security-Policy: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src②⓪">default-src</a> https:; report-uri https://example.com/
</pre>
     <p>would send violation reports for <code>http</code> resources, but would not
    send violation reports for <code><a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors⑤">frame-ancestors</a></code> violations.
    Note also that combining them via '<code>,</code>' into the single header</p>
<pre>Content-Security-Policy: <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors⑥">frame-ancestors</a> https://example.com/, <a data-link-type="dfn" href="#default-src" id="ref-for-default-src②①">default-src</a> https:; report-uri https://example.com/
</pre>
     <p>would have the same effect, as the comma splits the header during parsing.</p>
    </div>
    <h3 class="heading settled" data-level="10.1" id="complications"><span class="secno">10.1. </span><span class="content">Processing Complications</span><a class="self-link" href="#complications"></a></h3>
    <p>Many user agents implement some form of optimistic resource fetching algorithm
  to speed up page loads. In implementing these features, user agents MUST
  ensure that these optimizations do not alter the behavior of the page’s
  security policy.</p>
    <p>Here, we’ll note a few potential complications that could cause bugs in
  implementations:</p>
    <ol>
     <li> The <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors⑦">frame-ancestor</a> directive MUST take effect before a document is
      loaded into a <a data-link-type="dfn" href="http://www.w3.org/TR/html5/browsers.html#nested-browsing-context" id="ref-for-nested-browsing-context⑥">nested browsing context</a>, and certainly before script
      is potentially executed. One way to approach this constraint is to perform
      the ancestor check defined in <a href="#directive-frame-ancestors">§ 7.7 frame-ancestors</a> while parsing
      the document’s headers. This might mean that no document object is
      available at all, which can complicate checks against <code>'self'</code>,
      and <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-scheme" id="ref-for-concept-url-scheme④">scheme</a>- or <a data-link-type="dfn" href="http://www.w3.org/TR/url/#concept-url-port" id="ref-for-concept-url-port①">port</a>-relative source expressions. 
     <li>
       Likewise, the <code>Link</code> HTTP response header could generate
      requests for stylesheet resources before a document is available. User
      agents MUST ensure that any policy contained in the response headers is
      parsed and effective <em>before</em> these requests are generated. For
      example, a response returning the following headers: 
<pre>Content-Security-Policy: style-src 'none'
Link: &lt;awesome.css>; rel=stylesheet
</pre>
      <p>MUST have the same behavior as a response returning the following headers:</p>
<pre>Link: &lt;awesome.css>; rel=stylesheet
Content-Security-Policy: style-src 'none'
</pre>
      <p>namely, both must block requests for the stylesheet. To meet this
      requirement user agents MUST wait until all headers have been processed
      before beginning to prefetch resources.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="iana-considerations"><span class="secno">11. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <p>The permanent message header field registry should be updated
  with the following registrations: <a data-link-type="biblio" href="#biblio-rfc3864" title="Registration Procedures for Message Header Fields">[RFC3864]</a></p>
    <section>
     <h3 class="heading settled" data-level="11.1" id="iana-content-security-policy"><span class="secno">11.1. </span><span class="content">Content-Security-Policy</span><a class="self-link" href="#iana-content-security-policy"></a></h3>
     <dl>
      <dt>Header field name
      <dd>Content-Security-Policy
      <dt>Applicable protocol
      <dd>http
      <dt>Status
      <dd>standard
      <dt>Author/Change controller
      <dd>W3C
      <dt>Specification document
      <dd>This specification (See <code><a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy⑤">Content-Security-Policy</a></code> Header Field)
     </dl>
    </section>
    <section>
     <h3 class="heading settled" data-level="11.2" id="iana-content-security-policy-report-only"><span class="secno">11.2. </span><span class="content">Content-Security-Policy-Report-Only</span><a class="self-link" href="#iana-content-security-policy-report-only"></a></h3>
     <dl>
      <dt>Header field name
      <dd>Content-Security-Policy-Report-Only
      <dt>Applicable protocol
      <dd>http
      <dt>Status
      <dd>standard
      <dt>Author/Change controller
      <dd>W3C
      <dt>Specification document
      <dd>This specification (See <code><a data-link-type="dfn" href="#content-security-policy-report-only" id="ref-for-content-security-policy-report-only③">Content-Security-Policy-Report-Only</a></code> Header Field)
     </dl>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="12" id="acknowledgements"><span class="secno">12. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>In addition to the documents in the W3C Web Application Security working
  group, the work on this document is also informed by the work of the <a href="https://tools.ietf.org/wg/websec/">IETF websec working group</a>,
  particularly that working group’s requirements document: <a href="https://tools.ietf.org/id/draft-hodges-websec-framework-reqs">draft-hodges-websec-framework-reqs</a>.</p>
    <p>A portion of the <code><a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors⑧">frame-ancestors</a></code> directive was
  originally developed as <code>X-Frame-Options</code>. <a data-link-type="biblio" href="#biblio-rfc7034" title="HTTP Header Field X-Frame-Options">[RFC7034]</a></p>
    <p>Brian Smith, Neil Matatall, Anne van Kesteren, and Sigbjørn Vik provided
  particularly insightful feedback to keep this specification sane.</p>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#allowed-base-urls">allowed base URLs</a><span>, in § 7.1</span>
   <li><a href="#allowed-child-sources">allowed child sources</a><span>, in § 7.2</span>
   <li><a href="#allowed-connection-targets">allowed connection targets</a><span>, in § 7.3</span>
   <li><a href="#allowed-font-sources">allowed font sources</a><span>, in § 7.5</span>
   <li><a href="#allowed-form-actions">allowed form actions</a><span>, in § 7.6</span>
   <li><a href="#allowed-frame-ancestors">allowed frame ancestors</a><span>, in § 7.7</span>
   <li><a href="#allowed-frame-sources">allowed frame sources</a><span>, in § 7.8</span>
   <li><a href="#allowed-image-sources">allowed image sources</a><span>, in § 7.9</span>
   <li><a href="#allowed-media-sources">allowed media sources</a><span>, in § 7.10</span>
   <li><a href="#allowed-object-sources">allowed object sources</a><span>, in § 7.11</span>
   <li><a href="#allowed-plugin-media-types">allowed plugin media types</a><span>, in § 7.12</span>
   <li><a href="#allowed-script-sources">allowed script sources</a><span>, in § 7.15</span>
   <li><a href="#allowed-style-sources">allowed style sources</a><span>, in § 7.16</span>
   <li><a href="#alpha">ALPHA</a><span>, in § 2.4</span>
   <li><a href="#ancestor-source">ancestor-source</a><span>, in § 7.7</span>
   <li><a href="#ancestor-source-list">ancestor-source-list</a><span>, in § 7.7</span>
   <li><a href="#base64-value">base64-value</a><span>, in § 4.2</span>
   <li><a href="#base-uri">base-uri</a><span>, in § 7.1</span>
   <li>
    blockedURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-blockeduri">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-blockeduri">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#callable">callable</a><span>, in § 2.3</span>
   <li><a href="#callers">callers</a><span>, in § 2.3</span>
   <li><a href="#child-src">child-src</a><span>, in § 7.2</span>
   <li>
    columnNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-columnnumber">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-columnnumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#connect-src">connect-src</a><span>, in § 7.3</span>
   <li><a href="#content-security-policy">Content-Security-Policy</a><span>, in § 3.1</span>
   <li><a href="#content-security-policy-report-only">Content-Security-Policy-Report-Only</a><span>, in § 3.2</span>
   <li><a href="#content-security-policy-task-source">Content Security Policy task source</a><span>, in § 4.4</span>
   <li><a href="#default-sources">default sources</a><span>, in § 7.4</span>
   <li><a href="#default-src">default-src</a><span>, in § 7.4</span>
   <li><a href="#digest-of-elements-content">digest of element’s content</a><span>, in § 4.2.5</span>
   <li><a href="#digit">DIGIT</a><span>, in § 2.4</span>
   <li><a href="#security-policy-directive">directive</a><span>, in § 2.1</span>
   <li><a href="#security-policy-directive-name">directive name</a><span>, in § 2.1</span>
   <li><a href="#directive-name">directive-name</a><span>, in § 4.1</span>
   <li><a href="#directive-token">directive-token</a><span>, in § 4.1</span>
   <li><a href="#security-policy-directive-value">directive value</a><span>, in § 2.1</span>
   <li><a href="#directive-value">directive-value</a><span>, in § 4.1</span>
   <li>
    documentURI
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-documenturi">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-documenturi">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li>
    effectiveDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-effectivedirective">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-effectivedirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#elements-content">element’s content</a><span>, in § 4.2.5</span>
   <li><a href="#enforce">enforce</a><span>, in § 5</span>
   <li><a href="#fire-a-violation-event">fire a violation event</a><span>, in § 6.3</span>
   <li><a href="#font-src">font-src</a><span>, in § 7.5</span>
   <li><a href="#form-action">form-action</a><span>, in § 7.6</span>
   <li><a href="#frame-ancestors">frame-ancestors</a><span>, in § 7.7</span>
   <li><a href="#frame-src">frame-src</a><span>, in § 7.8</span>
   <li><a href="#generate-a-violation-report-object">generate a violation report object</a><span>, in § 4.4</span>
   <li><a href="#generate-a-violation-report-object">generating a violation report object</a><span>, in § 4.4</span>
   <li><a href="#globally-unique-identifier">globally unique identifier</a><span>, in § 2.2</span>
   <li><a href="#hash-algo">hash-algo</a><span>, in § 4.2</span>
   <li><a href="#hash-source">hash-source</a><span>, in § 4.2</span>
   <li><a href="#hash-value">hash-value</a><span>, in § 4.2</span>
   <li><a href="#host-char">host-char</a><span>, in § 4.2</span>
   <li><a href="#host-part">host-part</a><span>, in § 4.2</span>
   <li><a href="#host-source">host-source</a><span>, in § 4.2</span>
   <li><a href="#http-200-response">HTTP 200 response</a><span>, in § 2.2</span>
   <li><a href="#img-src">img-src</a><span>, in § 7.9</span>
   <li><a href="#json-object">JSON object</a><span>, in § 2.2</span>
   <li><a href="#json-stringification">JSON stringification</a><span>, in § 2.2</span>
   <li><a href="#keyword-source">keyword-source</a><span>, in § 4.2</span>
   <li>
    lineNumber
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-linenumber">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-linenumber">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#match-a-media-type-list">match a media type list</a><span>, in § 4.3.2</span>
   <li><a href="#match-a-source-expression">match a source expression</a><span>, in § 4.2.2</span>
   <li><a href="#match-a-source-list">match a source list</a><span>, in § 4.2.2</span>
   <li><a href="#media-src">media-src</a><span>, in § 7.10</span>
   <li><a href="#media-type">media type</a><span>, in § 4.3</span>
   <li><a href="#media-type①">media-type</a><span>, in § 4.3</span>
   <li><a href="#media-type-list">media type list</a><span>, in § 4.3</span>
   <li><a href="#media-type-list①">media-type-list</a><span>, in § 4.3</span>
   <li><a href="#monitor">monitor</a><span>, in § 5</span>
   <li>
    nonce
    <ul>
     <li><a href="#dom-htmlscriptelement-nonce">attribute for HTMLScriptElement</a><span>, in § 4.2.3</span>
     <li><a href="#dom-htmlstyleelement-nonce">attribute for HTMLStyleElement</a><span>, in § 4.2.3</span>
     <li><a href="#element-attrdef-script-nonce">element-attr for script</a><span>, in § 4.2.3</span>
     <li><a href="#element-attrdef-style-nonce">element-attr for style</a><span>, in § 4.2.3</span>
    </ul>
   <li><a href="#nonce-source">nonce-source</a><span>, in § 4.2</span>
   <li><a href="#nonce-value">nonce-value</a><span>, in § 4.2</span>
   <li><a href="#object-src">object-src</a><span>, in § 7.11</span>
   <li><a href="#origin">origin</a><span>, in § 2.2</span>
   <li>
    originalPolicy
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-originalpolicy">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-originalpolicy">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#parse-a-media-type-list">parse a media type list</a><span>, in § 4.3.1</span>
   <li><a href="#parse-a-source-list">parse a source list</a><span>, in § 4.2.1</span>
   <li><a href="#parse-the-policy">parse the policy</a><span>, in § 4.1.1</span>
   <li><a href="#path-part">path-part</a><span>, in § 4.2</span>
   <li><a href="#plugin-types">plugin-types</a><span>, in § 7.12</span>
   <li><a href="#security-policy">policy</a><span>, in § 2.1</span>
   <li><a href="#policy-token">policy-token</a><span>, in § 4.1</span>
   <li><a href="#port-part">port-part</a><span>, in § 4.2</span>
   <li><a href="#protected-resource">protected resource</a><span>, in § 2.1</span>
   <li>
    referrer
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-referrer">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-referrer">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#report-a-violation">report a violation</a><span>, in § 4.4</span>
   <li><a href="#report-uri">report-uri</a><span>, in § 7.13</span>
   <li><a href="#resource-representation">representation</a><span>, in § 2.2</span>
   <li><a href="#resource-representation">resource representation</a><span>, in § 2.2</span>
   <li><a href="#runs-a-worker">runs a worker</a><span>, in § 2.3</span>
   <li><a href="#sandbox">sandbox</a><span>, in § 7.14</span>
   <li><a href="#sandbox-token">sandbox-token</a><span>, in § 7.14</span>
   <li><a href="#scheme-part">scheme-part</a><span>, in § 4.2</span>
   <li><a href="#scheme-source">scheme-source</a><span>, in § 4.2</span>
   <li><a href="#script-src">script-src</a><span>, in § 7.15</span>
   <li><a href="#security-policy">security policy</a><span>, in § 2.1</span>
   <li><a href="#security-policy-directive">security policy directive</a><span>, in § 2.1</span>
   <li><a href="#security-policy-directive-name">security policy directive name</a><span>, in § 2.1</span>
   <li><a href="#security-policy-directive-value">security policy directive value</a><span>, in § 2.1</span>
   <li><a href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
   <li><a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
   <li><a href="#send-violation-reports">send violation reports</a><span>, in § 4.4</span>
   <li><a href="#set-of-report-urls">set of report URLs</a><span>, in § 7.13</span>
   <li><a href="#sha-256">SHA-256</a><span>, in § 2.2</span>
   <li><a href="#sha-384">SHA-384</a><span>, in § 2.2</span>
   <li><a href="#sha-512">SHA-512</a><span>, in § 2.2</span>
   <li><a href="#source-expression">source expression</a><span>, in § 4.2</span>
   <li><a href="#source-expression①">source-expression</a><span>, in § 4.2</span>
   <li><a href="#source-file">source-file</a><span>, in § 4.4</span>
   <li>
    sourceFile
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-sourcefile">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-sourcefile">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#source-list">source list</a><span>, in § 4.2</span>
   <li><a href="#source-list①">source-list</a><span>, in § 4.2</span>
   <li><a href="#dom-securitypolicyviolationevent-statuscode">statusCode</a><span>, in § 6.1</span>
   <li><a href="#strip-uri-for-reporting">stripped for reporting</a><span>, in § 4.4</span>
   <li><a href="#strip-uri-for-reporting">strip uri for reporting</a><span>, in § 4.4</span>
   <li><a href="#style-src">style-src</a><span>, in § 7.16</span>
   <li><a href="#uri-reference">uri-reference</a><span>, in § 7.13</span>
   <li><a href="#url">URL</a><span>, in § 2.2</span>
   <li><a href="#valid-hash">valid hash</a><span>, in § 4.2.5</span>
   <li><a href="#valid-nonce">valid nonce</a><span>, in § 4.2.4</span>
   <li><a href="#vchar">VCHAR</a><span>, in § 2.4</span>
   <li>
    violatedDirective
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-violateddirective">attribute for SecurityPolicyViolationEvent</a><span>, in § 6.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-violateddirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 6.2</span>
    </ul>
   <li><a href="#wsp">WSP</a><span>, in § 2.4</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="298863fc">Document</span>
     <li><span class="dfn-paneled" id="7a3fe402">Event</span>
     <li><span class="dfn-paneled" id="6ba5480f">EventInit</span>
     <li><span class="dfn-paneled" id="5d771b5e">HTMLScriptElement</span>
     <li><span class="dfn-paneled" id="b289f2bd">HTMLStyleElement</span>
     <li><span class="dfn-paneled" id="51c8be2a">active document</span>
     <li><span class="dfn-paneled" id="03fa8fbd">allow-forms</span>
     <li><span class="dfn-paneled" id="17e1e536">allow-pointer-lock</span>
     <li><span class="dfn-paneled" id="5f71dd2f">allow-popups</span>
     <li><span class="dfn-paneled" id="6649bb25">allow-same-origin</span>
     <li><span class="dfn-paneled" id="7fc78acc">allow-scripts</span>
     <li><span class="dfn-paneled" id="07da650d">allow-top-navigation</span>
     <li><span class="dfn-paneled" id="bd7ccfb7">ancestor browsing context</span>
     <li><span class="dfn-paneled" id="0293496b">applet</span>
     <li><span class="dfn-paneled" id="ad82a250">archive</span>
     <li><span class="dfn-paneled" id="40b8e924">ascii case-insensitive match</span>
     <li><span class="dfn-paneled" id="792579ad">audio</span>
     <li><span class="dfn-paneled" id="ca716760">auxiliary browsing context</span>
     <li><span class="dfn-paneled" id="2c3492d0">child browsing context</span>
     <li><span class="dfn-paneled" id="be1af899">code</span>
     <li><span class="dfn-paneled" id="9f7dd21b">content</span>
     <li><span class="dfn-paneled" id="0277f47e">data</span>
     <li><span class="dfn-paneled" id="c00185c4">default port</span>
     <li><span class="dfn-paneled" id="4d8a883c">embed</span>
     <li><span class="dfn-paneled" id="12a49276">fetch</span>
     <li><span class="dfn-paneled" id="06d29dcf">form</span>
     <li><span class="dfn-paneled" id="ae3c8d32">frame</span>
     <li><span class="dfn-paneled" id="3b14bf61">head</span>
     <li><span class="dfn-paneled" id="75b05fce">host</span>
     <li><span class="dfn-paneled" id="b7d9685d">href</span>
     <li><span class="dfn-paneled" id="d004a3b6">http-equiv</span>
     <li><span class="dfn-paneled" id="b72e3725">icon</span>
     <li><span class="dfn-paneled" id="8b38c221">iframe</span>
     <li><span class="dfn-paneled" id="eea5e41b">image</span>
     <li><span class="dfn-paneled" id="eb6a8bfd">img</span>
     <li><span class="dfn-paneled" id="98c08795">input</span>
     <li><span class="dfn-paneled" id="3db5ef5f">ipv4address</span>
     <li><span class="dfn-paneled" id="8fd73518">ipv6 address</span>
     <li><span class="dfn-paneled" id="ad3ba822">link</span>
     <li><span class="dfn-paneled" id="12906b48">link type stylesheet</span>
     <li><span class="dfn-paneled" id="61710bfb">long</span>
     <li><span class="dfn-paneled" id="fddf7685">meta</span>
     <li><span class="dfn-paneled" id="34a91001">nested browsing context</span>
     <li><span class="dfn-paneled" id="fa6b605d">object</span>
     <li><span class="dfn-paneled" id="b91eca73">opener browsing context</span>
     <li><span class="dfn-paneled" id="9a336a9c">origin of a url</span>
     <li><span class="dfn-paneled" id="17531788">path</span>
     <li><span class="dfn-paneled" id="d9e3edc8">percent decode</span>
     <li><span class="dfn-paneled" id="6e078f61">plugin</span>
     <li><span class="dfn-paneled" id="98b9d39f">port</span>
     <li><span class="dfn-paneled" id="b1a358e7">poster</span>
     <li><span class="dfn-paneled" id="18d7be56">pragma directives</span>
     <li><span class="dfn-paneled" id="9cece305">referrer</span>
     <li><span class="dfn-paneled" id="186722ad">rel</span>
     <li><span class="dfn-paneled" id="3f756b8f">sandbox</span>
     <li><span class="dfn-paneled" id="1b0577a6">scheme</span>
     <li><span class="dfn-paneled" id="47e0af6c">script</span>
     <li><span class="dfn-paneled" id="a1239cb2">setInterval()</span>
     <li><span class="dfn-paneled" id="0e927ae3">setTimeout()</span>
     <li><span class="dfn-paneled" id="ebdd5311">source</span>
     <li><span class="dfn-paneled" id="528b2aa3">src <small>(for embed)</small></span>
     <li><span class="dfn-paneled" id="8399fbe1">src <small>(for img)</small></span>
     <li><span class="dfn-paneled" id="2bba1354">src <small>(for input)</small></span>
     <li><span class="dfn-paneled" id="e41a24ee">src <small>(for script)</small></span>
     <li><span class="dfn-paneled" id="a0aa3187">src <small>(for video)</small></span>
     <li><span class="dfn-paneled" id="2280b762">strip leading and trailing whitespace</span>
     <li><span class="dfn-paneled" id="7fdd42a9">style</span>
     <li><span class="dfn-paneled" id="7a7b334b">svg</span>
     <li><span class="dfn-paneled" id="46e13e35">textContent</span>
     <li><span class="dfn-paneled" id="f0b866a8">top-level browsing context</span>
     <li><span class="dfn-paneled" id="b1f7b72c">track</span>
     <li><span class="dfn-paneled" id="7046a4eb">type</span>
     <li><span class="dfn-paneled" id="78861d43">url parser</span>
     <li><span class="dfn-paneled" id="fe21e5e5">url()</span>
     <li><span class="dfn-paneled" id="9561a14f">video</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS4-IMAGES]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c4af1e88">image()</span>
     <li><span class="dfn-paneled" id="f032e6de">image-set()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5170ff4d">insert a css rule</span>
     <li><span class="dfn-paneled" id="d51bddd3">parse a css declaration block</span>
     <li><span class="dfn-paneled" id="3de9f594">parse a css rule</span>
     <li><span class="dfn-paneled" id="64f679ea">parse a group of selectors</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-abnf">[ABNF]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-beacon">[BEACON]
   <dd>Ilya Grigorik; Alois Reitbauer. <a href="https://w3c.github.io/beacon/"><cite>Beacon</cite></a>. URL: <a href="https://w3c.github.io/beacon/">https://w3c.github.io/beacon/</a>
   <dt id="biblio-css3-fonts">[CSS3-FONTS]
   <dd>John Daggett; Myles Maxfield; Chris Lilley. <a href="https://drafts.csswg.org/css-fonts-3/"><cite>CSS Fonts Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-fonts-3/">https://drafts.csswg.org/css-fonts-3/</a>
   <dt id="biblio-css4-images">[CSS4-IMAGES]
   <dd>Tab Atkins Jr.; Elika Etemad; Lea Verou. <a href="https://drafts.csswg.org/css-images-4/"><cite>CSS Images Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-images-4/">https://drafts.csswg.org/css-images-4/</a>
   <dt id="biblio-cssom">[CSSOM]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-ecma-262">[ECMA-262]
   <dd><a href="https://tc39.es/ecma262/multipage/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/multipage/">https://tc39.es/ecma262/multipage/</a>
   <dt id="biblio-eventsource">[EVENTSOURCE]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html"><cite>Server-Sent Events</cite></a>. URL: <a href="https://html.spec.whatwg.org/multipage/server-sent-events.html">https://html.spec.whatwg.org/multipage/server-sent-events.html</a>
   <dt id="biblio-fips180">[FIPS180]
   <dd><a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf"><cite>FIPS-180-4</cite></a>. URL: <a href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf">http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf</a>
   <dt id="biblio-html-imports">[HTML-IMPORTS]
   <dd>Dimitri Glazkov; Hajime Morita. <a href="https://wicg.github.io/webcomponents/spec/imports/"><cite>HTML Imports</cite></a>. URL: <a href="https://wicg.github.io/webcomponents/spec/imports/">https://wicg.github.io/webcomponents/spec/imports/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="http://www.w3.org/TR/html5/"><cite>HTML5</cite></a>. REC. URL: <a href="http://www.w3.org/TR/html5/">http://www.w3.org/TR/html5/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc3492">[RFC3492]
   <dd>A. Costello. <a href="https://www.rfc-editor.org/rfc/rfc3492"><cite>Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</cite></a>. March 2003. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3492">https://www.rfc-editor.org/rfc/rfc3492</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://www.rfc-editor.org/rfc/rfc3864"><cite>Registration Procedures for Message Header Fields</cite></a>. September 2004. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
   <dt id="biblio-rfc3986">[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
   <dt id="biblio-rfc4627">[RFC4627]
   <dd>T. Bray, Ed.. <a href="https://www.rfc-editor.org/rfc/rfc8259"><cite>The JavaScript Object Notation (JSON) Data Interchange Format</cite></a>. December 2017. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc8259">https://www.rfc-editor.org/rfc/rfc8259</a>
   <dt id="biblio-rfc5988">[RFC5988]
   <dd>M. Nottingham. <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://www.rfc-editor.org/rfc/rfc6454"><cite>The Web Origin Concept</cite></a>. December 2011. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6454">https://www.rfc-editor.org/rfc/rfc6454</a>
   <dt id="biblio-rfc7034">[RFC7034]
   <dd>D. Ross; T. Gondrom. <a href="https://www.rfc-editor.org/rfc/rfc7034"><cite>HTTP Header Field X-Frame-Options</cite></a>. October 2013. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7034">https://www.rfc-editor.org/rfc/rfc7034</a>
   <dt id="biblio-rfc7230">[RFC7230]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9112.html"><cite>HTTP/1.1</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9112.html">https://httpwg.org/specs/rfc9112.html</a>
   <dt id="biblio-rfc7231">[RFC7231]
   <dd>R. Fielding, Ed.; M. Nottingham, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc9110.html"><cite>HTTP Semantics</cite></a>. June 2022. Internet Standard. URL: <a href="https://httpwg.org/specs/rfc9110.html">https://httpwg.org/specs/rfc9110.html</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren; Sam Ruby. <a href="http://www.w3.org/TR/url/"><cite>URL</cite></a>. WD. URL: <a href="http://www.w3.org/TR/url/">http://www.w3.org/TR/url/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Adam Rice. <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets Standard</cite></a>. Living Standard. URL: <a href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
   <dt id="biblio-workers">[WORKERS]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/workers.html"><cite>Web Workers</cite></a>. URL: <a href="https://html.spec.whatwg.org/multipage/workers.html">https://html.spec.whatwg.org/multipage/workers.html</a>
   <dt id="biblio-xml11">[XML11]
   <dd>Tim Bray; et al. <a href="https://www.w3.org/TR/xml11/"><cite>Extensible Markup Language (XML) 1.1 (Second Edition)</cite></a>. 16 August 2006. REC. URL: <a href="https://www.w3.org/TR/xml11/">https://www.w3.org/TR/xml11/</a>
   <dt id="biblio-xmlhttprequest">[XMLHTTPREQUEST]
   <dd>Anne van Kesteren; et al. <a href="https://xhr.spec.whatwg.org/"><cite>XMLHttpRequest Level 1</cite></a>. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
   <dt id="biblio-xslt">[XSLT]
   <dd>James Clark. <a href="https://www.w3.org/TR/xslt-10/"><cite>XSL Transformations (XSLT) Version 1.0</cite></a>. 16 November 1999. REC. URL: <a href="https://www.w3.org/TR/xslt-10/">https://www.w3.org/TR/xslt-10/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-rfc6797">[RFC6797]
   <dd>J. Hodges; C. Jackson; A. Barth. <a href="https://www.rfc-editor.org/rfc/rfc6797"><cite>HTTP Strict Transport Security (HSTS)</cite></a>. November 2012. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6797">https://www.rfc-editor.org/rfc/rfc6797</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="http://www.w3.org/TR/html5/scripting-1.html#htmlscriptelement"><c- g>HTMLScriptElement</c-></a> {
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-type="DOMString" href="#dom-htmlscriptelement-nonce"><c- g>nonce</c-></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="http://www.w3.org/TR/html5/document-metadata.html#htmlstyleelement"><c- g>HTMLStyleElement</c-></a> {
  <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-type="DOMString" href="#dom-htmlstyleelement-nonce"><c- g>nonce</c-></a>;
};

[<c- g>Constructor</c->(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <c- g>type</c->, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <c- g>eventInitDict</c->)]
<c- b>interface</c-> <a href="#securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></a> : <a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#event"><c- n>Event</c-></a> {
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-documenturi"><c- g>documentURI</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-referrer"><c- g>referrer</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-blockeduri"><c- g>blockedURI</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-violateddirective"><c- g>violatedDirective</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-effectivedirective"><c- g>effectiveDirective</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-originalpolicy"><c- g>originalPolicy</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-sourcefile"><c- g>sourceFile</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-statuscode"><c- g>statusCode</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long"><c- b>long</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="long" href="#dom-securitypolicyviolationevent-linenumber"><c- g>lineNumber</c-></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long"><c- b>long</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="long" href="#dom-securitypolicyviolationevent-columnnumber"><c- g>columnNumber</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></a> : <a data-link-type="idl-name" href="http://www.w3.org/TR/dom/#eventinit"><c- n>EventInit</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-documenturi"><c- g>documentURI</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-referrer"><c- g>referrer</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-blockeduri"><c- g>blockedURI</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-violateddirective"><c- g>violatedDirective</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-effectivedirective"><c- g>effectiveDirective</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-originalpolicy"><c- g>originalPolicy</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-sourcefile"><c- g>sourceFile</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long"><c- b>long</c-></a>      <a class="idl-code" data-link-type="dict-member" data-type="long" href="#dom-securitypolicyviolationeventinit-linenumber"><c- g>lineNumber</c-></a>;
    <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-long"><c- b>long</c-></a>      <a class="idl-code" data-link-type="dict-member" data-type="long" href="#dom-securitypolicyviolationeventinit-columnnumber"><c- g>columnNumber</c-></a>;
};

</pre>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"0277f47e": {"dfnID":"0277f47e","dfnText":"data","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-object-data"},{"id":"ref-for-attr-object-data\u2460"}],"title":"7.11. object-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-data"},
"0293496b": {"dfnID":"0293496b","dfnText":"applet","external":true,"refSections":[{"refs":[{"id":"ref-for-the-applet-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-applet-element\u2460"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-the-applet-element\u2461"},{"id":"ref-for-the-applet-element\u2462"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-the-applet-element\u2463"}],"title":"7.12. plugin-types"}],"url":"http://www.w3.org/TR/html5/obsolete.html#the-applet-element"},
"03fa8fbd": {"dfnID":"03fa8fbd","dfnText":"allow-forms","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-forms"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-forms"},
"06d29dcf": {"dfnID":"06d29dcf","dfnText":"form","external":true,"refSections":[{"refs":[{"id":"ref-for-the-form-element"},{"id":"ref-for-the-form-element\u2460"}],"title":"7.6. form-action"}],"url":"http://www.w3.org/TR/html5/forms.html#the-form-element"},
"07da650d": {"dfnID":"07da650d","dfnText":"allow-top-navigation","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-top-navigation"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-top-navigation"},
"0e927ae3": {"dfnID":"0e927ae3","dfnText":"setTimeout()","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-windowtimers-settimeout"}],"title":"7.15. script-src"}],"url":"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-settimeout"},
"12906b48": {"dfnID":"12906b48","dfnText":"link type stylesheet","external":true,"refSections":[{"refs":[{"id":"ref-for-link-type-stylesheet"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/html5/links.html#link-type-stylesheet"},
"12a49276": {"dfnID":"12a49276","dfnText":"fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-fetch"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-fetch\u2460"}],"title":"7.2.2. Workers"},{"refs":[{"id":"ref-for-fetch\u2461"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-fetch\u2462"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-fetch\u2463"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-fetch\u2464"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-fetch\u2465"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-fetch\u2466"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-fetch\u2467"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-fetch\u2468"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-fetch\u2460\u24ea"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/html5/infrastructure.html#fetch"},
"17531788": {"dfnID":"17531788","dfnText":"path","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-path"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#concept-url-path"},
"17e1e536": {"dfnID":"17e1e536","dfnText":"allow-pointer-lock","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-pointer-lock"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-pointer-lock"},
"186722ad": {"dfnID":"186722ad","dfnText":"rel","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-link-rel"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-attr-link-rel\u2460"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/html5/document-metadata.html#attr-link-rel"},
"18d7be56": {"dfnID":"18d7be56","dfnText":"pragma directives","external":true,"refSections":[{"refs":[{"id":"ref-for-pragma-directives"}],"title":"3.3. \n      HTML meta Element\n    "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#pragma-directives"},
"1b0577a6": {"dfnID":"1b0577a6","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-scheme"},{"id":"ref-for-concept-url-scheme\u2460"},{"id":"ref-for-concept-url-scheme\u2461"},{"id":"ref-for-concept-url-scheme\u2462"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-concept-url-scheme\u2463"}],"title":"10.1. Processing Complications"}],"url":"http://www.w3.org/TR/url/#concept-url-scheme"},
"2280b762": {"dfnID":"2280b762","dfnText":"strip leading and trailing whitespace","external":true,"refSections":[{"refs":[{"id":"ref-for-strip-leading-and-trailing-whitespace"}],"title":"4.2.4. Valid Nonces"}],"url":"http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace"},
"298863fc": {"dfnID":"298863fc","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-interface-document"}],"title":"7.14.1. Sandboxing and Workers"},{"refs":[{"id":"ref-for-interface-document\u2460"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/dom/#interface-document"},
"2bba1354": {"dfnID":"2bba1354","dfnText":"src (for input)","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-input-src"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/forms.html#attr-input-src"},
"2c3492d0": {"dfnID":"2c3492d0","dfnText":"child browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-child-browsing-context"},{"id":"ref-for-child-browsing-context\u2460"}],"title":"7.12. plugin-types"}],"url":"http://www.w3.org/TR/html5/browsers.html#child-browsing-context"},
"34a91001": {"dfnID":"34a91001","dfnText":"nested browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-nested-browsing-context"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-nested-browsing-context\u2460"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-nested-browsing-context\u2461"},{"id":"ref-for-nested-browsing-context\u2462"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-nested-browsing-context\u2463"},{"id":"ref-for-nested-browsing-context\u2464"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-nested-browsing-context\u2465"}],"title":"10.1. Processing Complications"}],"url":"http://www.w3.org/TR/html5/browsers.html#nested-browsing-context"},
"3b14bf61": {"dfnID":"3b14bf61","dfnText":"head","external":true,"refSections":[{"refs":[{"id":"ref-for-the-head-element"}],"title":"3.3. \n      HTML meta Element\n    "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#the-head-element"},
"3db5ef5f": {"dfnID":"3db5ef5f","dfnText":"ipv4address","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.2.2"}],"title":"4.2.2. Matching Source Expressions"}],"url":"https://tools.ietf.org/html/rfc3986#section-3.2.2"},
"3de9f594": {"dfnID":"3de9f594","dfnText":"parse a css rule","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-css-rule"}],"title":"7.16. style-src"}],"url":"https://drafts.csswg.org/cssom-1/#parse-a-css-rule"},
"3f756b8f": {"dfnID":"3f756b8f","dfnText":"sandbox","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox"},
"40b8e924": {"dfnID":"40b8e924","dfnText":"ascii case-insensitive match","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-case-insensitive"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460"}],"title":"4.2.1. Parsing Source Lists"},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2461"},{"id":"ref-for-ascii-case-insensitive\u2462"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2463"},{"id":"ref-for-ascii-case-insensitive\u2464"},{"id":"ref-for-ascii-case-insensitive\u2465"}],"title":"4.2.5. Valid Hashes"},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2466"}],"title":"4.3.2. Matching"},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2467"},{"id":"ref-for-ascii-case-insensitive\u2468"}],"title":"7.12. plugin-types"}],"url":"http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive"},
"46e13e35": {"dfnID":"46e13e35","dfnText":"textContent","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-node-textcontent"}],"title":"4.2.5. Valid Hashes"}],"url":"http://www.w3.org/TR/dom/#dom-node-textcontent"},
"47e0af6c": {"dfnID":"47e0af6c","dfnText":"script","external":true,"refSections":[{"refs":[{"id":"ref-for-the-script-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-script-element\u2460"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-the-script-element\u2461"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-the-script-element\u2462"}],"title":"4.2.3. \n        The nonce attribute\n      "},{"refs":[{"id":"ref-for-the-script-element\u2463"},{"id":"ref-for-the-script-element\u2464"}],"title":"4.2.5. Valid Hashes"},{"refs":[{"id":"ref-for-the-script-element\u2465"},{"id":"ref-for-the-script-element\u2466"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-the-script-element\u2467"},{"id":"ref-for-the-script-element\u2468"}],"title":"7.15.1. \n        Nonce usage for script elements\n      "},{"refs":[{"id":"ref-for-the-script-element\u2460\u24ea"}],"title":"7.15.2. \n        Hash usage for script elements\n      "},{"refs":[{"id":"ref-for-the-script-element\u2460\u2460"},{"id":"ref-for-the-script-element\u2460\u2461"},{"id":"ref-for-the-script-element\u2460\u2462"}],"title":"8.1. Sample Policy Definitions"}],"url":"http://www.w3.org/TR/html5/scripting-1.html#the-script-element"},
"4d8a883c": {"dfnID":"4d8a883c","dfnText":"embed","external":true,"refSections":[{"refs":[{"id":"ref-for-the-embed-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-embed-element\u2460"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-the-embed-element\u2461"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-the-embed-element\u2462"},{"id":"ref-for-the-embed-element\u2463"},{"id":"ref-for-the-embed-element\u2464"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-the-embed-element\u2465"},{"id":"ref-for-the-embed-element\u2466"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-the-embed-element\u2467"}],"title":"7.12.1. Usage"},{"refs":[{"id":"ref-for-the-embed-element\u2468"}],"title":"7.12.2. \n        Predeclaration of expected media types\n      "}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element"},
"5170ff4d": {"dfnID":"5170ff4d","dfnText":"insert a css rule","external":true,"refSections":[{"refs":[{"id":"ref-for-insert-a-css-rule"}],"title":"7.16. style-src"}],"url":"https://drafts.csswg.org/cssom-1/#insert-a-css-rule"},
"51c8be2a": {"dfnID":"51c8be2a","dfnText":"active document","external":true,"refSections":[{"refs":[{"id":"ref-for-active-document"},{"id":"ref-for-active-document\u2460"}],"title":"7.12. plugin-types"}],"url":"http://www.w3.org/TR/html5/browsers.html#active-document"},
"528b2aa3": {"dfnID":"528b2aa3","dfnText":"src (for embed)","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-embed-src"}],"title":"7.11. object-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-embed-src"},
"5d771b5e": {"dfnID":"5d771b5e","dfnText":"HTMLScriptElement","external":true,"refSections":[{"refs":[{"id":"ref-for-htmlscriptelement"}],"title":"4.2.3. \n        The nonce attribute\n      "}],"url":"http://www.w3.org/TR/html5/scripting-1.html#htmlscriptelement"},
"5f71dd2f": {"dfnID":"5f71dd2f","dfnText":"allow-popups","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-popups"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-popups"},
"61710bfb": {"dfnID":"61710bfb","dfnText":"long","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-long"},{"id":"ref-for-idl-long\u2460"},{"id":"ref-for-idl-long\u2461"},{"id":"ref-for-idl-long\u2462"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "},{"refs":[{"id":"ref-for-idl-long\u2463"},{"id":"ref-for-idl-long\u2464"},{"id":"ref-for-idl-long\u2465"},{"id":"ref-for-idl-long\u2466"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"https://heycam.github.io/webidl/#idl-long"},
"64f679ea": {"dfnID":"64f679ea","dfnText":"parse a group of selectors","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-group-of-selectors"}],"title":"7.16. style-src"}],"url":"https://drafts.csswg.org/cssom-1/#parse-a-group-of-selectors"},
"6649bb25": {"dfnID":"6649bb25","dfnText":"allow-same-origin","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-same-origin"},{"id":"ref-for-attr-iframe-sandbox-allow-same-origin\u2460"}],"title":"7.14.1. Sandboxing and Workers"},{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-same-origin\u2461"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin"},
"6ba5480f": {"dfnID":"6ba5480f","dfnText":"EventInit","external":true,"refSections":[{"refs":[{"id":"ref-for-eventinit"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"http://www.w3.org/TR/dom/#eventinit"},
"6e078f61": {"dfnID":"6e078f61","dfnText":"plugin","external":true,"refSections":[{"refs":[{"id":"ref-for-plugin"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-plugin\u2460"}],"title":"4.3. Media Type List Syntax"},{"refs":[{"id":"ref-for-plugin\u2461"},{"id":"ref-for-plugin\u2462"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-plugin\u2463"}],"title":"7.12. plugin-types"}],"url":"http://www.w3.org/TR/html5/infrastructure.html#plugin"},
"7046a4eb": {"dfnID":"7046a4eb","dfnText":"type","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-object-type"},{"id":"ref-for-attr-object-type\u2460"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-attr-object-type\u2461"}],"title":"7.12.2. \n        Predeclaration of expected media types\n      "}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type"},
"75b05fce": {"dfnID":"75b05fce","dfnText":"host","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-host"},{"id":"ref-for-concept-url-host\u2460"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#concept-url-host"},
"78861d43": {"dfnID":"78861d43","dfnText":"url parser","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-parser"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#concept-url-parser"},
"792579ad": {"dfnID":"792579ad","dfnText":"audio","external":true,"refSections":[{"refs":[{"id":"ref-for-the-audio-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-audio-element\u2460"}],"title":"7.10. media-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element"},
"7a3fe402": {"dfnID":"7a3fe402","dfnText":"Event","external":true,"refSections":[{"refs":[{"id":"ref-for-event"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"http://www.w3.org/TR/dom/#event"},
"7a7b334b": {"dfnID":"7a7b334b","dfnText":"svg","external":true,"refSections":[{"refs":[{"id":"ref-for-SVGElement"}],"title":"3.5. Policy applicability"}],"url":"http://www.w3.org/TR/SVG2/struct.html#SVGElement"},
"7fc78acc": {"dfnID":"7fc78acc","dfnText":"allow-scripts","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-scripts"},{"id":"ref-for-attr-iframe-sandbox-allow-scripts\u2460"}],"title":"7.14.1. Sandboxing and Workers"},{"refs":[{"id":"ref-for-attr-iframe-sandbox-allow-scripts\u2461"},{"id":"ref-for-attr-iframe-sandbox-allow-scripts\u2462"},{"id":"ref-for-attr-iframe-sandbox-allow-scripts\u2463"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts"},
"7fdd42a9": {"dfnID":"7fdd42a9","dfnText":"style","external":true,"refSections":[{"refs":[{"id":"ref-for-the-style-element"}],"title":"4.2.3. \n        The nonce attribute\n      "},{"refs":[{"id":"ref-for-the-style-element\u2460"}],"title":"4.2.5. Valid Hashes"},{"refs":[{"id":"ref-for-the-style-element\u2461"},{"id":"ref-for-the-style-element\u2462"}],"title":"7.16. style-src"},{"refs":[{"id":"ref-for-the-style-element\u2463"},{"id":"ref-for-the-style-element\u2464"}],"title":"7.16.1. \n        Nonce usage for style elements\n      "},{"refs":[{"id":"ref-for-the-style-element\u2465"},{"id":"ref-for-the-style-element\u2466"}],"title":"7.16.2. \n        Hash usage for style elements\n      "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#the-style-element"},
"8399fbe1": {"dfnID":"8399fbe1","dfnText":"src (for img)","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-img-src"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-img-src"},
"8855a9aa": {"dfnID":"8855a9aa","dfnText":"DOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-DOMString"},{"id":"ref-for-idl-DOMString\u2460"},{"id":"ref-for-idl-DOMString\u2461"},{"id":"ref-for-idl-DOMString\u2462"}],"title":"4.2.3. \n        The nonce attribute\n      "},{"refs":[{"id":"ref-for-idl-DOMString\u2463"},{"id":"ref-for-idl-DOMString\u2464"},{"id":"ref-for-idl-DOMString\u2465"},{"id":"ref-for-idl-DOMString\u2466"},{"id":"ref-for-idl-DOMString\u2467"},{"id":"ref-for-idl-DOMString\u2468"},{"id":"ref-for-idl-DOMString\u2460\u24ea"},{"id":"ref-for-idl-DOMString\u2460\u2460"},{"id":"ref-for-idl-DOMString\u2460\u2461"},{"id":"ref-for-idl-DOMString\u2460\u2462"},{"id":"ref-for-idl-DOMString\u2460\u2463"},{"id":"ref-for-idl-DOMString\u2460\u2464"},{"id":"ref-for-idl-DOMString\u2460\u2465"},{"id":"ref-for-idl-DOMString\u2460\u2466"},{"id":"ref-for-idl-DOMString\u2460\u2467"},{"id":"ref-for-idl-DOMString\u2460\u2468"},{"id":"ref-for-idl-DOMString\u2461\u24ea"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "},{"refs":[{"id":"ref-for-idl-DOMString\u2461\u2460"},{"id":"ref-for-idl-DOMString\u2461\u2461"},{"id":"ref-for-idl-DOMString\u2461\u2462"},{"id":"ref-for-idl-DOMString\u2461\u2463"},{"id":"ref-for-idl-DOMString\u2461\u2464"},{"id":"ref-for-idl-DOMString\u2461\u2465"},{"id":"ref-for-idl-DOMString\u2461\u2466"},{"id":"ref-for-idl-DOMString\u2461\u2467"},{"id":"ref-for-idl-DOMString\u2461\u2468"},{"id":"ref-for-idl-DOMString\u2462\u24ea"},{"id":"ref-for-idl-DOMString\u2462\u2460"},{"id":"ref-for-idl-DOMString\u2462\u2461"},{"id":"ref-for-idl-DOMString\u2462\u2462"},{"id":"ref-for-idl-DOMString\u2462\u2463"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"8b38c221": {"dfnID":"8b38c221","dfnText":"iframe","external":true,"refSections":[{"refs":[{"id":"ref-for-the-iframe-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-iframe-element\u2460"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-the-iframe-element\u2461"},{"id":"ref-for-the-iframe-element\u2462"}],"title":"5.2. srcdoc iframes"},{"refs":[{"id":"ref-for-the-iframe-element\u2463"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-the-iframe-element\u2464"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-the-iframe-element\u2465"},{"id":"ref-for-the-iframe-element\u2466"}],"title":"7.14.2. Usage"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element"},
"8fd73518": {"dfnID":"8fd73518","dfnText":"ipv6 address","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-ipv6"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#concept-ipv6"},
"9561a14f": {"dfnID":"9561a14f","dfnText":"video","external":true,"refSections":[{"refs":[{"id":"ref-for-the-video-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-video-element\u2460"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-the-video-element\u2461"}],"title":"7.10. media-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element"},
"98b9d39f": {"dfnID":"98b9d39f","dfnText":"port","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-port"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-concept-url-port\u2460"}],"title":"10.1. Processing Complications"}],"url":"http://www.w3.org/TR/url/#concept-url-port"},
"98c08795": {"dfnID":"98c08795","dfnText":"input","external":true,"refSections":[{"refs":[{"id":"ref-for-the-input-element"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/forms.html#the-input-element"},
"9a336a9c": {"dfnID":"9a336a9c","dfnText":"origin of a url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-origin"},{"id":"ref-for-concept-url-origin\u2460"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#concept-url-origin"},
"9cece305": {"dfnID":"9cece305","dfnText":"referrer","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-referrer"}],"title":"4.4. Reporting"}],"url":"http://www.w3.org/TR/html5/dom.html#dom-document-referrer"},
"9f7dd21b": {"dfnID":"9f7dd21b","dfnText":"content","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-content"},{"id":"ref-for-attr-meta-content\u2460"},{"id":"ref-for-attr-meta-content\u2461"}],"title":"3.3. \n      HTML meta Element\n    "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content"},
"a0aa3187": {"dfnID":"a0aa3187","dfnText":"src (for video)","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-media-src"}],"title":"7.10. media-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-media-src"},
"a1239cb2": {"dfnID":"a1239cb2","dfnText":"setInterval()","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-windowtimers-setinterval"}],"title":"7.15. script-src"}],"url":"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-setinterval"},
"ad3ba822": {"dfnID":"ad3ba822","dfnText":"link","external":true,"refSections":[{"refs":[{"id":"ref-for-the-link-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-link-element\u2460"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-the-link-element\u2461"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-the-link-element\u2462"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-the-link-element\u2463"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/html5/document-metadata.html#the-link-element"},
"ad82a250": {"dfnID":"ad82a250","dfnText":"archive","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-applet-archive"}],"title":"7.11. object-src"}],"url":"http://www.w3.org/TR/html5/obsolete.html#dom-applet-archive"},
"ae3c8d32": {"dfnID":"ae3c8d32","dfnText":"frame","external":true,"refSections":[{"refs":[{"id":"ref-for-frame"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-frame\u2460"}],"title":"7.8. frame-src"}],"url":"http://www.w3.org/TR/html5/obsolete.html#frame"},
"allowed-base-urls": {"dfnID":"allowed-base-urls","dfnText":"allowed base URLs","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-base-urls"}],"title":"7.1. base-uri"}],"url":"#allowed-base-urls"},
"allowed-child-sources": {"dfnID":"allowed-child-sources","dfnText":"allowed child sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-child-sources"}],"title":"7.2.2. Workers"},{"refs":[{"id":"ref-for-allowed-child-sources\u2460"}],"title":"7.8. frame-src"}],"url":"#allowed-child-sources"},
"allowed-connection-targets": {"dfnID":"allowed-connection-targets","dfnText":"allowed connection targets","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-connection-targets"}],"title":"7.3. connect-src"}],"url":"#allowed-connection-targets"},
"allowed-font-sources": {"dfnID":"allowed-font-sources","dfnText":"allowed font sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-font-sources"}],"title":"7.5. font-src"}],"url":"#allowed-font-sources"},
"allowed-form-actions": {"dfnID":"allowed-form-actions","dfnText":"allowed form actions","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-form-actions"}],"title":"7.6. form-action"}],"url":"#allowed-form-actions"},
"allowed-frame-ancestors": {"dfnID":"allowed-frame-ancestors","dfnText":"allowed frame ancestors","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-frame-ancestors"},{"id":"ref-for-allowed-frame-ancestors\u2460"}],"title":"7.7. frame-ancestors"}],"url":"#allowed-frame-ancestors"},
"allowed-frame-sources": {"dfnID":"allowed-frame-sources","dfnText":"allowed frame sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-frame-sources"}],"title":"7.8. frame-src"}],"url":"#allowed-frame-sources"},
"allowed-image-sources": {"dfnID":"allowed-image-sources","dfnText":"allowed image sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-image-sources"}],"title":"7.9. img-src"}],"url":"#allowed-image-sources"},
"allowed-media-sources": {"dfnID":"allowed-media-sources","dfnText":"allowed media sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-media-sources"}],"title":"7.10. media-src"}],"url":"#allowed-media-sources"},
"allowed-object-sources": {"dfnID":"allowed-object-sources","dfnText":"allowed object sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-object-sources"},{"id":"ref-for-allowed-object-sources\u2460"},{"id":"ref-for-allowed-object-sources\u2461"}],"title":"7.11. object-src"}],"url":"#allowed-object-sources"},
"allowed-plugin-media-types": {"dfnID":"allowed-plugin-media-types","dfnText":"allowed plugin media types","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-plugin-media-types"}],"title":"7.12. plugin-types"}],"url":"#allowed-plugin-media-types"},
"allowed-script-sources": {"dfnID":"allowed-script-sources","dfnText":"allowed script sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-script-sources"},{"id":"ref-for-allowed-script-sources\u2460"},{"id":"ref-for-allowed-script-sources\u2461"},{"id":"ref-for-allowed-script-sources\u2462"},{"id":"ref-for-allowed-script-sources\u2463"},{"id":"ref-for-allowed-script-sources\u2464"}],"title":"7.15. script-src"}],"url":"#allowed-script-sources"},
"allowed-style-sources": {"dfnID":"allowed-style-sources","dfnText":"allowed style sources","external":false,"refSections":[{"refs":[{"id":"ref-for-allowed-style-sources"},{"id":"ref-for-allowed-style-sources\u2460"},{"id":"ref-for-allowed-style-sources\u2461"},{"id":"ref-for-allowed-style-sources\u2462"},{"id":"ref-for-allowed-style-sources\u2463"}],"title":"7.16. style-src"}],"url":"#allowed-style-sources"},
"alpha": {"dfnID":"alpha","dfnText":"ALPHA","external":false,"refSections":[],"url":"#alpha"},
"ancestor-source": {"dfnID":"ancestor-source","dfnText":"ancestor-source","external":false,"refSections":[{"refs":[{"id":"ref-for-ancestor-source"},{"id":"ref-for-ancestor-source\u2460"}],"title":"7.7. frame-ancestors"}],"url":"#ancestor-source"},
"ancestor-source-list": {"dfnID":"ancestor-source-list","dfnText":"ancestor-source-list","external":false,"refSections":[{"refs":[{"id":"ref-for-ancestor-source-list"}],"title":"7.7. frame-ancestors"}],"url":"#ancestor-source-list"},
"b1a358e7": {"dfnID":"b1a358e7","dfnText":"poster","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-video-poster"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-video-poster"},
"b1f7b72c": {"dfnID":"b1f7b72c","dfnText":"track","external":true,"refSections":[{"refs":[{"id":"ref-for-the-track-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-track-element\u2460"}],"title":"7.10. media-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element"},
"b289f2bd": {"dfnID":"b289f2bd","dfnText":"HTMLStyleElement","external":true,"refSections":[{"refs":[{"id":"ref-for-htmlstyleelement"}],"title":"4.2.3. \n        The nonce attribute\n      "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#htmlstyleelement"},
"b72e3725": {"dfnID":"b72e3725","dfnText":"icon","external":true,"refSections":[{"refs":[{"id":"ref-for-rel-icon"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/links.html#rel-icon"},
"b7d9685d": {"dfnID":"b7d9685d","dfnText":"href","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-link-href"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-attr-link-href\u2460"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-attr-link-href\u2461"}],"title":"7.16. style-src"}],"url":"http://www.w3.org/TR/html5/document-metadata.html#attr-link-href"},
"b91eca73": {"dfnID":"b91eca73","dfnText":"opener browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-opener-browsing-context"}],"title":"2.3. Relevant Concepts from HTML"}],"url":"http://www.w3.org/TR/html5/browsers.html#opener-browsing-context"},
"base-uri": {"dfnID":"base-uri","dfnText":"base-uri","external":false,"refSections":[{"refs":[{"id":"ref-for-base-uri"}],"title":"1.1. Changes from Level 1"}],"url":"#base-uri"},
"base64-value": {"dfnID":"base64-value","dfnText":"base64-value","external":false,"refSections":[{"refs":[{"id":"ref-for-base64-value"},{"id":"ref-for-base64-value\u2460"}],"title":"4.2. Source List Syntax"}],"url":"#base64-value"},
"bd7ccfb7": {"dfnID":"bd7ccfb7","dfnText":"ancestor browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-ancestor-browsing-context"}],"title":"7.7. frame-ancestors"}],"url":"http://www.w3.org/TR/html5/browsers.html#ancestor-browsing-context"},
"be1af899": {"dfnID":"be1af899","dfnText":"code","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-applet-code"}],"title":"7.11. object-src"}],"url":"http://www.w3.org/TR/html5/obsolete.html#dom-applet-code"},
"c00185c4": {"dfnID":"c00185c4","dfnText":"default port","external":true,"refSections":[{"refs":[{"id":"ref-for-default-port"},{"id":"ref-for-default-port\u2460"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#default-port"},
"c4af1e88": {"dfnID":"c4af1e88","dfnText":"image()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-image"}],"title":"7.9. img-src"}],"url":"https://drafts.csswg.org/css-images-4/#funcdef-image"},
"ca716760": {"dfnID":"ca716760","dfnText":"auxiliary browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-auxiliary-browsing-context"}],"title":"2.3. Relevant Concepts from HTML"}],"url":"http://www.w3.org/TR/html5/browsers.html#auxiliary-browsing-context"},
"callable": {"dfnID":"callable","dfnText":"callable","external":false,"refSections":[{"refs":[{"id":"ref-for-callable"},{"id":"ref-for-callable\u2460"}],"title":"7.15. script-src"}],"url":"#callable"},
"callers": {"dfnID":"callers","dfnText":"callers","external":false,"refSections":[],"url":"#callers"},
"child-src": {"dfnID":"child-src","dfnText":"child-src","external":false,"refSections":[{"refs":[{"id":"ref-for-child-src"},{"id":"ref-for-child-src\u2460"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-child-src\u2461"}],"title":"7.4. default-src"}],"url":"#child-src"},
"connect-src": {"dfnID":"connect-src","dfnText":"connect-src","external":false,"refSections":[{"refs":[{"id":"ref-for-connect-src"},{"id":"ref-for-connect-src\u2460"},{"id":"ref-for-connect-src\u2461"}],"title":"3.4. Enforcing multiple policies"},{"refs":[{"id":"ref-for-connect-src\u2462"}],"title":"7.3.1. Usage"},{"refs":[{"id":"ref-for-connect-src\u2463"}],"title":"7.4. default-src"}],"url":"#connect-src"},
"content-security-policy": {"dfnID":"content-security-policy","dfnText":"Content-Security-Policy","external":false,"refSections":[{"refs":[{"id":"ref-for-content-security-policy"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-content-security-policy\u2460"}],"title":"5. Processing Model"},{"refs":[{"id":"ref-for-content-security-policy\u2461"},{"id":"ref-for-content-security-policy\u2462"},{"id":"ref-for-content-security-policy\u2463"}],"title":"10. Implementation Considerations"},{"refs":[{"id":"ref-for-content-security-policy\u2464"}],"title":"11.1. Content-Security-Policy"}],"url":"#content-security-policy"},
"content-security-policy-report-only": {"dfnID":"content-security-policy-report-only","dfnText":"Content-Security-Policy-Report-Only","external":false,"refSections":[{"refs":[{"id":"ref-for-content-security-policy-report-only"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-content-security-policy-report-only\u2460"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-content-security-policy-report-only\u2461"}],"title":"5. Processing Model"},{"refs":[{"id":"ref-for-content-security-policy-report-only\u2462"}],"title":"11.2. Content-Security-Policy-Report-Only"}],"url":"#content-security-policy-report-only"},
"content-security-policy-task-source": {"dfnID":"content-security-policy-task-source","dfnText":"Content Security Policy task\n          source","external":false,"refSections":[{"refs":[{"id":"ref-for-content-security-policy-task-source"}],"title":"6.3. Firing Violation Events"}],"url":"#content-security-policy-task-source"},
"d004a3b6": {"dfnID":"d004a3b6","dfnText":"http-equiv","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-http-equiv"}],"title":"3.3. \n      HTML meta Element\n    "}],"url":"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv"},
"d51bddd3": {"dfnID":"d51bddd3","dfnText":"parse a css declaration block","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-css-declaration-block"}],"title":"7.16. style-src"}],"url":"https://drafts.csswg.org/cssom-1/#parse-a-css-declaration-block"},
"d9e3edc8": {"dfnID":"d9e3edc8","dfnText":"percent decode","external":true,"refSections":[{"refs":[{"id":"ref-for-percent-decode"},{"id":"ref-for-percent-decode\u2460"}],"title":"4.2.2. Matching Source Expressions"}],"url":"http://www.w3.org/TR/url/#percent-decode"},
"default-sources": {"dfnID":"default-sources","dfnText":"default sources","external":false,"refSections":[{"refs":[{"id":"ref-for-default-sources"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-default-sources\u2460"}],"title":"7.1. base-uri"},{"refs":[{"id":"ref-for-default-sources\u2461"}],"title":"7.2. child-src"},{"refs":[{"id":"ref-for-default-sources\u2462"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-default-sources\u2463"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-default-sources\u2464"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-default-sources\u2465"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-default-sources\u2466"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-default-sources\u2467"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-default-sources\u2468"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-default-sources\u2460\u24ea"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-default-sources\u2460\u2460"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-default-sources\u2460\u2461"}],"title":"7.16. style-src"}],"url":"#default-sources"},
"default-src": {"dfnID":"default-src","dfnText":"default-src","external":false,"refSections":[{"refs":[{"id":"ref-for-default-src"},{"id":"ref-for-default-src\u2460"}],"title":"3.4. Enforcing multiple policies"},{"refs":[{"id":"ref-for-default-src\u2461"}],"title":"4.2.2.1. \n          Security Considerations for GUID URL schemes\n        "},{"refs":[{"id":"ref-for-default-src\u2462"},{"id":"ref-for-default-src\u2463"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-default-src\u2464"}],"title":"7. Directives"},{"refs":[{"id":"ref-for-default-src\u2465"},{"id":"ref-for-default-src\u2466"}],"title":"7.4.1. Usage"},{"refs":[{"id":"ref-for-default-src\u2467"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-default-src\u2468"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-default-src\u2460\u24ea"},{"id":"ref-for-default-src\u2460\u2460"}],"title":"7.15.1. \n        Nonce usage for script elements\n      "},{"refs":[{"id":"ref-for-default-src\u2460\u2461"}],"title":"7.15.2. \n        Hash usage for script elements\n      "},{"refs":[{"id":"ref-for-default-src\u2460\u2462"},{"id":"ref-for-default-src\u2460\u2463"},{"id":"ref-for-default-src\u2460\u2464"}],"title":"8.1. Sample Policy Definitions"},{"refs":[{"id":"ref-for-default-src\u2460\u2465"}],"title":"8.2. Sample Violation Report"},{"refs":[{"id":"ref-for-default-src\u2460\u2466"},{"id":"ref-for-default-src\u2460\u2467"},{"id":"ref-for-default-src\u2460\u2468"},{"id":"ref-for-default-src\u2461\u24ea"},{"id":"ref-for-default-src\u2461\u2460"}],"title":"10. Implementation Considerations"}],"url":"#default-src"},
"dictdef-securitypolicyviolationeventinit": {"dfnID":"dictdef-securitypolicyviolationeventinit","dfnText":"SecurityPolicyViolationEventInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-securitypolicyviolationeventinit"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dictdef-securitypolicyviolationeventinit"},
"digest-of-elements-content": {"dfnID":"digest-of-elements-content","dfnText":"digest of element\u2019s content","external":false,"refSections":[{"refs":[{"id":"ref-for-digest-of-elements-content"}],"title":"4.2.5. Valid Hashes"}],"url":"#digest-of-elements-content"},
"digit": {"dfnID":"digit","dfnText":"DIGIT","external":false,"refSections":[],"url":"#digit"},
"directive-name": {"dfnID":"directive-name","dfnText":"directive-name","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-name"}],"title":"4.1. Policy Syntax"}],"url":"#directive-name"},
"directive-token": {"dfnID":"directive-token","dfnText":"directive-token","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-token"},{"id":"ref-for-directive-token\u2460"}],"title":"4.1. Policy Syntax"}],"url":"#directive-token"},
"directive-value": {"dfnID":"directive-value","dfnText":"directive-value","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-value"}],"title":"4.1. Policy Syntax"}],"url":"#directive-value"},
"dom-htmlscriptelement-nonce": {"dfnID":"dom-htmlscriptelement-nonce","dfnText":"nonce","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-htmlscriptelement-nonce"}],"title":"4.2.3. \n        The nonce attribute\n      "}],"url":"#dom-htmlscriptelement-nonce"},
"dom-htmlstyleelement-nonce": {"dfnID":"dom-htmlstyleelement-nonce","dfnText":"nonce","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-htmlstyleelement-nonce"}],"title":"4.2.3. \n        The nonce attribute\n      "}],"url":"#dom-htmlstyleelement-nonce"},
"dom-securitypolicyviolationevent-blockeduri": {"dfnID":"dom-securitypolicyviolationevent-blockeduri","dfnText":"blockedURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-blockeduri"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-blockeduri"},
"dom-securitypolicyviolationevent-columnnumber": {"dfnID":"dom-securitypolicyviolationevent-columnnumber","dfnText":"columnNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-columnnumber"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-columnnumber\u2460"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-columnnumber"},
"dom-securitypolicyviolationevent-documenturi": {"dfnID":"dom-securitypolicyviolationevent-documenturi","dfnText":"documentURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-documenturi"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-documenturi"},
"dom-securitypolicyviolationevent-effectivedirective": {"dfnID":"dom-securitypolicyviolationevent-effectivedirective","dfnText":"effectiveDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-effectivedirective"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-effectivedirective\u2460"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-effectivedirective"},
"dom-securitypolicyviolationevent-linenumber": {"dfnID":"dom-securitypolicyviolationevent-linenumber","dfnText":"lineNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-linenumber"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-linenumber\u2460"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-linenumber"},
"dom-securitypolicyviolationevent-originalpolicy": {"dfnID":"dom-securitypolicyviolationevent-originalpolicy","dfnText":"originalPolicy","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-originalpolicy"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-originalpolicy"},
"dom-securitypolicyviolationevent-referrer": {"dfnID":"dom-securitypolicyviolationevent-referrer","dfnText":"referrer","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-referrer"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-referrer"},
"dom-securitypolicyviolationevent-sourcefile": {"dfnID":"dom-securitypolicyviolationevent-sourcefile","dfnText":"sourceFile","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sourcefile"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sourcefile\u2460"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-sourcefile"},
"dom-securitypolicyviolationevent-statuscode": {"dfnID":"dom-securitypolicyviolationevent-statuscode","dfnText":"statusCode","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-statuscode"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-statuscode\u2460"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-statuscode"},
"dom-securitypolicyviolationevent-violateddirective": {"dfnID":"dom-securitypolicyviolationevent-violateddirective","dfnText":"violatedDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-violateddirective"}],"title":"6.1. \n      SecurityPolicyViolationEvent Interface\n    "}],"url":"#dom-securitypolicyviolationevent-violateddirective"},
"dom-securitypolicyviolationeventinit-blockeduri": {"dfnID":"dom-securitypolicyviolationeventinit-blockeduri","dfnText":"blockedURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-blockeduri"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-blockeduri"},
"dom-securitypolicyviolationeventinit-columnnumber": {"dfnID":"dom-securitypolicyviolationeventinit-columnnumber","dfnText":"columnNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-columnnumber"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-columnnumber"},
"dom-securitypolicyviolationeventinit-documenturi": {"dfnID":"dom-securitypolicyviolationeventinit-documenturi","dfnText":"documentURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-documenturi"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-documenturi"},
"dom-securitypolicyviolationeventinit-effectivedirective": {"dfnID":"dom-securitypolicyviolationeventinit-effectivedirective","dfnText":"effectiveDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-effectivedirective"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-effectivedirective"},
"dom-securitypolicyviolationeventinit-linenumber": {"dfnID":"dom-securitypolicyviolationeventinit-linenumber","dfnText":"lineNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-linenumber"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-linenumber"},
"dom-securitypolicyviolationeventinit-originalpolicy": {"dfnID":"dom-securitypolicyviolationeventinit-originalpolicy","dfnText":"originalPolicy","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-originalpolicy"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-originalpolicy"},
"dom-securitypolicyviolationeventinit-referrer": {"dfnID":"dom-securitypolicyviolationeventinit-referrer","dfnText":"referrer","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-referrer"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-referrer"},
"dom-securitypolicyviolationeventinit-sourcefile": {"dfnID":"dom-securitypolicyviolationeventinit-sourcefile","dfnText":"sourceFile","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-sourcefile"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-sourcefile"},
"dom-securitypolicyviolationeventinit-violateddirective": {"dfnID":"dom-securitypolicyviolationeventinit-violateddirective","dfnText":"violatedDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationeventinit-violateddirective"}],"title":"6.2. \n      SecurityPolicyViolationEventInit Interface\n    "}],"url":"#dom-securitypolicyviolationeventinit-violateddirective"},
"e41a24ee": {"dfnID":"e41a24ee","dfnText":"src (for script)","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-script-src"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-attr-script-src\u2460"}],"title":"7.15.1. \n        Nonce usage for script elements\n      "}],"url":"http://www.w3.org/TR/html5/scripting-1.html#attr-script-src"},
"eb6a8bfd": {"dfnID":"eb6a8bfd","dfnText":"img","external":true,"refSections":[{"refs":[{"id":"ref-for-the-img-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-img-element\u2460"},{"id":"ref-for-the-img-element\u2461"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-the-img-element\u2462"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element"},
"ebdd5311": {"dfnID":"ebdd5311","dfnText":"source","external":true,"refSections":[{"refs":[{"id":"ref-for-the-source-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-source-element\u2460"}],"title":"7.10. media-src"}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element"},
"eea5e41b": {"dfnID":"eea5e41b","dfnText":"image","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-input-type-image-keyword"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/html5/forms.html#attr-input-type-image-keyword"},
"element-attrdef-script-nonce": {"dfnID":"element-attrdef-script-nonce","dfnText":"nonce","external":false,"refSections":[{"refs":[{"id":"ref-for-element-attrdef-script-nonce"}],"title":"4.2.4. Valid Nonces"},{"refs":[{"id":"ref-for-element-attrdef-script-nonce\u2460"}],"title":"8.1. Sample Policy Definitions"}],"url":"#element-attrdef-script-nonce"},
"element-attrdef-style-nonce": {"dfnID":"element-attrdef-style-nonce","dfnText":"nonce","external":false,"refSections":[],"url":"#element-attrdef-style-nonce"},
"elements-content": {"dfnID":"elements-content","dfnText":"element\u2019s content","external":false,"refSections":[{"refs":[{"id":"ref-for-elements-content"}],"title":"4.2.5. Valid Hashes"}],"url":"#elements-content"},
"enforce": {"dfnID":"enforce","dfnText":"enforce","external":false,"refSections":[{"refs":[{"id":"ref-for-enforce"}],"title":"3.1. \n      Content-Security-Policy Header Field\n    "},{"refs":[{"id":"ref-for-enforce\u2460"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-enforce\u2461"},{"id":"ref-for-enforce\u2462"}],"title":"5. Processing Model"},{"refs":[{"id":"ref-for-enforce\u2463"}],"title":"5.1. Workers"},{"refs":[{"id":"ref-for-enforce\u2464"},{"id":"ref-for-enforce\u2465"}],"title":"5.2. srcdoc iframes"},{"refs":[{"id":"ref-for-enforce\u2466"}],"title":"7.12. plugin-types"}],"url":"#enforce"},
"f032e6de": {"dfnID":"f032e6de","dfnText":"image-set()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-image-set"}],"title":"7.9. img-src"}],"url":"https://drafts.csswg.org/css-images-4/#funcdef-image-set"},
"f0b866a8": {"dfnID":"f0b866a8","dfnText":"top-level browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-top-level-browsing-context"}],"title":"7.7. frame-ancestors"}],"url":"http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context"},
"fa6b605d": {"dfnID":"fa6b605d","dfnText":"object","external":true,"refSections":[{"refs":[{"id":"ref-for-the-object-element"}],"title":"2.3. Relevant Concepts from HTML"},{"refs":[{"id":"ref-for-the-object-element\u2460"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-the-object-element\u2461"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-the-object-element\u2462"},{"id":"ref-for-the-object-element\u2463"},{"id":"ref-for-the-object-element\u2464"},{"id":"ref-for-the-object-element\u2465"},{"id":"ref-for-the-object-element\u2466"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-the-object-element\u2467"},{"id":"ref-for-the-object-element\u2468"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-the-object-element\u2460\u24ea"}],"title":"7.12.1. Usage"},{"refs":[{"id":"ref-for-the-object-element\u2460\u2460"}],"title":"7.12.2. \n        Predeclaration of expected media types\n      "}],"url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element"},
"fddf7685": {"dfnID":"fddf7685","dfnText":"meta","external":true,"refSections":[{"refs":[{"id":"ref-for-the-meta-element"}],"title":"3. Policy Delivery"},{"refs":[{"id":"ref-for-the-meta-element\u2460"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-the-meta-element\u2461"},{"id":"ref-for-the-meta-element\u2462"},{"id":"ref-for-the-meta-element\u2463"},{"id":"ref-for-the-meta-element\u2464"},{"id":"ref-for-the-meta-element\u2465"},{"id":"ref-for-the-meta-element\u2466"},{"id":"ref-for-the-meta-element\u2467"},{"id":"ref-for-the-meta-element\u2468"},{"id":"ref-for-the-meta-element\u2460\u24ea"},{"id":"ref-for-the-meta-element\u2460\u2460"},{"id":"ref-for-the-meta-element\u2460\u2461"},{"id":"ref-for-the-meta-element\u2460\u2462"},{"id":"ref-for-the-meta-element\u2460\u2463"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-the-meta-element\u2460\u2464"}],"title":"7.7. frame-ancestors"}],"url":"http://www.w3.org/TR/html5/document-metadata.html#the-meta-element"},
"fe21e5e5": {"dfnID":"fe21e5e5","dfnText":"url()","external":true,"refSections":[{"refs":[{"id":"ref-for-uri"}],"title":"7.9. img-src"}],"url":"http://www.w3.org/TR/CSS21/syndata.html#uri"},
"fire-a-violation-event": {"dfnID":"fire-a-violation-event","dfnText":"fire a violation event","external":false,"refSections":[{"refs":[{"id":"ref-for-fire-a-violation-event"}],"title":"4.4. Reporting"}],"url":"#fire-a-violation-event"},
"font-src": {"dfnID":"font-src","dfnText":"font-src","external":false,"refSections":[{"refs":[{"id":"ref-for-font-src"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-font-src\u2460"}],"title":"7.4.1. Usage"}],"url":"#font-src"},
"form-action": {"dfnID":"form-action","dfnText":"form-action","external":false,"refSections":[{"refs":[{"id":"ref-for-form-action"}],"title":"1.1. Changes from Level 1"}],"url":"#form-action"},
"frame-ancestors": {"dfnID":"frame-ancestors","dfnText":"frame-ancestors","external":false,"refSections":[{"refs":[{"id":"ref-for-frame-ancestors"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-frame-ancestors\u2460"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-frame-ancestors\u2461"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-frame-ancestors\u2462"}],"title":"7.7.2. Multiple Host Source Values"},{"refs":[{"id":"ref-for-frame-ancestors\u2463"},{"id":"ref-for-frame-ancestors\u2464"},{"id":"ref-for-frame-ancestors\u2465"}],"title":"10. Implementation Considerations"},{"refs":[{"id":"ref-for-frame-ancestors\u2466"}],"title":"10.1. Processing Complications"},{"refs":[{"id":"ref-for-frame-ancestors\u2467"}],"title":"12. Acknowledgements"}],"url":"#frame-ancestors"},
"frame-src": {"dfnID":"frame-src","dfnText":"frame-src","external":false,"refSections":[{"refs":[{"id":"ref-for-frame-src"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-frame-src\u2460"}],"title":"7.2.1. Nested Browsing Contexts"}],"url":"#frame-src"},
"generate-a-violation-report-object": {"dfnID":"generate-a-violation-report-object","dfnText":"generate a violation report object","external":false,"refSections":[{"refs":[{"id":"ref-for-generate-a-violation-report-object"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-generate-a-violation-report-object\u2460"}],"title":"6.3. Firing Violation Events"}],"url":"#generate-a-violation-report-object"},
"globally-unique-identifier": {"dfnID":"globally-unique-identifier","dfnText":"globally unique identifier","external":false,"refSections":[{"refs":[{"id":"ref-for-globally-unique-identifier"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-globally-unique-identifier\u2460"}],"title":"5.1. Workers"}],"url":"#globally-unique-identifier"},
"hash-algo": {"dfnID":"hash-algo","dfnText":"hash-algo","external":false,"refSections":[{"refs":[{"id":"ref-for-hash-algo"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-hash-algo\u2460"},{"id":"ref-for-hash-algo\u2461"},{"id":"ref-for-hash-algo\u2462"}],"title":"4.2.5. Valid Hashes"}],"url":"#hash-algo"},
"hash-source": {"dfnID":"hash-source","dfnText":"hash-source","external":false,"refSections":[{"refs":[{"id":"ref-for-hash-source"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-hash-source\u2460"}],"title":"4.2.5. Valid Hashes"},{"refs":[{"id":"ref-for-hash-source\u2461"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-hash-source\u2462"}],"title":"7.16. style-src"}],"url":"#hash-source"},
"hash-value": {"dfnID":"hash-value","dfnText":"hash-value","external":false,"refSections":[{"refs":[{"id":"ref-for-hash-value"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-hash-value\u2460"}],"title":"4.2.5. Valid Hashes"}],"url":"#hash-value"},
"host-char": {"dfnID":"host-char","dfnText":"host-char","external":false,"refSections":[{"refs":[{"id":"ref-for-host-char"},{"id":"ref-for-host-char\u2460"},{"id":"ref-for-host-char\u2461"}],"title":"4.2. Source List Syntax"}],"url":"#host-char"},
"host-part": {"dfnID":"host-part","dfnText":"host-part","external":false,"refSections":[{"refs":[{"id":"ref-for-host-part"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-host-part\u2460"},{"id":"ref-for-host-part\u2461"},{"id":"ref-for-host-part\u2462"},{"id":"ref-for-host-part\u2463"}],"title":"4.2.2. Matching Source Expressions"}],"url":"#host-part"},
"host-source": {"dfnID":"host-source","dfnText":"host-source","external":false,"refSections":[{"refs":[{"id":"ref-for-host-source"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-host-source\u2460"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-host-source\u2461"}],"title":"7.7. frame-ancestors"}],"url":"#host-source"},
"http-200-response": {"dfnID":"http-200-response","dfnText":"HTTP 200 response","external":false,"refSections":[{"refs":[{"id":"ref-for-http-200-response"}],"title":"7.7. frame-ancestors"}],"url":"#http-200-response"},
"img-src": {"dfnID":"img-src","dfnText":"img-src","external":false,"refSections":[{"refs":[{"id":"ref-for-img-src"}],"title":"4.2.2.3. Paths and Redirects"},{"refs":[{"id":"ref-for-img-src\u2460"}],"title":"7.4. default-src"}],"url":"#img-src"},
"json-object": {"dfnID":"json-object","dfnText":"JSON object","external":false,"refSections":[{"refs":[{"id":"ref-for-json-object"}],"title":"4.4. Reporting"}],"url":"#json-object"},
"json-stringification": {"dfnID":"json-stringification","dfnText":"JSON stringification","external":false,"refSections":[{"refs":[{"id":"ref-for-json-stringification"}],"title":"4.4. Reporting"}],"url":"#json-stringification"},
"keyword-source": {"dfnID":"keyword-source","dfnText":"keyword-source","external":false,"refSections":[{"refs":[{"id":"ref-for-keyword-source"}],"title":"4.2. Source List Syntax"}],"url":"#keyword-source"},
"match-a-media-type-list": {"dfnID":"match-a-media-type-list","dfnText":"matches a media type\n      list","external":false,"refSections":[{"refs":[{"id":"ref-for-match-a-media-type-list"}],"title":"7.12. plugin-types"}],"url":"#match-a-media-type-list"},
"match-a-source-expression": {"dfnID":"match-a-source-expression","dfnText":"match a source expression","external":false,"refSections":[{"refs":[{"id":"ref-for-match-a-source-expression"}],"title":"4.2.2. Matching Source Expressions"}],"url":"#match-a-source-expression"},
"match-a-source-list": {"dfnID":"match-a-source-list","dfnText":"match a source list","external":false,"refSections":[{"refs":[{"id":"ref-for-match-a-source-list"}],"title":"7.1. base-uri"},{"refs":[{"id":"ref-for-match-a-source-list\u2460"}],"title":"7.2.2. Workers"},{"refs":[{"id":"ref-for-match-a-source-list\u2461"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2462"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2463"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-match-a-source-list\u2464"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-match-a-source-list\u2465"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2466"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2467"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2468"},{"id":"ref-for-match-a-source-list\u2460\u24ea"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2460\u2460"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-match-a-source-list\u2460\u2461"}],"title":"7.16. style-src"}],"url":"#match-a-source-list"},
"media-src": {"dfnID":"media-src","dfnText":"media-src","external":false,"refSections":[{"refs":[{"id":"ref-for-media-src"}],"title":"7.4. default-src"}],"url":"#media-src"},
"media-type": {"dfnID":"media-type","dfnText":"media type","external":false,"refSections":[],"url":"#media-type"},
"media-type-list": {"dfnID":"media-type-list","dfnText":"media type list","external":false,"refSections":[],"url":"#media-type-list"},
"media-type-list①": {"dfnID":"media-type-list\u2460","dfnText":"media-type-list","external":false,"refSections":[],"url":"#media-type-list\u2460"},
"media-type①": {"dfnID":"media-type\u2460","dfnText":"media-type","external":false,"refSections":[{"refs":[{"id":"ref-for-media-type\u2460"},{"id":"ref-for-media-type\u2460\u2460"}],"title":"4.3. Media Type List Syntax"},{"refs":[{"id":"ref-for-media-type\u2460\u2461"}],"title":"4.3.1. Parsing"}],"url":"#media-type\u2460"},
"monitor": {"dfnID":"monitor","dfnText":"monitor","external":false,"refSections":[{"refs":[{"id":"ref-for-monitor"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-monitor\u2460"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-monitor\u2461"}],"title":"5. Processing Model"},{"refs":[{"id":"ref-for-monitor\u2462"}],"title":"5.1. Workers"},{"refs":[{"id":"ref-for-monitor\u2463"}],"title":"5.2. srcdoc iframes"},{"refs":[{"id":"ref-for-monitor\u2464"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-monitor\u2465"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-monitor\u2466"},{"id":"ref-for-monitor\u2467"}],"title":"7.14. sandbox"}],"url":"#monitor"},
"nonce-source": {"dfnID":"nonce-source","dfnText":"nonce-source","external":false,"refSections":[{"refs":[{"id":"ref-for-nonce-source"},{"id":"ref-for-nonce-source\u2460"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-nonce-source\u2461"}],"title":"4.2.4. Valid Nonces"},{"refs":[{"id":"ref-for-nonce-source\u2462"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-nonce-source\u2463"}],"title":"7.16. style-src"}],"url":"#nonce-source"},
"nonce-value": {"dfnID":"nonce-value","dfnText":"nonce-value","external":false,"refSections":[{"refs":[{"id":"ref-for-nonce-value"},{"id":"ref-for-nonce-value\u2460"},{"id":"ref-for-nonce-value\u2461"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-nonce-value\u2462"}],"title":"4.2.4. Valid Nonces"}],"url":"#nonce-value"},
"object-src": {"dfnID":"object-src","dfnText":"object-src","external":false,"refSections":[{"refs":[{"id":"ref-for-object-src"},{"id":"ref-for-object-src\u2460"}],"title":"2.1. Terms defined by this specification"},{"refs":[{"id":"ref-for-object-src\u2461"}],"title":"7. Directives"},{"refs":[{"id":"ref-for-object-src\u2462"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-object-src\u2463"}],"title":"8.1. Sample Policy Definitions"}],"url":"#object-src"},
"origin": {"dfnID":"origin","dfnText":"origin","external":false,"refSections":[{"refs":[{"id":"ref-for-origin"}],"title":"2.2. Terms defined by reference"},{"refs":[{"id":"ref-for-origin\u2460"},{"id":"ref-for-origin\u2461"},{"id":"ref-for-origin\u2462"}],"title":"4.4. Reporting"}],"url":"#origin"},
"parse-a-media-type-list": {"dfnID":"parse-a-media-type-list","dfnText":"parse a media type list","external":false,"refSections":[{"refs":[{"id":"ref-for-parse-a-media-type-list"}],"title":"4.3.2. Matching"},{"refs":[{"id":"ref-for-parse-a-media-type-list\u2460"}],"title":"7.12. plugin-types"}],"url":"#parse-a-media-type-list"},
"parse-a-source-list": {"dfnID":"parse-a-source-list","dfnText":"parse a source list","external":false,"refSections":[{"refs":[{"id":"ref-for-parse-a-source-list"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-parse-a-source-list\u2460"}],"title":"7.1. base-uri"},{"refs":[{"id":"ref-for-parse-a-source-list\u2461"}],"title":"7.2. child-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2462"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2463"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2464"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2465"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-parse-a-source-list\u2466"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-parse-a-source-list\u2467"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2468"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2460\u24ea"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2460\u2460"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2460\u2461"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-parse-a-source-list\u2460\u2462"}],"title":"7.16. style-src"}],"url":"#parse-a-source-list"},
"parse-the-policy": {"dfnID":"parse-the-policy","dfnText":"parse the policy","external":false,"refSections":[{"refs":[{"id":"ref-for-parse-the-policy"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-parse-the-policy\u2460"},{"id":"ref-for-parse-the-policy\u2461"}],"title":"5. Processing Model"}],"url":"#parse-the-policy"},
"path-part": {"dfnID":"path-part","dfnText":"path-part","external":false,"refSections":[{"refs":[{"id":"ref-for-path-part"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-path-part\u2460"}],"title":"4.2.2. Matching Source Expressions"}],"url":"#path-part"},
"plugin-types": {"dfnID":"plugin-types","dfnText":"plugin-types","external":false,"refSections":[{"refs":[{"id":"ref-for-plugin-types"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-plugin-types\u2460"}],"title":"4.3. Media Type List Syntax"},{"refs":[{"id":"ref-for-plugin-types\u2461"},{"id":"ref-for-plugin-types\u2462"}],"title":"7.12.1. Usage"}],"url":"#plugin-types"},
"policy-token": {"dfnID":"policy-token","dfnText":"policy-token","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-token"}],"title":"3.1. \n      Content-Security-Policy Header Field\n    "},{"refs":[{"id":"ref-for-policy-token\u2460"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "}],"url":"#policy-token"},
"port-part": {"dfnID":"port-part","dfnText":"port-part","external":false,"refSections":[{"refs":[{"id":"ref-for-port-part"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-port-part\u2460"},{"id":"ref-for-port-part\u2461"}],"title":"4.2.2. Matching Source Expressions"}],"url":"#port-part"},
"protected-resource": {"dfnID":"protected-resource","dfnText":"protected resource","external":false,"refSections":[{"refs":[{"id":"ref-for-protected-resource"},{"id":"ref-for-protected-resource\u2460"},{"id":"ref-for-protected-resource\u2461"},{"id":"ref-for-protected-resource\u2462"},{"id":"ref-for-protected-resource\u2463"},{"id":"ref-for-protected-resource\u2464"},{"id":"ref-for-protected-resource\u2465"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-protected-resource\u2466"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-protected-resource\u2467"}],"title":"7.1. base-uri"},{"refs":[{"id":"ref-for-protected-resource\u2468"}],"title":"7.2.2. Workers"},{"refs":[{"id":"ref-for-protected-resource\u2460\u24ea"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2460"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2461"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2462"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2463"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2464"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2465"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2466"},{"id":"ref-for-protected-resource\u2460\u2467"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-protected-resource\u2460\u2468"},{"id":"ref-for-protected-resource\u2461\u24ea"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-protected-resource\u2461\u2460"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-protected-resource\u2461\u2461"}],"title":"7.16. style-src"}],"url":"#protected-resource"},
"report-a-violation": {"dfnID":"report-a-violation","dfnText":"report a violation","external":false,"refSections":[{"refs":[{"id":"ref-for-report-a-violation"}],"title":"5. Processing Model"},{"refs":[{"id":"ref-for-report-a-violation\u2460"}],"title":"7.2.2. Workers"},{"refs":[{"id":"ref-for-report-a-violation\u2461"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-report-a-violation\u2462"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-report-a-violation\u2463"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-report-a-violation\u2464"}],"title":"7.7. frame-ancestors"},{"refs":[{"id":"ref-for-report-a-violation\u2465"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-report-a-violation\u2466"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-report-a-violation\u2467"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-report-a-violation\u2468"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-report-a-violation\u2460\u24ea"}],"title":"7.12. plugin-types"},{"refs":[{"id":"ref-for-report-a-violation\u2460\u2460"},{"id":"ref-for-report-a-violation\u2460\u2461"},{"id":"ref-for-report-a-violation\u2460\u2462"},{"id":"ref-for-report-a-violation\u2460\u2463"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-report-a-violation\u2460\u2464"},{"id":"ref-for-report-a-violation\u2460\u2465"},{"id":"ref-for-report-a-violation\u2460\u2466"}],"title":"7.16. style-src"}],"url":"#report-a-violation"},
"report-uri": {"dfnID":"report-uri","dfnText":"report-uri","external":false,"refSections":[{"refs":[{"id":"ref-for-report-uri"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-report-uri\u2460"},{"id":"ref-for-report-uri\u2461"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-report-uri\u2462"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-report-uri\u2463"}],"title":"8.2. Sample Violation Report"}],"url":"#report-uri"},
"resource-representation": {"dfnID":"resource-representation","dfnText":"resource representation","external":false,"refSections":[{"refs":[{"id":"ref-for-resource-representation"}],"title":"2.1. Terms defined by this specification"},{"refs":[{"id":"ref-for-resource-representation\u2460"},{"id":"ref-for-resource-representation\u2461"}],"title":"3.1. \n      Content-Security-Policy Header Field\n    "},{"refs":[{"id":"ref-for-resource-representation\u2462"},{"id":"ref-for-resource-representation\u2463"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "}],"url":"#resource-representation"},
"runs-a-worker": {"dfnID":"runs-a-worker","dfnText":"runs a worker","external":false,"refSections":[{"refs":[{"id":"ref-for-runs-a-worker"}],"title":"5.1. Workers"},{"refs":[{"id":"ref-for-runs-a-worker\u2460"}],"title":"7.14.1. Sandboxing and Workers"}],"url":"#runs-a-worker"},
"sandbox": {"dfnID":"sandbox","dfnText":"sandbox","external":false,"refSections":[{"refs":[{"id":"ref-for-sandbox"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-sandbox\u2460"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-sandbox\u2461"},{"id":"ref-for-sandbox\u2462"}],"title":"7.14.1. Sandboxing and Workers"},{"refs":[{"id":"ref-for-sandbox\u2463"},{"id":"ref-for-sandbox\u2464"}],"title":"7.14.2. Usage"}],"url":"#sandbox"},
"sandbox-token": {"dfnID":"sandbox-token","dfnText":"sandbox-token","external":false,"refSections":[{"refs":[{"id":"ref-for-sandbox-token"}],"title":"7.14. sandbox"}],"url":"#sandbox-token"},
"scheme-part": {"dfnID":"scheme-part","dfnText":"scheme-part","external":false,"refSections":[{"refs":[{"id":"ref-for-scheme-part"},{"id":"ref-for-scheme-part\u2460"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-scheme-part\u2461"},{"id":"ref-for-scheme-part\u2462"}],"title":"4.2.2. Matching Source Expressions"}],"url":"#scheme-part"},
"scheme-source": {"dfnID":"scheme-source","dfnText":"scheme-source","external":false,"refSections":[{"refs":[{"id":"ref-for-scheme-source"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-scheme-source\u2460"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-scheme-source\u2461"}],"title":"7.7. frame-ancestors"}],"url":"#scheme-source"},
"script-src": {"dfnID":"script-src","dfnText":"script-src","external":false,"refSections":[{"refs":[{"id":"ref-for-script-src"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-script-src\u2460"},{"id":"ref-for-script-src\u2461"}],"title":"2.1. Terms defined by this specification"},{"refs":[{"id":"ref-for-script-src\u2462"}],"title":"3.1. \n      Content-Security-Policy Header Field\n    "},{"refs":[{"id":"ref-for-script-src\u2463"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-script-src\u2464"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-script-src\u2465"}],"title":"3.4. Enforcing multiple policies"},{"refs":[{"id":"ref-for-script-src\u2466"}],"title":"4.2.2.1. \n          Security Considerations for GUID URL schemes\n        "},{"refs":[{"id":"ref-for-script-src\u2467"},{"id":"ref-for-script-src\u2468"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-script-src\u2460\u24ea"}],"title":"7. Directives"},{"refs":[{"id":"ref-for-script-src\u2460\u2460"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-script-src\u2460\u2461"},{"id":"ref-for-script-src\u2460\u2462"}],"title":"7.4.1. Usage"},{"refs":[{"id":"ref-for-script-src\u2460\u2463"},{"id":"ref-for-script-src\u2460\u2464"},{"id":"ref-for-script-src\u2460\u2465"}],"title":"7.15.1. \n        Nonce usage for script elements\n      "},{"refs":[{"id":"ref-for-script-src\u2460\u2466"},{"id":"ref-for-script-src\u2460\u2467"},{"id":"ref-for-script-src\u2460\u2468"}],"title":"7.15.2. \n        Hash usage for script elements\n      "},{"refs":[{"id":"ref-for-script-src\u2461\u24ea"}],"title":"7.16. style-src"},{"refs":[{"id":"ref-for-script-src\u2461\u2460"},{"id":"ref-for-script-src\u2461\u2461"}],"title":"8.1. Sample Policy Definitions"}],"url":"#script-src"},
"security-policy": {"dfnID":"security-policy","dfnText":"security policy","external":false,"refSections":[{"refs":[{"id":"ref-for-security-policy"}],"title":"2.1. Terms defined by this specification"},{"refs":[{"id":"ref-for-security-policy\u2460"}],"title":"3. Policy Delivery"},{"refs":[{"id":"ref-for-security-policy\u2461"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-security-policy\u2462"}],"title":"3.5. Policy applicability"},{"refs":[{"id":"ref-for-security-policy\u2463"}],"title":"4.2.2. Matching Source Expressions"},{"refs":[{"id":"ref-for-security-policy\u2464"}],"title":"4.4. Reporting"},{"refs":[{"id":"ref-for-security-policy\u2465"},{"id":"ref-for-security-policy\u2466"}],"title":"5.2. srcdoc iframes"},{"refs":[{"id":"ref-for-security-policy\u2467"}],"title":"7.16. style-src"},{"refs":[{"id":"ref-for-security-policy\u2468"}],"title":"8.1. Sample Policy Definitions"}],"url":"#security-policy"},
"security-policy-directive": {"dfnID":"security-policy-directive","dfnText":"security policy directive","external":false,"refSections":[{"refs":[{"id":"ref-for-security-policy-directive"}],"title":"3.3. \n      HTML meta Element\n    "},{"refs":[{"id":"ref-for-security-policy-directive\u2460"}],"title":"4.1. Policy Syntax"},{"refs":[{"id":"ref-for-security-policy-directive\u2461"}],"title":"4.4. Reporting"}],"url":"#security-policy-directive"},
"security-policy-directive-name": {"dfnID":"security-policy-directive-name","dfnText":"security policy directive name","external":false,"refSections":[{"refs":[{"id":"ref-for-security-policy-directive-name"}],"title":"4.1. Policy Syntax"}],"url":"#security-policy-directive-name"},
"security-policy-directive-value": {"dfnID":"security-policy-directive-value","dfnText":"security policy directive value","external":false,"refSections":[{"refs":[{"id":"ref-for-security-policy-directive-value"}],"title":"4.1. Policy Syntax"}],"url":"#security-policy-directive-value"},
"securitypolicyviolationevent": {"dfnID":"securitypolicyviolationevent","dfnText":"SecurityPolicyViolationEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-securitypolicyviolationevent"},{"id":"ref-for-securitypolicyviolationevent\u2460"}],"title":"1.1. Changes from Level 1"},{"refs":[{"id":"ref-for-securitypolicyviolationevent\u2461"}],"title":"6.3. Firing Violation Events"}],"url":"#securitypolicyviolationevent"},
"send-violation-reports": {"dfnID":"send-violation-reports","dfnText":"send violation reports","external":false,"refSections":[{"refs":[{"id":"ref-for-send-violation-reports"}],"title":"3.2. \n      Content-Security-Policy-Report-Only Header Field\n    "},{"refs":[{"id":"ref-for-send-violation-reports\u2460"}],"title":"4.4. Reporting"}],"url":"#send-violation-reports"},
"set-of-report-urls": {"dfnID":"set-of-report-urls","dfnText":"set of report URLs","external":false,"refSections":[{"refs":[{"id":"ref-for-set-of-report-urls"},{"id":"ref-for-set-of-report-urls\u2460"}],"title":"4.4. Reporting"}],"url":"#set-of-report-urls"},
"sha-256": {"dfnID":"sha-256","dfnText":"SHA-256","external":false,"refSections":[{"refs":[{"id":"ref-for-sha-256"}],"title":"4.2.5. Valid Hashes"}],"url":"#sha-256"},
"sha-384": {"dfnID":"sha-384","dfnText":"SHA-384","external":false,"refSections":[{"refs":[{"id":"ref-for-sha-384"}],"title":"4.2.5. Valid Hashes"}],"url":"#sha-384"},
"sha-512": {"dfnID":"sha-512","dfnText":"SHA-512","external":false,"refSections":[{"refs":[{"id":"ref-for-sha-512"}],"title":"4.2.5. Valid Hashes"}],"url":"#sha-512"},
"source-expression": {"dfnID":"source-expression","dfnText":"source expression","external":false,"refSections":[],"url":"#source-expression"},
"source-expression①": {"dfnID":"source-expression\u2460","dfnText":"source-expression","external":false,"refSections":[{"refs":[{"id":"ref-for-source-expression\u2460"},{"id":"ref-for-source-expression\u2460\u2460"}],"title":"4.2. Source List Syntax"},{"refs":[{"id":"ref-for-source-expression\u2460\u2461"}],"title":"4.2.1. Parsing Source Lists"}],"url":"#source-expression\u2460"},
"source-file": {"dfnID":"source-file","dfnText":"source-file","external":false,"refSections":[{"refs":[{"id":"ref-for-source-file"},{"id":"ref-for-source-file\u2460"}],"title":"4.4. Reporting"}],"url":"#source-file"},
"source-list": {"dfnID":"source-list","dfnText":"source\n    list","external":false,"refSections":[],"url":"#source-list"},
"source-list①": {"dfnID":"source-list\u2460","dfnText":"source-list","external":false,"refSections":[{"refs":[{"id":"ref-for-source-list\u2460"}],"title":"7.1. base-uri"},{"refs":[{"id":"ref-for-source-list\u2460\u2460"}],"title":"7.2. child-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2461"}],"title":"7.3. connect-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2462"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2463"}],"title":"7.5. font-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2464"}],"title":"7.6. form-action"},{"refs":[{"id":"ref-for-source-list\u2460\u2465"}],"title":"7.8. frame-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2466"}],"title":"7.9. img-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2467"}],"title":"7.10. media-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2468"}],"title":"7.11. object-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2460\u24ea"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-source-list\u2460\u2460\u2460"}],"title":"7.16. style-src"}],"url":"#source-list\u2460"},
"strip-uri-for-reporting": {"dfnID":"strip-uri-for-reporting","dfnText":"strip\n    uri for reporting","external":false,"refSections":[{"refs":[{"id":"ref-for-strip-uri-for-reporting"},{"id":"ref-for-strip-uri-for-reporting\u2460"},{"id":"ref-for-strip-uri-for-reporting\u2461"}],"title":"4.4. Reporting"}],"url":"#strip-uri-for-reporting"},
"style-src": {"dfnID":"style-src","dfnText":"style-src","external":false,"refSections":[{"refs":[{"id":"ref-for-style-src"}],"title":"7.4. default-src"},{"refs":[{"id":"ref-for-style-src\u2460"}],"title":"9.1. Cascading Style Sheet (CSS) Parsing"}],"url":"#style-src"},
"uri-reference": {"dfnID":"uri-reference","dfnText":"uri-reference","external":false,"refSections":[{"refs":[{"id":"ref-for-uri-reference"},{"id":"ref-for-uri-reference\u2460"}],"title":"7.13. report-uri"}],"url":"#uri-reference"},
"url": {"dfnID":"url","dfnText":"URL","external":false,"refSections":[],"url":"#url"},
"valid-hash": {"dfnID":"valid-hash","dfnText":"valid hash","external":false,"refSections":[{"refs":[{"id":"ref-for-valid-hash"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-valid-hash\u2460"}],"title":"7.16. style-src"}],"url":"#valid-hash"},
"valid-nonce": {"dfnID":"valid-nonce","dfnText":"valid nonce","external":false,"refSections":[{"refs":[{"id":"ref-for-valid-nonce"},{"id":"ref-for-valid-nonce\u2460"}],"title":"7.15. script-src"},{"refs":[{"id":"ref-for-valid-nonce\u2461"}],"title":"7.15.1. \n        Nonce usage for script elements\n      "},{"refs":[{"id":"ref-for-valid-nonce\u2462"}],"title":"7.16. style-src"}],"url":"#valid-nonce"},
"vchar": {"dfnID":"vchar","dfnText":"VCHAR","external":false,"refSections":[],"url":"#vchar"},
"wsp": {"dfnID":"wsp","dfnText":"WSP","external":false,"refSections":[],"url":"#wsp"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#allowed-base-urls": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed base urls","type":"dfn","url":"#allowed-base-urls"},
"#allowed-child-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed child sources","type":"dfn","url":"#allowed-child-sources"},
"#allowed-connection-targets": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed connection targets","type":"dfn","url":"#allowed-connection-targets"},
"#allowed-font-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed font sources","type":"dfn","url":"#allowed-font-sources"},
"#allowed-form-actions": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed form actions","type":"dfn","url":"#allowed-form-actions"},
"#allowed-frame-ancestors": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed frame ancestors","type":"dfn","url":"#allowed-frame-ancestors"},
"#allowed-frame-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed frame sources","type":"dfn","url":"#allowed-frame-sources"},
"#allowed-image-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed image sources","type":"dfn","url":"#allowed-image-sources"},
"#allowed-media-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed media sources","type":"dfn","url":"#allowed-media-sources"},
"#allowed-object-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed object sources","type":"dfn","url":"#allowed-object-sources"},
"#allowed-plugin-media-types": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed plugin media types","type":"dfn","url":"#allowed-plugin-media-types"},
"#allowed-script-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed script sources","type":"dfn","url":"#allowed-script-sources"},
"#allowed-style-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"allowed style sources","type":"dfn","url":"#allowed-style-sources"},
"#ancestor-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"ancestor-source","type":"dfn","url":"#ancestor-source"},
"#ancestor-source-list": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"ancestor-source-list","type":"dfn","url":"#ancestor-source-list"},
"#base-uri": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"base-uri","type":"dfn","url":"#base-uri"},
"#base64-value": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"base64-value","type":"dfn","url":"#base64-value"},
"#callable": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"callable","type":"dfn","url":"#callable"},
"#child-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"child-src","type":"dfn","url":"#child-src"},
"#connect-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"connect-src","type":"dfn","url":"#connect-src"},
"#content-security-policy": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"content-security-policy","type":"dfn","url":"#content-security-policy"},
"#content-security-policy-report-only": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"content-security-policy-report-only","type":"dfn","url":"#content-security-policy-report-only"},
"#content-security-policy-task-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"content security policy task source","type":"dfn","url":"#content-security-policy-task-source"},
"#default-sources": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"default sources","type":"dfn","url":"#default-sources"},
"#default-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"default-src","type":"dfn","url":"#default-src"},
"#dictdef-securitypolicyviolationeventinit": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"SecurityPolicyViolationEventInit","type":"dictionary","url":"#dictdef-securitypolicyviolationeventinit"},
"#digest-of-elements-content": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"digest of element's content","type":"dfn","url":"#digest-of-elements-content"},
"#directive-name": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive-name","type":"dfn","url":"#directive-name"},
"#directive-token": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive-token","type":"dfn","url":"#directive-token"},
"#directive-value": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive-value","type":"dfn","url":"#directive-value"},
"#dom-htmlscriptelement-nonce": {"export":true,"for_":["HTMLScriptElement"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"nonce","type":"attribute","url":"#dom-htmlscriptelement-nonce"},
"#dom-htmlstyleelement-nonce": {"export":true,"for_":["HTMLStyleElement"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"nonce","type":"attribute","url":"#dom-htmlstyleelement-nonce"},
"#dom-securitypolicyviolationevent-blockeduri": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"blockedURI","type":"attribute","url":"#dom-securitypolicyviolationevent-blockeduri"},
"#dom-securitypolicyviolationevent-columnnumber": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"columnNumber","type":"attribute","url":"#dom-securitypolicyviolationevent-columnnumber"},
"#dom-securitypolicyviolationevent-documenturi": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"documentURI","type":"attribute","url":"#dom-securitypolicyviolationevent-documenturi"},
"#dom-securitypolicyviolationevent-effectivedirective": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"effectiveDirective","type":"attribute","url":"#dom-securitypolicyviolationevent-effectivedirective"},
"#dom-securitypolicyviolationevent-linenumber": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"lineNumber","type":"attribute","url":"#dom-securitypolicyviolationevent-linenumber"},
"#dom-securitypolicyviolationevent-originalpolicy": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"originalPolicy","type":"attribute","url":"#dom-securitypolicyviolationevent-originalpolicy"},
"#dom-securitypolicyviolationevent-referrer": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"referrer","type":"attribute","url":"#dom-securitypolicyviolationevent-referrer"},
"#dom-securitypolicyviolationevent-sourcefile": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sourceFile","type":"attribute","url":"#dom-securitypolicyviolationevent-sourcefile"},
"#dom-securitypolicyviolationevent-statuscode": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"statusCode","type":"attribute","url":"#dom-securitypolicyviolationevent-statuscode"},
"#dom-securitypolicyviolationevent-violateddirective": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"violatedDirective","type":"attribute","url":"#dom-securitypolicyviolationevent-violateddirective"},
"#dom-securitypolicyviolationeventinit-blockeduri": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"blockedURI","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-blockeduri"},
"#dom-securitypolicyviolationeventinit-columnnumber": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"columnNumber","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-columnnumber"},
"#dom-securitypolicyviolationeventinit-documenturi": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"documentURI","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-documenturi"},
"#dom-securitypolicyviolationeventinit-effectivedirective": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"effectiveDirective","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-effectivedirective"},
"#dom-securitypolicyviolationeventinit-linenumber": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"lineNumber","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-linenumber"},
"#dom-securitypolicyviolationeventinit-originalpolicy": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"originalPolicy","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-originalpolicy"},
"#dom-securitypolicyviolationeventinit-referrer": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"referrer","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-referrer"},
"#dom-securitypolicyviolationeventinit-sourcefile": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sourceFile","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-sourcefile"},
"#dom-securitypolicyviolationeventinit-violateddirective": {"export":true,"for_":["SecurityPolicyViolationEventInit"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"violatedDirective","type":"dict-member","url":"#dom-securitypolicyviolationeventinit-violateddirective"},
"#element-attrdef-script-nonce": {"export":true,"for_":["script"],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"nonce","type":"element-attr","url":"#element-attrdef-script-nonce"},
"#elements-content": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"element's content","type":"dfn","url":"#elements-content"},
"#enforce": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"enforce","type":"dfn","url":"#enforce"},
"#fire-a-violation-event": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"fire a violation event","type":"dfn","url":"#fire-a-violation-event"},
"#font-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"font-src","type":"dfn","url":"#font-src"},
"#form-action": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"form-action","type":"dfn","url":"#form-action"},
"#frame-ancestors": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"frame-ancestors","type":"dfn","url":"#frame-ancestors"},
"#frame-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"frame-src","type":"dfn","url":"#frame-src"},
"#generate-a-violation-report-object": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"generating a violation report object","type":"dfn","url":"#generate-a-violation-report-object"},
"#globally-unique-identifier": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"globally unique identifier","type":"dfn","url":"#globally-unique-identifier"},
"#hash-algo": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"hash-algo","type":"dfn","url":"#hash-algo"},
"#hash-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"hash-source","type":"dfn","url":"#hash-source"},
"#hash-value": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"hash-value","type":"dfn","url":"#hash-value"},
"#host-char": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"host-char","type":"dfn","url":"#host-char"},
"#host-part": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"host-part","type":"dfn","url":"#host-part"},
"#host-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"host-source","type":"dfn","url":"#host-source"},
"#http-200-response": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"http 200 response","type":"dfn","url":"#http-200-response"},
"#img-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"img-src","type":"dfn","url":"#img-src"},
"#json-object": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"json object","type":"dfn","url":"#json-object"},
"#json-stringification": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"json stringification","type":"dfn","url":"#json-stringification"},
"#keyword-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"keyword-source","type":"dfn","url":"#keyword-source"},
"#match-a-media-type-list": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"match a media type list","type":"dfn","url":"#match-a-media-type-list"},
"#match-a-source-expression": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"match a source expression","type":"dfn","url":"#match-a-source-expression"},
"#match-a-source-list": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"match a source list","type":"dfn","url":"#match-a-source-list"},
"#media-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"media-src","type":"dfn","url":"#media-src"},
"#media-type①": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"media-type","type":"dfn","url":"#media-type\u2460"},
"#monitor": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"monitor","type":"dfn","url":"#monitor"},
"#nonce-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"nonce-source","type":"dfn","url":"#nonce-source"},
"#nonce-value": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"nonce-value","type":"dfn","url":"#nonce-value"},
"#object-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"object-src","type":"dfn","url":"#object-src"},
"#origin": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"origin","type":"dfn","url":"#origin"},
"#parse-a-media-type-list": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"parse a media type list","type":"dfn","url":"#parse-a-media-type-list"},
"#parse-a-source-list": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"parse a source list","type":"dfn","url":"#parse-a-source-list"},
"#parse-the-policy": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"parse the policy","type":"dfn","url":"#parse-the-policy"},
"#path-part": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"path-part","type":"dfn","url":"#path-part"},
"#plugin-types": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"plugin-types","type":"dfn","url":"#plugin-types"},
"#policy-token": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"policy-token","type":"dfn","url":"#policy-token"},
"#port-part": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"port-part","type":"dfn","url":"#port-part"},
"#protected-resource": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"protected resource","type":"dfn","url":"#protected-resource"},
"#report-a-violation": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"report a violation","type":"dfn","url":"#report-a-violation"},
"#report-uri": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"report-uri","type":"dfn","url":"#report-uri"},
"#resource-representation": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"resource representation","type":"dfn","url":"#resource-representation"},
"#runs-a-worker": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"runs a worker","type":"dfn","url":"#runs-a-worker"},
"#sandbox": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sandbox","type":"dfn","url":"#sandbox"},
"#sandbox-token": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sandbox-token","type":"dfn","url":"#sandbox-token"},
"#scheme-part": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"scheme-part","type":"dfn","url":"#scheme-part"},
"#scheme-source": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"scheme-source","type":"dfn","url":"#scheme-source"},
"#script-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"script-src","type":"dfn","url":"#script-src"},
"#security-policy": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"security policy","type":"dfn","url":"#security-policy"},
"#security-policy-directive": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive","type":"dfn","url":"#security-policy-directive"},
"#security-policy-directive-name": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive name","type":"dfn","url":"#security-policy-directive-name"},
"#security-policy-directive-value": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"directive value","type":"dfn","url":"#security-policy-directive-value"},
"#securitypolicyviolationevent": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"SecurityPolicyViolationEvent","type":"interface","url":"#securitypolicyviolationevent"},
"#send-violation-reports": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"send violation reports","type":"dfn","url":"#send-violation-reports"},
"#set-of-report-urls": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"set of report urls","type":"dfn","url":"#set-of-report-urls"},
"#sha-256": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sha-256","type":"dfn","url":"#sha-256"},
"#sha-384": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sha-384","type":"dfn","url":"#sha-384"},
"#sha-512": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"sha-512","type":"dfn","url":"#sha-512"},
"#source-expression①": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"source-expression","type":"dfn","url":"#source-expression\u2460"},
"#source-file": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"source-file","type":"dfn","url":"#source-file"},
"#source-list①": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"source-list","type":"dfn","url":"#source-list\u2460"},
"#strip-uri-for-reporting": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"stripped for reporting","type":"dfn","url":"#strip-uri-for-reporting"},
"#style-src": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"style-src","type":"dfn","url":"#style-src"},
"#uri-reference": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"uri-reference","type":"dfn","url":"#uri-reference"},
"#valid-hash": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"valid hash","type":"dfn","url":"#valid-hash"},
"#valid-nonce": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"csp2-2","status":"local","text":"valid nonce","type":"dfn","url":"#valid-nonce"},
"http://www.w3.org/TR/CSS21/syndata.html#uri": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"url()","type":"function","url":"http://www.w3.org/TR/CSS21/syndata.html#uri"},
"http://www.w3.org/TR/SVG2/struct.html#SVGElement": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"svg","type":"element","url":"http://www.w3.org/TR/SVG2/struct.html#SVGElement"},
"http://www.w3.org/TR/dom/#dom-node-textcontent": {"export":true,"for_":["Node"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"textContent","type":"attribute","url":"http://www.w3.org/TR/dom/#dom-node-textcontent"},
"http://www.w3.org/TR/dom/#event": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"Event","type":"interface","url":"http://www.w3.org/TR/dom/#event"},
"http://www.w3.org/TR/dom/#eventinit": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"EventInit","type":"interface","url":"http://www.w3.org/TR/dom/#eventinit"},
"http://www.w3.org/TR/dom/#interface-document": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"Document","type":"interface","url":"http://www.w3.org/TR/dom/#interface-document"},
"http://www.w3.org/TR/html5/browsers.html#active-document": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"active document","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#active-document"},
"http://www.w3.org/TR/html5/browsers.html#ancestor-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"ancestor browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#ancestor-browsing-context"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-forms": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-forms","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-forms"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-pointer-lock": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-pointer-lock","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-pointer-lock"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-popups": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-popups","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-popups"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-same-origin","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-same-origin"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-scripts","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-scripts"},
"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-top-navigation": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"allow-top-navigation","type":"element-attr","url":"http://www.w3.org/TR/html5/browsers.html#attr-iframe-sandbox-allow-top-navigation"},
"http://www.w3.org/TR/html5/browsers.html#auxiliary-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"auxiliary browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#auxiliary-browsing-context"},
"http://www.w3.org/TR/html5/browsers.html#child-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"child browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#child-browsing-context"},
"http://www.w3.org/TR/html5/browsers.html#nested-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"nested browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#nested-browsing-context"},
"http://www.w3.org/TR/html5/browsers.html#opener-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"opener browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#opener-browsing-context"},
"http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"top-level browsing context","type":"dfn","url":"http://www.w3.org/TR/html5/browsers.html#top-level-browsing-context"},
"http://www.w3.org/TR/html5/document-metadata.html#attr-link-href": {"export":true,"for_":["link"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"href","type":"element-attr","url":"http://www.w3.org/TR/html5/document-metadata.html#attr-link-href"},
"http://www.w3.org/TR/html5/document-metadata.html#attr-link-rel": {"export":true,"for_":["link"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"rel","type":"element-attr","url":"http://www.w3.org/TR/html5/document-metadata.html#attr-link-rel"},
"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content": {"export":true,"for_":["meta"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"content","type":"element-attr","url":"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-content"},
"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv": {"export":true,"for_":["meta"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"http-equiv","type":"element-attr","url":"http://www.w3.org/TR/html5/document-metadata.html#attr-meta-http-equiv"},
"http://www.w3.org/TR/html5/document-metadata.html#htmlstyleelement": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"HTMLStyleElement","type":"interface","url":"http://www.w3.org/TR/html5/document-metadata.html#htmlstyleelement"},
"http://www.w3.org/TR/html5/document-metadata.html#pragma-directives": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"pragma directives","type":"dfn","url":"http://www.w3.org/TR/html5/document-metadata.html#pragma-directives"},
"http://www.w3.org/TR/html5/document-metadata.html#the-head-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"head","type":"element","url":"http://www.w3.org/TR/html5/document-metadata.html#the-head-element"},
"http://www.w3.org/TR/html5/document-metadata.html#the-link-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"link","type":"element","url":"http://www.w3.org/TR/html5/document-metadata.html#the-link-element"},
"http://www.w3.org/TR/html5/document-metadata.html#the-meta-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"meta","type":"element","url":"http://www.w3.org/TR/html5/document-metadata.html#the-meta-element"},
"http://www.w3.org/TR/html5/document-metadata.html#the-style-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"style","type":"element","url":"http://www.w3.org/TR/html5/document-metadata.html#the-style-element"},
"http://www.w3.org/TR/html5/dom.html#dom-document-referrer": {"export":true,"for_":["Document"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"referrer","type":"attribute","url":"http://www.w3.org/TR/html5/dom.html#dom-document-referrer"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-embed-src": {"export":true,"for_":["embed"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"src","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-embed-src"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox": {"export":true,"for_":["iframe"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"sandbox","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-iframe-sandbox"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-img-src": {"export":true,"for_":["img"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"src","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-img-src"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-media-src": {"export":true,"for_":["video"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"src","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-media-src"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-data": {"export":true,"for_":["object"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"data","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-data"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type": {"export":true,"for_":["object"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"type","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-object-type"},
"http://www.w3.org/TR/html5/embedded-content-0.html#attr-video-poster": {"export":true,"for_":["video"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"poster","type":"element-attr","url":"http://www.w3.org/TR/html5/embedded-content-0.html#attr-video-poster"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"audio","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-audio-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"embed","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-embed-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"iframe","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-iframe-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"img","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-img-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"object","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-object-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"source","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-source-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"track","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-track-element"},
"http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"video","type":"element","url":"http://www.w3.org/TR/html5/embedded-content-0.html#the-video-element"},
"http://www.w3.org/TR/html5/forms.html#attr-input-src": {"export":true,"for_":["input"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"src","type":"element-attr","url":"http://www.w3.org/TR/html5/forms.html#attr-input-src"},
"http://www.w3.org/TR/html5/forms.html#attr-input-type-image-keyword": {"export":true,"for_":["input"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"image","type":"element-attr","url":"http://www.w3.org/TR/html5/forms.html#attr-input-type-image-keyword"},
"http://www.w3.org/TR/html5/forms.html#the-form-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"form","type":"element","url":"http://www.w3.org/TR/html5/forms.html#the-form-element"},
"http://www.w3.org/TR/html5/forms.html#the-input-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"input","type":"element","url":"http://www.w3.org/TR/html5/forms.html#the-input-element"},
"http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"ascii case-insensitive match","type":"dfn","url":"http://www.w3.org/TR/html5/infrastructure.html#ascii-case-insensitive"},
"http://www.w3.org/TR/html5/infrastructure.html#fetch": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"fetch","type":"dfn","url":"http://www.w3.org/TR/html5/infrastructure.html#fetch"},
"http://www.w3.org/TR/html5/infrastructure.html#plugin": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"plugin","type":"dfn","url":"http://www.w3.org/TR/html5/infrastructure.html#plugin"},
"http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"strip leading and trailing whitespace","type":"dfn","url":"http://www.w3.org/TR/html5/infrastructure.html#strip-leading-and-trailing-whitespace"},
"http://www.w3.org/TR/html5/links.html#link-type-stylesheet": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"link type stylesheet","type":"dfn","url":"http://www.w3.org/TR/html5/links.html#link-type-stylesheet"},
"http://www.w3.org/TR/html5/links.html#rel-icon": {"export":true,"for_":["link"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"icon","type":"element-attr","url":"http://www.w3.org/TR/html5/links.html#rel-icon"},
"http://www.w3.org/TR/html5/obsolete.html#dom-applet-archive": {"export":true,"for_":["applet"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"archive","type":"element-attr","url":"http://www.w3.org/TR/html5/obsolete.html#dom-applet-archive"},
"http://www.w3.org/TR/html5/obsolete.html#dom-applet-code": {"export":true,"for_":["applet"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"code","type":"element-attr","url":"http://www.w3.org/TR/html5/obsolete.html#dom-applet-code"},
"http://www.w3.org/TR/html5/obsolete.html#frame": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"frame","type":"element","url":"http://www.w3.org/TR/html5/obsolete.html#frame"},
"http://www.w3.org/TR/html5/obsolete.html#the-applet-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"applet","type":"element","url":"http://www.w3.org/TR/html5/obsolete.html#the-applet-element"},
"http://www.w3.org/TR/html5/scripting-1.html#attr-script-src": {"export":true,"for_":["script"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"src","type":"element-attr","url":"http://www.w3.org/TR/html5/scripting-1.html#attr-script-src"},
"http://www.w3.org/TR/html5/scripting-1.html#htmlscriptelement": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"HTMLScriptElement","type":"interface","url":"http://www.w3.org/TR/html5/scripting-1.html#htmlscriptelement"},
"http://www.w3.org/TR/html5/scripting-1.html#the-script-element": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"script","type":"element","url":"http://www.w3.org/TR/html5/scripting-1.html#the-script-element"},
"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-setinterval": {"export":true,"for_":["WindowTimers"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"setInterval()","type":"method","url":"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-setinterval"},
"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-settimeout": {"export":true,"for_":["WindowTimers"],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"setTimeout()","type":"method","url":"http://www.w3.org/TR/html5/webappapis.html#dom-windowtimers-settimeout"},
"http://www.w3.org/TR/url/#concept-ipv6": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"ipv6 address","type":"dfn","url":"http://www.w3.org/TR/url/#concept-ipv6"},
"http://www.w3.org/TR/url/#concept-url-host": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"host","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-host"},
"http://www.w3.org/TR/url/#concept-url-origin": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"origin of a url","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-origin"},
"http://www.w3.org/TR/url/#concept-url-parser": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"url parser","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-parser"},
"http://www.w3.org/TR/url/#concept-url-path": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"path","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-path"},
"http://www.w3.org/TR/url/#concept-url-port": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"port","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-port"},
"http://www.w3.org/TR/url/#concept-url-scheme": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"scheme","type":"dfn","url":"http://www.w3.org/TR/url/#concept-url-scheme"},
"http://www.w3.org/TR/url/#default-port": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"default port","type":"dfn","url":"http://www.w3.org/TR/url/#default-port"},
"http://www.w3.org/TR/url/#percent-decode": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"percent decode","type":"dfn","url":"http://www.w3.org/TR/url/#percent-decode"},
"https://drafts.csswg.org/css-images-4/#funcdef-image": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-images","spec":"css-images-4","status":"current","text":"image()","type":"function","url":"https://drafts.csswg.org/css-images-4/#funcdef-image"},
"https://drafts.csswg.org/css-images-4/#funcdef-image-set": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-images","spec":"css-images-4","status":"current","text":"image-set()","type":"function","url":"https://drafts.csswg.org/css-images-4/#funcdef-image-set"},
"https://drafts.csswg.org/cssom-1/#insert-a-css-rule": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"insert a css rule","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#insert-a-css-rule"},
"https://drafts.csswg.org/cssom-1/#parse-a-css-declaration-block": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"parse a css declaration block","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#parse-a-css-declaration-block"},
"https://drafts.csswg.org/cssom-1/#parse-a-css-rule": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"parse a css rule","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#parse-a-css-rule"},
"https://drafts.csswg.org/cssom-1/#parse-a-group-of-selectors": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"parse a group of selectors","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#parse-a-group-of-selectors"},
"https://heycam.github.io/webidl/#idl-long": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"long","type":"interface","url":"https://heycam.github.io/webidl/#idl-long"},
"https://tools.ietf.org/html/rfc3986#section-3.2.2": {"export":true,"for_":[],"level":"2","normative":true,"shortname":"csp2","spec":"","status":"anchor-block","text":"ipv4address","type":"dfn","url":"https://tools.ietf.org/html/rfc3986#section-3.2.2"},
"https://webidl.spec.whatwg.org/#idl-DOMString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"DOMString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>