<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>CSS Color HDR Module Level 1</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="exploring" name="csswg-work-status">
  <meta content="UD" name="w3c-status">
  <meta content="This module explores additions to CSS Color 4 to enable High Dynamic Range (HDR)." name="abstract">
  <link href="../default.css" rel="stylesheet" type="text/css">
  <link href="../csslogo.ico" rel="shortcut icon" type="image/x-icon">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-UD" rel="stylesheet" type="text/css">
  <link href="https://www.w3.org/TR/css-color-hdr/" rel="canonical">
  <link href="style.css" rel="stylesheet">
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #707070;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #bbb;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">CSS Color HDR Module Level 1</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Unofficial Proposal Draft, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://drafts.csswg.org/css-color-hdr/">https://drafts.csswg.org/css-color-hdr/</a>
     <dt>Latest published version:
     <dd><a href="https://www.w3.org/TR/css-color-hdr/">https://www.w3.org/TR/css-color-hdr/</a>
     <dt>Issue Tracking:
     <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-color-hdr-1">CSSWG Issues Repository</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="1438"><a class="p-name fn u-email email" href="mailto:chris@w3.org">Chris Lilley</a> (<span class="p-org org">W3C</span>)
     <dt>Suggest an Edit for this Spec:
     <dd><a href="https://github.com/w3c/csswg-drafts/blob/master/css-color-hdr-1/Overview.bs">GitHub Editor</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This module explores additions to CSS Color 4 to enable High Dynamic Range (HDR).</p>
    <a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
(such as HTML and XML)
on screen, on paper, etc. 
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p><em>This section describes the status of this document at the time of its publication.
	Other documents may supersede this document.
	A list of current W3C publications
	and the latest revision of this technical report
	can be found in the <a href="https://www.w3.org/TR/">W3C technical reports index at https://www.w3.org/TR/.</a></em> </p>
   <p>Please send feedback
	by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
	including the spec code “css-color-hdr” in the title, like this:
	“[css-color-hdr] <i>…summary of comment…</i>”.
	All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
	Alternately, feedback can be sent to the (<a href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list <a href="mailto:www-style@w3.org?Subject=%5Bcss-color-hdr%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>. </p>
   <p>This document is governed by the <a href="https://www.w3.org/2020/Process-20200915/" id="w3c_process_revision">15 September 2020 W3C Process Document</a>. </p>
   <p>This document was produced by a group operating under the <a href="https://www.w3.org/Consortium/Patent-Policy-20200915/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/2004/01/pp-impl/32061/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes
	contains <a href="https://www.w3.org/Consortium/Patent-Policy-20200915/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy-20200915/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#values"><span class="secno">1.1</span> <span class="content">Value Definitions</span></a>
     </ol>
    <li>
     <a href="#predefined-HDR"><span class="secno">2</span> <span class="content">Predefined colorspaces for HDR:</span></a>
     <ol class="toc">
      <li><a href="#valdef-color-rec2100-pq"><span class="secno">2.1</span> <span class="content"><span>rec2100-pq</span></span></a>
      <li><a href="#valdef-color-rec2100-hlg"><span class="secno">2.2</span> <span class="content"><span>rec2100-hlg</span></span></a>
      <li><a href="#Jzazbz"><span class="secno">2.3</span> <span class="content"><span>Jzazbz</span></span></a>
      <li>
       <a href="#JzCzHz"><span class="secno">2.4</span> <span class="content"><span>JzCzHz</span></span></a>
       <ol class="toc">
        <li><a href="#Jzazbz-to-JzCzHz"><span class="secno">2.4.1</span> <span class="content"> Converting <span class="css">Jzazbz</span> colors to <span class="css">JzCzHz</span> colors</span></a>
        <li><a href="#JzCzHz-to-Jzazbz"><span class="secno">2.4.2</span> <span class="content"> Converting JzCzHz colors to Jzazbz  colors</span></a>
       </ol>
      <li><a href="#ICtCp"><span class="secno">2.5</span> <span class="content"><span>ICtCp</span></span></a>
     </ol>
    <li><a href="#Compositing-SDR-HDR"><span class="secno">3</span> <span class="content">Compositing SDR and HDR content</span></a>
    <li><a href="#priv-sec"><span class="secno"></span> <span class="content">Privacy and Security Considerations</span></a>
    <li><a href="#a11y"><span class="secno"></span> <span class="content">Accessibility Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> Document conventions</span></a>
      <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content"> Conformance classes</span></a>
      <li>
       <a href="#w3c-partial"><span class="secno"></span> <span class="content"> Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span class="content"> Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>CSS Color 4 adds Wide Color Gamut (WCG) colorspaces to the Open Web Platform.
	By design, these are all Standard Dynamic Range (SDR) colorspaces.
	This specification explores what additions might be suitable
	to also add High Dynamic Range (HDR).</p>
   <p>While WCG specifications have been broadly stable for some decades,
	HDR standards are less mature
	and have undergone frequent revision in the last decade.</p>
   <p>This specification is a collection of ideas and has no status whatsoever.
	It is not even an Editors Draft and has not been reviewed or adopted by
	the CSS Working Group.</p>
   <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span class="content">Value Definitions</span><a class="self-link" href="#values"></a></h3>
   <p>This specification follows the <a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSS property definition conventions</a> from <a data-link-type="biblio" href="#biblio-css2">[CSS2]</a> using the <a href="https://www.w3.org/TR/css-values-3/#value-defs">value definition syntax</a> from <a data-link-type="biblio" href="#biblio-css-values-3">[CSS-VALUES-3]</a>.
	Value types not defined in this specification are defined in CSS Values &amp; Units <span>[CSS-VALUES-3]</span>.
	Combination with other CSS modules may expand the definitions of these value types.</p>
   <p>In addition to the property-specific values listed in their definitions,
	all properties defined in this specification
	also accept the <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-wide-keywords" id="ref-for-css-wide-keywords">CSS-wide keywords</a> as their property value.
	For readability they have not been repeated explicitly.</p>
   <h2 class="heading settled" data-level="2" id="predefined-HDR"><span class="secno">2. </span><span class="content">Predefined colorspaces for HDR:</span><a class="self-link" href="#predefined-HDR"></a></h2>
   <p>In addition to the <a href="https://drafts.csswg.org/css-color-4/#predefined">SDR
	colorspaces</a> defined by CSS Color 4, the following HDR colorspaces are defined
	for use in the color function <a href="https://www.w3.org/TR/css-color-4/#color-function">CSS Color 4 §10.1 Specifying profiled colors: the color() function</a>.</p>
   <p>Serialization of values in these new colorspaces is identical to the decription in <a href="https://www.w3.org/TR/css-color-4/#serializing-color-values">CSS Color 4 §4.7 Serializing &lt;color> Values</a>.</p>
   <h3 class="heading settled" data-level="2.1" id="valdef-color-rec2100-pq"><span class="secno">2.1. </span><span class="content"><dfn data-dfn-type="dfn" data-export id="rec2100-pq">rec2100-pq<a class="self-link" href="#rec2100-pq"></a></dfn></span><a class="self-link" href="#valdef-color-rec2100-pq"></a></h3>
   <p>The <span class="css">rec2100-pq</span> <a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a> colorspace accepts three numeric parameters,
	representing the red, green, and blue channels of the color,
	with each having a valid range of [0, 1]
	regardless of the actual bit depth (10 or 12 bits per component).</p>
   <p class="issue" id="issue-9005a92b"><a class="self-link" href="#issue-9005a92b"></a> This is to avoid confusion if [0, 1024] and [0, 4096]
	encoded values are mixed up.
	Add examples showing conversion from binary values to the [0, 1] range.</p>
   <p class="issue" id="issue-9ed1b145"><a class="self-link" href="#issue-9ed1b145"></a> should this specification recommend that the CSS Object Model
	store these values in the 16-bit half-floating point representation
	(IEEE standard 754-2008.)
	from BT.2100 pp. 9-10? (or any wider representation, like float or double)?</p>
   <p class="issue" id="issue-692834b0"><a class="self-link" href="#issue-692834b0"></a> should the values accept % as well as number? so 19% as well as 0.19.
	Probably yes.</p>
   <p>The Perceptual Quantizer (PQ) electro-optical transfer function is used <a data-link-type="biblio" href="#biblio-smpte-st-2084">[SMPTE-ST-2084]</a>,<a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a>.
	PQ assumes a reference viewing condition
	where the screen surround
	is at 5 cd/m².</p>
   <p>ITU Reference 2100 is used for HDR 4k and 8k television.</p>
   <p>In contrast to SDR colorspaces and some HDR colorspaces,
	the PQ values are <em>absolute</em> rather than relative.</p>
   <p class="issue" id="issue-b905ab0c"><a class="self-link" href="#issue-b905ab0c"></a> add a diagram showing SDR and HDR dynamic ranges on a log scale</p>
   <p>It has the following characteristics:
	(The display primaries are the same as <a data-link-type="biblio" href="#biblio-rec2020">[Rec.2020]</a>):</p>
   <table>
    <thead>
     <tr>
      <td>
      <td>x
      <td>y
    <tbody>
     <tr>
      <th>Red chromaticity
      <td>0.708
      <td>0.292
     <tr>
      <th>Green chromaticity
      <td>0.170
      <td>0.797
     <tr>
      <th>Blue chromaticity
      <td>0.131
      <td>0.046
     <tr>
      <th>White chromaticity
      <td>0.3127
      <td>0.3290
     <tr>
      <th>Transfer function
      <td colspan="2">Perceptual Quantizer
     <tr>
      <th>White luminance
      <td colspan="2">203 cd/m²
     <tr>
      <th>Peak white luminance
      <td colspan="2">10,000 cd/m²
     <tr>
      <th>Black luminance
      <td colspan="2">0.001 cd/m²
     <tr>
      <th>Image state
      <td colspan="2">display-referred
   </table>
   <p class="issue" id="issue-2191a240"><a class="self-link" href="#issue-2191a240"></a> from BT.2100 p.3 "Note 3d – For PQ in a non-reference viewing environment, or for HLG (in any viewing environment), the black level should be adjusted using the PLUGE test signal and procedure specified in Recommendation ITU-R BT.814."</p>
   <div class="example" id="example-dbd71f8e">
    <a class="self-link" href="#example-dbd71f8e"></a> This color represents a blinding white
		with a luminance of 10,000 cd/m².
		Such a bright color can only be displayed briefly,
		on a small area of the screen.
		Content is typically mastered with a lower peak white,
		such as 4,000  cd/m². 
<pre><span class="swatch oog" style="--color: white"></span> color(rec2100-pq 1.0 1.0 1.0);
</pre>
   </div>
   <div class="example" id="example-337567a1">
    <a class="self-link" href="#example-337567a1"></a> This color represents a comfortable "diffuse white"
		This color can be displayed for long periods,
		or used for subtitles,
		on any sized area of the screen.
		Diffuse white is 203 cd/m². 
<pre><span class="swatch" style="--color: white"></span> color(rec2100-pq 0.58 0.58 0.58);
</pre>
    <p>This color represents a mid grey,
		like a photographer’s "18% reflectance grey" card,
		at 17 cd/m².</p>
<pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-pq 0.34 0.34 0.34);
</pre>
   </div>
   <p class="issue" id="issue-3762b88c"><a class="self-link" href="#issue-3762b88c"></a> add other examples, including encoding of sRGB red, green, blue and P3 red, green, blue.</p>
   <p>Linear-light RGB signals are converted to PQ encoded as follows. An absolute luminance scale is used, so the luminance of diffuse (media) white is required to scale relative luminances. The maximum encodable value (peak, small-area white) in PQ is 10,000 cd/m². Media whte is 203 cd/m² <a data-link-type="biblio" href="#biblio-rpt_bt2408">[Rpt_BT.2408]</a>.</p>
<pre class="lang-javascript highlight"><c- a>var</c-> Er<c- p>;</c->      <c- c1>// the red, green or blue component, [0, 1] for SDR, [0, 70ish] for HDR</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->  <c- c1>// the absolute luminance of diffuse white, cd/m²</c->
<c- a>var</c-> x <c- o>=</c-> Er <c- o>*</c-> Yw <c- o>/</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// absolute luminance of peak white is 10,000 cd/m².</c->
<c- a>const</c-> n <c- o>=</c-> <c- mf>2610</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>);</c->
<c- a>const</c-> m <c- o>=</c-> <c- mf>2523</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>);</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
xPQ <c- o>=</c-> <c- p>(((</c->c1 <c- o>+</c-> <c- p>(</c->c2 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>)))</c-> <c- o>/</c-> <c- p>(</c-><c- mf>1</c-> <c- o>+</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->x <c- o>**</c-> n<c- p>))))</c-> <c- o>**</c-> m<c- p>);</c->
</pre>
   <p>xPQ is the "gamma-corrected" (OETF-adjusted) signal [0, 1].</p>
   <p>PQ encoded values are converted to linear-light as follows:</p>
<pre class="lang-javascript highlight"><c- a>var</c-> xPQ<c- p>;</c->      <c- c1>// the red, green or blue PQ-encoded component, [0, 1]</c->
<c- a>const</c-> ninv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>14</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2610</c-><c- p>;</c->
<c- a>const</c-> minv <c- o>=</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>5</c-><c- p>)</c-> <c- o>/</c-> <c- mf>2523</c-><c- p>;</c->
<c- a>const</c-> c1 <c- o>=</c-> <c- mf>3424</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>12</c-><c- p>);</c->
<c- a>const</c-> c2 <c- o>=</c-> <c- mf>2413</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>const</c-> c3 <c- o>=</c-> <c- mf>2392</c-> <c- o>/</c-> <c- p>(</c-><c- mf>2</c-> <c- o>**</c-> <c- mf>7</c-><c- p>);</c->
<c- a>var</c-> x <c- o>=</c-> <c- p>(((</c->Math<c- p>.</c->max<c- p>(((</c->xPQ <c- o>**</c-> minv<c- p>)</c-> <c- o>-</c-> c1<c- p>),</c-> <c- mf>0</c-><c- p>)</c-> <c- o>/</c-> <c- p>(</c->c2 <c- o>-</c-> <c- p>(</c->c3 <c- o>*</c-> <c- p>(</c->xPQ <c- o>**</c-> minv<c- p>))))</c-> <c- o>**</c-> ninv<c- p>);</c->
<c- a>var</c-> Yw <c- o>=</c-> <c- mf>203</c-><c- p>;</c->      <c- c1>// the absolute luminance of diffuse white, cd/m²</c->
<c- a>var</c-> Ea <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-><c- p>;</c->   <c- c1>// absolute luminance, [0, 10,000].</c->
<c- a>var</c-> Er <c- o>=</c-> x <c- o>*</c-> <c- mf>10000</c-> <c- o>/</c-> Yw<c- p>;</c->   <c- c1>// luminance relative to diffuse white, [0, 70 or so].</c->
</pre>
   <h3 class="heading settled" data-level="2.2" id="valdef-color-rec2100-hlg"><span class="secno">2.2. </span><span class="content"><dfn data-dfn-type="dfn" data-export id="rec2100-hlg">rec2100-hlg<a class="self-link" href="#rec2100-hlg"></a></dfn></span><a class="self-link" href="#valdef-color-rec2100-hlg"></a></h3>
   <p>The <span class="css">rec2100-hlg</span> <a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a> colorspace accepts three numeric parameters,
	representing the red, green, and blue channels of the color,
	with each having a valid range of [0, 1]
	regardless of the actual bit depth (10 or 12 bits per component).</p>
   <p>The Hybrid Log-Gamma (HLG) electro-optical transfer function
	is used <a data-link-type="biblio" href="#biblio-arib_std-b67">[ARIB_STD-B67]</a>,<a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a>.
	HLG can be used with displays of different brightness
	in a wide range of viewing environments,
	with user control of the overall brightness level.
	A value of 0.75 represents "diffuse" or "media" white
	while an "18% reflectance grey" card
	has a value of 0.38. <a data-link-type="biblio" href="#biblio-rec_bt2390">[Rec_BT.2390]</a>.</p>
   <p>It has the following characteristics:
	(The display primaries are the same as <a data-link-type="biblio" href="#biblio-rec2020">[Rec.2020]</a>):</p>
   <table>
    <thead>
     <tr>
      <td>
      <td>x
      <td>y
    <tbody>
     <tr>
      <th>Red chromaticity
      <td>0.708
      <td>0.292
     <tr>
      <th>Green chromaticity
      <td>0.170
      <td>0.797
     <tr>
      <th>Blue chromaticity
      <td>0.131
      <td>0.046
     <tr>
      <th>White chromaticity
      <td>0.3127
      <td>0.3290
     <tr>
      <th>Transfer function
      <td colspan="2">Hybrid log Gamma
     <tr>
      <th>White luminance
     <tr>
      <td colspan="2">depends on viewing conditions
     <tr>
      <th>Peak white luminance
      <td colspan="2">12 times reference white
     <tr>
      <th>Black luminance
      <td colspan="2">depends on reference white, see text
     <tr>
      <th>Image state
      <td colspan="2">scene-referred
   </table>
   <p class="issue" id="issue-63bd5f3d"><a class="self-link" href="#issue-63bd5f3d"></a> add other examples</p>
   <div class="example" id="example-76514555">
    <a class="self-link" href="#example-76514555"></a> This color represents a comfortable "diffuse white"
		This color can be displayed for long periods,
		or used for subtitles,
		on any sized area of the screen.
		Content is typically mastered with a peak white
		of 1,000 to 4,000  cd/m²,
		so diffuse white will be 203 to 581 cd/m². 
<pre><span class="swatch" style="--color: white"></span> color(rec2100-hlg 0.75 0.75 0.75);
</pre>
    <p>This color represents a mid grey,
		at 26 to 104  cd/m².</p>
<pre><span class="swatch" style="--color: rgb(46.632% 46.632% 46.632%)"></span> color(rec2100-hlg 0.38 0.38 0.38);
</pre>
   </div>
   <p>Linear-light RGB signals are converted to HLG encoded as follows <a data-link-type="biblio" href="#biblio-rec_bt2390">[Rec_BT.2390]</a>:</p>
<pre class="lang-javascript highlight"><c- a>var</c-> E<c- p>;</c->      <c- c1>// the red, green or blue component, [0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->E <c- o>&lt;=</c-> <c- mf>1</c-><c- o>/</c-><c- mf>12</c-><c- p>)</c-> <c- p>{</c->
  Edash <c- o>=</c-> Math<c- p>.</c->sqrt<c- p>(</c-> <c- mf>3</c-> <c- o>*</c-> E<c- p>);</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  Edash <c- o>=</c-> a <c- o>*</c-> Math<c- p>.</c->log<c- p>(</c-><c- mf>12</c-> <c- o>*</c-> E <c- o>-</c-> b<c- p>)</c-> <c- o>+</c-> c<c- p>;</c->
<c- p>}</c->
</pre>
   <p>Edash is the "gamma-corrected" (OETF-adjusted) signal.</p>
   <p>The reverse conversion (HLG encoded to linear light) is as follows <a data-link-type="biblio" href="#biblio-rec_bt2390">[Rec_BT.2390]</a>::</p>
<pre class="lang-javascript highlight"><c- a>var</c-> Edash<c- p>;</c->      <c- c1>// the red, green or blue encoded component, [0, 1]</c->
<c- a>const</c-> a <c- o>=</c-> <c- mf>0.17883277</c-><c- p>;</c->
<c- a>const</c-> b <c- o>=</c-> <c- mf>0.28466892</c-><c- p>;</c->   <c- c1>// 1 - (4 * a)</c->
<c- a>const</c-> c <c- o>=</c-> <c- mf>0.55991073</c-><c- p>;</c->   <c- c1>// 0.5 - a * Math.log(4 *a)</c->
<c- k>if</c-> <c- p>(</c->Edash <c- o>&lt;=</c-> <c- mf>0.5</c-><c- p>)</c-> <c- p>{</c->
  E <c- o>=</c-> <c- p>(</c->Edash <c- o>**</c-> <c- mf>2</c-><c- p>)</c-> <c- o>/</c-> <c- mf>3</c-><c- p>;</c->
<c- p>}</c->
<c- k>else</c-> <c- p>{</c->
  E <c- o>=</c-> Math<c- p>.</c->exp<c- p>(((</c->Edash <c- o>-</c-> c<c- p>)</c-> <c- o>/</c-> a<c- p>)</c-> <c- o>+</c-> b<c- p>)</c-> <c- o>/</c-> <c- mf>12</c-><c- p>;</c->
<c- p>}</c->
</pre>
   <p class="issue" id="issue-fb589d17"><a class="self-link" href="#issue-fb589d17"></a> add black level lift Β as defined on same page?</p>
   <h3 class="heading settled" data-level="2.3" id="Jzazbz"><span class="secno">2.3. </span><span class="content"><dfn data-dfn-type="dfn" data-export id="jzazbz">Jzazbz<a class="self-link" href="#jzazbz"></a></dfn></span><a class="self-link" href="#Jzazbz"></a></h3>
   <p>The <span class="css">Jzazbz</span> colorspace <a data-link-type="biblio" href="#biblio-safdar-pucs">[Safdar-PUCS]</a> accepts three numeric parameters,
	with J<sub>z</sub> representing the Lightness (similar to L in Lab)
	while a<sub>z</sub> and b<sub>z</sub> represent the
	redness-greenness and yellowness-blueness
	opponent-color axes (similar to a and b in Lab).</p>
   <p>Lab uses a lightness scale with a [0%, 100%] range,
	relative to media white,
	and has been experimentally extended to L=400%.
	In contrast, the J<sub>z</sub> axis in <span class="css">Jzazbz</span> uses Perceptual Quantizer encoding,
	and can represent a dynamic range of more than 13 stops.</p>
   <p>It has the following characteristics:</p>
   <table>
    <thead>
     <tr>
      <td>
      <td>x
      <td>y
    <tbody>
     <tr>
      <th>White chromaticity
      <td>0.3127
      <td>0.3290
     <tr>
      <th>Transfer function
      <td colspan="2">Perceptual Quantizer
     <tr>
      <th>Peak white luminance
      <td colspan="2">10,000 cd/m²
     <tr>
      <th>Black luminance
      <td colspan="2">0.001 cd/m²
     <tr>
      <th>Image state
      <td colspan="2">display-referred
   </table>
   <p>Note that unlike Lab, a D65 whitepoint is used.
	Thus, for most RGB spaces
	(which also use a D65 whitepoint)
	no chromatic adaptation step need be performed.</p>
   <h3 class="heading settled" data-level="2.4" id="JzCzHz"><span class="secno">2.4. </span><span class="content"><dfn data-dfn-type="dfn" data-export id="jzczhz">JzCzHz<a class="self-link" href="#jzczhz"></a></dfn></span><a class="self-link" href="#JzCzHz"></a></h3>
   <p>Similar to LCH, which is the polar representation of Lab, <span class="css">JzCzHz</span> is the polar form of <span class="css">Jzazbz</span>.
	J<sub>z</sub> is identical to  the value in <span class="css">JzCzHz</span> and represents the Lightness,
	while C<sub>z</sub> represents the Chroma or colorfulness
	and H<sub>z</sub> represents a hue angle,
	measured from the positive a<sub>z</sub> axis,
	towards the positive b<sub>z</sub> axis.</p>
   <div class="example" id="example-f452e72c">
    <a class="self-link" href="#example-f452e72c"></a> This color represents the sRGB color "lime" in <span class="css">Jzazbz</span> 
<pre><span class="swatch" style="--color: lime"></span> color(jzazbz 0.17542 -0.1179 0.1092);
</pre>
    <p>and here is the same color in the polar form</p>
<pre><span class="swatch" style="--color: lime"></span> color(jzczhz 0.17542 0.1614 132.50);
</pre>
   </div>
   <h4 class="heading settled" data-level="2.4.1" id="Jzazbz-to-JzCzHz"><span class="secno">2.4.1. </span><span class="content"> Converting <span class="css">Jzazbz</span> colors to <span class="css">JzCzHz</span> colors</span><a class="self-link" href="#Jzazbz-to-JzCzHz"></a></h4>
   <p>Conversion to <span class="css">JzCzHz</span> is trivial:</p>
   <ol>
    <li>Hz = atan2(bz, az) // but convert to degrees! 
    <li>Cz = sqrt(az^2 + bz^2) 
    <li>Jz is the same 
   </ol>
   <h4 class="heading settled" data-level="2.4.2" id="JzCzHz-to-Jzazbz"><span class="secno">2.4.2. </span><span class="content"> Converting JzCzHz colors to Jzazbz  colors</span><a class="self-link" href="#JzCzHz-to-Jzazbz"></a></h4>
   <p>Conversion to <span class="css">Jzazbz</span> is trivial:</p>
   <ol>
    <li>az = Cz cos(H) 	// convert to radians first! 
    <li>bz = Cz sin(H)	// convert to radians first! 
    <li>Jz is the same 
   </ol>
   <h3 class="heading settled" data-level="2.5" id="ICtCp"><span class="secno">2.5. </span><span class="content"><dfn data-dfn-type="dfn" data-export id="ictcp">ICtCp<a class="self-link" href="#ictcp"></a></dfn></span><a class="self-link" href="#ICtCp"></a></h3>
   <p>The <span class="css">ICtCp</span> colorspace
	is defined as Constant Intensity IC<sub>T</sub>C<sub>P</sub> signal format
	in <a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a> and accepts three numeric parameters,
	with I representing the Intensity
	(similar to L in Lab, but covering a luminance range
	up to 10,000 cd/m<sup>2</sup>)
	while C<sub>T</sub> and C<sub>P</sub> represent the
	yellowness-blueness (tritanope) and
	redness-greenness (protanope)
	opponent-color axes (similar to b and a, respectively, in Lab).</p>
   <p>It is based on human visual system LMS cone primaries;
	the Hunt-Pointer-Estevez (HPE) XYZ to LMS transform
	is used,
	normalized to a D65 white point.
	A crosstalk matrix is then applied,
	to reduce the gamut hull concavities of BT.2020 RGB,
	thus reducing interpolation errors.
	The crosstalk also provides improved lines of constant hue
	and improved uniformity of Just Noticeable Difference (JND) MacAdam ellipses.</p>
   <p>It has the following characteristics:</p>
   <table>
    <thead>
     <tr>
      <td>
      <td>x
      <td>y
    <tbody>
     <tr>
      <th>White chromaticity
      <td>0.3127
      <td>0.3290
     <tr>
      <th>Transfer function
      <td colspan="2">Perceptual Quantizer
     <tr>
      <th>White luminance
      <td colspan="2">203 cd/m²
     <tr>
      <th>Peak white luminance
      <td colspan="2">10,000 cd/m²
     <tr>
      <th>Black luminance
      <td colspan="2">0.001 cd/m²
     <tr>
      <th>Image state
      <td colspan="2">display-referred
   </table>
   <p>Although <a data-link-type="biblio" href="#biblio-rec_bt2100">[Rec_BT.2100]</a> defines IC<sub>T</sub>C<sub>P</sub> by a conversion from linear-light BT.2100 RGB <span>[Rec_BT.2100]</span>,
	this conversion proceds via LMS
	and thus, any other color space can also be represented
	by applying an XYZ to LMS transform.</p>
   <p>Note that unlike Lab, a D65 whitepoint is used.</p>
   <p>Also unlike Lab, which has primarily been tested with
	lower-intensity reflective colors,
	IC<sub>T</sub>C<sub>P</sub> has been tested with
	high-chroma,
	self-luminous, and
	high intensity (HDR) colors.
	This makes it suitable for color difference measurement (deltaE ITP)
	and for gamut mapping of SDR and HDR colors.</p>
   <div class="example" id="example-1122f61d">
    <a class="self-link" href="#example-1122f61d"></a> This color represents the sRGB color "lime" in <span class="css">ICtCp</span> 
<pre><span class="swatch" style="--color: lime"></span> color(ictcp 0.5393 -0.2643 -0.0625);
</pre>
   </div>
   <h2 class="heading settled" data-level="3" id="Compositing-SDR-HDR"><span class="secno">3. </span><span class="content">Compositing SDR and HDR content</span><a class="self-link" href="#Compositing-SDR-HDR"></a></h2>
   <p>Compositing should take place in CIE XYZ,
as it is a linear-light space without gamut limitations.
Implementations may chose to composite in a linear-light RGB space instead,
which will give the same result
provided out-of-gamut values (negative, or greater than 100%)
are correctly handled
and not clipped or gamut mapped until
the final transfer to the device colorspace.</p>
   <p>Relative HDR, using the HLG transfer function,
must map SDR media white
to the same luminance as is used
to display the 75% HLG value. <a data-link-type="biblio" href="#biblio-smpte-st-2084">[SMPTE-ST-2084]</a></p>
   <p>For further details, see also tables 3 and 4 in ITU Rpt_BT.2408-0 <a data-link-type="biblio" href="#biblio-rpt_bt2408">[Rpt_BT.2408]</a></p>
   <p>Absolute HDR, using the PQ transfer function,
should map SDR media white
to 203 cd/m², the same luminance as is used
to display the 58% PQ value. <a data-link-type="biblio" href="#biblio-smpte-st-2084">[SMPTE-ST-2084]</a> However, implementations may chose to incorporate
a color re-rendering step (OOTF)
to account for non-reference viewing conditions.</p>
   <p class="issue" id="issue-42f2d9f1"><a class="self-link" href="#issue-42f2d9f1"></a> Do the PQ-based colorspaces require tone-mapping (OOTF) for display in different viewing environments?</p>
   <h2 class="no-num heading settled" id="priv-sec"><span class="content">Privacy and Security Considerations</span><a class="self-link" href="#priv-sec"></a></h2>
   <p class="issue" id="issue-2202014f"><a class="self-link" href="#issue-2202014f"></a> Make some considerations about privacy and security.</p>
   <h2 class="no-num heading settled" id="a11y"><span class="content">Accessibility Considerations</span><a class="self-link" href="#a11y"></a></h2>
   <p>Some individuals may have a sensitivity to very bright colors, so user agents should provide a mechanism to limit the maximum luminance at user option. The toe and knee procedure in section 5.4.1 <em>Mapping to display with limited brightness range</em> of <a data-link-type="biblio" href="#biblio-rec_bt2390">[Rec_BT.2390]</a> is suggested as suitable.</p>
  </main>
  <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
  <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code>class="example"</code>,
    like this: </p>
  <div class="example" id="example-ae2b6bc0">
   <a class="self-link" href="#example-ae2b6bc0"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code>class="note"</code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code>&lt;strong class="advisement"></code>, like
    this: <strong class="advisement"> UAs MUST provide an accessible alternative. </strong> </p>
  <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> Conformance classes</span><a class="self-link" href="#w3c-conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes: </p>
  <dl>
   <dt>style sheet 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>. 
   <dt>renderer 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that interprets the semantics of a style sheet and renders
            documents that use them. 
   <dt>authoring tool 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that writes a style sheet. 
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module. </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.) </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module. </p>
  <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> Partial implementations</span><a class="self-link" href="#w3c-partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong> treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS. </p>
  <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> Non-experimental implementations</span><a class="self-link" href="#w3c-testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec. </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group. </p>
  <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> mailing list.</p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#ictcp">ICtCp</a><span>, in §2.5</span>
   <li><a href="#jzazbz">Jzazbz</a><span>, in §2.3</span>
   <li><a href="#jzczhz">JzCzHz</a><span>, in §2.4</span>
   <li><a href="#rec2100-hlg">rec2100-hlg</a><span>, in §2.2</span>
   <li><a href="#rec2100-pq">rec2100-pq</a><span>, in §2.1</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-css-wide-keywords">
   <a href="https://drafts.csswg.org/css-values-4/#css-wide-keywords">https://drafts.csswg.org/css-values-4/#css-wide-keywords</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-css-wide-keywords">1.1. Value Definitions</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[css-values-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-css-wide-keywords">css-wide keywords</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-values-3">[CSS-VALUES-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-3/">CSS Values and Units Module Level 3</a>. 6 June 2019. CR. URL: <a href="https://www.w3.org/TR/css-values-3/">https://www.w3.org/TR/css-values-3/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://www.w3.org/TR/css-values-4/">CSS Values and Units Module Level 4</a>. 31 January 2019. WD. URL: <a href="https://www.w3.org/TR/css-values-4/">https://www.w3.org/TR/css-values-4/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://www.w3.org/TR/CSS21/">Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</a>. 7 June 2011. REC. URL: <a href="https://www.w3.org/TR/CSS21/">https://www.w3.org/TR/CSS21/</a>
   <dt id="biblio-rec2020">[Rec.2020]
   <dd><a href="http://www.itu.int/rec/R-REC-BT.2020/en">Recommendation  ITU-R  BT.2020-2:  Parameter values for ultra-high definition television systems for production and international programme exchange </a>. October 2015. URL: <a href="http://www.itu.int/rec/R-REC-BT.2020/en">http://www.itu.int/rec/R-REC-BT.2020/en</a>
   <dt id="biblio-rec_bt2100">[Rec_BT.2100]
   <dd><a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf">ITU-R BT.2100-2 Image parameter values for high dynamic range television for use in production and international programme exchange</a>. July 2018. URL: <a href="https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf">https://www.itu.int/dms_pubrec/itu-r/rec/bt/R-REC-BT.2100-2-201807-I!!PDF-E.pdf</a>
   <dt id="biblio-rec_bt2390">[Rec_BT.2390]
   <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">ITU-R BT.2390-8 High dynamic range television for production and international programme exchange</a>. February 2020. URL: <a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2390-8-2020-PDF-E.pdf</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rpt_bt2408">[Rpt_BT.2408]
   <dd><a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">Report ITU-R BT.2408-0 Operational practices in HDR television production</a>. October 2017. URL: <a href="https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf">https://www.itu.int/dms_pub/itu-r/opb/rep/R-REP-BT.2408-2017-PDF-E.pdf</a>
   <dt id="biblio-safdar-pucs">[Safdar-PUCS]
   <dd>Safdar, Muhammad; et al. <a href="https://www.osapublishing.org/DirectPDFAccess/33630C0F-CFF9-6328-FA6195B4E962F4D7_368272/oe-25-13-15131.pdf?da=1&amp;id=368272&amp;amp;seq=0&amp;amp;mobile=no">Perceptually uniform color space for image signals including high dynamic range and wide gamut</a>. 26 June 2017. URL: <a href="https://www.osapublishing.org/DirectPDFAccess/33630C0F-CFF9-6328-FA6195B4E962F4D7_368272/oe-25-13-15131.pdf?da=1&amp;id=368272&amp;amp;seq=0&amp;amp;mobile=no">https://www.osapublishing.org/DirectPDFAccess/33630C0F-CFF9-6328-FA6195B4E962F4D7_368272/oe-25-13-15131.pdf?da=1&amp;id=368272&amp;amp;seq=0&amp;amp;mobile=no</a>
   <dt id="biblio-smpte-st-2084">[SMPTE-ST-2084]
   <dd><a href="https://ieeexplore.ieee.org/document/7291452">ST 2084:2014 - SMPTE Standard - High Dynamic Range Electro-Optical Transfer Function of Mastering Reference Displays</a>. 29 August 2014. URL: <a href="https://ieeexplore.ieee.org/document/7291452">https://ieeexplore.ieee.org/document/7291452</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-arib_std-b67">[ARIB_STD-B67]
   <dd><a href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">Essential Parameter Values for the Extended Image Dynamic Range Television (EIDRTV) System for Programme Production</a>. 3 July 2015. URL: <a href="https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf">https://www.arib.or.jp/english/html/overview/doc/2-STD-B67v1_0.pdf</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> This is to avoid confusion if [0, 1024] and [0, 4096]
	encoded values are mixed up.
	Add examples showing conversion from binary values to the [0, 1] range.<a href="#issue-9005a92b"> ↵ </a></div>
   <div class="issue"> should this specification recommend that the CSS Object Model
	store these values in the 16-bit half-floating point representation
	(IEEE standard 754-2008.)
	from BT.2100 pp. 9-10? (or any wider representation, like float or double)?<a href="#issue-9ed1b145"> ↵ </a></div>
   <div class="issue"> should the values accept % as well as number? so 19% as well as 0.19.
	Probably yes.<a href="#issue-692834b0"> ↵ </a></div>
   <div class="issue"> add a diagram showing SDR and HDR dynamic ranges on a log scale<a href="#issue-b905ab0c"> ↵ </a></div>
   <div class="issue"> from BT.2100 p.3 "Note 3d – For PQ in a non-reference viewing environment, or for HLG (in any viewing environment), the black level should be adjusted using the PLUGE test signal and procedure specified in Recommendation ITU-R BT.814."<a href="#issue-2191a240"> ↵ </a></div>
   <div class="issue"> add other examples, including encoding of sRGB red, green, blue and P3 red, green, blue.<a href="#issue-3762b88c"> ↵ </a></div>
   <div class="issue"> add other examples<a href="#issue-63bd5f3d"> ↵ </a></div>
   <div class="issue"> add black level lift Β as defined on same page?<a href="#issue-fb589d17"> ↵ </a></div>
   <div class="issue"> Do the PQ-based colorspaces require tone-mapping (OOTF) for display in different viewing environments?<a href="#issue-42f2d9f1"> ↵ </a></div>
   <div class="issue"> Make some considerations about privacy and security.<a href="#issue-2202014f"> ↵ </a></div>
  </div>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>