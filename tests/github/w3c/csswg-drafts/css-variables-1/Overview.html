<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>CSS Custom Properties for Cascading Variables Module Level 1</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <link href="https://www.w3.org/TR/css-variables-1/" rel="canonical">
  <link href="https://drafts.csswg.org/csslogo.ico" rel="icon">
  <meta content="dark light" name="color-scheme">
  <link href="https://www.w3.org/StyleSheets/TR/2021/dark.css" media="(prefers-color-scheme: dark)" rel="stylesheet" type="text/css">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */
/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
    --dfnpanel-target-bg: #ffc;
    --dfnpanel-target-outline: orange;
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
        --dfnpanel-target-bg: #333;
        --dfnpanel-target-outline: silver;
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel a:focus {
    outline: 5px auto Highlight;
    outline: 5px auto -webkit-focus-ring-color;
}
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: 8px;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
    transition: left 1s ease-out, bottom 1s ease-out;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3px;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }

.highlighted {
    animation: target-fade 3s;
}

@keyframes target-fade {
    from {
        background-color: var(--dfnpanel-target-bg);
        outline: 5px solid var(--dfnpanel-target-outline);
    }
    to {
        color: var(--a-normal-text);
        background-color: transparent;
        outline: transparent;
    }
}
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-mdn-anno */
:root {
	--mdn-bg: #EEE;
	--mdn-shadow: #999;
	--mdn-nosupport-text: #ccc;
	--mdn-pass: green;
	--mdn-fail: red;
}
@media (prefers-color-scheme: dark) {
	:root {
		--mdn-bg: #222;
		--mdn-shadow: #444;
		--mdn-nosupport-text: #666;
		--mdn-pass: #690;
		--mdn-fail: #d22;
	}
}
.mdn-anno {
	background: var(--mdn-bg, #EEE);
	border-radius: .25em;
	box-shadow: 0 0 3px var(--mdn-shadow, #999);
	color: var(--text, black);
	font: 1em sans-serif;
	hyphens: none;
	max-width: min-content;
	overflow: hidden;
	padding: 0.2em;
	position: absolute;
	right: 0.3em;
	top: auto;
	white-space: nowrap;
	word-wrap: normal;
	z-index: 8;
}
.mdn-anno.unpositioned {
	display: none;
}
.mdn-anno.overlapping-main {
	opacity: .2;
	transition: opacity .1s;
}
.mdn-anno[open] {
	opacity: 1;
	z-index: 9;
	min-width: 9em;
}
.mdn-anno:hover {
	opacity: 1;
	outline: var(--text, black) 1px solid;
}
.mdn-anno > summary {
	font-weight: normal;
	text-align: right;
	cursor: pointer;
	display: block;
}
.mdn-anno > summary > .less-than-two-engines-flag {
	color: var(--mdn-fail);
	padding-right: 2px;
}
.mdn-anno > summary > .all-engines-flag {
	color: var(--mdn-pass);
	padding-right: 2px;
}
.mdn-anno > summary > span {
	color: #fff;
	background-color: #000;
	font-weight: normal;
	font-family: zillaslab, Palatino, "Palatino Linotype", serif;
	padding: 2px 3px 0px 3px;
	line-height: 1.3em;
	vertical-align: top;
}
.mdn-anno > .feature {
	margin-top: 20px;
}
.mdn-anno > .feature:not(:first-of-type) {
	border-top: 1px solid #999;
	margin-top: 6px;
	padding-top: 2px;
}
.mdn-anno > .feature > .less-than-two-engines-text {
	color: var(--mdn-fail);
}
.mdn-anno > .feature > .all-engines-text {
	color: var(--mdn-pass);
}
.mdn-anno > .feature > p {
	font-size: .75em;
	margin-top: 6px;
	margin-bottom: 0;
}
.mdn-anno > .feature > p + p {
	margin-top: 3px;
}
.mdn-anno > .feature > .support {
	display: block;
	font-size: 0.6em;
	margin: 0;
	padding: 0;
	margin-top: 2px;
}
.mdn-anno > .feature > .support + div {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > hr {
	display: block;
	border: none;
	border-top: 1px dotted #999;
	padding: 3px 0px 0px 0px;
	margin: 2px 3px 0px 3px;
}
.mdn-anno > .feature > .support > hr::before {
	content: "";
}
.mdn-anno > .feature > .support > span {
	padding: 0.2em 0;
	display: block;
	display: table;
}
.mdn-anno > .feature > .support > span.no {
	color: var(--mdn-nosupport-text);
	filter: grayscale(100%);
}
.mdn-anno > .feature > .support > span.no::before {
	opacity: 0.5;
}
.mdn-anno > .feature > .support > span:first-of-type {
	padding-top: 0.5em;
}
.mdn-anno > .feature > .support > span > span {
	padding: 0 0.5em;
	display: table-cell;
}
.mdn-anno > .feature > .support > span > span:first-child {
	width: 100%;
}
.mdn-anno > .feature > .support > span > span:last-child {
	width: 100%;
	white-space: pre;
	padding: 0;
}
.mdn-anno > .feature > .support > span::before {
	content: ' ';
	display: table-cell;
	min-width: 1.5em;
	height: 1.5em;
	background: no-repeat center center;
	background-size: contain;
	text-align: right;
	font-size: 0.75em;
	font-weight: bold;
}
.mdn-anno > .feature > .support > .chrome_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .firefox_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .chrome::before {
	background-image: url(https://resources.whatwg.org/browser-logos/chrome.svg);
}
.mdn-anno > .feature > .support > .edge_blink::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge.svg);
}
.mdn-anno > .feature > .support > .edge::before {
	background-image: url(https://resources.whatwg.org/browser-logos/edge_legacy.svg);
}
.mdn-anno > .feature > .support > .firefox::before {
	background-image: url(https://resources.whatwg.org/browser-logos/firefox.png);
}
.mdn-anno > .feature > .support > .ie::before {
	background-image: url(https://resources.whatwg.org/browser-logos/ie.png);
}
.mdn-anno > .feature > .support > .safari_ios::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari-ios.svg);
}
.mdn-anno > .feature > .support > .nodejs::before {
	background-image: url(https://nodejs.org/static/images/favicons/favicon.ico);
}
.mdn-anno > .feature > .support > .opera_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .opera::before {
	background-image: url(https://resources.whatwg.org/browser-logos/opera.svg);
}
.mdn-anno > .feature > .support > .safari::before {
	background-image: url(https://resources.whatwg.org/browser-logos/safari.png);
}
.mdn-anno > .feature > .support > .samsunginternet_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/samsung.svg);
}
.mdn-anno > .feature > .support > .webview_android::before {
	background-image: url(https://resources.whatwg.org/browser-logos/android-webview.png);
}
.name-slug-mismatch {
	color: red;
}
.caniuse-status:hover {
	z-index: 9;
}
/* dt, li, .issue, .note, and .example are "position: relative", so to put annotation at right margin, must move to right of containing block */;
.h-entry:not(.status-LS) dt > .mdn-anno, .h-entry:not(.status-LS) li > .mdn-anno, .h-entry:not(.status-LS) .issue > .mdn-anno, .h-entry:not(.status-LS) .note > .mdn-anno, .h-entry:not(.status-LS) .example > .mdn-anno {
	right: -6.7em;
}
.h-entry p + .mdn-anno {
	margin-top: 0;
}
 h2 + .mdn-anno.after {
	margin: -48px 0 0 0;
}
 h3 + .mdn-anno.after {
	margin: -46px 0 0 0;
}
 h4 + .mdn-anno.after {
	margin: -42px 0 0 0;
}
 h5 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
 h6 + .mdn-anno.after {
	margin: -40px 0 0 0;
}
</style>
<style>/* Boilerplate: style-ref-hints */
:root {
    --ref-hint-bg: #ddd;
    --ref-hint-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --ref-hint-bg: #222;
        --ref-hint-text: var(--text);
    }
}

.ref-hint {
    display: inline-block;
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.5em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--ref-hint-bg);
    color: var(--ref-hint-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}

.ref-hint * { margin: 0; padding: 0; text-indent: 0; }

.ref-hint ul { padding: 0 0 0 1em; list-style: none; }
</style>
<style>/* Boilerplate: style-selflinks */
:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-wpt */
:root {
    --wpt-border: hsl(0, 0%, 60%);
    --wpt-bg: hsl(0, 0%, 95%);
    --wpt-text: var(--text);
    --wptheading-text: hsl(0, 0%, 30%);
}
@media (prefers-color-scheme: dark) {
    :root {
        --wpt-border: hsl(0, 0%, 30%);
        --wpt-bg: var(--borderedblock-bg);
        --wpt-text: var(--text);
        --wptheading-text: hsl(0, 0%, 60%);
    }
}
.wpt-tests-block {
    list-style: none;
    border-left: .5em solid var(--wpt-border);
    background: var(--wpt-bg);
    color: var(--wpt-text);
    margin: 1em auto;
    padding: .5em;
}
.wpt-tests-block summary {
    color: var(--wptheading-text);
    font-weight: normal;
    text-transform: uppercase;
}
.wpt-tests-block summary::marker{
    color: var(--wpt-border);
}
.wpt-tests-block summary:hover::marker{
    color: var(--wpt-text);
}
/*
   The only content  of a wpt test block in its closed state is the <summary>,
   which contains the word TESTS,
   and that is absolutely positioned.
   In that closed state, wpt test blocks are styled
   to have a top margin whose height is exactly equal
   to the height of the absolutely positioned <summary>,
   and no other background/padding/margin/border.
   The wpt test block elements will therefore allow the maring
   of the previous/next block elements
   to collapse through them;
   if this combined margin would be larger than its own top margin,
   it stays as is,
   and therefore the pre-existing vertical rhythm of the document is undisturbed.
   If that combined margin would be smaller, it is grown to that size.
   This means that the wpt test block ensures
   that there's always enough vertical space to insert the summary,
   without adding more than is needed.
*/
.wpt-tests-block:not([open]){
    padding: 0;
    border: none;
    background: none;
    font-size: 0.75em;
    line-height: 1;
    position: relative;
    margin: 1em 0 0;
}
.wpt-tests-block:not([open]) summary {
    position: absolute;
    right: 0;
    bottom: 0;
}
/*
   It is possible that both the last child of a block element
   and the block element itself
   would be annotated with a <wpt> block each.
   If the block element has a padding or a border,
   that's fine, but otherwise
   the bottom margin of the block and of its last child would collapse
   and both <wpt> elements would overlap, being both placed there.
   To avoid that, add 1px of padding to the <wpt> element annotating the last child
   to prevent the bottom margin of the block and of its last child from collapsing
   (and as much negative margin,
   as wel only want to prevent margin collapsing,
   but are not trying to actually take more space).
*/
.wpt-tests-block:not([open]):last-child {
    padding-bottom: 1px;
    margin-bottom: -1px;
}
/*
   Exception to the previous rule:
   don't do that in non-last list items,
   because it's not necessary,
   and would therefore consume more space than strictly needed.
   Lists must have list items as children, not <wpt> elements,
   so a <wpt> element cannot be a sibling of a list item,
   and the collision that the previous rule avoids cannot happen.
*/
li:not(:last-child) > .wpt-tests-block:not([open]):last-child,
dd:not(:last-child) > .wpt-tests-block:not([open]):last-child {
    padding-bottom: 0;
    margin-bottom: 0;
}
.wpt-tests-block:not([open]):not(:hover){
    opacity: 0.5;
}
.wpt-tests-list {
    list-style: none;
    display: grid;
    margin: 0;
    padding: 0;
    grid-template-columns: 1fr max-content auto auto;
    grid-column-gap: .5em;
}
.wpt-tests-block hr:last-child {
    display: none;
}
.wpt-test {
    display: contents;
}
.wpt-test > a {
    text-decoration: underline;
    border: none;
}
.wpt-test > .wpt-name { grid-column: 1; }
.wpt-test > .wpt-results { grid-column: 2; }
.wpt-test > .wpt-live { grid-column: 3; }
.wpt-test > .wpt-source { grid-column: 4; }

.wpt-test > .wpt-results {
    display: flex;
    gap: .1em;
}
.wpt-test .wpt-result {
    display: inline-block;
    height: 1em;
    width: 1em;
    border-radius: 50%;
    position: relative;
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">CSS Custom Properties for Cascading Variables Module Level 1</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://drafts.csswg.org/css-variables/">https://drafts.csswg.org/css-variables/</a>
      <dt>Latest published version:
      <dd><a href="https://www.w3.org/TR/css-variables-1/">https://www.w3.org/TR/css-variables-1/</a>
      <dt>Previous Versions:
      <dd><a href="https://www.w3.org/TR/2015/CR-css-variables-1-20151203/" rel="prev">https://www.w3.org/TR/2015/CR-css-variables-1-20151203/</a>
      <dd><a href="https://www.w3.org/TR/2014/WD-css-variables-1-20140506/" rel="prev">https://www.w3.org/TR/2014/WD-css-variables-1-20140506/</a>
      <dd><a href="https://www.w3.org/TR/2013/WD-css-variables-1-20130620/" rel="prev">https://www.w3.org/TR/2013/WD-css-variables-1-20130620/</a>
      <dd><a href="https://www.w3.org/TR/2013/WD-css-variables-20130312/" rel="prev">https://www.w3.org/TR/2013/WD-css-variables-20130312/</a>
      <dd><a href="https://www.w3.org/TR/2012/WD-css-variables-20120410/" rel="prev">https://www.w3.org/TR/2012/WD-css-variables-20120410/</a>
      <dt>Feedback:
      <dd><a href="https://github.com/w3c/csswg-drafts/labels/css-variables-1">CSSWG Issues Repository</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="42199"><a class="p-name fn u-url url" href="http://xanthir.com/contact">Tab Atkins Jr.</a> (<span class="p-org org">Google</span>)
      <dt>Suggest an Edit for this Spec:
      <dd><a href="https://github.com/w3c/csswg-drafts/blob/main/css-variables-1/Overview.bs">GitHub Editor</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/policies/#copyright">Copyright</a> © 1970 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/policies/#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/policies/#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/copyright/software-license/" rel="license" title="W3C Software and Document License">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This module introduces cascading variables as a new primitive value type that is accepted by all CSS properties, and custom properties for defining them.</p>
    <a href="https://www.w3.org/TR/CSS/">CSS</a> is a language for describing the rendering of structured documents
(such as HTML and XML)
on screen, on paper, etc. 
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p>Please send feedback
	by <a href="https://github.com/w3c/csswg-drafts/issues">filing issues in GitHub</a> (preferred),
	including the spec code “css-variables” in the title, like this:
	“[css-variables] <i>…summary of comment…</i>”.
	All issues and comments are <a href="https://lists.w3.org/Archives/Public/public-css-archive/">archived</a>.
	Alternately, feedback can be sent to the (<a href="https://lists.w3.org/Archives/Public/www-style/">archived</a>) public mailing list <a href="mailto:www-style@w3.org?Subject=%5Bcss-variables%5D%20PUT%20SUBJECT%20HERE">www-style@w3.org</a>. </p>
   <p>This document is governed by the <a href="https://www.w3.org/policies/process/20231103/" id="w3c_process_revision">03 November 2023 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content"> Introduction</span></a>
     <ol class="toc">
      <li><a href="#values"><span class="secno">1.1</span> <span class="content"> Value Definitions</span></a>
     </ol>
    <li>
     <a href="#defining-variables"><span class="secno">2</span> <span class="content"> Defining Custom Properties: the <span class="property">--*</span> family of properties</span></a>
     <ol class="toc">
      <li><a href="#syntax"><span class="secno">2.1</span> <span class="content"> Custom Property Value Syntax</span></a>
      <li><a href="#guaranteed-invalid"><span class="secno">2.2</span> <span class="content"> Guaranteed-Invalid Values</span></a>
      <li><a href="#cycles"><span class="secno">2.3</span> <span class="content"> Resolving Dependency Cycles</span></a>
     </ol>
    <li>
     <a href="#using-variables"><span class="secno">3</span> <span class="content"> Using Cascading Variables: the <span class="css">var()</span> notation</span></a>
     <ol class="toc">
      <li><a href="#invalid-variables"><span class="secno">3.1</span> <span class="content"> Invalid Variables</span></a>
      <li><a href="#variables-in-shorthands"><span class="secno">3.2</span> <span class="content"> Variables in Shorthand Properties</span></a>
      <li><a href="#long-variables"><span class="secno">3.3</span> <span class="content"> Safely Handling Overly-Long Variables</span></a>
     </ol>
    <li>
     <a href="#apis"><span class="secno">4</span> <span class="content"> APIs</span></a>
     <ol class="toc">
      <li><a href="#serializing-custom-props"><span class="secno">4.1</span> <span class="content"> Serializing Custom Properties</span></a>
     </ol>
    <li>
     <a href="#changes"><span class="secno">5</span> <span class="content"> Changes</span></a>
     <ol class="toc">
      <li><a href="#changes-20151203"><span class="secno">5.1</span> <span class="content"> Changes Since the 03 December 2015 CR</span></a>
      <li><a href="#changes-20140506"><span class="secno">5.2</span> <span class="content"> Changes since the May 6 2014 Last Call Working Draft</span></a>
     </ol>
    <li><a href="#acks"><span class="secno">6</span> <span class="content"> Acknowledgments</span></a>
    <li><a href="#priv-sec"><span class="secno">7</span> <span class="content">Privacy and Security Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content"> Document conventions</span></a>
      <li><a href="#w3c-conformance-classes"><span class="secno"></span> <span class="content"> Conformance classes</span></a>
      <li>
       <a href="#w3c-partial"><span class="secno"></span> <span class="content"> Partial implementations</span></a>
       <ol class="toc">
        <li><a href="#w3c-conform-future-proofing"><span class="secno"></span> <span class="content"> Implementations of Unstable and Proprietary Features</span></a>
       </ol>
      <li><a href="#w3c-testing"><span class="secno"></span> <span class="content"> Non-experimental implementations</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#property-index"><span class="secno"></span> <span class="content">Property Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content"> Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>Large documents or applications
	(and even small ones)
	can contain quite a bit of CSS.
	Many of the values in the CSS file will be duplicate data;
	for example,
	a site may establish a color scheme
	and reuse three or four colors throughout the site.
	Altering this data can be difficult and error-prone,
	since it’s scattered throughout the CSS file
	(and possibly across multiple files),
	and may not be amenable to Find-and-Replace.</p>
   <p>This module introduces a family of custom author-defined properties known collectively as <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property">custom properties</a>,
	which allow an author to assign arbitrary values to a property with an author-chosen name,
	and the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var">var()</a> function,
	which allow an author to then use those values in other properties elsewhere in the document.
	This makes it easier to read large files,
	as seemingly-arbitrary values now have informative names,
	and makes editing such files much easier and less error-prone,
	as one only has to change the value once,
	in the <span id="ref-for-custom-property①">custom property</span>,
	and the change will propagate to all uses of that variable automatically.</p>
   <h3 class="heading settled" data-level="1.1" id="values"><span class="secno">1.1. </span><span class="content"> Value Definitions</span><a class="self-link" href="#values"></a></h3>
   <p>This specification follows the <a href="https://www.w3.org/TR/CSS2/about.html#property-defs">CSS property definition conventions</a> from <a data-link-type="biblio" href="#biblio-css2" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> using the <a href="https://www.w3.org/TR/css-values-3/#value-defs">value definition syntax</a> from <a data-link-type="biblio" href="#biblio-css-values-3" title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</a>.
	Value types not defined in this specification are defined in CSS Values &amp; Units <span title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>.
	Combination with other CSS modules may expand the definitions of these value types.</p>
   <p>In addition to the property-specific values listed in their definitions,
	all properties defined in this specification
	also accept the <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-wide-keywords" id="ref-for-css-wide-keywords">CSS-wide keywords</a> as their property value.
	For readability they have not been repeated explicitly.</p>
   <h2 class="heading settled" data-level="2" id="defining-variables"><span class="secno">2. </span><span class="content"> Defining Custom Properties: the <a class="property css" data-link-type="property">--*</a> family of properties</span><a class="self-link" href="#defining-variables"></a></h2>
   <p>This specification defines an open-ended set of properties called <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②">custom properties</a>,
	which, among other things, are used to define the <a data-link-type="dfn" href="#substitute-a-var" id="ref-for-substitute-a-var">substitution value</a> of <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①">var()</a> functions.</p>
   <table class="def propdef" data-link-for-hint="--*">
    <tbody>
     <tr>
      <th>Name:
      <td><dfn class="dfn-paneled css" data-dfn-type="property" data-export id="propdef-">--*</dfn>
     <tr class="value">
      <th><a href="https://www.w3.org/TR/css-values/#value-defs">Value:</a>
      <td class="prod"><a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value" id="ref-for-typedef-declaration-value">&lt;declaration-value></a><a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#mult-opt" id="ref-for-mult-opt">?</a> 
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#initial-values">Initial:</a>
      <td>the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value">guaranteed-invalid value</a> 
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#applies-to">Applies to:</a>
      <td><a href="https://www.w3.org/TR/css-pseudo/#generated-content" title="Includes ::before and ::after pseudo-elements.">all elements</a> 
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#inherited-property">Inherited:</a>
      <td>yes 
     <tr>
      <th><a href="https://www.w3.org/TR/css-values/#percentages">Percentages:</a>
      <td>n/a 
     <tr>
      <th><a href="https://www.w3.org/TR/css-cascade/#computed">Computed value:</a>
      <td>specified value with variables substituted, or the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value①">guaranteed-invalid value</a> 
     <tr>
      <th><a href="https://www.w3.org/TR/cssom/#serializing-css-values">Canonical order:</a>
      <td>per grammar 
     <tr>
      <th><a href="https://www.w3.org/TR/web-animations/#animation-type">Animation type:</a>
      <td>discrete 
   </table>
   <p class="all-media">User agents are expected to support this property on all media, including non-visual ones.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="custom-property">custom property</dfn> is any property
	whose name starts with two dashes (U+002D HYPHEN-MINUS),
	like <a class="property css" data-link-type="property">--foo</a>.
	The <dfn class="dfn-paneled css" data-dfn-type="type" data-export id="typedef-custom-property-name">&lt;custom-property-name></dfn> production corresponds to this:
	it’s defined as any <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-values-4/#typedef-dashed-ident" id="ref-for-typedef-dashed-ident">&lt;dashed-ident></a> (a valid <span>identifier</span> that starts with two dashes),
	except <span class="css">--</span> itself,
	which is reserved for future use by CSS. <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property③">Custom properties</a> are solely for use by authors and users;
	CSS will never give them a meaning beyond what is presented here.</p>
   <div class="example" id="example-81b6bcdd">
    <a class="self-link" href="#example-81b6bcdd"></a> Custom properties define variables,
		referenced with the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var②">var()</a> notation,
		which can be used for many purposes.
		For example, a page that consistently uses a small set of colors in its design
		can store the colors in custom properties
		and use them with variables: 
<pre class="highlight">:root <c- p>{</c->
  <c- k>--main-color</c-><c- p>:</c-> #06c<c- p>;</c->
  <c- k>--accent-color</c-><c- p>:</c-> #006<c- p>;</c->
<c- p>}</c->
<c- c>/* The rest of the CSS file */</c->
#foo h1 <c- p>{</c->
  <c- k>color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--main-color<c- p>);</c->
<c- p>}</c->
</pre>
    <p>The naming provides a mnemonic for the colors,
		prevents difficult-to-spot typos in the color codes,
		and if the theme colors are ever changed,
		focuses the change on one simple spot
		(the custom property value)
		rather than requiring many edits across all stylesheets in the webpage.</p>
   </div>
   <p>Unlike other CSS properties,
	custom property names are <a data-link-type="dfn" href="https://w3c.github.io/i18n-glossary/#dfn-case-sensitive" id="ref-for-dfn-case-sensitive">case-sensitive</a>.</p>
   <div class="example" id="example-ddbbde9e"><a class="self-link" href="#example-ddbbde9e"></a> While both <a class="property css" data-link-type="property">--foo</a> and --FOO are valid,
		they are distinct properties -
		using <span class="css">var(--foo)</span> will refer to the first one,
		while using <span class="css">var(--FOO)</span> will refer to the second. </div>
   <p>Custom properties are <strong>not</strong> reset by the <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-cascade-5/#propdef-all" id="ref-for-propdef-all">all</a> property. <span class="note">We may define a property in the future that resets all variables.</span></p>
   <p>The <a data-link-type="dfn" href="https://drafts.csswg.org/css-values-4/#css-wide-keywords" id="ref-for-css-wide-keywords①">CSS-wide keywords</a> can be used in custom properties,
	with the same meaning as in any another property.</p>
   <p class="note" role="note"><span class="marker">Note:</span> That is, they’re interpreted at cascaded-value time as normal,
	and are not preserved as the custom property’s value,
	and thus are not substituted in by the corresponding variable.</p>
   <p class="note" role="note"><span class="marker">Note:</span> While this module focuses on the use of <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property④">custom properties</a> with the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③">var()</a> function to create “variables”,
	they can also be used as actual custom properties,
	parsed by and acted on by script.
	It’s expected that the CSS Extensions spec <a data-link-type="biblio" href="#biblio-css-extensions" title="CSS Extensions">[CSS-EXTENSIONS]</a> will expand on these use-cases and make them easier to do.</p>
   <p>Custom properties are ordinary properties,
	so they can be declared on any element,
	are resolved with the normal inheritance and cascade rules,
	can be made conditional with <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-conditional-3/#at-ruledef-media" id="ref-for-at-ruledef-media">@media</a> and other conditional rules,
	can be used in HTML’s <code class="highlight">style</code> attribute,
	can be read or set using the CSSOM, etc.</p>
   <p>Notably, they can even be transitioned or animated,
	but since the UA has no way to interpret their contents,
	they always use the "flips at 50%" behavior
	that is used for any other pair of values that can’t be intelligently interpolated.
	However, any <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property⑤">custom property</a> used in a <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes" id="ref-for-at-ruledef-keyframes">@keyframes</a> rule
	becomes <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="animation-tainted">animation-tainted</dfn>,
	which affects how it is treated when referred to via the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④">var()</a> function in an animation property.</p>
   <div class="example" id="example-d6247b0f">
    <a class="self-link" href="#example-d6247b0f"></a> This style rule: 
<pre class="highlight">:root <c- p>{</c->
  <c- k>--header-color</c-><c- p>:</c-> #06c<c- p>;</c->
<c- p>}</c->
</pre>
    <p>declares a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property⑥">custom property</a> named <a class="property css" data-link-type="property">--header-color</a> on the root element,
		and assigns to it the value "#06c".
		This property is then inherited to the elements in the rest of the document.
		Its value can be referenced with the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var⑤">var()</a> function:</p>
<pre class="highlight">h1 <c- p>{</c-> <c- k>background-color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--header-color<c- p>);</c-> <c- p>}</c->
</pre>
    <p>The preceding rule is equivalent to writing <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color" id="ref-for-propdef-background-color">background-color: #06c;</a>,
		except that the variable name makes the origin of the color clearer,
		and if <span class="css">var(--header-color)</span> is used on other elements in the document,
		all of the uses can be updated at once
		by changing the <a class="property css" data-link-type="property">--header-color</a> property on the root element.</p>
   </div>
   <div class="example" id="example-c3e4e8d9">
    <a class="self-link" href="#example-c3e4e8d9"></a> If a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property⑦">custom property</a> is declared multiple times,
		the standard cascade rules help resolve it.
		Variables always draw from the computed value of the associated custom property on the same element: 
<pre class="highlight">:root <c- p>{</c-> <c- k>--color</c-><c- p>:</c-> blue<c- p>;</c-> <c- p>}</c->
div <c- p>{</c-> <c- k>--color</c-><c- p>:</c-> green<c- p>;</c-> <c- p>}</c->
#alert <c- p>{</c-> <c- k>--color</c-><c- p>:</c-> red<c- p>;</c-> <c- p>}</c->
* <c- p>{</c-> <c- k>color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--color<c- p>);</c-> <c- p>}</c->

&lt;p><span style="color: blue">I inherited blue from the root element!</span>&lt;/p>
&lt;div><span style="color: green">I got green set directly on me!</span>&lt;/div>
&lt;div id=<c- s>'alert'</c->>
  <span style="color: red">While I got red set directly on me!</span>
  &lt;p><span style="color: red">I’m red too<c- p>,</c-> because of inheritance!</span>&lt;/p>
&lt;/div>
</pre>
   </div>
   <div class="example" id="example-658ebee9">
    <a class="self-link" href="#example-658ebee9"></a> A real-world example of <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property⑧">custom property</a> usage
		is easily separating out strings from where they’re used,
		to aid in maintenance of internationalization: 
<pre class="lang-css highlight">:root<c- p>,</c->
:root<c- nf>:lang</c-><c- p>(</c->en<c- p>)</c-> <c- p>{</c-><c- k>--external-link</c-><c- p>:</c-> <c- s>"external link"</c-><c- p>;}</c->
:root<c- nf>:lang</c-><c- p>(</c->de<c- p>)</c-> <c- p>{</c-><c- k>--external-link</c-><c- p>:</c-> <c- s>"externer Link"</c-><c- p>;}</c->

a<c- p>[</c->href^=<c- s>"http"</c-><c- p>]</c->::after <c- p>{</c-><c- k>content</c-><c- p>:</c-> <c- s>" ("</c-> <c- nf>var</c-><c- p>(</c->--external-link<c- p>)</c-> <c- s>")"</c-><c- p>}</c->
</pre>
    <p>The variable declarations can even be kept in a separate file,
		to make maintaining the translations simpler.</p>
   </div>
   <h3 class="heading settled" data-level="2.1" id="syntax"><span class="secno">2.1. </span><span class="content"> Custom Property Value Syntax</span><a class="self-link" href="#syntax"></a></h3>
   <p>The allowed syntax for <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property⑨">custom properties</a> is extremely permissive.
	The <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value" id="ref-for-typedef-declaration-value①">&lt;declaration-value></a> production matches <em>any</em> sequence of one or more tokens,
	so long as the sequence does not contain <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-bad-string-token" id="ref-for-typedef-bad-string-token">&lt;bad-string-token></a>, <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-bad-url-token" id="ref-for-typedef-bad-url-token">&lt;bad-url-token></a>,
	unmatched <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#tokendef-close-paren" id="ref-for-tokendef-close-paren">&lt;)-token></a>, <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#tokendef-close-square" id="ref-for-tokendef-close-square">&lt;]-token></a>, or <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#tokendef-close-curly" id="ref-for-tokendef-close-curly">&lt;}-token></a>,
	or top-level <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-semicolon-token" id="ref-for-typedef-semicolon-token">&lt;semicolon-token></a> tokens or <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-delim-token" id="ref-for-typedef-delim-token">&lt;delim-token></a> tokens with a value of "!".</p>
   <p>In addition, if the value of a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①⓪">custom property</a> contains a <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var⑥">var()</a> reference,
	the <span class="css" id="ref-for-funcdef-var⑦">var()</span> reference must be valid according to the specified <span class="css" id="ref-for-funcdef-var⑧">var()</span> grammar.
	If not, the <span id="ref-for-custom-property①①">custom property</span> is invalid and must be ignored.</p>
   <p class="note" role="note"><span class="marker">Note:</span> This definition,
	along with the general CSS syntax rules,
	implies that a custom property value never includes an unmatched quote or bracket,
	and so cannot have any effect on larger syntax constructs,
	like the enclosing style rule,
	when reserialized.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Custom properties can contain a trailing <span class="css">!important</span>,
	but this is automatically removed from the property’s value by the CSS parser,
	and makes the custom property "important" in the CSS cascade.
	In other words, the prohibition on top-level "!" characters
	does not prevent <span class="css">!important</span> from being used,
	as the <span class="css">!important</span> is removed before syntax checking happens.</p>
   <div class="example" id="example-fb41560d">
    <a class="self-link" href="#example-fb41560d"></a> For example, the following is a valid custom property: 
<pre class="highlight"><c- k>--foo</c-><c- p>:</c-> <c- nf>if</c-><c- p>(</c->x > <c- m>5</c-><c- p>)</c-> this.width = <c- m>10</c-><c- p>;</c->
</pre>
    <p>While this value is obviously useless as a <em>variable</em>,
		as it would be invalid in any normal property,
		it might be read and acted on by JavaScript.</p>
   </div>
   <p>The values of custom properties,
	and the values of <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var⑨">var()</a> functions substituted into custom properties,
	are <em>case-sensitive</em>,
	and must be preserved in their original author-given casing.
	(Many CSS values are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive">ASCII case-insensitive</a>,
	which user agents can take advantage of by "canonicalizing" them into a single casing,
	but that isn’t allowed for custom properties.)</p>
   <h3 class="heading settled" data-level="2.2" id="guaranteed-invalid"><span class="secno">2.2. </span><span class="content"> Guaranteed-Invalid Values</span><a class="self-link" href="#guaranteed-invalid"></a></h3>
   <p>The initial value of a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①②">custom property</a> is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="guaranteed-invalid-value">guaranteed-invalid value</dfn>.
	As defined in <a href="#using-variables">§ 3 Using Cascading Variables: the var() notation</a>,
	using <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①⓪">var()</a> to substitute a <span id="ref-for-custom-property①③">custom property</span> with this as its value
	makes the property referencing it <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time">invalid at computed-value time</a>.</p>
   <p>This value serializes as the empty string,
	but actually writing an empty value into a custom property,
	like <span style=";white-space:nowrap"><a class="css" data-link-type="propdesc">--foo: ;</a></span>,
	is a valid (empty) value,
	not the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value②">guaranteed-invalid value</a>.
	If, for whatever reason,
	one wants to manually reset a variable to the <span id="ref-for-guaranteed-invalid-value③">guaranteed-invalid value</span>,
	using the keyword <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-initial" id="ref-for-valdef-all-initial">initial</a> will do this.</p>
   <h3 class="heading settled" data-level="2.3" id="cycles"><span class="secno">2.3. </span><span class="content"> Resolving Dependency Cycles</span><a class="self-link" href="#cycles"></a></h3>
   <p><a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①④">Custom properties</a> are left almost entirely unevaluated,
	except that they allow and evaluate the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①①">var()</a> function in their value.
	This can create cyclic dependencies
	where a custom property uses a <span class="css" id="ref-for-funcdef-var①②">var()</span> referring to itself,
	or two or more <span id="ref-for-custom-property①⑤">custom properties</span> each attempt to refer to each other.</p>
   <p>For each element,
	create a directed dependency graph,
	containing nodes for each <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①⑥">custom property</a>.
	If the value of a <span id="ref-for-custom-property①⑦">custom property</span> <var>prop</var> contains a <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①③">var()</a> function referring to the property <var>var</var> (including in the fallback argument of <span class="css" id="ref-for-funcdef-var①④">var()</span>),
	add an edge between <var>prop</var> and the <var>var</var>. <span class="note">Edges are possible from a custom property to itself.</span></p>
   <p>If there is a cycle in the dependency graph,
	all the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①⑧">custom properties</a> in the cycle
	are <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time①">invalid at computed-value time</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Defined properties that participate in a dependency cycle
	either end up with invalid variables in their value
	(becoming <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time②">invalid at computed-value time</a>),
	or define their own cyclic handling
	(like <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-fonts-4/#propdef-font-size" id="ref-for-propdef-font-size">font-size</a> using <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-values-4/#em" id="ref-for-em">em</a> values).
	They do not computed to the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value④">guaranteed-invalid value</a> like custom properties do.</p>
   <div class="example" id="example-75bf73fb">
    <a class="self-link" href="#example-75bf73fb"></a> This example shows a custom property safely using a variable: 
<pre class="highlight">:root <c- p>{</c->
  <c- k>--main-color</c-><c- p>:</c-> #c06<c- p>;</c->
  <c- k>--accent-background</c-><c- p>:</c-> <c- nf>linear-gradient</c-><c- p>(</c->to top<c- p>,</c-> <c- nf>var</c-><c- p>(</c->--main-color<c- p>),</c-> white<c- p>);</c->
<c- p>}</c->
</pre>
    <p>The <a class="property css" data-link-type="property">--accent-background</a> property
		(along with any other properties that use <span class="css">var(--main-color)</span>)
		will automatically update when the <span class="property">--main-color</span> property is changed.</p>
   </div>
   <div class="example invalid-example" id="example-b8947a2b">
    <a class="self-link" href="#example-b8947a2b"></a> On the other hand,
		this example shows an invalid instance of variables depending on each other: 
<pre class="highlight">:root <c- p>{</c->
  <c- k>--one</c-><c- p>:</c-> <c- nf>calc</c-><c- p>(</c-><c- nf>var</c-><c- p>(</c->--two<c- p>)</c-> + <c- m>20</c-><c- k>px</c-><c- p>);</c->
  <c- k>--two</c-><c- p>:</c-> <c- nf>calc</c-><c- p>(</c-><c- nf>var</c-><c- p>(</c->--one<c- p>)</c-> - <c- m>20</c-><c- k>px</c-><c- p>);</c->
<c- p>}</c->
</pre>
    <p>Both <a class="property css" data-link-type="property">--one</a> and <span class="property">--two</span> are now <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time③">invalid at computed-value time</a>,
		and compute to the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value⑤">guaranteed-invalid value</a> rather than lengths.</p>
   </div>
   <p>It is important to note that <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property①⑨">custom properties</a> resolve any <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①⑤">var()</a> functions in their values at computed-value time,
	which occurs <em>before</em> the value is inherited.
	In general,
	cyclic dependencies occur only when multiple custom properties on the same element refer to each other;
	custom properties defined on elements higher in the element tree can never cause a cyclic reference with properties defined on elements lower in the element tree.</p>
   <div class="example" id="example-beef67cd">
    <a class="self-link" href="#example-beef67cd"></a> For example,
		given the following structure,
		these custom properties are <strong>not</strong> cyclic,
		and all define valid variables: 
<pre class="highlight"><c- p>&lt;</c-><c- f>one</c-><c- p>>&lt;</c-><c- f>two</c-><c- p>>&lt;</c-><c- f>three</c-> <c- p>/>&lt;/</c-><c- f>two</c-><c- p>>&lt;/</c-><c- f>one</c-><c- p>></c->
<c- p>&lt;</c-><c- f>style</c-><c- p>></c->
<c- f>one</c->   <c- p>{</c-> <c- g>--foo</c-><c- p>:</c-> <c- mi>10</c-><c- b>px</c-><c- p>;</c-> <c- p>}</c->
<c- f>two</c->   <c- p>{</c-> <c- g>--bar</c-><c- p>:</c-> calc<c- p>(</c-><c- nf>var</c-><c- p>(</c-><c- g>--foo</c-><c- p>)</c-> <c- o>+</c-> <c- mi>10</c-><c- b>px</c-><c- p>);</c-> <c- p>}</c->
<c- f>three</c-> <c- p>{</c-> <c- g>--foo</c-><c- p>:</c-> calc<c- p>(</c-><c- nf>var</c-><c- p>(</c-><c- g>--bar</c-><c- p>)</c-> <c- o>+</c-> <c- mi>10</c-><c- b>px</c-><c- p>);</c-> <c- p>}</c->
<c- p>&lt;/</c-><c- f>style</c-><c- p>></c->
</pre>
    <p>The &lt;one> element defines a value for <a class="property css" data-link-type="property">--foo</a>.
		The &lt;two> element inherits this value,
		and additionally assigns a value to <span class="property">--bar</span> using the <span class="css">foo</span> variable.
		Finally,
		the &lt;three> element inherits the <span class="property">--bar</span> value <em>after</em> variable substitution
		(in other words, it sees the value <span class="css">calc(10px + 10px)</span>),
		and then redefines <span class="property">--foo</span> in terms of that value.
		Since the value it inherited for <span class="property">--bar</span> no longer contains a reference to the <span class="property">--foo</span> property defined on &lt;one>,
		defining <span class="property">--foo</span> using the <span class="css">var(--bar)</span> variable is not cyclic,
		and actually defines a value that will eventually
		(when referenced as a variable in a normal property)
		resolve to <span class="css">30px</span>.</p>
   </div>
   <h2 class="heading settled" data-level="3" id="using-variables"><span class="secno">3. </span><span class="content"> Using Cascading Variables: the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①⑥">var()</a> notation</span><a class="self-link" href="#using-variables"></a></h2>
   <p>The value of a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②⓪">custom property</a> can be substituted into the value of another property
	with the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①⑦">var()</a> function.
	The syntax of <span class="css" id="ref-for-funcdef-var①⑧">var()</span> is:</p>
<pre class="prod highlight"><dfn class="dfn-paneled" data-dfn-type="function" data-export id="funcdef-var"><c- nf>var</c-><c- p>()</c-></dfn> = <c- nf>var</c-><c- p>(</c-> <a class="production" data-link-type="type" href="#typedef-custom-property-name" id="ref-for-typedef-custom-property-name">&lt;custom-property-name></a> <a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#comb-comma" id="ref-for-comb-comma"><c- p>,</c-></a> <a class="production" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value" id="ref-for-typedef-declaration-value②">&lt;declaration-value></a><a data-link-type="grammar" href="https://drafts.csswg.org/css-values-4/#mult-opt" id="ref-for-mult-opt①">?</a> <c- p>)</c->
</pre>
   <p>The <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var①⑨">var()</a> function can be used in place of any part of a value in any property on an element.
	The <span class="css" id="ref-for-funcdef-var②⓪">var()</span> function can not be used as
	property names,
	selectors,
	or anything else besides property values.
	(Doing so usually produces invalid syntax,
	or else a value whose meaning has no connection to the variable.)</p>
   <div class="example" id="example-43a8c543">
    <a class="self-link" href="#example-43a8c543"></a> For example, the following code incorrectly attempts to use a variable as a property name: 
<pre class="highlight">.foo <c- p>{</c->
  <c- k>--side</c-><c- p>:</c-> margin-top<c- p>;</c->
  <c- nf>var</c-><c- p>(</c->--side<c- p>)</c->: <c- m>20</c-><c- k>px</c-><c- p>;</c->
<c- p>}</c->
</pre>
    <p>This is <em>not</em> equivalent to setting <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-box-4/#propdef-margin-top" id="ref-for-propdef-margin-top">margin-top: 20px;</a>.
		Instead, the second declaration is simply thrown away as a syntax error
		for having an invalid property name.</p>
   </div>
   <p>The first argument to the function is the name of the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②①">custom property</a> to be substituted.
	The second argument to the function, if provided,
	is a fallback value,
	which is used as the substitution value when the value of the referenced <span id="ref-for-custom-property②②">custom property</span> is the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value⑥">guaranteed-invalid value</a>.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The syntax of the fallback, like that of <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②③">custom properties</a>, allows commas.
	For example, <span class="css">var(--foo, red, blue)</span> defines a fallback of <span class="css">red, blue</span>;
	that is, anything between the first comma and the end of the function is considered a fallback value.</p>
   <div class="example" id="example-abd63bac">
    <a class="self-link" href="#example-abd63bac"></a> The fallback value allows for some types of defensive coding.
		For example,
		an author may create a component
		intended to be included in a larger application,
		and use variables to style it
		so that it’s easy for the author of the larger application
		to theme the component to match the rest of the app. 
    <p>Without fallback,
		the app author must supply a value for every variable that your component uses.
		With fallback, the component author can supply defaults,
		so the app author only needs to supply values for the variables they wish to override.</p>
<pre class="highlight"><c- c>/* In the component’s style: */</c->
.component .header <c- p>{</c->
  <c- k>color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--header-color<c- p>,</c-> blue<c- p>);</c->
<c- p>}</c->
.component .text <c- p>{</c->
  <c- k>color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--text-color<c- p>,</c-> black<c- p>);</c->
<c- p>}</c->

<c- c>/* In the larger application’s style: */</c->
.component <c- p>{</c->
  <c- k>--text-color</c-><c- p>:</c-> #080<c- p>;</c->
  <c- c>/* header-color isn’t set,</c->
<c- c>     and so remains blue,</c->
<c- c>     the fallback value */</c->
<c- p>}</c->
</pre>
   </div>
   <p>If a property contains one or more <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var②①">var()</a> functions,
	and those functions are syntactically valid,
	the entire property’s grammar must be assumed to be valid at parse time.
	It is only syntax-checked at computed-value time,
	after <span class="css" id="ref-for-funcdef-var②②">var()</span> functions have been <a data-link-type="dfn" href="#substitute-a-var" id="ref-for-substitute-a-var①">substituted</a>.</p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="substitute a var()|var() substitution" id="substitute-a-var">substitute a var()</dfn> in a property’s value:</p>
   <ol>
    <li>
      If the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②④">custom property</a> named by the first argument to the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var②③">var()</a> function is <a data-link-type="dfn" href="#animation-tainted" id="ref-for-animation-tainted">animation-tainted</a>,
			and the <span class="css" id="ref-for-funcdef-var②④">var()</span> function is being used in: 
     <ul>
      <li data-md>
       <p>the <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-animations-1/#propdef-animation" id="ref-for-propdef-animation">animation</a> property or one of its longhands,</p>
      <li data-md>
       <p>the <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-display-4/#propdef-display" id="ref-for-propdef-display">display</a> property, such that after substitution the property would have a value that suppresses the element’s box (such as <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-4/#valdef-display-none" id="ref-for-valdef-display-none">none</a> or <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-display-4/#valdef-display-contents" id="ref-for-valdef-display-contents">contents</a>)</p>
     </ul>
     <p>treat the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②⑤">custom property</a> as having its initial value for the rest of this algorithm.</p>
    <li> If the value of the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②⑥">custom property</a> named by the first argument to the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var②⑤">var()</a> function
			is anything but the initial value,
			replace the <span class="css" id="ref-for-funcdef-var②⑥">var()</span> function by the value of the corresponding <span id="ref-for-custom-property②⑦">custom property</span>. 
    <li> Otherwise, if the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var②⑦">var()</a> function has a fallback value as its second argument,
			replace the <span class="css" id="ref-for-funcdef-var②⑧">var()</span> function by the fallback value.
			If there are any <span class="css" id="ref-for-funcdef-var②⑨">var()</span> references in the fallback, <a data-link-type="dfn" href="#substitute-a-var" id="ref-for-substitute-a-var②">substitute</a> them as well. 
    <li>
      Otherwise,
			the property containing the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③⓪">var()</a> function is <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time④">invalid at computed-value time</a>. 
     <p class="note" role="note"><span class="marker">Note:</span> Other things can also make a property <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time⑤">invalid at computed-value time</a>.</p>
   </ol>
   <div class="note" role="note">
     Note that <a data-link-type="dfn" href="#substitute-a-var" id="ref-for-substitute-a-var③">var() substitution</a> takes place at the level of CSS tokens <a data-link-type="biblio" href="#biblio-css-syntax-3" title="CSS Syntax Module Level 3">[css-syntax-3]</a>,
		not at a textual level;
		you can’t build up a single token where part of it is provided by a variable: 
<pre class="highlight">.foo <c- p>{</c->
  <c- k>--gap</c-><c- p>:</c-> <c- m>20</c-><c- p>;</c->
  <c- k>margin-top</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--gap<c- p>)</c->px<c- p>;</c->
<c- p>}</c->
</pre>
    <p>This is <em>not</em> equivalent to setting <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-box-4/#propdef-margin-top" id="ref-for-propdef-margin-top①">margin-top: 20px;</a> (a length).
		Instead, it’s equivalent to <span class="css" id="ref-for-propdef-margin-top②">margin-top: 20 px;</span> (a number followed by an ident),
		which is simply an invalid value for the <span class="property" id="ref-for-propdef-margin-top③">margin-top</span> property.
		Note, though, that <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-values-4/#funcdef-calc" id="ref-for-funcdef-calc">calc()</a> can be used to validly achieve the same thing, like so:</p>
<pre class="highlight">.foo <c- p>{</c->
  <c- k>--gap</c-><c- p>:</c-> <c- m>20</c-><c- p>;</c->
  <c- k>margin-top</c-><c- p>:</c-> <c- nf>calc</c-><c- p>(</c-><c- nf>var</c-><c- p>(</c->--gap<c- p>)</c-> * <c- m>1</c-><c- k>px</c-><c- p>);</c->
<c- p>}</c->
</pre>
   </div>
   <p><a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③①">var()</a> functions are <a data-link-type="dfn" href="#substitute-a-var" id="ref-for-substitute-a-var④">substituted</a> at computed-value time.
	If a declaration,
	once all <span class="css" id="ref-for-funcdef-var③②">var()</span> functions are substituted in,
	does not match its declared grammar,
	the declaration is <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time⑥">invalid at computed-value time</a>.</p>
   <div class="example" id="example-6ec8308f">
    <a class="self-link" href="#example-6ec8308f"></a> For example,
		the following usage is fine from a syntax standpoint,
		but results in nonsense when the variable is substituted in: 
<pre class="highlight">:root <c- p>{</c-> <c- k>--looks-valid</c-><c- p>:</c-> <c- m>20</c-><c- k>px</c-><c- p>;</c-> <c- p>}</c->
p <c- p>{</c-> <c- k>background-color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--looks-valid<c- p>);</c-> <c- p>}</c->
</pre>
    <p>Since <span class="css">20px</span> is an invalid value for <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color" id="ref-for-propdef-background-color①">background-color</a>,
		this instance of the property computes to <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-color-4/#valdef-color-transparent" id="ref-for-valdef-color-transparent">transparent</a> (the initial value for <span class="property" id="ref-for-propdef-background-color②">background-color</span>)
		instead.</p>
    <p>If the property was one that’s inherited by default,
		such as <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-color-4/#propdef-color" id="ref-for-propdef-color">color</a>,
		it would compute to the inherited value
		rather than the initial value.</p>
   </div>
   <h3 class="heading settled" data-level="3.1" id="invalid-variables"><span class="secno">3.1. </span><span class="content"> Invalid Variables</span><a class="self-link" href="#invalid-variables"></a></h3>
   <p>When a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②⑧">custom property’s</a> value is the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value⑦">guaranteed-invalid value</a>, <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③③">var()</a> functions cannot use it for substitution.
	Attempting to do so
	makes the declaration <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time⑦">invalid at computed-value time</a>,
	unless a valid fallback is specified.</p>
   <p>A declaration can be <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="invalid-at-computed-value-time">invalid at computed-value time</dfn> if it contains a <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③④">var()</a> that references a <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property②⑨">custom property</a> with the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value⑧">guaranteed-invalid value</a>,
	as explained above,
	or if it uses a valid <span id="ref-for-custom-property③⓪">custom property</span>,
	but the property value,
	after substituting its <span class="css" id="ref-for-funcdef-var③⑤">var()</span> functions,
	is invalid.
	When this happens,
	the computed value is one of the following
	depending on the property’s type:</p>
   <dl class="switch">
    <dt data-md>The property is a non-registered <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property③①">custom property</a>
    <dt data-md>The property is a <a data-link-type="dfn" href="https://drafts.css-houdini.org/css-properties-values-api-1/#registered-custom-property" id="ref-for-registered-custom-property">registered custom property</a> with <a data-link-type="dfn">universal syntax</a>
    <dd data-md>
     <p>The computed value is the <a data-link-type="dfn" href="#guaranteed-invalid-value" id="ref-for-guaranteed-invalid-value⑨">guaranteed-invalid value</a>.</p>
    <dt data-md>Otherwise
    <dd data-md>
     <p>Either the property’s inherited value
or its initial value
depending on whether the property is inherited or not, respectively,
as if the property’s value had been specified as the <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css-cascade-5/#valdef-all-unset" id="ref-for-valdef-all-unset">unset</a> keyword.</p>
   </dl>
   <div class="example" id="example-53e4f9d5">
    <a class="self-link" href="#example-53e4f9d5"></a> For example, in the following code: 
<pre class="highlight">:root <c- p>{</c-> <c- k>--not-a-color</c-><c- p>:</c-> <c- m>20</c-><c- k>px</c-><c- p>;</c-> <c- p>}</c->
p <c- p>{</c-> <c- k>background-color</c-><c- p>:</c-> red<c- p>;</c-> <c- p>}</c->
p <c- p>{</c-> <c- k>background-color</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--not-a-color<c- p>);</c-> <c- p>}</c->
</pre>
    <p>the &lt;p> elements will have transparent backgrounds
		(the initial value for <a class="property css" data-link-type="property" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color" id="ref-for-propdef-background-color③">background-color</a>),
		rather than red backgrounds.
		The same would happen if the <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property③②">custom property</a> itself was unset,
		or contained an invalid <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③⑥">var()</a> function.</p>
    <p>Note the difference between this
		and what happens if the author had just written <a class="css" data-link-type="propdesc" href="https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color" id="ref-for-propdef-background-color④">background-color: 20px</a> directly in their stylesheet -
		that would be a normal syntax error,
		which would cause the rule to be discarded,
		so the <span class="css" id="ref-for-propdef-background-color⑤">background-color: red</span> rule would be used instead.</p>
   </div>
   <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time⑧">invalid at computed-value time</a> concept exists
	because variables can’t "fail early" like other syntax errors can,
	so by the time the user agent realizes a property value is invalid,
	it’s already thrown away the other cascaded values.</p>
   <h3 class="heading settled" data-level="3.2" id="variables-in-shorthands"><span class="secno">3.2. </span><span class="content"> Variables in Shorthand Properties</span><a class="self-link" href="#variables-in-shorthands"></a></h3>
   <p>The use of <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③⑦">var()</a> functions in <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#shorthand-property" id="ref-for-shorthand-property">shorthand properties</a> presents some unique difficulties.</p>
   <p>For non-custom properties,
	the value of a shorthand property is separated out into its component <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-5/#longhand" id="ref-for-longhand">longhand properties</a> at parse time,
	and then the longhands themselves participate in the <a data-link-type="dfn" href="https://drafts.csswg.org/css-cascade-6/#cascade" id="ref-for-cascade">cascade</a>,
	with the shorthand more-or-less discarded.
	If a <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var③⑧">var()</a> functions is used in a shorthand, however,
	one can’t tell what values are meant to go where;
	it may in fact be impossible to separate it out at parse time,
	as a single <span class="css" id="ref-for-funcdef-var③⑨">var()</span> function may substitute in the value of several longhands at once.</p>
   <p>To get around this,
	implementations must fill in longhands with a special, unobservable-to-authors <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="pending-substitution-value">pending-substitution value</dfn> that indicates the shorthand contains a variable,
	and thus the longhand’s value is pending variable substitution.
	This value must then be cascaded as normal,
	and at computed-value time,
	after <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④⓪">var()</a> functions are finally substituted in,
	the shorthand must be parsed and the longhands must be given their appropriate values at that point.</p>
   <p><a data-link-type="dfn" href="#pending-substitution-value" id="ref-for-pending-substitution-value">Pending-substitution values</a> must be serialized as the empty string,
	if an API allows them to be observed.</p>
   <p>Similarly,
	while <a data-link-type="biblio" href="#biblio-cssom" title="CSS Object Model (CSSOM)">[CSSOM]</a> defines that shorthand properties are serialized
	by appropriately concatenating the values of their corresponding longhands,
	shorthands that are specified with explicit <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④①">var()</a> functions
	must serialize to the original, <span class="css" id="ref-for-funcdef-var④②">var()</span>-containing value.
	For other shorthands,
	if any of the longhand subproperties for that shorthand have <a data-link-type="dfn" href="#pending-substitution-value" id="ref-for-pending-substitution-value①">pending-substitution values</a> then the serialized value of the shorthand must be the empty string.</p>
   <h3 class="heading settled" data-level="3.3" id="long-variables"><span class="secno">3.3. </span><span class="content"> Safely Handling Overly-Long Variables</span><a class="self-link" href="#long-variables"></a></h3>
   <p>Naively implemented, <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④③">var()</a> functions can be used in a variation of the "billion laughs attack":</p>
   <div class="example" id="example-9c9258de">
    <a class="self-link" href="#example-9c9258de"></a> 
<pre class="highlight" lang="css">.foo <c- p>{</c->
  <c- k>--prop1</c-><c- p>:</c-> lol<c- p>;</c->
  <c- k>--prop2</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--prop1<c- p>)</c-> <c- nf>var</c-><c- p>(</c->--prop1<c- p>);</c->
  <c- k>--prop3</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--prop2<c- p>)</c-> <c- nf>var</c-><c- p>(</c->--prop2<c- p>);</c->
  <c- k>--prop4</c-><c- p>:</c-> <c- nf>var</c-><c- p>(</c->--prop3<c- p>)</c-> <c- nf>var</c-><c- p>(</c->--prop3<c- p>);</c->
  <c- c>/* etc */</c->
<c- p>}</c->
</pre>
    <p>In this short example, <span class="css">--prop4</span>’s computed value is <span class="css">lol lol lol lol lol lol lol lol</span>,
		containing 8 copies of the original <span class="css">lol</span>.
		Every additional level added to this doubles the number of identifiers;
		extending it to a mere 30 levels,
		the work of a few minutes by hand,
		would make <span class="css">--prop30</span> contain <em>nearly a billion instances</em> of the identifier.</p>
   </div>
   <p>To avoid this sort of attack,
	UAs must impose a UA-defined limit on the allowed length of the token stream
	that a <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④④">var()</a> function expands into.
	If a <span class="css" id="ref-for-funcdef-var④⑤">var()</span> would expand into a longer token stream than this limit,
	it instead makes the property it’s expanding into <a data-link-type="dfn" href="#invalid-at-computed-value-time" id="ref-for-invalid-at-computed-value-time⑨">invalid at computed-value time</a>.</p>
   <p>This specification does not define what size limit should be imposed.
	However, since there are valid use-cases for custom properties that contain a kilobyte or more of text,
	it’s recommended that the limit be set relatively high.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The general principle that UAs are allowed to violate standards due to resource constraints
	is still generally true here;
	a UA might, separately, have limits on how long of a custom property they can support,
	or how large of an identifier they can support.
	This section calls out this attack specifically
	because of its long history,
	and the fact that it can be done without any of the pieces <em>seeming</em> to be too large on first inspection.</p>
   <h2 class="heading settled" data-level="4" id="apis"><span class="secno">4. </span><span class="content"> APIs</span><a class="self-link" href="#apis"></a></h2>
   <p>All <a data-link-type="dfn" href="#custom-property" id="ref-for-custom-property③③">custom property</a> <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations" id="ref-for-cssstyledeclaration-declarations">declarations</a> have the <a data-link-type="dfn" href="https://drafts.csswg.org/cssom-1/#css-declaration-case-sensitive-flag" id="ref-for-css-declaration-case-sensitive-flag">case-sensitive flag</a> set.</p>
   <p class="note" role="note"><span class="marker">Note:</span> Custom properties do not appear on a CSSStyleDeclaration object in camel-cased form,
	because their names may have both upper and lower case letters
	which indicate distinct custom properties.
	The sort of text transformation that automatic camel-casing performs is incompatible with this.
	They can still be accessed by their proper name via <a class="idl-code" data-link-type="method" href="https://drafts.csswg.org/cssom-1/#dom-cssstyledeclaration-getpropertyvalue" id="ref-for-dom-cssstyledeclaration-getpropertyvalue">getPropertyValue()</a>/etc.</p>
   <h3 class="heading settled" data-level="4.1" id="serializing-custom-props"><span class="secno">4.1. </span><span class="content"> Serializing Custom Properties</span><a class="self-link" href="#serializing-custom-props"></a></h3>
   <p>Custom property names must be serialized with the casing as provided by the author.</p>
   <p class="note" role="note"><span class="marker">Note:</span> For non-custom properties,
	property names are restricted to the ASCII range and are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive" id="ref-for-ascii-case-insensitive①">ASCII case-insensitive</a>,
	so implementations typically serialize the name lowercased.</p>
   <h2 class="heading settled" data-level="5" id="changes"><span class="secno">5. </span><span class="content"> Changes</span><a class="self-link" href="#changes"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="changes-20151203"><span class="secno">5.1. </span><span class="content"> Changes Since the 03 December 2015 CR</span><a class="self-link" href="#changes-20151203"></a></h3>
   <ul>
    <li data-md>
     <p>Now that <a data-link-type="biblio" href="#biblio-css-syntax-3" title="CSS Syntax Module Level 3">[css-syntax-3]</a> auto-trims whitespace from declaration values,
made <a class="production css" data-link-type="type" href="https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value" id="ref-for-typedef-declaration-value③">&lt;declaration-value></a> optional in the custom property grammar,
so that empty variables are still allowed.
(<a href="https://github.com/w3c/csswg-drafts/issues/774#issuecomment-434571254">Issue 774</a>)</p>
   </ul>
   <h3 class="heading settled" data-level="5.2" id="changes-20140506"><span class="secno">5.2. </span><span class="content"> Changes since the May 6 2014 Last Call Working Draft</span><a class="self-link" href="#changes-20140506"></a></h3>
   <ul>
    <li data-md>
     <p>Serialization of longhands when shorthand uses a variable was defined.</p>
    <li data-md>
     <p>Link to DOM’s definition of "case-sensitive".</p>
    <li data-md>
     <p>Added example of using variables with <a class="css" data-link-type="maybe" href="https://drafts.csswg.org/css2/#selectordef-lang" id="ref-for-selectordef-lang">:lang()</a> to do simple i18n.</p>
    <li data-md>
     <p>Clarified that usage of <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④⑥">var()</a> in a custom property must be valid per the <span class="css" id="ref-for-funcdef-var④⑦">var()</span> grammar.</p>
   </ul>
   <h2 class="heading settled" data-level="6" id="acks"><span class="secno">6. </span><span class="content"> Acknowledgments</span><a class="self-link" href="#acks"></a></h2>
   <p>Many thanks to several people in the CSS Working Group for keeping the dream of variables alive over the years,
	particularly Daniel Glazman and David Hyatt.
	Thanks to multiple people on the mailing list for helping contribute to the development of this incarnation of variables,
	particularly
	Brian Kardell,
	David Baron,
	François Remy,
	Roland Steiner,
	and Shane Stephens.</p>
   <h2 class="heading settled" data-level="7" id="priv-sec"><span class="secno">7. </span><span class="content">Privacy and Security Considerations</span><a class="self-link" href="#priv-sec"></a></h2>
   <p>This specification defines a purely author-level mechanism for passing styling information around within a page they control.
As such, there are no new privacy considerations.</p>
   <p><a href="#long-variables">§ 3.3 Safely Handling Overly-Long Variables</a> calls out a long-standing Denial-of-Service attack
that can be mounted against "macro-expansion"-like mechanisms,
such as the <a class="css" data-link-type="maybe" href="#funcdef-var" id="ref-for-funcdef-var④⑧">var()</a> function,
and mandates a defense against that attack.</p>
  </main>
  <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content"> Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
  <h3 class="no-ref heading settled" id="w3c-conventions"><span class="content"> Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
  <p>Conformance requirements are expressed with a combination of
    descriptive assertions and RFC 2119 terminology. The key words “MUST”,
    “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
    “RECOMMENDED”, “MAY”, and “OPTIONAL” in the normative parts of this
    document are to be interpreted as described in RFC 2119.
    However, for readability, these words do not appear in all uppercase
    letters in this specification. </p>
  <p>All of the text of this specification is normative except sections
    explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a></p>
  <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text with <code class="highlight">class=<c- s>"example"</c-></code>,
    like this: </p>
  <div class="example" id="w3c-example">
   <a class="self-link" href="#w3c-example"></a> 
   <p>This is an example of an informative example.</p>
  </div>
  <p>Informative notes begin with the word “Note” and are set apart from the
    normative text with <code class="highlight">class=<c- s>"note"</c-></code>, like this: </p>
  <p class="note" role="note">Note, this is an informative note.</p>
  <p>Advisements are normative sections styled to evoke special attention and are
    set apart from other normative text with <code class="highlight">&lt;strong class=<c- s>"advisement"</c->></code>, like
    this: <strong class="advisement"> UAs MUST provide an accessible alternative. </strong></p>
  <details class="wpt-tests-block" dir="ltr" lang="en" open>
   <summary>Tests</summary>
   <p>Tests relating to the content of this specification
                     may be documented in “Tests” blocks like this one.
                     Any such block is non-normative.</p>
   <ul class="wpt-tests-list"></ul>
   <hr>
  </details>
  <h3 class="no-ref heading settled" id="w3c-conformance-classes"><span class="content"> Conformance classes</span><a class="self-link" href="#w3c-conformance-classes"></a></h3>
  <p>Conformance to this specification
    is defined for three conformance classes: </p>
  <dl>
   <dt>style sheet 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#style-sheet">CSS
            style sheet</a>. 
   <dt>renderer 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that interprets the semantics of a style sheet and renders
            documents that use them. 
   <dt>authoring tool 
   <dd>A <a href="http://www.w3.org/TR/CSS21/conform.html#user-agent">UA</a> that writes a style sheet. 
  </dl>
  <p>A style sheet is conformant to this specification
    if all of its statements that use syntax defined in this module are valid
    according to the generic CSS grammar and the individual grammars of each
    feature defined in this module. </p>
  <p>A renderer is conformant to this specification
    if, in addition to interpreting the style sheet as defined by the
    appropriate specifications, it supports all the features defined
    by this specification by parsing them correctly
    and rendering the document accordingly. However, the inability of a
    UA to correctly render a document due to limitations of the device
    does not make the UA non-conformant. (For example, a UA is not
    required to render color on a monochrome monitor.) </p>
  <p>An authoring tool is conformant to this specification
    if it writes style sheets that are syntactically correct according to the
    generic CSS grammar and the individual grammars of each feature in
    this module, and meet all other conformance requirements of style sheets
    as described in this module. </p>
  <h3 class="no-ref heading settled" id="w3c-partial"><span class="content"> Partial implementations</span><a class="self-link" href="#w3c-partial"></a></h3>
  <p>So that authors can exploit the forward-compatible parsing rules to
    assign fallback values, CSS renderers <strong>must</strong> treat as invalid (and <a href="http://www.w3.org/TR/CSS21/conform.html#ignore">ignore
    as appropriate</a>) any at-rules, properties, property values, keywords,
    and other syntactic constructs for which they have no usable level of
    support. In particular, user agents <strong>must not</strong> selectively
    ignore unsupported component values and honor supported values in a single
    multi-value property declaration: if any value is considered invalid
    (as unsupported values must be), CSS requires that the entire declaration
    be ignored.</p>
  <h4 class="heading settled" id="w3c-conform-future-proofing"><span class="content"> Implementations of Unstable and Proprietary Features</span><a class="self-link" href="#w3c-conform-future-proofing"></a></h4>
  <p>To avoid clashes with future stable CSS features,
        the CSSWG recommends <a href="http://www.w3.org/TR/CSS/#future-proofing">following best practices</a> for the implementation of <a href="http://www.w3.org/TR/CSS/#unstable">unstable</a> features and <a href="http://www.w3.org/TR/CSS/#proprietary-extension">proprietary extensions</a> to CSS. </p>
  <h3 class="no-ref heading settled" id="w3c-testing"><span class="content"> Non-experimental implementations</span><a class="self-link" href="#w3c-testing"></a></h3>
  <p>Once a specification reaches the Candidate Recommendation stage,
    non-experimental implementations are possible, and implementors should
    release an unprefixed implementation of any CR-level feature they
    can demonstrate to be correctly implemented according to spec. </p>
  <p>To establish and maintain the interoperability of CSS across
    implementations, the CSS Working Group requests that non-experimental
    CSS renderers submit an implementation report (and, if necessary, the
    testcases used for that implementation report) to the W3C before
    releasing an unprefixed implementation of any CSS features. Testcases
    submitted to W3C are subject to review and correction by the CSS
    Working Group. </p>
  <p>Further information on submitting testcases and implementation reports
    can be found from on the CSS Working Group’s website at <a href="http://www.w3.org/Style/CSS/Test/">http://www.w3.org/Style/CSS/Test/</a>.
    Questions should be directed to the <a href="http://lists.w3.org/Archives/Public/public-css-testsuite">public-css-testsuite@w3.org</a> mailing list.</p>
  <script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#propdef-">--*</a><span>, in § 2</span>
   <li><a href="#animation-tainted">animation-tainted</a><span>, in § 2</span>
   <li><a href="#custom-property">custom property</a><span>, in § 2</span>
   <li><a href="#typedef-custom-property-name">&lt;custom-property-name></a><span>, in § 2</span>
   <li><a href="#guaranteed-invalid-value">guaranteed-invalid value</a><span>, in § 2.2</span>
   <li><a href="#invalid-at-computed-value-time">invalid at computed-value time</a><span>, in § 3.1</span>
   <li><a href="#pending-substitution-value">pending-substitution value</a><span>, in § 3.2</span>
   <li><a href="#substitute-a-var">substitute a var()</a><span>, in § 3</span>
   <li><a href="#funcdef-var">var()</a><span>, in § 3</span>
   <li><a href="#substitute-a-var">var() substitution</a><span>, in § 3</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[CSS-ANIMATIONS-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fa19c68e">@keyframes</span>
     <li><span class="dfn-paneled" id="eda608e1">animation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BACKGROUNDS-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="11fb4d5b">background-color</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-BOX-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="00140718">margin-top</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-5]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="d95397a7">all</span>
     <li><span class="dfn-paneled" id="4d7d3dcd">initial</span>
     <li><span class="dfn-paneled" id="31ccd1a9">longhand property</span>
     <li><span class="dfn-paneled" id="8ca0c013">shorthand property</span>
     <li><span class="dfn-paneled" id="9e004c39">unset</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CASCADE-6]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="de6d76c2">cascade</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-COLOR-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="73ea1d43">color</span>
     <li><span class="dfn-paneled" id="313bb160">transparent</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-CONDITIONAL-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="5f1b7f60">@media</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-DISPLAY-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9ee4a8b2">contents</span>
     <li><span class="dfn-paneled" id="e7f0dd6c">display</span>
     <li><span class="dfn-paneled" id="55e8f5de">none</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-FONTS-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fdf6efd5">font-size</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-PROPERTIES-VALUES-API-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f5848d5e">registered custom property</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-SYNTAX-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fcd4cfdb">&lt;)-token></span>
     <li><span class="dfn-paneled" id="40bd5e29">&lt;]-token></span>
     <li><span class="dfn-paneled" id="f20bb4b1">&lt;bad-string-token></span>
     <li><span class="dfn-paneled" id="c086086a">&lt;bad-url-token></span>
     <li><span class="dfn-paneled" id="8144e597">&lt;declaration-value></span>
     <li><span class="dfn-paneled" id="860c17f8">&lt;delim-token></span>
     <li><span class="dfn-paneled" id="aa917269">&lt;semicolon-token></span>
     <li><span class="dfn-paneled" id="f8c04a24">&lt;}-token></span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS-VALUES-4]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9f9120ff">,</span>
     <li><span class="dfn-paneled" id="8a427103">&lt;dashed-ident></span>
     <li><span class="dfn-paneled" id="537cf076">?</span>
     <li><span class="dfn-paneled" id="584e9c31">calc()</span>
     <li><span class="dfn-paneled" id="358fd6ff">css-wide keywords</span>
     <li><span class="dfn-paneled" id="e8ff0bb4">em</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS22]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="222f0f3c">:lang()</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSSOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b4632a2b">case-sensitive flag</span>
     <li><span class="dfn-paneled" id="e4ffca7f">declarations</span>
     <li><span class="dfn-paneled" id="4a3be6e5">getPropertyValue(property)</span>
    </ul>
   <li>
    <a data-link-type="biblio">[I18N-GLOSSARY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="86c3e5ca">case-sensitive</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7f9469b5">ascii case-insensitive</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-css-animations-1">[CSS-ANIMATIONS-1]
   <dd>David Baron; et al. <a href="https://drafts.csswg.org/css-animations/"><cite>CSS Animations Level 1</cite></a>. URL: <a href="https://drafts.csswg.org/css-animations/">https://drafts.csswg.org/css-animations/</a>
   <dt id="biblio-css-cascade-5">[CSS-CASCADE-5]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-cascade-5/"><cite>CSS Cascading and Inheritance Level 5</cite></a>. URL: <a href="https://drafts.csswg.org/css-cascade-5/">https://drafts.csswg.org/css-cascade-5/</a>
   <dt id="biblio-css-cascade-6">[CSS-CASCADE-6]
   <dd>Elika Etemad; Miriam Suzanne; Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-cascade-6/"><cite>CSS Cascading and Inheritance Level 6</cite></a>. URL: <a href="https://drafts.csswg.org/css-cascade-6/">https://drafts.csswg.org/css-cascade-6/</a>
   <dt id="biblio-css-conditional-3">[CSS-CONDITIONAL-3]
   <dd>Chris Lilley; David Baron; Elika Etemad. <a href="https://drafts.csswg.org/css-conditional-3/"><cite>CSS Conditional Rules Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-conditional-3/">https://drafts.csswg.org/css-conditional-3/</a>
   <dt id="biblio-css-display-4">[CSS-DISPLAY-4]
   <dd><a href="https://drafts.csswg.org/css-display-4/"><cite>CSS Display Module Level 4</cite></a>. Editor's Draft. URL: <a href="https://drafts.csswg.org/css-display-4/">https://drafts.csswg.org/css-display-4/</a>
   <dt id="biblio-css-properties-values-api-1">[CSS-PROPERTIES-VALUES-API-1]
   <dd>Tab Atkins Jr.; Alan Stearns; Greg Whitworth. <a href="https://drafts.css-houdini.org/css-properties-values-api-1/"><cite>CSS Properties and Values API Level 1</cite></a>. URL: <a href="https://drafts.css-houdini.org/css-properties-values-api-1/">https://drafts.css-houdini.org/css-properties-values-api-1/</a>
   <dt id="biblio-css-syntax-3">[CSS-SYNTAX-3]
   <dd>Tab Atkins Jr.; Simon Sapin. <a href="https://drafts.csswg.org/css-syntax/"><cite>CSS Syntax Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-syntax/">https://drafts.csswg.org/css-syntax/</a>
   <dt id="biblio-css-values-3">[CSS-VALUES-3]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-3/"><cite>CSS Values and Units Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-3/">https://drafts.csswg.org/css-values-3/</a>
   <dt id="biblio-css-values-4">[CSS-VALUES-4]
   <dd>Tab Atkins Jr.; Elika Etemad. <a href="https://drafts.csswg.org/css-values-4/"><cite>CSS Values and Units Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-values-4/">https://drafts.csswg.org/css-values-4/</a>
   <dt id="biblio-css2">[CSS2]
   <dd>Bert Bos; et al. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-css22">[CSS22]
   <dd>Bert Bos. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 2 (CSS 2.2) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-cssom">[CSSOM]
   <dd>Daniel Glazman; Emilio Cobos Álvarez. <a href="https://drafts.csswg.org/cssom/"><cite>CSS Object Model (CSSOM)</cite></a>. URL: <a href="https://drafts.csswg.org/cssom/">https://drafts.csswg.org/cssom/</a>
   <dt id="biblio-i18n-glossary">[I18N-GLOSSARY]
   <dd>Richard Ishida; Addison Phillips. <a href="https://w3c.github.io/i18n-glossary/"><cite>Internationalization Glossary</cite></a>. URL: <a href="https://w3c.github.io/i18n-glossary/">https://w3c.github.io/i18n-glossary/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-css-backgrounds-3">[CSS-BACKGROUNDS-3]
   <dd>Elika Etemad; Brad Kemper. <a href="https://drafts.csswg.org/css-backgrounds/"><cite>CSS Backgrounds and Borders Module Level 3</cite></a>. URL: <a href="https://drafts.csswg.org/css-backgrounds/">https://drafts.csswg.org/css-backgrounds/</a>
   <dt id="biblio-css-box-4">[CSS-BOX-4]
   <dd>Elika Etemad. <a href="https://drafts.csswg.org/css-box-4/"><cite>CSS Box Model Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-box-4/">https://drafts.csswg.org/css-box-4/</a>
   <dt id="biblio-css-color-4">[CSS-COLOR-4]
   <dd>Chris Lilley; Tab Atkins Jr.; Lea Verou. <a href="https://drafts.csswg.org/css-color-4/"><cite>CSS Color Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-color-4/">https://drafts.csswg.org/css-color-4/</a>
   <dt id="biblio-css-extensions">[CSS-EXTENSIONS]
   <dd>Tab Atkins Jr.. <a href="https://drafts.csswg.org/css-extensions/"><cite>CSS Extensions</cite></a>. ED. URL: <a href="https://drafts.csswg.org/css-extensions/">https://drafts.csswg.org/css-extensions/</a>
   <dt id="biblio-css-fonts-4">[CSS-FONTS-4]
   <dd>Chris Lilley. <a href="https://drafts.csswg.org/css-fonts-4/"><cite>CSS Fonts Module Level 4</cite></a>. URL: <a href="https://drafts.csswg.org/css-fonts-4/">https://drafts.csswg.org/css-fonts-4/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="property-index"><span class="content">Property Index</span><a class="self-link" href="#property-index"></a></h2>
  <div class="big-element-wrapper">
   <table class="index">
    <thead>
     <tr>
      <th scope="col">Name
      <th scope="col">Value
      <th scope="col">Initial
      <th scope="col">Applies to
      <th scope="col">Inh.
      <th scope="col">%ages
      <th scope="col">Anim­ation type
      <th scope="col">Canonical order
      <th scope="col">Com­puted value
    <tbody>
     <tr>
      <th scope="row"><a class="css" data-link-type="property">--*</a>
      <td>&lt;declaration-value>?
      <td>the guaranteed-invalid value
      <td>all elements
      <td>yes
      <td>n/a
      <td>discrete
      <td>per grammar
      <td>specified value with variables substituted, or the guaranteed-invalid value
   </table>
  </div>
  <details class="mdn-anno unpositioned" data-anno-for="using-variables">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/var()" title="The var() CSS function can be used to insert the value of a custom property (sometimes called a &quot;CSS variable&quot;) instead of any part of a value of another property.">var()</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>31+</span></span><span class="safari yes"><span>Safari</span><span>9.1+</span></span><span class="chrome yes"><span>Chrome</span><span>49+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>15+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android yes"><span>Android WebView</span><span>50+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
  <details class="mdn-anno unpositioned" data-anno-for="defining-variables">
   <summary><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></summary>
   <div class="feature">
    <p><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/--*" title="Property names that are prefixed with --, like --example-name, represent custom properties that contain a value that can be used in other declarations using the var() function.">--*</a></p>
    <p class="all-engines-text">In all current engines.</p>
    <div class="support">
     <span class="firefox yes"><span>Firefox</span><span>31+</span></span><span class="safari yes"><span>Safari</span><span>9.1+</span></span><span class="chrome yes"><span>Chrome</span><span>49+</span></span>
     <hr>
     <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
     <hr>
     <span class="edge yes"><span>Edge (Legacy)</span><span>15+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
     <hr>
     <span class="firefox_android no"><span>Firefox for Android</span><span>?</span></span><span class="safari_ios no"><span>iOS Safari</span><span>?</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
    </div>
   </div>
  </details>
<script>/* Boilerplate: script-dom-helper */
"use strict";
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
let dfnPanelData = {
"00140718": {"dfnID":"00140718","dfnText":"margin-top","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-margin-top"},{"id":"ref-for-propdef-margin-top\u2460"},{"id":"ref-for-propdef-margin-top\u2461"},{"id":"ref-for-propdef-margin-top\u2462"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-box-4/#propdef-margin-top"},
"11fb4d5b": {"dfnID":"11fb4d5b","dfnText":"background-color","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-background-color"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-propdef-background-color\u2460"},{"id":"ref-for-propdef-background-color\u2461"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-propdef-background-color\u2462"},{"id":"ref-for-propdef-background-color\u2463"},{"id":"ref-for-propdef-background-color\u2464"}],"title":"3.1. \nInvalid Variables"}],"url":"https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color"},
"222f0f3c": {"dfnID":"222f0f3c","dfnText":":lang()","external":true,"refSections":[{"refs":[{"id":"ref-for-selectordef-lang"}],"title":"5.2. \nChanges since the May 6 2014 Last Call Working Draft"}],"url":"https://drafts.csswg.org/css2/#selectordef-lang"},
"313bb160": {"dfnID":"313bb160","dfnText":"transparent","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-color-transparent"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-color-4/#valdef-color-transparent"},
"31ccd1a9": {"dfnID":"31ccd1a9","dfnText":"longhand property","external":true,"refSections":[{"refs":[{"id":"ref-for-longhand"}],"title":"3.2. \nVariables in Shorthand Properties"}],"url":"https://drafts.csswg.org/css-cascade-5/#longhand"},
"358fd6ff": {"dfnID":"358fd6ff","dfnText":"css-wide keywords","external":true,"refSections":[{"refs":[{"id":"ref-for-css-wide-keywords"}],"title":"1.1. \nValue Definitions"},{"refs":[{"id":"ref-for-css-wide-keywords\u2460"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://drafts.csswg.org/css-values-4/#css-wide-keywords"},
"40bd5e29": {"dfnID":"40bd5e29","dfnText":"<]-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-tokendef-close-square"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-square"},
"4a3be6e5": {"dfnID":"4a3be6e5","dfnText":"getPropertyValue(property)","external":true,"refSections":[{"refs":[{"id":"ref-for-dom-cssstyledeclaration-getpropertyvalue"}],"title":"4. \nAPIs"}],"url":"https://drafts.csswg.org/cssom-1/#dom-cssstyledeclaration-getpropertyvalue"},
"4d7d3dcd": {"dfnID":"4d7d3dcd","dfnText":"initial","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-initial"}],"title":"2.2. \nGuaranteed-Invalid Values"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial"},
"537cf076": {"dfnID":"537cf076","dfnText":"?","external":true,"refSections":[{"refs":[{"id":"ref-for-mult-opt"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-mult-opt\u2460"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-values-4/#mult-opt"},
"55e8f5de": {"dfnID":"55e8f5de","dfnText":"none","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-display-none"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-display-4/#valdef-display-none"},
"584e9c31": {"dfnID":"584e9c31","dfnText":"calc()","external":true,"refSections":[{"refs":[{"id":"ref-for-funcdef-calc"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-values-4/#funcdef-calc"},
"5f1b7f60": {"dfnID":"5f1b7f60","dfnText":"@media","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-media"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://drafts.csswg.org/css-conditional-3/#at-ruledef-media"},
"73ea1d43": {"dfnID":"73ea1d43","dfnText":"color","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-color"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-color-4/#propdef-color"},
"7f9469b5": {"dfnID":"7f9469b5","dfnText":"ascii case-insensitive","external":true,"refSections":[{"refs":[{"id":"ref-for-ascii-case-insensitive"}],"title":"2.1. \nCustom Property Value Syntax"},{"refs":[{"id":"ref-for-ascii-case-insensitive\u2460"}],"title":"4.1. \nSerializing Custom Properties"}],"url":"https://infra.spec.whatwg.org/#ascii-case-insensitive"},
"8144e597": {"dfnID":"8144e597","dfnText":"<declaration-value>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-declaration-value"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-typedef-declaration-value\u2460"}],"title":"2.1. \nCustom Property Value Syntax"},{"refs":[{"id":"ref-for-typedef-declaration-value\u2461"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-typedef-declaration-value\u2462"}],"title":"5.1. \nChanges Since the 03 December 2015 CR"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value"},
"860c17f8": {"dfnID":"860c17f8","dfnText":"<delim-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-delim-token"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-delim-token"},
"86c3e5ca": {"dfnID":"86c3e5ca","dfnText":"case-sensitive","external":true,"refSections":[{"refs":[{"id":"ref-for-dfn-case-sensitive"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://w3c.github.io/i18n-glossary/#dfn-case-sensitive"},
"8a427103": {"dfnID":"8a427103","dfnText":"<dashed-ident>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-dashed-ident"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://drafts.csswg.org/css-values-4/#typedef-dashed-ident"},
"8ca0c013": {"dfnID":"8ca0c013","dfnText":"shorthand property","external":true,"refSections":[{"refs":[{"id":"ref-for-shorthand-property"}],"title":"3.2. \nVariables in Shorthand Properties"}],"url":"https://drafts.csswg.org/css-cascade-5/#shorthand-property"},
"9e004c39": {"dfnID":"9e004c39","dfnText":"unset","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-all-unset"}],"title":"3.1. \nInvalid Variables"}],"url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset"},
"9ee4a8b2": {"dfnID":"9ee4a8b2","dfnText":"contents","external":true,"refSections":[{"refs":[{"id":"ref-for-valdef-display-contents"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-display-4/#valdef-display-contents"},
"9f9120ff": {"dfnID":"9f9120ff","dfnText":",","external":true,"refSections":[{"refs":[{"id":"ref-for-comb-comma"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-values-4/#comb-comma"},
"aa917269": {"dfnID":"aa917269","dfnText":"<semicolon-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-semicolon-token"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-semicolon-token"},
"animation-tainted": {"dfnID":"animation-tainted","dfnText":"animation-tainted","external":false,"refSections":[{"refs":[{"id":"ref-for-animation-tainted"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"#animation-tainted"},
"b4632a2b": {"dfnID":"b4632a2b","dfnText":"case-sensitive flag","external":true,"refSections":[{"refs":[{"id":"ref-for-css-declaration-case-sensitive-flag"}],"title":"4. \nAPIs"}],"url":"https://drafts.csswg.org/cssom-1/#css-declaration-case-sensitive-flag"},
"c086086a": {"dfnID":"c086086a","dfnText":"<bad-url-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-bad-url-token"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-bad-url-token"},
"custom-property": {"dfnID":"custom-property","dfnText":"custom property","external":false,"refSections":[{"refs":[{"id":"ref-for-custom-property"},{"id":"ref-for-custom-property\u2460"}],"title":"1. \nIntroduction"},{"refs":[{"id":"ref-for-custom-property\u2461"},{"id":"ref-for-custom-property\u2462"},{"id":"ref-for-custom-property\u2463"},{"id":"ref-for-custom-property\u2464"},{"id":"ref-for-custom-property\u2465"},{"id":"ref-for-custom-property\u2466"},{"id":"ref-for-custom-property\u2467"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-custom-property\u2468"},{"id":"ref-for-custom-property\u2460\u24ea"},{"id":"ref-for-custom-property\u2460\u2460"}],"title":"2.1. \nCustom Property Value Syntax"},{"refs":[{"id":"ref-for-custom-property\u2460\u2461"},{"id":"ref-for-custom-property\u2460\u2462"}],"title":"2.2. \nGuaranteed-Invalid Values"},{"refs":[{"id":"ref-for-custom-property\u2460\u2463"},{"id":"ref-for-custom-property\u2460\u2464"},{"id":"ref-for-custom-property\u2460\u2465"},{"id":"ref-for-custom-property\u2460\u2466"},{"id":"ref-for-custom-property\u2460\u2467"},{"id":"ref-for-custom-property\u2460\u2468"}],"title":"2.3. \nResolving Dependency Cycles"},{"refs":[{"id":"ref-for-custom-property\u2461\u24ea"},{"id":"ref-for-custom-property\u2461\u2460"},{"id":"ref-for-custom-property\u2461\u2461"},{"id":"ref-for-custom-property\u2461\u2462"},{"id":"ref-for-custom-property\u2461\u2463"},{"id":"ref-for-custom-property\u2461\u2464"},{"id":"ref-for-custom-property\u2461\u2465"},{"id":"ref-for-custom-property\u2461\u2466"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-custom-property\u2461\u2467"},{"id":"ref-for-custom-property\u2461\u2468"},{"id":"ref-for-custom-property\u2462\u24ea"},{"id":"ref-for-custom-property\u2462\u2460"},{"id":"ref-for-custom-property\u2462\u2461"}],"title":"3.1. \nInvalid Variables"},{"refs":[{"id":"ref-for-custom-property\u2462\u2462"}],"title":"4. \nAPIs"}],"url":"#custom-property"},
"d95397a7": {"dfnID":"d95397a7","dfnText":"all","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-all"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://drafts.csswg.org/css-cascade-5/#propdef-all"},
"de6d76c2": {"dfnID":"de6d76c2","dfnText":"cascade","external":true,"refSections":[{"refs":[{"id":"ref-for-cascade"}],"title":"3.2. \nVariables in Shorthand Properties"}],"url":"https://drafts.csswg.org/css-cascade-6/#cascade"},
"e4ffca7f": {"dfnID":"e4ffca7f","dfnText":"declarations","external":true,"refSections":[{"refs":[{"id":"ref-for-cssstyledeclaration-declarations"}],"title":"4. \nAPIs"}],"url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations"},
"e7f0dd6c": {"dfnID":"e7f0dd6c","dfnText":"display","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-display"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-display-4/#propdef-display"},
"e8ff0bb4": {"dfnID":"e8ff0bb4","dfnText":"em","external":true,"refSections":[{"refs":[{"id":"ref-for-em"}],"title":"2.3. \nResolving Dependency Cycles"}],"url":"https://drafts.csswg.org/css-values-4/#em"},
"eda608e1": {"dfnID":"eda608e1","dfnText":"animation","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-animation"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"https://drafts.csswg.org/css-animations-1/#propdef-animation"},
"f20bb4b1": {"dfnID":"f20bb4b1","dfnText":"<bad-string-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-typedef-bad-string-token"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#typedef-bad-string-token"},
"f5848d5e": {"dfnID":"f5848d5e","dfnText":"registered custom property","external":true,"refSections":[{"refs":[{"id":"ref-for-registered-custom-property"}],"title":"3.1. \nInvalid Variables"}],"url":"https://drafts.css-houdini.org/css-properties-values-api-1/#registered-custom-property"},
"f8c04a24": {"dfnID":"f8c04a24","dfnText":"<}-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-tokendef-close-curly"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-curly"},
"fa19c68e": {"dfnID":"fa19c68e","dfnText":"@keyframes","external":true,"refSections":[{"refs":[{"id":"ref-for-at-ruledef-keyframes"}],"title":"2. \nDefining Custom Properties: the --* family of properties"}],"url":"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes"},
"fcd4cfdb": {"dfnID":"fcd4cfdb","dfnText":"<)-token>","external":true,"refSections":[{"refs":[{"id":"ref-for-tokendef-close-paren"}],"title":"2.1. \nCustom Property Value Syntax"}],"url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-paren"},
"fdf6efd5": {"dfnID":"fdf6efd5","dfnText":"font-size","external":true,"refSections":[{"refs":[{"id":"ref-for-propdef-font-size"}],"title":"2.3. \nResolving Dependency Cycles"}],"url":"https://drafts.csswg.org/css-fonts-4/#propdef-font-size"},
"funcdef-var": {"dfnID":"funcdef-var","dfnText":"var()","external":false,"refSections":[{"refs":[{"id":"ref-for-funcdef-var"}],"title":"1. \nIntroduction"},{"refs":[{"id":"ref-for-funcdef-var\u2460"},{"id":"ref-for-funcdef-var\u2461"},{"id":"ref-for-funcdef-var\u2462"},{"id":"ref-for-funcdef-var\u2463"},{"id":"ref-for-funcdef-var\u2464"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-funcdef-var\u2465"},{"id":"ref-for-funcdef-var\u2466"},{"id":"ref-for-funcdef-var\u2467"},{"id":"ref-for-funcdef-var\u2468"}],"title":"2.1. \nCustom Property Value Syntax"},{"refs":[{"id":"ref-for-funcdef-var\u2460\u24ea"}],"title":"2.2. \nGuaranteed-Invalid Values"},{"refs":[{"id":"ref-for-funcdef-var\u2460\u2460"},{"id":"ref-for-funcdef-var\u2460\u2461"},{"id":"ref-for-funcdef-var\u2460\u2462"},{"id":"ref-for-funcdef-var\u2460\u2463"},{"id":"ref-for-funcdef-var\u2460\u2464"}],"title":"2.3. \nResolving Dependency Cycles"},{"refs":[{"id":"ref-for-funcdef-var\u2460\u2465"},{"id":"ref-for-funcdef-var\u2460\u2466"},{"id":"ref-for-funcdef-var\u2460\u2467"},{"id":"ref-for-funcdef-var\u2460\u2468"},{"id":"ref-for-funcdef-var\u2461\u24ea"},{"id":"ref-for-funcdef-var\u2461\u2460"},{"id":"ref-for-funcdef-var\u2461\u2461"},{"id":"ref-for-funcdef-var\u2461\u2462"},{"id":"ref-for-funcdef-var\u2461\u2463"},{"id":"ref-for-funcdef-var\u2461\u2464"},{"id":"ref-for-funcdef-var\u2461\u2465"},{"id":"ref-for-funcdef-var\u2461\u2466"},{"id":"ref-for-funcdef-var\u2461\u2467"},{"id":"ref-for-funcdef-var\u2461\u2468"},{"id":"ref-for-funcdef-var\u2462\u24ea"},{"id":"ref-for-funcdef-var\u2462\u2460"},{"id":"ref-for-funcdef-var\u2462\u2461"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-funcdef-var\u2462\u2462"},{"id":"ref-for-funcdef-var\u2462\u2463"},{"id":"ref-for-funcdef-var\u2462\u2464"},{"id":"ref-for-funcdef-var\u2462\u2465"}],"title":"3.1. \nInvalid Variables"},{"refs":[{"id":"ref-for-funcdef-var\u2462\u2466"},{"id":"ref-for-funcdef-var\u2462\u2467"},{"id":"ref-for-funcdef-var\u2462\u2468"},{"id":"ref-for-funcdef-var\u2463\u24ea"},{"id":"ref-for-funcdef-var\u2463\u2460"},{"id":"ref-for-funcdef-var\u2463\u2461"}],"title":"3.2. \nVariables in Shorthand Properties"},{"refs":[{"id":"ref-for-funcdef-var\u2463\u2462"},{"id":"ref-for-funcdef-var\u2463\u2463"},{"id":"ref-for-funcdef-var\u2463\u2464"}],"title":"3.3. \nSafely Handling Overly-Long Variables"},{"refs":[{"id":"ref-for-funcdef-var\u2463\u2465"},{"id":"ref-for-funcdef-var\u2463\u2466"}],"title":"5.2. \nChanges since the May 6 2014 Last Call Working Draft"},{"refs":[{"id":"ref-for-funcdef-var\u2463\u2467"}],"title":"7. Privacy and Security Considerations"}],"url":"#funcdef-var"},
"guaranteed-invalid-value": {"dfnID":"guaranteed-invalid-value","dfnText":"guaranteed-invalid value","external":false,"refSections":[{"refs":[{"id":"ref-for-guaranteed-invalid-value"},{"id":"ref-for-guaranteed-invalid-value\u2460"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-guaranteed-invalid-value\u2461"},{"id":"ref-for-guaranteed-invalid-value\u2462"}],"title":"2.2. \nGuaranteed-Invalid Values"},{"refs":[{"id":"ref-for-guaranteed-invalid-value\u2463"},{"id":"ref-for-guaranteed-invalid-value\u2464"}],"title":"2.3. \nResolving Dependency Cycles"},{"refs":[{"id":"ref-for-guaranteed-invalid-value\u2465"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-guaranteed-invalid-value\u2466"},{"id":"ref-for-guaranteed-invalid-value\u2467"},{"id":"ref-for-guaranteed-invalid-value\u2468"}],"title":"3.1. \nInvalid Variables"}],"url":"#guaranteed-invalid-value"},
"invalid-at-computed-value-time": {"dfnID":"invalid-at-computed-value-time","dfnText":"invalid at computed-value time","external":false,"refSections":[{"refs":[{"id":"ref-for-invalid-at-computed-value-time"}],"title":"2.2. \nGuaranteed-Invalid Values"},{"refs":[{"id":"ref-for-invalid-at-computed-value-time\u2460"},{"id":"ref-for-invalid-at-computed-value-time\u2461"},{"id":"ref-for-invalid-at-computed-value-time\u2462"}],"title":"2.3. \nResolving Dependency Cycles"},{"refs":[{"id":"ref-for-invalid-at-computed-value-time\u2463"},{"id":"ref-for-invalid-at-computed-value-time\u2464"},{"id":"ref-for-invalid-at-computed-value-time\u2465"}],"title":"3. \nUsing Cascading Variables: the var() notation"},{"refs":[{"id":"ref-for-invalid-at-computed-value-time\u2466"},{"id":"ref-for-invalid-at-computed-value-time\u2467"}],"title":"3.1. \nInvalid Variables"},{"refs":[{"id":"ref-for-invalid-at-computed-value-time\u2468"}],"title":"3.3. \nSafely Handling Overly-Long Variables"}],"url":"#invalid-at-computed-value-time"},
"pending-substitution-value": {"dfnID":"pending-substitution-value","dfnText":"pending-substitution value","external":false,"refSections":[{"refs":[{"id":"ref-for-pending-substitution-value"},{"id":"ref-for-pending-substitution-value\u2460"}],"title":"3.2. \nVariables in Shorthand Properties"}],"url":"#pending-substitution-value"},
"propdef-": {"dfnID":"propdef-","dfnText":"--*","external":false,"refSections":[],"url":"#propdef-"},
"substitute-a-var": {"dfnID":"substitute-a-var","dfnText":"substitute a var()","external":false,"refSections":[{"refs":[{"id":"ref-for-substitute-a-var"}],"title":"2. \nDefining Custom Properties: the --* family of properties"},{"refs":[{"id":"ref-for-substitute-a-var\u2460"},{"id":"ref-for-substitute-a-var\u2461"},{"id":"ref-for-substitute-a-var\u2462"},{"id":"ref-for-substitute-a-var\u2463"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"#substitute-a-var"},
"typedef-custom-property-name": {"dfnID":"typedef-custom-property-name","dfnText":"<custom-property-name>","external":false,"refSections":[{"refs":[{"id":"ref-for-typedef-custom-property-name"}],"title":"3. \nUsing Cascading Variables: the var() notation"}],"url":"#typedef-custom-property-name"},
};

document.addEventListener("DOMContentLoaded", ()=>{
    genAllDfnPanels();

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });
});

window.addEventListener("resize", () => {
    // Pin any visible dfn panel
    queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>positionDfnPanel(el));
});

function genAllDfnPanels() {
    for(const panelData of Object.values(dfnPanelData)) {
        const dfnID = panelData.dfnID;
        const dfn = document.getElementById(dfnID);
        if(!dfn) {
            console.log(`Can't find dfn#${dfnID}.`, panelData);
            continue;
        }
        dfn.panelData = panelData;
        insertDfnPopupAction(dfn);
    }
}

function genDfnPanel(dfn, { dfnID, url, dfnText, refSections, external }) {
    const dfnPanel = mk.aside({
        class: "dfn-panel on",
        id: `infopanel-for-${dfnID}`,
        "data-for": dfnID,
        "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
        },
        mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
            `Info about the '${dfnText}' ${external?"external":""} reference.`),
        mk.a({href:url, class:"dfn-link"}, url),
        refSections.length == 0 ? [] :
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({ href: `#${ref.id}` },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
        genLinkingSyntaxes(dfn),
    );

    dfnPanel.addEventListener('click', (event) => {
        if (event.target.nodeName == 'A') {
            scrollToTargetAndHighlight(event);
            pinDfnPanel(dfnPanel);
        }
        event.stopPropagation();
        refocusOnTarget(event);
    });
    dfnPanel.addEventListener('keydown', (event) => {
        if(event.keyCode == 27) { // Escape key
            hideDfnPanel({dfnPanel});
            event.stopPropagation();
            event.preventDefault();
        }
    });

    dfnPanel.dfn = dfn;
    dfn.dfnPanel = dfnPanel;
    return dfnPanel;
}



function hideAllDfnPanels() {
    // Delete the currently-active dfn panel.
    queryAll(".dfn-panel").forEach(dfnPanel=>hideDfnPanel({dfnPanel}));
}

function showDfnPanel(dfn) {
    hideAllDfnPanels(); // Only display one at a time.

    dfn.setAttribute("aria-expanded", "true");

    const dfnPanel = genDfnPanel(dfn, dfn.panelData);

    // Give the dfn a unique tabindex, and then
    // give all the tabbable panel bits successive indexes.
    let tabIndex = 100;
    dfn.tabIndex = tabIndex++;
    const tabbable = dfnPanel.querySelectorAll(":is(a, button)");
    for (const el of tabbable) {
        el.tabIndex = tabIndex++;
    }

    append(document.body, dfnPanel);
    positionDfnPanel(dfnPanel);
}

function positionDfnPanel(dfnPanel) {
    const dfn = dfnPanel.dfn;
    const dfnPos = getBounds(dfn);
    dfnPanel.style.top = dfnPos.bottom + "px";
    dfnPanel.style.left = dfnPos.left + "px";

    const panelPos = dfnPanel.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, dfnPos.left - overflowAmount);
        dfnPanel.style.left = newLeft + "px";
    }
}

function pinDfnPanel(dfnPanel) {
    // Switch it to "activated" state, which pins it.
    dfnPanel.classList.add("activated");
    dfnPanel.style.position = "fixed";
    dfnPanel.style.left = null;
    dfnPanel.style.top = null;
}

function hideDfnPanel({dfn, dfnPanel}) {
    if(!dfnPanel) dfnPanel = dfn.dfnPanel;
    if(!dfn) dfn = dfnPanel.dfn;
    dfn.dfnPanel = undefined;
    dfnPanel.dfn = undefined;
    dfn.setAttribute("aria-expanded", "false");
    dfn.tabIndex = undefined;
    dfnPanel.remove()
}

function toggleDfnPanel(dfn) {
    if(dfn.dfnPanel) {
        hideDfnPanel(dfn);
    } else {
        showDfnPanel(dfn);
    }
}

function insertDfnPopupAction(dfn) {
    dfn.setAttribute('role', 'button');
    dfn.setAttribute('aria-expanded', 'false')
    dfn.tabIndex = 0;
    dfn.classList.add('has-dfn-panel');
    dfn.addEventListener('click', (event) => {
        toggleDfnPanel(dfn);
        event.stopPropagation();
    });
    dfn.addEventListener('keypress', (event) => {
        const kc = event.keyCode;
        // 32->Space, 13->Enter
        if(kc == 32 || kc == 13) {
            toggleDfnPanel(dfn);
            event.stopPropagation();
            event.preventDefault();
        }
    });
}

function refocusOnTarget(event) {
    const target = event.target;
    setTimeout(() => {
        // Refocus on the event.target element.
        // This is needed after browser scrolls to the destination.
        target.focus();
    });
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function scrollToTargetAndHighlight(event) {
    let hash = event.target.hash;
    if (hash) {
        hash = decodeURIComponent(hash.substring(1));
        const dest = document.getElementById(hash);
        if (dest) {
            dest.classList.add('highlighted');
            setTimeout(() => dest.classList.remove('highlighted'), 1000);
        }
    }
}

// Functions, divided by link type, that wrap an autolink's
// contents with the appropriate outer syntax.
// Alternately, a string naming another type they format
// the same as.
function needsFor(type) {
    switch(type) {
        case "descriptor":
        case "value":
        case "element-attr":
        case "attr-value":
        case "element-state":
        case "method":
        case "constructor":
        case "argument":
        case "attribute":
        case "const":
        case "dict-member":
        case "event":
        case "enum-value":
        case "stringifier":
        case "serializer":
        case "iterator":
        case "maplike":
        case "setlike":
        case "state":
        case "mode":
        case "context":
        case "facet": return true;

        default: return false;
    }
}
function refusesFor(type) {
    switch(type) {
        case "property":
        case "element":
        case "interface":
        case "namespace":
        case "callback":
        case "dictionary":
        case "enum":
        case "exception":
        case "typedef":
        case "http-header":
        case "permission": return true;

        default: return false;
    }
}
function linkFormatterFromType(type) {
    switch(type) {
        case 'scheme':
        case 'permission':
        case 'dfn': return (text) => `[=${text}=]`;

        case 'abstract-op': return (text) => `[\$${text}\$]`;

        case 'function':
        case 'at-rule':
        case 'selector':
        case 'value': return (text) => `''${text}''`;

        case 'http-header': return (text) => `[:${text}:]`;

        case 'interface':
        case 'constructor':
        case 'method':
        case 'argument':
        case 'attribute':
        case 'callback':
        case 'dictionary':
        case 'dict-member':
        case 'enum':
        case 'enum-value':
        case 'exception':
        case 'const':
        case 'typedef':
        case 'stringifier':
        case 'serializer':
        case 'iterator':
        case 'maplike':
        case 'setlike':
        case 'extended-attribute':
        case 'event':
        case 'idl': return (text) => `{{${text}}}`;

        case 'element-state':
        case 'element-attr':
        case 'attr-value':
        case 'element': return (element) => `<{${element}}>`;

        case 'grammar': return (text) => `${text} (within a <pre class=prod>)`;

        case 'type': return (text)=> `<<${text}>>`;

        case 'descriptor':
        case 'property': return (text) => `'${text}'`;

        default: return;
    };
};

function genLinkingSyntaxes(dfn) {
    if(dfn.tagName != "DFN") return;

    const type = dfn.getAttribute('data-dfn-type');
    if(!type) {
        console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
        return [];
    }

    // Return a function that wraps link text based on the type
    const linkFormatter = linkFormatterFromType(type);
    if(!linkFormatter) {
        console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
        return [];
    }

    let ltAlts;
    if(dfn.hasAttribute('data-lt')) {
        ltAlts = dfn.getAttribute('data-lt')
            .split("|")
            .map(x=>x.trim());
    } else {
        ltAlts = [dfn.textContent.trim()];
    }
    if(type == "type") {
        // lt of "<foo>", but "foo" is the interior;
        // <<foo/bar>> is how you write it with a for,
        // not <foo/<bar>> or whatever.
        for(var i = 0; i < ltAlts.length; i++) {
            const lt = ltAlts[i];
            const match = /<(.*)>/.exec(lt);
            if(match) { ltAlts[i] = match[1]; }
        }
    }

    let forAlts;
    if(dfn.hasAttribute('data-dfn-for')) {
        forAlts = dfn.getAttribute('data-dfn-for')
            .split(",")
            .map(x=>x.trim());
    } else {
        forAlts = [''];
    }

    let linkingSyntaxes = [];
    if(!needsFor(type)) {
        for(const lt of ltAlts) {
            linkingSyntaxes.push(linkFormatter(lt));
        }
    }
    if(!refusesFor(type)) {
        for(const f of forAlts) {
            linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
        }
    }
    return [
        mk.b({}, 'Possible linking syntaxes:'),
        mk.ul({},
            ...linkingSyntaxes.map(link => {
                const copyLink = async () =>
                    await navigator.clipboard.writeText(link);
                return mk.li({},
                    mk.div({ class: 'link-item' },
                        mk.button({
                            class: 'copy-icon', title: 'Copy',
                            type: 'button',
                            _onclick: copyLink,
                            tabindex: 0,
                        }, mk.span({ class: 'icon' }) ),
                        mk.span({}, link)
                    )
                );
            })
        )
    ];
}
}
</script>
<script>/* Boilerplate: script-position-annos */
"use strict";
{
function repositionAnnoPanels(){
    const panels = [...document.querySelectorAll("[data-anno-for]")];
    hydratePanels(panels);
    let vSoFar = 0;
    for(const panel of panels.sort(cmpTops)) {
        if(panel.top < vSoFar) {
            panel.top = vSoFar;
            panel.style.top = vSoFar + "px";
        }
        vSoFar = panel.top + panel.height + 15;
    }
}
function hydratePanels(panels) {
    const main = document.querySelector("main");
    let mainRect;
    if(main) mainRect = main.getBoundingClientRect();
    // First display them all, if they're not already visible.
    for(const panel of panels) {
        panel.classList.remove("unpositioned");
    }
    // Measure them all
    for(const panel of panels) {
        const dfn = document.getElementById(panel.getAttribute("data-anno-for"));
        if(!dfn) {
            console.log("Can't find the annotation panel target:", panel);
            continue;
        }
        panel.dfn = dfn;
        panel.top = window.scrollY + dfn.getBoundingClientRect().top;
        let panelRect = panel.getBoundingClientRect();
        panel.height = panelRect.height;
        if(main) {
            panel.overlappingMain = panelRect.left < mainRect.right;
        } else {
            panel.overlappingMain = false;
        }
    }
    // And finally position them
    for(const panel of panels) {
        const dfn = panel.dfn;
        if(!dfn) continue;
        panel.style.top = panel.top + "px";
        panel.classList.toggle("overlapping-main", panel.overlappingMain);
    }
}

function cmpTops(a,b) {
    return a.top - b.top;
}

window.addEventListener("load", repositionAnnoPanels);
window.addEventListener("resize", repositionAnnoPanels);
}
</script>
<script>/* Boilerplate: script-ref-hints */
"use strict";
{
let refsData = {
"#animation-tainted": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"animation-tainted","type":"dfn","url":"#animation-tainted"},
"#custom-property": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"custom property","type":"dfn","url":"#custom-property"},
"#funcdef-var": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"var()","type":"function","url":"#funcdef-var"},
"#guaranteed-invalid-value": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"guaranteed-invalid value","type":"dfn","url":"#guaranteed-invalid-value"},
"#invalid-at-computed-value-time": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"invalid at computed-value time","type":"dfn","url":"#invalid-at-computed-value-time"},
"#pending-substitution-value": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"pending-substitution value","type":"dfn","url":"#pending-substitution-value"},
"#substitute-a-var": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"substitute a var()","type":"dfn","url":"#substitute-a-var"},
"#typedef-custom-property-name": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-variables","spec":"css-variables-1","status":"local","text":"<custom-property-name>","type":"type","url":"#typedef-custom-property-name"},
"https://drafts.css-houdini.org/css-properties-values-api-1/#registered-custom-property": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-properties-values-api","spec":"css-properties-values-api-1","status":"current","text":"registered custom property","type":"dfn","url":"https://drafts.css-houdini.org/css-properties-values-api-1/#registered-custom-property"},
"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-animations","spec":"css-animations-1","status":"current","text":"@keyframes","type":"at-rule","url":"https://drafts.csswg.org/css-animations-1/#at-ruledef-keyframes"},
"https://drafts.csswg.org/css-animations-1/#propdef-animation": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css-animations","spec":"css-animations-1","status":"current","text":"animation","type":"property","url":"https://drafts.csswg.org/css-animations-1/#propdef-animation"},
"https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-backgrounds","spec":"css-backgrounds-3","status":"current","text":"background-color","type":"property","url":"https://drafts.csswg.org/css-backgrounds-3/#propdef-background-color"},
"https://drafts.csswg.org/css-box-4/#propdef-margin-top": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-box","spec":"css-box-4","status":"current","text":"margin-top","type":"property","url":"https://drafts.csswg.org/css-box-4/#propdef-margin-top"},
"https://drafts.csswg.org/css-cascade-5/#longhand": {"export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"longhand property","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#longhand"},
"https://drafts.csswg.org/css-cascade-5/#propdef-all": {"export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"all","type":"property","url":"https://drafts.csswg.org/css-cascade-5/#propdef-all"},
"https://drafts.csswg.org/css-cascade-5/#shorthand-property": {"export":true,"for_":[],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"shorthand property","type":"dfn","url":"https://drafts.csswg.org/css-cascade-5/#shorthand-property"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial": {"export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"initial","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-initial"},
"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset": {"export":true,"for_":["all"],"level":"5","normative":true,"shortname":"css-cascade","spec":"css-cascade-5","status":"current","text":"unset","type":"value","url":"https://drafts.csswg.org/css-cascade-5/#valdef-all-unset"},
"https://drafts.csswg.org/css-cascade-6/#cascade": {"export":true,"for_":[],"level":"6","normative":true,"shortname":"css-cascade","spec":"css-cascade-6","status":"current","text":"cascade","type":"dfn","url":"https://drafts.csswg.org/css-cascade-6/#cascade"},
"https://drafts.csswg.org/css-color-4/#propdef-color": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-color","spec":"css-color-4","status":"current","text":"color","type":"property","url":"https://drafts.csswg.org/css-color-4/#propdef-color"},
"https://drafts.csswg.org/css-color-4/#valdef-color-transparent": {"export":true,"for_":["<color>"],"level":"4","normative":true,"shortname":"css-color","spec":"css-color-4","status":"current","text":"transparent","type":"value","url":"https://drafts.csswg.org/css-color-4/#valdef-color-transparent"},
"https://drafts.csswg.org/css-conditional-3/#at-ruledef-media": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-conditional","spec":"css-conditional-3","status":"current","text":"@media","type":"at-rule","url":"https://drafts.csswg.org/css-conditional-3/#at-ruledef-media"},
"https://drafts.csswg.org/css-display-4/#propdef-display": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"display","type":"property","url":"https://drafts.csswg.org/css-display-4/#propdef-display"},
"https://drafts.csswg.org/css-display-4/#valdef-display-contents": {"export":true,"for_":["display","<display-box>"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"contents","type":"value","url":"https://drafts.csswg.org/css-display-4/#valdef-display-contents"},
"https://drafts.csswg.org/css-display-4/#valdef-display-none": {"export":true,"for_":["display","<display-box>"],"level":"4","normative":true,"shortname":"css-display","spec":"css-display-4","status":"current","text":"none","type":"value","url":"https://drafts.csswg.org/css-display-4/#valdef-display-none"},
"https://drafts.csswg.org/css-fonts-4/#propdef-font-size": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-fonts","spec":"css-fonts-4","status":"current","text":"font-size","type":"property","url":"https://drafts.csswg.org/css-fonts-4/#propdef-font-size"},
"https://drafts.csswg.org/css-syntax-3/#tokendef-close-curly": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<}-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-curly"},
"https://drafts.csswg.org/css-syntax-3/#tokendef-close-paren": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<)-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-paren"},
"https://drafts.csswg.org/css-syntax-3/#tokendef-close-square": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<]-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#tokendef-close-square"},
"https://drafts.csswg.org/css-syntax-3/#typedef-bad-string-token": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<bad-string-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-bad-string-token"},
"https://drafts.csswg.org/css-syntax-3/#typedef-bad-url-token": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<bad-url-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-bad-url-token"},
"https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<declaration-value>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-declaration-value"},
"https://drafts.csswg.org/css-syntax-3/#typedef-delim-token": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<delim-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-delim-token"},
"https://drafts.csswg.org/css-syntax-3/#typedef-semicolon-token": {"export":true,"for_":[],"level":"3","normative":true,"shortname":"css-syntax","spec":"css-syntax-3","status":"current","text":"<semicolon-token>","type":"type","url":"https://drafts.csswg.org/css-syntax-3/#typedef-semicolon-token"},
"https://drafts.csswg.org/css-values-4/#comb-comma": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":",","type":"grammar","url":"https://drafts.csswg.org/css-values-4/#comb-comma"},
"https://drafts.csswg.org/css-values-4/#css-wide-keywords": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"css-wide keywords","type":"dfn","url":"https://drafts.csswg.org/css-values-4/#css-wide-keywords"},
"https://drafts.csswg.org/css-values-4/#em": {"export":true,"for_":["<length>"],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"em","type":"value","url":"https://drafts.csswg.org/css-values-4/#em"},
"https://drafts.csswg.org/css-values-4/#funcdef-calc": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"calc()","type":"function","url":"https://drafts.csswg.org/css-values-4/#funcdef-calc"},
"https://drafts.csswg.org/css-values-4/#mult-opt": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"?","type":"grammar","url":"https://drafts.csswg.org/css-values-4/#mult-opt"},
"https://drafts.csswg.org/css-values-4/#typedef-dashed-ident": {"export":true,"for_":[],"level":"4","normative":true,"shortname":"css-values","spec":"css-values-4","status":"current","text":"<dashed-ident>","type":"type","url":"https://drafts.csswg.org/css-values-4/#typedef-dashed-ident"},
"https://drafts.csswg.org/css2/#selectordef-lang": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"css","spec":"css22","status":"current","text":":lang()","type":"selector","url":"https://drafts.csswg.org/css2/#selectordef-lang"},
"https://drafts.csswg.org/cssom-1/#css-declaration-case-sensitive-flag": {"export":false,"for_":["CSS declaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"case-sensitive flag","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#css-declaration-case-sensitive-flag"},
"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations": {"export":true,"for_":["CSSStyleDeclaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"declarations","type":"dfn","url":"https://drafts.csswg.org/cssom-1/#cssstyledeclaration-declarations"},
"https://drafts.csswg.org/cssom-1/#dom-cssstyledeclaration-getpropertyvalue": {"export":true,"for_":["CSSStyleDeclaration"],"level":"1","normative":true,"shortname":"cssom","spec":"cssom-1","status":"current","text":"getPropertyValue(property)","type":"method","url":"https://drafts.csswg.org/cssom-1/#dom-cssstyledeclaration-getpropertyvalue"},
"https://infra.spec.whatwg.org/#ascii-case-insensitive": {"export":true,"for_":[],"level":"1","normative":true,"shortname":"infra","spec":"infra","status":"current","text":"ascii case-insensitive","type":"dfn","url":"https://infra.spec.whatwg.org/#ascii-case-insensitive"},
"https://w3c.github.io/i18n-glossary/#dfn-case-sensitive": {"export":true,"for_":[],"level":"1","normative":false,"shortname":"i18n-glossary","spec":"i18n-glossary","status":"current","text":"case-sensitive","type":"dfn","url":"https://w3c.github.io/i18n-glossary/#dfn-case-sensitive"},
};

function mkRefHint(link, ref) {
    const linkText = link.textContent;
    let dfnTextElements = '';
    if (ref.text != linkText) {
        dfnTextElements =
            mk.li({},
                mk.b({}, "Term: "),
                mk.span({}, ref.text)
            );
    }
    const forList = ref.for_;
    let forListElements;
    if(forList.length == 0) {
        forListElements = [];
    } else if(forList.length == 1) {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.span({}, forList[0]),
        );
    } else {
        forListElements = mk.li({},
            mk.b({}, "For: "),
            mk.ul({},
                ...forList.map(forItem =>
                    mk.li({},
                        mk.span({}, forItem)
                    ),
                ),
            ),
        );
    }
    const url = ref.url;
    const safeUrl = encodeURIComponent(url);
    const hintPanel = mk.aside({
        class: "ref-hint",
        id: `ref-hint-for-${safeUrl}`,
        "data-for": url,
        "aria-labelled-by": `ref-hint-for-${safeUrl}`,
    },
        mk.ul({},
            dfnTextElements,
            mk.li({},
                mk.b({}, "URL: "),
                mk.a({ href: url, class: "ref" }, url),
            ),
            mk.li({},
                mk.b({}, "Type: "),
                mk.span({}, `${ref.type}`),
            ),
            mk.li({},
                mk.b({}, "Spec: "),
                mk.span({}, `${ref.spec ? ref.spec : ''}`),
            ),
            forListElements
        ),
    );
    hintPanel.forLink = link;
    setupRefHintEventListeners(link, hintPanel);
    return hintPanel;
}

function hideAllRefHints() {
    queryAll(".ref-hint").forEach(el=>hideRefHint(el));
}

function hideRefHint(refHint) {
    const link = refHint.forLink;
    link.setAttribute("aria-expanded", "false");
    if(refHint.teardownEventListeners) {
        refHint.teardownEventListeners();
    }
    refHint.remove();
}

function showRefHint(link) {
    if(link.classList.contains("dfn-link")) return;
    const url = link.getAttribute("href");
    const ref = refsData[url];
    if(!ref) return;

    hideAllRefHints(); // Only display one at this time.

    const refHint = mkRefHint(link, ref);
    append(document.body, refHint);
    link.setAttribute("aria-expanded", "true");
    positionRefHint(refHint);
}

function setupRefHintEventListeners(link, refHint) {
    if (refHint.teardownEventListeners) return;
    // Add event handlers to hide the refHint after the user moves away
    // from both the link and refHint, if not hovering either within one second.
    let timeout = null;
    const startHidingRefHint = (event) => {
        if (timeout) {
            clearTimeout(timeout);
        }
        timeout = setTimeout(() => {
            hideRefHint(refHint);
        }, 1000);
    }
    const resetHidingRefHint = (event) => {
        if (timeout) clearTimeout(timeout);
        timeout = null;
    };
    link.addEventListener("mouseleave", startHidingRefHint);
    link.addEventListener("mouseenter", resetHidingRefHint);
    link.addEventListener("blur", startHidingRefHint);
    link.addEventListener("focus", resetHidingRefHint);
    refHint.addEventListener("mouseleave", startHidingRefHint);
    refHint.addEventListener("mouseenter", resetHidingRefHint);
    refHint.addEventListener("blur", startHidingRefHint);
    refHint.addEventListener("focus", resetHidingRefHint);

    refHint.teardownEventListeners = () => {
        // remove event listeners
        resetHidingRefHint();
        link.removeEventListener("mouseleave", startHidingRefHint);
        link.removeEventListener("mouseenter", resetHidingRefHint);
        link.removeEventListener("blur", startHidingRefHint);
        link.removeEventListener("focus", resetHidingRefHint);
        refHint.removeEventListener("mouseleave", startHidingRefHint);
        refHint.removeEventListener("mouseenter", resetHidingRefHint);
        refHint.removeEventListener("blur", startHidingRefHint);
        refHint.removeEventListener("focus", resetHidingRefHint);
    };
}

function positionRefHint(refHint) {
    const link = refHint.forLink;
    const linkPos = getBounds(link);
    refHint.style.top = linkPos.bottom + "px";
    refHint.style.left = linkPos.left + "px";

    const panelPos = refHint.getBoundingClientRect();
    const panelMargin = 8;
    const maxRight = document.body.parentNode.clientWidth - panelMargin;
    if (panelPos.right > maxRight) {
        const overflowAmount = panelPos.right - maxRight;
        const newLeft = Math.max(panelMargin, linkPos.left - overflowAmount);
        refHint.style.left = newLeft + "px";
    }
}

// TODO: shared util
// Returns the root-level absolute position {left and top} of element.
function getBounds(el, relativeTo=document.body) {
    const relativeRect = relativeTo.getBoundingClientRect();
    const elRect = el.getBoundingClientRect();
    const top = elRect.top - relativeRect.top;
    const left = elRect.left - relativeRect.left;
    return {
        top,
        left,
        bottom: top + elRect.height,
        right: left + elRect.width,
    }
}

function showRefHintListener(e) {
    // If the target isn't in a link (or is a link),
    // just ignore it.
    let link = e.target.closest("a");
    if(!link) return;

    // If the target is in a ref-hint panel
    // (aka a link in the already-open one),
    // also just ignore it.
    if(link.closest(".ref-hint")) return;

    // Otherwise, show the panel for the link.
    showRefHint(link);
}

function hideAllHintsListener(e) {
    // If the click is inside a ref-hint panel, ignore it.
    if(e.target.closest(".ref-hint")) return;
    // Otherwise, close all the current panels.
    hideAllRefHints();
}

document.addEventListener("DOMContentLoaded", () => {
    document.body.addEventListener("mousedown", showRefHintListener);
    document.body.addEventListener("focus", showRefHintListener);

    document.body.addEventListener("click", hideAllHintsListener);
});

window.addEventListener("resize", () => {
    // Hide any open ref hint.
    hideAllRefHints();
});
}
</script>