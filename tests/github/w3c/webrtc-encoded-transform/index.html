<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>WebRTC Encoded Transform</title>
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <link href="https://w3c.github.io/webrtc-encoded-transform/" rel="canonical">
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    min-width: min-content;
    max-width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">WebRTC Encoded Transform</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://w3c.github.io/webrtc-encoded-transform/">https://w3c.github.io/webrtc-encoded-transform/</a>
      <dt>Feedback:
      <dd><span><a href="mailto:public-webrtc@w3.org?subject=%5Bwebrtc-encoded-transform%5D%20YOUR%20TOPIC%20HERE">public-webrtc@w3.org</a> with subject line “<kbd>[webrtc-encoded-transform] <i data-lt>… message topic …</i></kbd>” (<a href="https://lists.w3.org/Archives/Public/public-webrtc/" rel="discussion">archives</a>)</span>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hta@google.com">Harald Alvestrand</a> (<a class="p-org org" href="https://google.com">Google</a>)
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:guidou@google.com">Guido Urdaneta</a> (<a class="p-org org" href="https://google.com">Google</a>)
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:youenn@apple.com">Youenn Fablet</a> (<a class="p-org org" href="https://www.apple.com">Apple</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This API defines an API surface for manipulating the bits on <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack" id="ref-for-dom-mediastreamtrack">MediaStreamTrack</a></code>s being sent via an <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection">RTCPeerConnection</a></code>.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This is a public copy of the editors’ draft.
	It is provided for discussion only and may change at any moment.
	Its publication here does not imply endorsement of its contents by W3C.
	Don’t cite this document other than as work in progress. </p>
   <p> If you wish to make comments regarding this document, please send them to <a href="mailto:public-webrtc@w3.org?Subject=%5Bwebrtc-encoded-transform%5D%20PUT%20SUBJECT%20HERE">public-webrtc@w3.org</a> (<a href="mailto:public-webrtc-request@w3.org?subject=subscribe">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/public-webrtc/">archives</a>).
	When sending e-mail,
	please put the text “webrtc-encoded-transform” in the subject,
	preferably like this:
	“[webrtc-encoded-transform] <em>…summary of comment…</em>”.
	All comments are welcome. </p>
   <p> This document was produced by the <a href="https://www.w3.org/groups/wg/webrtc">Web Real-Time Communications Working Group</a>. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/Consortium/Patent-Policy/">W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/2004/01/pp-impl/47318/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2021/Process-20211102/" id="w3c_process_revision">2 November 2021 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#terminology"><span class="secno">2</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#specification"><span class="secno">3</span> <span class="content">Specification</span></a>
     <ol class="toc">
      <li>
       <a href="#operation"><span class="secno">3.1</span> <span class="content">Extension operation</span></a>
       <ol class="toc">
        <li><a href="#stream-creation"><span class="secno">3.1.1</span> <span class="content">Stream creation</span></a>
        <li><a href="#stream-processing"><span class="secno">3.1.2</span> <span class="content">Stream processing</span></a>
       </ol>
      <li><a href="#attribute"><span class="secno">3.2</span> <span class="content">Extension attribute</span></a>
     </ol>
    <li>
     <a href="#sframe"><span class="secno">4</span> <span class="content">SFrameTransform</span></a>
     <ol class="toc">
      <li><a href="#sframe-transform-algorithm"><span class="secno">4.1</span> <span class="content">Algorithm</span></a>
      <li><a href="#sframe-transform-methods"><span class="secno">4.2</span> <span class="content">Methods</span></a>
     </ol>
    <li>
     <a href="#scriptTransform"><span class="secno">5</span> <span class="content">RTCRtpScriptTransform</span></a>
     <ol class="toc">
      <li><a href="#RTCRtpScriptTransform-operations"><span class="secno">5.1</span> <span class="content">Operations</span></a>
      <li><a href="#RTCRtpScriptTransformer-attributes"><span class="secno">5.2</span> <span class="content">Attributes</span></a>
     </ol>
    <li><a href="#privacy"><span class="secno">6</span> <span class="content">Privacy and security considerations</span></a>
    <li><a href="#examples"><span class="secno">7</span> <span class="content">Examples</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>The <a data-link-type="biblio" href="#biblio-webrtc-nv-use-cases" title="WebRTC Next Version Use Cases">[WEBRTC-NV-USE-CASES]</a> document describes several functions that
can only be achieved by access to media (requirements N20-N22),
including, but not limited to:</p>
   <ul>
    <li data-md>
     <p>Funny Hats</p>
    <li data-md>
     <p>Machine Learning</p>
    <li data-md>
     <p>Virtual Reality Gaming</p>
   </ul>
   <p>These use cases further require that processing can be done in worker
threads (requirement N23-N24).</p>
   <p>Furthermore, the "trusted JavaScript cloud conferencing" use case
requires such processing to be done on encoded media, not just the raw
media.</p>
   <p>This specification gives an interface inspired by <a data-link-type="biblio" href="#biblio-web-codecs" title="Web Codecs explainer">[WEB-CODECS]</a> to
provide access to such functionality while retaining the setup flow of
RTCPeerConnection.</p>
   <p>This iteration of the specification provides access to encoded media,
which is the output of the encoder part of a codec and the input to the
decoder part of a codec.</p>
   <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <h2 class="heading settled" data-level="3" id="specification"><span class="secno">3. </span><span class="content">Specification</span><a class="self-link" href="#specification"></a></h2>
   <p>The Streams definition doesn’t use WebIDL much, but the WebRTC spec does.
This specification shows the IDL extensions for WebRTC.</p>
   <p>It uses an extension to RTCConfiguration in order to notify the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection①">RTCPeerConnection</a></code> that insertable streams will be used, and uses
an additional API on <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender">RTCRtpSender</a></code> and <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver">RTCRtpReceiver</a></code> to
insert the processing into the pipeline.</p>
<pre class="idl highlight def">// New dictionary
<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-rtcinsertablestreams"><code><c- g>RTCInsertableStreams</c-></code></dfn> {
    <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream"><c- n>ReadableStream</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RTCInsertableStreams" data-dfn-type="dict-member" data-export data-type="ReadableStream " id="dom-rtcinsertablestreams-readable"><code><c- g>readable</c-></code></dfn>;
    <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream"><c- n>WritableStream</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RTCInsertableStreams" data-dfn-type="dict-member" data-export data-type="WritableStream " id="dom-rtcinsertablestreams-writable"><code><c- g>writable</c-></code></dfn>;
};

// New fields in RTCConfiguration
<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration" id="ref-for-dom-rtcconfiguration"><c- g>RTCConfiguration</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="RTCConfiguration" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-rtcconfiguration-encodedinsertablestreams"><code><c- g>encodedInsertableStreams</c-></code></dfn> = <c- b>false</c->;
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#sframetransform" id="ref-for-sframetransform"><c- n>SFrameTransform</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#rtcrtpscripttransform" id="ref-for-rtcrtpscripttransform"><c- n>RTCRtpScriptTransform</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-rtcrtptransform"><code><c- g>RTCRtpTransform</c-></code></dfn>;

// New methods for RTCRtpSender and RTCRtpReceiver
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender①"><c- g>RTCRtpSender</c-></a> {
    <a data-link-type="idl-name" href="#dictdef-rtcinsertablestreams" id="ref-for-dictdef-rtcinsertablestreams"><c- n>RTCInsertableStreams</c-></a> <a class="idl-code" data-link-type="method" href="#dom-rtcrtpsender-createencodedstreams" id="ref-for-dom-rtcrtpsender-createencodedstreams"><c- g>createEncodedStreams</c-></a>();
    <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-rtcrtptransform" id="ref-for-typedefdef-rtcrtptransform"><c- n>RTCRtpTransform</c-></a>? <a class="idl-code" data-link-type="attribute" data-type="RTCRtpTransform?" href="#dom-rtcrtpsender-transform" id="ref-for-dom-rtcrtpsender-transform"><c- g>transform</c-></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver①"><c- g>RTCRtpReceiver</c-></a> {
    <a data-link-type="idl-name" href="#dictdef-rtcinsertablestreams" id="ref-for-dictdef-rtcinsertablestreams①"><c- n>RTCInsertableStreams</c-></a> <dfn class="idl-code" data-dfn-for="RTCRtpReceiver" data-dfn-type="method" data-export data-lt="createEncodedStreams()" id="dom-rtcrtpreceiver-createencodedstreams"><code><c- g>createEncodedStreams</c-></code><a class="self-link" href="#dom-rtcrtpreceiver-createencodedstreams"></a></dfn>();
    <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-rtcrtptransform" id="ref-for-typedefdef-rtcrtptransform①"><c- n>RTCRtpTransform</c-></a>? <a class="idl-code" data-link-type="attribute" data-type="RTCRtpTransform?" href="#dom-rtcrtpsender-transform" id="ref-for-dom-rtcrtpsender-transform①"><c- g>transform</c-></a>;
};
</pre>
   <h3 class="heading settled" data-level="3.1" id="operation"><span class="secno">3.1. </span><span class="content">Extension operation</span><a class="self-link" href="#operation"></a></h3>
   <p>At the time when a codec is initialized as part of the encoder, and the
corresponding flag is set in the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection②">RTCPeerConnection</a></code>'s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration" id="ref-for-dom-rtcconfiguration①">RTCConfiguration</a></code> argument, ensure that the codec is disabled and produces no output.</p>
   <h4 class="heading settled" data-level="3.1.1" id="stream-creation"><span class="secno">3.1.1. </span><span class="content">Stream creation</span><a class="self-link" href="#stream-creation"></a></h4>
   <p>At construction of each <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender②">RTCRtpSender</a></code> or <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver②">RTCRtpReceiver</a></code>, run the following steps:</p>
   <ol>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a>.<code>[[Streams]]</code> to null.</p>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>.<code>[[transform]]</code> to null.</p>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>.<code>[[readable]]</code> to a new <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream①">ReadableStream</a></code>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up" id="ref-for-readablestream-set-up">Set up</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③">this</a>.<code>[[readable]]</code>. <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this④">this</a>.<code>[[readable]]</code> is provided frames using the <a data-link-type="dfn" href="#readencodeddata" id="ref-for-readencodeddata">readEncodedData</a> algorithm given <var>this</var> as parameter.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑤">this</a>.<code>[[readable]]</code>.<code>[[owner]]</code> to <var>this</var>.</p>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑥">this</a>.<code>[[writable]]</code> to a new <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream①">WritableStream</a></code>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up" id="ref-for-writablestream-set-up">Set up</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑦">this</a>.<code>[[writable]]</code> with its <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm" id="ref-for-writablestream-set-up-writealgorithm">writeAlgorithm</a> set to <a data-link-type="dfn" href="#writeencodeddata" id="ref-for-writeencodeddata">writeEncodedData</a> given <var>this</var> as parameter.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑧">this</a>.<code>[[writable]]</code>.<code>[[owner]]</code> to <var>this</var>.</p>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this⑨">this</a>.<code>[[pipeToController]]</code> to null.</p>
    <li data-md>
     <p>Initialize <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⓪">this</a>.<code>[[lastReceivedFrameTimestamp]]</code> to zero.</p>
    <li data-md>
     <p>If the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection③">RTCPeerConnection</a></code>'s configuration does not have <code class="idl"><a data-link-type="idl" href="#dom-rtcconfiguration-encodedinsertablestreams" id="ref-for-dom-rtcconfiguration-encodedinsertablestreams">encodedInsertableStreams</a></code> set to "true", <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">queue a task</a> to run the following steps:</p>
     <ol>
      <li data-md>
       <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①①">this</a>.<code>[[pipeToController]]</code> is not null, abort these steps.</p>
      <li data-md>
       <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①②">this</a>.<code>[[pipeToController]]</code> to a new <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortcontroller" id="ref-for-abortcontroller">AbortController</a></code>.</p>
      <li data-md>
       <p>Call <a href="https://streams.spec.whatwg.org/#readable-stream-pipe-to">pipeTo</a> with <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①③">this</a>.<code>[[readable]]</code>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①④">this</a>.<code>[[writable]]</code>, preventClose equal to true, preventAbort equal to true, preventCancel equal to true and <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑤">this</a>.<code>[[pipeToController]]</code>.signal.</p>
     </ol>
   </ol>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpSender" data-dfn-type="method" data-export id="dom-rtcrtpsender-createencodedstreams"><code>createEncodedStreams()</code></dfn> method steps are:</p>
   <ol>
    <li data-md>
     <p>If the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection" id="ref-for-dom-rtcpeerconnection④">RTCPeerConnection</a></code>'s configuration does not have <code class="idl"><a data-link-type="idl" href="#dom-rtcconfiguration-encodedinsertablestreams" id="ref-for-dom-rtcconfiguration-encodedinsertablestreams①">encodedInsertableStreams</a></code> set to "true", throw an "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror">InvalidAccessError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code> and abort these steps.</p>
    <li data-md>
     <p>If the data source does not permit access, throw an "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror①">InvalidAccessError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException①">DOMException</a></code> and abort these steps.</p>
    <li data-md>
     <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑥">this</a>.<code>[[Streams]]</code> is not null, throw an "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror②">InvalidAccessError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException②">DOMException</a></code>.</p>
    <li data-md>
     <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑦">this</a>.<code>[[pipeToController]]</code> is not null, throw an "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidaccesserror" id="ref-for-invalidaccesserror③">InvalidAccessError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException③">DOMException</a></code>.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑧">this</a>.<code>[[Streams]]</code> to an <code class="idl"><a data-link-type="idl" href="#dictdef-rtcinsertablestreams" id="ref-for-dictdef-rtcinsertablestreams②">RTCInsertableStreams</a></code> object.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①⑨">this</a>.<code>[[Streams]]</code>.<code class="idl"><a data-link-type="idl" href="#dom-rtcinsertablestreams-readable" id="ref-for-dom-rtcinsertablestreams-readable">readable</a></code> to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⓪">this</a>.<code>[[readable]]</code>.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②①">this</a>.<code>[[Streams]]</code>.<code class="idl"><a data-link-type="idl" href="#dom-rtcinsertablestreams-writable" id="ref-for-dom-rtcinsertablestreams-writable">writable</a></code> to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②②">this</a>.<code>[[writable]]</code>.</p>
    <li data-md>
     <p>Enable the encoded data source.</p>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②③">this</a>.<code>[[Streams]]</code>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.2" id="stream-processing"><span class="secno">3.1.2. </span><span class="content">Stream processing</span><a class="self-link" href="#stream-processing"></a></h4>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="readencodeddata">readEncodedData</dfn> algorithm is given a <var>rtcObject</var> as parameter. It is defined by running the following steps:</p>
   <ol>
    <li data-md>
     <p>Wait for a frame to be produced by <var>rtcObject</var>’s encoder if it is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender③">RTCRtpSender</a></code> or <var>rtcObject</var>’s packetizer if it is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver③">RTCRtpReceiver</a></code>.</p>
    <li data-md>
     <p>Let <var>frame</var> be the newly produced frame.</p>
    <li data-md>
     <p>Set <var>frame</var>.<code>[[owner]]</code> to <var>rtcObject</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-enqueue" id="ref-for-readablestream-enqueue">Enqueue</a> <var>frame</var> in <var>rtcObject</var>.<code>[[readable]]</code>.</p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="writeencodeddata">writeEncodedData</dfn> algorithm is given a <var>rtcObject</var> as parameter and a <var>frame</var> as input. It is defined by running the following steps:</p>
   <ol>
    <li data-md>
     <p>If <var>frame</var>.<code>[[owner]]</code> is not equal to <var>rtcObject</var>, abort these steps and return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with">a promise resolved with</a> undefined. A processor cannot create frames, or move frames between streams.</p>
    <li data-md>
     <p>If the <var>frame</var>’s <code class="idl"><a data-link-type="idl" href="#dom-rtcencodedvideoframe-timestamp" id="ref-for-dom-rtcencodedvideoframe-timestamp">timestamp</a></code> is equal to or larger than <var>rtcObject</var>.<code>[[lastReceivedFrameTimestamp]]</code>, abort these steps and return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①">a promise resolved with</a> undefined. A processor cannot reorder frames, although it may delay them or drop them.</p>
    <li data-md>
     <p>Set <var>rtcObject</var>.<code>[[lastReceivedFrameTimestamp]]</code> to the <var>frame</var>’s <code class="idl"><a data-link-type="idl" href="#dom-rtcencodedvideoframe-timestamp" id="ref-for-dom-rtcencodedvideoframe-timestamp①">timestamp</a></code>.</p>
    <li data-md>
     <p>Enqueue the frame for processing as if it came directly from the encoded data source, by running one of the following steps:</p>
     <ul>
      <li data-md>
       <p>If <var>rtcObject</var> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender④">RTCRtpSender</a></code>, enqueue it to <var>rtcObject</var>’s packetizer, to be processed <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>.</p>
      <li data-md>
       <p>If <var>rtcObject</var> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver④">RTCRtpReceiver</a></code>, enqueue it to <var>rtcObject</var>’s decoder, to be processed <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①">in parallel</a>.</p>
     </ul>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②">a promise resolved with</a> undefined.</p>
   </ol>
   <h3 class="heading settled" data-level="3.2" id="attribute"><span class="secno">3.2. </span><span class="content">Extension attribute</span><a class="self-link" href="#attribute"></a></h3>
   <p>A RTCRtpTransform has two private slots called <code>[[readable]]</code> and <code>[[writable]]</code>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpSender,RTCRtpReceiver" data-dfn-type="attribute" data-export id="dom-rtcrtpsender-transform"><code>transform</code></dfn> getter steps are:</p>
   <ol>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②④">this</a>.<code>[[transform]]</code>.</p>
   </ol>
   <p>The <code>transform</code> setter steps are:</p>
   <ol start="2">
    <li data-md>
     <p>Let <var>transform</var> be the argument to the setter.</p>
    <li data-md>
     <p>Let <var>checkedTransform</var> set to <var>transform</var> if it is not null or to an <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#identity-transform-stream" id="ref-for-identity-transform-stream">identity transform stream</a> otherwise.</p>
    <li data-md>
     <p>Let <var>reader</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-get-a-reader" id="ref-for-readablestream-get-a-reader">getting a reader</a> for <var>checkedTransform</var>.<code>[[readable]]</code>.</p>
    <li data-md>
     <p>Let <var>writer</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestream-get-a-writer" id="ref-for-writablestream-get-a-writer">getting a writer</a> for <var>checkedTransform</var>.<code>[[writable]]</code>.</p>
    <li data-md>
     <p>Initialize <var>newPipeToController</var> to a new <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortcontroller" id="ref-for-abortcontroller①">AbortController</a></code>.</p>
    <li data-md>
     <p>If <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑤">this</a>.<code>[[pipeToController]]</code> is not null, run the following steps:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#abortsignal-add" id="ref-for-abortsignal-add">Add</a> the <a data-link-type="dfn" href="#chain-transform-algorithm" id="ref-for-chain-transform-algorithm">chain transform algorithm</a> to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑥">this</a>.<code>[[pipeToController]]</code>.signal.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#abortsignal-signal-abort" id="ref-for-abortsignal-signal-abort">signal abort</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑦">this</a>.<code>[[pipeToController]]</code>.signal.</p>
     </ol>
    <li data-md>
     <p>Else, run the <a data-link-type="dfn" href="#chain-transform-algorithm" id="ref-for-chain-transform-algorithm①">chain transform algorithm</a> steps.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑧">this</a>.<code>[[pipeToController]]</code> to <var>newPipeToController</var>.</p>
    <li data-md>
     <p>Set <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②⑨">this</a>.<code>[[transform]]</code> to <var>transform</var>.</p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="chain-transform-algorithm">chain transform algorithm</dfn> steps are defined as:</p>
   <ol>
    <li data-md>
     <p>If <var>newPipeToController</var>’s <a data-link-type="dfn">aborted flag</a> is true, abort these steps.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-release" id="ref-for-readablestreamdefaultreader-release">Release</a> <var>reader</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#writablestreamdefaultwriter-release" id="ref-for-writablestreamdefaultwriter-release">Release</a> <var>writer</var>.</p>
    <li data-md>
     <p>Assert that <var>newPipeToController</var> is the same object as <var>rtcObject</var>.<code>[[pipeToController]]</code>.</p>
    <li data-md>
     <p>Call <a href="https://streams.spec.whatwg.org/#readable-stream-pipe-to">pipeTo</a> with <var>rtcObject</var>.<code>[[readable]]</code>, <var>checkedTransform</var>.<code>[[writable]]</code>, preventClose equal to false, preventAbort equal to false, preventCancel equal to true and <var>newPipeToController</var>.signal.</p>
    <li data-md>
     <p>Call <a href="https://streams.spec.whatwg.org/#readable-stream-pipe-to">pipeTo</a> with <var>checkedTransform</var>.<code>[[readable]]</code>, <var>rtcObject</var>.<code>[[writable]]</code>, preventClose equal to true, preventAbort equal to true, preventCancel equal to false and <var>newPipeToController</var>.signal.</p>
   </ol>
   <p>This algorithm is defined so that transforms can be updated dynamically.
There is no guarantee on which frame will happen the switch from the previous transform to the new transform.</p>
   <p>If a web application sets the transform synchronously at creation of the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender⑤">RTCRtpSender</a></code> (for instance when calling addTrack), the transform will receive the first frame generated by the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender⑥">RTCRtpSender</a></code>'s encoder.
Similarly, if a web application sets the transform synchronously at creation of the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver⑤">RTCRtpReceiver</a></code> (for instance when calling addTrack, or at track event handler), the transform will receive the first full frame generated by the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver⑥">RTCRtpReceiver</a></code>'s packetizer.</p>
   <h2 class="heading settled" data-level="4" id="sframe"><span class="secno">4. </span><span class="content">SFrameTransform</span><a class="self-link" href="#sframe"></a></h2>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-sframetransformrole"><code><c- g>SFrameTransformRole</c-></code></dfn> {
    <dfn class="idl-code" data-dfn-for="SFrameTransformRole" data-dfn-type="enum-value" data-export id="dom-sframetransformrole-encrypt"><code><c- s>"encrypt"</c-></code><a class="self-link" href="#dom-sframetransformrole-encrypt"></a></dfn>,
    <dfn class="idl-code" data-dfn-for="SFrameTransformRole" data-dfn-type="enum-value" data-export id="dom-sframetransformrole-decrypt"><code><c- s>"decrypt"</c-></code><a class="self-link" href="#dom-sframetransformrole-decrypt"></a></dfn>
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-sframetransformoptions"><code><c- g>SFrameTransformOptions</c-></code></dfn> {
    <a data-link-type="idl-name" href="#enumdef-sframetransformrole" id="ref-for-enumdef-sframetransformrole"><c- n>SFrameTransformRole</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;encrypt&quot;" data-dfn-for="SFrameTransformOptions" data-dfn-type="dict-member" data-export data-type="SFrameTransformRole " id="dom-sframetransformoptions-role"><code><c- g>role</c-></code></dfn> = "encrypt";
};

<c- b>typedef</c-> [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange" id="ref-for-EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-smallcryptokeyid"><code><c- g>SmallCryptoKeyID</c-></code></dfn>;
<c- b>typedef</c-> (<a data-link-type="idl-name" href="#typedefdef-smallcryptokeyid" id="ref-for-typedefdef-smallcryptokeyid"><c- n>SmallCryptoKeyID</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-bigint" id="ref-for-idl-bigint"><c- b>bigint</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-cryptokeyid"><code><c- g>CryptoKeyID</c-></code></dfn>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="sframetransform"><code><c- g>SFrameTransform</c-></code></dfn> {
    <a class="idl-code" data-link-type="constructor" href="#dom-sframetransform-sframetransform" id="ref-for-dom-sframetransform-sframetransform"><c- g>constructor</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sframetransformoptions" id="ref-for-dictdef-sframetransformoptions"><c- n>SFrameTransformOptions</c-></a> <dfn class="idl-code" data-dfn-for="SFrameTransform/SFrameTransform(options), SFrameTransform/constructor(options), SFrameTransform/SFrameTransform(), SFrameTransform/constructor()" data-dfn-type="argument" data-export id="dom-sframetransform-sframetransform-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-sframetransform-sframetransform-options-options"></a></dfn> = {});
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sframetransform-setencryptionkey" id="ref-for-dom-sframetransform-setencryptionkey"><c- g>setEncryptionKey</c-></a>(<a data-link-type="idl-name" href="https://w3c.github.io/webcrypto/#dfn-CryptoKey" id="ref-for-dfn-CryptoKey"><c- n>CryptoKey</c-></a> <dfn class="idl-code" data-dfn-for="SFrameTransform/setEncryptionKey(key, keyID), SFrameTransform/setEncryptionKey(key)" data-dfn-type="argument" data-export id="dom-sframetransform-setencryptionkey-key-keyid-key"><code><c- g>key</c-></code><a class="self-link" href="#dom-sframetransform-setencryptionkey-key-keyid-key"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#typedefdef-cryptokeyid" id="ref-for-typedefdef-cryptokeyid"><c- n>CryptoKeyID</c-></a> <dfn class="idl-code" data-dfn-for="SFrameTransform/setEncryptionKey(key, keyID), SFrameTransform/setEncryptionKey(key)" data-dfn-type="argument" data-export id="dom-sframetransform-setencryptionkey-key-keyid-keyid"><code><c- g>keyID</c-></code><a class="self-link" href="#dom-sframetransform-setencryptionkey-key-keyid-keyid"></a></dfn>);
};
<a data-link-type="idl-name" href="#sframetransform" id="ref-for-sframetransform①"><c- n>SFrameTransform</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#generictransformstream" id="ref-for-generictransformstream"><c- n>GenericTransformStream</c-></a>;
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="SFrameTransform" data-dfn-type="constructor" data-export data-lt="SFrameTransform(options)|constructor(options)|SFrameTransform()|constructor()" id="dom-sframetransform-sframetransform"><code>new SFrameTransform(<var>options</var>)</code></dfn> constructor steps are:</p>
   <ol>
    <li data-md>
     <p>Let <var>transformAlgorithm</var> be an algorithm which takes a <var>frame</var> as input and runs the <a href="#sframe-transform-algorithm">SFrame transform algorithm</a> with <var>this</var> and <var>frame</var>.</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[transform]]</code> to a new <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#transformstream" id="ref-for-transformstream">TransformStream</a></code>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-set-up" id="ref-for-readablestream-set-up①">Set up</a> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③⓪">this</a>.<code>[[transform]]</code> with <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#transformstream-set-up-transformalgorithm" id="ref-for-transformstream-set-up-transformalgorithm">transformAlgorithm</a> set to <var>transformAlgorithm</var>.</p>
    <li data-md>
     <p>Let <var>options</var> be the method’s first argument.</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[role]]</code> to <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-sframetransformoptions-role" id="ref-for-dom-sframetransformoptions-role">role</a></code>"].</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[readable]]</code> to <var>this</var>.<code>[[transform]]</code>.<code>[[readable]]</code>.</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[writable]]</code> to <var>this</var>.<code>[[transform]]</code>.<code>[[writable]]</code>.</p>
   </ol>
   <h3 class="heading settled" data-level="4.1" id="sframe-transform-algorithm"><span class="secno">4.1. </span><span class="content">Algorithm</span><a class="self-link" href="#sframe-transform-algorithm"></a></h3>
   <p>The SFrame transform algorithm, given <var>sframe</var> as a SFrameTransform object and <var>frame</var>, runs these steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>role</var> be <var>sframe</var>.<code>[[role]]</code>.</p>
    <li data-md>
     <p>If <var>frame</var>.<code>[[owner]]</code> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender" id="ref-for-dom-rtcrtpsender⑦">RTCRtpSender</a></code>, set <var>role</var> to 'encrypt'.</p>
    <li data-md>
     <p>If <var>frame</var>.<code>[[owner]]</code> is a <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver" id="ref-for-dom-rtcrtpreceiver⑦">RTCRtpReceiver</a></code>, set <var>role</var> to 'decrypt'.</p>
    <li data-md>
     <p>Let <var>data</var> be undefined.</p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#BufferSource" id="ref-for-BufferSource">BufferSource</a></code>, set <var>data</var> to <var>frame</var>.</p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="#rtcencodedaudioframe" id="ref-for-rtcencodedaudioframe">RTCEncodedAudioFrame</a></code>, set <var>data</var> to <var>frame</var>.<code class="idl"><a data-link-type="idl" href="#dom-rtcencodedaudioframe-data" id="ref-for-dom-rtcencodedaudioframe-data">data</a></code></p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="#rtcencodedvideoframe" id="ref-for-rtcencodedvideoframe">RTCEncodedVideoFrame</a></code>, set <var>data</var> to <var>frame</var>.<code class="idl"><a data-link-type="idl" href="#dom-rtcencodedvideoframe-data" id="ref-for-dom-rtcencodedvideoframe-data">data</a></code></p>
    <li data-md>
     <p>If <var>data</var> is undefined, abort these steps.</p>
    <li data-md>
     <p>Let <var>buffer</var> be the result of running the SFrame algorithm with <var>data</var> and <var>role</var> as parameters. This algorithm is defined by the <a href="https://datatracker.ietf.org/doc/draft-omara-sframe/">SFrame specification</a> and returns an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer">ArrayBuffer</a></code>.</p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#BufferSource" id="ref-for-BufferSource①">BufferSource</a></code>, set <var>frame</var> to <var>buffer</var>.</p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="#rtcencodedaudioframe" id="ref-for-rtcencodedaudioframe①">RTCEncodedAudioFrame</a></code>, set <var>frame</var>.<code class="idl"><a data-link-type="idl" href="#dom-rtcencodedaudioframe-data" id="ref-for-dom-rtcencodedaudioframe-data①">data</a></code> to <var>buffer</var>.</p>
    <li data-md>
     <p>If <var>frame</var> is a <code class="idl"><a data-link-type="idl" href="#rtcencodedvideoframe" id="ref-for-rtcencodedvideoframe①">RTCEncodedVideoFrame</a></code>, set <var>frame</var>.<code class="idl"><a data-link-type="idl" href="#dom-rtcencodedvideoframe-data" id="ref-for-dom-rtcencodedvideoframe-data①">data</a></code> to <var>buffer</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-enqueue" id="ref-for-readablestream-enqueue①">Enqueue</a> <var>frame</var> in <var>sframe</var>.<code>[[transform]]</code>.</p>
   </ol>
   <h3 class="heading settled" data-level="4.2" id="sframe-transform-methods"><span class="secno">4.2. </span><span class="content">Methods</span><a class="self-link" href="#sframe-transform-methods"></a></h3>
    The <dfn class="dfn-paneled idl-code" data-dfn-for="SFrameTransform" data-dfn-type="method" data-export data-lt="setEncryptionKey(key, keyID)|setEncryptionKey(key)" id="dom-sframetransform-setencryptionkey"><code>setEncryptionKey(<var>key</var>, <var>keyID</var>)</code></dfn> method steps are: 
   <ol>
    <li data-md>
     <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise">a new promise</a>.</p>
    <li data-md>
     <p>If <var>keyID</var> is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-bigint" id="ref-for-idl-bigint①">bigint</a></code> which cannot be represented as a integer between 0 and 2<sup>64</sup>-1 inclusive, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror">RangeError</a></code> exception.</p>
    <li data-md>
     <p>Otherwise, <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel②">in parallel</a>, run the following steps:</p>
     <ol>
      <li data-md>
       <p>Set <var>key</var> with its optional <var>keyID</var> as key material to use for the SFrame transform algorithm, as defined by the <a href="https://datatracker.ietf.org/doc/draft-omara-sframe/">SFrame specification</a>.</p>
      <li data-md>
       <p>If setting the key material fails, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①">reject</a> <var>promise</var> with an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidmodificationerror" id="ref-for-invalidmodificationerror">InvalidModificationError</a></code> exception and abort these steps.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">Resolve</a> <var>promise</var> with undefined.</p>
     </ol>
    <li data-md>
     <p>Return <var>promise</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="5" id="scriptTransform"><span class="secno">5. </span><span class="content">RTCRtpScriptTransform</span><a class="self-link" href="#scriptTransform"></a></h2>
<pre class="idl highlight def">// New enum for video frame types. Will eventually re-use the equivalent defined
// by WebCodecs.
<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-rtcencodedvideoframetype"><code><c- g>RTCEncodedVideoFrameType</c-></code></dfn> {
    <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameType" data-dfn-type="enum-value" data-export id="dom-rtcencodedvideoframetype-empty"><code><c- s>"empty"</c-></code><a class="self-link" href="#dom-rtcencodedvideoframetype-empty"></a></dfn>,
    <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameType" data-dfn-type="enum-value" data-export id="dom-rtcencodedvideoframetype-key"><code><c- s>"key"</c-></code><a class="self-link" href="#dom-rtcencodedvideoframetype-key"></a></dfn>,
    <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameType" data-dfn-type="enum-value" data-export id="dom-rtcencodedvideoframetype-delta"><code><c- s>"delta"</c-></code><a class="self-link" href="#dom-rtcencodedvideoframetype-delta"></a></dfn>,
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-rtcencodedvideoframemetadata"><code><c- g>RTCEncodedVideoFrameMetadata</c-></code></dfn> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="long long " id="dom-rtcencodedvideoframemetadata-frameid"><code><c- g>frameId</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-frameid"></a></dfn>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long" id="ref-for-idl-long-long①"><c- b>long</c-> <c- b>long</c-></a>> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="sequence<long long> " id="dom-rtcencodedvideoframemetadata-dependencies"><code><c- g>dependencies</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-dependencies"></a></dfn>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="unsigned short " id="dom-rtcencodedvideoframemetadata-width"><code><c- g>width</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-width"></a></dfn>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short" id="ref-for-idl-unsigned-short①"><c- b>unsigned</c-> <c- b>short</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="unsigned short " id="dom-rtcencodedvideoframemetadata-height"><code><c- g>height</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-height"></a></dfn>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long"><c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="long " id="dom-rtcencodedvideoframemetadata-spatialindex"><code><c- g>spatialIndex</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-spatialindex"></a></dfn>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long①"><c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="long " id="dom-rtcencodedvideoframemetadata-temporalindex"><code><c- g>temporalIndex</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-temporalindex"></a></dfn>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long②"><c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="long " id="dom-rtcencodedvideoframemetadata-synchronizationsource"><code><c- g>synchronizationSource</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-synchronizationsource"></a></dfn>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence①"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long③"><c- b>long</c-></a>> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrameMetadata" data-dfn-type="dict-member" data-export data-type="sequence<long> " id="dom-rtcencodedvideoframemetadata-contributingsources"><code><c- g>contributingSources</c-></code><a class="self-link" href="#dom-rtcencodedvideoframemetadata-contributingsources"></a></dfn>;
};

// New interfaces to define encoded video and audio frames. Will eventually
// re-use or extend the equivalent defined in WebCodecs.
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="rtcencodedvideoframe"><code><c- g>RTCEncodedVideoFrame</c-></code></dfn> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-rtcencodedvideoframetype" id="ref-for-enumdef-rtcencodedvideoframetype"><c- n>RTCEncodedVideoFrameType</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrame" data-dfn-type="attribute" data-export data-readonly data-type="RTCEncodedVideoFrameType" id="dom-rtcencodedvideoframe-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-rtcencodedvideoframe-type"></a></dfn>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RTCEncodedVideoFrame" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long long" id="dom-rtcencodedvideoframe-timestamp"><code><c- g>timestamp</c-></code></dfn>;
    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer①"><c- b>ArrayBuffer</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RTCEncodedVideoFrame" data-dfn-type="attribute" data-export data-type="ArrayBuffer" id="dom-rtcencodedvideoframe-data"><code><c- g>data</c-></code></dfn>;
    <a data-link-type="idl-name" href="#dictdef-rtcencodedvideoframemetadata" id="ref-for-dictdef-rtcencodedvideoframemetadata"><c- n>RTCEncodedVideoFrameMetadata</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedVideoFrame" data-dfn-type="method" data-export data-lt="getMetadata()" id="dom-rtcencodedvideoframe-getmetadata"><code><c- g>getMetadata</c-></code><a class="self-link" href="#dom-rtcencodedvideoframe-getmetadata"></a></dfn>();
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-rtcencodedaudioframemetadata"><code><c- g>RTCEncodedAudioFrameMetadata</c-></code></dfn> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long④"><c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedAudioFrameMetadata" data-dfn-type="dict-member" data-export data-type="long " id="dom-rtcencodedaudioframemetadata-synchronizationsource"><code><c- g>synchronizationSource</c-></code><a class="self-link" href="#dom-rtcencodedaudioframemetadata-synchronizationsource"></a></dfn>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence②"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long" id="ref-for-idl-long⑤"><c- b>long</c-></a>> <dfn class="idl-code" data-dfn-for="RTCEncodedAudioFrameMetadata" data-dfn-type="dict-member" data-export data-type="sequence<long> " id="dom-rtcencodedaudioframemetadata-contributingsources"><code><c- g>contributingSources</c-></code><a class="self-link" href="#dom-rtcencodedaudioframemetadata-contributingsources"></a></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="rtcencodedaudioframe"><code><c- g>RTCEncodedAudioFrame</c-></code></dfn> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long②"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedAudioFrame" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long long" id="dom-rtcencodedaudioframe-timestamp"><code><c- g>timestamp</c-></code><a class="self-link" href="#dom-rtcencodedaudioframe-timestamp"></a></dfn>;
    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer②"><c- b>ArrayBuffer</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="RTCEncodedAudioFrame" data-dfn-type="attribute" data-export data-type="ArrayBuffer" id="dom-rtcencodedaudioframe-data"><code><c- g>data</c-></code></dfn>;
    <a data-link-type="idl-name" href="#dictdef-rtcencodedaudioframemetadata" id="ref-for-dictdef-rtcencodedaudioframemetadata"><c- n>RTCEncodedAudioFrameMetadata</c-></a> <dfn class="idl-code" data-dfn-for="RTCEncodedAudioFrame" data-dfn-type="method" data-export data-lt="getMetadata()" id="dom-rtcencodedaudioframe-getmetadata"><code><c- g>getMetadata</c-></code><a class="self-link" href="#dom-rtcencodedaudioframe-getmetadata"></a></dfn>();
};


// New interfaces to expose JavaScript-based transforms.

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="rtctransformevent"><code><c- g>RTCTransformEvent</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event" id="ref-for-event"><c- n>Event</c-></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#rtcrtpscripttransformer" id="ref-for-rtcrtpscripttransformer"><c- n>RTCRtpScriptTransformer</c-></a> <dfn class="idl-code" data-dfn-for="RTCTransformEvent" data-dfn-type="attribute" data-export data-readonly data-type="RTCRtpScriptTransformer" id="dom-rtctransformevent-transformer"><code><c- g>transformer</c-></code><a class="self-link" href="#dom-rtctransformevent-transformer"></a></dfn>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope" id="ref-for-dedicatedworkerglobalscope"><c- g>DedicatedWorkerGlobalScope</c-></a> {
    <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <dfn class="idl-code" data-dfn-for="DedicatedWorkerGlobalScope" data-dfn-type="attribute" data-export data-type="EventHandler" id="dom-dedicatedworkerglobalscope-onrtctransform"><code><c- g>onrtctransform</c-></code><a class="self-link" href="#dom-dedicatedworkerglobalscope-onrtctransform"></a></dfn>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="rtcrtpscripttransformer"><code><c- g>RTCRtpScriptTransformer</c-></code></dfn> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream②"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-rtcrtpscripttransformer-readable" id="ref-for-dom-rtcrtpscripttransformer-readable"><c- g>readable</c-></a>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream" id="ref-for-writablestream②"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-rtcrtpscripttransformer-writable" id="ref-for-dom-rtcrtpscripttransformer-writable"><c- g>writable</c-></a>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="any" href="#dom-rtcrtpscripttransformer-options" id="ref-for-dom-rtcrtpscripttransformer-options"><c- g>options</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="rtcrtpscripttransform"><code><c- g>RTCRtpScriptTransform</c-></code></dfn> {
    <a class="idl-code" data-link-type="constructor" href="#dom-rtcrtpscripttransform-rtcrtpscripttransform" id="ref-for-dom-rtcrtpscripttransform-rtcrtpscripttransform"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#worker" id="ref-for-worker"><c- n>Worker</c-></a> <dfn class="idl-code" data-dfn-for="RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options, transfer), RTCRtpScriptTransform/constructor(worker, options, transfer), RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options), RTCRtpScriptTransform/constructor(worker, options), RTCRtpScriptTransform/RTCRtpScriptTransform(worker), RTCRtpScriptTransform/constructor(worker)" data-dfn-type="argument" data-export id="dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-worker"><code><c- g>worker</c-></code><a class="self-link" href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-worker"></a></dfn>, <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any" id="ref-for-idl-any①"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options, transfer), RTCRtpScriptTransform/constructor(worker, options, transfer), RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options), RTCRtpScriptTransform/constructor(worker, options), RTCRtpScriptTransform/RTCRtpScriptTransform(worker), RTCRtpScriptTransform/constructor(worker)" data-dfn-type="argument" data-export id="dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-options"></a></dfn>, <c- b>optional</c-> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence" id="ref-for-idl-sequence③"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a>> <dfn class="idl-code" data-dfn-for="RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options, transfer), RTCRtpScriptTransform/constructor(worker, options, transfer), RTCRtpScriptTransform/RTCRtpScriptTransform(worker, options), RTCRtpScriptTransform/constructor(worker, options), RTCRtpScriptTransform/RTCRtpScriptTransform(worker), RTCRtpScriptTransform/constructor(worker)" data-dfn-type="argument" data-export id="dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-transfer"><code><c- g>transfer</c-></code><a class="self-link" href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-transfer"></a></dfn>);
};
</pre>
   <h3 class="heading settled" data-level="5.1" id="RTCRtpScriptTransform-operations"><span class="secno">5.1. </span><span class="content">Operations</span><a class="self-link" href="#RTCRtpScriptTransform-operations"></a></h3>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpScriptTransform" data-dfn-type="constructor" data-export data-lt="RTCRtpScriptTransform(worker, options, transfer)|constructor(worker, options, transfer)|RTCRtpScriptTransform(worker, options)|constructor(worker, options)|RTCRtpScriptTransform(worker)|constructor(worker)" id="dom-rtcrtpscripttransform-rtcrtpscripttransform"><code>new RTCRtpScriptTransform(<var>worker</var>, <var>options</var>, <var>transfer</var>)</code></dfn> constructor steps are:</p>
   <ol>
    <li data-md>
     <p>Set <var>t1</var> to an <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#identity-transform-stream" id="ref-for-identity-transform-stream①">identity transform stream</a>.</p>
    <li data-md>
     <p>Set <var>t2</var> to an <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#identity-transform-stream" id="ref-for-identity-transform-stream②">identity transform stream</a>.</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[writable]]</code> to <var>t1</var>.<code>[[writable]]</code>.</p>
    <li data-md>
     <p>Set <var>this</var>.<code>[[readable]]</code> to <var>t2</var>.<code>[[readable]]</code>.</p>
    <li data-md>
     <p>Let <var>serializedOptions</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer">StructuredSerializeWithTransfer</a>(<var>options</var>, <var>transfer</var>).</p>
    <li data-md>
     <p>Let <var>serializedReadable</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer①">StructuredSerializeWithTransfer</a>(<var>t1</var>.<code>[[readable]]</code>, « <var>t1</var>.<code>[[readable]]</code> »).</p>
    <li data-md>
     <p>Let <var>serializedWritable</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer②">StructuredSerializeWithTransfer</a>(<var>t2</var>.<code>[[writable]]</code>, « <var>t2</var>.<code>[[writable]]</code> »).</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task①">Queue a task</a> on the DOM manipulation <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source" id="ref-for-task-source">task source</a> <var>worker</var>’s global scope to run the following steps:</p>
     <ol>
      <li data-md>
       <p>Let <var>transformerOptions</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize" id="ref-for-structureddeserialize">StructuredDeserialize</a>(<var>serializedOptions</var>, the current Realm).</p>
      <li data-md>
       <p>Let <var>readable</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize" id="ref-for-structureddeserialize①">StructuredDeserialize</a>(<var>serializedReadable</var>, the current Realm).</p>
      <li data-md>
       <p>Let <var>writable</var> be the result of <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize" id="ref-for-structureddeserialize②">StructuredDeserialize</a>(<var>serializedWritable</var>, the current Realm).</p>
      <li data-md>
       <p>Let <var>transformer</var> be a new <code class="idl"><a data-link-type="idl" href="#rtcrtpscripttransformer" id="ref-for-rtcrtpscripttransformer①">RTCRtpScriptTransformer</a></code>.</p>
      <li data-md>
       <p>Set <var>transformer</var>.<code>[[options]]</code> to <var>transformerOptions</var>.</p>
      <li data-md>
       <p>Set <var>transformer</var>.<code>[[readable]]</code> to <var>readable</var>.</p>
      <li data-md>
       <p>Set <var>transformer</var>.<code>[[writable]]</code> to <var>writable</var>.</p>
      <li data-md>
       <p>Let <var>event</var> be the result of <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-create" id="ref-for-concept-event-create">creating an event</a> with <code class="idl"><a data-link-type="idl" href="#rtctransformevent" id="ref-for-rtctransformevent">RTCTransformEvent</a></code>.</p>
      <li data-md>
       <p>Set <var>event</var>.type attribute to "rtctransform".</p>
      <li data-md>
       <p>Set <var>event</var>.transformer to <var>transformer</var>.</p>
      <li data-md>
       <p>Dispatch <var>event</var> on <var>worker</var>’s global scope.</p>
     </ol>
   </ol>
   <p>// FIXME: Describe error handling (worker closing flag true at RTCRtpScriptTransform creation time. And worker being terminated while transform is processing data).</p>
   <h3 class="heading settled" data-level="5.2" id="RTCRtpScriptTransformer-attributes"><span class="secno">5.2. </span><span class="content">Attributes</span><a class="self-link" href="#RTCRtpScriptTransformer-attributes"></a></h3>
   <p>A RTCRtpScriptTransformer has three private slots called <code>[[options]]</code>, <code>[[readable]]</code> and <code>[[writable]]</code>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpScriptTransformer" data-dfn-type="attribute" data-export id="dom-rtcrtpscripttransformer-options"><code>options</code></dfn> getter steps are:</p>
   <ol>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③①">this</a>.<code>[[options]]</code>.</p>
   </ol>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpScriptTransformer" data-dfn-type="attribute" data-export id="dom-rtcrtpscripttransformer-readable"><code>readable</code></dfn> getter steps are:</p>
   <ol>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③②">this</a>.<code>[[readable]]</code>.</p>
   </ol>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="RTCRtpScriptTransformer" data-dfn-type="attribute" data-export id="dom-rtcrtpscripttransformer-writable"><code>writable</code></dfn> getter steps are:</p>
   <ol>
    <li data-md>
     <p>Return <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this③③">this</a>.<code>[[writable]]</code>.</p>
   </ol>
   <h2 class="heading settled" data-level="6" id="privacy"><span class="secno">6. </span><span class="content">Privacy and security considerations</span><a class="self-link" href="#privacy"></a></h2>
   <p>This API gives Javascript access to the content of media streams. This
is also available from other sources, such as Canvas and WebAudio.</p>
   <p>However, streams that are isolated (as specified in <a data-link-type="biblio" href="#biblio-webrtc-identity" title="Identity for WebRTC 1.0">[WEBRTC-IDENTITY]</a>) or tainted with another origin, cannot be
accessed using this API, since that would break the isolation rule.</p>
   <p>The API will allow access to some aspects of timing information that are
otherwise unavailable, which allows some fingerprinting surface.</p>
   <h2 class="heading settled" data-level="7" id="examples"><span class="secno">7. </span><span class="content">Examples</span><a class="self-link" href="#examples"></a></h2>
   <p>See the <a href="https://github.com/w3c/webrtc-encoded-transform/blob/master/explainer.md#code-examples">explainer document</a>.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#chain-transform-algorithm">chain transform algorithm</a><span>, in § 3.2</span>
   <li><a href="#dom-sframetransform-sframetransform">constructor()</a><span>, in § 4</span>
   <li><a href="#dom-sframetransform-sframetransform">constructor(options)</a><span>, in § 4</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">constructor(worker)</a><span>, in § 5.1</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">constructor(worker, options)</a><span>, in § 5.1</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">constructor(worker, options, transfer)</a><span>, in § 5.1</span>
   <li>
    contributingSources
    <ul>
     <li><a href="#dom-rtcencodedaudioframemetadata-contributingsources">dict-member for RTCEncodedAudioFrameMetadata</a><span>, in § 5</span>
     <li><a href="#dom-rtcencodedvideoframemetadata-contributingsources">dict-member for RTCEncodedVideoFrameMetadata</a><span>, in § 5</span>
    </ul>
   <li>
    createEncodedStreams()
    <ul>
     <li><a href="#dom-rtcrtpreceiver-createencodedstreams">method for RTCRtpReceiver</a><span>, in § 3</span>
     <li><a href="#dom-rtcrtpsender-createencodedstreams">method for RTCRtpSender</a><span>, in § 3.1.1</span>
    </ul>
   <li><a href="#typedefdef-cryptokeyid">CryptoKeyID</a><span>, in § 4</span>
   <li>
    data
    <ul>
     <li><a href="#dom-rtcencodedaudioframe-data">attribute for RTCEncodedAudioFrame</a><span>, in § 5</span>
     <li><a href="#dom-rtcencodedvideoframe-data">attribute for RTCEncodedVideoFrame</a><span>, in § 5</span>
    </ul>
   <li><a href="#dom-sframetransformrole-decrypt">"decrypt"</a><span>, in § 4</span>
   <li><a href="#dom-rtcencodedvideoframetype-delta">"delta"</a><span>, in § 5</span>
   <li><a href="#dom-rtcencodedvideoframemetadata-dependencies">dependencies</a><span>, in § 5</span>
   <li><a href="#dom-rtcencodedvideoframetype-empty">"empty"</a><span>, in § 5</span>
   <li><a href="#dom-rtcconfiguration-encodedinsertablestreams">encodedInsertableStreams</a><span>, in § 3</span>
   <li><a href="#dom-sframetransformrole-encrypt">"encrypt"</a><span>, in § 4</span>
   <li><a href="#dom-rtcencodedvideoframemetadata-frameid">frameId</a><span>, in § 5</span>
   <li>
    getMetadata()
    <ul>
     <li><a href="#dom-rtcencodedaudioframe-getmetadata">method for RTCEncodedAudioFrame</a><span>, in § 5</span>
     <li><a href="#dom-rtcencodedvideoframe-getmetadata">method for RTCEncodedVideoFrame</a><span>, in § 5</span>
    </ul>
   <li><a href="#dom-rtcencodedvideoframemetadata-height">height</a><span>, in § 5</span>
   <li><a href="#dom-rtcencodedvideoframetype-key">"key"</a><span>, in § 5</span>
   <li><a href="#dom-dedicatedworkerglobalscope-onrtctransform">onrtctransform</a><span>, in § 5</span>
   <li><a href="#dom-rtcrtpscripttransformer-options">options</a><span>, in § 5.2</span>
   <li>
    readable
    <ul>
     <li><a href="#dom-rtcrtpscripttransformer-readable">attribute for RTCRtpScriptTransformer</a><span>, in § 5.2</span>
     <li><a href="#dom-rtcinsertablestreams-readable">dict-member for RTCInsertableStreams</a><span>, in § 3</span>
    </ul>
   <li><a href="#readencodeddata">readEncodedData</a><span>, in § 3.1.2</span>
   <li><a href="#dom-sframetransformoptions-role">role</a><span>, in § 4</span>
   <li><a href="#rtcencodedaudioframe">RTCEncodedAudioFrame</a><span>, in § 5</span>
   <li><a href="#dictdef-rtcencodedaudioframemetadata">RTCEncodedAudioFrameMetadata</a><span>, in § 5</span>
   <li><a href="#rtcencodedvideoframe">RTCEncodedVideoFrame</a><span>, in § 5</span>
   <li><a href="#dictdef-rtcencodedvideoframemetadata">RTCEncodedVideoFrameMetadata</a><span>, in § 5</span>
   <li><a href="#enumdef-rtcencodedvideoframetype">RTCEncodedVideoFrameType</a><span>, in § 5</span>
   <li><a href="#dictdef-rtcinsertablestreams">RTCInsertableStreams</a><span>, in § 3</span>
   <li><a href="#rtcrtpscripttransform">RTCRtpScriptTransform</a><span>, in § 5</span>
   <li><a href="#rtcrtpscripttransformer">RTCRtpScriptTransformer</a><span>, in § 5</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">RTCRtpScriptTransform(worker)</a><span>, in § 5.1</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">RTCRtpScriptTransform(worker, options)</a><span>, in § 5.1</span>
   <li><a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform">RTCRtpScriptTransform(worker, options, transfer)</a><span>, in § 5.1</span>
   <li><a href="#typedefdef-rtcrtptransform">RTCRtpTransform</a><span>, in § 3</span>
   <li><a href="#rtctransformevent">RTCTransformEvent</a><span>, in § 5</span>
   <li><a href="#dom-sframetransform-setencryptionkey">setEncryptionKey(key)</a><span>, in § 4.2</span>
   <li><a href="#dom-sframetransform-setencryptionkey">setEncryptionKey(key, keyID)</a><span>, in § 4.2</span>
   <li><a href="#sframetransform">SFrameTransform</a><span>, in § 4</span>
   <li><a href="#dom-sframetransform-sframetransform">SFrameTransform()</a><span>, in § 4</span>
   <li><a href="#dom-sframetransform-sframetransform">SFrameTransform(options)</a><span>, in § 4</span>
   <li><a href="#dictdef-sframetransformoptions">SFrameTransformOptions</a><span>, in § 4</span>
   <li><a href="#enumdef-sframetransformrole">SFrameTransformRole</a><span>, in § 4</span>
   <li><a href="#typedefdef-smallcryptokeyid">SmallCryptoKeyID</a><span>, in § 4</span>
   <li><a href="#dom-rtcencodedvideoframemetadata-spatialindex">spatialIndex</a><span>, in § 5</span>
   <li>
    synchronizationSource
    <ul>
     <li><a href="#dom-rtcencodedaudioframemetadata-synchronizationsource">dict-member for RTCEncodedAudioFrameMetadata</a><span>, in § 5</span>
     <li><a href="#dom-rtcencodedvideoframemetadata-synchronizationsource">dict-member for RTCEncodedVideoFrameMetadata</a><span>, in § 5</span>
    </ul>
   <li><a href="#dom-rtcencodedvideoframemetadata-temporalindex">temporalIndex</a><span>, in § 5</span>
   <li>
    timestamp
    <ul>
     <li><a href="#dom-rtcencodedaudioframe-timestamp">attribute for RTCEncodedAudioFrame</a><span>, in § 5</span>
     <li><a href="#dom-rtcencodedvideoframe-timestamp">attribute for RTCEncodedVideoFrame</a><span>, in § 5</span>
    </ul>
   <li><a href="#dom-rtcrtpsender-transform">transform</a><span>, in § 3.2</span>
   <li><a href="#dom-rtctransformevent-transformer">transformer</a><span>, in § 5</span>
   <li><a href="#dom-rtcencodedvideoframe-type">type</a><span>, in § 5</span>
   <li><a href="#dom-rtcencodedvideoframemetadata-width">width</a><span>, in § 5</span>
   <li>
    writable
    <ul>
     <li><a href="#dom-rtcrtpscripttransformer-writable">attribute for RTCRtpScriptTransformer</a><span>, in § 5.2</span>
     <li><a href="#dom-rtcinsertablestreams-writable">dict-member for RTCInsertableStreams</a><span>, in § 3</span>
    </ul>
   <li><a href="#writeencodeddata">writeEncodedData</a><span>, in § 3.1.2</span>
  </ul>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['c39ea07f9fe7582ab58785f52bb2fb22'] = {'external': 1, 'id': 'c39ea07f9fe7582ab58785f52bb2fb22', 'url': 'https://dom.spec.whatwg.org/#abortcontroller', 'dfnText': 'AbortController', 'items': [{'ids': [{'linkID': 'ref-for-abortcontroller'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-abortcontroller①'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['316772b0029bcc028521d2db08fd3717'] = {'external': 1, 'id': '316772b0029bcc028521d2db08fd3717', 'url': 'https://dom.spec.whatwg.org/#event', 'dfnText': 'Event', 'items': [{'ids': [{'linkID': 'ref-for-event'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['ea86cd4a0dc314bc1093a2d0542c4364'] = {'external': 1, 'id': 'ea86cd4a0dc314bc1093a2d0542c4364', 'url': 'https://dom.spec.whatwg.org/#abortsignal-add', 'dfnText': 'add', 'items': [{'ids': [{'linkID': 'ref-for-abortsignal-add'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['c61f62a5312ce36419c5f6fe20f0d28b'] = {'external': 1, 'id': 'c61f62a5312ce36419c5f6fe20f0d28b', 'url': 'https://dom.spec.whatwg.org/#concept-event-create', 'dfnText': 'creating an event', 'items': [{'ids': [{'linkID': 'ref-for-concept-event-create'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['456092ef045c1559d107ee10841febd3'] = {'external': 1, 'id': '456092ef045c1559d107ee10841febd3', 'url': 'https://dom.spec.whatwg.org/#abortsignal-signal-abort', 'dfnText': 'signal abort', 'items': [{'ids': [{'linkID': 'ref-for-abortsignal-signal-abort'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['c0abb72a4aa2f971e990a7517b81e62a'] = {'external': 1, 'id': 'c0abb72a4aa2f971e990a7517b81e62a', 'url': 'https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope', 'dfnText': 'DedicatedWorkerGlobalScope', 'items': [{'ids': [{'linkID': 'ref-for-dedicatedworkerglobalscope'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['716703f1068cc638b4235f83154eff6c'] = {'external': 1, 'id': '716703f1068cc638b4235f83154eff6c', 'url': 'https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler', 'dfnText': 'EventHandler', 'items': [{'ids': [{'linkID': 'ref-for-eventhandler'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['7a7e704e0b3deedb2e838a06d27f740e'] = {'external': 1, 'id': '7a7e704e0b3deedb2e838a06d27f740e', 'url': 'https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize', 'dfnText': 'StructuredDeserialize', 'items': [{'ids': [{'linkID': 'ref-for-structureddeserialize'}, {'linkID': 'ref-for-structureddeserialize①'}, {'linkID': 'ref-for-structureddeserialize②'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['15aa28a5ee77adc5228b4fede60e07d5'] = {'external': 1, 'id': '15aa28a5ee77adc5228b4fede60e07d5', 'url': 'https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer', 'dfnText': 'StructuredSerializeWithTransfer', 'items': [{'ids': [{'linkID': 'ref-for-structuredserializewithtransfer'}, {'linkID': 'ref-for-structuredserializewithtransfer①'}, {'linkID': 'ref-for-structuredserializewithtransfer②'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['1875387458fa6e1450bbb7f8999f1636'] = {'external': 1, 'id': '1875387458fa6e1450bbb7f8999f1636', 'url': 'https://html.spec.whatwg.org/multipage/workers.html#worker', 'dfnText': 'Worker', 'items': [{'ids': [{'linkID': 'ref-for-worker'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['3a2763fcaa6bc82693554cf36780c0dd'] = {'external': 1, 'id': '3a2763fcaa6bc82693554cf36780c0dd', 'url': 'https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel', 'dfnText': 'in parallel', 'items': [{'ids': [{'linkID': 'ref-for-in-parallel'}, {'linkID': 'ref-for-in-parallel①'}], 'text': '3.1.2. Stream processing'}, {'ids': [{'linkID': 'ref-for-in-parallel②'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['da7ed5f190c4eedd375552d6f7876301'] = {'external': 1, 'id': 'da7ed5f190c4eedd375552d6f7876301', 'url': 'https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task', 'dfnText': 'queue a task', 'items': [{'ids': [{'linkID': 'ref-for-queue-a-task'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-queue-a-task①'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['8022a5f0b9910c35c5215fd070e93d09'] = {'external': 1, 'id': '8022a5f0b9910c35c5215fd070e93d09', 'url': 'https://html.spec.whatwg.org/multipage/webappapis.html#task-source', 'dfnText': 'task source', 'items': [{'ids': [{'linkID': 'ref-for-task-source'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['084e04016dd179bec71e0192f72becac'] = {'external': 1, 'id': '084e04016dd179bec71e0192f72becac', 'url': 'https://w3c.github.io/mediacapture-main/#dom-mediastreamtrack', 'dfnText': 'MediaStreamTrack', 'items': [{'ids': [{'linkID': 'ref-for-dom-mediastreamtrack'}], 'text': 'Unnumbered Section'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['e83c66cb38107c7fbcbc7b74c2dd9ace'] = {'external': 1, 'id': 'e83c66cb38107c7fbcbc7b74c2dd9ace', 'url': 'https://streams.spec.whatwg.org/#generictransformstream', 'dfnText': 'GenericTransformStream', 'items': [{'ids': [{'linkID': 'ref-for-generictransformstream'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['66e5f618a6e13b8af5a3bb1a7bcb3923'] = {'external': 1, 'id': '66e5f618a6e13b8af5a3bb1a7bcb3923', 'url': 'https://streams.spec.whatwg.org/#readablestream', 'dfnText': 'ReadableStream', 'items': [{'ids': [{'linkID': 'ref-for-readablestream'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-readablestream①'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-readablestream②'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['b74000861e16cac48f4f5e5fd3672a51'] = {'external': 1, 'id': 'b74000861e16cac48f4f5e5fd3672a51', 'url': 'https://streams.spec.whatwg.org/#transformstream', 'dfnText': 'TransformStream', 'items': [{'ids': [{'linkID': 'ref-for-transformstream'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['5f4df04b43560570b213124df57e5ff0'] = {'external': 1, 'id': '5f4df04b43560570b213124df57e5ff0', 'url': 'https://streams.spec.whatwg.org/#writablestream', 'dfnText': 'WritableStream', 'items': [{'ids': [{'linkID': 'ref-for-writablestream'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-writablestream①'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-writablestream②'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['5060a219a8476e31f0cdfcff357628f4'] = {'external': 1, 'id': '5060a219a8476e31f0cdfcff357628f4', 'url': 'https://streams.spec.whatwg.org/#readablestream-enqueue', 'dfnText': 'enqueue', 'items': [{'ids': [{'linkID': 'ref-for-readablestream-enqueue'}], 'text': '3.1.2. Stream processing'}, {'ids': [{'linkID': 'ref-for-readablestream-enqueue①'}], 'text': '4.1. Algorithm'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['f58021d636d41892e712aa5bcd62b2e4'] = {'external': 1, 'id': 'f58021d636d41892e712aa5bcd62b2e4', 'url': 'https://streams.spec.whatwg.org/#readablestream-get-a-reader', 'dfnText': 'getting a reader', 'items': [{'ids': [{'linkID': 'ref-for-readablestream-get-a-reader'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['f0211d9aa7f5bd1b4a2855e1cb5adc01'] = {'external': 1, 'id': 'f0211d9aa7f5bd1b4a2855e1cb5adc01', 'url': 'https://streams.spec.whatwg.org/#writablestream-get-a-writer', 'dfnText': 'getting a writer', 'items': [{'ids': [{'linkID': 'ref-for-writablestream-get-a-writer'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['69233bff482a146056a7a4c0f4f2aeca'] = {'external': 1, 'id': '69233bff482a146056a7a4c0f4f2aeca', 'url': 'https://streams.spec.whatwg.org/#identity-transform-stream', 'dfnText': 'identity transform stream', 'items': [{'ids': [{'linkID': 'ref-for-identity-transform-stream'}], 'text': '3.2. Extension attribute'}, {'ids': [{'linkID': 'ref-for-identity-transform-stream①'}, {'linkID': 'ref-for-identity-transform-stream②'}], 'text': '5.1. Operations'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['7e011eb5820beee1dc04cf522a316a9f'] = {'external': 1, 'id': '7e011eb5820beee1dc04cf522a316a9f', 'url': 'https://streams.spec.whatwg.org/#readablestreamdefaultreader-release', 'dfnText': 'release (for ReadableStreamDefaultReader)', 'items': [{'ids': [{'linkID': 'ref-for-readablestreamdefaultreader-release'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['0f117631f40d5356514f5ce0e350e6de'] = {'external': 1, 'id': '0f117631f40d5356514f5ce0e350e6de', 'url': 'https://streams.spec.whatwg.org/#writablestreamdefaultwriter-release', 'dfnText': 'release (for WritableStreamDefaultWriter)', 'items': [{'ids': [{'linkID': 'ref-for-writablestreamdefaultwriter-release'}], 'text': '3.2. Extension attribute'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['b8a414e15ae079207395844197877bf4'] = {'external': 1, 'id': 'b8a414e15ae079207395844197877bf4', 'url': 'https://streams.spec.whatwg.org/#readablestream-set-up', 'dfnText': 'set up (for ReadableStream)', 'items': [{'ids': [{'linkID': 'ref-for-readablestream-set-up'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-readablestream-set-up①'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['d29c83fe7e7e8ecf6e6103447f1c6cad'] = {'external': 1, 'id': 'd29c83fe7e7e8ecf6e6103447f1c6cad', 'url': 'https://streams.spec.whatwg.org/#writablestream-set-up', 'dfnText': 'set up (for WritableStream)', 'items': [{'ids': [{'linkID': 'ref-for-writablestream-set-up'}], 'text': '3.1.1. Stream creation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['2b3150e1a2b1a16e5dbc951fc9eee57d'] = {'external': 1, 'id': '2b3150e1a2b1a16e5dbc951fc9eee57d', 'url': 'https://streams.spec.whatwg.org/#transformstream-set-up-transformalgorithm', 'dfnText': 'transformalgorithm', 'items': [{'ids': [{'linkID': 'ref-for-transformstream-set-up-transformalgorithm'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['6d93512ee1e1e36dfdae87350a8c08b3'] = {'external': 1, 'id': '6d93512ee1e1e36dfdae87350a8c08b3', 'url': 'https://streams.spec.whatwg.org/#writablestream-set-up-writealgorithm', 'dfnText': 'writealgorithm', 'items': [{'ids': [{'linkID': 'ref-for-writablestream-set-up-writealgorithm'}], 'text': '3.1.1. Stream creation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['4a13f937c21d9441c878af8c52cef9b8'] = {'external': 1, 'id': '4a13f937c21d9441c878af8c52cef9b8', 'url': 'https://w3c.github.io/webcrypto/#dfn-CryptoKey', 'dfnText': 'CryptoKey', 'items': [{'ids': [{'linkID': 'ref-for-dfn-CryptoKey'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['8e4f03edcfe9224009a4032bac512ab6'] = {'external': 1, 'id': '8e4f03edcfe9224009a4032bac512ab6', 'url': 'https://webidl.spec.whatwg.org/#idl-ArrayBuffer', 'dfnText': 'ArrayBuffer', 'items': [{'ids': [{'linkID': 'ref-for-idl-ArrayBuffer'}], 'text': '4.1. Algorithm'}, {'ids': [{'linkID': 'ref-for-idl-ArrayBuffer①'}, {'linkID': 'ref-for-idl-ArrayBuffer②'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['1fcbdca3bebbc8c92cea6e7184b4ea45'] = {'external': 1, 'id': '1fcbdca3bebbc8c92cea6e7184b4ea45', 'url': 'https://webidl.spec.whatwg.org/#BufferSource', 'dfnText': 'BufferSource', 'items': [{'ids': [{'linkID': 'ref-for-BufferSource'}, {'linkID': 'ref-for-BufferSource①'}], 'text': '4.1. Algorithm'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['0ab204fb9cc9a746edaff83c0db0740a'] = {'external': 1, 'id': '0ab204fb9cc9a746edaff83c0db0740a', 'url': 'https://webidl.spec.whatwg.org/#idl-DOMException', 'dfnText': 'DOMException', 'items': [{'ids': [{'linkID': 'ref-for-idl-DOMException'}, {'linkID': 'ref-for-idl-DOMException①'}, {'linkID': 'ref-for-idl-DOMException②'}, {'linkID': 'ref-for-idl-DOMException③'}], 'text': '3.1.1. Stream creation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['e667e629f6d6cd7af11a164eb4bb237c'] = {'external': 1, 'id': 'e667e629f6d6cd7af11a164eb4bb237c', 'url': 'https://webidl.spec.whatwg.org/#EnforceRange', 'dfnText': 'EnforceRange', 'items': [{'ids': [{'linkID': 'ref-for-EnforceRange'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['dde049eb112f043fc45407ec0d4cb457'] = {'external': 1, 'id': 'dde049eb112f043fc45407ec0d4cb457', 'url': 'https://webidl.spec.whatwg.org/#Exposed', 'dfnText': 'Exposed', 'items': [{'ids': [{'linkID': 'ref-for-Exposed'}], 'text': '4. SFrameTransform'}, {'ids': [{'linkID': 'ref-for-Exposed①'}, {'linkID': 'ref-for-Exposed②'}, {'linkID': 'ref-for-Exposed③'}, {'linkID': 'ref-for-Exposed④'}, {'linkID': 'ref-for-Exposed⑤'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['8ba0220117df1bc22fb9309a72d18b71'] = {'external': 1, 'id': '8ba0220117df1bc22fb9309a72d18b71', 'url': 'https://webidl.spec.whatwg.org/#invalidaccesserror', 'dfnText': 'InvalidAccessError', 'items': [{'ids': [{'linkID': 'ref-for-invalidaccesserror'}, {'linkID': 'ref-for-invalidaccesserror①'}, {'linkID': 'ref-for-invalidaccesserror②'}, {'linkID': 'ref-for-invalidaccesserror③'}], 'text': '3.1.1. Stream creation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['153343972687752b6534c28bd811972c'] = {'external': 1, 'id': '153343972687752b6534c28bd811972c', 'url': 'https://webidl.spec.whatwg.org/#invalidmodificationerror', 'dfnText': 'InvalidModificationError', 'items': [{'ids': [{'linkID': 'ref-for-invalidmodificationerror'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['93669c631ec1ef8e696b4c083bdbe12c'] = {'external': 1, 'id': '93669c631ec1ef8e696b4c083bdbe12c', 'url': 'https://webidl.spec.whatwg.org/#idl-promise', 'dfnText': 'Promise', 'items': [{'ids': [{'linkID': 'ref-for-idl-promise'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['04b3ab4ac1c03b8ef3df67e1fed2c870'] = {'external': 1, 'id': '04b3ab4ac1c03b8ef3df67e1fed2c870', 'url': 'https://webidl.spec.whatwg.org/#exceptiondef-rangeerror', 'dfnText': 'RangeError', 'items': [{'ids': [{'linkID': 'ref-for-exceptiondef-rangeerror'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['bbe33fc7ac016834e4aaddbfd1b084a1'] = {'external': 1, 'id': 'bbe33fc7ac016834e4aaddbfd1b084a1', 'url': 'https://webidl.spec.whatwg.org/#a-new-promise', 'dfnText': 'a new promise', 'items': [{'ids': [{'linkID': 'ref-for-a-new-promise'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['cb7ce63b39eb2128b9c2cc2cf413299f'] = {'external': 1, 'id': 'cb7ce63b39eb2128b9c2cc2cf413299f', 'url': 'https://webidl.spec.whatwg.org/#a-promise-resolved-with', 'dfnText': 'a promise resolved with', 'items': [{'ids': [{'linkID': 'ref-for-a-promise-resolved-with'}, {'linkID': 'ref-for-a-promise-resolved-with①'}, {'linkID': 'ref-for-a-promise-resolved-with②'}], 'text': '3.1.2. Stream processing'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['8eec6bb7878bb17dddbbb727b8d77c28'] = {'external': 1, 'id': '8eec6bb7878bb17dddbbb727b8d77c28', 'url': 'https://webidl.spec.whatwg.org/#idl-any', 'dfnText': 'any', 'items': [{'ids': [{'linkID': 'ref-for-idl-any'}, {'linkID': 'ref-for-idl-any①'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['e882d7e982b1edeea348be3ce3f60337'] = {'external': 1, 'id': 'e882d7e982b1edeea348be3ce3f60337', 'url': 'https://webidl.spec.whatwg.org/#idl-bigint', 'dfnText': 'bigint', 'items': [{'ids': [{'linkID': 'ref-for-idl-bigint'}], 'text': '4. SFrameTransform'}, {'ids': [{'linkID': 'ref-for-idl-bigint①'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['f8062b07e25ed0281f5cbfb9a54070b4'] = {'external': 1, 'id': 'f8062b07e25ed0281f5cbfb9a54070b4', 'url': 'https://webidl.spec.whatwg.org/#idl-boolean', 'dfnText': 'boolean', 'items': [{'ids': [{'linkID': 'ref-for-idl-boolean'}], 'text': '3. Specification'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['a189a0d7ce5bc36522126b11ca418f0a'] = {'external': 1, 'id': 'a189a0d7ce5bc36522126b11ca418f0a', 'url': 'https://webidl.spec.whatwg.org/#idl-long', 'dfnText': 'long', 'items': [{'ids': [{'linkID': 'ref-for-idl-long'}, {'linkID': 'ref-for-idl-long①'}, {'linkID': 'ref-for-idl-long②'}, {'linkID': 'ref-for-idl-long③'}, {'linkID': 'ref-for-idl-long④'}, {'linkID': 'ref-for-idl-long⑤'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['bdb104b4bd6b3ad8ef37148d62f2c227'] = {'external': 1, 'id': 'bdb104b4bd6b3ad8ef37148d62f2c227', 'url': 'https://webidl.spec.whatwg.org/#idl-long-long', 'dfnText': 'long long', 'items': [{'ids': [{'linkID': 'ref-for-idl-long-long'}, {'linkID': 'ref-for-idl-long-long①'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['5039223412f0d0a24ee17570f82d3d59'] = {'external': 1, 'id': '5039223412f0d0a24ee17570f82d3d59', 'url': 'https://webidl.spec.whatwg.org/#idl-object', 'dfnText': 'object', 'items': [{'ids': [{'linkID': 'ref-for-idl-object'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['f7204c0306e7ffcb24c31adf6e629e1d'] = {'external': 1, 'id': 'f7204c0306e7ffcb24c31adf6e629e1d', 'url': 'https://webidl.spec.whatwg.org/#reject', 'dfnText': 'reject', 'items': [{'ids': [{'linkID': 'ref-for-reject'}, {'linkID': 'ref-for-reject①'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['f4f973f92274819781816b033aea1f11'] = {'external': 1, 'id': 'f4f973f92274819781816b033aea1f11', 'url': 'https://webidl.spec.whatwg.org/#resolve', 'dfnText': 'resolve', 'items': [{'ids': [{'linkID': 'ref-for-resolve'}], 'text': '4.2. Methods'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['38ab7db52e46bed36993204c29f67202'] = {'external': 1, 'id': '38ab7db52e46bed36993204c29f67202', 'url': 'https://webidl.spec.whatwg.org/#idl-sequence', 'dfnText': 'sequence', 'items': [{'ids': [{'linkID': 'ref-for-idl-sequence'}, {'linkID': 'ref-for-idl-sequence①'}, {'linkID': 'ref-for-idl-sequence②'}, {'linkID': 'ref-for-idl-sequence③'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['be0933df03cd63338f98de217c4158c7'] = {'external': 1, 'id': 'be0933df03cd63338f98de217c4158c7', 'url': 'https://webidl.spec.whatwg.org/#this', 'dfnText': 'this', 'items': [{'ids': [{'linkID': 'ref-for-this'}, {'linkID': 'ref-for-this①'}, {'linkID': 'ref-for-this②'}, {'linkID': 'ref-for-this③'}, {'linkID': 'ref-for-this④'}, {'linkID': 'ref-for-this⑤'}, {'linkID': 'ref-for-this⑥'}, {'linkID': 'ref-for-this⑦'}, {'linkID': 'ref-for-this⑧'}, {'linkID': 'ref-for-this⑨'}, {'linkID': 'ref-for-this①⓪'}, {'linkID': 'ref-for-this①①'}, {'linkID': 'ref-for-this①②'}, {'linkID': 'ref-for-this①③'}, {'linkID': 'ref-for-this①④'}, {'linkID': 'ref-for-this①⑤'}, {'linkID': 'ref-for-this①⑥'}, {'linkID': 'ref-for-this①⑦'}, {'linkID': 'ref-for-this①⑧'}, {'linkID': 'ref-for-this①⑨'}, {'linkID': 'ref-for-this②⓪'}, {'linkID': 'ref-for-this②①'}, {'linkID': 'ref-for-this②②'}, {'linkID': 'ref-for-this②③'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-this②④'}, {'linkID': 'ref-for-this②⑤'}, {'linkID': 'ref-for-this②⑥'}, {'linkID': 'ref-for-this②⑦'}, {'linkID': 'ref-for-this②⑧'}, {'linkID': 'ref-for-this②⑨'}], 'text': '3.2. Extension attribute'}, {'ids': [{'linkID': 'ref-for-this③⓪'}], 'text': '4. SFrameTransform'}, {'ids': [{'linkID': 'ref-for-this③①'}, {'linkID': 'ref-for-this③②'}, {'linkID': 'ref-for-this③③'}], 'text': '5.2. Attributes'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['cee863f1f2ec91066cfb7f5d309d59dc'] = {'external': 1, 'id': 'cee863f1f2ec91066cfb7f5d309d59dc', 'url': 'https://webidl.spec.whatwg.org/#idl-undefined', 'dfnText': 'undefined', 'items': [{'ids': [{'linkID': 'ref-for-idl-undefined'}], 'text': '4. SFrameTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['db891cb1cc28e2bf626982240ec36b2a'] = {'external': 1, 'id': 'db891cb1cc28e2bf626982240ec36b2a', 'url': 'https://webidl.spec.whatwg.org/#idl-unsigned-long-long', 'dfnText': 'unsigned long long', 'items': [{'ids': [{'linkID': 'ref-for-idl-unsigned-long-long'}], 'text': '4. SFrameTransform'}, {'ids': [{'linkID': 'ref-for-idl-unsigned-long-long①'}, {'linkID': 'ref-for-idl-unsigned-long-long②'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['85ad66f191d72a7d6508e0bab70044dc'] = {'external': 1, 'id': '85ad66f191d72a7d6508e0bab70044dc', 'url': 'https://webidl.spec.whatwg.org/#idl-unsigned-short', 'dfnText': 'unsigned short', 'items': [{'ids': [{'linkID': 'ref-for-idl-unsigned-short'}, {'linkID': 'ref-for-idl-unsigned-short①'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['16c142d56e48341566f9b16f8377b6e3'] = {'external': 1, 'id': '16c142d56e48341566f9b16f8377b6e3', 'url': 'https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration', 'dfnText': 'RTCConfiguration', 'items': [{'ids': [{'linkID': 'ref-for-dom-rtcconfiguration'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-dom-rtcconfiguration①'}], 'text': '3.1. Extension operation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['59e356cc010cd9e35d3d4993ef153441'] = {'external': 1, 'id': '59e356cc010cd9e35d3d4993ef153441', 'url': 'https://w3c.github.io/webrtc-pc/#dom-rtcpeerconnection', 'dfnText': 'RTCPeerConnection', 'items': [{'ids': [{'linkID': 'ref-for-dom-rtcpeerconnection'}], 'text': 'Unnumbered Section'}, {'ids': [{'linkID': 'ref-for-dom-rtcpeerconnection①'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-dom-rtcpeerconnection②'}], 'text': '3.1. Extension operation'}, {'ids': [{'linkID': 'ref-for-dom-rtcpeerconnection③'}, {'linkID': 'ref-for-dom-rtcpeerconnection④'}], 'text': '3.1.1. Stream creation'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['d4c25fedb9f08626e1c4d29cb47ce7b2'] = {'external': 1, 'id': 'd4c25fedb9f08626e1c4d29cb47ce7b2', 'url': 'https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver', 'dfnText': 'RTCRtpReceiver', 'items': [{'ids': [{'linkID': 'ref-for-dom-rtcrtpreceiver'}, {'linkID': 'ref-for-dom-rtcrtpreceiver①'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpreceiver②'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpreceiver③'}, {'linkID': 'ref-for-dom-rtcrtpreceiver④'}], 'text': '3.1.2. Stream processing'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpreceiver⑤'}, {'linkID': 'ref-for-dom-rtcrtpreceiver⑥'}], 'text': '3.2. Extension attribute'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpreceiver⑦'}], 'text': '4.1. Algorithm'}]};
</script>
<script>
    window.dfnsJson ??= {};
    window.dfnsJson['2302f1712d9a2b75744e0c22d04487a4'] = {'external': 1, 'id': '2302f1712d9a2b75744e0c22d04487a4', 'url': 'https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender', 'dfnText': 'RTCRtpSender', 'items': [{'ids': [{'linkID': 'ref-for-dom-rtcrtpsender'}, {'linkID': 'ref-for-dom-rtcrtpsender①'}], 'text': '3. Specification'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpsender②'}], 'text': '3.1.1. Stream creation'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpsender③'}, {'linkID': 'ref-for-dom-rtcrtpsender④'}], 'text': '3.1.2. Stream processing'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpsender⑤'}, {'linkID': 'ref-for-dom-rtcrtpsender⑥'}], 'text': '3.2. Extension attribute'}, {'ids': [{'linkID': 'ref-for-dom-rtcrtpsender⑦'}], 'text': '4.1. Algorithm'}]};
</script>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c39ea07f9fe7582ab58785f52bb2fb22">AbortController</span>
     <li><span class="dfn-paneled" id="316772b0029bcc028521d2db08fd3717">Event</span>
     <li><span class="dfn-paneled" id="ea86cd4a0dc314bc1093a2d0542c4364">add</span>
     <li><span class="dfn-paneled" id="c61f62a5312ce36419c5f6fe20f0d28b">creating an event</span>
     <li><span class="dfn-paneled" id="456092ef045c1559d107ee10841febd3">signal abort</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c0abb72a4aa2f971e990a7517b81e62a">DedicatedWorkerGlobalScope</span>
     <li><span class="dfn-paneled" id="716703f1068cc638b4235f83154eff6c">EventHandler</span>
     <li><span class="dfn-paneled" id="7a7e704e0b3deedb2e838a06d27f740e">StructuredDeserialize</span>
     <li><span class="dfn-paneled" id="15aa28a5ee77adc5228b4fede60e07d5">StructuredSerializeWithTransfer</span>
     <li><span class="dfn-paneled" id="1875387458fa6e1450bbb7f8999f1636">Worker</span>
     <li><span class="dfn-paneled" id="3a2763fcaa6bc82693554cf36780c0dd">in parallel</span>
     <li><span class="dfn-paneled" id="da7ed5f190c4eedd375552d6f7876301">queue a task</span>
     <li><span class="dfn-paneled" id="8022a5f0b9910c35c5215fd070e93d09">task source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MEDIACAPTURE-STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="084e04016dd179bec71e0192f72becac">MediaStreamTrack</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="e83c66cb38107c7fbcbc7b74c2dd9ace">GenericTransformStream</span>
     <li><span class="dfn-paneled" id="66e5f618a6e13b8af5a3bb1a7bcb3923">ReadableStream</span>
     <li><span class="dfn-paneled" id="b74000861e16cac48f4f5e5fd3672a51">TransformStream</span>
     <li><span class="dfn-paneled" id="5f4df04b43560570b213124df57e5ff0">WritableStream</span>
     <li><span class="dfn-paneled" id="5060a219a8476e31f0cdfcff357628f4">enqueue</span>
     <li><span class="dfn-paneled" id="f58021d636d41892e712aa5bcd62b2e4">getting a reader</span>
     <li><span class="dfn-paneled" id="f0211d9aa7f5bd1b4a2855e1cb5adc01">getting a writer</span>
     <li><span class="dfn-paneled" id="69233bff482a146056a7a4c0f4f2aeca">identity transform stream</span>
     <li><span class="dfn-paneled" id="7e011eb5820beee1dc04cf522a316a9f">release <small>(for ReadableStreamDefaultReader)</small></span>
     <li><span class="dfn-paneled" id="0f117631f40d5356514f5ce0e350e6de">release <small>(for WritableStreamDefaultWriter)</small></span>
     <li><span class="dfn-paneled" id="b8a414e15ae079207395844197877bf4">set up <small>(for ReadableStream)</small></span>
     <li><span class="dfn-paneled" id="d29c83fe7e7e8ecf6e6103447f1c6cad">set up <small>(for WritableStream)</small></span>
     <li><span class="dfn-paneled" id="2b3150e1a2b1a16e5dbc951fc9eee57d">transformalgorithm</span>
     <li><span class="dfn-paneled" id="6d93512ee1e1e36dfdae87350a8c08b3">writealgorithm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebCryptoAPI]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="4a13f937c21d9441c878af8c52cef9b8">CryptoKey</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8e4f03edcfe9224009a4032bac512ab6">ArrayBuffer</span>
     <li><span class="dfn-paneled" id="1fcbdca3bebbc8c92cea6e7184b4ea45">BufferSource</span>
     <li><span class="dfn-paneled" id="0ab204fb9cc9a746edaff83c0db0740a">DOMException</span>
     <li><span class="dfn-paneled" id="e667e629f6d6cd7af11a164eb4bb237c">EnforceRange</span>
     <li><span class="dfn-paneled" id="dde049eb112f043fc45407ec0d4cb457">Exposed</span>
     <li><span class="dfn-paneled" id="8ba0220117df1bc22fb9309a72d18b71">InvalidAccessError</span>
     <li><span class="dfn-paneled" id="153343972687752b6534c28bd811972c">InvalidModificationError</span>
     <li><span class="dfn-paneled" id="93669c631ec1ef8e696b4c083bdbe12c">Promise</span>
     <li><span class="dfn-paneled" id="04b3ab4ac1c03b8ef3df67e1fed2c870">RangeError</span>
     <li><span class="dfn-paneled" id="bbe33fc7ac016834e4aaddbfd1b084a1">a new promise</span>
     <li><span class="dfn-paneled" id="cb7ce63b39eb2128b9c2cc2cf413299f">a promise resolved with</span>
     <li><span class="dfn-paneled" id="8eec6bb7878bb17dddbbb727b8d77c28">any</span>
     <li><span class="dfn-paneled" id="e882d7e982b1edeea348be3ce3f60337">bigint</span>
     <li><span class="dfn-paneled" id="f8062b07e25ed0281f5cbfb9a54070b4">boolean</span>
     <li><span class="dfn-paneled" id="a189a0d7ce5bc36522126b11ca418f0a">long</span>
     <li><span class="dfn-paneled" id="bdb104b4bd6b3ad8ef37148d62f2c227">long long</span>
     <li><span class="dfn-paneled" id="5039223412f0d0a24ee17570f82d3d59">object</span>
     <li><span class="dfn-paneled" id="f7204c0306e7ffcb24c31adf6e629e1d">reject</span>
     <li><span class="dfn-paneled" id="f4f973f92274819781816b033aea1f11">resolve</span>
     <li><span class="dfn-paneled" id="38ab7db52e46bed36993204c29f67202">sequence</span>
     <li><span class="dfn-paneled" id="be0933df03cd63338f98de217c4158c7">this</span>
     <li><span class="dfn-paneled" id="cee863f1f2ec91066cfb7f5d309d59dc">undefined</span>
     <li><span class="dfn-paneled" id="db891cb1cc28e2bf626982240ec36b2a">unsigned long long</span>
     <li><span class="dfn-paneled" id="85ad66f191d72a7d6508e0bab70044dc">unsigned short</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBRTC]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="16c142d56e48341566f9b16f8377b6e3">RTCConfiguration</span>
     <li><span class="dfn-paneled" id="59e356cc010cd9e35d3d4993ef153441">RTCPeerConnection</span>
     <li><span class="dfn-paneled" id="d4c25fedb9f08626e1c4d29cb47ce7b2">RTCRtpReceiver</span>
     <li><span class="dfn-paneled" id="2302f1712d9a2b75744e0c22d04487a4">RTCRtpSender</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-mediacapture-streams">[MEDIACAPTURE-STREAMS]
   <dd>Cullen Jennings; et al. <a href="https://w3c.github.io/mediacapture-main/"><cite>Media Capture and Streams</cite></a>. URL: <a href="https://w3c.github.io/mediacapture-main/">https://w3c.github.io/mediacapture-main/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-streams">[STREAMS]
   <dd>Adam Rice; et al. <a href="https://streams.spec.whatwg.org/"><cite>Streams Standard</cite></a>. Living Standard. URL: <a href="https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
   <dt id="biblio-webcryptoapi">[WebCryptoAPI]
   <dd>Mark Watson. <a href="https://w3c.github.io/webcrypto/"><cite>Web Cryptography API</cite></a>. URL: <a href="https://w3c.github.io/webcrypto/">https://w3c.github.io/webcrypto/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-webrtc">[WEBRTC]
   <dd>Cullen Jennings; Henrik Boström; Jan-Ivar Bruaroey. <a href="https://w3c.github.io/webrtc-pc/"><cite>WebRTC 1.0: Real-Time Communication Between Browsers</cite></a>. URL: <a href="https://w3c.github.io/webrtc-pc/">https://w3c.github.io/webrtc-pc/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-web-codecs">[WEB-CODECS]
   <dd><a href="https://github.com/WICG/web-codecs/blob/master/explainer.md"><cite>Web Codecs explainer</cite></a>. URL: <a href="https://github.com/WICG/web-codecs/blob/master/explainer.md">https://github.com/WICG/web-codecs/blob/master/explainer.md</a>
   <dt id="biblio-webrtc-identity">[WEBRTC-IDENTITY]
   <dd>Cullen Jennings; Martin Thomson. <a href="https://w3c.github.io/webrtc-identity/"><cite>Identity for WebRTC 1.0</cite></a>. URL: <a href="https://w3c.github.io/webrtc-identity/">https://w3c.github.io/webrtc-identity/</a>
   <dt id="biblio-webrtc-nv-use-cases">[WEBRTC-NV-USE-CASES]
   <dd>Bernard Aboba. <a href="https://w3c.github.io/webrtc-nv-use-cases/"><cite>WebRTC Next Version Use Cases</cite></a>. URL: <a href="https://w3c.github.io/webrtc-nv-use-cases/">https://w3c.github.io/webrtc-nv-use-cases/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">// New dictionary
<c- b>dictionary</c-> <a href="#dictdef-rtcinsertablestreams"><code><c- g>RTCInsertableStreams</c-></code></a> {
    <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream"><c- n>ReadableStream</c-></a> <a data-type="ReadableStream " href="#dom-rtcinsertablestreams-readable"><code><c- g>readable</c-></code></a>;
    <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream"><c- n>WritableStream</c-></a> <a data-type="WritableStream " href="#dom-rtcinsertablestreams-writable"><code><c- g>writable</c-></code></a>;
};

// New fields in RTCConfiguration
<c- b>partial</c-> <c- b>dictionary</c-> <a class="idl-code" data-link-type="dictionary" href="https://w3c.github.io/webrtc-pc/#dom-rtcconfiguration"><c- g>RTCConfiguration</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-rtcconfiguration-encodedinsertablestreams"><code><c- g>encodedInsertableStreams</c-></code></a> = <c- b>false</c->;
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#sframetransform"><c- n>SFrameTransform</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#rtcrtpscripttransform"><c- n>RTCRtpScriptTransform</c-></a>) <a href="#typedefdef-rtcrtptransform"><code><c- g>RTCRtpTransform</c-></code></a>;

// New methods for RTCRtpSender and RTCRtpReceiver
<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpsender"><c- g>RTCRtpSender</c-></a> {
    <a data-link-type="idl-name" href="#dictdef-rtcinsertablestreams"><c- n>RTCInsertableStreams</c-></a> <a class="idl-code" data-link-type="method" href="#dom-rtcrtpsender-createencodedstreams"><c- g>createEncodedStreams</c-></a>();
    <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-rtcrtptransform"><c- n>RTCRtpTransform</c-></a>? <a class="idl-code" data-link-type="attribute" data-type="RTCRtpTransform?" href="#dom-rtcrtpsender-transform"><c- g>transform</c-></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://w3c.github.io/webrtc-pc/#dom-rtcrtpreceiver"><c- g>RTCRtpReceiver</c-></a> {
    <a data-link-type="idl-name" href="#dictdef-rtcinsertablestreams"><c- n>RTCInsertableStreams</c-></a> <a href="#dom-rtcrtpreceiver-createencodedstreams"><code><c- g>createEncodedStreams</c-></code></a>();
    <c- b>attribute</c-> <a data-link-type="idl-name" href="#typedefdef-rtcrtptransform"><c- n>RTCRtpTransform</c-></a>? <a class="idl-code" data-link-type="attribute" data-type="RTCRtpTransform?" href="#dom-rtcrtpsender-transform"><c- g>transform</c-></a>;
};

<c- b>enum</c-> <a href="#enumdef-sframetransformrole"><code><c- g>SFrameTransformRole</c-></code></a> {
    <a href="#dom-sframetransformrole-encrypt"><code><c- s>"encrypt"</c-></code></a>,
    <a href="#dom-sframetransformrole-decrypt"><code><c- s>"decrypt"</c-></code></a>
};

<c- b>dictionary</c-> <a href="#dictdef-sframetransformoptions"><code><c- g>SFrameTransformOptions</c-></code></a> {
    <a data-link-type="idl-name" href="#enumdef-sframetransformrole"><c- n>SFrameTransformRole</c-></a> <a data-default="&quot;encrypt&quot;" data-type="SFrameTransformRole " href="#dom-sframetransformoptions-role"><code><c- g>role</c-></code></a> = "encrypt";
};

<c- b>typedef</c-> [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a href="#typedefdef-smallcryptokeyid"><code><c- g>SmallCryptoKeyID</c-></code></a>;
<c- b>typedef</c-> (<a data-link-type="idl-name" href="#typedefdef-smallcryptokeyid"><c- n>SmallCryptoKeyID</c-></a> <c- b>or</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-bigint"><c- b>bigint</c-></a>) <a href="#typedefdef-cryptokeyid"><code><c- g>CryptoKeyID</c-></code></a>;

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <a href="#sframetransform"><code><c- g>SFrameTransform</c-></code></a> {
    <a class="idl-code" data-link-type="constructor" href="#dom-sframetransform-sframetransform"><c- g>constructor</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-sframetransformoptions"><c- n>SFrameTransformOptions</c-></a> <a href="#dom-sframetransform-sframetransform-options-options"><code><c- g>options</c-></code></a> = {});
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-sframetransform-setencryptionkey"><c- g>setEncryptionKey</c-></a>(<a data-link-type="idl-name" href="https://w3c.github.io/webcrypto/#dfn-CryptoKey"><c- n>CryptoKey</c-></a> <a href="#dom-sframetransform-setencryptionkey-key-keyid-key"><code><c- g>key</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#typedefdef-cryptokeyid"><c- n>CryptoKeyID</c-></a> <a href="#dom-sframetransform-setencryptionkey-key-keyid-keyid"><code><c- g>keyID</c-></code></a>);
};
<a data-link-type="idl-name" href="#sframetransform"><c- n>SFrameTransform</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#generictransformstream"><c- n>GenericTransformStream</c-></a>;

// New enum for video frame types. Will eventually re-use the equivalent defined
// by WebCodecs.
<c- b>enum</c-> <a href="#enumdef-rtcencodedvideoframetype"><code><c- g>RTCEncodedVideoFrameType</c-></code></a> {
    <a href="#dom-rtcencodedvideoframetype-empty"><code><c- s>"empty"</c-></code></a>,
    <a href="#dom-rtcencodedvideoframetype-key"><code><c- s>"key"</c-></code></a>,
    <a href="#dom-rtcencodedvideoframetype-delta"><code><c- s>"delta"</c-></code></a>,
};

<c- b>dictionary</c-> <a href="#dictdef-rtcencodedvideoframemetadata"><code><c- g>RTCEncodedVideoFrameMetadata</c-></code></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a> <a data-type="long long " href="#dom-rtcencodedvideoframemetadata-frameid"><code><c- g>frameId</c-></code></a>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long-long"><c- b>long</c-> <c- b>long</c-></a>> <a data-type="sequence<long long> " href="#dom-rtcencodedvideoframemetadata-dependencies"><code><c- g>dependencies</c-></code></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-type="unsigned short " href="#dom-rtcencodedvideoframemetadata-width"><code><c- g>width</c-></code></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-short"><c- b>unsigned</c-> <c- b>short</c-></a> <a data-type="unsigned short " href="#dom-rtcencodedvideoframemetadata-height"><code><c- g>height</c-></code></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a> <a data-type="long " href="#dom-rtcencodedvideoframemetadata-spatialindex"><code><c- g>spatialIndex</c-></code></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a> <a data-type="long " href="#dom-rtcencodedvideoframemetadata-temporalindex"><code><c- g>temporalIndex</c-></code></a>;
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a> <a data-type="long " href="#dom-rtcencodedvideoframemetadata-synchronizationsource"><code><c- g>synchronizationSource</c-></code></a>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a>> <a data-type="sequence<long> " href="#dom-rtcencodedvideoframemetadata-contributingsources"><code><c- g>contributingSources</c-></code></a>;
};

// New interfaces to define encoded video and audio frames. Will eventually
// re-use or extend the equivalent defined in WebCodecs.
[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <a href="#rtcencodedvideoframe"><code><c- g>RTCEncodedVideoFrame</c-></code></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-rtcencodedvideoframetype"><c- n>RTCEncodedVideoFrameType</c-></a> <a data-readonly data-type="RTCEncodedVideoFrameType" href="#dom-rtcencodedvideoframe-type"><code><c- g>type</c-></code></a>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-readonly data-type="unsigned long long" href="#dom-rtcencodedvideoframe-timestamp"><code><c- g>timestamp</c-></code></a>;
    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><c- b>ArrayBuffer</c-></a> <a data-type="ArrayBuffer" href="#dom-rtcencodedvideoframe-data"><code><c- g>data</c-></code></a>;
    <a data-link-type="idl-name" href="#dictdef-rtcencodedvideoframemetadata"><c- n>RTCEncodedVideoFrameMetadata</c-></a> <a href="#dom-rtcencodedvideoframe-getmetadata"><code><c- g>getMetadata</c-></code></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-rtcencodedaudioframemetadata"><code><c- g>RTCEncodedAudioFrameMetadata</c-></code></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a> <a data-type="long " href="#dom-rtcencodedaudioframemetadata-synchronizationsource"><code><c- g>synchronizationSource</c-></code></a>;
    <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-long"><c- b>long</c-></a>> <a data-type="sequence<long> " href="#dom-rtcencodedaudioframemetadata-contributingsources"><code><c- g>contributingSources</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>DedicatedWorker</c->)]
<c- b>interface</c-> <a href="#rtcencodedaudioframe"><code><c- g>RTCEncodedAudioFrame</c-></code></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a data-readonly data-type="unsigned long long" href="#dom-rtcencodedaudioframe-timestamp"><code><c- g>timestamp</c-></code></a>;
    <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer"><c- b>ArrayBuffer</c-></a> <a data-type="ArrayBuffer" href="#dom-rtcencodedaudioframe-data"><code><c- g>data</c-></code></a>;
    <a data-link-type="idl-name" href="#dictdef-rtcencodedaudioframemetadata"><c- n>RTCEncodedAudioFrameMetadata</c-></a> <a href="#dom-rtcencodedaudioframe-getmetadata"><code><c- g>getMetadata</c-></code></a>();
};


// New interfaces to expose JavaScript-based transforms.

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <a href="#rtctransformevent"><code><c- g>RTCTransformEvent</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#event"><c- n>Event</c-></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#rtcrtpscripttransformer"><c- n>RTCRtpScriptTransformer</c-></a> <a data-readonly data-type="RTCRtpScriptTransformer" href="#dom-rtctransformevent-transformer"><code><c- g>transformer</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/workers.html#dedicatedworkerglobalscope"><c- g>DedicatedWorkerGlobalScope</c-></a> {
    <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a data-type="EventHandler" href="#dom-dedicatedworkerglobalscope-onrtctransform"><code><c- g>onrtctransform</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>DedicatedWorker</c->]
<c- b>interface</c-> <a href="#rtcrtpscripttransformer"><code><c- g>RTCRtpScriptTransformer</c-></code></a> {
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#readablestream"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-rtcrtpscripttransformer-readable"><c- g>readable</c-></a>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://streams.spec.whatwg.org/#writablestream"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-rtcrtpscripttransformer-writable"><c- g>writable</c-></a>;
    <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="any" href="#dom-rtcrtpscripttransformer-options"><c- g>options</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#rtcrtpscripttransform"><code><c- g>RTCRtpScriptTransform</c-></code></a> {
    <a class="idl-code" data-link-type="constructor" href="#dom-rtcrtpscripttransform-rtcrtpscripttransform"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/workers.html#worker"><c- n>Worker</c-></a> <a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-worker"><code><c- g>worker</c-></code></a>, <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-any"><c- b>any</c-></a> <a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-options"><code><c- g>options</c-></code></a>, <c- b>optional</c-> <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#idl-sequence"><c- b>sequence</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-object"><c- b>object</c-></a>> <a href="#dom-rtcrtpscripttransform-rtcrtpscripttransform-worker-options-transfer-transfer"><code><c- g>transfer</c-></code></a>);
};

</pre>
<script>
window.dfnsJson ??= {};
window.dfnsJson['dictdef-rtcinsertablestreams'] = {'id': 'dictdef-rtcinsertablestreams', 'url': '#dictdef-rtcinsertablestreams', 'dfnText': 'RTCInsertableStreams', 'items': [{'ids': [{'refID': 'ref-for-dictdef-rtcinsertablestreams'}, {'refID': 'ref-for-dictdef-rtcinsertablestreams①'}], 'text': '3. Specification'}, {'ids': [{'refID': 'ref-for-dictdef-rtcinsertablestreams②'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['dom-rtcinsertablestreams-readable'] = {'id': 'dom-rtcinsertablestreams-readable', 'url': '#dom-rtcinsertablestreams-readable', 'dfnText': 'readable', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcinsertablestreams-readable'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['dom-rtcinsertablestreams-writable'] = {'id': 'dom-rtcinsertablestreams-writable', 'url': '#dom-rtcinsertablestreams-writable', 'dfnText': 'writable', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcinsertablestreams-writable'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['dom-rtcconfiguration-encodedinsertablestreams'] = {'id': 'dom-rtcconfiguration-encodedinsertablestreams', 'url': '#dom-rtcconfiguration-encodedinsertablestreams', 'dfnText': 'encodedInsertableStreams', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcconfiguration-encodedinsertablestreams'}, {'refID': 'ref-for-dom-rtcconfiguration-encodedinsertablestreams①'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['typedefdef-rtcrtptransform'] = {'id': 'typedefdef-rtcrtptransform', 'url': '#typedefdef-rtcrtptransform', 'dfnText': 'RTCRtpTransform', 'items': [{'ids': [{'refID': 'ref-for-typedefdef-rtcrtptransform'}, {'refID': 'ref-for-typedefdef-rtcrtptransform①'}], 'text': '3. Specification'}]};
window.dfnsJson['dom-rtcrtpsender-createencodedstreams'] = {'id': 'dom-rtcrtpsender-createencodedstreams', 'url': '#dom-rtcrtpsender-createencodedstreams', 'dfnText': 'createEncodedStreams()', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpsender-createencodedstreams'}], 'text': '3. Specification'}]};
window.dfnsJson['readencodeddata'] = {'id': 'readencodeddata', 'url': '#readencodeddata', 'dfnText': 'readEncodedData', 'items': [{'ids': [{'refID': 'ref-for-readencodeddata'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['writeencodeddata'] = {'id': 'writeencodeddata', 'url': '#writeencodeddata', 'dfnText': 'writeEncodedData', 'items': [{'ids': [{'refID': 'ref-for-writeencodeddata'}], 'text': '3.1.1. Stream creation'}]};
window.dfnsJson['dom-rtcrtpsender-transform'] = {'id': 'dom-rtcrtpsender-transform', 'url': '#dom-rtcrtpsender-transform', 'dfnText': 'transform', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpsender-transform'}, {'refID': 'ref-for-dom-rtcrtpsender-transform①'}], 'text': '3. Specification'}]};
window.dfnsJson['chain-transform-algorithm'] = {'id': 'chain-transform-algorithm', 'url': '#chain-transform-algorithm', 'dfnText': 'chain transform algorithm', 'items': [{'ids': [{'refID': 'ref-for-chain-transform-algorithm'}, {'refID': 'ref-for-chain-transform-algorithm①'}], 'text': '3.2. Extension attribute'}]};
window.dfnsJson['enumdef-sframetransformrole'] = {'id': 'enumdef-sframetransformrole', 'url': '#enumdef-sframetransformrole', 'dfnText': 'SFrameTransformRole', 'items': [{'ids': [{'refID': 'ref-for-enumdef-sframetransformrole'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['dictdef-sframetransformoptions'] = {'id': 'dictdef-sframetransformoptions', 'url': '#dictdef-sframetransformoptions', 'dfnText': 'SFrameTransformOptions', 'items': [{'ids': [{'refID': 'ref-for-dictdef-sframetransformoptions'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['dom-sframetransformoptions-role'] = {'id': 'dom-sframetransformoptions-role', 'url': '#dom-sframetransformoptions-role', 'dfnText': 'role', 'items': [{'ids': [{'refID': 'ref-for-dom-sframetransformoptions-role'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['typedefdef-smallcryptokeyid'] = {'id': 'typedefdef-smallcryptokeyid', 'url': '#typedefdef-smallcryptokeyid', 'dfnText': 'SmallCryptoKeyID', 'items': [{'ids': [{'refID': 'ref-for-typedefdef-smallcryptokeyid'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['typedefdef-cryptokeyid'] = {'id': 'typedefdef-cryptokeyid', 'url': '#typedefdef-cryptokeyid', 'dfnText': 'CryptoKeyID', 'items': [{'ids': [{'refID': 'ref-for-typedefdef-cryptokeyid'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['sframetransform'] = {'id': 'sframetransform', 'url': '#sframetransform', 'dfnText': 'SFrameTransform', 'items': [{'ids': [{'refID': 'ref-for-sframetransform'}], 'text': '3. Specification'}, {'ids': [{'refID': 'ref-for-sframetransform①'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['dom-sframetransform-sframetransform'] = {'id': 'dom-sframetransform-sframetransform', 'url': '#dom-sframetransform-sframetransform', 'dfnText': 'new SFrameTransform(options)', 'items': [{'ids': [{'refID': 'ref-for-dom-sframetransform-sframetransform'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['dom-sframetransform-setencryptionkey'] = {'id': 'dom-sframetransform-setencryptionkey', 'url': '#dom-sframetransform-setencryptionkey', 'dfnText': 'setEncryptionKey(key, keyID)', 'items': [{'ids': [{'refID': 'ref-for-dom-sframetransform-setencryptionkey'}], 'text': '4. SFrameTransform'}]};
window.dfnsJson['enumdef-rtcencodedvideoframetype'] = {'id': 'enumdef-rtcencodedvideoframetype', 'url': '#enumdef-rtcencodedvideoframetype', 'dfnText': 'RTCEncodedVideoFrameType', 'items': [{'ids': [{'refID': 'ref-for-enumdef-rtcencodedvideoframetype'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['dictdef-rtcencodedvideoframemetadata'] = {'id': 'dictdef-rtcencodedvideoframemetadata', 'url': '#dictdef-rtcencodedvideoframemetadata', 'dfnText': 'RTCEncodedVideoFrameMetadata', 'items': [{'ids': [{'refID': 'ref-for-dictdef-rtcencodedvideoframemetadata'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['rtcencodedvideoframe'] = {'id': 'rtcencodedvideoframe', 'url': '#rtcencodedvideoframe', 'dfnText': 'RTCEncodedVideoFrame', 'items': [{'ids': [{'refID': 'ref-for-rtcencodedvideoframe'}, {'refID': 'ref-for-rtcencodedvideoframe①'}], 'text': '4.1. Algorithm'}]};
window.dfnsJson['dom-rtcencodedvideoframe-timestamp'] = {'id': 'dom-rtcencodedvideoframe-timestamp', 'url': '#dom-rtcencodedvideoframe-timestamp', 'dfnText': 'timestamp', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcencodedvideoframe-timestamp'}, {'refID': 'ref-for-dom-rtcencodedvideoframe-timestamp①'}], 'text': '3.1.2. Stream processing'}]};
window.dfnsJson['dom-rtcencodedvideoframe-data'] = {'id': 'dom-rtcencodedvideoframe-data', 'url': '#dom-rtcencodedvideoframe-data', 'dfnText': 'data', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcencodedvideoframe-data'}, {'refID': 'ref-for-dom-rtcencodedvideoframe-data①'}], 'text': '4.1. Algorithm'}]};
window.dfnsJson['dictdef-rtcencodedaudioframemetadata'] = {'id': 'dictdef-rtcencodedaudioframemetadata', 'url': '#dictdef-rtcencodedaudioframemetadata', 'dfnText': 'RTCEncodedAudioFrameMetadata', 'items': [{'ids': [{'refID': 'ref-for-dictdef-rtcencodedaudioframemetadata'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['rtcencodedaudioframe'] = {'id': 'rtcencodedaudioframe', 'url': '#rtcencodedaudioframe', 'dfnText': 'RTCEncodedAudioFrame', 'items': [{'ids': [{'refID': 'ref-for-rtcencodedaudioframe'}, {'refID': 'ref-for-rtcencodedaudioframe①'}], 'text': '4.1. Algorithm'}]};
window.dfnsJson['dom-rtcencodedaudioframe-data'] = {'id': 'dom-rtcencodedaudioframe-data', 'url': '#dom-rtcencodedaudioframe-data', 'dfnText': 'data', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcencodedaudioframe-data'}, {'refID': 'ref-for-dom-rtcencodedaudioframe-data①'}], 'text': '4.1. Algorithm'}]};
window.dfnsJson['rtctransformevent'] = {'id': 'rtctransformevent', 'url': '#rtctransformevent', 'dfnText': 'RTCTransformEvent', 'items': [{'ids': [{'refID': 'ref-for-rtctransformevent'}], 'text': '5.1. Operations'}]};
window.dfnsJson['rtcrtpscripttransformer'] = {'id': 'rtcrtpscripttransformer', 'url': '#rtcrtpscripttransformer', 'dfnText': 'RTCRtpScriptTransformer', 'items': [{'ids': [{'refID': 'ref-for-rtcrtpscripttransformer'}], 'text': '5. RTCRtpScriptTransform'}, {'ids': [{'refID': 'ref-for-rtcrtpscripttransformer①'}], 'text': '5.1. Operations'}]};
window.dfnsJson['rtcrtpscripttransform'] = {'id': 'rtcrtpscripttransform', 'url': '#rtcrtpscripttransform', 'dfnText': 'RTCRtpScriptTransform', 'items': [{'ids': [{'refID': 'ref-for-rtcrtpscripttransform'}], 'text': '3. Specification'}]};
window.dfnsJson['dom-rtcrtpscripttransform-rtcrtpscripttransform'] = {'id': 'dom-rtcrtpscripttransform-rtcrtpscripttransform', 'url': '#dom-rtcrtpscripttransform-rtcrtpscripttransform', 'dfnText': 'new RTCRtpScriptTransform(worker, options, transfer)', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpscripttransform-rtcrtpscripttransform'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['dom-rtcrtpscripttransformer-options'] = {'id': 'dom-rtcrtpscripttransformer-options', 'url': '#dom-rtcrtpscripttransformer-options', 'dfnText': 'options', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpscripttransformer-options'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['dom-rtcrtpscripttransformer-readable'] = {'id': 'dom-rtcrtpscripttransformer-readable', 'url': '#dom-rtcrtpscripttransformer-readable', 'dfnText': 'readable', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpscripttransformer-readable'}], 'text': '5. RTCRtpScriptTransform'}]};
window.dfnsJson['dom-rtcrtpscripttransformer-writable'] = {'id': 'dom-rtcrtpscripttransformer-writable', 'url': '#dom-rtcrtpscripttransformer-writable', 'dfnText': 'writable', 'items': [{'ids': [{'refID': 'ref-for-dom-rtcrtpscripttransformer-writable'}], 'text': '5. RTCRtpScriptTransform'}]};
</script>
<script>/* script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    function genDfnPanel([key, value]) {
        const {id, url, dfnText, items, external}  = value;
        const itemsHtml = items.map((item) => {
            const idsHtml = item.ids.map((id, index) => {
                const href = `#${external ? id.linkID : id.refID}`;
                const anchorText = (index == 0) ? item.text : `(${index + 1})`;
                return /* html */`
                    <li><a href="${href}">${anchorText}</a></li>`;
            });
            return idsHtml.join('');
        });

        return /* html */`
            <aside
                class="dfn-panel"
                id="infopanel-for-${id}"
                data-for="${id}"
                aria-labelledby="infopaneltitle-for-${id}">
                <span id="infopaneltitle-for-${id}" style="display:none">
                    Info about the '${dfnText}'
                    ${external ? 'external': ''} reference.
                </span>
                <a href=${url}>${url}</a>
                <b>Referenced in:</b>
                <ul>${itemsHtml.join('')}</ul>
            </aside>`;
    }

    function genAllDfnPanels() {
        const html = Object.entries(dfnsJson).map(genDfnPanel).join('\n');
        const div = document.createElement('div');
        div.innerHTML = html;
        document.body.appendChild(div);
    }

    genAllDfnPanels();

    function queryAll(sel) {
        return [].slice.call(document.querySelectorAll(sel));
    }

    // Add popup behavior to all dfns to show the corresponding dfn-panel.
    var dfns = document.querySelectorAll('.dfn-paneled');
    for (let dfn of dfns) { insertDfnPopupAction(dfn); }

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });

    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn) {
        // Find dfn panel
        const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
        if (dfnPanel) {
            const panelWrapper = document.createElement('span');
            panelWrapper.appendChild(dfnPanel);
            panelWrapper.style.position = "relative";
            panelWrapper.style.height = "0px";
            dfn.insertAdjacentElement("afterend", panelWrapper);
            dfn.setAttribute('role', 'button');
            dfn.setAttribute('aria-expanded', 'false')
            dfn.tabIndex = 0;
            dfn.classList.add('has-dfn-panel');
            dfn.addEventListener('click', (event) => {
                showDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
            });
            dfn.addEventListener('keypress', (event) => {
                const kc = event.keyCode;
                // 32->Space, 13->Enter
                if(kc == 32 || kc == 13) {
                    toggleDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            });

            dfnPanel.addEventListener('click', (event) => {
                if (event.target.nodeName != 'A') {
                    pinDfnPanel(dfnPanel);
                }
                event.stopPropagation();
            });

            dfnPanel.addEventListener('keydown', (event) => {
                if(event.keyCode == 27) { // Escape key
                    hideDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            })

        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
        }
    }
}
</script>