<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>WebXR Raw Camera Access Module</title>
  <meta content="CG-DRAFT" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <link href="https://immersive-web.github.io/raw-camera-access/" rel="canonical">
<style>
  .non-normative::before {
    content: "This section is non-normative.";
    font-style: italic;
  }
  .non-normative-remainder::before {
    content: "The remainder of this section is non-normative.";
    font-style: italic;
  }
  .tg {
    border-collapse: collapse;
    border-spacing: 0;
  }
  .tg th {
    border-style: solid;
    border-width: 1px;
    background: #90b8de;
    color: #fff;
    font-family: sans-serif;
    font-weight: bold;
    border-color: grey;
  }
  .tg td {
    padding: 4px 5px;
    background-color: rgb(221, 238, 255);
    font-family: monospace;
    border-style: solid;
    border-width: 1px;
    border-color: grey;
    overflow: hidden;
    word-break: normal;
  }
  .unstable::before {
    content: "This section is not stable";
    display: block;
    font-weight: bold;
    text-align: right;
    color: red;
  }
  .unstable {
    border: thin solid pink;
    border-radius: .5em;
    padding: .5em;
    margin: .5em calc(-0.5em - 1px);
    background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='300' height='290'><text transform='rotate(-45)' text-anchor='middle' font-family='sans-serif' font-weight='bold' font-size='70' y='210' opacity='.1'>Unstable</text></svg>");
    background-repeat: repeat;
    background-color: #FFF4F4;
  }
  .unstable h3:first-of-type {
    margin-top: 0.5rem;
  }
  .unstable.example:not(.no-marker)::before {
    content: "Example " counter(example) " (Unstable)";
    float: none;
  }
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">WebXR Raw Camera Access Module</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>This version:
      <dd><a class="u-url" href="https://immersive-web.github.io/raw-camera-access/">https://immersive-web.github.io/raw-camera-access/</a>
      <dt class="editor">Editor:
      <dd class="editor p-author h-card vcard" data-editor-id="114482"><a class="p-name fn u-email email" href="mailto:bialpio@google.com">Piotr Bialecki</a> (<a class="p-org org" href="http://google.com/">Google</a>)
      <dt>Participate:
      <dd><a href="https://github.com/immersive-web/raw-camera-access/issues/new">File an issue</a> (<a href="https://github.com/immersive-web/raw-camera-access/issues">open issues</a>)
      <dd><a href="https://lists.w3.org/Archives/Public/public-immersive-web/">Mailing list archive</a>
      <dd><a href="irc://irc.w3.org:6665/">W3C’s #immersive-web IRC</a>
      <dt>Explainer:
      <dd><a href="https://github.com/immersive-web/raw-camera-access/blob/main/explainer.md">explainer.md on GitHub</a>
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification provides a means to access the raw camera image displayed behind an immerisve-ar session, when the device is responsible for rendering that camera image.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#terminology"><span class="secno">1.1</span> <span class="content">Terminology</span></a>
     </ol>
    <li>
     <a href="#initialization"><span class="secno">2</span> <span class="content">Initialization</span></a>
     <ol class="toc">
      <li><a href="#feature-descriptor"><span class="secno">2.1</span> <span class="content">Feature descriptor</span></a>
     </ol>
    <li>
     <a href="#accessing-camera-texture"><span class="secno">3</span> <span class="content">Accessing camera texture</span></a>
     <ol class="toc">
      <li><a href="#xr-view-section"><span class="secno">3.1</span> <span class="content">XRView</span></a>
      <li><a href="#xr-camera-section"><span class="secno">3.2</span> <span class="content">XRCamera</span></a>
      <li><a href="#xr-web-gl-binding-section"><span class="secno">3.3</span> <span class="content">XRWebGLBinding</span></a>
     </ol>
    <li>
     <a href="#native-device-concepts"><span class="secno">4</span> <span class="content">Native device concepts</span></a>
     <ol class="toc">
      <li><a href="#native-camera-section"><span class="secno">4.1</span> <span class="content">Native camera</span></a>
     </ol>
    <li>
     <a href="#privacy-security"><span class="secno">5</span> <span class="content">Privacy &amp; Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#user-experience"><span class="secno">5.1</span> <span class="content">User experience</span></a>
      <li><a href="#privacy-indicators"><span class="secno">5.2</span> <span class="content">Privacy indicators</span></a>
     </ol>
    <li><a href="#ack"><span class="secno">6</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <section class="non-normative">
    <p>This specification introduces new WebXR Device API capability, namely Raw Camera Access API. The newly introduced API enables WebXR-powered applications to access camera image pixels, allowing them to leverage this new information to compute custom per-frame visual effects, or take a snapshot of the app-rendered content overlaid with the camera image.</p>
    <p class="note" role="note"><span class="marker">Note:</span> The API shape specified in this document primarily solves the smartphone-centric scenarios. See <a href="https://github.com/immersive-web/raw-camera-access/issues/2">issue #2</a> for context.</p>
   </section>
   <h3 class="heading settled" data-level="1.1" id="terminology"><span class="secno">1.1. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h3>
   <p>This document uses the acronyms AR to signify Augmented Reality, and VR to signify Virtual Reality.</p>
   <h2 class="heading settled" data-level="2" id="initialization"><span class="secno">2. </span><span class="content">Initialization</span><a class="self-link" href="#initialization"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="feature-descriptor"><span class="secno">2.1. </span><span class="content">Feature descriptor</span><a class="self-link" href="#feature-descriptor"></a></h3>
   <p>The applications can request that raw camera access be enabled on an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface">XRSession</a></code> by passing an appropriate <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#feature-descriptor" id="ref-for-feature-descriptor">feature descriptor</a>. This module introduces new string - <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="camera-access">camera-access</dfn>, as a new valid feature descriptor for raw camera access feature.</p>
   <p>A device is <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#capable-of-supporting" id="ref-for-capable-of-supporting">capable of supporting</a> the raw camera access feature if the device exposes <a data-link-type="dfn" href="#native-camera" id="ref-for-native-camera">native camera</a> capability. The <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#inline-xr-device" id="ref-for-inline-xr-device">inline XR device</a> MUST NOT be treated as <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#capable-of-supporting" id="ref-for-capable-of-supporting①">capable of supporting</a> the raw camera access feature.</p>
   <p>The raw camera access feature is subject to <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#permissions-policy" id="ref-for-permissions-policy">permissions policy</a> and requires <code>"xr-spatial-tracking"</code> policy to be allowed on the requesting document’s origin. In addition, the <code>"camera"</code> <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#permissions-policy" id="ref-for-permissions-policy①">permissions policy</a> must be allowed on the requesting document’s origin.</p>
   <div class="example" id="example-db4da1e5">
    <a class="self-link" href="#example-db4da1e5"></a> The following code demonstrates how a session that requires raw camera access API could be requested: 
<pre class="highlight"><c- a>const</c-> session <c- o>=</c-> <c- k>await</c-> navigator<c- p>.</c->xr<c- p>.</c->requestSession<c- p>(</c-><c- u>"immersive-ar"</c-><c- p>,</c-> <c- p>{</c->
  requiredFeatures<c- o>:</c-> <c- p>[</c-><c- u>"camera-access"</c-><c- p>],</c->
<c- p>});</c->
</pre>
   </div>
   <h2 class="heading settled" data-level="3" id="accessing-camera-texture"><span class="secno">3. </span><span class="content">Accessing camera texture</span><a class="self-link" href="#accessing-camera-texture"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="xr-view-section"><span class="secno">3.1. </span><span class="content">XRView</span><a class="self-link" href="#xr-view-section"></a></h3>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface"><c- g>XRView</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject" id="ref-for-SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#xrcamera" id="ref-for-xrcamera"><c- n>XRCamera</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="XRView" data-dfn-type="attribute" data-export data-readonly data-type="XRCamera?" id="dom-xrview-camera"><code><c- g>camera</c-></code></dfn>;
};
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface①">XRView</a></code> is extended to contain a <code class="idl"><a data-link-type="idl" href="#dom-xrview-camera" id="ref-for-dom-xrview-camera">camera</a></code> attribute which refers to an <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera①">XRCamera</a></code> instance containing information about the camera image relevant for this view. When <code class="idl"><a data-link-type="idl" href="#dom-xrview-camera" id="ref-for-dom-xrview-camera①">camera</a></code> attribute is accessed for the first time on a given <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface②">XRView</a></code> instance, the user agent MUST run the <a data-link-type="dfn" href="#obtain-camera" id="ref-for-obtain-camera">obtain camera</a> algorithm. Subsequent accesses on the same <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface③">XRView</a></code> instance MUST result the same <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera②">XRCamera</a></code> instance if one was returned, or <code>null</code> otherwise.</p>
   <div class="algorithm" data-algorithm="obtain-camera">
    <p>In order to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-camera">obtain camera</dfn> for <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface④">XRView</a></code> <var>view</var>, the user agent MUST run the following steps:</p>
    <ol>
     <li data-md>
      <p>Let <var>session</var> be the <var>view</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrview-session" id="ref-for-xrview-session">session</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access">camera-access</a> feature descriptor is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contained</a> in the <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#set-of-granted-features" id="ref-for-set-of-granted-features">set of granted features</a>, return <code>null</code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>frame</var> be the <var>view</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrview-frame" id="ref-for-xrview-frame">frame</a>.</p>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-active" id="ref-for-xrframe-active">active</a> boolean is <code>false</code>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw">throw</a> an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-animationframe" id="ref-for-xrframe-animationframe">animationFrame</a> boolean is <code>false</code>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw①">throw</a> an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror①">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>camera image</var> contain a camera image buffer of size <var>width</var> by <var>height</var> texels that was returned from <a data-link-type="dfn" href="#native-camera" id="ref-for-native-camera①">native camera</a> that is valid for <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-time" id="ref-for-xrframe-time">time</a>.</p>
     <li data-md>
      <p>If <var>camera image</var> is <code>null</code>, return <code>null</code> and abort these steps.</p>
     <li data-md>
      <p>Ensure that <var>camera image</var> contains data that is <a data-link-type="dfn" href="#aligned" id="ref-for-aligned">aligned</a> with the <var>view</var>, including adjusting <var>width</var> and <var>height</var> as appropriate. If that is not possible, return <code>null</code> and abort these steps.</p>
     <li data-md>
      <p>Invoke <a data-link-type="dfn" href="#create-camera-instance" id="ref-for-create-camera-instance">create camera instance</a> algorithm with <var>view</var>, <var>camera image</var>, <var>width</var> and <var>height</var> and return its result.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.2" id="xr-camera-section"><span class="secno">3.2. </span><span class="content">XRCamera</span><a class="self-link" href="#xr-camera-section"></a></h3>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="xrcamera"><code><c- g>XRCamera</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="XRCamera" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-xrcamera-width"><code><c- g>width</c-></code></dfn>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long" id="ref-for-idl-unsigned-long①"><c- b>unsigned</c-> <c- b>long</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="XRCamera" data-dfn-type="attribute" data-export data-readonly data-type="unsigned long" id="dom-xrcamera-height"><code><c- g>height</c-></code></dfn>;
};
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera③">XRCamera</a></code> interface is introduced as a way to expose information about the camera texture that can be obtained from <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype" id="ref-for-XRWebGLBindingtype">XRWebGLBinding</a></code>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera④">XRCamera</a></code> contains <code class="idl"><a data-link-type="idl" href="#dom-xrcamera-width" id="ref-for-dom-xrcamera-width">width</a></code> attribute that contains the width (in texels) of the <a data-link-type="dfn" href="#xrcamera-camera-image" id="ref-for-xrcamera-camera-image">camera image</a>.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera⑤">XRCamera</a></code> contains <code class="idl"><a data-link-type="idl" href="#dom-xrcamera-height" id="ref-for-dom-xrcamera-height">height</a></code> attribute that contains the height (in texels) of the <a data-link-type="dfn" href="#xrcamera-camera-image" id="ref-for-xrcamera-camera-image①">camera image</a>.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera⑥">XRCamera</a></code> has an associated <dfn class="dfn-paneled" data-dfn-for="XRCamera" data-dfn-type="dfn" data-noexport id="xrcamera-view">view</dfn> instance that contains the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface⑤">XRView</a></code> from which the <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera⑦">XRCamera</a></code> instance was returned.</p>
   <p>Each <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera⑧">XRCamera</a></code> has an associated <dfn class="dfn-paneled" data-dfn-for="XRCamera" data-dfn-type="dfn" data-noexport id="xrcamera-camera-image">camera image</dfn> data buffer.</p>
   <div class="algorithm" data-algorithm="create-camera">
     In order to <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="create camera instance" data-noexport id="create-camera-instance"> create camera instance</dfn> from <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface⑥">XRView</a></code> <var>view</var>, <var>camera image</var>, <var>width</var> and <var>height</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>result</var> be a new instance of <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera⑨">XRCamera</a></code> interface.</p>
     <li data-md>
      <p>Set <var>result</var>’s <a data-link-type="dfn" href="#xrcamera-view" id="ref-for-xrcamera-view">view</a> to <var>view</var>.</p>
     <li data-md>
      <p>Set <var>result</var>’s <a data-link-type="dfn" href="#xrcamera-camera-image" id="ref-for-xrcamera-camera-image②">camera image</a> to <var>camera image</var>.</p>
     <li data-md>
      <p>Set <var>result</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrcamera-width" id="ref-for-dom-xrcamera-width①">width</a></code> to <var>width</var>.</p>
     <li data-md>
      <p>Set <var>result</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrcamera-height" id="ref-for-dom-xrcamera-height①">height</a></code> to <var>height</var>.</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.3" id="xr-web-gl-binding-section"><span class="secno">3.3. </span><span class="content">XRWebGLBinding</span><a class="self-link" href="#xr-web-gl-binding-section"></a></h3>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype" id="ref-for-XRWebGLBindingtype①"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9"><c- n>WebGLTexture</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="XRWebGLBinding" data-dfn-type="method" data-export data-lt="getCameraImage(camera)" id="dom-xrwebglbinding-getcameraimage"><code><c- g>getCameraImage</c-></code></dfn>(<a data-link-type="idl-name" href="#xrcamera" id="ref-for-xrcamera①⓪"><c- n>XRCamera</c-></a> <dfn class="idl-code" data-dfn-for="XRWebGLBinding/getCameraImage(camera)" data-dfn-type="argument" data-export id="dom-xrwebglbinding-getcameraimage-camera-camera"><code><c- g>camera</c-></code><a class="self-link" href="#dom-xrwebglbinding-getcameraimage-camera-camera"></a></dfn>);
};
</pre>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-xrwebglbinding-getcameraimage" id="ref-for-dom-xrwebglbinding-getcameraimage">getCameraImage(camera)</a></code> method, when invoked, can be used to <a data-link-type="dfn" href="#obtain-camera-image" id="ref-for-obtain-camera-image">obtain camera image</a> from an <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype" id="ref-for-XRWebGLBindingtype②">XRWebGLBinding</a></code>. The returned <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9①">WebGLTexture</a></code>, if non-<code>null</code>, is an <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#opaque-texture" id="ref-for-opaque-texture">opaque texture</a>.</p>
   <div class="algorithm" data-algorithm="obtain-camera-image">
     In order to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="obtain-camera-image">obtain camera image</dfn> from <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype" id="ref-for-XRWebGLBindingtype③">XRWebGLBinding</a></code> <var>binding</var>, for <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera①①">XRCamera</a></code> <var>camera</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>session</var> be <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#xrwebglbinding-session" id="ref-for-xrwebglbinding-session">session</a>.</p>
     <li data-md>
      <p>Let <var>view</var> be <var>camera</var>’s <a data-link-type="dfn" href="#xrcamera-view" id="ref-for-xrcamera-view①">view</a>.</p>
     <li data-md>
      <p>If <var>view</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrview-session" id="ref-for-xrview-session①">session</a> does not match <var>session</var>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw②">throw</a> an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror②">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>frame</var> be the <var>view</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrview-frame" id="ref-for-xrview-frame①">frame</a>.</p>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-active" id="ref-for-xrframe-active①">active</a> boolean is <code>false</code>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw③">throw</a> an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror③">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-animationframe" id="ref-for-xrframe-animationframe①">animationFrame</a> boolean is <code>false</code>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#dfn-throw" id="ref-for-dfn-throw④">throw</a> an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror④">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>context</var> be the <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#xrwebglbinding-context" id="ref-for-xrwebglbinding-context">context</a>.</p>
     <li data-md>
      <p>Let <var>camera image</var> be the <var>camera</var>’s <a data-link-type="dfn" href="#xrcamera-camera-image" id="ref-for-xrcamera-camera-image③">camera image</a>.</p>
     <li data-md>
      <p>Let <var>result</var> be a <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9②">WebGLTexture</a></code> that was created on <var>context</var>, containing <var>camera image</var>’s data. <var>result</var> is an <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#opaque-texture" id="ref-for-opaque-texture①">opaque texture</a>.</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <p>The user agent MAY cache the results of a call to <code class="idl"><a data-link-type="idl" href="#dom-xrwebglbinding-getcameraimage" id="ref-for-dom-xrwebglbinding-getcameraimage①">getCameraImage(camera)</a></code> to be returned for subsequent calls of the method, assuming that the cache is keyed by the binding and the camera instance. The user agent MUST perform initial validations even when using the cache by running up to step 6 (inclusive) of <a data-link-type="dfn" href="#obtain-camera-image" id="ref-for-obtain-camera-image①">obtain camera image</a> algorithm. Because this caching is permitted, the application SHOULD treat the returned <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9③">WebGLTexture</a></code> as read-only.</p>
   <p class="note" role="note"><span class="marker">Note:</span> caching is permitted because the user agent retains ownership of the lifetime of the returned <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9④">WebGLTexture</a></code> (since it’s considered an <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#opaque-texture" id="ref-for-opaque-texture②">opaque texture</a>), and because calling this method multiple times within the same <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#requestanimationframe" id="ref-for-requestanimationframe">requestAnimationFrame()</a> callback (ensured by using <code class="idl"><a data-link-type="idl" href="#xrcamera" id="ref-for-xrcamera①②">XRCamera</a></code>, &amp; therefore <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface">XRFrame</a></code> transitively as a part of the cache key), on the same binding (ensured by using <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype" id="ref-for-XRWebGLBindingtype④">XRWebGLBinding</a></code> as a part of the cache key), will result in textures with identical contents.</p>
   <p>If the <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9⑤">WebGLTexture</a></code> returned from a call to <code class="idl"><a data-link-type="idl" href="#dom-xrwebglbinding-getcameraimage" id="ref-for-dom-xrwebglbinding-getcameraimage②">getCameraImage(camera)</a></code> supports transparency, it MUST contain colors with premultiplied alpha.</p>
   <p class="issue" id="issue-63423cac"><a class="self-link" href="#issue-63423cac"></a> Should we specify more information about the returned <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9" id="ref-for-5.9⑥">WebGLTexture</a></code>? E.g.: is color-renderable, what is the texture format, etc.</p>
   <h2 class="heading settled" data-level="4" id="native-device-concepts"><span class="secno">4. </span><span class="content">Native device concepts</span><a class="self-link" href="#native-device-concepts"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="native-camera-section"><span class="secno">4.1. </span><span class="content">Native camera</span><a class="self-link" href="#native-camera-section"></a></h3>
   <section class="non-normative">
    <p>Raw camera API specification assumes that the native device on top of which the API is implemented provides a way to access animation-frame-synchronized access to the camera image. Such a device is said to support a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="native-camera">native camera</dfn> capability.</p>
    <p>In addition for the device to being able to provide a camera image, the Raw Camera Access API can only provide camera image textures that are <a data-link-type="dfn" href="#aligned" id="ref-for-aligned①">aligned</a> with an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface⑦">XRView</a></code> from which they are requested. The camera image is said to be <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="aligned">aligned</dfn> with the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface⑧">XRView</a></code> if the camera pose is the same as the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface⑨">XRView</a></code>'s pose, and the camera’s viewing frustum has the same shape as <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface①⓪">XRView</a></code>'s viewing frustum. If the camera image returned by the <a data-link-type="dfn" href="#native-camera" id="ref-for-native-camera②">native camera</a> covers a viewing frustum that entirely contains the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface①①">XRView</a></code>'s viewing frustum, the user agent can crop the camera image as long as the operation causes the viewing frustum shapes to match exactly.</p>
   </section>
   <h2 class="heading settled" data-level="5" id="privacy-security"><span class="secno">5. </span><span class="content">Privacy &amp; Security Considerations</span><a class="self-link" href="#privacy-security"></a></h2>
   <section class="non-normative">
    <p>The Raw Camera Access API has the highest privacy implications out of all currently available WebXR capabilities, in that it is the only API that allows the applications to directly observe the user’s environment. Due to this, the user agents should seek user consent prior to allowing creating sessions with <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access①">camera-access</a> feature enabled. Refer to <a href="https://immersive-web.github.io/webxr/#security">WebXR Device API § security</a> &amp; <a href="https://immersive-web.github.io/webxr/#user-intention">WebXR Device API § user-intention</a> sections for more details, as well as <a href="#user-experience">§ 5.1 User experience</a> &amp; <a href="#privacy-indicators">§ 5.2 Privacy indicators</a> sections below.</p>
    <p>The requirement that the provided camera images are <a data-link-type="dfn" href="#aligned" id="ref-for-aligned②">aligned</a> with the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrview-interface" id="ref-for-xrview-interface①②">XRView</a></code>s offers a partial mitigation for impact of the API on users' privacy. A consequence of this requirement is that depending on the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xr-compositor" id="ref-for-xr-compositor">XR Compositor</a>'s <a data-link-type="dfn" href="https://immersive-web.github.io/webxr-ar-module/#blend-technique" id="ref-for-blend-technique">blend technique</a>, the camera image will contain the same information that the user may already be seeing, thus providing direct feedback about which parts of the environment are visible to the website. Note that in some cases it would be possible for the sites to suppress this information (e.g. on smartphones by rendering an opaque object that would encompass the entire view, thus occluding the environment rendered by the compositor).</p>
    <p>In addition to the requirement for the user agents to seek user consent, the application developers are strongly encouraged not to ask for <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access②">camera-access</a> feature if there are other means of achieving their use cases.</p>
   </section>
   <h3 class="heading settled" data-level="5.1" id="user-experience"><span class="secno">5.1. </span><span class="content">User experience</span><a class="self-link" href="#user-experience"></a></h3>
   <section class="non-normative">
    <p>As stated above, due to privacy implications of Raw Camera Access API, the user agent should seek user consent prior to creating a session with <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access③">camera-access</a> feature enabled. This can be achieved in multiple ways, some of which would require interacting with the user directly.</p>
    <p>Some examples of interacting with the user directly are:</p>
    <ol>
     <li data-md>
      <p>Displaying a permission prompt that allows the user to select how fine-grained information will be exposed to the site. Mock of such prompt can be seen below.</p>
    </ol>
    <p align="center"> <img src="img/permission-mock.png"> </p>
    <ol start="2">
     <li data-md>
      <p>Displaying a series of permission prompts that would take into consideration various levels of user consent needed in order to create a session with the requested and optional features provided by the application to <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/webxr/#dom-xrsystem-requestsession" id="ref-for-dom-xrsystem-requestsession">requestSession()</a></code> call.</p>
    </ol>
    <p>It is the intent of this specification to ensure that the user agent does not encourage app developers to ask for <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access④">camera-access</a> feature if the experience they want to provide does not absolutely require it. Due to privacy implications of the feature, user agents are allowed to introduce additional friction when a site asks for access to the camera images, with the hopes that this would incentivize the applications to not ask for the feature needlessly.</p>
    <p>User Agents should consider re-using permissions UI (or permissions granted to the origin already) for the <a data-link-type="dfn">powerful feature</a> "<a data-link-type="dfn" href="https://www.w3.org/TR/mediacapture-streams/#dfn-camera" id="ref-for-dfn-camera">camera</a>".</p>
   </section>
   <h3 class="heading settled" data-level="5.2" id="privacy-indicators"><span class="secno">5.2. </span><span class="content">Privacy indicators</span><a class="self-link" href="#privacy-indicators"></a></h3>
   <p>The user agent MUST display a privacy indicator every time an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface①">XRSession</a></code> with <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access⑤">camera-access</a> has been created and has not yet <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#ended" id="ref-for-ended">ended</a>. If it ever becomes possible to modify a <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#set-of-granted-features" id="ref-for-set-of-granted-features①">set of granted features</a> of a session after a session has been created, the indicator SHOULD be displayed for at least as long as the <a data-link-type="dfn" href="#camera-access" id="ref-for-camera-access⑥">camera-access</a> feature descriptor is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain①">contained</a> in the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#set-of-granted-features" id="ref-for-set-of-granted-features②">set of granted features</a> of the session.</p>
   <section class="non-normative-remainder">
    <p>The indicator displayed to the user should communicate the fact that the device’s camera is in-use and the site has access to it, and thus they should take extra care to ensure that the content that falls within the field of view of the camera is something they are comfortable sharing with the site. This is especially true in a public setting, where bystanders that did not consent to being recorded may be present.</p>
    <p>The example indicators consist of (but are not limited to):</p>
    <ul>
     <li data-md>
      <p>on a mobile device, displaying a notification in the status bar that the camera is in use;</p>
     <li data-md>
      <p>rendering a UI element (e.g. a border around the content, a round icon symbolizing "Record" button, etc.) that suggests that the content is being recorded;</p>
     <li data-md>
      <p>using a LED indicator of the recording device (if present and controllable by user agent);</p>
     <li data-md>
      <p>emitting a camera shutter sound effect at the start of the session;</p>
    </ul>
   </section>
   <h2 class="heading settled" data-level="6" id="ack"><span class="secno">6. </span><span class="content">Acknowledgements</span><a class="self-link" href="#ack"></a></h2>
   <p>The following individuals have contributed to the design of the WebXR Raw Camera Access specification:</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#aligned">aligned</a><span>, in § 4.1</span>
   <li><a href="#dom-xrview-camera">camera</a><span>, in § 3.1</span>
   <li><a href="#camera-access">camera-access</a><span>, in § 2.1</span>
   <li><a href="#xrcamera-camera-image">camera image</a><span>, in § 3.2</span>
   <li><a href="#create-camera-instance">create camera instance</a><span>, in § 3.2</span>
   <li><a href="#dom-xrwebglbinding-getcameraimage">getCameraImage(camera)</a><span>, in § 3.3</span>
   <li><a href="#dom-xrcamera-height">height</a><span>, in § 3.2</span>
   <li><a href="#native-camera">native camera</a><span>, in § 4.1</span>
   <li><a href="#obtain-camera">obtain camera</a><span>, in § 3.1</span>
   <li><a href="#obtain-camera-image">obtain camera image</a><span>, in § 3.3</span>
   <li><a href="#xrcamera-view">view</a><span>, in § 3.2</span>
   <li><a href="#dom-xrcamera-width">width</a><span>, in § 3.2</span>
   <li><a href="#xrcamera">XRCamera</a><span>, in § 3.2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-list-contain">
   <a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">3.1. XRView</a>
    <li><a href="#ref-for-list-contain①">5.2. Privacy indicators</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-camera">
   <a href="https://www.w3.org/TR/mediacapture-streams/#dfn-camera">https://www.w3.org/TR/mediacapture-streams/#dfn-camera</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-camera">5.1. User experience</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-5.9">
   <a href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9">https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-5.9">3.3. XRWebGLBinding</a> <a href="#ref-for-5.9①">(2)</a> <a href="#ref-for-5.9②">(3)</a> <a href="#ref-for-5.9③">(4)</a> <a href="#ref-for-5.9④">(5)</a> <a href="#ref-for-5.9⑤">(6)</a> <a href="#ref-for-5.9⑥">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">3.2. XRCamera</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invalidstateerror">
   <a href="https://webidl.spec.whatwg.org/#invalidstateerror">https://webidl.spec.whatwg.org/#invalidstateerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invalidstateerror">3.1. XRView</a> <a href="#ref-for-invalidstateerror①">(2)</a>
    <li><a href="#ref-for-invalidstateerror②">3.3. XRWebGLBinding</a> <a href="#ref-for-invalidstateerror③">(2)</a> <a href="#ref-for-invalidstateerror④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SameObject">
   <a href="https://webidl.spec.whatwg.org/#SameObject">https://webidl.spec.whatwg.org/#SameObject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SameObject">3.1. XRView</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
   <a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">3.2. XRCamera</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-throw">
   <a href="https://webidl.spec.whatwg.org/#dfn-throw">https://webidl.spec.whatwg.org/#dfn-throw</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-throw">3.1. XRView</a> <a href="#ref-for-dfn-throw①">(2)</a>
    <li><a href="#ref-for-dfn-throw②">3.3. XRWebGLBinding</a> <a href="#ref-for-dfn-throw③">(2)</a> <a href="#ref-for-dfn-throw④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unsigned-long">
   <a href="https://webidl.spec.whatwg.org/#idl-unsigned-long">https://webidl.spec.whatwg.org/#idl-unsigned-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long">3.2. XRCamera</a> <a href="#ref-for-idl-unsigned-long①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-xrsystem-requestsession">
   <a href="https://immersive-web.github.io/webxr/#dom-xrsystem-requestsession">https://immersive-web.github.io/webxr/#dom-xrsystem-requestsession</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrsystem-requestsession">5.1. User experience</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-blend-technique">
   <a href="https://immersive-web.github.io/webxr-ar-module/#blend-technique">https://immersive-web.github.io/webxr-ar-module/#blend-technique</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-blend-technique">5. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-interface">
   <a href="https://www.w3.org/TR/webxr/#xrframe-interface">https://www.w3.org/TR/webxr/#xrframe-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-interface">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrsession-interface">
   <a href="https://www.w3.org/TR/webxr/#xrsession-interface">https://www.w3.org/TR/webxr/#xrsession-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-interface">2.1. Feature descriptor</a>
    <li><a href="#ref-for-xrsession-interface①">5.2. Privacy indicators</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrview-interface">
   <a href="https://www.w3.org/TR/webxr/#xrview-interface">https://www.w3.org/TR/webxr/#xrview-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrview-interface">3.1. XRView</a> <a href="#ref-for-xrview-interface①">(2)</a> <a href="#ref-for-xrview-interface②">(3)</a> <a href="#ref-for-xrview-interface③">(4)</a> <a href="#ref-for-xrview-interface④">(5)</a>
    <li><a href="#ref-for-xrview-interface⑤">3.2. XRCamera</a> <a href="#ref-for-xrview-interface⑥">(2)</a>
    <li><a href="#ref-for-xrview-interface⑦">4.1. Native camera</a> <a href="#ref-for-xrview-interface⑧">(2)</a> <a href="#ref-for-xrview-interface⑨">(3)</a> <a href="#ref-for-xrview-interface①⓪">(4)</a> <a href="#ref-for-xrview-interface①①">(5)</a>
    <li><a href="#ref-for-xrview-interface①②">5. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-active">
   <a href="https://www.w3.org/TR/webxr/#xrframe-active">https://www.w3.org/TR/webxr/#xrframe-active</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-active">3.1. XRView</a>
    <li><a href="#ref-for-xrframe-active①">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-animationframe">
   <a href="https://www.w3.org/TR/webxr/#xrframe-animationframe">https://www.w3.org/TR/webxr/#xrframe-animationframe</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-animationframe">3.1. XRView</a>
    <li><a href="#ref-for-xrframe-animationframe①">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-capable-of-supporting">
   <a href="https://www.w3.org/TR/webxr/#capable-of-supporting">https://www.w3.org/TR/webxr/#capable-of-supporting</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-capable-of-supporting">2.1. Feature descriptor</a> <a href="#ref-for-capable-of-supporting①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ended">
   <a href="https://www.w3.org/TR/webxr/#ended">https://www.w3.org/TR/webxr/#ended</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ended">5.2. Privacy indicators</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-feature-descriptor">
   <a href="https://www.w3.org/TR/webxr/#feature-descriptor">https://www.w3.org/TR/webxr/#feature-descriptor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-feature-descriptor">2.1. Feature descriptor</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrview-frame">
   <a href="https://www.w3.org/TR/webxr/#xrview-frame">https://www.w3.org/TR/webxr/#xrview-frame</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrview-frame">3.1. XRView</a>
    <li><a href="#ref-for-xrview-frame①">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-inline-xr-device">
   <a href="https://www.w3.org/TR/webxr/#inline-xr-device">https://www.w3.org/TR/webxr/#inline-xr-device</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-inline-xr-device">2.1. Feature descriptor</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-permissions-policy">
   <a href="https://www.w3.org/TR/webxr/#permissions-policy">https://www.w3.org/TR/webxr/#permissions-policy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-permissions-policy">2.1. Feature descriptor</a> <a href="#ref-for-permissions-policy①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-requestanimationframe">
   <a href="https://www.w3.org/TR/webxr/#requestanimationframe">https://www.w3.org/TR/webxr/#requestanimationframe</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-requestanimationframe">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrview-session">
   <a href="https://www.w3.org/TR/webxr/#xrview-session">https://www.w3.org/TR/webxr/#xrview-session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrview-session">3.1. XRView</a>
    <li><a href="#ref-for-xrview-session①">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-of-granted-features">
   <a href="https://www.w3.org/TR/webxr/#set-of-granted-features">https://www.w3.org/TR/webxr/#set-of-granted-features</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-of-granted-features">3.1. XRView</a>
    <li><a href="#ref-for-set-of-granted-features①">5.2. Privacy indicators</a> <a href="#ref-for-set-of-granted-features②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-time">
   <a href="https://www.w3.org/TR/webxr/#xrframe-time">https://www.w3.org/TR/webxr/#xrframe-time</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-time">3.1. XRView</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xr-compositor">
   <a href="https://www.w3.org/TR/webxr/#xr-compositor">https://www.w3.org/TR/webxr/#xr-compositor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xr-compositor">5. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-XRWebGLBindingtype">
   <a href="https://immersive-web.github.io/layers/#XRWebGLBindingtype">https://immersive-web.github.io/layers/#XRWebGLBindingtype</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-XRWebGLBindingtype">3.2. XRCamera</a>
    <li><a href="#ref-for-XRWebGLBindingtype①">3.3. XRWebGLBinding</a> <a href="#ref-for-XRWebGLBindingtype②">(2)</a> <a href="#ref-for-XRWebGLBindingtype③">(3)</a> <a href="#ref-for-XRWebGLBindingtype④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrwebglbinding-context">
   <a href="https://immersive-web.github.io/layers/#xrwebglbinding-context">https://immersive-web.github.io/layers/#xrwebglbinding-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding-context">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-opaque-texture">
   <a href="https://immersive-web.github.io/layers/#opaque-texture">https://immersive-web.github.io/layers/#opaque-texture</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-opaque-texture">3.3. XRWebGLBinding</a> <a href="#ref-for-opaque-texture①">(2)</a> <a href="#ref-for-opaque-texture②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrwebglbinding-session">
   <a href="https://immersive-web.github.io/layers/#xrwebglbinding-session">https://immersive-web.github.io/layers/#xrwebglbinding-session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding-session">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-contain">contain</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MEDIA CAPTURE AND STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dfn-camera">camera</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBGL-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-5.9">WebGLTexture</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-invalidstateerror">InvalidStateError</span>
     <li><span class="dfn-paneled" id="term-for-SameObject">SameObject</span>
     <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
     <li><span class="dfn-paneled" id="term-for-dfn-throw">throw</span>
     <li><span class="dfn-paneled" id="term-for-idl-unsigned-long">unsigned long</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dom-xrsystem-requestsession">requestSession(mode)</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR AUGMENTED REALITY MODULE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-blend-technique">blend technique</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR DEVICE API - LEVEL 1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-xrframe-interface">XRFrame</span>
     <li><span class="dfn-paneled" id="term-for-xrsession-interface">XRSession</span>
     <li><span class="dfn-paneled" id="term-for-xrview-interface">XRView</span>
     <li><span class="dfn-paneled" id="term-for-xrframe-active">active</span>
     <li><span class="dfn-paneled" id="term-for-xrframe-animationframe">animationframe</span>
     <li><span class="dfn-paneled" id="term-for-capable-of-supporting">capable of supporting</span>
     <li><span class="dfn-paneled" id="term-for-ended">ended</span>
     <li><span class="dfn-paneled" id="term-for-feature-descriptor">feature descriptor</span>
     <li><span class="dfn-paneled" id="term-for-xrview-frame">frame</span>
     <li><span class="dfn-paneled" id="term-for-inline-xr-device">inline xr device</span>
     <li><span class="dfn-paneled" id="term-for-permissions-policy">permissions policy</span>
     <li><span class="dfn-paneled" id="term-for-requestanimationframe">requestanimationframe()</span>
     <li><span class="dfn-paneled" id="term-for-xrview-session">session</span>
     <li><span class="dfn-paneled" id="term-for-set-of-granted-features">set of granted features</span>
     <li><span class="dfn-paneled" id="term-for-xrframe-time">time</span>
     <li><span class="dfn-paneled" id="term-for-xr-compositor">xr compositor</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR LAYERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-XRWebGLBindingtype">XRWebGLBinding</span>
     <li><span class="dfn-paneled" id="term-for-xrwebglbinding-context">context</span>
     <li><span class="dfn-paneled" id="term-for-opaque-texture">opaque texture</span>
     <li><span class="dfn-paneled" id="term-for-xrwebglbinding-session">session</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-webgl-2">[WEBGL-2]
   <dd>Dean Jackson; Jeff Gilbert. <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/"><cite>WebGL 2.0 Specification</cite></a>. 12 August 2017. URL: <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/">https://www.khronos.org/registry/webgl/specs/latest/2.0/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-webxr">[WEBXR]
   <dd>Brandon Jones; Manish Goregaokar; Rik Cabanier. <a href="https://immersive-web.github.io/webxr/"><cite>WebXR Device API</cite></a>. URL: <a href="https://immersive-web.github.io/webxr/">https://immersive-web.github.io/webxr/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrview-interface"><c- g>XRView</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SameObject"><c- g>SameObject</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#xrcamera"><c- n>XRCamera</c-></a>? <a data-readonly data-type="XRCamera?" href="#dom-xrview-camera"><code><c- g>camera</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#xrcamera"><code><c- g>XRCamera</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a> <a data-readonly data-type="unsigned long" href="#dom-xrcamera-width"><code><c- g>width</c-></code></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-unsigned-long"><c- b>unsigned</c-> <c- b>long</c-></a> <a data-readonly data-type="unsigned long" href="#dom-xrcamera-height"><code><c- g>height</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#XRWebGLBindingtype"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9"><c- n>WebGLTexture</c-></a>? <a href="#dom-xrwebglbinding-getcameraimage"><code><c- g>getCameraImage</c-></code></a>(<a data-link-type="idl-name" href="#xrcamera"><c- n>XRCamera</c-></a> <a href="#dom-xrwebglbinding-getcameraimage-camera-camera"><code><c- g>camera</c-></code></a>);
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Should we specify more information about the returned <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#5.9">WebGLTexture</a></code>? E.g.: is color-renderable, what is the texture format, etc. <a class="issue-return" href="#issue-63423cac" title="Jump to section">↵</a></div>
  </div>
  <aside class="dfn-panel" data-for="camera-access">
   <b><a href="#camera-access">#camera-access</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-camera-access">3.1. XRView</a>
    <li><a href="#ref-for-camera-access①">5. Privacy &amp; Security Considerations</a> <a href="#ref-for-camera-access②">(2)</a>
    <li><a href="#ref-for-camera-access③">5.1. User experience</a> <a href="#ref-for-camera-access④">(2)</a>
    <li><a href="#ref-for-camera-access⑤">5.2. Privacy indicators</a> <a href="#ref-for-camera-access⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrview-camera">
   <b><a href="#dom-xrview-camera">#dom-xrview-camera</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrview-camera">3.1. XRView</a> <a href="#ref-for-dom-xrview-camera①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-camera">
   <b><a href="#obtain-camera">#obtain-camera</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-camera">3.1. XRView</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrcamera">
   <b><a href="#xrcamera">#xrcamera</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrcamera">3.1. XRView</a> <a href="#ref-for-xrcamera①">(2)</a> <a href="#ref-for-xrcamera②">(3)</a>
    <li><a href="#ref-for-xrcamera③">3.2. XRCamera</a> <a href="#ref-for-xrcamera④">(2)</a> <a href="#ref-for-xrcamera⑤">(3)</a> <a href="#ref-for-xrcamera⑥">(4)</a> <a href="#ref-for-xrcamera⑦">(5)</a> <a href="#ref-for-xrcamera⑧">(6)</a> <a href="#ref-for-xrcamera⑨">(7)</a>
    <li><a href="#ref-for-xrcamera①⓪">3.3. XRWebGLBinding</a> <a href="#ref-for-xrcamera①①">(2)</a> <a href="#ref-for-xrcamera①②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrcamera-width">
   <b><a href="#dom-xrcamera-width">#dom-xrcamera-width</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrcamera-width">3.2. XRCamera</a> <a href="#ref-for-dom-xrcamera-width①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrcamera-height">
   <b><a href="#dom-xrcamera-height">#dom-xrcamera-height</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrcamera-height">3.2. XRCamera</a> <a href="#ref-for-dom-xrcamera-height①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrcamera-view">
   <b><a href="#xrcamera-view">#xrcamera-view</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrcamera-view">3.2. XRCamera</a>
    <li><a href="#ref-for-xrcamera-view①">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrcamera-camera-image">
   <b><a href="#xrcamera-camera-image">#xrcamera-camera-image</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrcamera-camera-image">3.2. XRCamera</a> <a href="#ref-for-xrcamera-camera-image①">(2)</a> <a href="#ref-for-xrcamera-camera-image②">(3)</a>
    <li><a href="#ref-for-xrcamera-camera-image③">3.3. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-camera-instance">
   <b><a href="#create-camera-instance">#create-camera-instance</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-camera-instance">3.1. XRView</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrwebglbinding-getcameraimage">
   <b><a href="#dom-xrwebglbinding-getcameraimage">#dom-xrwebglbinding-getcameraimage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrwebglbinding-getcameraimage">3.3. XRWebGLBinding</a> <a href="#ref-for-dom-xrwebglbinding-getcameraimage①">(2)</a> <a href="#ref-for-dom-xrwebglbinding-getcameraimage②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="obtain-camera-image">
   <b><a href="#obtain-camera-image">#obtain-camera-image</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-obtain-camera-image">3.3. XRWebGLBinding</a> <a href="#ref-for-obtain-camera-image①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="native-camera">
   <b><a href="#native-camera">#native-camera</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-native-camera">2.1. Feature descriptor</a>
    <li><a href="#ref-for-native-camera①">3.1. XRView</a>
    <li><a href="#ref-for-native-camera②">4.1. Native camera</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="aligned">
   <b><a href="#aligned">#aligned</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aligned">3.1. XRView</a>
    <li><a href="#ref-for-aligned①">4.1. Native camera</a>
    <li><a href="#ref-for-aligned②">5. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    "use strict";
    {
        document.addEventListener("click", e=>{
            if(e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>