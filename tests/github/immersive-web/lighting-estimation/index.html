<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>WebXR Lighting Estimation API Level 1</title>
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet" type="text/css">
  <link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
  <link href="favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
<style>
  .unstable::before {
    content: "This section is not stable";
    display: block;
    font-weight: bold;
    text-align: right;
    color: red;
  }
  .unstable {
    border: thin solid pink;
    border-radius: .5em;
    padding: .5em;
    margin: .5em calc(-0.5em - 1px);
    background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='300' height='290'><text transform='rotate(-45)' text-anchor='middle' font-family='sans-serif' font-weight='bold' font-size='70' y='210' opacity='.1'>Unstable</text></svg>");
    background-repeat: repeat;
    background-color: #FFF4F4;
  }
  .unstable h3:first-of-type {
    margin-top: 0.5rem;
  }

  .unstable.example:not(.no-marker)::before {
    content: "Example " counter(example) " (Unstable)";
    float: none;
  }

  .non-normative::before {
    content: "This section is non-normative.";
    font-style: italic;
  }
  .tg {
    border-collapse: collapse;
    border-spacing: 0;
  }
  .tg th {
    border-style: solid;
    border-width: 1px;
    background: #90b8de;
    color: #fff;
    font-family: sans-serif;
    font-weight: bold;
    border-color: grey;
  }
  .tg td {
    padding: 4px 5px;
    background-color: rgb(221, 238, 255);
    font-family: monospace;
    border-style: solid;
    border-width: 1px;
    border-color: grey;
    overflow: hidden;
    word-break: normal;
  }
</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-dfn-panel */

:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">WebXR Lighting Estimation API Level 1</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="profile-and-date"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Previous Versions:
     <dd><a href rel="prev"></a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:bajones@google.com">Brandon Jones</a> (<a class="p-org org" href="https://google.com">Google</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:kgilbert@mozilla.com">Kearwood Gilbert</a> (<a class="p-org org" href="https://mozilla.org/">Mozilla</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="https://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="https://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="https://www.keio.ac.jp/">Keio</a>, <a href="https://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification describes support for exposing estimates of environmental lighting conditions to WebXR sessions.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other
    documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="https://www.w3.org/immersive-web/">Immersive Web Working Group</a> as an Editors' Draft. This document is intended to become a W3C Recommendation.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/immersive-web/lighting-estimation/issues">Github issues</a>.
    Discussions may also be found in the <a href="http://lists.w3.org/Archives/Public/public-immersive-web/">public-immersive-web@w3.org archives</a>. </p>
   <p> Publication as an Editors' Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20170801/"> <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/groups/wg/immersive-web/ipr" rel="disclosure">public list of any
    patent disclosures</a> made in connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual who has actual knowledge of a
    patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20170801/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20170801/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2020/Process-20200915/" id="w3c_process_revision">15 September 2020 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#light-primitives"><span class="secno">2</span> <span class="content">Light Primitives</span></a>
     <ol class="toc">
      <li><a href="#xrlightprobe-interface"><span class="secno">2.1</span> <span class="content">XRLightProbe</span></a>
      <li><a href="#xrreflectionformat-interface"><span class="secno">2.2</span> <span class="content">XRReflectionFormat</span></a>
      <li><a href="#xrlightestimate-interface"><span class="secno">2.3</span> <span class="content">XRLightEstimate</span></a>
     </ol>
    <li>
     <a href="#webxr-device-api-integration"><span class="secno">3</span> <span class="content">WebXR Device API Integration</span></a>
     <ol class="toc">
      <li><a href="#session-initialization"><span class="secno">3.1</span> <span class="content">Session Initialization</span></a>
      <li><a href="#xrsession-interface"><span class="secno">3.2</span> <span class="content">XRSession</span></a>
      <li><a href="#xrframe-interface"><span class="secno">3.3</span> <span class="content">XRFrame</span></a>
     </ol>
    <li>
     <a href="#webxr-layers-integration"><span class="secno">4</span> <span class="content">WebXR Layers Integration</span></a>
     <ol class="toc">
      <li><a href="#xrwebglbinding-interface"><span class="secno">4.1</span> <span class="content">XRWebGLBinding</span></a>
     </ol>
    <li>
     <a href="#events"><span class="secno">5</span> <span class="content">Events</span></a>
     <ol class="toc">
      <li><a href="#event-types"><span class="secno">5.1</span> <span class="content">Event Types</span></a>
     </ol>
    <li><a href="#privacy-security"><span class="secno">6</span> <span class="content">Privacy &amp; Security Considerations</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>The WebXR Lighting Estimation module expands the <a href="https://www.w3.org/TR/webxr/">WebXR Device API</a>, the <a href="https://immersive-web.github.io/webxr-ar-module/">WebXR Augmented Reality Module</a>, and the <a href="https://immersive-web.github.io/layers/">WebXR Layers module</a> with the ability to expose estimates of the lighting conditions of the user’s environment.</p>
   <h2 class="heading settled" data-level="2" id="light-primitives"><span class="secno">2. </span><span class="content">Light Primitives</span><a class="self-link" href="#light-primitives"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="xrlightprobe-interface"><span class="secno">2.1. </span><span class="content">XRLightProbe</span><a class="self-link" href="#xrlightprobe-interface"></a></h3>
   <p>An <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe">XRLightProbe</a></code> collects estimated lighting information at a given point in the user’s environment.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="xrlightprobe"><code><c- g>XRLightProbe</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://immersive-web.github.io/webxr/#xrspace" id="ref-for-xrspace"><c- n>XRSpace</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="XRSpace" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace"><c- g>probeSpace</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-xrlightprobe-onreflectionchange" id="ref-for-dom-xrlightprobe-onreflectionchange"><c- g>onreflectionchange</c-></a>;
};
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="attribute" data-export id="dom-xrlightprobe-probespace"><code>probeSpace</code></dfn> attribute is an <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/webxr/#xrspace" id="ref-for-xrspace①">XRSpace</a></code> that has a <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrspace-native-origin" id="ref-for-xrspace-native-origin">native origin</a> tracking the position and orientation that the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①">XRLightProbe</a></code>'s lighting estimations are being generated relative to.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="attribute" data-export id="dom-xrlightprobe-onreflectionchange"><code>onreflectionchange</code></dfn> attribute is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes" id="ref-for-event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#eventdef-xrlightprobe-reflectionchange" id="ref-for-eventdef-xrlightprobe-reflectionchange">reflectionchange</a></code> event type.</p>
   <h3 class="heading settled" data-level="2.2" id="xrreflectionformat-interface"><span class="secno">2.2. </span><span class="content">XRReflectionFormat</span><a class="self-link" href="#xrreflectionformat-interface"></a></h3>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-xrreflectionformat"><code><c- g>XRReflectionFormat</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="XRReflectionFormat" data-dfn-type="enum-value" data-export id="dom-xrreflectionformat-srgba8"><code><c- s>"srgba8"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="XRReflectionFormat" data-dfn-type="enum-value" data-export id="dom-xrreflectionformat-rgba16f"><code><c- s>"rgba16f"</c-></code></dfn>,
};
</pre>
   <p>Reflection cube maps have an internal reflection format that indicates how the texture data is represented, and may change how applications choose to use the texture. Cube maps MAY be requested with the <code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8">"srgba8"</a></code> format or the <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat">preferredReflectionFormat</a></code> of the light probe.</p>
   <table class="data">
    <thead>
     <tr>
      <th><code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat">XRReflectionFormat</a></code> 
      <th>WebGL Format 
      <th>WebGL Internal Format 
      <th>WebGPU Format 
      <th>HDR 
    <tbody>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8①">"srgba8"</a></code> 
      <td>RGBA 
      <td>SRGB8_ALPHA8 
      <td>"rgba8unorm-srgb" 
      <td>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-rgba16f" id="ref-for-dom-xrreflectionformat-rgba16f">"rgba16f"</a></code> 
      <td>RGBA 
      <td>RGBA16F 
      <td>"rgba16float" 
      <td>✓ 
   </table>
   <h3 class="heading settled" data-level="2.3" id="xrlightestimate-interface"><span class="secno">2.3. </span><span class="content">XRLightEstimate</span><a class="self-link" href="#xrlightestimate-interface"></a></h3>
   <p>An <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate">XRLightEstimate</a></code> provides the estimated lighting values for an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe②">XRLightProbe</a></code> at the time represented by an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface">XRFrame</a></code>. <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate①">XRLightEstimate</a></code>s are queried by passing an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe③">XRLightProbe</a></code> to the <code class="idl"><a data-link-type="idl" href="#dom-xrframe-getlightestimate" id="ref-for-dom-xrframe-getlightestimate">getLightEstimate()</a></code> method of an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface①">XRFrame</a></code>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="xrlightestimate"><code><c- g>XRLightEstimate</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-Float32Array" id="ref-for-idl-Float32Array"><c- b>Float32Array</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Float32Array" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients"><c- g>sphericalHarmonicsCoefficients</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly" id="ref-for-dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection"><c- g>primaryLightDirection</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly" id="ref-for-dompointreadonly①"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity"><c- g>primaryLightIntensity</c-></a>;
};
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-sphericalharmonicscoefficients"><code>sphericalHarmonicsCoefficients</code></dfn> attribute returns a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Float32Array" id="ref-for-idl-Float32Array①">Float32Array</a></code> containing 9 spherical harmonics coefficients. The array MUST be 27 elements in length, with every 3 elements defining the red, green, and blue components respectively of a single coefficient. The first term of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients①">sphericalHarmonicsCoefficients</a></code>, meaning the first 3 elements of the array, MUST be representative of a valid lighting estimate. All other terms are optional, and MAY be 0 if a corresponding lighting estimate is not available due to either user privacy settings or the capabilities of the platform.</p>
   <p>The order of coefficients in <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients②">sphericalHarmonicsCoefficients</a></code>, is  [<var>C</var><sub>0</sub><sup>0</sup>, <var>C</var><sub>1</sub><sup>-1</sup>, <var>C</var><sub>1</sub><sup>0</sup>, <var>C</var><sub>1</sub><sup>1</sup>, <var>C</var><sub>2</sub><sup>-2</sup>, <var>C</var><sub>2</sub><sup>-1</sup>, <var>C</var><sub>2</sub><sup>0</sup>, <var>C</var><sub>2</sub><sup>1</sup>, <var>C</var><sub>2</sub><sup>2</sup>], where <var>C</var><sub><var>l</var></sub><sup><var>m</var></sup> is the coefficient of spherical harmonic <var>Y</var><sub><var>l</var></sub><sup><var>m</var></sup>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-primarylightdirection"><code>primaryLightDirection</code></dfn> represents the direction to the primary light source from the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrspace-native-origin" id="ref-for-xrspace-native-origin①">native origin</a> of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace①">probeSpace</a></code> of the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe④">XRLightProbe</a></code> that produced the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate②">XRLightEstimate</a></code>. The value MUST be a unit length 3D vector and the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w" id="ref-for-dom-dompointreadonly-w">w</a></code> value MUST be <code>0.0</code>. If estimated values from the users’s environment are not available the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection①">primaryLightDirection</a></code> MUST be <code>{ x: 0.0, y: 1.0, z: 0.0, w: 0.0 }</code>, representing a light shining straight down from above.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-primarylightintensity"><code>primaryLightIntensity</code></dfn> represents the direction to the primary light source from the origin of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace②">probeSpace</a></code> of the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑤">XRLightProbe</a></code> that produced the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate③">XRLightEstimate</a></code>. The value MUST represent an RGB value mapped to the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x" id="ref-for-dom-dompointreadonly-x">x</a></code>, <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y" id="ref-for-dom-dompointreadonly-y">y</a></code>, and <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z" id="ref-for-dom-dompointreadonly-z">z</a></code> values respectively where each component is greater than or equal to <code>0.0</code> and the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w" id="ref-for-dom-dompointreadonly-w①">w</a></code> value MUST be <code>1.0</code>. If estimated values from the users’s environment are not available the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity①">primaryLightIntensity</a></code> MUST be <code>{x: 0.0, y: 0.0, z: 0.0, w: 1.0}</code>, representing no illumination.</p>
   <h2 class="heading settled" data-level="3" id="webxr-device-api-integration"><span class="secno">3. </span><span class="content">WebXR Device API Integration</span><a class="self-link" href="#webxr-device-api-integration"></a></h2>
   <p>Both the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface">XRSession</a></code> and <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface②">XRFrame</a></code> interfaces from the <a href="https://www.w3.org/TR/webxr/">WebXR Device API</a> are expanded by this module.</p>
   <h3 class="heading settled" data-level="3.1" id="session-initialization"><span class="secno">3.1. </span><span class="content">Session Initialization</span><a class="self-link" href="#session-initialization"></a></h3>
   <p>The string "<dfn class="dfn-paneled" data-dfn-for="feature descriptor" data-dfn-type="dfn" data-noexport id="feature-descriptor-light-estimation">light-estimation</dfn>" is introduced by this module as a new valid <a data-link-type="dfn" href="https://immersive-web.github.io/webxr/#feature-descriptor" id="ref-for-feature-descriptor">feature descriptor</a>. Applications that wish to use light estimation features MUST be requested with an the "<a data-link-type="dfn" href="#feature-descriptor-light-estimation" id="ref-for-feature-descriptor-light-estimation">light-estimation</a>" <a data-link-type="dfn" href="https://immersive-web.github.io/webxr/#feature-descriptor" id="ref-for-feature-descriptor①">feature descriptor</a>.</p>
   <h3 class="heading settled" data-level="3.2" id="xrsession-interface"><span class="secno">3.2. </span><span class="content">XRSession</span><a class="self-link" href="#xrsession-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface①">XRSession</a></code> interface is extended with the ability to create new <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑥">XRLightProbe</a></code> instances. <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑦">XRLightProbe</a></code> instances have a <dfn class="dfn-paneled" data-dfn-for="XRLightProbe" data-dfn-type="dfn" data-noexport id="xrlightprobe-session">session</dfn> object, which is the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface②">XRSession</a></code> that created this <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑧">XRLightProbe</a></code>. And an <dfn class="dfn-paneled" data-dfn-for="XRLightProbe" data-dfn-type="dfn" data-noexport id="xrlightprobe-reflection-format">reflection format</dfn> object, which is the <code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat①">XRReflectionFormat</a></code> that the light probe may retrieve.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface③">XRSession</a></code> interface is further extended with an attribute <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat①">preferredReflectionFormat</a></code>, indicating the <code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat②">XRReflectionFormat</a></code> most closely supported by the underlying <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device">XR device</a></p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-xrlightprobeinit"><code><c- g>XRLightProbeInit</c-></code></dfn> {
  <a data-link-type="idl-name" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat③"><c- n>XRReflectionFormat</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;srgba8&quot;" data-dfn-for="XRLightProbeInit" data-dfn-type="dict-member" data-export data-type="XRReflectionFormat " id="dom-xrlightprobeinit-reflectionformat"><code><c- g>reflectionFormat</c-></code></dfn> = "srgba8";
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface④"><c- g>XRSession</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe⑨"><c- n>XRLightProbe</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-xrsession-requestlightprobe" id="ref-for-dom-xrsession-requestlightprobe"><c- g>requestLightProbe</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-xrlightprobeinit" id="ref-for-dictdef-xrlightprobeinit"><c- n>XRLightProbeInit</c-></a> <dfn class="idl-code" data-dfn-for="XRSession/requestLightProbe(options), XRSession/requestLightProbe()" data-dfn-type="argument" data-export id="dom-xrsession-requestlightprobe-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-xrsession-requestlightprobe-options-options"></a></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat④"><c- n>XRReflectionFormat</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="XRSession" data-dfn-type="attribute" data-export data-readonly data-type="XRReflectionFormat" id="dom-xrsession-preferredreflectionformat"><code><c- g>preferredReflectionFormat</c-></code></dfn>;
};
</pre>
   <div class="algorithm" data-algorithm="request-light-probe">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRSession" data-dfn-type="method" data-export data-lt="requestLightProbe(options)|requestLightProbe()" id="dom-xrsession-requestlightprobe"><code>requestLightProbe(<var>options</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface⑤">XRSession</a></code> <var>session</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise">a new Promise</a>.</p>
     <li data-md>
      <p>If the <a data-link-type="dfn" href="#feature-descriptor-light-estimation" id="ref-for-feature-descriptor-light-estimation①">light-estimation</a> feature descriptor is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contained</a> in the <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features" id="ref-for-xrsession-list-of-enabled-features">list of enabled features</a>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject">reject</a> <var>promise</var> with <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror" id="ref-for-notsupportederror">NotSupportedError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#ended" id="ref-for-ended">ended</a> value is <code>true</code>, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code> and abort these steps.</p>
      <dl class="switch">
       <dt>If <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobeinit-reflectionformat" id="ref-for-dom-xrlightprobeinit-reflectionformat">reflectionFormat</a></code> is <code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8②">"srgba8"</a></code> or matches <var>session</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat②">preferredReflectionFormat</a></code>:
       <dd>
        <ol>
         <li data-md>
          <p>Let <var>probe</var> be a new <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①⓪">XRLightProbe</a></code>.</p>
         <li data-md>
          <p>Set <var>probe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session">session</a> to <var>session</var>.</p>
         <li data-md>
          <p>Set <var>probe</var>’s <a data-link-type="dfn" href="#xrlightprobe-reflection-format" id="ref-for-xrlightprobe-reflection-format">reflection format</a> to <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobeinit-reflectionformat" id="ref-for-dom-xrlightprobeinit-reflectionformat①">reflectionFormat</a></code></p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve">Resolve</a> <var>promise</var> with <var>probe</var>.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①">Reject</a> <var>promise</var> with a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#notsupportederror" id="ref-for-notsupportederror①">NotSupportedError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code></p>
        </ol>
      </dl>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.3" id="xrframe-interface"><span class="secno">3.3. </span><span class="content">XRFrame</span><a class="self-link" href="#xrframe-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface③">XRFrame</a></code> interface is extended with the ability to query the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate④">XRLightEstimate</a></code> for a given <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①①">XRLightProbe</a></code>.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface④"><c- g>XRFrame</c-></a> {
  <a data-link-type="idl-name" href="#xrlightestimate" id="ref-for-xrlightestimate⑤"><c- n>XRLightEstimate</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrframe-getlightestimate" id="ref-for-dom-xrframe-getlightestimate①"><c- g>getLightEstimate</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe①②"><c- n>XRLightProbe</c-></a> <dfn class="idl-code" data-dfn-for="XRFrame/getLightEstimate(lightProbe)" data-dfn-type="argument" data-export id="dom-xrframe-getlightestimate-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code><a class="self-link" href="#dom-xrframe-getlightestimate-lightprobe-lightprobe"></a></dfn>);
};
</pre>
   <div class="algorithm" data-algorithm="get-light-estimate">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRFrame" data-dfn-type="method" data-export id="dom-xrframe-getlightestimate"><code>getLightEstimate(<var>lightProbe</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface⑤">XRFrame</a></code> <var>frame</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-active" id="ref-for-xrframe-active">active</a> boolean is `false`, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror①">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>session</var> be <var>frame</var>’s <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/webxr/#dom-xrframe-session" id="ref-for-dom-xrframe-session">session</a></code> object.</p>
     <li data-md>
      <p>If <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session①">session</a> does not equal <var>session</var>, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror②">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>device</var> be <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device①">XR device</a>.</p>
     <li data-md>
      <p>If <var>device</var> cannot estimate the lighting for this frame, return null.</p>
     <li data-md>
      <p>Let <var>estimate</var> be a new <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate⑥">XRLightEstimate</a></code>.</p>
     <li data-md>
      <p>Populate estimate|'s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients③">sphericalHarmonicsCoefficients</a></code>, with the coefficients provided by <var>device</var>.</p>
      <dl class="switch">
       <dt>If <var>device</var> has an estimated direction for the light source
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection②">primaryLightDirection</a></code> to the estimated direction of the light source.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection③">primaryLightDirection</a></code> to <code>{ x: 0.0, y: 1.0, z: 0.0, w: 0.0 }</code></p>
        </ol>
      </dl>
      <dl class="switch">
       <dt>If <var>device</var> has an estimated intensity for the light source
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity②">primaryLightIntensity</a></code> to the estimated intensity of the light source.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity③">primaryLightIntensity</a></code> to <code>{x: 0.0, y: 0.0, z: 0.0, w: 1.0}</code></p>
        </ol>
      </dl>
     <li data-md>
      <p>Return <var>estimate</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="webxr-layers-integration"><span class="secno">4. </span><span class="content">WebXR Layers Integration</span><a class="self-link" href="#webxr-layers-integration"></a></h2>
   <p>The <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding">XRWebGLBinding</a></code> interface from the <a href="https://immersive-web.github.io/layers/">WebXR Layers module</a> is expanded by this module.</p>
   <h3 class="heading settled" data-level="4.1" id="xrwebglbinding-interface"><span class="secno">4.1. </span><span class="content">XRWebGLBinding</span><a class="self-link" href="#xrwebglbinding-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding①">XRWebGLBinding</a></code> interface is extended with the ability to query a reflection cube map for a given <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①③">XRLightProbe</a></code>.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding②"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture" id="ref-for-WebGLTexture"><c- n>WebGLTexture</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrwebglbinding-getreflectioncubemap" id="ref-for-dom-xrwebglbinding-getreflectioncubemap"><c- g>getReflectionCubeMap</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe①④"><c- n>XRLightProbe</c-></a> <dfn class="idl-code" data-dfn-for="XRWebGLBinding/getReflectionCubeMap(lightProbe)" data-dfn-type="argument" data-export id="dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code><a class="self-link" href="#dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"></a></dfn>);
};
</pre>
   <div class="algorithm" data-algorithm="get-reflection-cubemap">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRWebGLBinding" data-dfn-type="method" data-export id="dom-xrwebglbinding-getreflectioncubemap"><code>getReflectionCubeMap(<var>lightProbe</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding③">XRWebGLBinding</a></code> <var>binding</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#xrwebglbinding-context" id="ref-for-xrwebglbinding-context">context</a> is lost, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror③">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>session</var> be <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#session" id="ref-for-session">session</a>.</p>
     <li data-md>
      <p>If <var>session</var> is ended, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror④">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>session</var> does not match <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session②">session</a>, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#invalidstateerror" id="ref-for-invalidstateerror⑤">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>device</var> be <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device②">XR Device</a>.</p>
     <li data-md>
      <p>If no reflection cube map is available from <var>device</var>, return <code>null</code>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture" id="ref-for-WebGLTexture①">WebGLTexture</a></code> cubemap in the format specified by <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-reflection-format" id="ref-for-xrlightprobe-reflection-format①">reflection format</a> and populated with the data from <var>device</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="events"><span class="secno">5. </span><span class="content">Events</span><a class="self-link" href="#events"></a></h2>
   <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source" id="ref-for-task-source">task source</a> for all <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">tasks queued</a> in this specification is the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xr-task-source" id="ref-for-xr-task-source">XR task source</a>, unless otherwise specified.</p>
   <h3 class="heading settled" data-level="5.1" id="event-types"><span class="secno">5.1. </span><span class="content">Event Types</span><a class="self-link" href="#event-types"></a></h3>
   <p>The user agent MUST fire a <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="event" data-export id="eventdef-xrlightprobe-reflectionchange"><code>reflectionchange</code></dfn> event on an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①⑤">XRLightProbe</a></code> object each time the contents of the cube map returned by calling <code class="idl"><a data-link-type="idl" href="#dom-xrwebglbinding-getreflectioncubemap" id="ref-for-dom-xrwebglbinding-getreflectioncubemap①">getReflectionCubeMap()</a></code> have changed. The event MUST be of type <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event">Event</a></code>.</p>
   <h2 class="heading settled" data-level="6" id="privacy-security"><span class="secno">6. </span><span class="content">Privacy &amp; Security Considerations</span><a class="self-link" href="#privacy-security"></a></h2>
   <section class="non-normative">
    <p>The lighting estimation API shares many potential <a data-link-type="dfn" href="https://www.w3.org/TR/ambient-light/#security-and-privacy" id="ref-for-security-and-privacy">privacy and security risks</a> with the Ambient Light Sensor API <a data-link-type="biblio" href="#biblio-ambient-light">[AMBIENT-LIGHT]</a>, including:</p>
    <ul>
     <li data-md>
      <p>Profiling: Lighting Estimation can leak information about user’s use patterns and surroundings. This information can be used to enhance user profiling and behavioral analysis.</p>
     <li data-md>
      <p>Cross-device Linking: Two devices can access web sites that include the same third-party script that correlates lighting levels over time.</p>
     <li data-md>
      <p>Cross Device Communication: A simple broadcast communication method can use device screen or camera LED flashes to broadcast messages read out with lighting estimation on a nearby device.</p>
    </ul>
    <p>In addition to these, there are a few vectors unique to lighting estimation to
consider.</p>
    <ul>
     <li data-md>
      <p>The lighting estimation returned by the WebXR API explicitly describes the real world environment in close proximity to the user.</p>
     <li data-md>
      <p>Reflection cube maps of a high enough resolution approach the same level as camera access.</p>
    </ul>
    <p>Lighting estimation must be declared when creating an XR Session as a <a data-link-type="dfn" href="https://immersive-web.github.io/webxr/#feature-descriptor" id="ref-for-feature-descriptor②">feature descriptor</a>, which will allow the user agent to notify the user of the potential privacy implications of allowing the lighting estimation API to be used by the website. The user agent is encouraged to NOT provide real-time updates to any portion of the lighting estimation API, especially the reflection cube map. By default, only low spaital frequency and low temporal frequency information should be returned by the WebXR API. Reflection cube maps should be kept low resolution, unless the user has also consented to camera permissions for a particular origin.  As further mitigation, the Spherical Harmonics and primary light direction MAY be quantized.</p>
   </section>
   <p id="back-to-top" role="navigation"><a href="#toc"><abbr title="Back to Top">↑</abbr></a></p>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  </main>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-xrframe-getlightestimate">getLightEstimate(lightProbe)</a><span>, in §3.3</span>
   <li><a href="#dom-xrwebglbinding-getreflectioncubemap">getReflectionCubeMap(lightProbe)</a><span>, in §4.1</span>
   <li><a href="#feature-descriptor-light-estimation">light-estimation</a><span>, in §3.1</span>
   <li><a href="#dom-xrlightprobe-onreflectionchange">onreflectionchange</a><span>, in §2.1</span>
   <li><a href="#dom-xrsession-preferredreflectionformat">preferredReflectionFormat</a><span>, in §3.2</span>
   <li><a href="#dom-xrlightestimate-primarylightdirection">primaryLightDirection</a><span>, in §2.3</span>
   <li><a href="#dom-xrlightestimate-primarylightintensity">primaryLightIntensity</a><span>, in §2.3</span>
   <li><a href="#dom-xrlightprobe-probespace">probeSpace</a><span>, in §2.1</span>
   <li><a href="#eventdef-xrlightprobe-reflectionchange">reflectionchange</a><span>, in §5.1</span>
   <li><a href="#xrlightprobe-reflection-format">reflection format</a><span>, in §3.2</span>
   <li><a href="#dom-xrlightprobeinit-reflectionformat">reflectionFormat</a><span>, in §3.2</span>
   <li><a href="#dom-xrsession-requestlightprobe">requestLightProbe()</a><span>, in §3.2</span>
   <li><a href="#dom-xrsession-requestlightprobe">requestLightProbe(options)</a><span>, in §3.2</span>
   <li><a href="#dom-xrreflectionformat-rgba16f">"rgba16f"</a><span>, in §2.2</span>
   <li><a href="#xrlightprobe-session">session</a><span>, in §3.2</span>
   <li><a href="#dom-xrlightestimate-sphericalharmonicscoefficients">sphericalHarmonicsCoefficients</a><span>, in §2.3</span>
   <li><a href="#dom-xrreflectionformat-srgba8">"srgba8"</a><span>, in §2.2</span>
   <li><a href="#xrlightestimate">XRLightEstimate</a><span>, in §2.3</span>
   <li><a href="#xrlightprobe">XRLightProbe</a><span>, in §2.1</span>
   <li><a href="#dictdef-xrlightprobeinit">XRLightProbeInit</a><span>, in §3.2</span>
   <li><a href="#enumdef-xrreflectionformat">XRReflectionFormat</a><span>, in §2.2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-security-and-privacy">
   <a href="https://www.w3.org/TR/ambient-light/#security-and-privacy">https://www.w3.org/TR/ambient-light/#security-and-privacy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-security-and-privacy">6. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event">
   <a href="https://dom.spec.whatwg.org/#event">https://dom.spec.whatwg.org/#event</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event">5.1. Event Types</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventtarget">
   <a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventtarget">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dompointreadonly">
   <a href="https://drafts.fxtf.org/geometry-1/#dompointreadonly">https://drafts.fxtf.org/geometry-1/#dompointreadonly</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dompointreadonly">2.3. XRLightEstimate</a> <a href="#ref-for-dompointreadonly①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-dompointreadonly-w">
   <a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-w">2.3. XRLightEstimate</a> <a href="#ref-for-dom-dompointreadonly-w①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-dompointreadonly-x">
   <a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-x">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-dompointreadonly-y">
   <a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-y">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-dompointreadonly-z">
   <a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-z">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-eventhandler">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventhandler">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-handler-idl-attributes">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-handler-idl-attributes">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-task">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-task">5. Events</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-task-source">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source">https://html.spec.whatwg.org/multipage/webappapis.html#task-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-task-source">5. Events</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-contain">
   <a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-WebGLTexture">
   <a href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture">https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-WebGLTexture">4.1. XRWebGLBinding</a> <a href="#ref-for-WebGLTexture①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">2.1. XRLightProbe</a>
    <li><a href="#ref-for-Exposed①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-Float32Array">
   <a href="https://heycam.github.io/webidl/#idl-Float32Array">https://heycam.github.io/webidl/#idl-Float32Array</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-Float32Array">2.3. XRLightEstimate</a> <a href="#ref-for-idl-Float32Array①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invalidstateerror">
   <a href="https://heycam.github.io/webidl/#invalidstateerror">https://heycam.github.io/webidl/#invalidstateerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invalidstateerror">3.2. XRSession</a>
    <li><a href="#ref-for-invalidstateerror①">3.3. XRFrame</a> <a href="#ref-for-invalidstateerror②">(2)</a>
    <li><a href="#ref-for-invalidstateerror③">4.1. XRWebGLBinding</a> <a href="#ref-for-invalidstateerror④">(2)</a> <a href="#ref-for-invalidstateerror⑤">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-notsupportederror">
   <a href="https://heycam.github.io/webidl/#notsupportederror">https://heycam.github.io/webidl/#notsupportederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notsupportederror">3.2. XRSession</a> <a href="#ref-for-notsupportederror①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-SecureContext">
   <a href="https://heycam.github.io/webidl/#SecureContext">https://heycam.github.io/webidl/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">2.1. XRLightProbe</a>
    <li><a href="#ref-for-SecureContext①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-new-promise">
   <a href="https://heycam.github.io/webidl/#a-new-promise">https://heycam.github.io/webidl/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-reject">
   <a href="https://heycam.github.io/webidl/#reject">https://heycam.github.io/webidl/#reject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reject">3.2. XRSession</a> <a href="#ref-for-reject①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve">
   <a href="https://heycam.github.io/webidl/#resolve">https://heycam.github.io/webidl/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrspace">
   <a href="https://immersive-web.github.io/webxr/#xrspace">https://immersive-web.github.io/webxr/#xrspace</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrspace">2.1. XRLightProbe</a> <a href="#ref-for-xrspace①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-feature-descriptor">
   <a href="https://immersive-web.github.io/webxr/#feature-descriptor">https://immersive-web.github.io/webxr/#feature-descriptor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-feature-descriptor">3.1. Session Initialization</a> <a href="#ref-for-feature-descriptor①">(2)</a>
    <li><a href="#ref-for-feature-descriptor②">6. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-xrframe-session">
   <a href="https://immersive-web.github.io/webxr/#dom-xrframe-session">https://immersive-web.github.io/webxr/#dom-xrframe-session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrframe-session">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-interface">
   <a href="https://www.w3.org/TR/webxr/#xrframe-interface">https://www.w3.org/TR/webxr/#xrframe-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-interface">2.3. XRLightEstimate</a> <a href="#ref-for-xrframe-interface①">(2)</a>
    <li><a href="#ref-for-xrframe-interface②">3. WebXR Device API Integration</a>
    <li><a href="#ref-for-xrframe-interface③">3.3. XRFrame</a> <a href="#ref-for-xrframe-interface④">(2)</a> <a href="#ref-for-xrframe-interface⑤">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrsession-interface">
   <a href="https://www.w3.org/TR/webxr/#xrsession-interface">https://www.w3.org/TR/webxr/#xrsession-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-interface">3. WebXR Device API Integration</a>
    <li><a href="#ref-for-xrsession-interface①">3.2. XRSession</a> <a href="#ref-for-xrsession-interface②">(2)</a> <a href="#ref-for-xrsession-interface③">(3)</a> <a href="#ref-for-xrsession-interface④">(4)</a> <a href="#ref-for-xrsession-interface⑤">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrframe-active">
   <a href="https://www.w3.org/TR/webxr/#xrframe-active">https://www.w3.org/TR/webxr/#xrframe-active</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-active">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ended">
   <a href="https://www.w3.org/TR/webxr/#ended">https://www.w3.org/TR/webxr/#ended</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ended">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrsession-list-of-enabled-features">
   <a href="https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features">https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-list-of-enabled-features">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrspace-native-origin">
   <a href="https://www.w3.org/TR/webxr/#xrspace-native-origin">https://www.w3.org/TR/webxr/#xrspace-native-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrspace-native-origin">2.1. XRLightProbe</a>
    <li><a href="#ref-for-xrspace-native-origin①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrsession-xr-device">
   <a href="https://www.w3.org/TR/webxr/#xrsession-xr-device">https://www.w3.org/TR/webxr/#xrsession-xr-device</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-xr-device">3.2. XRSession</a>
    <li><a href="#ref-for-xrsession-xr-device①">3.3. XRFrame</a>
    <li><a href="#ref-for-xrsession-xr-device②">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xr-task-source">
   <a href="https://www.w3.org/TR/webxr/#xr-task-source">https://www.w3.org/TR/webxr/#xr-task-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xr-task-source">5. Events</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrwebglbinding">
   <a href="https://immersive-web.github.io/layers/#xrwebglbinding">https://immersive-web.github.io/layers/#xrwebglbinding</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding">4. WebXR Layers Integration</a>
    <li><a href="#ref-for-xrwebglbinding①">4.1. XRWebGLBinding</a> <a href="#ref-for-xrwebglbinding②">(2)</a> <a href="#ref-for-xrwebglbinding③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-xrwebglbinding-context">
   <a href="https://immersive-web.github.io/layers/#xrwebglbinding-context">https://immersive-web.github.io/layers/#xrwebglbinding-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding-context">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-session">
   <a href="https://immersive-web.github.io/layers/#session">https://immersive-web.github.io/layers/#session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-session">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[AMBIENT-LIGHT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-security-and-privacy">privacy and security risks</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-event">Event</span>
     <li><span class="dfn-paneled" id="term-for-eventtarget">EventTarget</span>
    </ul>
   <li>
    <a data-link-type="biblio">[geometry-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-dompointreadonly">DOMPointReadOnly</span>
     <li><span class="dfn-paneled" id="term-for-dom-dompointreadonly-w">w</span>
     <li><span class="dfn-paneled" id="term-for-dom-dompointreadonly-x">x</span>
     <li><span class="dfn-paneled" id="term-for-dom-dompointreadonly-y">y</span>
     <li><span class="dfn-paneled" id="term-for-dom-dompointreadonly-z">z</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-eventhandler">EventHandler</span>
     <li><span class="dfn-paneled" id="term-for-event-handler-idl-attributes">event handler idl attribute</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-task">queue a task</span>
     <li><span class="dfn-paneled" id="term-for-task-source">task source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-contain">contain</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBGL-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-WebGLTexture">WebGLTexture</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-idl-Float32Array">Float32Array</span>
     <li><span class="dfn-paneled" id="term-for-invalidstateerror">InvalidStateError</span>
     <li><span class="dfn-paneled" id="term-for-notsupportederror">NotSupportedError</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-SecureContext">SecureContext</span>
     <li><span class="dfn-paneled" id="term-for-a-new-promise">a new promise</span>
     <li><span class="dfn-paneled" id="term-for-reject">reject</span>
     <li><span class="dfn-paneled" id="term-for-resolve">resolve</span>
    </ul>
   <li>
    <a data-link-type="biblio">[webxr]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-xrspace">XRSpace</span>
     <li><span class="dfn-paneled" id="term-for-feature-descriptor">feature descriptor</span>
     <li><span class="dfn-paneled" id="term-for-dom-xrframe-session">session</span>
    </ul>
   <li>
    <a data-link-type="biblio">[webxr device api - level 1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-xrframe-interface">XRFrame</span>
     <li><span class="dfn-paneled" id="term-for-xrsession-interface">XRSession</span>
     <li><span class="dfn-paneled" id="term-for-xrframe-active">active</span>
     <li><span class="dfn-paneled" id="term-for-ended">ended</span>
     <li><span class="dfn-paneled" id="term-for-xrsession-list-of-enabled-features">list of enabled features</span>
     <li><span class="dfn-paneled" id="term-for-xrspace-native-origin">native origin</span>
     <li><span class="dfn-paneled" id="term-for-xrsession-xr-device">xr device</span>
     <li><span class="dfn-paneled" id="term-for-xr-task-source">xr task source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[webxr layers api]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-xrwebglbinding">XRWebGLBinding</span>
     <li><span class="dfn-paneled" id="term-for-xrwebglbinding-context">context</span>
     <li><span class="dfn-paneled" id="term-for-session">session</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ambient-light">[AMBIENT-LIGHT]
   <dd>Anssi Kostiainen. <a href="https://www.w3.org/TR/ambient-light/">Ambient Light Sensor</a>. 7 March 2019. WD. URL: <a href="https://www.w3.org/TR/ambient-light/">https://www.w3.org/TR/ambient-light/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-geometry-1">[GEOMETRY-1]
   <dd>Simon Pieters; Chris Harrelson. <a href="https://www.w3.org/TR/geometry-1/">Geometry Interfaces Module Level 1</a>. 4 December 2018. CR. URL: <a href="https://www.w3.org/TR/geometry-1/">https://www.w3.org/TR/geometry-1/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-webgl-2">[WEBGL-2]
   <dd>Dean Jackson; Jeff Gilbert. <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/">WebGL 2.0 Specification</a>. 12 August 2017. URL: <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/">https://www.khronos.org/registry/webgl/specs/latest/2.0/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
   <dt id="biblio-webxr">[WEBXR]
   <dd>Brandon Jones; Manish Goregaokar; Nell Waliczek. <a href="https://www.w3.org/TR/webxr/">WebXR Device API</a>. 24 July 2020. WD. URL: <a href="https://www.w3.org/TR/webxr/">https://www.w3.org/TR/webxr/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#xrlightprobe"><code><c- g>XRLightProbe</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://immersive-web.github.io/webxr/#xrspace"><c- n>XRSpace</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="XRSpace" href="#dom-xrlightprobe-probespace"><c- g>probeSpace</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-xrlightprobe-onreflectionchange"><c- g>onreflectionchange</c-></a>;
};

<c- b>enum</c-> <a href="#enumdef-xrreflectionformat"><code><c- g>XRReflectionFormat</c-></code></a> {
  <a href="#dom-xrreflectionformat-srgba8"><code><c- s>"srgba8"</c-></code></a>,
  <a href="#dom-xrreflectionformat-rgba16f"><code><c- s>"rgba16f"</c-></code></a>,
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#xrlightestimate"><code><c- g>XRLightEstimate</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-Float32Array"><c- b>Float32Array</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Float32Array" href="#dom-xrlightestimate-sphericalharmonicscoefficients"><c- g>sphericalHarmonicsCoefficients</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightdirection"><c- g>primaryLightDirection</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightintensity"><c- g>primaryLightIntensity</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-xrlightprobeinit"><code><c- g>XRLightProbeInit</c-></code></a> {
  <a data-link-type="idl-name" href="#enumdef-xrreflectionformat"><c- n>XRReflectionFormat</c-></a> <a data-default="&quot;srgba8&quot;" data-type="XRReflectionFormat " href="#dom-xrlightprobeinit-reflectionformat"><code><c- g>reflectionFormat</c-></code></a> = "srgba8";
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrsession-interface"><c- g>XRSession</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-xrsession-requestlightprobe"><c- g>requestLightProbe</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-xrlightprobeinit"><c- n>XRLightProbeInit</c-></a> <a href="#dom-xrsession-requestlightprobe-options-options"><code><c- g>options</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-xrreflectionformat"><c- n>XRReflectionFormat</c-></a> <a data-readonly data-type="XRReflectionFormat" href="#dom-xrsession-preferredreflectionformat"><code><c- g>preferredReflectionFormat</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrframe-interface"><c- g>XRFrame</c-></a> {
  <a data-link-type="idl-name" href="#xrlightestimate"><c- n>XRLightEstimate</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrframe-getlightestimate"><c- g>getLightEstimate</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a> <a href="#dom-xrframe-getlightestimate-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code></a>);
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#xrwebglbinding"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture"><c- n>WebGLTexture</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrwebglbinding-getreflectioncubemap"><c- g>getReflectionCubeMap</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a> <a href="#dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code></a>);
};

</pre>
  <aside class="dfn-panel" data-for="xrlightprobe">
   <b><a href="#xrlightprobe">#xrlightprobe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe">2.1. XRLightProbe</a> <a href="#ref-for-xrlightprobe①">(2)</a>
    <li><a href="#ref-for-xrlightprobe②">2.3. XRLightEstimate</a> <a href="#ref-for-xrlightprobe③">(2)</a> <a href="#ref-for-xrlightprobe④">(3)</a> <a href="#ref-for-xrlightprobe⑤">(4)</a>
    <li><a href="#ref-for-xrlightprobe⑥">3.2. XRSession</a> <a href="#ref-for-xrlightprobe⑦">(2)</a> <a href="#ref-for-xrlightprobe⑧">(3)</a> <a href="#ref-for-xrlightprobe⑨">(4)</a> <a href="#ref-for-xrlightprobe①⓪">(5)</a>
    <li><a href="#ref-for-xrlightprobe①①">3.3. XRFrame</a> <a href="#ref-for-xrlightprobe①②">(2)</a>
    <li><a href="#ref-for-xrlightprobe①③">4.1. XRWebGLBinding</a> <a href="#ref-for-xrlightprobe①④">(2)</a>
    <li><a href="#ref-for-xrlightprobe①⑤">5.1. Event Types</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightprobe-probespace">
   <b><a href="#dom-xrlightprobe-probespace">#dom-xrlightprobe-probespace</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobe-probespace">2.1. XRLightProbe</a>
    <li><a href="#ref-for-dom-xrlightprobe-probespace①">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightprobe-probespace②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightprobe-onreflectionchange">
   <b><a href="#dom-xrlightprobe-onreflectionchange">#dom-xrlightprobe-onreflectionchange</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobe-onreflectionchange">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-xrreflectionformat">
   <b><a href="#enumdef-xrreflectionformat">#enumdef-xrreflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-xrreflectionformat">2.2. XRReflectionFormat</a>
    <li><a href="#ref-for-enumdef-xrreflectionformat①">3.2. XRSession</a> <a href="#ref-for-enumdef-xrreflectionformat②">(2)</a> <a href="#ref-for-enumdef-xrreflectionformat③">(3)</a> <a href="#ref-for-enumdef-xrreflectionformat④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrreflectionformat-srgba8">
   <b><a href="#dom-xrreflectionformat-srgba8">#dom-xrreflectionformat-srgba8</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrreflectionformat-srgba8">2.2. XRReflectionFormat</a> <a href="#ref-for-dom-xrreflectionformat-srgba8①">(2)</a>
    <li><a href="#ref-for-dom-xrreflectionformat-srgba8②">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrreflectionformat-rgba16f">
   <b><a href="#dom-xrreflectionformat-rgba16f">#dom-xrreflectionformat-rgba16f</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrreflectionformat-rgba16f">2.2. XRReflectionFormat</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrlightestimate">
   <b><a href="#xrlightestimate">#xrlightestimate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightestimate">2.3. XRLightEstimate</a> <a href="#ref-for-xrlightestimate①">(2)</a> <a href="#ref-for-xrlightestimate②">(3)</a> <a href="#ref-for-xrlightestimate③">(4)</a>
    <li><a href="#ref-for-xrlightestimate④">3.3. XRFrame</a> <a href="#ref-for-xrlightestimate⑤">(2)</a> <a href="#ref-for-xrlightestimate⑥">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightestimate-sphericalharmonicscoefficients">
   <b><a href="#dom-xrlightestimate-sphericalharmonicscoefficients">#dom-xrlightestimate-sphericalharmonicscoefficients</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients①">(2)</a> <a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients②">(3)</a>
    <li><a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients③">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightestimate-primarylightdirection">
   <b><a href="#dom-xrlightestimate-primarylightdirection">#dom-xrlightestimate-primarylightdirection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightdirection">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-primarylightdirection①">(2)</a>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightdirection②">3.3. XRFrame</a> <a href="#ref-for-dom-xrlightestimate-primarylightdirection③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightestimate-primarylightintensity">
   <b><a href="#dom-xrlightestimate-primarylightintensity">#dom-xrlightestimate-primarylightintensity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightintensity">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-primarylightintensity①">(2)</a>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightintensity②">3.3. XRFrame</a> <a href="#ref-for-dom-xrlightestimate-primarylightintensity③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="feature-descriptor-light-estimation">
   <b><a href="#feature-descriptor-light-estimation">#feature-descriptor-light-estimation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-feature-descriptor-light-estimation">3.1. Session Initialization</a>
    <li><a href="#ref-for-feature-descriptor-light-estimation①">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrlightprobe-session">
   <b><a href="#xrlightprobe-session">#xrlightprobe-session</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe-session">3.2. XRSession</a>
    <li><a href="#ref-for-xrlightprobe-session①">3.3. XRFrame</a>
    <li><a href="#ref-for-xrlightprobe-session②">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="xrlightprobe-reflection-format">
   <b><a href="#xrlightprobe-reflection-format">#xrlightprobe-reflection-format</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe-reflection-format">3.2. XRSession</a>
    <li><a href="#ref-for-xrlightprobe-reflection-format①">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-xrlightprobeinit">
   <b><a href="#dictdef-xrlightprobeinit">#dictdef-xrlightprobeinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-xrlightprobeinit">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrlightprobeinit-reflectionformat">
   <b><a href="#dom-xrlightprobeinit-reflectionformat">#dom-xrlightprobeinit-reflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobeinit-reflectionformat">3.2. XRSession</a> <a href="#ref-for-dom-xrlightprobeinit-reflectionformat①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrsession-preferredreflectionformat">
   <b><a href="#dom-xrsession-preferredreflectionformat">#dom-xrsession-preferredreflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrsession-preferredreflectionformat">2.2. XRReflectionFormat</a>
    <li><a href="#ref-for-dom-xrsession-preferredreflectionformat①">3.2. XRSession</a> <a href="#ref-for-dom-xrsession-preferredreflectionformat②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrsession-requestlightprobe">
   <b><a href="#dom-xrsession-requestlightprobe">#dom-xrsession-requestlightprobe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrsession-requestlightprobe">3.2. XRSession</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrframe-getlightestimate">
   <b><a href="#dom-xrframe-getlightestimate">#dom-xrframe-getlightestimate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrframe-getlightestimate">2.3. XRLightEstimate</a>
    <li><a href="#ref-for-dom-xrframe-getlightestimate①">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-xrwebglbinding-getreflectioncubemap">
   <b><a href="#dom-xrwebglbinding-getreflectioncubemap">#dom-xrwebglbinding-getreflectioncubemap</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrwebglbinding-getreflectioncubemap">4.1. XRWebGLBinding</a>
    <li><a href="#ref-for-dom-xrwebglbinding-getreflectioncubemap①">5.1. Event Types</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="eventdef-xrlightprobe-reflectionchange">
   <b><a href="#eventdef-xrlightprobe-reflectionchange">#eventdef-xrlightprobe-reflectionchange</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-xrlightprobe-reflectionchange">2.1. XRLightProbe</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    {
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>