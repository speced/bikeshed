<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <title>WebXR Lighting Estimation API Level 1</title>
  <meta content="w3c/ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2021/W3C-ED" rel="stylesheet">
  <link href="https://www.w3.org/2008/site/images/favicon.ico" rel="icon">
  <link href="favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
  <link href="favicon-96x96.png" rel="icon" sizes="96x96" type="image/png">
<style>
  .unstable::before {
    content: "This section is not stable";
    display: block;
    font-weight: bold;
    text-align: right;
    color: red;
  }
  .unstable {
    border: thin solid pink;
    border-radius: .5em;
    padding: .5em;
    margin: .5em calc(-0.5em - 1px);
    background-image: url("data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' width='300' height='290'><text transform='rotate(-45)' text-anchor='middle' font-family='sans-serif' font-weight='bold' font-size='70' y='210' opacity='.1'>Unstable</text></svg>");
    background-repeat: repeat;
    background-color: #FFF4F4;
  }
  .unstable h3:first-of-type {
    margin-top: 0.5rem;
  }

  .unstable.example:not(.no-marker)::before {
    content: "Example " counter(example) " (Unstable)";
    float: none;
  }

  .non-normative::before {
    content: "This section is non-normative.";
    font-style: italic;
  }
  .tg {
    border-collapse: collapse;
    border-spacing: 0;
  }
  .tg th {
    border-style: solid;
    border-width: 1px;
    background: #90b8de;
    color: #fff;
    font-family: sans-serif;
    font-weight: bold;
    border-color: grey;
  }
  .tg td {
    padding: 4px 5px;
    background-color: rgb(221, 238, 255);
    font-family: monospace;
    border-style: solid;
    border-width: 1px;
    border-color: grey;
    overflow: hidden;
    word-break: normal;
  }
</style>
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    min-width: min-content;
    max-width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-var-click-highlighting */
var { cursor: pointer; }
var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">WebXR Lighting Estimation API Level 1</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#ED">Editor’s Draft</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <details open>
    <summary>More details about this document</summary>
    <div data-fill-with="spec-metadata">
     <dl>
      <dt>Previous Versions:
      <dd><a href rel="prev"></a>
      <dt class="editor">Editors:
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:bajones@google.com">Brandon Jones</a> (<a class="p-org org" href="https://google.com">Google</a>)
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:kgilbert@mozilla.com">Kearwood Gilbert</a> (<a class="p-org org" href="https://mozilla.org/">Mozilla</a>)
     </dl>
    </div>
   </details>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 <a href="https://www.w3.org/">World Wide Web Consortium</a>. <abbr title="World Wide Web Consortium">W3C</abbr><sup>®</sup> <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/2015/copyright-software-and-document" rel="license">permissive document license</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification describes support for exposing estimates of environmental lighting conditions to WebXR sessions.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="sotd"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="https://www.w3.org/groups/wg/immersive-web">Immersive Web Working Group</a> as an Editors' Draft. This document is intended to become a W3C Recommendation.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/immersive-web/lighting-estimation/issues">Github issues</a>.
    Discussions may also be found in the <a href="http://lists.w3.org/Archives/Public/public-immersive-web-wg/">public-immersive-web-wg@w3.org archives</a>. </p>
   <p> Publication as an Editors' Draft does not imply endorsement by <abbr title="World Wide Web Consortium">W3C</abbr> and its Members. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="https://www.w3.org/Consortium/Patent-Policy/">W3C Patent Policy</a>.
    W3C maintains a <a href="https://www.w3.org/groups/wg/immersive-web/ipr" rel="disclosure">public list of any patent
    disclosures</a> made in connection with the deliverables of the group; that page also includes instructions for disclosing a patent. An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy/#sec-Disclosure">section
    6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2021/Process-20211102/" id="w3c_process_revision">2 November 2021 W3C Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#light-primitives"><span class="secno">2</span> <span class="content">Light Primitives</span></a>
     <ol class="toc">
      <li><a href="#xrlightprobe-interface"><span class="secno">2.1</span> <span class="content">XRLightProbe</span></a>
      <li><a href="#xrreflectionformat-interface"><span class="secno">2.2</span> <span class="content">XRReflectionFormat</span></a>
      <li><a href="#xrlightestimate-interface"><span class="secno">2.3</span> <span class="content">XRLightEstimate</span></a>
     </ol>
    <li>
     <a href="#webxr-device-api-integration"><span class="secno">3</span> <span class="content">WebXR Device API Integration</span></a>
     <ol class="toc">
      <li><a href="#session-initialization"><span class="secno">3.1</span> <span class="content">Session Initialization</span></a>
      <li><a href="#xrsession-interface"><span class="secno">3.2</span> <span class="content">XRSession</span></a>
      <li><a href="#xrframe-interface"><span class="secno">3.3</span> <span class="content">XRFrame</span></a>
     </ol>
    <li>
     <a href="#webxr-layers-integration"><span class="secno">4</span> <span class="content">WebXR Layers Integration</span></a>
     <ol class="toc">
      <li><a href="#xrwebglbinding-interface"><span class="secno">4.1</span> <span class="content">XRWebGLBinding</span></a>
     </ol>
    <li>
     <a href="#events"><span class="secno">5</span> <span class="content">Events</span></a>
     <ol class="toc">
      <li><a href="#event-types"><span class="secno">5.1</span> <span class="content">Event Types</span></a>
     </ol>
    <li><a href="#privacy-security"><span class="secno">6</span> <span class="content">Privacy &amp; Security Considerations</span></a>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>The WebXR Lighting Estimation module expands the <a href="https://www.w3.org/TR/webxr/">WebXR Device API</a>, the <a href="https://immersive-web.github.io/webxr-ar-module/">WebXR Augmented Reality Module</a>, and the <a href="https://immersive-web.github.io/layers/">WebXR Layers module</a> with the ability to expose estimates of the lighting conditions of the user’s environment.</p>
   <h2 class="heading settled" data-level="2" id="light-primitives"><span class="secno">2. </span><span class="content">Light Primitives</span><a class="self-link" href="#light-primitives"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="xrlightprobe-interface"><span class="secno">2.1. </span><span class="content">XRLightProbe</span><a class="self-link" href="#xrlightprobe-interface"></a></h3>
   <p>An <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe">XRLightProbe</a></code> collects estimated lighting information at a given point in the user’s environment.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="xrlightprobe"><code><c- g>XRLightProbe</c-></code></dfn> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget" id="ref-for-eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://immersive-web.github.io/webxr/#xrspace" id="ref-for-xrspace"><c- n>XRSpace</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="XRSpace" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace"><c- g>probeSpace</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler" id="ref-for-eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-xrlightprobe-onreflectionchange" id="ref-for-dom-xrlightprobe-onreflectionchange"><c- g>onreflectionchange</c-></a>;
};
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="attribute" data-export id="dom-xrlightprobe-probespace"><code>probeSpace</code></dfn> attribute is an <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/webxr/#xrspace" id="ref-for-xrspace①">XRSpace</a></code> that has a <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrspace-native-origin" id="ref-for-xrspace-native-origin">native origin</a> tracking the position and orientation that the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①">XRLightProbe</a></code>'s lighting estimations are being generated relative to.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="attribute" data-export id="dom-xrlightprobe-onreflectionchange"><code>onreflectionchange</code></dfn> attribute is an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes" id="ref-for-event-handler-idl-attributes">Event handler IDL attribute</a> for the <code class="idl"><a data-link-type="idl" href="#eventdef-xrlightprobe-reflectionchange" id="ref-for-eventdef-xrlightprobe-reflectionchange">reflectionchange</a></code> event type.</p>
   <h3 class="heading settled" data-level="2.2" id="xrreflectionformat-interface"><span class="secno">2.2. </span><span class="content">XRReflectionFormat</span><a class="self-link" href="#xrreflectionformat-interface"></a></h3>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-xrreflectionformat"><code><c- g>XRReflectionFormat</c-></code></dfn> {
  <dfn class="dfn-paneled idl-code" data-dfn-for="XRReflectionFormat" data-dfn-type="enum-value" data-export id="dom-xrreflectionformat-srgba8"><code><c- s>"srgba8"</c-></code></dfn>,
  <dfn class="dfn-paneled idl-code" data-dfn-for="XRReflectionFormat" data-dfn-type="enum-value" data-export id="dom-xrreflectionformat-rgba16f"><code><c- s>"rgba16f"</c-></code></dfn>,
};
</pre>
   <p>Reflection cube maps have an internal reflection format that indicates how the texture data is represented, and may change how applications choose to use the texture. Cube maps MAY be requested with the <code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8">"srgba8"</a></code> format or the <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat">preferredReflectionFormat</a></code> of the light probe.</p>
   <table class="data">
    <thead>
     <tr>
      <th><code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat">XRReflectionFormat</a></code> 
      <th>WebGL Format 
      <th>WebGL Internal Format 
      <th>WebGPU Format 
      <th>HDR 
    <tbody>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8①">"srgba8"</a></code> 
      <td>RGBA 
      <td>SRGB8_ALPHA8 
      <td>"rgba8unorm-srgb" 
      <td>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-rgba16f" id="ref-for-dom-xrreflectionformat-rgba16f">"rgba16f"</a></code> 
      <td>RGBA 
      <td>RGBA16F 
      <td>"rgba16float" 
      <td>✓ 
   </table>
   <h3 class="heading settled" data-level="2.3" id="xrlightestimate-interface"><span class="secno">2.3. </span><span class="content">XRLightEstimate</span><a class="self-link" href="#xrlightestimate-interface"></a></h3>
   <p>An <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate">XRLightEstimate</a></code> provides the estimated lighting values for an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe②">XRLightProbe</a></code> at the time represented by an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface">XRFrame</a></code>. <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate①">XRLightEstimate</a></code>s are queried by passing an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe③">XRLightProbe</a></code> to the <code class="idl"><a data-link-type="idl" href="#dom-xrframe-getlightestimate" id="ref-for-dom-xrframe-getlightestimate">getLightEstimate()</a></code> method of an <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface①">XRFrame</a></code>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext" id="ref-for-SecureContext①"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="xrlightestimate"><code><c- g>XRLightEstimate</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-Float32Array" id="ref-for-idl-Float32Array"><c- b>Float32Array</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Float32Array" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients"><c- g>sphericalHarmonicsCoefficients</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly" id="ref-for-dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection"><c- g>primaryLightDirection</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly" id="ref-for-dompointreadonly①"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity"><c- g>primaryLightIntensity</c-></a>;
};
</pre>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-sphericalharmonicscoefficients"><code>sphericalHarmonicsCoefficients</code></dfn> attribute returns a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Float32Array" id="ref-for-idl-Float32Array①">Float32Array</a></code> containing 9 spherical harmonics coefficients. The array MUST be 27 elements in length, with every 3 elements defining the red, green, and blue components respectively of a single coefficient. The first term of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients①">sphericalHarmonicsCoefficients</a></code>, meaning the first 3 elements of the array, MUST be representative of a valid lighting estimate. All other terms are optional, and MAY be 0 if a corresponding lighting estimate is not available due to either user privacy settings or the capabilities of the platform.</p>
   <p>The order of coefficients in <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients②">sphericalHarmonicsCoefficients</a></code>, is  [<var>C</var><sub>0</sub><sup>0</sup>, <var>C</var><sub>1</sub><sup>-1</sup>, <var>C</var><sub>1</sub><sup>0</sup>, <var>C</var><sub>1</sub><sup>1</sup>, <var>C</var><sub>2</sub><sup>-2</sup>, <var>C</var><sub>2</sub><sup>-1</sup>, <var>C</var><sub>2</sub><sup>0</sup>, <var>C</var><sub>2</sub><sup>1</sup>, <var>C</var><sub>2</sub><sup>2</sup>], where <var>C</var><sub><var>l</var></sub><sup><var>m</var></sup> is the coefficient of spherical harmonic <var>Y</var><sub><var>l</var></sub><sup><var>m</var></sup>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-primarylightdirection"><code>primaryLightDirection</code></dfn> represents the direction to the primary light source from the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrspace-native-origin" id="ref-for-xrspace-native-origin①">native origin</a> of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace①">probeSpace</a></code> of the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe④">XRLightProbe</a></code> that produced the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate②">XRLightEstimate</a></code>. The value MUST be a unit length 3D vector and the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w" id="ref-for-dom-dompointreadonly-w">w</a></code> value MUST be <code>0.0</code>. If estimated values from the users’s environment are not available the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection①">primaryLightDirection</a></code> MUST be <code>{ x: 0.0, y: 1.0, z: 0.0, w: 0.0 }</code>, representing a light shining straight down from above.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightEstimate" data-dfn-type="attribute" data-export id="dom-xrlightestimate-primarylightintensity"><code>primaryLightIntensity</code></dfn> represents the direction to the primary light source from the origin of the <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobe-probespace" id="ref-for-dom-xrlightprobe-probespace②">probeSpace</a></code> of the <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑤">XRLightProbe</a></code> that produced the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate③">XRLightEstimate</a></code>. The value MUST represent an RGB value mapped to the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x" id="ref-for-dom-dompointreadonly-x">x</a></code>, <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y" id="ref-for-dom-dompointreadonly-y">y</a></code>, and <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z" id="ref-for-dom-dompointreadonly-z">z</a></code> values respectively where each component is greater than or equal to <code>0.0</code> and the <code class="idl"><a data-link-type="idl" href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w" id="ref-for-dom-dompointreadonly-w①">w</a></code> value MUST be <code>1.0</code>. If estimated values from the users’s environment are not available the <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity①">primaryLightIntensity</a></code> MUST be <code>{x: 0.0, y: 0.0, z: 0.0, w: 1.0}</code>, representing no illumination.</p>
   <h2 class="heading settled" data-level="3" id="webxr-device-api-integration"><span class="secno">3. </span><span class="content">WebXR Device API Integration</span><a class="self-link" href="#webxr-device-api-integration"></a></h2>
   <p>Both the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface">XRSession</a></code> and <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface②">XRFrame</a></code> interfaces from the <a href="https://www.w3.org/TR/webxr/">WebXR Device API</a> are expanded by this module.</p>
   <h3 class="heading settled" data-level="3.1" id="session-initialization"><span class="secno">3.1. </span><span class="content">Session Initialization</span><a class="self-link" href="#session-initialization"></a></h3>
   <p>The string "<dfn class="dfn-paneled" data-dfn-for="feature descriptor" data-dfn-type="dfn" data-noexport id="feature-descriptor-light-estimation">light-estimation</dfn>" is introduced by this module as a new valid <a data-link-type="dfn">feature descriptor</a>. Applications that wish to use light estimation features MUST be requested with an the "<a data-link-type="dfn" href="#feature-descriptor-light-estimation" id="ref-for-feature-descriptor-light-estimation">light-estimation</a>" <a data-link-type="dfn">feature descriptor</a>.</p>
   <h3 class="heading settled" data-level="3.2" id="xrsession-interface"><span class="secno">3.2. </span><span class="content">XRSession</span><a class="self-link" href="#xrsession-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface①">XRSession</a></code> interface is extended with the ability to create new <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑥">XRLightProbe</a></code> instances. <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑦">XRLightProbe</a></code> instances have a <dfn class="dfn-paneled" data-dfn-for="XRLightProbe" data-dfn-type="dfn" data-noexport id="xrlightprobe-session">session</dfn> object, which is the <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface②">XRSession</a></code> that created this <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe⑧">XRLightProbe</a></code>. And an <dfn class="dfn-paneled" data-dfn-for="XRLightProbe" data-dfn-type="dfn" data-noexport id="xrlightprobe-reflection-format">reflection format</dfn> object, which is the <code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat①">XRReflectionFormat</a></code> that the light probe may retrieve.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface③">XRSession</a></code> interface is further extended with an attribute <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat①">preferredReflectionFormat</a></code>, indicating the <code class="idl"><a data-link-type="idl" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat②">XRReflectionFormat</a></code> most closely supported by the underlying <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device">XR device</a></p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-xrlightprobeinit"><code><c- g>XRLightProbeInit</c-></code></dfn> {
  <a data-link-type="idl-name" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat③"><c- n>XRReflectionFormat</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;srgba8&quot;" data-dfn-for="XRLightProbeInit" data-dfn-type="dict-member" data-export data-type="XRReflectionFormat " id="dom-xrlightprobeinit-reflectionformat"><code><c- g>reflectionFormat</c-></code></dfn> = "srgba8";
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface④"><c- g>XRSession</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe⑨"><c- n>XRLightProbe</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-xrsession-requestlightprobe" id="ref-for-dom-xrsession-requestlightprobe"><c- g>requestLightProbe</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-xrlightprobeinit" id="ref-for-dictdef-xrlightprobeinit"><c- n>XRLightProbeInit</c-></a> <dfn class="idl-code" data-dfn-for="XRSession/requestLightProbe(options), XRSession/requestLightProbe()" data-dfn-type="argument" data-export id="dom-xrsession-requestlightprobe-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-xrsession-requestlightprobe-options-options"></a></dfn> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-xrreflectionformat" id="ref-for-enumdef-xrreflectionformat④"><c- n>XRReflectionFormat</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="XRSession" data-dfn-type="attribute" data-export data-readonly data-type="XRReflectionFormat" id="dom-xrsession-preferredreflectionformat"><code><c- g>preferredReflectionFormat</c-></code></dfn>;
};
</pre>
   <div class="algorithm" data-algorithm="request-light-probe">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRSession" data-dfn-type="method" data-export data-lt="requestLightProbe(options)|requestLightProbe()" id="dom-xrsession-requestlightprobe"><code>requestLightProbe(<var>options</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrsession-interface" id="ref-for-xrsession-interface⑤">XRSession</a></code> <var>session</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise">a new Promise</a>.</p>
     <li data-md>
      <p>If the <a data-link-type="dfn" href="#feature-descriptor-light-estimation" id="ref-for-feature-descriptor-light-estimation①">light-estimation</a> feature descriptor is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contained</a> in the <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features" id="ref-for-xrsession-list-of-enabled-features">list of enabled features</a>, <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">reject</a> <var>promise</var> with <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notsupportederror" id="ref-for-notsupportederror">NotSupportedError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#ended" id="ref-for-ended">ended</a> value is <code>true</code>, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror">InvalidStateError</a></code> and abort these steps.</p>
      <dl class="switch">
       <dt>If <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobeinit-reflectionformat" id="ref-for-dom-xrlightprobeinit-reflectionformat">reflectionFormat</a></code> is <code class="idl"><a data-link-type="idl" href="#dom-xrreflectionformat-srgba8" id="ref-for-dom-xrreflectionformat-srgba8②">"srgba8"</a></code> or matches <var>session</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrsession-preferredreflectionformat" id="ref-for-dom-xrsession-preferredreflectionformat②">preferredReflectionFormat</a></code>:
       <dd>
        <ol>
         <li data-md>
          <p>Let <var>probe</var> be a new <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①⓪">XRLightProbe</a></code>.</p>
         <li data-md>
          <p>Set <var>probe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session">session</a> to <var>session</var>.</p>
         <li data-md>
          <p>Set <var>probe</var>’s <a data-link-type="dfn" href="#xrlightprobe-reflection-format" id="ref-for-xrlightprobe-reflection-format">reflection format</a> to <var>options</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightprobeinit-reflectionformat" id="ref-for-dom-xrlightprobeinit-reflectionformat①">reflectionFormat</a></code></p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">Resolve</a> <var>promise</var> with <var>probe</var>.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject①">Reject</a> <var>promise</var> with a "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notsupportederror" id="ref-for-notsupportederror①">NotSupportedError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code></p>
        </ol>
      </dl>
    </ol>
   </div>
   <h3 class="heading settled" data-level="3.3" id="xrframe-interface"><span class="secno">3.3. </span><span class="content">XRFrame</span><a class="self-link" href="#xrframe-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface③">XRFrame</a></code> interface is extended with the ability to query the <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate④">XRLightEstimate</a></code> for a given <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①①">XRLightProbe</a></code>.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface④"><c- g>XRFrame</c-></a> {
  <a data-link-type="idl-name" href="#xrlightestimate" id="ref-for-xrlightestimate⑤"><c- n>XRLightEstimate</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrframe-getlightestimate" id="ref-for-dom-xrframe-getlightestimate①"><c- g>getLightEstimate</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe①②"><c- n>XRLightProbe</c-></a> <dfn class="idl-code" data-dfn-for="XRFrame/getLightEstimate(lightProbe)" data-dfn-type="argument" data-export id="dom-xrframe-getlightestimate-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code><a class="self-link" href="#dom-xrframe-getlightestimate-lightprobe-lightprobe"></a></dfn>);
};
</pre>
   <div class="algorithm" data-algorithm="get-light-estimate">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRFrame" data-dfn-type="method" data-export id="dom-xrframe-getlightestimate"><code>getLightEstimate(<var>lightProbe</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://www.w3.org/TR/webxr/#xrframe-interface" id="ref-for-xrframe-interface⑤">XRFrame</a></code> <var>frame</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>frame</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrframe-active" id="ref-for-xrframe-active">active</a> boolean is `false`, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror①">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>session</var> be <var>frame</var>’s <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/webxr/#dom-xrframe-session" id="ref-for-dom-xrframe-session">session</a></code> object.</p>
     <li data-md>
      <p>If <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session①">session</a> does not equal <var>session</var>, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror②">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>device</var> be <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device①">XR device</a>.</p>
     <li data-md>
      <p>If <var>device</var> cannot estimate the lighting for this frame, return null.</p>
     <li data-md>
      <p>Let <var>estimate</var> be a new <code class="idl"><a data-link-type="idl" href="#xrlightestimate" id="ref-for-xrlightestimate⑥">XRLightEstimate</a></code>.</p>
     <li data-md>
      <p>Populate estimate|'s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-sphericalharmonicscoefficients" id="ref-for-dom-xrlightestimate-sphericalharmonicscoefficients③">sphericalHarmonicsCoefficients</a></code>, with the coefficients provided by <var>device</var>.</p>
      <dl class="switch">
       <dt>If <var>device</var> has an estimated direction for the light source
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection②">primaryLightDirection</a></code> to the estimated direction of the light source.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightdirection" id="ref-for-dom-xrlightestimate-primarylightdirection③">primaryLightDirection</a></code> to <code>{ x: 0.0, y: 1.0, z: 0.0, w: 0.0 }</code></p>
        </ol>
      </dl>
      <dl class="switch">
       <dt>If <var>device</var> has an estimated intensity for the light source
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity②">primaryLightIntensity</a></code> to the estimated intensity of the light source.</p>
        </ol>
       <dt>else
       <dd>
        <ol>
         <li data-md>
          <p>Set <var>estimate</var>’s <code class="idl"><a data-link-type="idl" href="#dom-xrlightestimate-primarylightintensity" id="ref-for-dom-xrlightestimate-primarylightintensity③">primaryLightIntensity</a></code> to <code>{x: 0.0, y: 0.0, z: 0.0, w: 1.0}</code></p>
        </ol>
      </dl>
     <li data-md>
      <p>Return <var>estimate</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="4" id="webxr-layers-integration"><span class="secno">4. </span><span class="content">WebXR Layers Integration</span><a class="self-link" href="#webxr-layers-integration"></a></h2>
   <p>The <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding">XRWebGLBinding</a></code> interface from the <a href="https://immersive-web.github.io/layers/">WebXR Layers module</a> is expanded by this module.</p>
   <h3 class="heading settled" data-level="4.1" id="xrwebglbinding-interface"><span class="secno">4.1. </span><span class="content">XRWebGLBinding</span><a class="self-link" href="#xrwebglbinding-interface"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding①">XRWebGLBinding</a></code> interface is extended with the ability to query a reflection cube map for a given <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①③">XRLightProbe</a></code>.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding②"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture" id="ref-for-WebGLTexture"><c- n>WebGLTexture</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrwebglbinding-getreflectioncubemap" id="ref-for-dom-xrwebglbinding-getreflectioncubemap"><c- g>getReflectionCubeMap</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe" id="ref-for-xrlightprobe①④"><c- n>XRLightProbe</c-></a> <dfn class="idl-code" data-dfn-for="XRWebGLBinding/getReflectionCubeMap(lightProbe)" data-dfn-type="argument" data-export id="dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code><a class="self-link" href="#dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"></a></dfn>);
};
</pre>
   <div class="algorithm" data-algorithm="get-reflection-cubemap">
     When the <dfn class="dfn-paneled idl-code" data-dfn-for="XRWebGLBinding" data-dfn-type="method" data-export id="dom-xrwebglbinding-getreflectioncubemap"><code>getReflectionCubeMap(<var>lightProbe</var>)</code></dfn> method is invoked on <code class="idl"><a data-link-type="idl" href="https://immersive-web.github.io/layers/#xrwebglbinding" id="ref-for-xrwebglbinding③">XRWebGLBinding</a></code> <var>binding</var>, the user agent MUST run the following steps: 
    <ol>
     <li data-md>
      <p>If <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#xrwebglbinding-context" id="ref-for-xrwebglbinding-context">context</a> is lost, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror③">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>session</var> be <var>binding</var>’s <a data-link-type="dfn" href="https://immersive-web.github.io/layers/#session" id="ref-for-session">session</a>.</p>
     <li data-md>
      <p>If <var>session</var> is ended, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror④">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>If <var>session</var> does not match <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-session" id="ref-for-xrlightprobe-session②">session</a>, throw an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#invalidstateerror" id="ref-for-invalidstateerror⑤">InvalidStateError</a></code> and abort these steps.</p>
     <li data-md>
      <p>Let <var>device</var> be <var>session</var>’s <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xrsession-xr-device" id="ref-for-xrsession-xr-device②">XR Device</a>.</p>
     <li data-md>
      <p>If no reflection cube map is available from <var>device</var>, return <code>null</code>.</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture" id="ref-for-WebGLTexture①">WebGLTexture</a></code> cubemap in the format specified by <var>lightProbe</var>’s <a data-link-type="dfn" href="#xrlightprobe-reflection-format" id="ref-for-xrlightprobe-reflection-format①">reflection format</a> and populated with the data from <var>device</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="events"><span class="secno">5. </span><span class="content">Events</span><a class="self-link" href="#events"></a></h2>
   <p>The <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source" id="ref-for-task-source">task source</a> for all <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">tasks queued</a> in this specification is the <a data-link-type="dfn" href="https://www.w3.org/TR/webxr/#xr-task-source" id="ref-for-xr-task-source">XR task source</a>, unless otherwise specified.</p>
   <h3 class="heading settled" data-level="5.1" id="event-types"><span class="secno">5.1. </span><span class="content">Event Types</span><a class="self-link" href="#event-types"></a></h3>
   <p>The user agent MUST fire a <dfn class="dfn-paneled idl-code" data-dfn-for="XRLightProbe" data-dfn-type="event" data-export id="eventdef-xrlightprobe-reflectionchange"><code>reflectionchange</code></dfn> event on an <code class="idl"><a data-link-type="idl" href="#xrlightprobe" id="ref-for-xrlightprobe①⑤">XRLightProbe</a></code> object each time the contents of the cube map returned by calling <code class="idl"><a data-link-type="idl" href="#dom-xrwebglbinding-getreflectioncubemap" id="ref-for-dom-xrwebglbinding-getreflectioncubemap①">getReflectionCubeMap()</a></code> have changed. The event MUST be of type <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#event" id="ref-for-event">Event</a></code>.</p>
   <h2 class="heading settled" data-level="6" id="privacy-security"><span class="secno">6. </span><span class="content">Privacy &amp; Security Considerations</span><a class="self-link" href="#privacy-security"></a></h2>
   <section class="non-normative">
    <p>The lighting estimation API shares many potential <a data-link-type="dfn" href="https://www.w3.org/TR/ambient-light/#security-and-privacy" id="ref-for-security-and-privacy">privacy and security risks</a> with the Ambient Light Sensor API <a data-link-type="biblio" href="#biblio-ambient-light" title="Ambient Light Sensor">[AMBIENT-LIGHT]</a>, including:</p>
    <ul>
     <li data-md>
      <p>Profiling: Lighting Estimation can leak information about user’s use patterns and surroundings. This information can be used to enhance user profiling and behavioral analysis.</p>
     <li data-md>
      <p>Cross-device Linking: Two devices can access web sites that include the same third-party script that correlates lighting levels over time.</p>
     <li data-md>
      <p>Cross Device Communication: A simple broadcast communication method can use device screen or camera LED flashes to broadcast messages read out with lighting estimation on a nearby device.</p>
    </ul>
    <p>In addition to these, there are a few vectors unique to lighting estimation to
consider.</p>
    <ul>
     <li data-md>
      <p>The lighting estimation returned by the WebXR API explicitly describes the real world environment in close proximity to the user.</p>
     <li data-md>
      <p>Reflection cube maps of a high enough resolution approach the same level as camera access.</p>
    </ul>
    <p>Lighting estimation must be declared when creating an XR Session as a <a data-link-type="dfn">feature descriptor</a>, which will allow the user agent to notify the user of the potential privacy implications of allowing the lighting estimation API to be used by the website. The user agent is encouraged to NOT provide real-time updates to any portion of the lighting estimation API, especially the reflection cube map. By default, only low spaital frequency and low temporal frequency information should be returned by the WebXR API. Reflection cube maps should be kept low resolution, unless the user has also consented to camera permissions for a particular origin.  As further mitigation, the Spherical Harmonics and primary light direction MAY be quantized.</p>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-xrframe-getlightestimate">getLightEstimate(lightProbe)</a><span>, in § 3.3</span>
   <li><a href="#dom-xrwebglbinding-getreflectioncubemap">getReflectionCubeMap(lightProbe)</a><span>, in § 4.1</span>
   <li><a href="#feature-descriptor-light-estimation">light-estimation</a><span>, in § 3.1</span>
   <li><a href="#dom-xrlightprobe-onreflectionchange">onreflectionchange</a><span>, in § 2.1</span>
   <li><a href="#dom-xrsession-preferredreflectionformat">preferredReflectionFormat</a><span>, in § 3.2</span>
   <li><a href="#dom-xrlightestimate-primarylightdirection">primaryLightDirection</a><span>, in § 2.3</span>
   <li><a href="#dom-xrlightestimate-primarylightintensity">primaryLightIntensity</a><span>, in § 2.3</span>
   <li><a href="#dom-xrlightprobe-probespace">probeSpace</a><span>, in § 2.1</span>
   <li><a href="#eventdef-xrlightprobe-reflectionchange">reflectionchange</a><span>, in § 5.1</span>
   <li><a href="#xrlightprobe-reflection-format">reflection format</a><span>, in § 3.2</span>
   <li><a href="#dom-xrlightprobeinit-reflectionformat">reflectionFormat</a><span>, in § 3.2</span>
   <li><a href="#dom-xrsession-requestlightprobe">requestLightProbe()</a><span>, in § 3.2</span>
   <li><a href="#dom-xrsession-requestlightprobe">requestLightProbe(options)</a><span>, in § 3.2</span>
   <li><a href="#dom-xrreflectionformat-rgba16f">"rgba16f"</a><span>, in § 2.2</span>
   <li><a href="#xrlightprobe-session">session</a><span>, in § 3.2</span>
   <li><a href="#dom-xrlightestimate-sphericalharmonicscoefficients">sphericalHarmonicsCoefficients</a><span>, in § 2.3</span>
   <li><a href="#dom-xrreflectionformat-srgba8">"srgba8"</a><span>, in § 2.2</span>
   <li><a href="#xrlightestimate">XRLightEstimate</a><span>, in § 2.3</span>
   <li><a href="#xrlightprobe">XRLightProbe</a><span>, in § 2.1</span>
   <li><a href="#dictdef-xrlightprobeinit">XRLightProbeInit</a><span>, in § 3.2</span>
   <li><a href="#enumdef-xrreflectionformat">XRReflectionFormat</a><span>, in § 2.2</span>
  </ul>
  <aside aria-labelledby="infopaneltitle-for-c53cba7b26b1a5b0e0b8a4e1ab54d6d3" class="dfn-panel" data-for="c53cba7b26b1a5b0e0b8a4e1ab54d6d3" id="infopanel-for-c53cba7b26b1a5b0e0b8a4e1ab54d6d3">
   <span id="infopaneltitle-for-c53cba7b26b1a5b0e0b8a4e1ab54d6d3" style="display:none">Info about the 'privacy and security risks' external reference.</span><a href="https://www.w3.org/TR/ambient-light/#security-and-privacy">https://www.w3.org/TR/ambient-light/#security-and-privacy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-security-and-privacy">6. Privacy &amp; Security Considerations</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-316772b0029bcc028521d2db08fd3717" class="dfn-panel" data-for="316772b0029bcc028521d2db08fd3717" id="infopanel-for-316772b0029bcc028521d2db08fd3717">
   <span id="infopaneltitle-for-316772b0029bcc028521d2db08fd3717" style="display:none">Info about the 'Event' external reference.</span><a href="https://dom.spec.whatwg.org/#event">https://dom.spec.whatwg.org/#event</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event">5.1. Event Types</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a6aa66e0075314e8eefa4e662cb40fbb" class="dfn-panel" data-for="a6aa66e0075314e8eefa4e662cb40fbb" id="infopanel-for-a6aa66e0075314e8eefa4e662cb40fbb">
   <span id="infopaneltitle-for-a6aa66e0075314e8eefa4e662cb40fbb" style="display:none">Info about the 'EventTarget' external reference.</span><a href="https://dom.spec.whatwg.org/#eventtarget">https://dom.spec.whatwg.org/#eventtarget</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventtarget">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-22f6656444120cc0d06a1fbf0992caa0" class="dfn-panel" data-for="22f6656444120cc0d06a1fbf0992caa0" id="infopanel-for-22f6656444120cc0d06a1fbf0992caa0">
   <span id="infopaneltitle-for-22f6656444120cc0d06a1fbf0992caa0" style="display:none">Info about the 'DOMPointReadOnly' external reference.</span><a href="https://drafts.fxtf.org/geometry-1/#dompointreadonly">https://drafts.fxtf.org/geometry-1/#dompointreadonly</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dompointreadonly">2.3. XRLightEstimate</a> <a href="#ref-for-dompointreadonly①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-4988b25abb4b0989abd17019ba4f0dca" class="dfn-panel" data-for="4988b25abb4b0989abd17019ba4f0dca" id="infopanel-for-4988b25abb4b0989abd17019ba4f0dca">
   <span id="infopaneltitle-for-4988b25abb4b0989abd17019ba4f0dca" style="display:none">Info about the 'w' external reference.</span><a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-w</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-w">2.3. XRLightEstimate</a> <a href="#ref-for-dom-dompointreadonly-w①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-962570e35c6bb5cf295b70af03c7034c" class="dfn-panel" data-for="962570e35c6bb5cf295b70af03c7034c" id="infopanel-for-962570e35c6bb5cf295b70af03c7034c">
   <span id="infopaneltitle-for-962570e35c6bb5cf295b70af03c7034c" style="display:none">Info about the 'x' external reference.</span><a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-x</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-x">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-33bb969454b6bdc9c36f8387e168d700" class="dfn-panel" data-for="33bb969454b6bdc9c36f8387e168d700" id="infopanel-for-33bb969454b6bdc9c36f8387e168d700">
   <span id="infopaneltitle-for-33bb969454b6bdc9c36f8387e168d700" style="display:none">Info about the 'y' external reference.</span><a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-y</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-y">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-392b8d97b5cfcf1625150ef7ae8ecbd3" class="dfn-panel" data-for="392b8d97b5cfcf1625150ef7ae8ecbd3" id="infopanel-for-392b8d97b5cfcf1625150ef7ae8ecbd3">
   <span id="infopaneltitle-for-392b8d97b5cfcf1625150ef7ae8ecbd3" style="display:none">Info about the 'z' external reference.</span><a href="https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z">https://drafts.fxtf.org/geometry-1/#dom-dompointreadonly-z</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-dompointreadonly-z">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-716703f1068cc638b4235f83154eff6c" class="dfn-panel" data-for="716703f1068cc638b4235f83154eff6c" id="infopanel-for-716703f1068cc638b4235f83154eff6c">
   <span id="infopaneltitle-for-716703f1068cc638b4235f83154eff6c" style="display:none">Info about the 'EventHandler' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler">https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventhandler">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e76cd636ec243fdd4a25330499736463" class="dfn-panel" data-for="e76cd636ec243fdd4a25330499736463" id="infopanel-for-e76cd636ec243fdd4a25330499736463">
   <span id="infopaneltitle-for-e76cd636ec243fdd4a25330499736463" style="display:none">Info about the 'event handler idl attribute' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes">https://html.spec.whatwg.org/multipage/webappapis.html#event-handler-idl-attributes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-handler-idl-attributes">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-da7ed5f190c4eedd375552d6f7876301" class="dfn-panel" data-for="da7ed5f190c4eedd375552d6f7876301" id="infopanel-for-da7ed5f190c4eedd375552d6f7876301">
   <span id="infopaneltitle-for-da7ed5f190c4eedd375552d6f7876301" style="display:none">Info about the 'queue a task' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-task">5. Events</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-8022a5f0b9910c35c5215fd070e93d09" class="dfn-panel" data-for="8022a5f0b9910c35c5215fd070e93d09" id="infopanel-for-8022a5f0b9910c35c5215fd070e93d09">
   <span id="infopaneltitle-for-8022a5f0b9910c35c5215fd070e93d09" style="display:none">Info about the 'task source' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#task-source">https://html.spec.whatwg.org/multipage/webappapis.html#task-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-task-source">5. Events</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" class="dfn-panel" data-for="eb75379b05abc264a531a791358e1eba" id="infopanel-for-eb75379b05abc264a531a791358e1eba">
   <span id="infopaneltitle-for-eb75379b05abc264a531a791358e1eba" style="display:none">Info about the 'contain' external reference.</span><a href="https://infra.spec.whatwg.org/#list-contain">https://infra.spec.whatwg.org/#list-contain</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-contain">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c7ee65072c07dd070e06852fdb4de2a5" class="dfn-panel" data-for="c7ee65072c07dd070e06852fdb4de2a5" id="infopanel-for-c7ee65072c07dd070e06852fdb4de2a5">
   <span id="infopaneltitle-for-c7ee65072c07dd070e06852fdb4de2a5" style="display:none">Info about the 'WebGLTexture' external reference.</span><a href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture">https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-WebGLTexture">4.1. XRWebGLBinding</a> <a href="#ref-for-WebGLTexture①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" class="dfn-panel" data-for="0ab204fb9cc9a746edaff83c0db0740a" id="infopanel-for-0ab204fb9cc9a746edaff83c0db0740a">
   <span id="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" style="display:none">Info about the 'DOMException' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMException">https://webidl.spec.whatwg.org/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dde049eb112f043fc45407ec0d4cb457" class="dfn-panel" data-for="dde049eb112f043fc45407ec0d4cb457" id="infopanel-for-dde049eb112f043fc45407ec0d4cb457">
   <span id="infopaneltitle-for-dde049eb112f043fc45407ec0d4cb457" style="display:none">Info about the 'Exposed' external reference.</span><a href="https://webidl.spec.whatwg.org/#Exposed">https://webidl.spec.whatwg.org/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">2.1. XRLightProbe</a>
    <li><a href="#ref-for-Exposed①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-239c03b36afd7db097e4f112cedf2dc3" class="dfn-panel" data-for="239c03b36afd7db097e4f112cedf2dc3" id="infopanel-for-239c03b36afd7db097e4f112cedf2dc3">
   <span id="infopaneltitle-for-239c03b36afd7db097e4f112cedf2dc3" style="display:none">Info about the 'Float32Array' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-Float32Array">https://webidl.spec.whatwg.org/#idl-Float32Array</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-Float32Array">2.3. XRLightEstimate</a> <a href="#ref-for-idl-Float32Array①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-e2a06375a2fb70c61a8b4cd0abe9d4f1" class="dfn-panel" data-for="e2a06375a2fb70c61a8b4cd0abe9d4f1" id="infopanel-for-e2a06375a2fb70c61a8b4cd0abe9d4f1">
   <span id="infopaneltitle-for-e2a06375a2fb70c61a8b4cd0abe9d4f1" style="display:none">Info about the 'InvalidStateError' external reference.</span><a href="https://webidl.spec.whatwg.org/#invalidstateerror">https://webidl.spec.whatwg.org/#invalidstateerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invalidstateerror">3.2. XRSession</a>
    <li><a href="#ref-for-invalidstateerror①">3.3. XRFrame</a> <a href="#ref-for-invalidstateerror②">(2)</a>
    <li><a href="#ref-for-invalidstateerror③">4.1. XRWebGLBinding</a> <a href="#ref-for-invalidstateerror④">(2)</a> <a href="#ref-for-invalidstateerror⑤">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-c0194e44e6b2e643055f42ba786d0a3a" class="dfn-panel" data-for="c0194e44e6b2e643055f42ba786d0a3a" id="infopanel-for-c0194e44e6b2e643055f42ba786d0a3a">
   <span id="infopaneltitle-for-c0194e44e6b2e643055f42ba786d0a3a" style="display:none">Info about the 'NotSupportedError' external reference.</span><a href="https://webidl.spec.whatwg.org/#notsupportederror">https://webidl.spec.whatwg.org/#notsupportederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notsupportederror">3.2. XRSession</a> <a href="#ref-for-notsupportederror①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" class="dfn-panel" data-for="93669c631ec1ef8e696b4c083bdbe12c" id="infopanel-for-93669c631ec1ef8e696b4c083bdbe12c">
   <span id="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" style="display:none">Info about the 'Promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cdf224ec60dc3b08449a2fbdf3a90406" class="dfn-panel" data-for="cdf224ec60dc3b08449a2fbdf3a90406" id="infopanel-for-cdf224ec60dc3b08449a2fbdf3a90406">
   <span id="infopaneltitle-for-cdf224ec60dc3b08449a2fbdf3a90406" style="display:none">Info about the 'SecureContext' external reference.</span><a href="https://webidl.spec.whatwg.org/#SecureContext">https://webidl.spec.whatwg.org/#SecureContext</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-SecureContext">2.1. XRLightProbe</a>
    <li><a href="#ref-for-SecureContext①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" class="dfn-panel" data-for="bbe33fc7ac016834e4aaddbfd1b084a1" id="infopanel-for-bbe33fc7ac016834e4aaddbfd1b084a1">
   <span id="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" style="display:none">Info about the 'a new promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#a-new-promise">https://webidl.spec.whatwg.org/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" class="dfn-panel" data-for="f7204c0306e7ffcb24c31adf6e629e1d" id="infopanel-for-f7204c0306e7ffcb24c31adf6e629e1d">
   <span id="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" style="display:none">Info about the 'reject' external reference.</span><a href="https://webidl.spec.whatwg.org/#reject">https://webidl.spec.whatwg.org/#reject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reject">3.2. XRSession</a> <a href="#ref-for-reject①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f4f973f92274819781816b033aea1f11" class="dfn-panel" data-for="f4f973f92274819781816b033aea1f11" id="infopanel-for-f4f973f92274819781816b033aea1f11">
   <span id="infopaneltitle-for-f4f973f92274819781816b033aea1f11" style="display:none">Info about the 'resolve' external reference.</span><a href="https://webidl.spec.whatwg.org/#resolve">https://webidl.spec.whatwg.org/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-81d38bc4c9f63ab509668b59b3e58f93" class="dfn-panel" data-for="81d38bc4c9f63ab509668b59b3e58f93" id="infopanel-for-81d38bc4c9f63ab509668b59b3e58f93">
   <span id="infopaneltitle-for-81d38bc4c9f63ab509668b59b3e58f93" style="display:none">Info about the 'XRSpace' external reference.</span><a href="https://immersive-web.github.io/webxr/#xrspace">https://immersive-web.github.io/webxr/#xrspace</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrspace">2.1. XRLightProbe</a> <a href="#ref-for-xrspace①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a3b447eeb7dbd216b8f622f62880dedd" class="dfn-panel" data-for="a3b447eeb7dbd216b8f622f62880dedd" id="infopanel-for-a3b447eeb7dbd216b8f622f62880dedd">
   <span id="infopaneltitle-for-a3b447eeb7dbd216b8f622f62880dedd" style="display:none">Info about the 'session' external reference.</span><a href="https://immersive-web.github.io/webxr/#dom-xrframe-session">https://immersive-web.github.io/webxr/#dom-xrframe-session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrframe-session">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0448bacdb951c6c808cce9f79859004c" class="dfn-panel" data-for="0448bacdb951c6c808cce9f79859004c" id="infopanel-for-0448bacdb951c6c808cce9f79859004c">
   <span id="infopaneltitle-for-0448bacdb951c6c808cce9f79859004c" style="display:none">Info about the 'XRFrame' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrframe-interface">https://www.w3.org/TR/webxr/#xrframe-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-interface">2.3. XRLightEstimate</a> <a href="#ref-for-xrframe-interface①">(2)</a>
    <li><a href="#ref-for-xrframe-interface②">3. WebXR Device API Integration</a>
    <li><a href="#ref-for-xrframe-interface③">3.3. XRFrame</a> <a href="#ref-for-xrframe-interface④">(2)</a> <a href="#ref-for-xrframe-interface⑤">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-6a4e1b0c959522a43cb7d6591ea81393" class="dfn-panel" data-for="6a4e1b0c959522a43cb7d6591ea81393" id="infopanel-for-6a4e1b0c959522a43cb7d6591ea81393">
   <span id="infopaneltitle-for-6a4e1b0c959522a43cb7d6591ea81393" style="display:none">Info about the 'XRSession' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrsession-interface">https://www.w3.org/TR/webxr/#xrsession-interface</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-interface">3. WebXR Device API Integration</a>
    <li><a href="#ref-for-xrsession-interface①">3.2. XRSession</a> <a href="#ref-for-xrsession-interface②">(2)</a> <a href="#ref-for-xrsession-interface③">(3)</a> <a href="#ref-for-xrsession-interface④">(4)</a> <a href="#ref-for-xrsession-interface⑤">(5)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-1c8f701e24939749dc3074c6cb284d25" class="dfn-panel" data-for="1c8f701e24939749dc3074c6cb284d25" id="infopanel-for-1c8f701e24939749dc3074c6cb284d25">
   <span id="infopaneltitle-for-1c8f701e24939749dc3074c6cb284d25" style="display:none">Info about the 'active' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrframe-active">https://www.w3.org/TR/webxr/#xrframe-active</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrframe-active">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-10269e72751da0d71521ad482d969ac4" class="dfn-panel" data-for="10269e72751da0d71521ad482d969ac4" id="infopanel-for-10269e72751da0d71521ad482d969ac4">
   <span id="infopaneltitle-for-10269e72751da0d71521ad482d969ac4" style="display:none">Info about the 'ended' external reference.</span><a href="https://www.w3.org/TR/webxr/#ended">https://www.w3.org/TR/webxr/#ended</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ended">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cad5f01f05b41c17b9a660af83c359f3" class="dfn-panel" data-for="cad5f01f05b41c17b9a660af83c359f3" id="infopanel-for-cad5f01f05b41c17b9a660af83c359f3">
   <span id="infopaneltitle-for-cad5f01f05b41c17b9a660af83c359f3" style="display:none">Info about the 'list of enabled features' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features">https://www.w3.org/TR/webxr/#xrsession-list-of-enabled-features</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-list-of-enabled-features">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bf5999d4e3362c9120db2a3712a5e6b6" class="dfn-panel" data-for="bf5999d4e3362c9120db2a3712a5e6b6" id="infopanel-for-bf5999d4e3362c9120db2a3712a5e6b6">
   <span id="infopaneltitle-for-bf5999d4e3362c9120db2a3712a5e6b6" style="display:none">Info about the 'native origin' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrspace-native-origin">https://www.w3.org/TR/webxr/#xrspace-native-origin</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrspace-native-origin">2.1. XRLightProbe</a>
    <li><a href="#ref-for-xrspace-native-origin①">2.3. XRLightEstimate</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-00ff6dc8f6cd3081e6303cc2b49669d9" class="dfn-panel" data-for="00ff6dc8f6cd3081e6303cc2b49669d9" id="infopanel-for-00ff6dc8f6cd3081e6303cc2b49669d9">
   <span id="infopaneltitle-for-00ff6dc8f6cd3081e6303cc2b49669d9" style="display:none">Info about the 'xr device' external reference.</span><a href="https://www.w3.org/TR/webxr/#xrsession-xr-device">https://www.w3.org/TR/webxr/#xrsession-xr-device</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrsession-xr-device">3.2. XRSession</a>
    <li><a href="#ref-for-xrsession-xr-device①">3.3. XRFrame</a>
    <li><a href="#ref-for-xrsession-xr-device②">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-b87ee2981e0a25af9f41cb70f0038c5d" class="dfn-panel" data-for="b87ee2981e0a25af9f41cb70f0038c5d" id="infopanel-for-b87ee2981e0a25af9f41cb70f0038c5d">
   <span id="infopaneltitle-for-b87ee2981e0a25af9f41cb70f0038c5d" style="display:none">Info about the 'xr task source' external reference.</span><a href="https://www.w3.org/TR/webxr/#xr-task-source">https://www.w3.org/TR/webxr/#xr-task-source</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xr-task-source">5. Events</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-de54c8364087ab6e911d1de491dc921c" class="dfn-panel" data-for="de54c8364087ab6e911d1de491dc921c" id="infopanel-for-de54c8364087ab6e911d1de491dc921c">
   <span id="infopaneltitle-for-de54c8364087ab6e911d1de491dc921c" style="display:none">Info about the 'XRWebGLBinding' external reference.</span><a href="https://immersive-web.github.io/layers/#xrwebglbinding">https://immersive-web.github.io/layers/#xrwebglbinding</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding">4. WebXR Layers Integration</a>
    <li><a href="#ref-for-xrwebglbinding①">4.1. XRWebGLBinding</a> <a href="#ref-for-xrwebglbinding②">(2)</a> <a href="#ref-for-xrwebglbinding③">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-9860dc13013ac01db939dbe055fd0f15" class="dfn-panel" data-for="9860dc13013ac01db939dbe055fd0f15" id="infopanel-for-9860dc13013ac01db939dbe055fd0f15">
   <span id="infopaneltitle-for-9860dc13013ac01db939dbe055fd0f15" style="display:none">Info about the 'context' external reference.</span><a href="https://immersive-web.github.io/layers/#xrwebglbinding-context">https://immersive-web.github.io/layers/#xrwebglbinding-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrwebglbinding-context">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-ffeeaa4dbda5f70e27eec4ed49b849d7" class="dfn-panel" data-for="ffeeaa4dbda5f70e27eec4ed49b849d7" id="infopanel-for-ffeeaa4dbda5f70e27eec4ed49b849d7">
   <span id="infopaneltitle-for-ffeeaa4dbda5f70e27eec4ed49b849d7" style="display:none">Info about the 'session' external reference.</span><a href="https://immersive-web.github.io/layers/#session">https://immersive-web.github.io/layers/#session</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-session">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[AMBIENT-LIGHT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c53cba7b26b1a5b0e0b8a4e1ab54d6d3">privacy and security risks</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="316772b0029bcc028521d2db08fd3717">Event</span>
     <li><span class="dfn-paneled" id="a6aa66e0075314e8eefa4e662cb40fbb">EventTarget</span>
    </ul>
   <li>
    <a data-link-type="biblio">[GEOMETRY-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="22f6656444120cc0d06a1fbf0992caa0">DOMPointReadOnly</span>
     <li><span class="dfn-paneled" id="4988b25abb4b0989abd17019ba4f0dca">w</span>
     <li><span class="dfn-paneled" id="962570e35c6bb5cf295b70af03c7034c">x</span>
     <li><span class="dfn-paneled" id="33bb969454b6bdc9c36f8387e168d700">y</span>
     <li><span class="dfn-paneled" id="392b8d97b5cfcf1625150ef7ae8ecbd3">z</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="716703f1068cc638b4235f83154eff6c">EventHandler</span>
     <li><span class="dfn-paneled" id="e76cd636ec243fdd4a25330499736463">event handler idl attribute</span>
     <li><span class="dfn-paneled" id="da7ed5f190c4eedd375552d6f7876301">queue a task</span>
     <li><span class="dfn-paneled" id="8022a5f0b9910c35c5215fd070e93d09">task source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="eb75379b05abc264a531a791358e1eba">contain</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBGL-2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c7ee65072c07dd070e06852fdb4de2a5">WebGLTexture</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0ab204fb9cc9a746edaff83c0db0740a">DOMException</span>
     <li><span class="dfn-paneled" id="dde049eb112f043fc45407ec0d4cb457">Exposed</span>
     <li><span class="dfn-paneled" id="239c03b36afd7db097e4f112cedf2dc3">Float32Array</span>
     <li><span class="dfn-paneled" id="e2a06375a2fb70c61a8b4cd0abe9d4f1">InvalidStateError</span>
     <li><span class="dfn-paneled" id="c0194e44e6b2e643055f42ba786d0a3a">NotSupportedError</span>
     <li><span class="dfn-paneled" id="93669c631ec1ef8e696b4c083bdbe12c">Promise</span>
     <li><span class="dfn-paneled" id="cdf224ec60dc3b08449a2fbdf3a90406">SecureContext</span>
     <li><span class="dfn-paneled" id="bbe33fc7ac016834e4aaddbfd1b084a1">a new promise</span>
     <li><span class="dfn-paneled" id="f7204c0306e7ffcb24c31adf6e629e1d">reject</span>
     <li><span class="dfn-paneled" id="f4f973f92274819781816b033aea1f11">resolve</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="81d38bc4c9f63ab509668b59b3e58f93">XRSpace</span>
     <li><span class="dfn-paneled" id="a3b447eeb7dbd216b8f622f62880dedd">session</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR DEVICE API - LEVEL 1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0448bacdb951c6c808cce9f79859004c">XRFrame</span>
     <li><span class="dfn-paneled" id="6a4e1b0c959522a43cb7d6591ea81393">XRSession</span>
     <li><span class="dfn-paneled" id="1c8f701e24939749dc3074c6cb284d25">active</span>
     <li><span class="dfn-paneled" id="10269e72751da0d71521ad482d969ac4">ended</span>
     <li><span class="dfn-paneled" id="cad5f01f05b41c17b9a660af83c359f3">list of enabled features</span>
     <li><span class="dfn-paneled" id="bf5999d4e3362c9120db2a3712a5e6b6">native origin</span>
     <li><span class="dfn-paneled" id="00ff6dc8f6cd3081e6303cc2b49669d9">xr device</span>
     <li><span class="dfn-paneled" id="b87ee2981e0a25af9f41cb70f0038c5d">xr task source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBXR LAYERS API]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="de54c8364087ab6e911d1de491dc921c">XRWebGLBinding</span>
     <li><span class="dfn-paneled" id="9860dc13013ac01db939dbe055fd0f15">context</span>
     <li><span class="dfn-paneled" id="ffeeaa4dbda5f70e27eec4ed49b849d7">session</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-ambient-light">[AMBIENT-LIGHT]
   <dd>Anssi Kostiainen; Rijubrata Bhaumik. <a href="https://w3c.github.io/ambient-light/"><cite>Ambient Light Sensor</cite></a>. URL: <a href="https://w3c.github.io/ambient-light/">https://w3c.github.io/ambient-light/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-geometry-1">[GEOMETRY-1]
   <dd>Simon Pieters; Chris Harrelson. <a href="https://drafts.fxtf.org/geometry/"><cite>Geometry Interfaces Module Level 1</cite></a>. URL: <a href="https://drafts.fxtf.org/geometry/">https://drafts.fxtf.org/geometry/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-webgl-2">[WEBGL-2]
   <dd>Dean Jackson; Jeff Gilbert. <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/"><cite>WebGL 2.0 Specification</cite></a>. 12 August 2017. URL: <a href="https://www.khronos.org/registry/webgl/specs/latest/2.0/">https://www.khronos.org/registry/webgl/specs/latest/2.0/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
   <dt id="biblio-webxr">[WEBXR]
   <dd>Brandon Jones; Manish Goregaokar; Rik Cabanier. <a href="https://immersive-web.github.io/webxr/"><cite>WebXR Device API</cite></a>. URL: <a href="https://immersive-web.github.io/webxr/">https://immersive-web.github.io/webxr/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#xrlightprobe"><code><c- g>XRLightProbe</c-></code></a> : <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#eventtarget"><c- n>EventTarget</c-></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://immersive-web.github.io/webxr/#xrspace"><c- n>XRSpace</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="XRSpace" href="#dom-xrlightprobe-probespace"><c- g>probeSpace</c-></a>;
  <c- b>attribute</c-> <a data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/webappapis.html#eventhandler"><c- n>EventHandler</c-></a> <a class="idl-code" data-link-type="attribute" data-type="EventHandler" href="#dom-xrlightprobe-onreflectionchange"><c- g>onreflectionchange</c-></a>;
};

<c- b>enum</c-> <a href="#enumdef-xrreflectionformat"><code><c- g>XRReflectionFormat</c-></code></a> {
  <a href="#dom-xrreflectionformat-srgba8"><code><c- s>"srgba8"</c-></code></a>,
  <a href="#dom-xrreflectionformat-rgba16f"><code><c- s>"rgba16f"</c-></code></a>,
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#SecureContext"><c- g>SecureContext</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://webidl.spec.whatwg.org/#Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#xrlightestimate"><code><c- g>XRLightEstimate</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-Float32Array"><c- b>Float32Array</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Float32Array" href="#dom-xrlightestimate-sphericalharmonicscoefficients"><c- g>sphericalHarmonicsCoefficients</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightdirection"><c- g>primaryLightDirection</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://drafts.fxtf.org/geometry-1/#dompointreadonly"><c- n>DOMPointReadOnly</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="DOMPointReadOnly" href="#dom-xrlightestimate-primarylightintensity"><c- g>primaryLightIntensity</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-xrlightprobeinit"><code><c- g>XRLightProbeInit</c-></code></a> {
  <a data-link-type="idl-name" href="#enumdef-xrreflectionformat"><c- n>XRReflectionFormat</c-></a> <a data-default="&quot;srgba8&quot;" data-type="XRReflectionFormat " href="#dom-xrlightprobeinit-reflectionformat"><code><c- g>reflectionFormat</c-></code></a> = "srgba8";
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrsession-interface"><c- g>XRSession</c-></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-xrsession-requestlightprobe"><c- g>requestLightProbe</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-xrlightprobeinit"><c- n>XRLightProbeInit</c-></a> <a href="#dom-xrsession-requestlightprobe-options-options"><code><c- g>options</c-></code></a> = {});
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#enumdef-xrreflectionformat"><c- n>XRReflectionFormat</c-></a> <a data-readonly data-type="XRReflectionFormat" href="#dom-xrsession-preferredreflectionformat"><code><c- g>preferredReflectionFormat</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://www.w3.org/TR/webxr/#xrframe-interface"><c- g>XRFrame</c-></a> {
  <a data-link-type="idl-name" href="#xrlightestimate"><c- n>XRLightEstimate</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrframe-getlightestimate"><c- g>getLightEstimate</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a> <a href="#dom-xrframe-getlightestimate-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code></a>);
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://immersive-web.github.io/layers/#xrwebglbinding"><c- g>XRWebGLBinding</c-></a> {
  <a data-link-type="idl-name" href="https://www.khronos.org/registry/webgl/specs/latest/1.0/#WebGLTexture"><c- n>WebGLTexture</c-></a>? <a class="idl-code" data-link-type="method" href="#dom-xrwebglbinding-getreflectioncubemap"><c- g>getReflectionCubeMap</c-></a>(<a data-link-type="idl-name" href="#xrlightprobe"><c- n>XRLightProbe</c-></a> <a href="#dom-xrwebglbinding-getreflectioncubemap-lightprobe-lightprobe"><code><c- g>lightProbe</c-></code></a>);
};

</pre>
  <aside aria-labelledby="infopaneltitle-for-xrlightprobe" class="dfn-panel" data-for="xrlightprobe" id="infopanel-for-xrlightprobe">
   <span id="infopaneltitle-for-xrlightprobe" style="display:none">Info about the 'XRLightProbe' definition.</span><b><a href="#xrlightprobe">#xrlightprobe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe">2.1. XRLightProbe</a> <a href="#ref-for-xrlightprobe①">(2)</a>
    <li><a href="#ref-for-xrlightprobe②">2.3. XRLightEstimate</a> <a href="#ref-for-xrlightprobe③">(2)</a> <a href="#ref-for-xrlightprobe④">(3)</a> <a href="#ref-for-xrlightprobe⑤">(4)</a>
    <li><a href="#ref-for-xrlightprobe⑥">3.2. XRSession</a> <a href="#ref-for-xrlightprobe⑦">(2)</a> <a href="#ref-for-xrlightprobe⑧">(3)</a> <a href="#ref-for-xrlightprobe⑨">(4)</a> <a href="#ref-for-xrlightprobe①⓪">(5)</a>
    <li><a href="#ref-for-xrlightprobe①①">3.3. XRFrame</a> <a href="#ref-for-xrlightprobe①②">(2)</a>
    <li><a href="#ref-for-xrlightprobe①③">4.1. XRWebGLBinding</a> <a href="#ref-for-xrlightprobe①④">(2)</a>
    <li><a href="#ref-for-xrlightprobe①⑤">5.1. Event Types</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightprobe-probespace" class="dfn-panel" data-for="dom-xrlightprobe-probespace" id="infopanel-for-dom-xrlightprobe-probespace">
   <span id="infopaneltitle-for-dom-xrlightprobe-probespace" style="display:none">Info about the 'probeSpace' definition.</span><b><a href="#dom-xrlightprobe-probespace">#dom-xrlightprobe-probespace</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobe-probespace">2.1. XRLightProbe</a>
    <li><a href="#ref-for-dom-xrlightprobe-probespace①">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightprobe-probespace②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightprobe-onreflectionchange" class="dfn-panel" data-for="dom-xrlightprobe-onreflectionchange" id="infopanel-for-dom-xrlightprobe-onreflectionchange">
   <span id="infopaneltitle-for-dom-xrlightprobe-onreflectionchange" style="display:none">Info about the 'onreflectionchange' definition.</span><b><a href="#dom-xrlightprobe-onreflectionchange">#dom-xrlightprobe-onreflectionchange</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobe-onreflectionchange">2.1. XRLightProbe</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-enumdef-xrreflectionformat" class="dfn-panel" data-for="enumdef-xrreflectionformat" id="infopanel-for-enumdef-xrreflectionformat">
   <span id="infopaneltitle-for-enumdef-xrreflectionformat" style="display:none">Info about the 'XRReflectionFormat' definition.</span><b><a href="#enumdef-xrreflectionformat">#enumdef-xrreflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-xrreflectionformat">2.2. XRReflectionFormat</a>
    <li><a href="#ref-for-enumdef-xrreflectionformat①">3.2. XRSession</a> <a href="#ref-for-enumdef-xrreflectionformat②">(2)</a> <a href="#ref-for-enumdef-xrreflectionformat③">(3)</a> <a href="#ref-for-enumdef-xrreflectionformat④">(4)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrreflectionformat-srgba8" class="dfn-panel" data-for="dom-xrreflectionformat-srgba8" id="infopanel-for-dom-xrreflectionformat-srgba8">
   <span id="infopaneltitle-for-dom-xrreflectionformat-srgba8" style="display:none">Info about the '"srgba8"' definition.</span><b><a href="#dom-xrreflectionformat-srgba8">#dom-xrreflectionformat-srgba8</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrreflectionformat-srgba8">2.2. XRReflectionFormat</a> <a href="#ref-for-dom-xrreflectionformat-srgba8①">(2)</a>
    <li><a href="#ref-for-dom-xrreflectionformat-srgba8②">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrreflectionformat-rgba16f" class="dfn-panel" data-for="dom-xrreflectionformat-rgba16f" id="infopanel-for-dom-xrreflectionformat-rgba16f">
   <span id="infopaneltitle-for-dom-xrreflectionformat-rgba16f" style="display:none">Info about the '"rgba16f"' definition.</span><b><a href="#dom-xrreflectionformat-rgba16f">#dom-xrreflectionformat-rgba16f</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrreflectionformat-rgba16f">2.2. XRReflectionFormat</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-xrlightestimate" class="dfn-panel" data-for="xrlightestimate" id="infopanel-for-xrlightestimate">
   <span id="infopaneltitle-for-xrlightestimate" style="display:none">Info about the 'XRLightEstimate' definition.</span><b><a href="#xrlightestimate">#xrlightestimate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightestimate">2.3. XRLightEstimate</a> <a href="#ref-for-xrlightestimate①">(2)</a> <a href="#ref-for-xrlightestimate②">(3)</a> <a href="#ref-for-xrlightestimate③">(4)</a>
    <li><a href="#ref-for-xrlightestimate④">3.3. XRFrame</a> <a href="#ref-for-xrlightestimate⑤">(2)</a> <a href="#ref-for-xrlightestimate⑥">(3)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightestimate-sphericalharmonicscoefficients" class="dfn-panel" data-for="dom-xrlightestimate-sphericalharmonicscoefficients" id="infopanel-for-dom-xrlightestimate-sphericalharmonicscoefficients">
   <span id="infopaneltitle-for-dom-xrlightestimate-sphericalharmonicscoefficients" style="display:none">Info about the 'sphericalHarmonicsCoefficients' definition.</span><b><a href="#dom-xrlightestimate-sphericalharmonicscoefficients">#dom-xrlightestimate-sphericalharmonicscoefficients</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients①">(2)</a> <a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients②">(3)</a>
    <li><a href="#ref-for-dom-xrlightestimate-sphericalharmonicscoefficients③">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightestimate-primarylightdirection" class="dfn-panel" data-for="dom-xrlightestimate-primarylightdirection" id="infopanel-for-dom-xrlightestimate-primarylightdirection">
   <span id="infopaneltitle-for-dom-xrlightestimate-primarylightdirection" style="display:none">Info about the 'primaryLightDirection' definition.</span><b><a href="#dom-xrlightestimate-primarylightdirection">#dom-xrlightestimate-primarylightdirection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightdirection">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-primarylightdirection①">(2)</a>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightdirection②">3.3. XRFrame</a> <a href="#ref-for-dom-xrlightestimate-primarylightdirection③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightestimate-primarylightintensity" class="dfn-panel" data-for="dom-xrlightestimate-primarylightintensity" id="infopanel-for-dom-xrlightestimate-primarylightintensity">
   <span id="infopaneltitle-for-dom-xrlightestimate-primarylightintensity" style="display:none">Info about the 'primaryLightIntensity' definition.</span><b><a href="#dom-xrlightestimate-primarylightintensity">#dom-xrlightestimate-primarylightintensity</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightintensity">2.3. XRLightEstimate</a> <a href="#ref-for-dom-xrlightestimate-primarylightintensity①">(2)</a>
    <li><a href="#ref-for-dom-xrlightestimate-primarylightintensity②">3.3. XRFrame</a> <a href="#ref-for-dom-xrlightestimate-primarylightintensity③">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-feature-descriptor-light-estimation" class="dfn-panel" data-for="feature-descriptor-light-estimation" id="infopanel-for-feature-descriptor-light-estimation">
   <span id="infopaneltitle-for-feature-descriptor-light-estimation" style="display:none">Info about the 'light-estimation' definition.</span><b><a href="#feature-descriptor-light-estimation">#feature-descriptor-light-estimation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-feature-descriptor-light-estimation">3.1. Session Initialization</a>
    <li><a href="#ref-for-feature-descriptor-light-estimation①">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-xrlightprobe-session" class="dfn-panel" data-for="xrlightprobe-session" id="infopanel-for-xrlightprobe-session">
   <span id="infopaneltitle-for-xrlightprobe-session" style="display:none">Info about the 'session' definition.</span><b><a href="#xrlightprobe-session">#xrlightprobe-session</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe-session">3.2. XRSession</a>
    <li><a href="#ref-for-xrlightprobe-session①">3.3. XRFrame</a>
    <li><a href="#ref-for-xrlightprobe-session②">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-xrlightprobe-reflection-format" class="dfn-panel" data-for="xrlightprobe-reflection-format" id="infopanel-for-xrlightprobe-reflection-format">
   <span id="infopaneltitle-for-xrlightprobe-reflection-format" style="display:none">Info about the 'reflection format' definition.</span><b><a href="#xrlightprobe-reflection-format">#xrlightprobe-reflection-format</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-xrlightprobe-reflection-format">3.2. XRSession</a>
    <li><a href="#ref-for-xrlightprobe-reflection-format①">4.1. XRWebGLBinding</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-xrlightprobeinit" class="dfn-panel" data-for="dictdef-xrlightprobeinit" id="infopanel-for-dictdef-xrlightprobeinit">
   <span id="infopaneltitle-for-dictdef-xrlightprobeinit" style="display:none">Info about the 'XRLightProbeInit' definition.</span><b><a href="#dictdef-xrlightprobeinit">#dictdef-xrlightprobeinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-xrlightprobeinit">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrlightprobeinit-reflectionformat" class="dfn-panel" data-for="dom-xrlightprobeinit-reflectionformat" id="infopanel-for-dom-xrlightprobeinit-reflectionformat">
   <span id="infopaneltitle-for-dom-xrlightprobeinit-reflectionformat" style="display:none">Info about the 'reflectionFormat' definition.</span><b><a href="#dom-xrlightprobeinit-reflectionformat">#dom-xrlightprobeinit-reflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrlightprobeinit-reflectionformat">3.2. XRSession</a> <a href="#ref-for-dom-xrlightprobeinit-reflectionformat①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrsession-preferredreflectionformat" class="dfn-panel" data-for="dom-xrsession-preferredreflectionformat" id="infopanel-for-dom-xrsession-preferredreflectionformat">
   <span id="infopaneltitle-for-dom-xrsession-preferredreflectionformat" style="display:none">Info about the 'preferredReflectionFormat' definition.</span><b><a href="#dom-xrsession-preferredreflectionformat">#dom-xrsession-preferredreflectionformat</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrsession-preferredreflectionformat">2.2. XRReflectionFormat</a>
    <li><a href="#ref-for-dom-xrsession-preferredreflectionformat①">3.2. XRSession</a> <a href="#ref-for-dom-xrsession-preferredreflectionformat②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrsession-requestlightprobe" class="dfn-panel" data-for="dom-xrsession-requestlightprobe" id="infopanel-for-dom-xrsession-requestlightprobe">
   <span id="infopaneltitle-for-dom-xrsession-requestlightprobe" style="display:none">Info about the 'requestLightProbe(options)' definition.</span><b><a href="#dom-xrsession-requestlightprobe">#dom-xrsession-requestlightprobe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrsession-requestlightprobe">3.2. XRSession</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrframe-getlightestimate" class="dfn-panel" data-for="dom-xrframe-getlightestimate" id="infopanel-for-dom-xrframe-getlightestimate">
   <span id="infopaneltitle-for-dom-xrframe-getlightestimate" style="display:none">Info about the 'getLightEstimate(lightProbe)' definition.</span><b><a href="#dom-xrframe-getlightestimate">#dom-xrframe-getlightestimate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrframe-getlightestimate">2.3. XRLightEstimate</a>
    <li><a href="#ref-for-dom-xrframe-getlightestimate①">3.3. XRFrame</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-xrwebglbinding-getreflectioncubemap" class="dfn-panel" data-for="dom-xrwebglbinding-getreflectioncubemap" id="infopanel-for-dom-xrwebglbinding-getreflectioncubemap">
   <span id="infopaneltitle-for-dom-xrwebglbinding-getreflectioncubemap" style="display:none">Info about the 'getReflectionCubeMap(lightProbe)' definition.</span><b><a href="#dom-xrwebglbinding-getreflectioncubemap">#dom-xrwebglbinding-getreflectioncubemap</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-xrwebglbinding-getreflectioncubemap">4.1. XRWebGLBinding</a>
    <li><a href="#ref-for-dom-xrwebglbinding-getreflectioncubemap①">5.1. Event Types</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-eventdef-xrlightprobe-reflectionchange" class="dfn-panel" data-for="eventdef-xrlightprobe-reflectionchange" id="infopanel-for-eventdef-xrlightprobe-reflectionchange">
   <span id="infopaneltitle-for-eventdef-xrlightprobe-reflectionchange" style="display:none">Info about the 'reflectionchange' definition.</span><b><a href="#eventdef-xrlightprobe-reflectionchange">#eventdef-xrlightprobe-reflectionchange</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-eventdef-xrlightprobe-reflectionchange">2.1. XRLightProbe</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */
"use strict";
{
    function queryAll(sel) {
        return [].slice.call(document.querySelectorAll(sel));
    }

    // Add popup behavior to all dfns to show the corresponding dfn-panel.
    var dfns = document.querySelectorAll('.dfn-paneled');
    for (let dfn of dfns) { insertDfnPopupAction(dfn); }

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });

    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn) {
        // Find dfn panel
        const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
        if (dfnPanel) {
            const panelWrapper = document.createElement('span');
            panelWrapper.appendChild(dfnPanel);
            panelWrapper.style.position = "relative";
            panelWrapper.style.height = "0px";
            dfn.insertAdjacentElement("afterend", panelWrapper);
            dfn.setAttribute('role', 'button');
            dfn.setAttribute('aria-expanded', 'false')
            dfn.tabIndex = 0;
            dfn.classList.add('has-dfn-panel');
            dfn.addEventListener('click', (event) => {
                showDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
            });
            dfn.addEventListener('keypress', (event) => {
                const kc = event.keyCode;
                // 32->Space, 13->Enter
                if(kc == 32 || kc == 13) {
                    toggleDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            });

            dfnPanel.addEventListener('click', (event) => {
                pinDfnPanel(dfnPanel);
                event.stopPropagation();
            });

            dfnPanel.addEventListener('keydown', (event) => {
                if(event.keyCode == 27) { // Escape key
                    hideDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            })

        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
        }
    }
}
</script>
<script>/* script-var-click-highlighting */

    "use strict";
    {
        document.addEventListener("click", e=>{
            if(e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
</script>