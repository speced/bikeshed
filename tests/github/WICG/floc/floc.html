<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Federated Learning of Cohorts</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <link href="https://wicg.github.io/floc/" rel="canonical">
<style>/* style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}
</style>
<style>/* style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}
</style>
<style>/* style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    min-width: min-content;
    max-width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* style-syntax-highlighting */

            pre.idl.highlight {
                background: var(--borderedblock-bg, var(--def-bg));
            }
            
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-darkmode */

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}

@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}

@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Federated Learning of Cohorts</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/floc/">https://wicg.github.io/floc/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:yaoxia@chromium.org">Yao Xiao</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jkarlin@chromium.org">Josh Karlin</a> (<span class="p-org org">Google</span>)
     <dt>Participate:
     <dd><a href="https://github.com/WICG/floc">GitHub WICG/floc</a> (<a href="https://github.com/WICG/floc/issues/new">new issue</a>, <a href="https://github.com/WICG/floc/issues?state=open">open issues</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 the Contributors to the Federated Learning of Cohorts Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification describes a method that could enable ad-targeting based on the people’s general browsing interest without exposing the exact browsing history.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#interest-cohort-section"><span class="secno">2</span> <span class="content">Interest cohort</span></a>
    <li><a href="#the-api"><span class="secno">3</span> <span class="content">The API</span></a>
    <li><a href="#interpretation"><span class="secno">4</span> <span class="content">Interpretation</span></a>
    <li>
     <a href="#cohort-assignment-algorithm"><span class="secno">5</span> <span class="content">Cohort assignment algorithm</span></a>
     <ol class="toc">
      <li><a href="#input-and-output"><span class="secno">5.1</span> <span class="content">Input and output</span></a>
      <li><a href="#caching-the-result"><span class="secno">5.2</span> <span class="content">Caching the result</span></a>
      <li>
       <a href="#privacy-guarantees"><span class="secno">5.3</span> <span class="content">Privacy guarantees</span></a>
       <ol class="toc">
        <li><a href="#anonymity"><span class="secno">5.3.1</span> <span class="content">Anonymity</span></a>
        <li><a href="#no-browsing-history-recovering-from-cohorts"><span class="secno">5.3.2</span> <span class="content">No browsing history recovering from cohorts</span></a>
        <li><a href="#no-sensitive-cohorts"><span class="secno">5.3.3</span> <span class="content">No sensitive cohorts</span></a>
       </ol>
     </ol>
    <li><a href="#permissions-policy-integration"><span class="secno">6</span> <span class="content">Permissions policy integration</span></a>
    <li>
     <a href="#privacy-considerations"><span class="secno">7</span> <span class="content">Privacy considerations</span></a>
     <ol class="toc">
      <li>
       <a href="#permission"><span class="secno">7.1</span> <span class="content">Permission</span></a>
       <ol class="toc">
        <li><a href="#compute-eligibility"><span class="secno">7.1.1</span> <span class="content">Eligibility for a page to be included in the interest cohort computation</span></a>
        <li><a href="#access-eligibility"><span class="secno">7.1.2</span> <span class="content">Permission to access the interest cohort</span></a>
        <li><a href="#private-browsing-mode"><span class="secno">7.1.3</span> <span class="content">Private browsing / Incognito mode</span></a>
        <li><a href="#adoption-phase"><span class="secno">7.1.4</span> <span class="content">Adoption phase</span></a>
       </ol>
      <li><a href="#sensitive-information"><span class="secno">7.2</span> <span class="content">Sensitive information</span></a>
      <li><a href="#tracking-people-via-their-interest-cohort"><span class="secno">7.3</span> <span class="content">Tracking people via their interest cohort</span></a>
      <li><a href="#recovering-the-browsing-history-from-cohorts"><span class="secno">7.4</span> <span class="content">Recovering the browsing history from cohorts</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <section>
    <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
    <p>In today’s web, people’s interests are typically inferred based on observing what sites or pages they visit, which relies on tracking techniques like third-party cookies or less-transparent mechanisms like device fingerprinting. It would be better for privacy if interest-based advertising could be accomplished without needing to collect a particular individual’s browsing history.</p>
    <p>This specification provides an API to enable ad-targeting based on the people’s general browsing interest, without exposing the exact browsing history.</p>
    <div class="example" id="example-d5ba1303">
     <a class="self-link" href="#example-d5ba1303"></a> Creating an ad based on the interest cohort: 
<pre class="lang-js highlight"><c- a>const</c-> cohort <c- o>=</c-> <c- k>await</c-> document<c- p>.</c->interestCohort<c- p>();</c->
<c- a>const</c-> url <c- o>=</c-> <c- ow>new</c-> URL<c- p>(</c-><c- u>"https://ads.example/getCreative"</c-><c- p>);</c->
url<c- p>.</c->searchParams<c- p>.</c->append<c- p>(</c-><c- u>"cohort_id"</c-><c- p>,</c-> cohort<c- p>.</c->id<c- p>);</c->
url<c- p>.</c->searchParams<c- p>.</c->append<c- p>(</c-><c- u>"cohort_version"</c-><c- p>,</c-> cohort<c- p>.</c->version<c- p>);</c->
<c- a>const</c-> creative <c- o>=</c-> <c- k>await</c-> fetch<c- p>(</c->url<c- p>);</c->
</pre>
    </div>
   </section>
   <section>
    <h2 class="heading settled" data-level="2" id="interest-cohort-section"><span class="secno">2. </span><span class="content">Interest cohort</span><a class="self-link" href="#interest-cohort-section"></a></h2>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort">interest cohort</dfn> is a user’s assigned interest group under a particular <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a>. An interest cohort comprises an <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id">interest cohort id</a> and an <a data-link-type="dfn" href="#interest-cohort-version" id="ref-for-interest-cohort-version">interest cohort version</a>.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort-id">interest cohort id</dfn> represents the interest group that the user is assigned to by the <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a>. The total number of groups should not exceed 2^32, and each group can mapped to a 32 bit integer. The interest cohort id can be invalid, which means no group is assigned.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="string-representation-of-the-interest-cohort-id">string representation of the interest cohort id</dfn> is the string representation of the mapped integer of the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①">interest cohort id</a> in decimal (e.g. “17319”). If the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id②">interest cohort id</a> is invalid, the string representation will be an empty string.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort-version">interest cohort version</dfn> identifies the <a href="#cohort-assignment-algorithm">algorithm</a> used to compute the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id③">interest cohort id</a>.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="string-representation-of-the-interest-cohort-version">string representation of the interest cohort version</dfn> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#implementation-defined" id="ref-for-implementation-defined">implementation-defined</a>. It’s recommended that the browser vendor name is part of the version (e.g. “chrome.2.1”, “v21/mozilla”), so that when exposed to the Web, there won’t be naming collisions across browser vendors. As an exception, if two browsers choose to deliberately use the same cohort assignment algorithm, they should pick some other way to give it an unambiguous name and avoid collisions.</p>
    <p>The <code class="idl"><a data-link-type="idl" href="#dictdef-interestcohort" id="ref-for-dictdef-interestcohort">InterestCohort</a></code> dictionary is used to contain the <a data-link-type="dfn" href="#string-representation-of-the-interest-cohort-id" id="ref-for-string-representation-of-the-interest-cohort-id">string representation of the interest cohort id</a> and the <a data-link-type="dfn" href="#string-representation-of-the-interest-cohort-version" id="ref-for-string-representation-of-the-interest-cohort-version">string representation of the interest cohort version</a>.</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-interestcohort"><code><c- g>InterestCohort</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="InterestCohort" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-interestcohort-id"><code><c- g>id</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="InterestCohort" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-interestcohort-version"><code><c- g>version</c-></code></dfn>;
};
</pre>
   </section>
   <section>
    <h2 class="heading settled" data-level="3" id="the-api"><span class="secno">3. </span><span class="content">The API</span><a class="self-link" href="#the-api"></a></h2>
    <p>The interest cohort API lives under the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> interface since the access permission is tied to the document scope, and the API is only available if the document is in <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context" id="ref-for-secure-context">secure context</a>.</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①"><c- g>Document</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-interestcohort" id="ref-for-dictdef-interestcohort①"><c- n>InterestCohort</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-document-interestcohort" id="ref-for-dom-document-interestcohort"><c- g>interestCohort</c-></a>();
};
</pre>
    <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="Document" data-dfn-type="method" data-export id="dom-document-interestcohort"><code>interestCohort()</code></dfn> method steps are:</p>
    <ol>
     <li data-md>
      <p>Let <var>p</var> be <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#a-new-promise" id="ref-for-a-new-promise">a new promise</a>.</p>
     <li data-md>
      <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">in parallel</a>:</p>
      <ol>
       <li data-md>
        <p>If any of the following is true:</p>
        <ul>
         <li data-md>
          <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this">this</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use" id="ref-for-allowed-to-use">allowed to use</a> the "<code><a href="#interest-cohort-policy-controlled-feature" id="ref-for-interest-cohort-policy-controlled-feature">interest-cohort</a></code>" feature.</p>
         <li data-md>
          <p>The document is not allowed to access the interest cohort per user preference settings.</p>
         <li data-md>
          <p>The user agent believes that too many high-entropy bits of information have already been consumed by the given document, and exposing an interest cohort would violate a privacy budget.</p>
         <li data-md>
          <p>The <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a> is unavailable.</p>
        </ul>
        <p>then:</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task">Queue a global task</a> on the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort-task-source">interest cohort task source</dfn> given <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this①">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a> to <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#reject" id="ref-for-reject">reject</a> <var>p</var> with a "<code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#notallowederror" id="ref-for-notallowederror">NotAllowedError</a></code>" <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
         <li data-md>
          <p>Abort these steps.</p>
        </ol>
       <li data-md>
        <p>Let <var>id</var> be <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id④">interest cohort id</a> from running the <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a>.</p>
       <li data-md>
        <p>Let <var>version</var> be the <a data-link-type="dfn" href="#interest-cohort-version" id="ref-for-interest-cohort-version①">interest cohort version</a> corresponding to the <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task" id="ref-for-queue-a-global-task①">Queue a global task</a> on the <a data-link-type="dfn" href="#interest-cohort-task-source" id="ref-for-interest-cohort-task-source">interest cohort task source</a> given <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#this" id="ref-for-this②">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a> to perform the following steps:</p>
        <ol>
         <li data-md>
          <p>Let <var>d</var> be the <code class="idl"><a data-link-type="idl" href="#dictdef-interestcohort" id="ref-for-dictdef-interestcohort②">InterestCohort</a></code> dictionary, with <code class="idl"><a data-link-type="idl" href="#dom-interestcohort-id" id="ref-for-dom-interestcohort-id">id</a></code> being the <a href="#string-representation-of-the-interest-cohort-id" id="ref-for-string-representation-of-the-interest-cohort-id①">string representation</a> of <var>id</var>, and <code class="idl"><a data-link-type="idl" href="#dom-interestcohort-version" id="ref-for-dom-interestcohort-version">version</a></code> being <a href="#string-representation-of-the-interest-cohort-version" id="ref-for-string-representation-of-the-interest-cohort-version①">string representation</a> of <var>version</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#resolve" id="ref-for-resolve">Resolve</a> <var>p</var> with <var>d</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Return <var>p</var>.</p>
    </ol>
   </section>
   <section>
    <h2 class="heading settled" data-level="4" id="interpretation"><span class="secno">4. </span><span class="content">Interpretation</span><a class="self-link" href="#interpretation"></a></h2>
     Organizations that wish to interpret cohorts can observe the habits of each <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort">interest cohort</a> and ad targeting can then be partly based on what group the person falls into. The browser vendors could publicly share more information about the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id⑤">interest cohort id</a> (e.g. the range of numbers, whether they have semantics, etc.) or the <a data-link-type="dfn" href="#interest-cohort-version" id="ref-for-interest-cohort-version②">interest cohort version</a> (e.g. the algorithm detail, the compatibility between versions, etc.) to help with their modeling decisions. 
   </section>
   <section>
    <h2 class="heading settled" data-level="5" id="cohort-assignment-algorithm"><span class="secno">5. </span><span class="content">Cohort assignment algorithm</span><a class="self-link" href="#cohort-assignment-algorithm"></a></h2>
     The browser could use machine learning algorithms to develop the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id⑥">interest cohort id</a> to expose to a given document. 
    <h3 class="heading settled" data-level="5.1" id="input-and-output"><span class="secno">5.1. </span><span class="content">Input and output</span><a class="self-link" href="#input-and-output"></a></h3>
     The input features to the algorithm should be based on information from the browsing history, which may include the URLs, the page contents, or other factors. 
    <p>The input features should be kept local on the browser and should not be uploaded elsewhere.</p>
    <p>The output of the algorithm is the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id⑦">interest cohort id</a>.</p>
    <h3 class="heading settled" data-level="5.2" id="caching-the-result"><span class="secno">5.2. </span><span class="content">Caching the result</span><a class="self-link" href="#caching-the-result"></a></h3>
     For performance concern and/or to mitigate the risk of <a href="#recovering-the-browsing-history-from-cohorts">recovering the browsing history from cohorts</a>, the algorithm could return a cached <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id⑧">interest cohort id</a> that was computed recently, instead of computing from scratch. 
    <h3 class="heading settled" data-level="5.3" id="privacy-guarantees"><span class="secno">5.3. </span><span class="content">Privacy guarantees</span><a class="self-link" href="#privacy-guarantees"></a></h3>
     The algorithm should have the following privacy properties. Sometimes generating an invalid <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id⑨">interest cohort id</a> may be helpful to meet these guarantees. 
    <h4 class="heading settled" data-level="5.3.1" id="anonymity"><span class="secno">5.3.1. </span><span class="content">Anonymity</span><a class="self-link" href="#anonymity"></a></h4>
     The browser should ensure that the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①⓪">interest cohort ids</a> are well distributed, so that each represents thousands of people, where a person is considered to be associated with an <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①①">interest cohort id</a> if that <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①②">interest cohort id</a> was recently computed for them. The browser may further leverage other anonymization methods, such as differential privacy. 
    <h4 class="heading settled" data-level="5.3.2" id="no-browsing-history-recovering-from-cohorts"><span class="secno">5.3.2. </span><span class="content">No browsing history recovering from cohorts</span><a class="self-link" href="#no-browsing-history-recovering-from-cohorts"></a></h4>
     The browser should ensure that the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①③">interest cohort ids</a> exposed to any given site does not reveal the browsing history. 
    <h4 class="heading settled" data-level="5.3.3" id="no-sensitive-cohorts"><span class="secno">5.3.3. </span><span class="content">No sensitive cohorts</span><a class="self-link" href="#no-sensitive-cohorts"></a></h4>
     The browser should ensure that the <a data-link-type="dfn" href="#interest-cohort-id" id="ref-for-interest-cohort-id①④">interest cohort ids</a> are not correlated with <a href="#sensitive-information">sensitive information</a>. 
   </section>
   <section>
    <h2 class="heading settled" data-level="6" id="permissions-policy-integration"><span class="secno">6. </span><span class="content">Permissions policy integration</span><a class="self-link" href="#permissions-policy-integration"></a></h2>
    <p>This specification defines a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature">policy-controlled feature</a> identified by the string
"<code><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="interest-cohort-policy-controlled-feature">interest-cohort</dfn></code>". Its <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist" id="ref-for-default-allowlist">default allowlist</a> is <code>*</code>. </p>
   </section>
   <section>
    <h2 class="heading settled" data-level="7" id="privacy-considerations"><span class="secno">7. </span><span class="content">Privacy considerations</span><a class="self-link" href="#privacy-considerations"></a></h2>
    <h3 class="heading settled" data-level="7.1" id="permission"><span class="secno">7.1. </span><span class="content">Permission</span><a class="self-link" href="#permission"></a></h3>
    <h4 class="heading settled" data-level="7.1.1" id="compute-eligibility"><span class="secno">7.1.1. </span><span class="content">Eligibility for a page to be included in the interest cohort computation</span><a class="self-link" href="#compute-eligibility"></a></h4>
     By default, a page is eligible for the interest cohort computation if the <code class="idl"><a data-link-type="idl" href="#dom-document-interestcohort" id="ref-for-dom-document-interestcohort①">interestCohort()</a></code> API is used in the page. 
    <p>The page can opt itself out of the interest cohort computation through the "<code><a href="#interest-cohort-policy-controlled-feature" id="ref-for-interest-cohort-policy-controlled-feature①">interest-cohort</a></code>" <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature①">policy-controlled feature</a>. <a data-link-type="biblio" href="#biblio-permissions-policy" title="Permissions Policy">[PERMISSIONS-POLICY]</a></p>
    <p>The user agent should offer a dedicated permission setting for the user to disallow sites from being included for interest cohort calculations.</p>
    <h4 class="heading settled" data-level="7.1.2" id="access-eligibility"><span class="secno">7.1.2. </span><span class="content">Permission to access the interest cohort</span><a class="self-link" href="#access-eligibility"></a></h4>
     The page can restrict itself or subframes from accessing the interest cohort through the "<code><a href="#interest-cohort-policy-controlled-feature" id="ref-for-interest-cohort-policy-controlled-feature②">interest-cohort</a></code>" <a data-link-type="dfn" href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature" id="ref-for-policy-controlled-feature②">policy-controlled feature</a>. <a data-link-type="biblio" href="#biblio-permissions-policy" title="Permissions Policy">[PERMISSIONS-POLICY]</a> 
    <p><a href="#the-api">The API</a> will return a rejected promise if the user has specifically disallowed the site from accessing the <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①">interest cohort</a>.</p>
    <h4 class="heading settled" data-level="7.1.3" id="private-browsing-mode"><span class="secno">7.1.3. </span><span class="content">Private browsing / Incognito mode</span><a class="self-link" href="#private-browsing-mode"></a></h4>
     The interest cohort computation <a href="#cohort-assignment-algorithm">algorithm</a> and the <code class="idl"><a data-link-type="idl" href="#dom-document-interestcohort" id="ref-for-dom-document-interestcohort②">interestCohort()</a></code> API methods are applicable to the private browsing mode as well. That is, if the private browsing mode doesn’t save history at all, the "information from the browsing history" is expected to just be an empty set. 
    <h4 class="heading settled" data-level="7.1.4" id="adoption-phase"><span class="secno">7.1.4. </span><span class="content">Adoption phase</span><a class="self-link" href="#adoption-phase"></a></h4>
     To make the adoption easier, the user agent may relax the opt-in requirement while third-party cookies still exist. For example, pages with ads resources are an approximation of the pages that are going to opt-in to interest cohort computation in the long run. Thus, at the adoption phase, the page can be eligible to be included in the interest cohort computation if there are ads resources in the page, OR if <a href="#the-api">the API</a> is used. 
    <p>Additionally, during the adoption phase, the browser can use the existing cookie settings to approximate the interest cohort permission setting. For example, a page is not allowed to contribute to the interest cohort calculation if cookies are disallowed for that site; when cookies are cleared, previous page visits should not be used for interest cohort computation; accessing to the interest cohort within a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code> should be denied if cookie access is not allowed in the document, or when third-party cookies are disallowed in general.</p>
    <h3 class="heading settled" data-level="7.2" id="sensitive-information"><span class="secno">7.2. </span><span class="content">Sensitive information</span><a class="self-link" href="#sensitive-information"></a></h3>
     An <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort②">interest cohort</a> might reveal sensitive information. As a first mitigation, the browser should remove sensitive categories from its data collection. But this does not mean sensitive information can’t be leaked. Some people are sensitive to categories that others are not, and there is no globally accepted notion of sensitive categories. 
    <p>Cohorts could be evaluated for fairness by measuring and limiting their deviation from population-level demographics with respect to the prevalence of sensitive categories, to prevent their use as proxies for a sensitive category. However, this evaluation would require knowing how many individual people in each cohort were in the sensitive categories, information which could be difficult or intrusive to obtain. As an approximation, the browser could use a mechanism for recognizing which web pages are in sensitive categories. Evaluations could also consider that what is deemed sensitive may depend on the country or region of the world.</p>
    <p>It should be clear that FLoC will never be able to prevent all misuse. There will be categories that are sensitive in contexts that weren’t predicted. Beyond FLoC’s technical means of preventing abuse, sites that use cohorts will need to ensure that people are treated fairly, just as they must with algorithmic decisions made based on any other data today.</p>
    <h3 class="heading settled" data-level="7.3" id="tracking-people-via-their-interest-cohort"><span class="secno">7.3. </span><span class="content">Tracking people via their interest cohort</span><a class="self-link" href="#tracking-people-via-their-interest-cohort"></a></h3>
     An <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort③">interest cohort</a> could be used as a user identifier. It may not have enough bits of information to individually identify someone, but in combination with other information (such as an IP address), it might. One design mitigation is to ensure cohort sizes are large enough that they are not useful for tracking. In addition, if the user agent believes that too many high-entropy bits of information have already been consumed by a given <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code>, then the <code class="idl"><a data-link-type="idl" href="#dom-document-interestcohort" id="ref-for-dom-document-interestcohort③">interestCohort()</a></code> algorithm will return a rejected promise, which can help mitigate such tracking. 
    <p>If for any short time period the <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort④">interest cohorts</a> exposed to different sites tends to be the same, then the time series of <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort⑤">interest cohorts</a> can also be used as a user identifier. Sites could associate users' first-party identity with a series of <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort⑥">interest cohorts</a> observed over time, and could report these series to a single tracking service. The tracking service could then associate each series with the sites to know the browsing history of an individual.</p>
    <h3 class="heading settled" data-level="7.4" id="recovering-the-browsing-history-from-cohorts"><span class="secno">7.4. </span><span class="content">Recovering the browsing history from cohorts</span><a class="self-link" href="#recovering-the-browsing-history-from-cohorts"></a></h3>
     Updating the <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort⑦">interest cohort</a> too often may increase the likelihood of identifying portions of a user’s browsing history, for instance by using <a href="https://en.wikipedia.org/wiki/Compressed_sensing">compressed sensing</a>. 
    <p>One possible mitigation is: when the <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort⑧">interest cohort</a> is computed and exposed to an origin, pin that <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort⑨">interest cohort</a> to that origin for a period of time. When an <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①⓪">interest cohort</a> is pinned to an origin, the execution of the <a href="#cohort-assignment-algorithm">cohort assignment algorithm</a> on that origin will return the cached <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①①">interest cohort</a> instead of computing a new one.</p>
    <p>If the browser decide to cache <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①②">interest cohorts</a>, it should ensure proper handling of data deletion:</p>
    <ul>
     <li data-md>
      <p>When site data are deleted, and some cached <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①③">interest cohorts</a> are derived from any affected site, those <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①④">interest cohorts</a> should be cleared.</p>
     <li data-md>
      <p>When the browsing history is deleted and some cached <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①⑤">interest cohorts</a> are derived from any deleted browsing history, those <a data-link-type="dfn" href="#interest-cohort" id="ref-for-interest-cohort①⑥">interest cohorts</a> should be cleared.</p>
    </ul>
   </section>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-interestcohort-id">id</a><span>, in § 2</span>
   <li><a href="#interest-cohort">interest cohort</a><span>, in § 2</span>
   <li><a href="#interest-cohort-policy-controlled-feature">interest-cohort</a><span>, in § 6</span>
   <li><a href="#dictdef-interestcohort">InterestCohort</a><span>, in § 2</span>
   <li><a href="#dom-document-interestcohort">interestCohort()</a><span>, in § 3</span>
   <li><a href="#interest-cohort-id">interest cohort id</a><span>, in § 2</span>
   <li><a href="#interest-cohort-task-source">interest cohort task source</a><span>, in § 3</span>
   <li><a href="#interest-cohort-version">interest cohort version</a><span>, in § 2</span>
   <li><a href="#string-representation-of-the-interest-cohort-id">string representation of the interest cohort id</a><span>, in § 2</span>
   <li><a href="#string-representation-of-the-interest-cohort-version">string representation of the interest cohort version</a><span>, in § 2</span>
   <li><a href="#dom-interestcohort-version">version</a><span>, in § 2</span>
  </ul>
  <aside aria-labelledby="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" class="dfn-panel" data-for="07886e33695d0e7b473ef18f656ad7ac" id="infopanel-for-07886e33695d0e7b473ef18f656ad7ac">
   <span id="infopaneltitle-for-07886e33695d0e7b473ef18f656ad7ac" style="display:none">Info about the 'Document' external reference.</span><a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">3. The API</a> <a href="#ref-for-document①">(2)</a>
    <li><a href="#ref-for-document②">7.1.4. Adoption phase</a>
    <li><a href="#ref-for-document③">7.3. Tracking people via their interest cohort</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3dc9eee4a6a1d169f561b6d87bd08573" class="dfn-panel" data-for="3dc9eee4a6a1d169f561b6d87bd08573" id="infopanel-for-3dc9eee4a6a1d169f561b6d87bd08573">
   <span id="infopaneltitle-for-3dc9eee4a6a1d169f561b6d87bd08573" style="display:none">Info about the 'allowed to use' external reference.</span><a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#allowed-to-use</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-allowed-to-use">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-3a2763fcaa6bc82693554cf36780c0dd" class="dfn-panel" data-for="3a2763fcaa6bc82693554cf36780c0dd" id="infopanel-for-3a2763fcaa6bc82693554cf36780c0dd">
   <span id="infopaneltitle-for-3a2763fcaa6bc82693554cf36780c0dd" style="display:none">Info about the 'in parallel' external reference.</span><a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-a8756513b792b8f203588906035a13bb" class="dfn-panel" data-for="a8756513b792b8f203588906035a13bb" id="infopanel-for-a8756513b792b8f203588906035a13bb">
   <span id="infopaneltitle-for-a8756513b792b8f203588906035a13bb" style="display:none">Info about the 'queue a global task' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-global-task</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-global-task">3. The API</a> <a href="#ref-for-queue-a-global-task①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-2233058c8f0998915af8393ee2abbc1d" class="dfn-panel" data-for="2233058c8f0998915af8393ee2abbc1d" id="infopanel-for-2233058c8f0998915af8393ee2abbc1d">
   <span id="infopaneltitle-for-2233058c8f0998915af8393ee2abbc1d" style="display:none">Info about the 'relevant global object' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">3. The API</a> <a href="#ref-for-concept-relevant-global①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-613400696de3e8f8a5001430db03abe8" class="dfn-panel" data-for="613400696de3e8f8a5001430db03abe8" id="infopanel-for-613400696de3e8f8a5001430db03abe8">
   <span id="infopaneltitle-for-613400696de3e8f8a5001430db03abe8" style="display:none">Info about the 'secure context' external reference.</span><a href="https://html.spec.whatwg.org/multipage/webappapis.html#secure-context">https://html.spec.whatwg.org/multipage/webappapis.html#secure-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-secure-context">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-fd74d8159933c4a74d0b23390bed43e3" class="dfn-panel" data-for="fd74d8159933c4a74d0b23390bed43e3" id="infopanel-for-fd74d8159933c4a74d0b23390bed43e3">
   <span id="infopaneltitle-for-fd74d8159933c4a74d0b23390bed43e3" style="display:none">Info about the 'implementation-defined' external reference.</span><a href="https://infra.spec.whatwg.org/#implementation-defined">https://infra.spec.whatwg.org/#implementation-defined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implementation-defined">2. Interest cohort</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-18d0b1a84dc518786856e3236743c462" class="dfn-panel" data-for="18d0b1a84dc518786856e3236743c462" id="infopanel-for-18d0b1a84dc518786856e3236743c462">
   <span id="infopaneltitle-for-18d0b1a84dc518786856e3236743c462" style="display:none">Info about the 'default allowlist' external reference.</span><a href="https://w3c.github.io/webappsec-permissions-policy/#default-allowlist">https://w3c.github.io/webappsec-permissions-policy/#default-allowlist</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-allowlist">6. Permissions policy integration</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-cbc4165961071efad91900c4c7b2fe8b" class="dfn-panel" data-for="cbc4165961071efad91900c4c7b2fe8b" id="infopanel-for-cbc4165961071efad91900c4c7b2fe8b">
   <span id="infopaneltitle-for-cbc4165961071efad91900c4c7b2fe8b" style="display:none">Info about the 'policy-controlled feature' external reference.</span><a href="https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature">https://w3c.github.io/webappsec-permissions-policy/#policy-controlled-feature</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-policy-controlled-feature">6. Permissions policy integration</a>
    <li><a href="#ref-for-policy-controlled-feature①">7.1.1. Eligibility for a page to be included in the interest cohort computation</a>
    <li><a href="#ref-for-policy-controlled-feature②">7.1.2. Permission to access the interest cohort</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" class="dfn-panel" data-for="0ab204fb9cc9a746edaff83c0db0740a" id="infopanel-for-0ab204fb9cc9a746edaff83c0db0740a">
   <span id="infopaneltitle-for-0ab204fb9cc9a746edaff83c0db0740a" style="display:none">Info about the 'DOMException' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMException">https://webidl.spec.whatwg.org/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" class="dfn-panel" data-for="d0f238a61de9310f1738a214749fab18" id="infopanel-for-d0f238a61de9310f1738a214749fab18">
   <span id="infopaneltitle-for-d0f238a61de9310f1738a214749fab18" style="display:none">Info about the 'DOMString' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-DOMString">https://webidl.spec.whatwg.org/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2. Interest cohort</a> <a href="#ref-for-idl-DOMString①">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-aa43258e2b51dc6ebe6268a36e6fd733" class="dfn-panel" data-for="aa43258e2b51dc6ebe6268a36e6fd733" id="infopanel-for-aa43258e2b51dc6ebe6268a36e6fd733">
   <span id="infopaneltitle-for-aa43258e2b51dc6ebe6268a36e6fd733" style="display:none">Info about the 'NotAllowedError' external reference.</span><a href="https://webidl.spec.whatwg.org/#notallowederror">https://webidl.spec.whatwg.org/#notallowederror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-notallowederror">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" class="dfn-panel" data-for="93669c631ec1ef8e696b4c083bdbe12c" id="infopanel-for-93669c631ec1ef8e696b4c083bdbe12c">
   <span id="infopaneltitle-for-93669c631ec1ef8e696b4c083bdbe12c" style="display:none">Info about the 'Promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#idl-promise">https://webidl.spec.whatwg.org/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" class="dfn-panel" data-for="bbe33fc7ac016834e4aaddbfd1b084a1" id="infopanel-for-bbe33fc7ac016834e4aaddbfd1b084a1">
   <span id="infopaneltitle-for-bbe33fc7ac016834e4aaddbfd1b084a1" style="display:none">Info about the 'a new promise' external reference.</span><a href="https://webidl.spec.whatwg.org/#a-new-promise">https://webidl.spec.whatwg.org/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" class="dfn-panel" data-for="f7204c0306e7ffcb24c31adf6e629e1d" id="infopanel-for-f7204c0306e7ffcb24c31adf6e629e1d">
   <span id="infopaneltitle-for-f7204c0306e7ffcb24c31adf6e629e1d" style="display:none">Info about the 'reject' external reference.</span><a href="https://webidl.spec.whatwg.org/#reject">https://webidl.spec.whatwg.org/#reject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reject">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-f4f973f92274819781816b033aea1f11" class="dfn-panel" data-for="f4f973f92274819781816b033aea1f11" id="infopanel-for-f4f973f92274819781816b033aea1f11">
   <span id="infopaneltitle-for-f4f973f92274819781816b033aea1f11" style="display:none">Info about the 'resolve' external reference.</span><a href="https://webidl.spec.whatwg.org/#resolve">https://webidl.spec.whatwg.org/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-be0933df03cd63338f98de217c4158c7" class="dfn-panel" data-for="be0933df03cd63338f98de217c4158c7" id="infopanel-for-be0933df03cd63338f98de217c4158c7">
   <span id="infopaneltitle-for-be0933df03cd63338f98de217c4158c7" style="display:none">Info about the 'this' external reference.</span><a href="https://webidl.spec.whatwg.org/#this">https://webidl.spec.whatwg.org/#this</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-this">3. The API</a> <a href="#ref-for-this①">(2)</a> <a href="#ref-for-this②">(3)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="07886e33695d0e7b473ef18f656ad7ac">Document</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="3dc9eee4a6a1d169f561b6d87bd08573">allowed to use</span>
     <li><span class="dfn-paneled" id="3a2763fcaa6bc82693554cf36780c0dd">in parallel</span>
     <li><span class="dfn-paneled" id="a8756513b792b8f203588906035a13bb">queue a global task</span>
     <li><span class="dfn-paneled" id="2233058c8f0998915af8393ee2abbc1d">relevant global object</span>
     <li><span class="dfn-paneled" id="613400696de3e8f8a5001430db03abe8">secure context</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="fd74d8159933c4a74d0b23390bed43e3">implementation-defined</span>
    </ul>
   <li>
    <a data-link-type="biblio">[PERMISSIONS-POLICY]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="18d0b1a84dc518786856e3236743c462">default allowlist</span>
     <li><span class="dfn-paneled" id="cbc4165961071efad91900c4c7b2fe8b">policy-controlled feature</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="0ab204fb9cc9a746edaff83c0db0740a">DOMException</span>
     <li><span class="dfn-paneled" id="d0f238a61de9310f1738a214749fab18">DOMString</span>
     <li><span class="dfn-paneled" id="aa43258e2b51dc6ebe6268a36e6fd733">NotAllowedError</span>
     <li><span class="dfn-paneled" id="93669c631ec1ef8e696b4c083bdbe12c">Promise</span>
     <li><span class="dfn-paneled" id="bbe33fc7ac016834e4aaddbfd1b084a1">a new promise</span>
     <li><span class="dfn-paneled" id="f7204c0306e7ffcb24c31adf6e629e1d">reject</span>
     <li><span class="dfn-paneled" id="f4f973f92274819781816b033aea1f11">resolve</span>
     <li><span class="dfn-paneled" id="be0933df03cd63338f98de217c4158c7">this</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-permissions-policy">[PERMISSIONS-POLICY]
   <dd>Ian Clelland. <a href="https://w3c.github.io/webappsec-permissions-policy/"><cite>Permissions Policy</cite></a>. URL: <a href="https://w3c.github.io/webappsec-permissions-policy/">https://w3c.github.io/webappsec-permissions-policy/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def"><c- b>dictionary</c-> <a href="#dictdef-interestcohort"><code><c- g>InterestCohort</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-interestcohort-id"><code><c- g>id</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-DOMString"><c- b>DOMString</c-></a> <a data-type="DOMString " href="#dom-interestcohort-version"><code><c- g>version</c-></code></a>;
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document"><c- g>Document</c-></a> {
    <a class="idl-code" data-link-type="interface" href="https://webidl.spec.whatwg.org/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-interestcohort"><c- n>InterestCohort</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-document-interestcohort"><c- g>interestCohort</c-></a>();
};

</pre>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort" class="dfn-panel" data-for="interest-cohort" id="infopanel-for-interest-cohort">
   <span id="infopaneltitle-for-interest-cohort" style="display:none">Info about the 'interest cohort' definition.</span><b><a href="#interest-cohort">#interest-cohort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort">4. Interpretation</a>
    <li><a href="#ref-for-interest-cohort①">7.1.2. Permission to access the interest cohort</a>
    <li><a href="#ref-for-interest-cohort②">7.2. Sensitive information</a>
    <li><a href="#ref-for-interest-cohort③">7.3. Tracking people via their interest cohort</a> <a href="#ref-for-interest-cohort④">(2)</a> <a href="#ref-for-interest-cohort⑤">(3)</a> <a href="#ref-for-interest-cohort⑥">(4)</a>
    <li><a href="#ref-for-interest-cohort⑦">7.4. Recovering the browsing history from cohorts</a> <a href="#ref-for-interest-cohort⑧">(2)</a> <a href="#ref-for-interest-cohort⑨">(3)</a> <a href="#ref-for-interest-cohort①⓪">(4)</a> <a href="#ref-for-interest-cohort①①">(5)</a> <a href="#ref-for-interest-cohort①②">(6)</a> <a href="#ref-for-interest-cohort①③">(7)</a> <a href="#ref-for-interest-cohort①④">(8)</a> <a href="#ref-for-interest-cohort①⑤">(9)</a> <a href="#ref-for-interest-cohort①⑥">(10)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort-id" class="dfn-panel" data-for="interest-cohort-id" id="infopanel-for-interest-cohort-id">
   <span id="infopaneltitle-for-interest-cohort-id" style="display:none">Info about the 'interest cohort id' definition.</span><b><a href="#interest-cohort-id">#interest-cohort-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort-id">2. Interest cohort</a> <a href="#ref-for-interest-cohort-id①">(2)</a> <a href="#ref-for-interest-cohort-id②">(3)</a> <a href="#ref-for-interest-cohort-id③">(4)</a>
    <li><a href="#ref-for-interest-cohort-id④">3. The API</a>
    <li><a href="#ref-for-interest-cohort-id⑤">4. Interpretation</a>
    <li><a href="#ref-for-interest-cohort-id⑥">5. Cohort assignment algorithm</a>
    <li><a href="#ref-for-interest-cohort-id⑦">5.1. Input and output</a>
    <li><a href="#ref-for-interest-cohort-id⑧">5.2. Caching the result</a>
    <li><a href="#ref-for-interest-cohort-id⑨">5.3. Privacy guarantees</a>
    <li><a href="#ref-for-interest-cohort-id①⓪">5.3.1. Anonymity</a> <a href="#ref-for-interest-cohort-id①①">(2)</a> <a href="#ref-for-interest-cohort-id①②">(3)</a>
    <li><a href="#ref-for-interest-cohort-id①③">5.3.2. No browsing history recovering from cohorts</a>
    <li><a href="#ref-for-interest-cohort-id①④">5.3.3. No sensitive cohorts</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-string-representation-of-the-interest-cohort-id" class="dfn-panel" data-for="string-representation-of-the-interest-cohort-id" id="infopanel-for-string-representation-of-the-interest-cohort-id">
   <span id="infopaneltitle-for-string-representation-of-the-interest-cohort-id" style="display:none">Info about the 'string representation of the interest cohort id' definition.</span><b><a href="#string-representation-of-the-interest-cohort-id">#string-representation-of-the-interest-cohort-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-representation-of-the-interest-cohort-id">2. Interest cohort</a>
    <li><a href="#ref-for-string-representation-of-the-interest-cohort-id">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort-version" class="dfn-panel" data-for="interest-cohort-version" id="infopanel-for-interest-cohort-version">
   <span id="infopaneltitle-for-interest-cohort-version" style="display:none">Info about the 'interest cohort version' definition.</span><b><a href="#interest-cohort-version">#interest-cohort-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort-version">2. Interest cohort</a>
    <li><a href="#ref-for-interest-cohort-version①">3. The API</a>
    <li><a href="#ref-for-interest-cohort-version②">4. Interpretation</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-string-representation-of-the-interest-cohort-version" class="dfn-panel" data-for="string-representation-of-the-interest-cohort-version" id="infopanel-for-string-representation-of-the-interest-cohort-version">
   <span id="infopaneltitle-for-string-representation-of-the-interest-cohort-version" style="display:none">Info about the 'string representation of the interest cohort version' definition.</span><b><a href="#string-representation-of-the-interest-cohort-version">#string-representation-of-the-interest-cohort-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-string-representation-of-the-interest-cohort-version">2. Interest cohort</a>
    <li><a href="#ref-for-string-representation-of-the-interest-cohort-version">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dictdef-interestcohort" class="dfn-panel" data-for="dictdef-interestcohort" id="infopanel-for-dictdef-interestcohort">
   <span id="infopaneltitle-for-dictdef-interestcohort" style="display:none">Info about the 'InterestCohort' definition.</span><b><a href="#dictdef-interestcohort">#dictdef-interestcohort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-interestcohort">2. Interest cohort</a>
    <li><a href="#ref-for-dictdef-interestcohort①">3. The API</a> <a href="#ref-for-dictdef-interestcohort②">(2)</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-interestcohort-id" class="dfn-panel" data-for="dom-interestcohort-id" id="infopanel-for-dom-interestcohort-id">
   <span id="infopaneltitle-for-dom-interestcohort-id" style="display:none">Info about the 'id' definition.</span><b><a href="#dom-interestcohort-id">#dom-interestcohort-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-interestcohort-id">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-interestcohort-version" class="dfn-panel" data-for="dom-interestcohort-version" id="infopanel-for-dom-interestcohort-version">
   <span id="infopaneltitle-for-dom-interestcohort-version" style="display:none">Info about the 'version' definition.</span><b><a href="#dom-interestcohort-version">#dom-interestcohort-version</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-interestcohort-version">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-dom-document-interestcohort" class="dfn-panel" data-for="dom-document-interestcohort" id="infopanel-for-dom-document-interestcohort">
   <span id="infopaneltitle-for-dom-document-interestcohort" style="display:none">Info about the 'interestCohort()' definition.</span><b><a href="#dom-document-interestcohort">#dom-document-interestcohort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-document-interestcohort">3. The API</a>
    <li><a href="#ref-for-dom-document-interestcohort①">7.1.1. Eligibility for a page to be included in the interest cohort computation</a>
    <li><a href="#ref-for-dom-document-interestcohort②">7.1.3. Private browsing / Incognito mode</a>
    <li><a href="#ref-for-dom-document-interestcohort③">7.3. Tracking people via their interest cohort</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort-task-source" class="dfn-panel" data-for="interest-cohort-task-source" id="infopanel-for-interest-cohort-task-source">
   <span id="infopaneltitle-for-interest-cohort-task-source" style="display:none">Info about the 'interest cohort task source' definition.</span><b><a href="#interest-cohort-task-source">#interest-cohort-task-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort-task-source">3. The API</a>
   </ul>
  </aside>
  <aside aria-labelledby="infopaneltitle-for-interest-cohort-policy-controlled-feature" class="dfn-panel" data-for="interest-cohort-policy-controlled-feature" id="infopanel-for-interest-cohort-policy-controlled-feature">
   <span id="infopaneltitle-for-interest-cohort-policy-controlled-feature" style="display:none">Info about the 'interest-cohort' definition.</span><b><a href="#interest-cohort-policy-controlled-feature">#interest-cohort-policy-controlled-feature</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-interest-cohort-policy-controlled-feature">3. The API</a>
    <li><a href="#ref-for-interest-cohort-policy-controlled-feature">7.1.1. Eligibility for a page to be included in the interest cohort computation</a>
    <li><a href="#ref-for-interest-cohort-policy-controlled-feature">7.1.2. Permission to access the interest cohort</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */
"use strict";
{
    function queryAll(sel) {
        return [].slice.call(document.querySelectorAll(sel));
    }

    // Add popup behavior to all dfns to show the corresponding dfn-panel.
    var dfns = document.querySelectorAll('.dfn-paneled');
    for (let dfn of dfns) { insertDfnPopupAction(dfn); }

    document.body.addEventListener("click", (e) => {
        // If not handled already, just hide all dfn panels.
        hideAllDfnPanels();
    });

    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        const panelWidth = panelRect.right - panelRect.left;
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn) {
        // Find dfn panel
        const dfnPanel = document.querySelector(`.dfn-panel[data-for='${dfn.id}']`);
        if (dfnPanel) {
            const panelWrapper = document.createElement('span');
            panelWrapper.appendChild(dfnPanel);
            panelWrapper.style.position = "relative";
            panelWrapper.style.height = "0px";
            dfn.insertAdjacentElement("afterend", panelWrapper);
            dfn.setAttribute('role', 'button');
            dfn.setAttribute('aria-expanded', 'false')
            dfn.tabIndex = 0;
            dfn.classList.add('has-dfn-panel');
            dfn.addEventListener('click', (event) => {
                showDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
            });
            dfn.addEventListener('keypress', (event) => {
                const kc = event.keyCode;
                // 32->Space, 13->Enter
                if(kc == 32 || kc == 13) {
                    toggleDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            });

            dfnPanel.addEventListener('click', (event) => {
                pinDfnPanel(dfnPanel);
                event.stopPropagation();
            });

            dfnPanel.addEventListener('keydown', (event) => {
                if(event.keyCode == 27) { // Escape key
                    hideDfnPanel(dfnPanel, dfn);
                    event.stopPropagation();
                    event.preventDefault();
                }
            })

        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + dfn.id + "']");
        }
    }
}
</script>