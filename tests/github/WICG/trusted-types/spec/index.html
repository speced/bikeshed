<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Trusted Types Spec WIP</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <link href="https://www.w3.org/StyleSheets/TR/2016/cg-draft" rel="stylesheet">
  <link href="https://wicg.github.io/trusted-types/dist/spec/" rel="canonical">
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
<style>/* style-dfn-panel */

.dfn-panel {
    position: absolute;
    z-index: 35;
    height: auto;
    width: -webkit-fit-content;
    width: fit-content;
    max-width: 300px;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: #DDDDDD;
    color: black;
    border: outset 0.2em;
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: black; }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0; }
.dfn-panel li { list-style: inside; }
.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-paneled { cursor: pointer; }
</style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">Trusted Types Spec WIP</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Community Group Report, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/trusted-types/dist/spec/">https://wicg.github.io/trusted-types/dist/spec/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:koto@google.com">Krzysztof Kotowicz</a> (<a class="p-org org" href="https://google.com">Google LLC</a>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mkwst@google.com">Mike West</a> (<a class="p-org org" href="https://google.com">Google LLC</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 the Contributors to the Trusted Types Spec WIP Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>An API that allows applications to lock down DOM XSS injection sinks to only accept non-spoofable, typed values in place of strings.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#goals"><span class="secno">1.1</span> <span class="content">Goals</span></a>
      <li><a href="#non-goals"><span class="secno">1.2</span> <span class="content">Non-goals</span></a>
      <li><a href="#use-cases"><span class="secno">1.3</span> <span class="content">Use cases</span></a>
     </ol>
    <li>
     <a href="#framework"><span class="secno">2</span> <span class="content">Framework</span></a>
     <ol class="toc">
      <li><a href="#injection-sinks"><span class="secno">2.1</span> <span class="content">Injection sinks</span></a>
      <li>
       <a href="#trusted-types"><span class="secno">2.2</span> <span class="content">Trusted Types</span></a>
       <ol class="toc">
        <li><a href="#trusted-html"><span class="secno">2.2.1</span> <span class="content"><span>TrustedHTML</span></span></a>
        <li><a href="#trusted-script"><span class="secno">2.2.2</span> <span class="content"><span>TrustedScript</span></span></a>
        <li><a href="#trused-script-url"><span class="secno">2.2.3</span> <span class="content"><span>TrustedScriptURL</span></span></a>
        <li><a href="#trusted-url"><span class="secno">2.2.4</span> <span class="content"><span>TrustedURL</span></span></a>
       </ol>
      <li>
       <a href="#policies"><span class="secno">2.3</span> <span class="content">Policies</span></a>
       <ol class="toc">
        <li><a href="#trusted-type-policy-factory"><span class="secno">2.3.1</span> <span class="content"><span>TrustedTypePolicyFactory</span></span></a>
        <li><a href="#trusted-type-policy"><span class="secno">2.3.2</span> <span class="content"><span>TrustedTypePolicy</span></span></a>
        <li><a href="#trusted-type-policy-options"><span class="secno">2.3.3</span> <span class="content"><span>TrustedTypePolicyOptions</span></span></a>
        <li><a href="#default-policy-hdr"><span class="secno">2.3.4</span> <span class="content"><span>Default policy</span></span></a>
       </ol>
      <li>
       <a href="#enforcement"><span class="secno">2.4</span> <span class="content">Enforcement</span></a>
       <ol class="toc">
        <li><a href="#trusted-type-configuration-hdr"><span class="secno">2.4.1</span> <span class="content">TrustedTypeConfiguration</span></a>
        <li><a href="#trusted-types-http-header"><span class="secno">2.4.2</span> <span class="content"><span>Trusted-Types</span> HTTP Response Header</span></a>
        <li><a href="#violation"><span class="secno">2.4.3</span> <span class="content">Violation</span></a>
        <li><a href="#reporting"><span class="secno">2.4.4</span> <span class="content">Reporting</span></a>
       </ol>
     </ol>
    <li>
     <a href="#algorithms"><span class="secno">3</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li>
       <a href="#policy-algorithms"><span class="secno">3.1</span> <span class="content">Policies</span></a>
       <ol class="toc">
        <li><a href="#initialize-policy-factory-algorithm"><span class="secno">3.1.1</span> <span class="content"><span>Initialize policy factory</span></span></a>
        <li><a href="#create-trusted-type-policy-algorithm"><span class="secno">3.1.2</span> <span class="content"><span>Create a Trusted Type Policy</span></span></a>
        <li><a href="#get-exposed-policy-algorithm"><span class="secno">3.1.3</span> <span class="content"><span>Get exposed policy</span></span></a>
        <li><a href="#get-default-policy-algorithm"><span class="secno">3.1.4</span> <span class="content"><span>Get default policy</span></span></a>
        <li><a href="#is-policy-name-allow-algorithm"><span class="secno">3.1.5</span> <span class="content"><span>Is policy name allowed</span></span></a>
        <li><a href="#is-default-policy-algorithm"><span class="secno">3.1.6</span> <span class="content"><span>Is a default policy</span></span></a>
        <li><a href="#create-a-trusted-type-algorithm"><span class="secno">3.1.7</span> <span class="content"><span>Create a Trusted Type</span></span></a>
       </ol>
      <li>
       <a href="#enforcement-algorithms"><span class="secno">3.2</span> <span class="content">Enforcement</span></a>
       <ol class="toc">
        <li><a href="#obtain-a-trusted-type-configuration-for-a-response-algorithm"><span class="secno">3.2.1</span> <span class="content"><span>Obtain a Trusted Type Configuration for a response</span></span></a>
        <li><a href="#get-trusted-type-compliant-string-algorithm"><span class="secno">3.2.2</span> <span class="content"><span>Get Trusted Type compliant string</span></span></a>
        <li><a href="#enforce-a-trusted-type-algorithm"><span class="secno">3.2.3</span> <span class="content"><span>Enforce a Trusted Type</span></span></a>
        <li><a href="#create-a-violation-for-algorithm"><span class="secno">3.2.4</span> <span class="content"><span>Create a Violation for</span></span></a>
        <li><a href="#report-sink-type-mismatch-violation-algorithm"><span class="secno">3.2.5</span> <span class="content"><span>Report sink type mismatch violation</span></span></a>
       </ol>
     </ol>
    <li>
     <a href="#integrations"><span class="secno">4</span> <span class="content">Integrations</span></a>
     <ol class="toc">
      <li>
       <a href="#integration-with-html"><span class="secno">4.1</span> <span class="content">Integration with HTML</span></a>
       <ol class="toc">
        <li><a href="#initialize-a-documents-trusted-type-configuration-algorithm"><span class="secno">4.1.1</span> <span class="content"><span>Initialize a Document’s trusted type configuration algorithm</span></span></a>
        <li><a href="#extensions-to-the-window-interface"><span class="secno">4.1.2</span> <span class="content">Extensions to the Window interface</span></a>
        <li><a href="#extensions-to-the-document-interface"><span class="secno">4.1.3</span> <span class="content">Extensions to the Document interface</span></a>
        <li><a href="#enforcement-in-window-open"><span class="secno">4.1.4</span> <span class="content">Enforcement in window open steps algorithm</span></a>
        <li><a href="#enforcement-in-location"><span class="secno">4.1.5</span> <span class="content">Enforcement in Location navigation algorithm</span></a>
        <li><a href="#enforcement-document-write"><span class="secno">4.1.6</span> <span class="content">Enforcement in document write steps</span></a>
        <li><a href="#enforcement-in-sinks"><span class="secno">4.1.7</span> <span class="content">Enforcement in property sinks</span></a>
        <li><a href="#enforcement-in-timer-functions"><span class="secno">4.1.8</span> <span class="content">Enforcement in timer functions</span></a>
        <li><a href="#enforcement-in-event-handler-content-attributes"><span class="secno">4.1.9</span> <span class="content">Enforcement in event handler content attributes</span></a>
        <li><a href="#string-compilation"><span class="secno">4.1.10</span> <span class="content">String compilation</span></a>
       </ol>
      <li>
       <a href="#integration-with-dom-parsing"><span class="secno">4.2</span> <span class="content">Integration with DOM Parsing</span></a>
       <ol class="toc">
        <li><a href="#extensions-to-element-interface"><span class="secno">4.2.1</span> <span class="content">Extensions to the Element interface</span></a>
        <li><a href="#extensions-to-the-range-interface"><span class="secno">4.2.2</span> <span class="content">Extensions to the Range interface</span></a>
        <li><a href="#extensions-to-the-DOMParser"><span class="secno">4.2.3</span> <span class="content">Extensions to the DOMParser interface</span></a>
       </ol>
     </ol>
    <li>
     <a href="#security-considerations"><span class="secno">5</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#bypass-vectors"><span class="secno">5.1</span> <span class="content">Bypass vectors</span></a>
      <li><a href="#best-practices-for-policy-design"><span class="secno">5.2</span> <span class="content">Best practices for policy design</span></a>
     </ol>
    <li>
     <a href="#implementation-considerations"><span class="secno">6</span> <span class="content">Implementation Considerations</span></a>
     <ol class="toc">
      <li><a href="#vendor-specific-extensions-and-addons"><span class="secno">6.1</span> <span class="content">Vendor-specific Extensions and Addons</span></a>
     </ol>
    <li><a href="#conformance"><span class="secno"></span> <span class="content"> Conformance</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>DOM-Based Cross-Site Scripting (DOM XSS) occurs when a web application
takes a string value from an attacker-controlled source (e.g. the
document URL parameter, or postMessage channel) and passes that value
to one of the <a href="#injection-sinks">injection sinks</a>, that eventually causes execution of the
script payload controlled by the attacker.</p>
   <p>This vulnerability type is prevalent in the web applications for two
reasons. For one, it’s easy to introduce - there are over 60 different
injection sinks (e.g. <code>Element.innerHTML</code>, or <code>Location.href</code> setters).
A lot of those sinks are widely used, and are often passed an attacker-controlled
value without the developer realizing it. Secondly, DOM XSS is
difficult to prevent. Due to the dynamic nature of JavaScript it’s
difficult to ascertain that this vulnerability is not present in a
given program - as such, DOM XSS is often missed during manual code
reviews, and automated code analysis. As an example, <code>foo[bar] = aString</code> is a statement that potentially introduces DOM XSS.</p>
   <p>This document defines <a href="#trusted-types">Trusted Types</a> - an API that allows applications
to lock down DOM XSS injection sinks to only accept non-spoofable, typed values
in place of strings. These values can in turn only be created from
application-defined <a href="#policies">policies</a>, allowing the authors to define rules
guarding writing values to the DOM, and reducing the DOM XSS attack
surface to small, isolated parts of the web application codebase,
which are substantially easier to safeguard, monitor and review.</p>
   <h3 class="heading settled" data-level="1.1" id="goals"><span class="secno">1.1. </span><span class="content">Goals</span><a class="self-link" href="#goals"></a></h3>
   <ul>
    <li data-md>
     <p>Minimize the likelihood of accidental DOM XSS introduction by the authors.</p>
    <li data-md>
     <p>Encourage a design in which XSS-related security decisions are
encapsulated within a small part of the application.</p>
    <li data-md>
     <p>Reduce DOM XSS security review surface for complex web application codebases.</p>
   </ul>
   <h3 class="heading settled" data-level="1.2" id="non-goals"><span class="secno">1.2. </span><span class="content">Non-goals</span><a class="self-link" href="#non-goals"></a></h3>
   <ul>
    <li data-md>
     <p>Address injections into server-side generated markup, in specific
reflections into the body of the scripts running in a document.</p>
   </ul>
   <p class="issue" id="issue-1f1f9f2b"><a class="self-link" href="#issue-1f1f9f2b"></a> mention other solutions, like templating systems, or CSP for mitigating</p>
   <h3 class="heading settled" data-level="1.3" id="use-cases"><span class="secno">1.3. </span><span class="content">Use cases</span><a class="self-link" href="#use-cases"></a></h3>
   <p class="issue" id="issue-d33261f4"><a class="self-link" href="#issue-d33261f4"></a> figure out if we need this section here. CSP has none, SRI has one and it looks useful.</p>
   <ul>
    <li data-md>
     <p>An author maintains a complex web application written in a framework
that uses a secure templating system to generate the UI
components. The application also depends on 3rd party client-side
libraries that perform auxiliary tasks (e.g. analytics, performance
monitoring). To ensure that none of these components introduces DOM
XSS vulnerabilities, author defines a Trusted Type policy in the
templating policy and enables the enforcement for the DOM sinks.</p>
    <li data-md>
     <p class="issue" id="issue-5bedf486"><a class="self-link" href="#issue-5bedf486"></a> Something about reducing the review surface</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="framework"><span class="secno">2. </span><span class="content">Framework</span><a class="self-link" href="#framework"></a></h2>
   <h3 class="heading settled" data-level="2.1" id="injection-sinks"><span class="secno">2.1. </span><span class="content">Injection sinks</span><a class="self-link" href="#injection-sinks"></a></h3>
   <p><em>This section is not normative.</em></p>
   <p>A DOM XSS <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="injection-sink">injection sink</dfn> is a function that evaluates an input
string value in a way that could result in XSS if that value is untrusted.</p>
   <p>Examples of injection sinks include:</p>
   <ul>
    <li data-md>
     <p>Functions that parse &amp; insert HTML strings into he document like <a href="https://www.w3.org/TR/DOM-Parsing/#widl-Element-innerHTML">Element.innerHTML</a> setter</p>
    <li data-md>
     <p>Setters for <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element">Element</a></code> attributes that accept a URL of the code to load
like <code class="idl"><a class="idl-code" data-link-type="attribute" href="https://html.spec.whatwg.org/multipage/scripting.html#dom-script-src" id="ref-for-dom-script-src">HTMLScriptElement.src</a></code></p>
    <li data-md>
     <p>Setters for <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element①">Element</a></code> attributes that accept a code to execute like <code class="idl"><a class="idl-code" data-link-type="attribute" href="https://html.spec.whatwg.org/multipage/scripting.html#dom-script-text" id="ref-for-dom-script-text">HTMLScriptElement.text</a></code></p>
    <li data-md>
     <p>Functions that execute code directly like <code>eval</code>.</p>
    <li data-md>
     <p>Functions that accept URLs with <code>javascript:</code> scheme</p>
    <li data-md>
     <p>Functions that create a new same-origin <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> with caller-controlled
markup like <code class="idl"><a data-link-type="idl" href="#dom-domparser-parsefromstring" id="ref-for-dom-domparser-parsefromstring">parseFromString()</a></code>.</p>
   </ul>
   <p>An application is vulnerable to DOM XSS if it permits a flow of data from an
attacker-controlled source and permits that data to reach an injection sink
without appropriate validation, sanitization or escaping.</p>
   <p>It’s difficult to determine if DOM XSS is present by analyzing the invocations
of <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink">injection sinks</a>, as the strings do not carry the information about the
provenance of their value. To allow the authors to control values reaching
sensitive DOM and JavaScript functions, we introduce Trusted Types.</p>
   <p class="note" role="note"><span>Note:</span> The exact list of injection sinks covered by this document is defined in <a href="#integrations">§4 Integrations</a>.</p>
   <p class="issue" id="issue-7a6e3d33"><a class="self-link" href="#issue-7a6e3d33"></a> Consider surfacing the DOM sink (node + attr) => type mapping in the API, to faciliate building HTML sanitizers. <a href="https://github.com/WICG/trusted-types/issues/43">&lt;https://github.com/WICG/trusted-types/issues/43></a></p>
   <h3 class="heading settled" data-level="2.2" id="trusted-types"><span class="secno">2.2. </span><span class="content">Trusted Types</span><a class="self-link" href="#trusted-types"></a></h3>
   <p>We introduce the following list of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trusted-type">Trusted Type</dfn>s indicating that a given value is
trusted by the authors to be used with an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①">injection sink</a> in a certain context.</p>
   <p class="note" role="note"><span>Note:</span> <strong>Trusted</strong> in this context signifies the fact that the application author
is confident that a given value can be safely used with an injection sink - she <em>trusts</em> it does not introduce a vulnerability. That does not imply that the
value is indeed <em>safe</em>.</p>
   <p class="note" role="note"><span>Note:</span> This allows the authors to specify the intention when creating a given
value, and the user agents to introduce checks based on the type of
such value to preserve the authors' intent. For example, if the
authors intends a value to be used as a URL of an image, an attempt to
load a script from that URL would fail.</p>
   <p class="note" role="note"><span>Note:</span> All Trusted Types wrap over an immutable string, specified when the
objects are created. These objects are unforgable in a sense that
there is no JavaScript-exposed way to replace the inner string value
of a given object - it’s stored in an internal slot with no setter
exposed.</p>
   <p class="note" role="note"><span>Note:</span> All Trusted Types stringifiers return the inner string value.
This makes it easy to incrementally migrate the application code into using
Trusted Types in place of DOM strings (it’s possible to start
producing types in parts of the application, while still using and
accepting strings in other parts of the codebase). In that sense,
Trusted Types are backwards-compatible with the regular DOM APIs.</p>
   <h4 class="heading settled" data-level="2.2.1" id="trusted-html"><span class="secno">2.2.1. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedhtml">TrustedHTML<a class="self-link" href="#typedef-trustedhtml"></a></dfn></span><a class="self-link" href="#trusted-html"></a></h4>
   <p>The TrustedHTML interface represents a string that a developer can
confidently insert into an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink②">injection sink</a> that will render it as HTML.
These objects are immutable
wrappers around a string, constructed via a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy">TrustedTypePolicy</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createhtml" id="ref-for-dom-trustedtypepolicy-createhtml">createHTML</a></code> method.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedhtml"><code><c- g>TrustedHTML</c-></code></dfn> {
  <dfn data-dfn-for="TrustedHTML" data-dfn-type="dfn" data-export data-lt="stringification behavior" id="TrustedHTML-stringification-behavior"><c- b>stringifier</c-><a class="self-link" href="#TrustedHTML-stringification-behavior"></a></dfn>;
};
</pre>
   <p>TrustedHTML objects have a <code>[[Data]]</code> internal slot which holds a
DOMString. The slot’s value is set when the object is created, and
will never change during its lifetime.</p>
   <p>To stringify a TrustedHTML object, return the DOMString from its <code>[[Data]]</code> internal slot.</p>
   <p class="issue" id="issue-fee6a803"><a class="self-link" href="#issue-fee6a803"></a> Add TrustedHTML.EMPTY. <a href="https://github.com/WICG/trusted-types/issues/95">&lt;https://github.com/WICG/trusted-types/issues/95></a></p>
   <h4 class="heading settled" data-level="2.2.2" id="trusted-script"><span class="secno">2.2.2. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedscript">TrustedScript<a class="self-link" href="#typedef-trustedscript"></a></dfn></span><a class="self-link" href="#trusted-script"></a></h4>
   <p>The TrustedScript interface represents a string with an uncompiled
script body that a developer can confidently pass into an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink③">injection sink</a> that might lead to executing that script.
These objects are immutable wrappers
around a string, constructed via a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy①">TrustedTypePolicy</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createscript" id="ref-for-dom-trustedtypepolicy-createscript">createScript</a></code> method.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedscript"><code><c- g>TrustedScript</c-></code></dfn> {
  <dfn data-dfn-for="TrustedScript" data-dfn-type="dfn" data-export data-lt="stringification behavior" id="TrustedScript-stringification-behavior"><c- b>stringifier</c-><a class="self-link" href="#TrustedScript-stringification-behavior"></a></dfn>;
};
</pre>
   <p>TrustedScript objects have a <code>[[Data]]</code> internal slot which holds a
DOMString. The slot’s value is set when the object is created, and
will never change during its lifetime.</p>
   <p>To stringify a TrustedScript object, return the DOMString from its <code>[[Data]]</code> internal slot.</p>
   <h4 class="heading settled" data-level="2.2.3" id="trused-script-url"><span class="secno">2.2.3. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedscripturl">TrustedScriptURL<a class="self-link" href="#typedef-trustedscripturl"></a></dfn></span><a class="self-link" href="#trused-script-url"></a></h4>
   <p>The TrustedScriptURL interface represents a string that a developer
can confidently pass into an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink④">injection sink</a> that will parse it as a URL of
an external script resource.
These objects are immutable wrappers around a
string, constructed via a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy②">TrustedTypePolicy</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createscripturl" id="ref-for-dom-trustedtypepolicy-createscripturl">createScriptURL</a></code> method.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedscripturl"><code><c- g>TrustedScriptURL</c-></code></dfn> {
  <dfn data-dfn-for="TrustedScriptURL" data-dfn-type="dfn" data-export data-lt="stringification behavior" id="TrustedScriptURL-stringification-behavior"><c- b>stringifier</c-><a class="self-link" href="#TrustedScriptURL-stringification-behavior"></a></dfn>;
};
</pre>
   <p>TrustedScriptURL objects have a <code>[[Data]]</code> internal slot which holds a
USVString. The slot’s value is set when the object is created, and
will never change during its lifetime.</p>
   <p>To stringify a TrustedScriptURL object, return the USVString from its <code>[[Data]]</code> internal slot.</p>
   <h4 class="heading settled" data-level="2.2.4" id="trusted-url"><span class="secno">2.2.4. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedurl">TrustedURL<a class="self-link" href="#typedef-trustedurl"></a></dfn></span><a class="self-link" href="#trusted-url"></a></h4>
   <p>The TrustedURL interface represents a string that a developer
can confidently pass into an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink⑤">injection sink</a> that will be parse it a URL of
an external resource that is not scripted.
These objects are immutable wrappers around a
string, constructed via a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy③">TrustedTypePolicy</a></code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createurl" id="ref-for-dom-trustedtypepolicy-createurl">createURL</a></code> method.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedurl"><code><c- g>TrustedURL</c-></code></dfn> {
  <dfn data-dfn-for="TrustedURL" data-dfn-type="dfn" data-export data-lt="stringification behavior" id="TrustedURL-stringification-behavior"><c- b>stringifier</c-><a class="self-link" href="#TrustedURL-stringification-behavior"></a></dfn>;
};
</pre>
   <p>TrustedURL objects have a <code>[[Data]]</code> internal slot which holds a
USVString.  The slot’s value is set when the object is created, and
will never change during its lifetime.</p>
   <p>To stringify a TrustedURL object, return the USVString from its <code>[[Data]]</code> internal slot.</p>
   <p class="issue" id="issue-a6d5e385"><a class="self-link" href="#issue-a6d5e385"></a> Consider adding new set of types, e.g. related to CSS. <a href="https://github.com/WICG/trusted-types/issues/104">&lt;https://github.com/WICG/trusted-types/issues/104></a></p>
   <h3 class="heading settled" data-level="2.3" id="policies"><span class="secno">2.3. </span><span class="content">Policies</span><a class="self-link" href="#policies"></a></h3>
   <p>Trusted Types can only be created via user-defined
and immutable policies that define rules for converting a string into
a given Trusted Type object. Policies allows the authors to specify custom,
programmatic rules that Trusted Types must adhere to.</p>
   <div class="example" id="sanitizing-policy">
    <a class="self-link" href="#sanitizing-policy"></a> Authors may define a
policy that will sanitize an HTML string, allowing only a subset of
tags and attributes that are known not to cause JavaScript
execution. Any <code class="idl"><a data-link-type="idl" href="#trustedhtml" id="ref-for-trustedhtml">TrustedHTML</a></code> object created through this policy can then
be safely used in the application, and e.g. passed to <code>innerHTML</code> setter - even if the input value was controlled by the attacker, the
policy rules neutralized it to adhere to policy-specific
contract. 
<pre class="highlight"><c- kr>const</c-> sanitizingPolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'sanitize-html'</c-><c- p>,</c-> <c- p>{</c->
  createHTML<c- o>:</c-> <c- p>(</c->input<c- p>)</c-> <c- p>=></c-> myTrustedSanitizer<c- p>(</c->input<c- p>,</c-> <c- p>{</c-> superSafe<c- o>:</c-> <c- t>'ok'</c-><c- p>}),</c->
<c- p>},</c-> <c- d>/* expose = */</c-> <c- kc>true</c-><c- p>);</c->

myDiv<c- p>.</c->innerHTML <c- o>=</c-> sanitizingPolicy<c- p>.</c->createHTML<c- p>(</c->untrustedValue<c- p>);</c->
</pre>
   </div>
   <p class="note" role="note"><span>Note:</span> <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type">Trusted Type</a> objects wrap values that are explicitly trusted by
the author. As such, creating a Trusted Type object instance becomes a de
facto DOM XSS <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink⑥">injection sink</a>, and hence code that creates Trusted Type
instances is security-critical. To allow for strict control over Trusted Type
object creation we don’t expose the constructors of those
directly, but require policy usage.</p>
   <p>There can be multiple policies for a document, allowing the
applications to define different rules for different parts of the
codebase.</p>
   <div class="example" id="policy-reference">
    <a class="self-link" href="#policy-reference"></a> Library initialized with a policy allowing it to load additional scripts from
a given host. 
<pre class="highlight"><c- kr>const</c-> cdnScriptsPolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'cdn-scripts'</c-><c- p>,</c-> <c- p>{</c->
  createScriptURL<c- p>(</c->url<c- p>)</c-> <c- p>{</c->
    <c- kr>const</c-> parsed <c- o>=</c-> <c- k>new</c-> URL<c- p>(</c->url<c- p>,</c-> document<c- p>.</c->baseURI<c- p>);</c->
    <c- k>if</c-> <c- p>(</c->parsed<c- p>.</c->origin <c- o>==</c-> <c- t>'https://mycdn.example'</c-><c- p>)</c-> <c- p>{</c->
      <c- k>return</c-> URL<c- p>.</c->toString<c- p>();</c->
    <c- p>}</c->
    <c- k>throw</c-> <c- k>new</c-> TypeError<c- p>(</c-><c- t>'invalid URL'</c-><c- p>);</c->
  <c- p>},</c->
<c- p>});</c->

myLibrary<c- p>.</c->init<c- p>({</c->policy<c- o>:</c-> cdnScriptsPolicy<c- p>});</c->
</pre>
   </div>
   <p class="note" role="note"><span>Note:</span> As Trusted Type objects can only be created via policies, if <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①">enforcement</a> is enabled, only the policy code can introduce a DOM
XSS, and hence call-sites of the policies' factory functions are the <em>only</em> security-sensitive code in the entire program. Only this
typically small subset of the entire code base needs to be
security-reviewed for DOM XSS - there’s no need to monitor or review
the traditional DOM sinks, as User Agents <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①①">enforce</a> that
those sinks will only accept Trusted Type objects, and these in turn
can only be created via policies.</p>
   <p>The <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyfactory-createpolicy" id="ref-for-dom-trustedtypepolicyfactory-createpolicy">createPolicy</a></code> function returns a policy object whose create* functions
will create Trusted Type objects after applying the policy
rules. Policies may also be optionally exposed, allowing callers to
obtain a reference to the policy object from the global registry.</p>
   <p class="note" role="note"><span>Note:</span> While it’s safe to globally expose a policy that sanitizes its input
(and allow any part of the application to use it), there might be a
need to create lax policies to be used internally, and only to be
called with author-controlled input. For example, a client-side HTML
templating library, an HTML sanitizer library, or a JS asynchronous
code plugin loading subsystem each will likely need full control over
HTML or URLs. The API design facilitates that - each policy may only
be used if the callsite can obtain a reference to the policy (a return
value from <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyfactory-createpolicy" id="ref-for-dom-trustedtypepolicyfactory-createpolicy①">createPolicy()</a></code>). As such, policy
references can be treated as <a href="https://en.wikipedia.org/wiki/Object-capability_model">capabilities</a>,
access to which can be controlled using JavaScript techniques
(e.g. via closures, internal function variables, or modules).</p>
   <div class="example" id="policy-capability">
    <a class="self-link" href="#policy-capability"></a> Unsafe no-op policy reachable only from within a single code block to ascertain
that it’s called only with no attacker-controlled values. 
<pre class="highlight"><c- p>(</c-><c- a>function</c-> renderFootnote<c- p>()</c-> <c- p>{</c->
  <c- kr>const</c-> unsafePolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'html'</c-><c- p>,</c-> <c- p>{</c->
    createHTML<c- o>:</c-> input <c- p>=></c-> input<c- p>,</c->
  <c- p>});</c->
  <c- kr>const</c-> footnote <c- o>=</c-> await fetch<c- p>(</c-><c- t>'/footnote.html'</c-><c- p>).</c->then<c- p>(</c->r <c- p>=></c-> r<c- p>.</c->text<c- p>());</c->
  footNote<c- p>.</c->innerHTML <c- o>=</c-> unsafePolicy<c- p>.</c->createHTML<c- p>(</c->footnote<c- p>);</c->
<c- p>})();</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="2.3.1" id="trusted-type-policy-factory"><span class="secno">2.3.1. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedtypepolicyfactory">TrustedTypePolicyFactory<a class="self-link" href="#typedef-trustedtypepolicyfactory"></a></dfn></span><a class="self-link" href="#trusted-type-policy-factory"></a></h4>
   <p>TrustedTypePolicyFactory creates <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy④">policies</a></code> and verifies that Trusted Type object instances
were created via one of the policies.</p>
   <p class="note" role="note"><span>Note:</span> This factory object is exposed to JavaScript through <code>window.TrustedTypes</code> reference - see <a href="#extensions-to-the-window-interface">§4.1.2 Extensions to the Window interface</a>.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=<c- n>Window</c->] <c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedtypepolicyfactory"><code><c- g>TrustedTypePolicyFactory</c-></code></dfn> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑤"><c- n>TrustedTypePolicy</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-createpolicy" id="ref-for-dom-trustedtypepolicyfactory-createpolicy②"><c- g>createPolicy</c-></a>(
        <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/createPolicy(policyName, policyOptions, exposed), TrustedTypePolicyFactory/createPolicy(policyName, policyOptions), TrustedTypePolicyFactory/createPolicy(policyName)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyname"><code><c- g>policyName</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyname"></a></dfn>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-trustedtypepolicyoptions" id="ref-for-dictdef-trustedtypepolicyoptions"><c- n>TrustedTypePolicyOptions</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/createPolicy(policyName, policyOptions, exposed), TrustedTypePolicyFactory/createPolicy(policyName, policyOptions), TrustedTypePolicyFactory/createPolicy(policyName)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyoptions"><code><c- g>policyOptions</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyoptions"></a></dfn>,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/createPolicy(policyName, policyOptions, exposed), TrustedTypePolicyFactory/createPolicy(policyName, policyOptions), TrustedTypePolicyFactory/createPolicy(policyName)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-exposed"><code><c- g>exposed</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-exposed"></a></dfn> = <c- b>false</c->);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑥"><c- n>TrustedTypePolicy</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-getexposedpolicy" id="ref-for-dom-trustedtypepolicyfactory-getexposedpolicy"><c- g>getExposedPolicy</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/getExposedPolicy(policyName)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-getexposedpolicy-policyname-policyname"><code><c- g>policyName</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-getexposedpolicy-policyname-policyname"></a></dfn>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable②"><c- g>Unforgeable</c-></a>] <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-getpolicynames" id="ref-for-dom-trustedtypepolicyfactory-getpolicynames"><c- g>getPolicyNames</c-></a>();
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable③"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-ishtml" id="ref-for-dom-trustedtypepolicyfactory-ishtml"><c- g>isHTML</c-></a>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/isHTML(value)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-ishtml-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-ishtml-value-value"></a></dfn>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable④"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isscript" id="ref-for-dom-trustedtypepolicyfactory-isscript"><c- g>isScript</c-></a>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/isScript(value)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-isscript-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-isscript-value-value"></a></dfn>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑤"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean③"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isscripturl" id="ref-for-dom-trustedtypepolicyfactory-isscripturl"><c- g>isScriptURL</c-></a>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/isScriptURL(value)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-isscripturl-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-isscripturl-value-value"></a></dfn>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑥"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean④"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isurl" id="ref-for-dom-trustedtypepolicyfactory-isurl"><c- g>isURL</c-></a>(<c- b>any</c-> <dfn class="idl-code" data-dfn-for="TrustedTypePolicyFactory/isURL(value)" data-dfn-type="argument" data-export id="dom-trustedtypepolicyfactory-isurl-value-value"><code><c- g>value</c-></code><a class="self-link" href="#dom-trustedtypepolicyfactory-isurl-value-value"></a></dfn>);
};
</pre>
   <p>Internal slot <code>[[PolicyMap]]</code> contains a map, with each map entry
being a pair of a policy name (DOMString key) and the
TrustedTypePolicy (value).</p>
   <p>Internal slot <code>[[Configuration]]</code> stores the <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration">TrustedTypeConfiguration</a></code> to be applied for documents the factory is created for.</p>
   <div>
    <dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export data-lt="createPolicy(policyName, policyOptions, exposed)|createPolicy(policyName, policyOptions)|createPolicy(policyName)" id="dom-trustedtypepolicyfactory-createpolicy"><code>createPolicy(policyName, policyOptions, exposed)</code></dfn>
     <dd data-md>
      <p>Creates a uniquely named policy object that will implement the rules
passed in the <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypepolicyoptions" id="ref-for-dictdef-trustedtypepolicyoptions①">TrustedTypePolicyOptions</a></code> object. Allowed policy names
may be restricted by the <a data-link-type="dfn" href="#trusted-types-http-response-header" id="ref-for-trusted-types-http-response-header">Trusted-Types HTTP Response Header</a> - if that
is present, and the policy name is not on the whitelist defined in the
header, the policy creation fails with a <a href="https://www.w3.org/TR/2016/REC-WebIDL-1-20161215/#idl-Error">TypeError</a>.
Also, if createPolicy is called more than once with any given policyName,
policy creation fails with a TypeError.</p>
      <div class="example" id="create-policy-example">
       <a class="self-link" href="#create-policy-example"></a> 
<pre class="highlight"><c- c1>// HTTP Response header: Trusted-Types: "foo"</c->
TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- u>"foo"</c-><c- p>,</c-> <c- p>{});</c-> <c- c1>// ok.</c->
TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- u>"bar"</c-><c- p>,</c-> <c- p>{});</c-> <c- c1>// throws - name not on the whitelist.</c->
TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- u>"foo"</c-><c- p>,</c-> <c- p>{});</c-> <c- c1>// throws - duplicate name.</c->
</pre>
      </div>
      <p>The policy can also be optionally exposed, allowing for a policy retrieval via <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyfactory-getexposedpolicy" id="ref-for-dom-trustedtypepolicyfactory-getexposedpolicy①">getExposedPolicy(policyName)</a></code>.</p>
      <p>Returns the result of executing a <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type-policy" id="ref-for-abstract-opdef-create-a-trusted-type-policy">Create a Trusted Type Policy</a> algorithm,
with the following arguments:</p>
      <dl>
       <dt>factory
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a>
       <dt>policyName
       <dd>policyName 
       <dt>exposed
       <dd>exposed
      </dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-getpolicynames"><code>getPolicyNames()</code></dfn>
     <dd data-md>
      <p>Returns a new list, comprising of all keys of the <code>[[PolicyMap]]</code> internal slot map.</p>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-getexposedpolicy"><code>getExposedPolicy(policyName)</code></dfn>
     <dd data-md>
      <p>Returns a policy object identified by a name, if that policy exists
and is exposed. Returns the result of executing a <a data-link-type="abstract-op" href="#abstract-opdef-get-exposed-policy" id="ref-for-abstract-opdef-get-exposed-policy">Get exposed policy</a> algorithm, with the following arguments:</p>
      <dl>
       <dt>factory
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a>
       <dt>policyName
       <dd>policyName 
      </dl>
      <div class="example" id="get-exposed-policy-example">
       <a class="self-link" href="#get-exposed-policy-example"></a> 
<pre class="highlight"><c- kr>const</c-> exposedPolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'foo'</c-><c- p>,</c-> <c- p>{},</c-> <c- kc>true</c-><c- p>);</c->
exposedPolicy <c- o>===</c-> TrustedTypes<c- p>.</c->getExposedPolicy<c- p>(</c-><c- t>'foo'</c-><c- p>);</c-> <c- c1>// true</c->

<c- kr>const</c-> unexposedPolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'bar'</c-><c- p>,</c-> <c- p>{});</c->
unexposedPolicy <c- k>instanceof</c-> TrustedTypesPolicy <c- c1>// true</c->
TrustedTypes<c- p>.</c->getExposedPolicy<c- p>(</c-><c- t>'bar'</c-><c- p>)</c-> <c- o>===</c-> <c- kc>null</c-> <c- c1>// true</c->
</pre>
      </div>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-ishtml"><code>isHTML(value)</code></dfn>
     <dd data-md>
      <p>Returns true if value is an instance of <code class="idl"><a data-link-type="idl" href="#trustedhtml" id="ref-for-trustedhtml①">TrustedHTML</a></code> and has its <code>[[Data]]</code> internal slot set, false otherwise.</p>
      <p class="note" role="note"><span>Note:</span> <code>is*</code> functions are used to check if a given object is truly a legitimate <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type①">Trusted Type</a> object (e.g. it was created via one of the configured
policies). This is to be able to detect a forgery of the objects via
e.g. <a href="https://tc39.github.io/ecma262/#sec-object.create">Object.create</a> or prototype chains manipulation.</p>
      <div class="example" id="is-html-example">
       <a class="self-link" href="#is-html-example"></a> 
<pre class="highlight"><c- kr>const</c-> html <c- o>=</c-> policy<c- p>.</c->createHTML<c- p>(</c-><c- t>'&lt;div>'</c-><c- p>);</c->
TrustedTypes<c- p>.</c->isHTML<c- p>(</c->html<c- p>)</c-> <c- c1>// true</c->

<c- kr>const</c-> fake <c- o>=</c-> Object<c- p>.</c->create<c- p>(</c->TrustedHTML<c- p>.</c->prototype<c- p>);</c->
TrustedTypes<c- p>.</c->isHTML<c- p>(</c->fake<c- p>)</c-> <c- c1>// false</c->

TrustedTypes<c- p>.</c->isHTML<c- p>(</c-><c- u>"&lt;div>plain string&lt;/div>"</c-><c- p>)</c-> <c- c1>// false</c->
</pre>
      </div>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-isscript"><code>isScript(value)</code></dfn>
     <dd data-md>
      <p>Returns true if value is an instance of <code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript">TrustedScript</a></code> and has its <code>[[Data]]</code> internal slot set, false otherwise.</p>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-isscripturl"><code>isScriptURL(value)</code></dfn>
     <dd data-md>
      <p>Returns true if value is an instance of <code class="idl"><a data-link-type="idl" href="#trustedscripturl" id="ref-for-trustedscripturl">TrustedScriptURL</a></code> and has its <code>[[Data]]</code> internal slot set, false otherwise.</p>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyFactory" data-dfn-type="method" data-export id="dom-trustedtypepolicyfactory-isurl"><code>isURL(value)</code></dfn>
     <dd data-md>
      <p>Returns true if value is an instance of <code class="idl"><a data-link-type="idl" href="#trustedurl" id="ref-for-trustedurl">TrustedURL</a></code> and has its <code>[[Data]]</code> internal slot set, false otherwise.</p>
    </dl>
   </div>
   <div class="example" id="create-and-used-unexposed-policy">
    <a class="self-link" href="#create-and-used-unexposed-policy"></a> 
<pre class="highlight"><c- kr>const</c-> myPolicy <c- o>=</c-> TrustedTypes<c- p>.</c->createPolicy<c- p>(</c-><c- t>'myPolicy'</c-><c- p>,</c-> <c- p>{</c->
  <c- c1>// This needs security review, as it’s security critical code;</c->
  <c- c1>// a flaw in this code could cause DOM XSS.</c->
  createHTML<c- p>(</c->input<c- p>)</c-> <c- p>{</c-> <c- k>return</c-> ASanitizer<c- p>.</c->sanitize<c- p>(</c->input<c- p>)</c-> <c- p>},</c->
  createScriptURL<c- p>(</c->input<c- p>)</c-> <c- p>{</c->
    <c- kr>const</c-> u <c- o>=</c-> <c- k>new</c-> URL<c- p>(</c->dirty<c- p>,</c-> document<c- p>.</c->baseURI<c- p>);</c->
    <c- k>if</c-> <c- p>(</c->APPLICATION_CONFIG<c- p>.</c->scriptOrigins<c- p>.</c->includes<c- p>(</c->u<c- p>.</c->origin<c- p>))</c-> <c- p>{</c->
      <c- k>return</c-> u<c- p>.</c->href<c- p>;</c->
    <c- p>}</c->
    <c- k>throw</c-> <c- k>new</c-> Error<c- p>(</c-><c- t>'Cannot load scripts from this origin'</c-><c- p>);</c->
  <c- p>},</c->
<c- p>});</c->
TrustedTypes<c- p>.</c->getPolicyNames<c- p>();</c->
<c- c1>// ['myPolicy']</c->

TrustedTypes<c- p>.</c->getExposedPolicy<c- p>(</c-><c- t>'myPolicy'</c-><c- p>);</c->
<c- c1>// null</c->

document<c- p>.</c->querySelector<c- p>(</c-><c- u>"#foo"</c-><c- p>).</c->innerHTML <c- o>=</c-> myPolicy<c- p>.</c->createHTML<c- p>(</c->aValue<c- p>);</c->
scriptElement<c- p>.</c->src <c- o>=</c-> myPolicy<c- p>.</c->createScriptURL<c- p>(</c->
    <c- t>'https://scripts.myapp.example/script.js'</c-><c- p>);</c->
</pre>
   </div>
   <h4 class="heading settled" data-level="2.3.2" id="trusted-type-policy"><span class="secno">2.3.2. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedtypepolicy">TrustedTypePolicy<a class="self-link" href="#typedef-trustedtypepolicy"></a></dfn></span><a class="self-link" href="#trusted-type-policy"></a></h4>
   <p>Policy objects implement a TrustedTypePolicy interface and define a
group of functions creating Trusted Type objects. Each policy is
identified by a name unique within a realm. Each of the create
functions converts a string value to a given Trusted Type variant, or
throws a TypeError if a conversion of a given value is disallowed.</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="trustedtypepolicy"><code><c- g>TrustedTypePolicy</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑦"><c- g>Unforgeable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicy" data-dfn-type="attribute" data-export data-readonly data-type="DOMString" id="dom-trustedtypepolicy-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-trustedtypepolicy-name"></a></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑧"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml②"><c- n>TrustedHTML</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createhtml" id="ref-for-dom-trustedtypepolicy-createhtml①"><c- g>createHTML</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString④"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicy/createHTML(input)" data-dfn-type="argument" data-export id="dom-trustedtypepolicy-createhtml-input-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-trustedtypepolicy-createhtml-input-input"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑨"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript①"><c- n>TrustedScript</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createscript" id="ref-for-dom-trustedtypepolicy-createscript①"><c- g>createScript</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑤"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicy/createScript(input)" data-dfn-type="argument" data-export id="dom-trustedtypepolicy-createscript-input-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-trustedtypepolicy-createscript-input-input"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①⓪"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl①"><c- n>TrustedScriptURL</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createscripturl" id="ref-for-dom-trustedtypepolicy-createscripturl①"><c- g>createScriptURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑥"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicy/createScriptURL(input)" data-dfn-type="argument" data-export id="dom-trustedtypepolicy-createscripturl-input-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-trustedtypepolicy-createscripturl-input-input"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl①"><c- n>TrustedURL</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createurl" id="ref-for-dom-trustedtypepolicy-createurl①"><c- g>createURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑦"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="TrustedTypePolicy/createURL(input)" data-dfn-type="argument" data-export id="dom-trustedtypepolicy-createurl-input-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-trustedtypepolicy-createurl-input-input"></a></dfn>);
};
</pre>
   <p>Each TrustedTypePolicy object has an <code>[[options]]</code> internal slot, holding the <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypepolicyoptions" id="ref-for-dictdef-trustedtypepolicyoptions②">TrustedTypePolicyOptions</a></code> object describing the actual behavior of the policy.</p>
   <div>
    <dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicy" data-dfn-type="method" data-export id="dom-trustedtypepolicy-createhtml"><code>createHTML(input)</code></dfn>
     <dd data-md>
      <p>Returns the
result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type" id="ref-for-abstract-opdef-create-a-trusted-type">Create a Trusted Type</a> algorithm, with the
following arguments:</p>
      <dl>
       <dt>policy
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a> 
       <dt>trustedTypeName
       <dd><code>"TrustedHTML"</code>
       <dt>value
       <dd>input
      </dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicy" data-dfn-type="method" data-export id="dom-trustedtypepolicy-createscript"><code>createScript(input)</code></dfn>
     <dd data-md>
      <p>Returns the
result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type" id="ref-for-abstract-opdef-create-a-trusted-type①">Create a Trusted Type</a> algorithm, with the
following arguments:</p>
      <dl>
       <dt>policy
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a> 
       <dt>trustedTypeName
       <dd><code>"TrustedScript"</code>
       <dt>value
       <dd>input
      </dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicy" data-dfn-type="method" data-export id="dom-trustedtypepolicy-createscripturl"><code>createScriptURL(input)</code></dfn>
     <dd data-md>
      <p>Returns the
result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type" id="ref-for-abstract-opdef-create-a-trusted-type②">Create a Trusted Type</a> algorithm, with the
following arguments:</p>
      <dl>
       <dt>policy
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a> 
       <dt>trustedTypeName
       <dd><code>"TrustedScriptURL"</code>
       <dt>value
       <dd>input
      </dl>
     <dt data-md><dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicy" data-dfn-type="method" data-export id="dom-trustedtypepolicy-createurl"><code>createURL(input)</code></dfn>
     <dd data-md>
      <p>Returns the
result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type" id="ref-for-abstract-opdef-create-a-trusted-type③">Create a Trusted Type</a> algorithm, with the
following arguments:</p>
      <dl>
       <dt>policy
       <dd><a href="https://dom.spec.whatwg.org/#context-object">context object</a> 
       <dt>trustedTypeName
       <dd><code>"TrustedURL"</code>
       <dt>value
       <dd>input
      </dl>
    </dl>
   </div>
   <h4 class="heading settled" data-level="2.3.3" id="trusted-type-policy-options"><span class="secno">2.3.3. </span><span class="content"><dfn class="css" data-dfn-type="type" data-export id="typedef-trustedtypepolicyoptions">TrustedTypePolicyOptions<a class="self-link" href="#typedef-trustedtypepolicyoptions"></a></dfn></span><a class="self-link" href="#trusted-type-policy-options"></a></h4>
   <p>This dictionary holds author-defined functions for converting string
values into trusted values. These functions do not create <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type②">Trusted Type</a> object instances directly - this behavior is provided by <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑦">TrustedTypePolicy</a></code>.</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-trustedtypepolicyoptions"><code><c- g>TrustedTypePolicyOptions</c-></code></dfn> {
   <a class="n" data-link-type="idl-name" href="#callbackdef-createhtmlcallback" id="ref-for-callbackdef-createhtmlcallback"><c- n>CreateHTMLCallback</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyOptions" data-dfn-type="dict-member" data-export data-type="CreateHTMLCallback? " id="dom-trustedtypepolicyoptions-createhtml"><code><c- g>createHTML</c-></code></dfn>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createscriptcallback" id="ref-for-callbackdef-createscriptcallback"><c- n>CreateScriptCallback</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyOptions" data-dfn-type="dict-member" data-export data-type="CreateScriptCallback? " id="dom-trustedtypepolicyoptions-createscript"><code><c- g>createScript</c-></code></dfn>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createurlcallback" id="ref-for-callbackdef-createurlcallback"><c- n>CreateURLCallback</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyOptions" data-dfn-type="dict-member" data-export data-type="CreateURLCallback? " id="dom-trustedtypepolicyoptions-createurl"><code><c- g>createURL</c-></code></dfn>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createscripturlcallback" id="ref-for-callbackdef-createscripturlcallback"><c- n>CreateScriptURLCallback</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypePolicyOptions" data-dfn-type="dict-member" data-export data-type="CreateScriptURLCallback? " id="dom-trustedtypepolicyoptions-createscripturl"><code><c- g>createScriptURL</c-></code></dfn>;
   <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑤"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="TrustedTypePolicyOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-trustedtypepolicyoptions-exposed"><code><c- g>exposed</c-></code></dfn> = <c- b>false</c->;
};
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-createhtmlcallback"><code><c- g>CreateHTMLCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑧"><c- b>DOMString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑨"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CreateHTMLCallback" data-dfn-type="argument" data-export id="dom-createhtmlcallback-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-createhtmlcallback-input"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-createscriptcallback"><code><c- g>CreateScriptCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⓪"><c- b>DOMString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CreateScriptCallback" data-dfn-type="argument" data-export id="dom-createscriptcallback-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-createscriptcallback-input"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-createurlcallback"><code><c- g>CreateURLCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString"><c- b>USVString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CreateURLCallback" data-dfn-type="argument" data-export id="dom-createurlcallback-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-createurlcallback-input"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-createscripturlcallback"><code><c- g>CreateScriptURLCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①"><c- b>USVString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①③"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="CreateScriptURLCallback" data-dfn-type="argument" data-export id="dom-createscripturlcallback-input"><code><c- g>input</c-></code><a class="self-link" href="#dom-createscripturlcallback-input"></a></dfn>);
</pre>
   <h4 class="heading settled" data-level="2.3.4" id="default-policy-hdr"><span class="secno">2.3.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-policy">Default policy</dfn></span><a class="self-link" href="#default-policy-hdr"></a></h4>
   <p><em>This section is not normative.</em></p>
   <p>One of the policies, the "default" policy, is special; while all other
policies have to be called explicitly to create a TrustedType object,
the default policy can also be called implicitly by the user agent. It
allows the application to define the rules that should be run as a
fallback, in case an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink⑦">injection sink</a> is passed a string (instead of a
Trusted Type object).</p>
   <p>This optional behavior allows for introducing Trusted Type <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①②">enforcement</a> to applications that are still using legacy code that writes to the DOM
(or calls <code>eval</code>) directly. Needless to say, this exposed policy should
necessarily be defined with very strict rules not to introduce a DOM
XSS vulnerability in unknown parts of the application. In an extreme
case, a lax, no-op default policy could bring the application DOM XSS
security posture back to the pre-Trusted Types level. If possible,
authors should resort to a default policy in a transitional period
only, use it to detect and rewrite "raw DOM writes" dependencies and
eventually phase out its usage entirely.</p>
   <p class="note" role="note"><span>Note:</span> See <a href="#get-trusted-type-compliant-string-algorithm">§3.2.2 Get Trusted Type compliant string</a> for details on how
the default policy is applied.</p>
   <h3 class="heading settled" data-level="2.4" id="enforcement"><span class="secno">2.4. </span><span class="content">Enforcement</span><a class="self-link" href="#enforcement"></a></h3>
   <p>This section describes how applications may require <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type③">Trusted Types</a> values for
their <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink⑧">injection sinks</a> via specifying a HTTP response header, and what
actions should be undertaken if a string value is used instead.</p>
   <p class="note" role="note"><span>Note:</span> Most of the enforcement rules are defined as modifications of the algorithms
in other specifiactions, see <a href="#integrations">§4 Integrations</a>.</p>
   <h4 class="heading settled" data-level="2.4.1" id="trusted-type-configuration-hdr"><span class="secno">2.4.1. </span><span class="content">TrustedTypeConfiguration</span><a class="self-link" href="#trusted-type-configuration-hdr"></a></h4>
   <p>A Trusted Type Configuration defines <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①③">enforcement</a> setting for <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type④">Trusted Types</a> and restrictions on policy names that can be applied
to a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code>.</p>
<pre class="idl highlight def"><c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-stringatsinkdisposition"><code><c- g>StringAtSinkDisposition</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="StringAtSinkDisposition" data-dfn-type="enum-value" data-export id="dom-stringatsinkdisposition-reject"><code><c- s>"reject"</c-></code><a class="self-link" href="#dom-stringatsinkdisposition-reject"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="StringAtSinkDisposition" data-dfn-type="enum-value" data-export id="dom-stringatsinkdisposition-report"><code><c- s>"report"</c-></code><a class="self-link" href="#dom-stringatsinkdisposition-report"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="StringAtSinkDisposition" data-dfn-type="enum-value" data-export id="dom-stringatsinkdisposition-unsafe-allow"><code><c- s>"unsafe-allow"</c-></code><a class="self-link" href="#dom-stringatsinkdisposition-unsafe-allow"></a></dfn>,
};

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-unknownpolicynamedisposition"><code><c- g>UnknownPolicyNameDisposition</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="UnknownPolicyNameDisposition" data-dfn-type="enum-value" data-export id="dom-unknownpolicynamedisposition-reject"><code><c- s>"reject"</c-></code><a class="self-link" href="#dom-unknownpolicynamedisposition-reject"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="UnknownPolicyNameDisposition" data-dfn-type="enum-value" data-export id="dom-unknownpolicynamedisposition-allow"><code><c- s>"allow"</c-></code><a class="self-link" href="#dom-unknownpolicynamedisposition-allow"></a></dfn>,
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-trustedtypeconfiguration"><code><c- g>TrustedTypeConfiguration</c-></code></dfn> {
  <a class="n" data-link-type="idl-name" href="#enumdef-unknownpolicynamedisposition" id="ref-for-enumdef-unknownpolicynamedisposition"><c- n>UnknownPolicyNameDisposition</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;allow&quot;" data-dfn-for="TrustedTypeConfiguration" data-dfn-type="dict-member" data-export data-type="UnknownPolicyNameDisposition " id="dom-trustedtypeconfiguration-unknownpolicyname"><code><c- g>unknownPolicyName</c-></code></dfn> = "allow";
  <a class="n" data-link-type="idl-name" href="#enumdef-stringatsinkdisposition" id="ref-for-enumdef-stringatsinkdisposition"><c- n>StringAtSinkDisposition</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypeConfiguration" data-dfn-type="dict-member" data-export data-type="StringAtSinkDisposition? " id="dom-trustedtypeconfiguration-domsinks"><code><c- g>domSinks</c-></code></dfn>;
  <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①④"><c- b>DOMString</c-></a>> <dfn class="dfn-paneled idl-code" data-dfn-for="TrustedTypeConfiguration" data-dfn-type="dict-member" data-export data-type="sequence<DOMString> " id="dom-trustedtypeconfiguration-allowednames"><code><c- g>allowedNames</c-></code></dfn>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑤"><c- b>DOMString</c-></a> <dfn class="dfn-paneled idl-code" data-default="&quot;default&quot;" data-dfn-for="TrustedTypeConfiguration" data-dfn-type="dict-member" data-export data-type="DOMString " id="dom-trustedtypeconfiguration-reportinggroup"><code><c- g>reportingGroup</c-></code></dfn> = "default";
};
</pre>
   <p>Each Trusted Type Configuration has an associated <code class="idl"><a data-link-type="idl" href="#enumdef-stringatsinkdisposition" id="ref-for-enumdef-stringatsinkdisposition①">string at sink disposition</a></code> (for all DOM sinks).
It is either “reject”, “report” or “unsafe-allow”.</p>
   <p>Each Trusted Type Configuration has an associated <code class="idl"><a data-link-type="idl" href="#enumdef-unknownpolicynamedisposition" id="ref-for-enumdef-unknownpolicynamedisposition①">unknown policy name disposition</a></code>,
which is either “reject” or “allow”.</p>
   <p>Each Trusted Type Configuration has an associated allowed policy names set.</p>
   <p>Each Trusted Type Configuration has a related reporting group name.</p>
   <p class="issue" id="issue-d8483bad"><a class="self-link" href="#issue-d8483bad"></a> Decide if it should be possible from JS to determine if types are enforced without resorting to <code>try {} catch</code>. <a href="https://github.com/WICG/trusted-types/issues/36">&lt;https://github.com/WICG/trusted-types/issues/36></a></p>
   <h4 class="heading settled" data-level="2.4.2" id="trusted-types-http-header"><span class="secno">2.4.2. </span><span class="content"><dfn data-dfn-type="http-header" data-export id="http-headerdef-trusted-types">Trusted-Types<a class="self-link" href="#http-headerdef-trusted-types"></a></dfn> HTTP Response Header</span><a class="self-link" href="#trusted-types-http-header"></a></h4>
   <p class="issue" id="issue-f6daf6e4"><a class="self-link" href="#issue-f6daf6e4"></a> In the current Chromium implementation, the enforcement mechanism is
configured in the <code>Content-Security-Policy</code> header (instead of <code>Trusted-Types</code>), with slightly different syntax. See <a href="https://github.com/WICG/trusted-types#limiting-policies">explainer</a> and <a href="https://github.com/web-platform-tests/wpt/tree/master/trusted-types">platform test files</a>. <a href="https://github.com/WICG/trusted-types/issues/1">&lt;https://github.com/WICG/trusted-types/issues/1></a></p>
   <p class="issue" id="issue-559d4710"><a class="self-link" href="#issue-559d4710"></a> +mkwst The header does not appear in the origin trials.  Can
the spec differ so much from the implementation, especially given the
upcoming Origin Trials?</p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="trusted-types-http-response-header">Trusted-Types HTTP response header</dfn> instructs the user agent
to apply a particular configuration of the Trusted Types framework to
the document created from a given response. Specifically, the header
value defines which policies (identified by name) can be created by
the application, and what should be the behavior when a string value
is passed to an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink⑨">injection sink</a> (e.g. should the type-based enforcement be
enabled, or whether to attempt implicit conversion with a default
policy).</p>
   <p>The header value is a serialized Trusted Types configuration
represented by the following ANBF:</p>
<pre class="highlight"><c- nc>TRUSTEDTYPES</c-> <c- o>=</c-> <c- nc>json-field-value</c->
</pre>
   <p>The header’s value is interpreted as a JSON-formatted array of values
without the outer <code>[</code> and <code>]</code>, as described in Section 4 of <a data-link-type="biblio" href="#biblio-http-jfv">[HTTP-JFV]</a>.</p>
   <p class="note" role="note"><span>Note:</span> The header syntax is tailored to making a secure configuration
simple, while allowing explicit change towards less strict
configurations possible.</p>
   <div class="example" id="whitelist-of-policy-names-in-header">
    <a class="self-link" href="#whitelist-of-policy-names-in-header"></a> Types are enforced at sinks, and only policies name “one” and “two”
may be created. 
<pre class="http">Trusted-Types: "one", "two"
</pre>
   </div>
   <div class="example" id="header-that-allows-no-policy-names">
    <a class="self-link" href="#header-that-allows-no-policy-names"></a> A value of <code>null</code> indicates policies may not be created, and sinks are
enforced.  I.e. no <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①⓪">injection sinks</a> can be used in a document. 
<pre class="http">Trusted-Types: null
</pre>
   </div>
   <p>A policy named <code>"*"</code> makes it possible to create policies with any
previously unused name.</p>
   <div class="example" id="wildcard-policy-name-in-header">
    <a class="self-link" href="#wildcard-policy-name-in-header"></a> 
<pre class="http">Trusted-Types: "*"
</pre>
   </div>
   <p>If the policy named <code>“default”</code> is present in the list, it refers to the <a data-link-type="dfn" href="#default-policy" id="ref-for-default-policy">default policy</a>, and unless otherwise configured,
all strings passed to <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①①">injection sinks</a> will be passed through it instead
of being rejected outright.</p>
   <div class="example" id="default-in-header">
    <a class="self-link" href="#default-in-header"></a> 
<pre class="http">Trusted-Types: "one", "two", "default"
</pre>
   </div>
   <p>To specify more fine-grained control over the enforcement, authors can
use a header value that is an object. That object allows for configuring the
enforcement for the <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①②">injection sinks</a>.</p>
   <div class="example" id="complex configuration-in-header">
    <a class="self-link" href="#complex%20configuration-in-header"></a> Only reports violations in <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①③">injection sinks</a>, but allow strings passed to them
(similar to Content-Security-Policy-Report-Only). 
<pre class="http" id="string-at-sink-disposition-in-header">Trusted-Types: "*", {"dom”: "unsafe-allow"}
</pre>
    <p>Report violations using a “trustedtypes” reporting group.</p>
<pre class="http" id="reporting-group-in-header">Trusted-Types: "*", {"report": "trustedtypes"}
</pre>
    <p>Explicitly specify that a string passed to an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①④">injection sink</a> requiring
any Trusted Type should be rejected.  This is the default behavior if the
header is present.</p>
<pre class="http" id="unknown-policy-name-disposition-in-header">Trusted-Types: "*", {"dom": "reject"}
</pre>
   </div>
   <p class="issue" id="issue-20410262"><a class="self-link" href="#issue-20410262"></a> Decide if separate per-type enforcement settings should be exposed to the authors. <a href="https://github.com/WICG/trusted-types/issues/66">&lt;https://github.com/WICG/trusted-types/issues/66></a></p>
   <p class="issue" id="issue-cd9bcfb2"><a class="self-link" href="#issue-cd9bcfb2"></a> it seems to be the case that one object is allowed and it should
appear last, it cannot contain an allowedNames property and the allowedNames
set should be the string values.  Clarify.</p>
   <p class="issue" id="issue-7d9c4dc9"><a class="self-link" href="#issue-7d9c4dc9"></a> maybe treat a string as a configuration that is equivalent to a
configuration that allows just that name and which has the default values
for the other properties and allow <code>{"allowedNames":[...],...}</code>.
This would enable a use case where migrating one tool at a time by having
some policies that are report-only and others that are enforced.</p>
   <p class="issue" id="issue-e1f7a37a"><a class="self-link" href="#issue-e1f7a37a"></a> if so, need example of 2 disjoint allowed name sets with different
configurations.</p>
   <p class="issue" id="issue-ba779f5f"><a class="self-link" href="#issue-ba779f5f"></a> what happens if there are 2 configurations with overlapping
allowed name sets?</p>
   <p class="issue" id="issue-e5fdd885"><a class="self-link" href="#issue-e5fdd885"></a> does a single configuration with an unknown policy name disposition
of "allow" govern all policy names that appear in no other configuratons.</p>
   <h4 class="heading settled" data-level="2.4.3" id="violation"><span class="secno">2.4.3. </span><span class="content">Violation</span><a class="self-link" href="#violation"></a></h4>
   <p>A violation represents an action which is disallowed by the <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration①">TrustedTypeConfiguration</a></code> objects associated with the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document②">Document</a></code>.</p>
   <p class="issue" id="issue-d1310019"><a class="self-link" href="#issue-d1310019"></a> how does this relate to webappsec-csp/<a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#violation" id="ref-for-violation">Violation</a>?</p>
   <p class="issue" id="issue-cf1ff51c"><a class="self-link" href="#issue-cf1ff51c"></a> TODO: Describe the properties of the violation
Each violation has a configuration , which is a Trusted Type Configuration.
Each violation has a global object , which is a global object.</p>
   <p class="issue" id="issue-621e48db"><a class="self-link" href="#issue-621e48db"></a> TODO(mkwst): How to serialize? CSP3 has no serialization defined for
the violation object, although reporting assumes the object should be
serializable.</p>
   <h4 class="heading settled" data-level="2.4.4" id="reporting"><span class="secno">2.4.4. </span><span class="content">Reporting</span><a class="self-link" href="#reporting"></a></h4>
   <p class="issue" id="issue-de6065a2"><a class="self-link" href="#issue-de6065a2"></a> How does a policy violation get reported (both at the sink
level, and when creating a policy).</p>
   <h2 class="heading settled" data-level="3" id="algorithms"><span class="secno">3. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
   <h3 class="heading settled" data-level="3.1" id="policy-algorithms"><span class="secno">3.1. </span><span class="content">Policies</span><a class="self-link" href="#policy-algorithms"></a></h3>
   <h4 class="heading settled" data-level="3.1.1" id="initialize-policy-factory-algorithm"><span class="secno">3.1.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-initialize-policy-factory">Initialize policy factory</dfn></span><a class="self-link" href="#initialize-policy-factory-algorithm"></a></h4>
   <p>To initialize a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory">Trusted Type Factory</a></code> with a <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration②">TrustedTypeConfiguration</a></code> run these steps:</p>
   <ol>
    <li data-md>
     <p>Let <em>factory</em> be a new <code class="idl"><a data-link-type="idl" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory①">TrustedTypePolicyFactory</a></code> object, with an empty <code>[[PolicyMap]]</code> map.</p>
    <li data-md>
     <p>Set the <em>factory</em>'s <code>[[Configuration]]</code> internal slot to <em>configuration</em>.</p>
    <li data-md>
     <p>Return <em>factory</em>.</p>
   </ol>
   <p class="issue" id="issue-281b8e3f"><a class="self-link" href="#issue-281b8e3f"></a> does configuration need to be defensively copied.</p>
   <h4 class="heading settled" data-level="3.1.2" id="create-trusted-type-policy-algorithm"><span class="secno">3.1.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-create-a-trusted-type-policy">Create a Trusted Type Policy</dfn></span><a class="self-link" href="#create-trusted-type-policy-algorithm"></a></h4>
   <p>To create a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑧">TrustedTypePolicy</a></code> in a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory②">factory</a></code>,
given a DOMString (<em>policyName</em>), policy options dictionary (<em>options</em>)
and exposed flag (<em>exposed</em>), run these steps:</p>
   <ol>
    <li data-md>
     <p>If <em>factory</em>'s <code>[[PolicyMap]]</code> internal slot has an entry with the key <code>policyName</code>, then throw a <em>TypeError</em>.</p>
    <li data-md>
     <p>Let <em>policyAllowed</em> be the result of running <a data-link-type="abstract-op" href="#abstract-opdef-is-policy-name-allowed" id="ref-for-abstract-opdef-is-policy-name-allowed">Is policy name allowed</a> algorithm.</p>
    <li data-md>
     <p>If <em>policyAllowed</em> is False, throw a <em>TypeError</em>.</p>
    <li data-md>
     <p>If <a data-link-type="abstract-op" href="#abstract-opdef-is-a-default-policy" id="ref-for-abstract-opdef-is-a-default-policy">Is a default policy</a> algorithm returns True and <em>exposed</em> is False, then
throw a <em>TypeError</em>.</p>
    <li data-md>
     <p>Let <em>policy</em> be a new <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑨">TrustedTypePolicy</a></code> object.</p>
    <li data-md>
     <p>Set policy’s <code>name</code> property value to <em>policyName</em>.</p>
    <li data-md>
     <p>Let <em>policyOptions</em> be a new <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypepolicyoptions" id="ref-for-dictdef-trustedtypepolicyoptions③">TrustedTypePolicyOptions</a></code> object.</p>
    <li data-md>
     <p>Set <em>policyOptions</em> <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createhtml" id="ref-for-dom-trustedtypepolicy-createhtml②">createHTML</a></code> property to <em>option</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyoptions-createhtml" id="ref-for-dom-trustedtypepolicyoptions-createhtml">createHTML</a></code> property value.</p>
    <li data-md>
     <p>Set <em>policyOptions</em> <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createscript" id="ref-for-dom-trustedtypepolicy-createscript②">createScript</a></code> property to <em>option</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyoptions-createscript" id="ref-for-dom-trustedtypepolicyoptions-createscript">createScript</a></code> property value.</p>
    <li data-md>
     <p>Set <em>policyOptions</em> <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createscripturl" id="ref-for-dom-trustedtypepolicy-createscripturl②">createScriptURL</a></code> property to <em>option</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyoptions-createscripturl" id="ref-for-dom-trustedtypepolicyoptions-createscripturl">createScriptURL</a></code> property value.</p>
    <li data-md>
     <p>Set <em>policyOptions</em> <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicy-createurl" id="ref-for-dom-trustedtypepolicy-createurl②">createURL</a></code> property to <em>option</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyoptions-createurl" id="ref-for-dom-trustedtypepolicyoptions-createurl">createURL</a></code> property value.</p>
    <li data-md>
     <p>Set <em>policy</em>'s <code>[[options]]</code> internal slot value to <em>policyOptions</em>.</p>
    <li data-md>
     <p>Set the value for the <em>policyName</em> entry of <em>factory</em>'s <code>[[PolicyMap]]</code> to <em>policy</em>.</p>
    <li data-md>
     <p>Return <em>policy</em>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.3" id="get-exposed-policy-algorithm"><span class="secno">3.1.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-get-exposed-policy">Get exposed policy</dfn></span><a class="self-link" href="#get-exposed-policy-algorithm"></a></h4>
   <ol>
    <li data-md>
     <p>Let <em>policyName</em> and <em>factory</em> be the same variables as those of
the same name in the algorithm that invoked these steps.</p>
    <li data-md>
     <p>If <em>factory</em>'s <code>[[PolicyMap]]</code> internal slot does not have an entry
with the key <em>policyName</em>, return null.</p>
    <li data-md>
     <p>Otherwise, let <em>policy</em> be the value of the <em>policyName</em> entry of <em>factory</em>'s <code>[[PolicyMap]]</code>.</p>
    <li data-md>
     <p>If <em>policy</em>'s <code>[[options]]</code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypepolicyoptions-exposed" id="ref-for-dom-trustedtypepolicyoptions-exposed">exposed</a></code> attribute is false,
return null.</p>
    <li data-md>
     <p>Return <em>policy</em>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.4" id="get-default-policy-algorithm"><span class="secno">3.1.4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-get-default-policy">Get default policy</dfn></span><a class="self-link" href="#get-default-policy-algorithm"></a></h4>
    To get the <a data-link-type="dfn" href="#default-policy" id="ref-for-default-policy①">default policy</a> for a <em>factory</em>, execute the following steps: 
   <ol>
    <li data-md>
     <p>Set <em>policyName</em> to <code>"default"</code>.</p>
    <li data-md>
     <p>Return the result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-get-exposed-policy" id="ref-for-abstract-opdef-get-exposed-policy①">Get exposed policy</a> algorithm.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.5" id="is-policy-name-allow-algorithm"><span class="secno">3.1.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-is-policy-name-allowed">Is policy name allowed</dfn></span><a class="self-link" href="#is-policy-name-allow-algorithm"></a></h4>
   <p>Let <em>policyName</em> and <em>factory</em> be the same variables as those of the
same name in the algorithm that invoked these steps.</p>
   <ol>
    <li data-md>
     <p>Let <em>configuration</em> be the value of <em>factory</em>'s internal <code>[[Configuration]]</code> slot.</p>
    <li data-md>
     <p>If <em>configuration</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-unknownpolicyname" id="ref-for-dom-trustedtypeconfiguration-unknownpolicyname">unknownPolicyName</a></code>'s
is <code>"allow"</code>, return true.</p>
    <li data-md>
     <p>Otherwise, if <em>factory</em>'s <code>[[Configuration]]</code>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-allowednames" id="ref-for-dom-trustedtypeconfiguration-allowednames">allowedNames</a></code> set
contains <em>policyName</em>, return true.</p>
    <li data-md>
     <p>Return false.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.6" id="is-default-policy-algorithm"><span class="secno">3.1.6. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-is-a-default-policy">Is a default policy</dfn></span><a class="self-link" href="#is-default-policy-algorithm"></a></h4>
   <p>Let <em>policyName</em> be the same variable as that of the same name in the
algorithm that invoked these steps.</p>
   <ol>
    <li data-md>
     <p>If <em>policyName</em> equals <code>"default"</code>, return true.</p>
    <li data-md>
     <p>Otherwise, return false.</p>
   </ol>
   <h4 class="heading settled" data-level="3.1.7" id="create-a-trusted-type-algorithm"><span class="secno">3.1.7. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-create-a-trusted-type">Create a Trusted Type</dfn></span><a class="self-link" href="#create-a-trusted-type-algorithm"></a></h4>
   <p>Given a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy①⓪">TrustedTypePolicy</a></code> <em>policy</em>, a type name <em>trustedTypeName</em>,
and a string <em>value</em>, execute the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <em>functionName</em> be a function name for the given <em>trustedTypeName</em>,
based on the following table:</p>
     <table>
      <tbody>
       <tr>
        <th>Function name
        <th>Trusted Type name 
       <tr>
        <td>"createHTML"
        <td>"TrustedHTML"
       <tr>
        <td>"createScript"
        <td>"TrustedScript"
       <tr>
        <td>"createScriptURL"
        <td>"TrustedScriptURL"
       <tr>
        <td>"createURL"
        <td>"TrustedURL"
     </table>
    <li data-md>
     <p>Let <em>options</em> be the value of <em>policy</em>'s <code>[[options]]</code> slot.</p>
    <li data-md>
     <p>Let <em>function</em> be the value of the property in <em>options</em> named <em>functionName</em>.</p>
    <li data-md>
     <p>If <em>function</em> is null, throw a <em>TypeError</em>.</p>
    <li data-md>
     <p>Let <em>policyValue</em> be the result of invoking <em>function</em> with <em>value</em> as a first argument, and <a href="https://tc39.github.io/ecma262/#sec-method">callback **this** value</a> set to null.</p>
    <li data-md>
     <p>If <em>policyValue</em> is an error, return <em>policyValue</em> and abort the following steps.</p>
    <li data-md>
     <p>Let <em>dataString</em> be the result of stringifying <em>policyValue</em>.</p>
    <li data-md>
     <p>Let <em>trustedObject</em> be a new instance of an interface with a type
name <em>trustedTypeName</em>, with its <code>[[Data]]</code> internal slot value
set to <em>dataString</em>.</p>
    <li data-md>
     <p>Return <em>trustedObject</em>.</p>
   </ol>
   <h3 class="heading settled" data-level="3.2" id="enforcement-algorithms"><span class="secno">3.2. </span><span class="content">Enforcement</span><a class="self-link" href="#enforcement-algorithms"></a></h3>
   <h4 class="heading settled" data-level="3.2.1" id="obtain-a-trusted-type-configuration-for-a-response-algorithm"><span class="secno">3.2.1. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">Obtain a Trusted Type Configuration for a response</dfn></span><a class="self-link" href="#obtain-a-trusted-type-configuration-for-a-response-algorithm"></a></h4>
   <p>This algorithm parses the <a data-link-type="dfn" href="#trusted-types-http-response-header" id="ref-for-trusted-types-http-response-header①">Trusted-Types HTTP Response Header</a> from
the response as a <a data-link-type="biblio" href="#biblio-http-jfv">[HTTP-JFV]</a> value and creates a configuration
object.  The header value consists of a list of values.
Every string value is assumed to be an <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-allowednames" id="ref-for-dom-trustedtypeconfiguration-allowednames①">allowed policy name</a></code>,
and the presence of the header by default <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①④">enforces</a> the types at every sink type.</p>
   <p>Given a <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response">Response</a></code> (<em>response</em>), perform the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <em>config</em> be a new <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration③">TrustedTypeConfiguration</a></code>.</p>
    <li data-md>
     <p>Let <em>defaultSinkDisposition</em> be <code>“unsafe-allow”</code>.</p>
    <li data-md>
     <p>Let <em>hasWildcardPolicy</em> be true</p>
    <li data-md>
     <p>Let <em>header</em> be the value of the header in <em>response</em>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a> whose name is <code>“Trusted-Types”</code></p>
    <li data-md>
     <p>Let <em>list</em> be the result of executing the algorithm defined in
Section 4 of <a data-link-type="biblio" href="#biblio-http-jfv">[HTTP-JFV]</a> on <em>header</em>. If that algorithm results
in an error, abort these steps.</p>
     <p class="issue" id="issue-6648a1f5"><a class="self-link" href="#issue-6648a1f5"></a> A trailing comma should not disable enforcement.  Do we
need to leave the document in a locked down state?
Maybe set <em>config</em>.domSinks to "reject" and return <em>config</em>.</p>
    <li data-md>
     <p>If <em>list</em> is not empty, then set <em>hasWildcardPolicy</em> to false and set
defaultSinkDisposition to <code>“reject”</code>.</p>
    <li data-md>
     <p>For each <em>item</em> in <em>list</em>:</p>
     <ol>
      <li data-md>
       <p>If <em>item</em> is a <a href="https://tools.ietf.org/html/rfc8259#section-7">string</a> :</p>
       <ol>
        <li data-md>
         <p>If <em>item</em> is equal to <code>“*”</code>, then set <em>hasWildcardPolicy</em> to true.</p>
        <li data-md>
         <p>Otherwise, add <em>item</em> to <em>config</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-allowednames" id="ref-for-dom-trustedtypeconfiguration-allowednames②">allowedNames</a></code> set.</p>
       </ol>
      <li data-md>
       <p>Otherwise, if <em>item</em> is an <a href="https://tools.ietf.org/html/rfc8259#section-4">object</a>,
for each <em>name</em> → <em>value</em> of item, execute the following steps:</p>
       <ol>
        <li data-md>
         <p>Let <em>propertyName</em> be the result of running ASCII lowercase on name.</p>
        <li data-md>
         <p>Execute the first statement, switching on <em>propertyName</em>:</p>
         <ol>
          <li data-md>
           <p>case <code>“dom”</code>:
If value is a valid <code class="idl"><a data-link-type="idl" href="#enumdef-stringatsinkdisposition" id="ref-for-enumdef-stringatsinkdisposition②">StringAtSinkDisposition</a></code>, set <em>defaultSinkDisposition</em> to that value. Otherwise, throw
an error.</p>
          <li data-md>
           <p>case <code>“report”</code>:
If value is a <a href="https://tools.ietf.org/html/rfc8259#section-7">string</a>,
set <em>config</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-reportinggroup" id="ref-for-dom-trustedtypeconfiguration-reportinggroup">reportingGroup</a></code> to that value.
Otherwise, throw an error.</p>
          <li data-md>
           <p>Otherwise, continue.</p>
         </ol>
       </ol>
      <li data-md>
       <p>Otherwise, throw an error.</p>
     </ol>
    <li data-md>
     <p>If <em>hasWildcardPolicy</em> is false, then set <em>config</em>'s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-unknownpolicyname" id="ref-for-dom-trustedtypeconfiguration-unknownpolicyname①">unknownPolicyName</a></code> to <code>“reject”</code>.</p>
    <li data-md>
     <p>If <em>config</em>’s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-domsinks" id="ref-for-dom-trustedtypeconfiguration-domsinks">domSinks</a></code> is null,
set <em>config</em>’s domSinks to <em>defaultSinkDisposition</em>’s value.</p>
    <li data-md>
     <p>Return <em>config</em>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.2" id="get-trusted-type-compliant-string-algorithm"><span class="secno">3.2.2. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-get-trusted-type-compliant-string">Get Trusted Type compliant string</dfn></span><a class="self-link" href="#get-trusted-type-compliant-string-algorithm"></a></h4>
   <p>This algorithm will return a string that can be assigned to a DOM <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①⑤">injection sink</a>, optionally unwrapping it from a matching <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type⑤">Trusted Type</a>.
It will ensure that the Trusted Type <a data-link-type="dfn" href="#enforcement①" id="ref-for-enforcement①⑤">enforcement</a> rules were respected.</p>
   <p>Given a TrustedType type (<em>expectedType</em>), a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document③">Document</a></code> (<em>document</em>), a <code class="idl"><a data-link-type="idl" href="#typedefdef-trustedtype" id="ref-for-typedefdef-trustedtype">TrustedType</a></code> (<em>input</em>), and a boolean
(<em>passThroughFunctions</em>) run these steps:</p>
   <p class="issue" id="issue-27865f4d"><a class="self-link" href="#issue-27865f4d"></a> <em>input</em> could also be a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function">Function</a></code>, e.g. for <code>setTimeout</code>.  Maybe add <code>or Function</code> to <code>ScriptString</code> and rename to avoid confusion.</p>
   <p class="issue" id="issue-5437ea14"><a class="self-link" href="#issue-5437ea14"></a> Make it clear that no reporting is done when <em>disposition</em> is <code>unsafe-allow</code>.</p>
   <p class="issue" id="issue-e10bac35"><a class="self-link" href="#issue-e10bac35"></a> In step 1, refer to the internal slot in Document or the IDL additions to document that store the configuration.</p>
   <ol>
    <li data-md>
     <p>Let <em>disposition</em> be <em>document</em>’s TrustedTypeConfiguration’s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-domsinks" id="ref-for-dom-trustedtypeconfiguration-domsinks①">domSinks</a></code>.</p>
    <li data-md>
     <p>If <em>disposition</em> is <code>“unsafe-allow”</code>, then run these steps:</p>
     <ol>
      <li data-md>
       <p>If <em>passThroughFunctions</em> is true and <em>input</em> is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function①">Function</a></code>,
return <em>input</em> and abort these steps.</p>
      <li data-md>
       <p>Otherwise, return stringified <em>input</em> and abort these steps.</p>
     </ol>
    <li data-md>
     <p>If <em>input</em> has type <em>expectedType</em>, return stringified <em>input</em> and abort these steps.</p>
    <li data-md>
     <p>If <em>passThroughFunctions</em> is true and <em>input</em> is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function②">Function</a></code>,
return input and abort these steps.</p>
    <li data-md>
     <p>Otherwise, execute the following steps:</p>
     <ol>
      <li data-md>
       <p>Let <em>defaultPolicy</em> be the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-get-default-policy" id="ref-for-abstract-opdef-get-default-policy">Get default policy</a> algorithm on <em>document</em>’s <a href="https://www.w3.org/TR/html5/#concept-document-bc">browsing context</a>'s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window">Window</a></code> object.</p>
      <li data-md>
       <p>If <em>defaultPolicy</em> is null, abort these steps.</p>
       <p class="issue" id="issue-90794f3a"><a class="self-link" href="#issue-90794f3a"></a> Do we need some "resume below" language?</p>
      <li data-md>
       <p>Let <em>convertedInput</em> be the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-create-a-trusted-type" id="ref-for-abstract-opdef-create-a-trusted-type④">Create a
Trusted Type</a> algorithm, with the following arguments:</p>
       <ul>
        <li data-md>
         <p><em>defaultPolicy</em> as <em>policy</em></p>
        <li data-md>
         <p><em>input</em> as <em>value</em></p>
        <li data-md>
         <p><em>expectedType</em>’s type name as <em>trustedTypeName</em></p>
       </ul>
      <li data-md>
       <p>If <em>convertedInput</em> is an error, then return error and abort the following steps.</p>
      <li data-md>
       <p>If <em>convertedInput</em> has type <em>expectedType</em>, then return
stringified <em>convertedInput</em> and abort the following steps.</p>
      <li data-md>
       <p>If <em>passThroughFunctions</em> is true and <em>convertedInput</em> is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function③">Function</a></code>, then return <em>convertedInput</em> and abort the
following steps.</p>
      <li data-md>
       <p>Set <em>input</em> to <em>convertedInput</em>’s value.</p>
     </ol>
    <li data-md>
     <p>Execute <a data-link-type="abstract-op" href="#abstract-opdef-report-sink-type-mismatch-violation" id="ref-for-abstract-opdef-report-sink-type-mismatch-violation">Report sink type mismatch violation</a> algorithm.</p>
    <li data-md>
     <p>If <em>disposition</em> is <code>“report”</code>, then return stringified <em>input</em> and abort these steps.</p>
    <li data-md>
     <p>Throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-typeerror" id="ref-for-exceptiondef-typeerror">TypeError</a></code>.</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.3" id="enforce-a-trusted-type-algorithm"><span class="secno">3.2.3. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-enforce-a-trusted-type">Enforce a Trusted Type</dfn></span><a class="self-link" href="#enforce-a-trusted-type-algorithm"></a></h4>
   <p class="note" role="note"><span>Note:</span> <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="enforcement①">enforcement</dfn> is the process of checking that a value
has an appropriate type before it reaches an <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①⑥">injection sink</a>.</p>
   <p>Enforce a Trusted Type algorithm describes a modification to the <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①⑦">injection sinks</a>,
asserting that the input meets <a data-link-type="dfn" href="#trusted-type" id="ref-for-trusted-type⑥">Trusted Type</a> restrictions set for the current <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document④">Document</a></code>.  It accepts an input
value that the original function would and will optionally
pass-through to the original function -- all original arguments to the
function apart from input are passed through without modification.</p>
   <ol>
    <li data-md>
     <p>Let <em>compliantValue</em> be the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string">Get Trusted Type
compliant string</a> algorithm with</p>
     <ul>
      <li data-md>
       <p><em>document</em> being the current <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑤">Document</a></code></p>
      <li data-md>
       <p><em>input</em> being the new attribute value</p>
      <li data-md>
       <p><em>passThroughFunctions</em> being false, and</p>
      <li data-md>
       <p><em>expectedType</em> being the entry in the following table based on the sink type:</p>
     </ul>
     <table border="1">
      <tbody>
       <tr>
        <th>Sink parameter type
        <th><em>expectedType</em>
       <tr>
        <td><code class="idl"><a data-link-type="idl" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring">HTMLString</a></code>
        <td><code class="idl"><a data-link-type="idl" href="#trustedhtml" id="ref-for-trustedhtml③">TrustedHTML</a></code>
       <tr>
        <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scriptstring" id="ref-for-typedefdef-scriptstring">ScriptString</a></code>
        <td><code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript②">TrustedScript</a></code>
       <tr>
        <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scripturlstring" id="ref-for-typedefdef-scripturlstring">ScriptURLString</a></code>
        <td><code class="idl"><a data-link-type="idl" href="#trustedscripturl" id="ref-for-trustedscripturl②">TrustedScriptURL</a></code>
       <tr>
        <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring">URLString</a></code>
        <td><code class="idl"><a data-link-type="idl" href="#trustedurl" id="ref-for-trustedurl②">TrustedURL</a></code>
     </table>
    <li data-md>
     <p>If the previous algorithm throws an exception, rethrow the exception,
and abort these steps.</p>
     <p class="issue" id="issue-bb8c9be7"><a class="self-link" href="#issue-bb8c9be7"></a> can we use "<em>compliantValue</em> is an error" language here?</p>
    <li data-md>
     <p>Execute the original function with <em>compliantValue</em> instead of the
original value.  If the original functions accepts other
arguments, pass-them through to the original function.  Return the
result.</p>
   </ol>
   <h4 class="heading settled" data-level="3.2.4" id="create-a-violation-for-algorithm"><span class="secno">3.2.4. </span><span class="content"><dfn data-dfn-type="abstract-op" data-export id="abstract-opdef-create-a-violation-for">Create a Violation for<a class="self-link" href="#abstract-opdef-create-a-violation-for"></a></dfn></span><a class="self-link" href="#create-a-violation-for-algorithm"></a></h4>
   <p class="issue" id="issue-d9f0b628"><a class="self-link" href="#issue-d9f0b628"></a> TODO: write and link to it</p>
   <h4 class="heading settled" data-level="3.2.5" id="report-sink-type-mismatch-violation-algorithm"><span class="secno">3.2.5. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export id="abstract-opdef-report-sink-type-mismatch-violation">Report sink type mismatch violation</dfn></span><a class="self-link" href="#report-sink-type-mismatch-violation-algorithm"></a></h4>
   <p class="issue" id="issue-d66da75e"><a class="self-link" href="#issue-d66da75e"></a> Check that this algorithm is complete.</p>
   <p>Given a <a href="#violation">violation</a> (<em>violation</em>), this algorithm reports
it to the <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-reportinggroup" id="ref-for-dom-trustedtypeconfiguration-reportinggroup①">endpoint</a></code> specified in the violation’s <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration④">configuration
object</a></code>.</p>
   <ol>
    <li data-md>
     <p>Enqueue a task to run the following steps:</p>
     <ol>
      <li data-md>
       <p>Let <em>group</em> be <em>violation</em>’s configuration’s <code class="idl"><a data-link-type="idl" href="#dom-trustedtypeconfiguration-reportinggroup" id="ref-for-dom-trustedtypeconfiguration-reportinggroup②">reportingGroup</a></code>.</p>
      <li data-md>
       <p>Let <em>settings</em> be <em>violation</em>’s <a href="https://www.w3.org/TR/CSP3/#violation-global-object">global object</a>’s
relevant settings object.</p>
      <li data-md>
       <p>Execute <a href="https://wicg.github.io/reporting/#queue-report">Queue data as type for endpoint group on settings algorith</a> with the following arguments:</p>
       <ul>
        <li data-md>
         <p><em>data</em> = violation</p>
        <li data-md>
         <p><em>type</em> = <code>“trusted-types”</code></p>
        <li data-md>
         <p><em>endpoint group</em> = <em>group</em></p>
        <li data-md>
         <p><em>settings</em> = <em>settings</em></p>
       </ul>
       <p class="note" role="note"><span>Note:</span> The optional <em>url</em> parameter is not provided.</p>
     </ol>
   </ol>
   <h2 class="heading settled" data-level="4" id="integrations"><span class="secno">4. </span><span class="content">Integrations</span><a class="self-link" href="#integrations"></a></h2>
<pre class="idl highlight def"><c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑥"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml④"><c- n>TrustedHTML</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-htmlstring"><code><c- g>HTMLString</c-></code></dfn>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑦"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript③"><c- n>TrustedScript</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-scriptstring"><code><c- g>ScriptString</c-></code></dfn>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString②"><c- b>USVString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl③"><c- n>TrustedScriptURL</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-scripturlstring"><code><c- g>ScriptURLString</c-></code></dfn>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString③"><c- b>USVString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl③"><c- n>TrustedURL</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-urlstring"><code><c- g>URLString</c-></code></dfn>;
<c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml⑤"><c- n>TrustedHTML</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript④"><c- n>TrustedScript</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl④"><c- n>TrustedScriptURL</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl④"><c- n>TrustedURL</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-trustedtype"><code><c- g>TrustedType</c-></code></dfn>;
</pre>
   <h3 class="heading settled" data-level="4.1" id="integration-with-html"><span class="secno">4.1. </span><span class="content">Integration with HTML</span><a class="self-link" href="#integration-with-html"></a></h3>
   <p><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window①">Window</a></code> objects have a <code class="idl"><a data-link-type="idl" href="#dom-window-trustedtypes" id="ref-for-dom-window-trustedtypes">trusted type policy factory</a></code>,
which is a <code class="idl"><a data-link-type="idl" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory③">TrustedTypePolicyFactory</a></code> object.</p>
   <p><code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑥">Document</a></code> objects have a trusted type configuration,
which is a <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration⑤">TrustedTypeConfiguration</a></code> object.</p>
   <h4 class="heading settled" data-level="4.1.1" id="initialize-a-documents-trusted-type-configuration-algorithm"><span class="secno">4.1.1. </span><span class="content"><dfn data-dfn-type="abstract-op" data-export id="abstract-opdef-initialize-a-documents-trusted-type-configuration-algorithm">Initialize a Document’s trusted type configuration algorithm<a class="self-link" href="#abstract-opdef-initialize-a-documents-trusted-type-configuration-algorithm"></a></dfn></span><a class="self-link" href="#initialize-a-documents-trusted-type-configuration-algorithm"></a></h4>
   <p>This algorithm should be executed during the <a href="https://www.w3.org/TR/html5/#initialise-the-document-object">Initializing a new Document
object</a> algorithm.</p>
   <p>Given a <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑦">Document</a></code> (<em>document</em>), a <a href="https://www.w3.org/TR/html5/#concept-document-bc">browsing context</a> (<em>browsingContext</em>) and
a <a href="https://fetch.spec.whatwg.org/#response-class">response</a> (<em>response</em>), the user agent performs the
following steps in order to initialize <a href="#integration-with-html">*document*'s TrustedTypePolicyConfiguration</a>:</p>
   <ol>
    <li data-md>
     <p>Let <em>configuration</em> be the result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-obtain-a-trusted-type-configuration-for-a-response" id="ref-for-abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">Obtain a Trusted
Type Configuration for a response</a> algorithm on <em>response</em>. If that
algorithm results in an error, abort these steps.</p>
    <li data-md>
     <p>Set <a href="#integration-with-html">*document*'s TrustedTypePolicyConfiguration</a> to <em>configuration</em>.</p>
    <li data-md>
     <p>Let <em>factory</em> be the result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-initialize-policy-factory" id="ref-for-abstract-opdef-initialize-policy-factory">Initialize policy
factory</a> algorithm on <em>configuration</em>.</p>
    <li data-md>
     <p>Set <em>browsingContext</em>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy" id="ref-for-windowproxy">WindowProxy</a></code> object’s <code class="idl"><a data-link-type="idl" href="#dom-window-trustedtypes" id="ref-for-dom-window-trustedtypes①">TrustedTypes</a></code> attribute to <em>factory</em>.</p>
   </ol>
   <h4 class="heading settled" data-level="4.1.2" id="extensions-to-the-window-interface"><span class="secno">4.1.2. </span><span class="content">Extensions to the Window interface</span><a class="self-link" href="#extensions-to-the-window-interface"></a></h4>
   <p>This document extends the <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window②">Window</a></code> interface defined by <a data-link-type="biblio" href="#biblio-html5">HTML</a>:</p>
   <p class="issue" id="issue-f74e9f32"><a class="self-link" href="#issue-f74e9f32"></a> removed <a href="https://heycam.github.io/webidl/#TreatNullAs">TreatNullAs=EmptyString</a> from
features parameter which is not recognized by bikeshed.  Maybe there’s
additional configuration required.  See "It should not be used in
specifications unless ..."</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window③"><c- g>Window</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①②"><c- g>Unforgeable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c->
      <a class="n" data-link-type="idl-name" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory④"><c- n>TrustedTypePolicyFactory</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Window" data-dfn-type="attribute" data-export data-readonly data-type="TrustedTypePolicyFactory" id="dom-window-trustedtypes"><code><c- g>TrustedTypes</c-></code></dfn>;
  <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy" id="ref-for-windowproxy①"><c- n>WindowProxy</c-></a>? <dfn class="dfn-paneled idl-code" data-dfn-for="Window" data-dfn-type="method" data-export data-lt="open(url, target, features)|open(url, target)|open(url)|open()" id="dom-window-open"><code><c- g>open</c-></code></dfn>(
      <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①"><c- n>URLString</c-></a> <dfn class="idl-code" data-dfn-for="Window/open(url, target, features), Window/open(url, target), Window/open(url), Window/open()" data-dfn-type="argument" data-export id="dom-window-open-url-target-features-url"><code><c- g>url</c-></code><a class="self-link" href="#dom-window-open-url-target-features-url"></a></dfn> = "about:blank",
      <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑧"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Window/open(url, target, features), Window/open(url, target), Window/open(url), Window/open()" data-dfn-type="argument" data-export id="dom-window-open-url-target-features-target"><code><c- g>target</c-></code><a class="self-link" href="#dom-window-open-url-target-features-target"></a></dfn> = "_blank",
      <c- b>optional</c-> /* [TreatNullAs=EmptyString] */ <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑨"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Window/open(url, target, features), Window/open(url, target), Window/open(url), Window/open()" data-dfn-type="argument" data-export id="dom-window-open-url-target-features-features"><code><c- g>features</c-></code><a class="self-link" href="#dom-window-open-url-target-features-features"></a></dfn> = "");
};
</pre>
   <p><code class="idl"><a data-link-type="idl" href="#dom-window-trustedtypes" id="ref-for-dom-window-trustedtypes②">TrustedTypes</a></code> returns the <a href="#integration-with-html">trusted
type policy factory</a> of the current <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window④">Window</a></code>, if the current Window
has a trusted type policy factory, or null otherwise.</p>
   <p><code class="idl"><a data-link-type="idl" href="#dom-window-open" id="ref-for-dom-window-open">open</a></code>: The type of the <em>url</em> argument changes from <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString④">USVString</a></code> to <code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring②">URLString</a></code>.</p>
   <h4 class="heading settled" data-level="4.1.3" id="extensions-to-the-document-interface"><span class="secno">4.1.3. </span><span class="content">Extensions to the Document interface</span><a class="self-link" href="#extensions-to-the-document-interface"></a></h4>
   <p>This document modifies the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑧">Document</a></code> interface defined by <a data-link-type="biblio" href="#biblio-html5">HTML</a>:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨"><c- g>Document</c-></a> {
   <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy" id="ref-for-windowproxy②"><c- n>WindowProxy</c-></a>? <dfn class="idl-code" data-dfn-for="Document" data-dfn-type="method" data-export data-lt="open(url, name, features)" id="dom-document-open"><code><c- g>open</c-></code><a class="self-link" href="#dom-document-open"></a></dfn>(<a class="n" data-link-type="idl-name" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring③"><c- n>URLString</c-></a> <dfn class="idl-code" data-dfn-for="Document/open(url, name, features)" data-dfn-type="argument" data-export id="dom-document-open-url-name-features-url"><code><c- g>url</c-></code><a class="self-link" href="#dom-document-open-url-name-features-url"></a></dfn>, <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②⓪"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Document/open(url, name, features)" data-dfn-type="argument" data-export id="dom-document-open-url-name-features-name"><code><c- g>name</c-></code><a class="self-link" href="#dom-document-open-url-name-features-name"></a></dfn>, <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②①"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Document/open(url, name, features)" data-dfn-type="argument" data-export id="dom-document-open-url-name-features-features"><code><c- g>features</c-></code><a class="self-link" href="#dom-document-open-url-name-features-features"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions"><c- g>CEReactions</c-></a>] <c- b>void</c-> <dfn class="idl-code" data-dfn-for="Document" data-dfn-type="method" data-export data-lt="write(...text)|write()" id="dom-document-write"><code><c- g>write</c-></code><a class="self-link" href="#dom-document-write"></a></dfn>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring①"><c- n>HTMLString</c-></a>... <dfn class="idl-code" data-dfn-for="Document/write(...text)" data-dfn-type="argument" data-export id="dom-document-write-text-text"><code><c- g>text</c-></code><a class="self-link" href="#dom-document-write-text-text"></a></dfn>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions①"><c- g>CEReactions</c-></a>] <c- b>void</c-> <dfn class="idl-code" data-dfn-for="Document" data-dfn-type="method" data-export data-lt="writeln(...text)|writeln()" id="dom-document-writeln"><code><c- g>writeln</c-></code><a class="self-link" href="#dom-document-writeln"></a></dfn>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring②"><c- n>HTMLString</c-></a>... <dfn class="idl-code" data-dfn-for="Document/writeln(...text)" data-dfn-type="argument" data-export id="dom-document-writeln-text-text"><code><c- g>text</c-></code><a class="self-link" href="#dom-document-writeln-text-text"></a></dfn>);
};
</pre>
   <p class="note" role="note"><span>Note:</span> The types of arguments were changed.</p>
   <h4 class="heading settled" data-level="4.1.4" id="enforcement-in-window-open"><span class="secno">4.1.4. </span><span class="content">Enforcement in window open steps algorithm</span><a class="self-link" href="#enforcement-in-window-open"></a></h4>
   <p>Modify the <a href="https://www.w3.org/TR/html5/#window-open-steps">window open steps</a> to accept a <code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring④">URLString</a></code> (<em>url</em>) (instead of a string url), and add the following
steps after step 9:</p>
   <ol>
    <li data-md>
     <p>Set <em>url</em> to the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string①">Get Trusted Type compliant
string</a> algorithm with:</p>
     <ul>
      <li data-md>
       <p><em>document</em> being the source <a href="https://www.w3.org/TR/html5/#concept-document-bc">browsing context</a>’s active document,</p>
      <li data-md>
       <p><em>input</em> being <em>url</em>,</p>
      <li data-md>
       <p><em>passThroughFunctions</em> being false, and</p>
      <li data-md>
       <p><em>expectedType</em> being <code class="idl"><a data-link-type="idl" href="#trustedurl" id="ref-for-trustedurl⑤">TrustedURL</a></code>.</p>
     </ul>
    <li data-md>
     <p>If the previous algorithm throws an exception, rethrow the exception,
and abort the following steps.</p>
   </ol>
   <h4 class="heading settled" data-level="4.1.5" id="enforcement-in-location"><span class="secno">4.1.5. </span><span class="content">Enforcement in Location navigation algorithm</span><a class="self-link" href="#enforcement-in-location"></a></h4>
   <p>To the <a href="https://www.w3.org/TR/html5/#location-object-navigate">Location-object navigate</a> algorithm, add the following steps before step 1:</p>
   <ol>
    <li data-md>
     <p>Set <em>url</em> to the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string②">Get Trusted Type compliant string</a> algorithm with:</p>
     <ul>
      <li data-md>
       <p><em>document</em> being the Location object’s <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①⓪">Document</a></code>,</p>
      <li data-md>
       <p><em>input</em> being <em>url</em>,</p>
      <li data-md>
       <p><em>passThroughFunctions</em> being false, and</p>
      <li data-md>
       <p><em>expectedType</em> being <code class="idl"><a data-link-type="idl" href="#trustedurl" id="ref-for-trustedurl⑥">TrustedURL</a></code>.</p>
     </ul>
    <li data-md>
     <p>If the previous algorithm throws an exception, rethrow the
exception, and abort the following steps.</p>
   </ol>
   <h4 class="heading settled" data-level="4.1.6" id="enforcement-document-write"><span class="secno">4.1.6. </span><span class="content">Enforcement in document write steps</span><a class="self-link" href="#enforcement-document-write"></a></h4>
   <p>Modify the <a href="https://www.w3.org/TR/html5/#document-write-steps">document write steps</a> algorithm to accept an <code class="idl"><a data-link-type="idl" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring③">HTMLString</a></code> (<em>input</em>) (instead of a string
input), and add the following steps before step 1:</p>
   <ol>
    <li data-md>
     <p>Set input to the result of executing <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string③">Get Trusted Type compliant
string</a> algorithm with:</p>
     <ul>
      <li data-md>
       <p><em>document</em> being <em>document</em>,</p>
      <li data-md>
       <p><em>input</em> being <em>input</em>,</p>
      <li data-md>
       <p><em>passThroughFunctions</em> being false, and</p>
      <li data-md>
       <p><em>expectedType</em> being <code class="idl"><a data-link-type="idl" href="#trustedhtml" id="ref-for-trustedhtml⑥">TrustedHTML</a></code>.</p>
     </ul>
    <li data-md>
     <p>If the previous algorithm throws an exception, rethrow the
exception, and abort the following steps.</p>
   </ol>
   <h4 class="heading settled" data-level="4.1.7" id="enforcement-in-sinks"><span class="secno">4.1.7. </span><span class="content">Enforcement in property sinks</span><a class="self-link" href="#enforcement-in-sinks"></a></h4>
   <p>This document modifies the setters of the following properties of
various DOM elements.  For each property in the list, modify the IDL
to accept a given parameter type instead of the DOMString /
USVString. The setters will execute the <a data-link-type="abstract-op">Enforce a Trusted Type
algorithm</a>.</p>
   <table border="1" id="sink-setters-table">
    <tbody>
     <tr>
      <th>Sink setter
      <th>Parameter type
      <th>Notes
     <tr>
      <td>ShadowRoot.innerHTML
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring④">HTMLString</a></code>
      <td><a href="https://developer.mozilla.org/en-US/docs/Web/API/ShadowRoot/innerHTML">Non-standard property</a>
     <tr>
      <td>HTMLScriptElement.innerText
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scriptstring" id="ref-for-typedefdef-scriptstring①">ScriptString</a></code>
      <td class="issue" id="issue-7fe0f731"><a class="self-link" href="#issue-7fe0f731"></a> Issue: Might require modifying the more-generic <a href="https://html.spec.whatwg.org/multipage/#dom-innertext">HTML Standard §dom-innertext</a> setter algorithm. 
     <tr>
      <td>HTMLScriptElement.textContent
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scriptstring" id="ref-for-typedefdef-scriptstring②">ScriptString</a></code>
      <td class="issue" id="issue-7fe0f731①"><a class="self-link" href="#issue-7fe0f731①"></a> Issue: Might require modifying the more-generic <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">DOM Standard §dom-node-textcontent</a> setter algorithm. 
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-srcdoc" id="ref-for-dom-iframe-srcdoc">HTMLIFrameElement.srcdoc</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑤">HTMLString</a></code>
      <td><a href="https://www.w3.org/TR/html5/#attr-iframe-srcdoc">HTML5 §attr-iframe-srcdoc</a>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-embed-src" id="ref-for-dom-embed-src">HTMLEmbedElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scripturlstring" id="ref-for-typedefdef-scripturlstring①">ScriptURLString</a></code>
      <td><a href="https://www.w3.org/TR/html5/#attr-embed-src">HTML5 §attr-embed-src</a> 
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-object-data" id="ref-for-dom-object-data">HTMLObjectElement.data</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scripturlstring" id="ref-for-typedefdef-scripturlstring②">ScriptURLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-object-codebase" id="ref-for-dom-object-codebase">HTMLObjectElement.codeBase</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scripturlstring" id="ref-for-typedefdef-scripturlstring③">ScriptURLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/scripting.html#dom-script-src" id="ref-for-dom-script-src①">HTMLScriptElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-scripturlstring" id="ref-for-typedefdef-scripturlstring④">ScriptURLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/semantics.html#dom-link-href" id="ref-for-dom-link-href">HTMLLinkElement.href</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring⑤">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-frame-src" id="ref-for-dom-frame-src">HTMLFrameElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring⑥">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-src" id="ref-for-dom-iframe-src">HTMLIFrameElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring⑦">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-img-src" id="ref-for-dom-img-src">HTMLImageElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring⑧">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-action" id="ref-for-dom-fs-action">HTMLFormElement.action</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring⑨">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/input.html#dom-input-src" id="ref-for-dom-input-src">HTMLInputElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⓪">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl">HTMLInputElement.formAction</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①①">URLString</a></code>
      <td class="issue" id="issue-f5fb6f99"><a class="self-link" href="#issue-f5fb6f99"></a> Issue: IDL linking does not recognize HTMLInputElement/formAction even though
    it is defined in <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>. 
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/links.html#dom-hyperlink-href" id="ref-for-dom-hyperlink-href">HTMLAnchorElement.href</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①②">URLString</a></code>
      <td><code>href</code> actually defined via include
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/links.html#dom-hyperlink-href" id="ref-for-dom-hyperlink-href①">HTMLAreaElement.href</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①③">URLString</a></code>
      <td><code>href</code> actually defined via include
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/semantics.html#dom-base-href" id="ref-for-dom-base-href">HTMLBaseElement.href</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①④">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-formaction" id="ref-for-dom-fs-formaction">HTMLButtonElement.formAction</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⑤">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#dom-media-src" id="ref-for-dom-media-src">HTMLMediaElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⑥">URLString</a></code>
     <tr>
      <td><a href="https://github.com/WICG/portals">WICG/portals</a>’s HTMLPortalElement.src
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⑦">URLString</a></code>
      <td>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/embedded-content.html#dom-source-src" id="ref-for-dom-source-src">HTMLSourceElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⑧">URLString</a></code>
     <tr>
      <td><code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/media.html#dom-track-src" id="ref-for-dom-track-src">HTMLTrackElement.src</a></code>
      <td><code class="idl"><a data-link-type="idl" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①⑨">URLString</a></code>
   </table>
   <h4 class="heading settled" data-level="4.1.8" id="enforcement-in-timer-functions"><span class="secno">4.1.8. </span><span class="content">Enforcement in timer functions</span><a class="self-link" href="#enforcement-in-timer-functions"></a></h4>
   <p>To the <a href="https://www.w3.org/TR/html5/#timer-initialisation-steps">timer initialization steps algorithm</a>,
add a step between 7.1 and 7.2:</p>
   <ol>
    <li data-md>
     <p>Set the first method argument to the result of executing
the <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string④">Get Trusted Type compliant string</a> algorithm, with</p>
     <ul>
      <li data-md>
       <p><em>document</em> set to the document of the method content proxy.</p>
      <li data-md>
       <p><em>input</em> set to the first method argument,</p>
      <li data-md>
       <p><em>expectedType</em> set to <code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript⑤">TrustedScript</a></code> and</p>
      <li data-md>
       <p><em>passThroughFunctions</em> set to true.</p>
     </ul>
   </ol>
   <p class="note" role="note"><span>Note:</span> Makes sure that a <code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript⑥">TrustedScript</a></code> is passed to timer
functions in place of a string when Trusted Types are enforced, but
also unconditionally accepts any <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function④">Function</a></code> object.</p>
   <h4 class="heading settled" data-level="4.1.9" id="enforcement-in-event-handler-content-attributes"><span class="secno">4.1.9. </span><span class="content">Enforcement in event handler content attributes</span><a class="self-link" href="#enforcement-in-event-handler-content-attributes"></a></h4>
   <p>This document modifies the <a href="https://www.w3.org/TR/html5/#event-handler-content-attributes">attribute change steps for an event handler content attribute</a>.</p>
   <p>At the beginning of step 5, insert the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <em>value</em> be the result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string⑤">Get Trusted Type compliant string</a> algorithm, with</p>
     <ul>
      <li data-md>
       <p><em>document</em> set to the owner document of <em>eventTarget</em>,</p>
      <li data-md>
       <p><em>input</em> set to <em>value</em>,</p>
      <li data-md>
       <p><em>expectedType</em> set to <code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript⑦">TrustedScript</a></code>, and</p>
      <li data-md>
       <p><em>passThroughFunctions</em> set to false.</p>
     </ul>
    <li data-md>
     <p>If the algorithm throws an error, abort these steps.</p>
   </ol>
   <h4 class="heading settled" data-level="4.1.10" id="string-compilation"><span class="secno">4.1.10. </span><span class="content">String compilation</span><a class="self-link" href="#string-compilation"></a></h4>
   <p class="note" role="note"><span>Note:</span> See <a href="https://github.com/tc39/ecma262/issues/938">TC39/ecma262 issue #938</a> (adding a string to be compiled to algorithm parameters)</p>
   <p>Modify <a href="https://www.w3.org/TR/html5//webappapis#section-hostensurecancompilestrings">HostEnsureCanCompileStrings</a> algorithm, adding the following steps before step 1:</p>
   <ol>
    <li data-md>
     <p>Let <em>value</em> be the result of executing the <a data-link-type="abstract-op" href="#abstract-opdef-get-trusted-type-compliant-string" id="ref-for-abstract-opdef-get-trusted-type-compliant-string⑥">Get Trusted Type compliant string</a> algorithm, with:</p>
     <ul>
      <li data-md>
       <p><em>document</em> set to the <em>callerRealm</em>’s <a href="https://www.w3.org/TR/html5/#environment-settings-object">environment setting object</a>'s <a href="https://www.w3.org/TR/html5/#responsible-document">responsible document</a>,</p>
      <li data-md>
       <p><em>input</em> set to <em>codeToCompile</em>,</p>
      <li data-md>
       <p><em>expectedType</em> being <code class="idl"><a data-link-type="idl" href="#trustedscript" id="ref-for-trustedscript⑧">TrustedScript</a></code>, and</p>
      <li data-md>
       <p><em>passThroughFunctions</em> set to false</p>
     </ul>
    <li data-md>
     <p>If the algorithm throws an error, throw an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-evalerror" id="ref-for-exceptiondef-evalerror">EvalError</a></code>.</p>
   </ol>
   <h3 class="heading settled" data-level="4.2" id="integration-with-dom-parsing"><span class="secno">4.2. </span><span class="content">Integration with DOM Parsing</span><a class="self-link" href="#integration-with-dom-parsing"></a></h3>
   <p class="note" role="note"><span>Note:</span> Re <a data-link-type="biblio" href="#biblio-dom-parsing">[DOM-Parsing]</a>.</p>
   <h4 class="heading settled" data-level="4.2.1" id="extensions-to-element-interface"><span class="secno">4.2.1. </span><span class="content">Extensions to the Element interface</span><a class="self-link" href="#extensions-to-element-interface"></a></h4>
   <p>This document modifies the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#element" id="ref-for-element②">Element</a></code> interface defined by DOM Parsing:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element③"><c- g>Element</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions②"><c- g>CEReactions</c-></a>/*, TreatNullAs=EmptyString */] <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑥"><c- n>HTMLString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="attribute" data-export data-type="HTMLString" id="dom-element-innerhtml"><code><c- g>innerHTML</c-></code></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions③"><c- g>CEReactions</c-></a>/*, TreatNullAs=EmptyString */] <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑦"><c- n>HTMLString</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="attribute" data-export data-type="HTMLString" id="dom-element-outerhtml"><code><c- g>outerHTML</c-></code></dfn>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions④"><c- g>CEReactions</c-></a>] <c- b>void</c-> <dfn class="dfn-paneled idl-code" data-dfn-for="Element" data-dfn-type="method" data-export data-lt="insertAdjacentHTML(position, text)" id="dom-element-insertadjacenthtml"><code><c- g>insertAdjacentHTML</c-></code></dfn>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②②"><c- b>DOMString</c-></a> <dfn class="idl-code" data-dfn-for="Element/insertAdjacentHTML(position, text)" data-dfn-type="argument" data-export id="dom-element-insertadjacenthtml-position-text-position"><code><c- g>position</c-></code><a class="self-link" href="#dom-element-insertadjacenthtml-position-text-position"></a></dfn>, <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑧"><c- n>HTMLString</c-></a> <dfn class="idl-code" data-dfn-for="Element/insertAdjacentHTML(position, text)" data-dfn-type="argument" data-export id="dom-element-insertadjacenthtml-position-text-text"><code><c- g>text</c-></code><a class="self-link" href="#dom-element-insertadjacenthtml-position-text-text"></a></dfn>);
};
</pre>
   <p>For <code class="idl"><a data-link-type="idl" href="#dom-element-innerhtml" id="ref-for-dom-element-innerhtml">innerHTML</a></code>'s and <code class="idl"><a data-link-type="idl" href="#dom-element-outerhtml" id="ref-for-dom-element-outerhtml">outerHTML</a></code>'s execute the <a data-link-type="abstract-op" href="#abstract-opdef-enforce-a-trusted-type" id="ref-for-abstract-opdef-enforce-a-trusted-type">Enforce a Trusted Type</a> algorithm.</p>
   <p>For the <code class="idl"><a data-link-type="idl" href="#dom-element-insertadjacenthtml" id="ref-for-dom-element-insertadjacenthtml">insertAdjacentHTML()</a></code> method, execute the <a data-link-type="abstract-op" href="#abstract-opdef-enforce-a-trusted-type" id="ref-for-abstract-opdef-enforce-a-trusted-type①">Enforce a Trusted Type</a> algorithm with input argument set to the <em>text</em> parameter value.</p>
   <p class="issue" id="issue-f74e9f32①"><a class="self-link" href="#issue-f74e9f32①"></a> removed <a href="https://heycam.github.io/webidl/#TreatNullAs">TreatNullAs=EmptyString</a> from
features parameter which is not recognized by bikeshed.  Maybe there’s
additional configuration required.  See "It should not be used in
specifications unless ..."</p>
   <p class="issue" id="issue-d48d676e"><a class="self-link" href="#issue-d48d676e"></a> TreatNullAs is confusing, as for TrustedHTML, for some sinks a ull value will result in "", and "null" for others. This already caused problems in the polyfill. <a href="https://github.com/WICG/trusted-types/issues/2">&lt;https://github.com/WICG/trusted-types/issues/2></a></p>
   <h4 class="heading settled" data-level="4.2.2" id="extensions-to-the-range-interface"><span class="secno">4.2.2. </span><span class="content">Extensions to the Range interface</span><a class="self-link" href="#extensions-to-the-range-interface"></a></h4>
   <p>This document modifies the <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#range" id="ref-for-range">Range</a></code> interface defined by <a data-link-type="biblio" href="#biblio-dom-parsing">[DOM-Parsing]</a>:</p>
<pre class="idl highlight def"><c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#range" id="ref-for-range①"><c- g>Range</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions⑤"><c- g>CEReactions</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject" id="ref-for-NewObject"><c- g>NewObject</c-></a>] <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#documentfragment" id="ref-for-documentfragment"><c- n>DocumentFragment</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="Range" data-dfn-type="method" data-export data-lt="createContextualFragment(fragment)" id="dom-range-createcontextualfragment"><code><c- g>createContextualFragment</c-></code></dfn>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑨"><c- n>HTMLString</c-></a> <dfn class="idl-code" data-dfn-for="Range/createContextualFragment(fragment)" data-dfn-type="argument" data-export id="dom-range-createcontextualfragment-fragment-fragment"><code><c- g>fragment</c-></code><a class="self-link" href="#dom-range-createcontextualfragment-fragment-fragment"></a></dfn>);
};
</pre>
   <p>For <code class="idl"><a data-link-type="idl" href="#dom-range-createcontextualfragment" id="ref-for-dom-range-createcontextualfragment">createContextualFragment()</a></code> function, execute the <a data-link-type="abstract-op" href="#abstract-opdef-enforce-a-trusted-type" id="ref-for-abstract-opdef-enforce-a-trusted-type②">Enforce a Trusted Type</a> algorithm with the <em>input</em> argument set to
the <em>fragment</em> value.</p>
   <h4 class="heading settled" data-level="4.2.3" id="extensions-to-the-DOMParser"><span class="secno">4.2.3. </span><span class="content">Extensions to the DOMParser interface</span><a class="self-link" href="#extensions-to-the-DOMParser"></a></h4>
   <p>This document modifies the <code class="idl"><a data-link-type="idl" href="#domparser" id="ref-for-domparser">DOMParser</a></code> interface defined by <a data-link-type="biblio" href="#biblio-dom-parsing">[DOM-Parsing]</a>:</p>
<pre class="idl highlight def">[<dfn class="idl-code" data-dfn-for="DOMParser" data-dfn-type="constructor" data-export data-lt="DOMParser()" id="dom-domparser-domparser"><code><c- g>Constructor</c-></code><a class="self-link" href="#dom-domparser-domparser"></a></dfn>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="domparser"><code><c- g>DOMParser</c-></code></dfn> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject" id="ref-for-NewObject①"><c- g>NewObject</c-></a>] <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①"><c- n>Document</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="DOMParser" data-dfn-type="method" data-export data-lt="parseFromString(str, type)" id="dom-domparser-parsefromstring"><code><c- g>parseFromString</c-></code></dfn>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring①⓪"><c- n>HTMLString</c-></a> <dfn class="idl-code" data-dfn-for="DOMParser/parseFromString(str, type)" data-dfn-type="argument" data-export id="dom-domparser-parsefromstring-str-type-str"><code><c- g>str</c-></code><a class="self-link" href="#dom-domparser-parsefromstring-str-type-str"></a></dfn>, <a class="n" data-link-type="idl-name" href="#enumdef-supportedtype" id="ref-for-enumdef-supportedtype"><c- n>SupportedType</c-></a> <dfn class="idl-code" data-dfn-for="DOMParser/parseFromString(str, type)" data-dfn-type="argument" data-export id="dom-domparser-parsefromstring-str-type-type"><code><c- g>type</c-></code><a class="self-link" href="#dom-domparser-parsefromstring-str-type-type"></a></dfn>);
};
</pre>
   <p class="issue" id="issue-8efca2f1"><a class="self-link" href="#issue-8efca2f1"></a> IDL linkage broken for SupportedType but I don’t want DOMParser to not
show up in the IDL summary.</p>
<pre class="idl highlight def">// Not modified by this document, but bikeshed is not recognizing
// SupportedType
<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-supportedtype"><code><c- g>SupportedType</c-></code></dfn> {
  <dfn class="idl-code" data-dfn-for="SupportedType" data-dfn-type="enum-value" data-export id="dom-supportedtype-text-html"><code><c- s>"text/html"</c-></code><a class="self-link" href="#dom-supportedtype-text-html"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="SupportedType" data-dfn-type="enum-value" data-export id="dom-supportedtype-text-xml"><code><c- s>"text/xml"</c-></code><a class="self-link" href="#dom-supportedtype-text-xml"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="SupportedType" data-dfn-type="enum-value" data-export id="dom-supportedtype-application-xml"><code><c- s>"application/xml"</c-></code><a class="self-link" href="#dom-supportedtype-application-xml"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="SupportedType" data-dfn-type="enum-value" data-export id="dom-supportedtype-application-xhtmlxml"><code><c- s>"application/xhtml+xml"</c-></code><a class="self-link" href="#dom-supportedtype-application-xhtmlxml"></a></dfn>,
  <dfn class="idl-code" data-dfn-for="SupportedType" data-dfn-type="enum-value" data-export id="dom-supportedtype-image-svgxml"><code><c- s>"image/svg+xml"</c-></code><a class="self-link" href="#dom-supportedtype-image-svgxml"></a></dfn>
};
</pre>
   <p>For <code class="idl"><a data-link-type="idl" href="#dom-domparser-parsefromstring" id="ref-for-dom-domparser-parsefromstring①">parseFromString()</a></code> function, execute the <a data-link-type="abstract-op" href="#abstract-opdef-enforce-a-trusted-type" id="ref-for-abstract-opdef-enforce-a-trusted-type③">Enforce a
Trusted Type</a> algorithm with <em>input</em> argument set to the <em>str</em> value.</p>
   <p class="issue" id="issue-4b9885e1"><a class="self-link" href="#issue-4b9885e1"></a> Do we need to specify that the enforcement type is <code class="idl"><a data-link-type="idl" href="#trustedhtml" id="ref-for-trustedhtml⑦">TrustedHTML</a></code>, or
that it is dependent on <em>type</em> which may be <code>"image/svg+xml"</code> or generic XML?</p>
   <h2 class="heading settled" data-level="5" id="security-considerations"><span class="secno">5. </span><span class="content">Security Considerations</span><a class="self-link" href="#security-considerations"></a></h2>
   <p>Trusted Types are not intended to defend against XSS in an actively malicious
execution environment. It’s assumed that the application is written by
non-malicious authors; the intent is to prevent developer mistakes that could
result in security bugs, and not to defend against first-party malicious code actively trying to bypass policy restrictions.</p>
   <h3 class="heading settled" data-level="5.1" id="bypass-vectors"><span class="secno">5.1. </span><span class="content">Bypass vectors</span><a class="self-link" href="#bypass-vectors"></a></h3>
   <p class="issue" id="issue-31966331"><a class="self-link" href="#issue-31966331"></a> Mention node-adoption bypass vectors. <a href="https://github.com/WICG/trusted-types/issues/49">&lt;https://github.com/WICG/trusted-types/issues/49></a></p>
   <p class="issue" id="issue-1c3973fc"><a class="self-link" href="#issue-1c3973fc"></a> Mention anchor element properties bypass. <a href="https://github.com/WICG/trusted-types/issues/64">&lt;https://github.com/WICG/trusted-types/issues/64></a></p>
   <p class="issue" id="issue-fb0cfdf0"><a class="self-link" href="#issue-fb0cfdf0"></a> Mention text/attribute node copy bypass vectors. <a href="https://github.com/WICG/trusted-types/issues/47">&lt;https://github.com/WICG/trusted-types/issues/47></a></p>
   <p class="issue" id="issue-80906c67"><a class="self-link" href="#issue-80906c67"></a> Mention bypass vectors with template elements. <a href="https://github.com/WICG/trusted-types/issues/42">&lt;https://github.com/WICG/trusted-types/issues/42></a></p>
   <p class="issue" id="issue-f9e3242a"><a class="self-link" href="#issue-f9e3242a"></a> Mention corner cases with types that depend on a different attribute value. <a href="https://github.com/WICG/trusted-types/issues/6">&lt;https://github.com/WICG/trusted-types/issues/6></a></p>
   <h3 class="heading settled" data-level="5.2" id="best-practices-for-policy-design"><span class="secno">5.2. </span><span class="content">Best practices for policy design</span><a class="self-link" href="#best-practices-for-policy-design"></a></h3>
   <p>Trusted Types limit the scope of the code that can introduce DOM XSS
vulnerabilities to the implementation of <a href="#policies">policies</a>. In this design,
insecure policies can still enable XSS. Special emphasis needs to be taken by
use policies that are either secure for all possible inputs, or limit the access
to insecure policies, such that they are only called with non-attacker
controlled inputs.</p>
   <p class="issue" id="issue-fe3b0564"><a class="self-link" href="#issue-fe3b0564"></a> Mention the policy is global state-dependant. <a href="https://github.com/WICG/trusted-types/issues/78">&lt;https://github.com/WICG/trusted-types/issues/78></a></p>
   <p class="issue" id="issue-2eb927d2"><a class="self-link" href="#issue-2eb927d2"></a> Refer to the external document on secure policy design.</p>
   <h2 class="heading settled" data-level="6" id="implementation-considerations"><span class="secno">6. </span><span class="content">Implementation Considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
   <h3 class="heading settled" data-level="6.1" id="vendor-specific-extensions-and-addons"><span class="secno">6.1. </span><span class="content">Vendor-specific Extensions and Addons</span><a class="self-link" href="#vendor-specific-extensions-and-addons"></a></h3>
   <p>Restriction imposed by the <code class="idl"><a data-link-type="idl" href="#dictdef-trustedtypeconfiguration" id="ref-for-dictdef-trustedtypeconfiguration⑥">TrustedTypeConfiguration</a></code> objects SHOULD
NOT interfere with the operation of user-agent features like addons,
extensions, or bookmarklets. These kinds of features generally advance
the user’s priority over page authors, as espoused in <a data-link-type="biblio" href="#biblio-html-design-principles">[html-design-principles]</a>. Specifically, extensions SHOULD be able to pass strings
to the DOM XSS <a data-link-type="dfn" href="#injection-sink" id="ref-for-injection-sink①⑧">injection sinks</a> of the document without triggering <a data-link-type="dfn" href="#default-policy" id="ref-for-default-policy②">default policy</a> execution, <a href="#violation">violation</a> generation, or the rejection of the value.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="conformance"><span class="content"> Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p> Conformance requirements are expressed with a combination of descriptive assertions and RFC 2119 terminology.
            The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
            in the normative parts of this document
            are to be interpreted as described in RFC 2119.
            However, for readability,
            these words do not appear in all uppercase letters in this specification. </p>
   <p> All of the text of this specification is normative
            except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a> </p>
   <p> Examples in this specification are introduced with the words “for example”
            or are set apart from the normative text with <code>class="example"</code>, like this: </p>
   <div class="example" id="example-example"><a class="self-link" href="#example-example"></a> This is an example of an informative example. </div>
   <p> Informative notes begin with the word “Note”
            and are set apart from the normative text with <code>class="note"</code>, like this: </p>
   <p class="note" role="note"> Note, this is an informative note. </p>
  </div>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#dom-unknownpolicynamedisposition-allow">"allow"</a><span>, in §2.4.1</span>
   <li><a href="#dom-trustedtypeconfiguration-allowednames">allowedNames</a><span>, in §2.4.1</span>
   <li><a href="#dom-supportedtype-application-xhtmlxml">"application/xhtml+xml"</a><span>, in §4.2.3</span>
   <li><a href="#dom-supportedtype-application-xml">"application/xml"</a><span>, in §4.2.3</span>
   <li><a href="#abstract-opdef-create-a-trusted-type">Create a Trusted Type</a><span>, in §3.1.7</span>
   <li><a href="#abstract-opdef-create-a-trusted-type-policy">Create a Trusted Type Policy</a><span>, in §3.1.2</span>
   <li><a href="#abstract-opdef-create-a-violation-for">Create a Violation for</a><span>, in §3.2.4</span>
   <li><a href="#dom-range-createcontextualfragment">createContextualFragment(fragment)</a><span>, in §4.2.2</span>
   <li><a href="#dom-trustedtypepolicyoptions-createhtml">createHTML</a><span>, in §2.3.3</span>
   <li><a href="#callbackdef-createhtmlcallback">CreateHTMLCallback</a><span>, in §2.3.3</span>
   <li><a href="#dom-trustedtypepolicy-createhtml">createHTML(input)</a><span>, in §2.3.2</span>
   <li><a href="#dom-trustedtypepolicyfactory-createpolicy">createPolicy(policyName)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyfactory-createpolicy">createPolicy(policyName, policyOptions)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyfactory-createpolicy">createPolicy(policyName, policyOptions, exposed)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyoptions-createscript">createScript</a><span>, in §2.3.3</span>
   <li><a href="#callbackdef-createscriptcallback">CreateScriptCallback</a><span>, in §2.3.3</span>
   <li><a href="#dom-trustedtypepolicy-createscript">createScript(input)</a><span>, in §2.3.2</span>
   <li><a href="#dom-trustedtypepolicyoptions-createscripturl">createScriptURL</a><span>, in §2.3.3</span>
   <li><a href="#callbackdef-createscripturlcallback">CreateScriptURLCallback</a><span>, in §2.3.3</span>
   <li><a href="#dom-trustedtypepolicy-createscripturl">createScriptURL(input)</a><span>, in §2.3.2</span>
   <li><a href="#dom-trustedtypepolicyoptions-createurl">createURL</a><span>, in §2.3.3</span>
   <li><a href="#callbackdef-createurlcallback">CreateURLCallback</a><span>, in §2.3.3</span>
   <li><a href="#dom-trustedtypepolicy-createurl">createURL(input)</a><span>, in §2.3.2</span>
   <li><a href="#default-policy">Default policy</a><span>, in §2.3.4</span>
   <li><a href="#dom-domparser-domparser">DOMParser()</a><span>, in §4.2.3</span>
   <li><a href="#domparser">DOMParser</a><span>, in §4.2.3</span>
   <li><a href="#dom-trustedtypeconfiguration-domsinks">domSinks</a><span>, in §2.4.1</span>
   <li><a href="#abstract-opdef-enforce-a-trusted-type">Enforce a Trusted Type</a><span>, in §3.2.3</span>
   <li><a href="#enforcement①">enforcement</a><span>, in §3.2.3</span>
   <li><a href="#dom-trustedtypepolicyoptions-exposed">exposed</a><span>, in §2.3.3</span>
   <li><a href="#abstract-opdef-get-default-policy">Get default policy</a><span>, in §3.1.4</span>
   <li><a href="#abstract-opdef-get-exposed-policy">Get exposed policy</a><span>, in §3.1.3</span>
   <li><a href="#dom-trustedtypepolicyfactory-getexposedpolicy">getExposedPolicy(policyName)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyfactory-getpolicynames">getPolicyNames()</a><span>, in §2.3.1</span>
   <li><a href="#abstract-opdef-get-trusted-type-compliant-string">Get Trusted Type compliant string</a><span>, in §3.2.2</span>
   <li><a href="#typedefdef-htmlstring">HTMLString</a><span>, in §4</span>
   <li><a href="#dom-supportedtype-image-svgxml">"image/svg+xml"</a><span>, in §4.2.3</span>
   <li><a href="#abstract-opdef-initialize-a-documents-trusted-type-configuration-algorithm">Initialize a Document’s trusted type configuration algorithm</a><span>, in §4.1.1</span>
   <li><a href="#abstract-opdef-initialize-policy-factory">Initialize policy factory</a><span>, in §3.1.1</span>
   <li><a href="#injection-sink">injection sink</a><span>, in §2.1</span>
   <li><a href="#dom-element-innerhtml">innerHTML</a><span>, in §4.2.1</span>
   <li><a href="#dom-element-insertadjacenthtml">insertAdjacentHTML(position, text)</a><span>, in §4.2.1</span>
   <li><a href="#abstract-opdef-is-a-default-policy">Is a default policy</a><span>, in §3.1.6</span>
   <li><a href="#dom-trustedtypepolicyfactory-ishtml">isHTML(value)</a><span>, in §2.3.1</span>
   <li><a href="#abstract-opdef-is-policy-name-allowed">Is policy name allowed</a><span>, in §3.1.5</span>
   <li><a href="#dom-trustedtypepolicyfactory-isscripturl">isScriptURL(value)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyfactory-isscript">isScript(value)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicyfactory-isurl">isURL(value)</a><span>, in §2.3.1</span>
   <li><a href="#dom-trustedtypepolicy-name">name</a><span>, in §2.3.2</span>
   <li><a href="#abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">Obtain a Trusted Type Configuration for a response</a><span>, in §3.2.1</span>
   <li><a href="#dom-window-open">open()</a><span>, in §4.1.2</span>
   <li><a href="#dom-window-open">open(url)</a><span>, in §4.1.2</span>
   <li><a href="#dom-document-open">open(url, name, features)</a><span>, in §4.1.3</span>
   <li><a href="#dom-window-open">open(url, target)</a><span>, in §4.1.2</span>
   <li><a href="#dom-window-open">open(url, target, features)</a><span>, in §4.1.2</span>
   <li><a href="#dom-element-outerhtml">outerHTML</a><span>, in §4.2.1</span>
   <li><a href="#dom-domparser-parsefromstring">parseFromString(str, type)</a><span>, in §4.2.3</span>
   <li>
    "reject"
    <ul>
     <li><a href="#dom-stringatsinkdisposition-reject">enum-value for StringAtSinkDisposition</a><span>, in §2.4.1</span>
     <li><a href="#dom-unknownpolicynamedisposition-reject">enum-value for UnknownPolicyNameDisposition</a><span>, in §2.4.1</span>
    </ul>
   <li><a href="#dom-stringatsinkdisposition-report">"report"</a><span>, in §2.4.1</span>
   <li><a href="#dom-trustedtypeconfiguration-reportinggroup">reportingGroup</a><span>, in §2.4.1</span>
   <li><a href="#abstract-opdef-report-sink-type-mismatch-violation">Report sink type mismatch violation</a><span>, in §3.2.5</span>
   <li><a href="#typedefdef-scriptstring">ScriptString</a><span>, in §4</span>
   <li><a href="#typedefdef-scripturlstring">ScriptURLString</a><span>, in §4</span>
   <li><a href="#enumdef-stringatsinkdisposition">StringAtSinkDisposition</a><span>, in §2.4.1</span>
   <li>
    stringification behavior
    <ul>
     <li><a href="#TrustedHTML-stringification-behavior">dfn for TrustedHTML</a><span>, in §2.2.1</span>
     <li><a href="#TrustedScript-stringification-behavior">dfn for TrustedScript</a><span>, in §2.2.2</span>
     <li><a href="#TrustedScriptURL-stringification-behavior">dfn for TrustedScriptURL</a><span>, in §2.2.3</span>
     <li><a href="#TrustedURL-stringification-behavior">dfn for TrustedURL</a><span>, in §2.2.4</span>
    </ul>
   <li><a href="#enumdef-supportedtype">SupportedType</a><span>, in §4.2.3</span>
   <li><a href="#dom-supportedtype-text-html">"text/html"</a><span>, in §4.2.3</span>
   <li><a href="#dom-supportedtype-text-xml">"text/xml"</a><span>, in §4.2.3</span>
   <li>
    TrustedHTML
    <ul>
     <li><a href="#trustedhtml">(interface)</a><span>, in §2.2.1</span>
     <li><a href="#typedef-trustedhtml">(type)</a><span>, in §2.2.1</span>
    </ul>
   <li>
    TrustedScript
    <ul>
     <li><a href="#trustedscript">(interface)</a><span>, in §2.2.2</span>
     <li><a href="#typedef-trustedscript">(type)</a><span>, in §2.2.2</span>
    </ul>
   <li>
    TrustedScriptURL
    <ul>
     <li><a href="#trustedscripturl">(interface)</a><span>, in §2.2.3</span>
     <li><a href="#typedef-trustedscripturl">(type)</a><span>, in §2.2.3</span>
    </ul>
   <li><a href="#typedefdef-trustedtype">TrustedType</a><span>, in §4</span>
   <li><a href="#trusted-type">Trusted Type</a><span>, in §2.2</span>
   <li><a href="#dictdef-trustedtypeconfiguration">TrustedTypeConfiguration</a><span>, in §2.4.1</span>
   <li>
    TrustedTypePolicy
    <ul>
     <li><a href="#trustedtypepolicy">(interface)</a><span>, in §2.3.2</span>
     <li><a href="#typedef-trustedtypepolicy">(type)</a><span>, in §2.3.2</span>
    </ul>
   <li>
    TrustedTypePolicyFactory
    <ul>
     <li><a href="#trustedtypepolicyfactory">(interface)</a><span>, in §2.3.1</span>
     <li><a href="#typedef-trustedtypepolicyfactory">(type)</a><span>, in §2.3.1</span>
    </ul>
   <li>
    TrustedTypePolicyOptions
    <ul>
     <li><a href="#dictdef-trustedtypepolicyoptions">(dictionary)</a><span>, in §2.3.3</span>
     <li><a href="#typedef-trustedtypepolicyoptions">(type)</a><span>, in §2.3.3</span>
    </ul>
   <li><a href="#dom-window-trustedtypes">TrustedTypes</a><span>, in §4.1.2</span>
   <li><a href="#http-headerdef-trusted-types">Trusted-Types</a><span>, in §2.4.2</span>
   <li><a href="#trusted-types-http-response-header">Trusted-Types HTTP response header</a><span>, in §2.4.2</span>
   <li>
    TrustedURL
    <ul>
     <li><a href="#trustedurl">(interface)</a><span>, in §2.2.4</span>
     <li><a href="#typedef-trustedurl">(type)</a><span>, in §2.2.4</span>
    </ul>
   <li><a href="#dom-trustedtypeconfiguration-unknownpolicyname">unknownPolicyName</a><span>, in §2.4.1</span>
   <li><a href="#enumdef-unknownpolicynamedisposition">UnknownPolicyNameDisposition</a><span>, in §2.4.1</span>
   <li><a href="#dom-stringatsinkdisposition-unsafe-allow">"unsafe-allow"</a><span>, in §2.4.1</span>
   <li><a href="#typedefdef-urlstring">URLString</a><span>, in §4</span>
   <li><a href="#dom-document-write">write()</a><span>, in §4.1.3</span>
   <li><a href="#dom-document-writeln">writeln()</a><span>, in §4.1.3</span>
   <li><a href="#dom-document-writeln">writeln(...text)</a><span>, in §4.1.3</span>
   <li><a href="#dom-document-write">write(...text)</a><span>, in §4.1.3</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-violation">
   <a href="https://w3c.github.io/webappsec-csp/#violation">https://w3c.github.io/webappsec-csp/#violation</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-violation">2.4.3. Violation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-document">
   <a href="https://dom.spec.whatwg.org/#document">https://dom.spec.whatwg.org/#document</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-document">2.1. Injection sinks</a>
    <li><a href="#ref-for-document①">2.4.1. TrustedTypeConfiguration</a>
    <li><a href="#ref-for-document②">2.4.3. Violation</a>
    <li><a href="#ref-for-document③">3.2.2. Get Trusted Type compliant string</a>
    <li><a href="#ref-for-document④">3.2.3. Enforce a Trusted Type</a> <a href="#ref-for-document⑤">(2)</a>
    <li><a href="#ref-for-document⑥">4.1. Integration with HTML</a>
    <li><a href="#ref-for-document⑦">4.1.1. Initialize a Document’s trusted type configuration algorithm</a>
    <li><a href="#ref-for-document⑧">4.1.3. Extensions to the Document interface</a> <a href="#ref-for-document⑨">(2)</a>
    <li><a href="#ref-for-document①⓪">4.1.5. Enforcement in Location navigation algorithm</a>
    <li><a href="#ref-for-document①①">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-documentfragment">
   <a href="https://dom.spec.whatwg.org/#documentfragment">https://dom.spec.whatwg.org/#documentfragment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-documentfragment">4.2.2. Extensions to the Range interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-element">
   <a href="https://dom.spec.whatwg.org/#element">https://dom.spec.whatwg.org/#element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-element">2.1. Injection sinks</a> <a href="#ref-for-element①">(2)</a>
    <li><a href="#ref-for-element②">4.2.1. Extensions to the Element interface</a> <a href="#ref-for-element③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-range">
   <a href="https://dom.spec.whatwg.org/#range">https://dom.spec.whatwg.org/#range</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-range">4.2.2. Extensions to the Range interface</a> <a href="#ref-for-range①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-response">
   <a href="https://fetch.spec.whatwg.org/#response">https://fetch.spec.whatwg.org/#response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-response">3.2.1. Obtain a Trusted Type Configuration for a response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-header-list">
   <a href="https://fetch.spec.whatwg.org/#concept-header-list">https://fetch.spec.whatwg.org/#concept-header-list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-header-list">3.2.1. Obtain a Trusted Type Configuration for a response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-cereactions">
   <a href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions">https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cereactions">4.1.3. Extensions to the Document interface</a> <a href="#ref-for-cereactions①">(2)</a>
    <li><a href="#ref-for-cereactions②">4.2.1. Extensions to the Element interface</a> <a href="#ref-for-cereactions③">(2)</a> <a href="#ref-for-cereactions④">(3)</a>
    <li><a href="#ref-for-cereactions⑤">4.2.2. Extensions to the Range interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-window">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#window">https://html.spec.whatwg.org/multipage/window-object.html#window</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-window">3.2.2. Get Trusted Type compliant string</a>
    <li><a href="#ref-for-window①">4.1. Integration with HTML</a>
    <li><a href="#ref-for-window②">4.1.2. Extensions to the Window interface</a> <a href="#ref-for-window③">(2)</a> <a href="#ref-for-window④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-windowproxy">
   <a href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy">https://html.spec.whatwg.org/multipage/window-object.html#windowproxy</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windowproxy">4.1.1. Initialize a Document’s trusted type configuration algorithm</a>
    <li><a href="#ref-for-windowproxy①">4.1.2. Extensions to the Window interface</a>
    <li><a href="#ref-for-windowproxy②">4.1.3. Extensions to the Document interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-fs-action">
   <a href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-action">https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-action</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fs-action">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-object-codebase">
   <a href="https://html.spec.whatwg.org/multipage/obsolete.html#dom-object-codebase">https://html.spec.whatwg.org/multipage/obsolete.html#dom-object-codebase</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-object-codebase">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-object-data">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-object-data">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-object-data</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-object-data">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-fs-formaction">
   <a href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-formaction">https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#dom-fs-formaction</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-fs-formaction">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-link-href">
   <a href="https://html.spec.whatwg.org/multipage/semantics.html#dom-link-href">https://html.spec.whatwg.org/multipage/semantics.html#dom-link-href</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-link-href">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-track-src">
   <a href="https://html.spec.whatwg.org/multipage/media.html#dom-track-src">https://html.spec.whatwg.org/multipage/media.html#dom-track-src</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-track-src">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-iframe-srcdoc">
   <a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-srcdoc">https://html.spec.whatwg.org/multipage/iframe-embed-object.html#dom-iframe-srcdoc</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-iframe-srcdoc">4.1.7. Enforcement in property sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-script-text">
   <a href="https://html.spec.whatwg.org/multipage/scripting.html#dom-script-text">https://html.spec.whatwg.org/multipage/scripting.html#dom-script-text</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-script-text">2.1. Injection sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMString">
   <a href="https://heycam.github.io/webidl/#idl-DOMString">https://heycam.github.io/webidl/#idl-DOMString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMString">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-idl-DOMString①">(2)</a> <a href="#ref-for-idl-DOMString②">(3)</a>
    <li><a href="#ref-for-idl-DOMString③">2.3.2. TrustedTypePolicy</a> <a href="#ref-for-idl-DOMString④">(2)</a> <a href="#ref-for-idl-DOMString⑤">(3)</a> <a href="#ref-for-idl-DOMString⑥">(4)</a> <a href="#ref-for-idl-DOMString⑦">(5)</a>
    <li><a href="#ref-for-idl-DOMString⑧">2.3.3. TrustedTypePolicyOptions</a> <a href="#ref-for-idl-DOMString⑨">(2)</a> <a href="#ref-for-idl-DOMString①⓪">(3)</a> <a href="#ref-for-idl-DOMString①①">(4)</a> <a href="#ref-for-idl-DOMString①②">(5)</a> <a href="#ref-for-idl-DOMString①③">(6)</a>
    <li><a href="#ref-for-idl-DOMString①④">2.4.1. TrustedTypeConfiguration</a> <a href="#ref-for-idl-DOMString①⑤">(2)</a>
    <li><a href="#ref-for-idl-DOMString①⑥">4. Integrations</a> <a href="#ref-for-idl-DOMString①⑦">(2)</a>
    <li><a href="#ref-for-idl-DOMString①⑧">4.1.2. Extensions to the Window interface</a> <a href="#ref-for-idl-DOMString①⑨">(2)</a>
    <li><a href="#ref-for-idl-DOMString②⓪">4.1.3. Extensions to the Document interface</a> <a href="#ref-for-idl-DOMString②①">(2)</a>
    <li><a href="#ref-for-idl-DOMString②②">4.2.1. Extensions to the Element interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptiondef-evalerror">
   <a href="https://heycam.github.io/webidl/#exceptiondef-evalerror">https://heycam.github.io/webidl/#exceptiondef-evalerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptiondef-evalerror">4.1.10. String compilation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">2.2.1. TrustedHTML</a>
    <li><a href="#ref-for-Exposed①">2.2.2. TrustedScript</a>
    <li><a href="#ref-for-Exposed②">2.2.3. TrustedScriptURL</a>
    <li><a href="#ref-for-Exposed③">2.2.4. TrustedURL</a>
    <li><a href="#ref-for-Exposed④">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-Exposed⑤">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-Exposed⑥">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Function">
   <a href="https://heycam.github.io/webidl/#Function">https://heycam.github.io/webidl/#Function</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Function">3.2.2. Get Trusted Type compliant string</a> <a href="#ref-for-Function①">(2)</a> <a href="#ref-for-Function②">(3)</a> <a href="#ref-for-Function③">(4)</a>
    <li><a href="#ref-for-Function④">4.1.8. Enforcement in timer functions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-NewObject">
   <a href="https://heycam.github.io/webidl/#NewObject">https://heycam.github.io/webidl/#NewObject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-NewObject">4.2.2. Extensions to the Range interface</a>
    <li><a href="#ref-for-NewObject①">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptiondef-typeerror">
   <a href="https://heycam.github.io/webidl/#exceptiondef-typeerror">https://heycam.github.io/webidl/#exceptiondef-typeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptiondef-typeerror">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-USVString">
   <a href="https://heycam.github.io/webidl/#idl-USVString">https://heycam.github.io/webidl/#idl-USVString</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-USVString">2.3.3. TrustedTypePolicyOptions</a> <a href="#ref-for-idl-USVString①">(2)</a>
    <li><a href="#ref-for-idl-USVString②">4. Integrations</a> <a href="#ref-for-idl-USVString③">(2)</a>
    <li><a href="#ref-for-idl-USVString④">4.1.2. Extensions to the Window interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Unforgeable">
   <a href="https://heycam.github.io/webidl/#Unforgeable">https://heycam.github.io/webidl/#Unforgeable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Unforgeable">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-Unforgeable①">(2)</a> <a href="#ref-for-Unforgeable②">(3)</a> <a href="#ref-for-Unforgeable③">(4)</a> <a href="#ref-for-Unforgeable④">(5)</a> <a href="#ref-for-Unforgeable⑤">(6)</a> <a href="#ref-for-Unforgeable⑥">(7)</a>
    <li><a href="#ref-for-Unforgeable⑦">2.3.2. TrustedTypePolicy</a> <a href="#ref-for-Unforgeable⑧">(2)</a> <a href="#ref-for-Unforgeable⑨">(3)</a> <a href="#ref-for-Unforgeable①⓪">(4)</a> <a href="#ref-for-Unforgeable①①">(5)</a>
    <li><a href="#ref-for-Unforgeable①②">4.1.2. Extensions to the Window interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
   <a href="https://heycam.github.io/webidl/#idl-boolean">https://heycam.github.io/webidl/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-idl-boolean①">(2)</a> <a href="#ref-for-idl-boolean②">(3)</a> <a href="#ref-for-idl-boolean③">(4)</a> <a href="#ref-for-idl-boolean④">(5)</a>
    <li><a href="#ref-for-idl-boolean⑤">2.3.3. TrustedTypePolicyOptions</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[csp-3]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-violation" style="color:initial">violation</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-document" style="color:initial">Document</span>
     <li><span class="dfn-paneled" id="term-for-documentfragment" style="color:initial">DocumentFragment</span>
     <li><span class="dfn-paneled" id="term-for-element" style="color:initial">Element</span>
     <li><span class="dfn-paneled" id="term-for-range" style="color:initial">Range</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-response" style="color:initial">Response</span>
     <li><span class="dfn-paneled" id="term-for-concept-header-list" style="color:initial">header list</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-cereactions" style="color:initial">CEReactions</span>
     <li><span class="dfn-paneled" id="term-for-window" style="color:initial">Window</span>
     <li><span class="dfn-paneled" id="term-for-windowproxy" style="color:initial">WindowProxy</span>
     <li><span class="dfn-paneled" id="term-for-dom-fs-action" style="color:initial">action</span>
     <li><span class="dfn-paneled" id="term-for-dom-object-codebase" style="color:initial">codeBase</span>
     <li><span class="dfn-paneled" id="term-for-dom-object-data" style="color:initial">data</span>
     <li><span class="dfn-paneled" id="term-for-dom-fs-formaction" style="color:initial">formAction</span>
     <li><span class="dfn-paneled" id="term-for-dom-link-href" style="color:initial">href <small>(for HTMLLinkElement)</small></span>
     <li><span class="dfn-paneled" id="term-for-dom-track-src" style="color:initial">src <small>(for HTMLTrackElement)</small></span>
     <li><span class="dfn-paneled" id="term-for-dom-iframe-srcdoc" style="color:initial">srcdoc</span>
     <li><span class="dfn-paneled" id="term-for-dom-script-text" style="color:initial">text</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-idl-DOMString" style="color:initial">DOMString</span>
     <li><span class="dfn-paneled" id="term-for-exceptiondef-evalerror" style="color:initial">EvalError</span>
     <li><span class="dfn-paneled" id="term-for-Exposed" style="color:initial">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-Function" style="color:initial">Function</span>
     <li><span class="dfn-paneled" id="term-for-NewObject" style="color:initial">NewObject</span>
     <li><span class="dfn-paneled" id="term-for-exceptiondef-typeerror" style="color:initial">TypeError</span>
     <li><span class="dfn-paneled" id="term-for-idl-USVString" style="color:initial">USVString</span>
     <li><span class="dfn-paneled" id="term-for-Unforgeable" style="color:initial">Unforgeable</span>
     <li><span class="dfn-paneled" id="term-for-idl-boolean" style="color:initial">boolean</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-csp-3">[CSP-3]
   <dd>Content Security Policy Level 3 URL: <a href="https://www.w3.org/TR/CSP3/">https://www.w3.org/TR/CSP3/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/">Web IDL</a>. 15 December 2016. ED. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-dom-parsing">[DOM-Parsing]
   <dd>Travis Leithead. <a href="https://www.w3.org/TR/DOM-Parsing/">DOM Parsing and Serialization</a>. 17 May 2016. WD. URL: <a href="https://www.w3.org/TR/DOM-Parsing/">https://www.w3.org/TR/DOM-Parsing/</a>
   <dt id="biblio-html-design-principles">[HTML-DESIGN-PRINCIPLES]
   <dd>Anne van Kesteren; Maciej Stachowiak. <a href="https://www.w3.org/TR/html-design-principles/">HTML Design Principles</a>. 26 November 2007. WD. URL: <a href="https://www.w3.org/TR/html-design-principles/">https://www.w3.org/TR/html-design-principles/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="https://www.w3.org/TR/html5/">HTML5</a>. 27 March 2018. REC. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
   <dt id="biblio-http-jfv">[HTTP-JFV]
   <dd>J. Reschke. <a href="https://tools.ietf.org/html/draft-reschke-http-jfv">A JSON Encoding for HTTP Header Field Values</a>. 24 October 2017. Active Internet-Draft. URL: <a href="https://tools.ietf.org/html/draft-reschke-http-jfv">https://tools.ietf.org/html/draft-reschke-http-jfv</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#trustedhtml"><code><c- g>TrustedHTML</c-></code></a> {
  <a href="#TrustedHTML-stringification-behavior"><c- b>stringifier</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#trustedscript"><code><c- g>TrustedScript</c-></code></a> {
  <a href="#TrustedScript-stringification-behavior"><c- b>stringifier</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#trustedscripturl"><code><c- g>TrustedScriptURL</c-></code></a> {
  <a href="#TrustedScriptURL-stringification-behavior"><c- b>stringifier</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#trustedurl"><code><c- g>TrustedURL</c-></code></a> {
  <a href="#TrustedURL-stringification-behavior"><c- b>stringifier</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④①"><c- g>Exposed</c-></a>=<c- n>Window</c->] <c- b>interface</c-> <a href="#trustedtypepolicyfactory"><code><c- g>TrustedTypePolicyFactory</c-></code></a> {
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①③"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑤①"><c- n>TrustedTypePolicy</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-createpolicy" id="ref-for-dom-trustedtypepolicyfactory-createpolicy②①"><c- g>createPolicy</c-></a>(
        <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②④"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyname"><code><c- g>policyName</c-></code></a>, <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#dictdef-trustedtypepolicyoptions" id="ref-for-dictdef-trustedtypepolicyoptions④"><c- n>TrustedTypePolicyOptions</c-></a> <a href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-policyoptions"><code><c- g>policyOptions</c-></code></a>,
        <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑥"><c- b>boolean</c-></a> <a href="#dom-trustedtypepolicyfactory-createpolicy-policyname-policyoptions-exposed-exposed"><code><c- g>exposed</c-></code></a> = <c- b>false</c->);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①④"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedtypepolicy" id="ref-for-trustedtypepolicy⑥①"><c- n>TrustedTypePolicy</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-getexposedpolicy" id="ref-for-dom-trustedtypepolicyfactory-getexposedpolicy②"><c- g>getExposedPolicy</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①①⓪"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicyfactory-getexposedpolicy-policyname-policyname"><code><c- g>policyName</c-></code></a>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable②①"><c- g>Unforgeable</c-></a>] <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②③"><c- b>DOMString</c-></a>> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-getpolicynames" id="ref-for-dom-trustedtypepolicyfactory-getpolicynames①"><c- g>getPolicyNames</c-></a>();
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable③①"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean①①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-ishtml" id="ref-for-dom-trustedtypepolicyfactory-ishtml①"><c- g>isHTML</c-></a>(<c- b>any</c-> <a href="#dom-trustedtypepolicyfactory-ishtml-value-value"><code><c- g>value</c-></code></a>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable④①"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean②①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isscript" id="ref-for-dom-trustedtypepolicyfactory-isscript①"><c- g>isScript</c-></a>(<c- b>any</c-> <a href="#dom-trustedtypepolicyfactory-isscript-value-value"><code><c- g>value</c-></code></a>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑤①"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean③①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isscripturl" id="ref-for-dom-trustedtypepolicyfactory-isscripturl①"><c- g>isScriptURL</c-></a>(<c- b>any</c-> <a href="#dom-trustedtypepolicyfactory-isscripturl-value-value"><code><c- g>value</c-></code></a>);
    [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑥①"><c- g>Unforgeable</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean④①"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicyfactory-isurl" id="ref-for-dom-trustedtypepolicyfactory-isurl①"><c- g>isURL</c-></a>(<c- b>any</c-> <a href="#dom-trustedtypepolicyfactory-isurl-value-value"><code><c- g>value</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#trustedtypepolicy"><code><c- g>TrustedTypePolicy</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑦①"><c- g>Unforgeable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString③①"><c- b>DOMString</c-></a> <a data-readonly data-type="DOMString" href="#dom-trustedtypepolicy-name"><code><c- g>name</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑧①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml②①"><c- n>TrustedHTML</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createhtml" id="ref-for-dom-trustedtypepolicy-createhtml①①"><c- g>createHTML</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString④①"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicy-createhtml-input-input"><code><c- g>input</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable⑨①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript①①"><c- n>TrustedScript</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createscript" id="ref-for-dom-trustedtypepolicy-createscript①①"><c- g>createScript</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑤①"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicy-createscript-input-input"><code><c- g>input</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①⓪①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl①①"><c- n>TrustedScriptURL</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createscripturl" id="ref-for-dom-trustedtypepolicy-createscripturl①①"><c- g>createScriptURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑥①"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicy-createscripturl-input-input"><code><c- g>input</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①①①"><c- g>Unforgeable</c-></a>] <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl①①"><c- n>TrustedURL</c-></a> <a class="idl-code" data-link-type="method" href="#dom-trustedtypepolicy-createurl" id="ref-for-dom-trustedtypepolicy-createurl①①"><c- g>createURL</c-></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑦①"><c- b>DOMString</c-></a> <a href="#dom-trustedtypepolicy-createurl-input-input"><code><c- g>input</c-></code></a>);
};

<c- b>dictionary</c-> <a href="#dictdef-trustedtypepolicyoptions"><code><c- g>TrustedTypePolicyOptions</c-></code></a> {
   <a class="n" data-link-type="idl-name" href="#callbackdef-createhtmlcallback" id="ref-for-callbackdef-createhtmlcallback①"><c- n>CreateHTMLCallback</c-></a>? <a data-type="CreateHTMLCallback? " href="#dom-trustedtypepolicyoptions-createhtml"><code><c- g>createHTML</c-></code></a>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createscriptcallback" id="ref-for-callbackdef-createscriptcallback①"><c- n>CreateScriptCallback</c-></a>? <a data-type="CreateScriptCallback? " href="#dom-trustedtypepolicyoptions-createscript"><code><c- g>createScript</c-></code></a>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createurlcallback" id="ref-for-callbackdef-createurlcallback①"><c- n>CreateURLCallback</c-></a>? <a data-type="CreateURLCallback? " href="#dom-trustedtypepolicyoptions-createurl"><code><c- g>createURL</c-></code></a>;
   <a class="n" data-link-type="idl-name" href="#callbackdef-createscripturlcallback" id="ref-for-callbackdef-createscripturlcallback①"><c- n>CreateScriptURLCallback</c-></a>? <a data-type="CreateScriptURLCallback? " href="#dom-trustedtypepolicyoptions-createscripturl"><code><c- g>createScriptURL</c-></code></a>;
   <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑤①"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-trustedtypepolicyoptions-exposed"><code><c- g>exposed</c-></code></a> = <c- b>false</c->;
};
<c- b>callback</c-> <a href="#callbackdef-createhtmlcallback"><code><c- g>CreateHTMLCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑧①"><c- b>DOMString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString⑨①"><c- b>DOMString</c-></a> <a href="#dom-createhtmlcallback-input"><code><c- g>input</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-createscriptcallback"><code><c- g>CreateScriptCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⓪①"><c- b>DOMString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①①①"><c- b>DOMString</c-></a> <a href="#dom-createscriptcallback-input"><code><c- g>input</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-createurlcallback"><code><c- g>CreateURLCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString⑤"><c- b>USVString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①②①"><c- b>DOMString</c-></a> <a href="#dom-createurlcallback-input"><code><c- g>input</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-createscripturlcallback"><code><c- g>CreateScriptURLCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString①①"><c- b>USVString</c-></a> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①③①"><c- b>DOMString</c-></a> <a href="#dom-createscripturlcallback-input"><code><c- g>input</c-></code></a>);

<c- b>enum</c-> <a href="#enumdef-stringatsinkdisposition"><code><c- g>StringAtSinkDisposition</c-></code></a> {
  <a href="#dom-stringatsinkdisposition-reject"><code><c- s>"reject"</c-></code></a>,
  <a href="#dom-stringatsinkdisposition-report"><code><c- s>"report"</c-></code></a>,
  <a href="#dom-stringatsinkdisposition-unsafe-allow"><code><c- s>"unsafe-allow"</c-></code></a>,
};

<c- b>enum</c-> <a href="#enumdef-unknownpolicynamedisposition"><code><c- g>UnknownPolicyNameDisposition</c-></code></a> {
  <a href="#dom-unknownpolicynamedisposition-reject"><code><c- s>"reject"</c-></code></a>,
  <a href="#dom-unknownpolicynamedisposition-allow"><code><c- s>"allow"</c-></code></a>,
};

<c- b>dictionary</c-> <a href="#dictdef-trustedtypeconfiguration"><code><c- g>TrustedTypeConfiguration</c-></code></a> {
  <a class="n" data-link-type="idl-name" href="#enumdef-unknownpolicynamedisposition" id="ref-for-enumdef-unknownpolicynamedisposition②"><c- n>UnknownPolicyNameDisposition</c-></a> <a data-default="&quot;allow&quot;" data-type="UnknownPolicyNameDisposition " href="#dom-trustedtypeconfiguration-unknownpolicyname"><code><c- g>unknownPolicyName</c-></code></a> = "allow";
  <a class="n" data-link-type="idl-name" href="#enumdef-stringatsinkdisposition" id="ref-for-enumdef-stringatsinkdisposition③"><c- n>StringAtSinkDisposition</c-></a>? <a data-type="StringAtSinkDisposition? " href="#dom-trustedtypeconfiguration-domsinks"><code><c- g>domSinks</c-></code></a>;
  <c- b>sequence</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①④①"><c- b>DOMString</c-></a>> <a data-type="sequence<DOMString> " href="#dom-trustedtypeconfiguration-allowednames"><code><c- g>allowedNames</c-></code></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑤①"><c- b>DOMString</c-></a> <a data-default="&quot;default&quot;" data-type="DOMString " href="#dom-trustedtypeconfiguration-reportinggroup"><code><c- g>reportingGroup</c-></code></a> = "default";
};

<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑥①"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml④①"><c- n>TrustedHTML</c-></a>) <a href="#typedefdef-htmlstring"><code><c- g>HTMLString</c-></code></a>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑦①"><c- b>DOMString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript③①"><c- n>TrustedScript</c-></a>) <a href="#typedefdef-scriptstring"><code><c- g>ScriptString</c-></code></a>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString②①"><c- b>USVString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl③①"><c- n>TrustedScriptURL</c-></a>) <a href="#typedefdef-scripturlstring"><code><c- g>ScriptURLString</c-></code></a>;
<c- b>typedef</c-> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString" id="ref-for-idl-USVString③①"><c- b>USVString</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl③①"><c- n>TrustedURL</c-></a>) <a href="#typedefdef-urlstring"><code><c- g>URLString</c-></code></a>;
<c- b>typedef</c-> (<a class="n" data-link-type="idl-name" href="#trustedhtml" id="ref-for-trustedhtml⑤①"><c- n>TrustedHTML</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscript" id="ref-for-trustedscript④①"><c- n>TrustedScript</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedscripturl" id="ref-for-trustedscripturl④①"><c- n>TrustedScriptURL</c-></a> <c- b>or</c-> <a class="n" data-link-type="idl-name" href="#trustedurl" id="ref-for-trustedurl④①"><c- n>TrustedURL</c-></a>) <a href="#typedefdef-trustedtype"><code><c- g>TrustedType</c-></code></a>;

<c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/window-object.html#window" id="ref-for-window③①"><c- g>Window</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Unforgeable" id="ref-for-Unforgeable①②①"><c- g>Unforgeable</c-></a>] <c- b>readonly</c-> <c- b>attribute</c->
      <a class="n" data-link-type="idl-name" href="#trustedtypepolicyfactory" id="ref-for-trustedtypepolicyfactory④①"><c- n>TrustedTypePolicyFactory</c-></a> <a data-readonly data-type="TrustedTypePolicyFactory" href="#dom-window-trustedtypes"><code><c- g>TrustedTypes</c-></code></a>;
  <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy" id="ref-for-windowproxy①①"><c- n>WindowProxy</c-></a>? <a href="#dom-window-open"><code><c- g>open</c-></code></a>(
      <c- b>optional</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring①①⓪"><c- n>URLString</c-></a> <a href="#dom-window-open-url-target-features-url"><code><c- g>url</c-></code></a> = "about:blank",
      <c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑧①"><c- b>DOMString</c-></a> <a href="#dom-window-open-url-target-features-target"><code><c- g>target</c-></code></a> = "_blank",
      <c- b>optional</c-> /* [TreatNullAs=EmptyString] */ <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString①⑨①"><c- b>DOMString</c-></a> <a href="#dom-window-open-url-target-features-features"><code><c- g>features</c-></code></a> = "");
};

<c- b>partial</c-> <c- b>interface</c-> <c- b>mixin</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#document" id="ref-for-document⑨①"><c- g>Document</c-></a> {
   <a class="n" data-link-type="idl-name" href="https://html.spec.whatwg.org/multipage/window-object.html#windowproxy" id="ref-for-windowproxy②①"><c- n>WindowProxy</c-></a>? <a href="#dom-document-open"><code><c- g>open</c-></code></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-urlstring" id="ref-for-typedefdef-urlstring③①"><c- n>URLString</c-></a> <a href="#dom-document-open-url-name-features-url"><code><c- g>url</c-></code></a>, <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②⓪①"><c- b>DOMString</c-></a> <a href="#dom-document-open-url-name-features-name"><code><c- g>name</c-></code></a>, <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②①①"><c- b>DOMString</c-></a> <a href="#dom-document-open-url-name-features-features"><code><c- g>features</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions⑥"><c- g>CEReactions</c-></a>] <c- b>void</c-> <a href="#dom-document-write"><code><c- g>write</c-></code></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring①①"><c- n>HTMLString</c-></a>... <a href="#dom-document-write-text-text"><code><c- g>text</c-></code></a>);
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions①①"><c- g>CEReactions</c-></a>] <c- b>void</c-> <a href="#dom-document-writeln"><code><c- g>writeln</c-></code></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring②①"><c- n>HTMLString</c-></a>... <a href="#dom-document-writeln-text-text"><code><c- g>text</c-></code></a>);
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#element" id="ref-for-element③①"><c- g>Element</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions②①"><c- g>CEReactions</c-></a>/*, TreatNullAs=EmptyString */] <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑥①"><c- n>HTMLString</c-></a> <a data-type="HTMLString" href="#dom-element-innerhtml"><code><c- g>innerHTML</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions③①"><c- g>CEReactions</c-></a>/*, TreatNullAs=EmptyString */] <c- b>attribute</c-> <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑦①"><c- n>HTMLString</c-></a> <a data-type="HTMLString" href="#dom-element-outerhtml"><code><c- g>outerHTML</c-></code></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions④①"><c- g>CEReactions</c-></a>] <c- b>void</c-> <a href="#dom-element-insertadjacenthtml"><code><c- g>insertAdjacentHTML</c-></code></a>(<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString" id="ref-for-idl-DOMString②②①"><c- b>DOMString</c-></a> <a href="#dom-element-insertadjacenthtml-position-text-position"><code><c- g>position</c-></code></a>, <a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑧①"><c- n>HTMLString</c-></a> <a href="#dom-element-insertadjacenthtml-position-text-text"><code><c- g>text</c-></code></a>);
};

<c- b>partial</c-> <c- b>interface</c-> <a class="idl-code" data-link-type="interface" href="https://dom.spec.whatwg.org/#range" id="ref-for-range①①"><c- g>Range</c-></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/custom-elements.html#cereactions" id="ref-for-cereactions⑤①"><c- g>CEReactions</c-></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject" id="ref-for-NewObject②"><c- g>NewObject</c-></a>] <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#documentfragment" id="ref-for-documentfragment①"><c- n>DocumentFragment</c-></a> <a href="#dom-range-createcontextualfragment"><code><c- g>createContextualFragment</c-></code></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring⑨①"><c- n>HTMLString</c-></a> <a href="#dom-range-createcontextualfragment-fragment-fragment"><code><c- g>fragment</c-></code></a>);
};

[<a href="#dom-domparser-domparser"><code><c- g>Constructor</c-></code></a>, <a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥①"><c- g>Exposed</c-></a>=<c- n>Window</c->]
<c- b>interface</c-> <a href="#domparser"><code><c- g>DOMParser</c-></code></a> {
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject" id="ref-for-NewObject①①"><c- g>NewObject</c-></a>] <a class="n" data-link-type="idl-name" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①①①"><c- n>Document</c-></a> <a href="#dom-domparser-parsefromstring"><code><c- g>parseFromString</c-></code></a>(<a class="n" data-link-type="idl-name" href="#typedefdef-htmlstring" id="ref-for-typedefdef-htmlstring①⓪①"><c- n>HTMLString</c-></a> <a href="#dom-domparser-parsefromstring-str-type-str"><code><c- g>str</c-></code></a>, <a class="n" data-link-type="idl-name" href="#enumdef-supportedtype" id="ref-for-enumdef-supportedtype①"><c- n>SupportedType</c-></a> <a href="#dom-domparser-parsefromstring-str-type-type"><code><c- g>type</c-></code></a>);
};

// Not modified by this document, but bikeshed is not recognizing
// SupportedType
<c- b>enum</c-> <a href="#enumdef-supportedtype"><code><c- g>SupportedType</c-></code></a> {
  <a href="#dom-supportedtype-text-html"><code><c- s>"text/html"</c-></code></a>,
  <a href="#dom-supportedtype-text-xml"><code><c- s>"text/xml"</c-></code></a>,
  <a href="#dom-supportedtype-application-xml"><code><c- s>"application/xml"</c-></code></a>,
  <a href="#dom-supportedtype-application-xhtmlxml"><code><c- s>"application/xhtml+xml"</c-></code></a>,
  <a href="#dom-supportedtype-image-svgxml"><code><c- s>"image/svg+xml"</c-></code></a>
};

</pre>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> mention other solutions, like templating systems, or CSP for mitigating<a href="#issue-1f1f9f2b"> ↵ </a></div>
   <div class="issue"> figure out if we need this section here. CSP has none, SRI has one and it looks useful.<a href="#issue-d33261f4"> ↵ </a></div>
   <div class="issue"> Something about reducing the review surface<a href="#issue-5bedf486"> ↵ </a></div>
   <div class="issue"> Consider surfacing the DOM sink (node + attr) => type mapping in the API, to faciliate building HTML sanitizers. <a href="https://github.com/WICG/trusted-types/issues/43">&lt;https://github.com/WICG/trusted-types/issues/43></a><a href="#issue-7a6e3d33"> ↵ </a></div>
   <div class="issue"> Add TrustedHTML.EMPTY. <a href="https://github.com/WICG/trusted-types/issues/95">&lt;https://github.com/WICG/trusted-types/issues/95></a><a href="#issue-fee6a803"> ↵ </a></div>
   <div class="issue"> Consider adding new set of types, e.g. related to CSS. <a href="https://github.com/WICG/trusted-types/issues/104">&lt;https://github.com/WICG/trusted-types/issues/104></a><a href="#issue-a6d5e385"> ↵ </a></div>
   <div class="issue"> Decide if it should be possible from JS to determine if types are enforced without resorting to <code>try {} catch</code>. <a href="https://github.com/WICG/trusted-types/issues/36">&lt;https://github.com/WICG/trusted-types/issues/36></a><a href="#issue-d8483bad"> ↵ </a></div>
   <div class="issue"> In the current Chromium implementation, the enforcement mechanism is
configured in the <code>Content-Security-Policy</code> header (instead of <code>Trusted-Types</code>), with slightly different syntax. See <a href="https://github.com/WICG/trusted-types#limiting-policies">explainer</a> and <a href="https://github.com/web-platform-tests/wpt/tree/master/trusted-types">platform test files</a>. <a href="https://github.com/WICG/trusted-types/issues/1">&lt;https://github.com/WICG/trusted-types/issues/1></a><a href="#issue-f6daf6e4"> ↵ </a></div>
   <div class="issue"> +mkwst The header does not appear in the origin trials.  Can
the spec differ so much from the implementation, especially given the
upcoming Origin Trials?<a href="#issue-559d4710"> ↵ </a></div>
   <div class="issue"> Decide if separate per-type enforcement settings should be exposed to the authors. <a href="https://github.com/WICG/trusted-types/issues/66">&lt;https://github.com/WICG/trusted-types/issues/66></a><a href="#issue-20410262"> ↵ </a></div>
   <div class="issue"> it seems to be the case that one object is allowed and it should
appear last, it cannot contain an allowedNames property and the allowedNames
set should be the string values.  Clarify.<a href="#issue-cd9bcfb2"> ↵ </a></div>
   <div class="issue"> maybe treat a string as a configuration that is equivalent to a
configuration that allows just that name and which has the default values
for the other properties and allow <code>{"allowedNames":[...],...}</code>.
This would enable a use case where migrating one tool at a time by having
some policies that are report-only and others that are enforced.<a href="#issue-7d9c4dc9"> ↵ </a></div>
   <div class="issue"> if so, need example of 2 disjoint allowed name sets with different
configurations.<a href="#issue-e1f7a37a"> ↵ </a></div>
   <div class="issue"> what happens if there are 2 configurations with overlapping
allowed name sets?<a href="#issue-ba779f5f"> ↵ </a></div>
   <div class="issue"> does a single configuration with an unknown policy name disposition
of "allow" govern all policy names that appear in no other configuratons.<a href="#issue-e5fdd885"> ↵ </a></div>
   <div class="issue"> how does this relate to webappsec-csp/<a data-link-type="dfn" href="https://w3c.github.io/webappsec-csp/#violation">Violation</a>?<a href="#issue-d1310019"> ↵ </a></div>
   <div class="issue"> TODO: Describe the properties of the violation
Each violation has a configuration , which is a Trusted Type Configuration.
Each violation has a global object , which is a global object.<a href="#issue-cf1ff51c"> ↵ </a></div>
   <div class="issue"> TODO(mkwst): How to serialize? CSP3 has no serialization defined for
the violation object, although reporting assumes the object should be
serializable.<a href="#issue-621e48db"> ↵ </a></div>
   <div class="issue"> How does a policy violation get reported (both at the sink
level, and when creating a policy).<a href="#issue-de6065a2"> ↵ </a></div>
   <div class="issue"> does configuration need to be defensively copied.<a href="#issue-281b8e3f"> ↵ </a></div>
   <div class="issue"> A trailing comma should not disable enforcement.  Do we
need to leave the document in a locked down state?
Maybe set <em>config</em>.domSinks to "reject" and return <em>config</em>.<a href="#issue-6648a1f5"> ↵ </a></div>
   <div class="issue"> <em>input</em> could also be a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function">Function</a></code>, e.g. for <code>setTimeout</code>.  Maybe add <code>or Function</code> to <code>ScriptString</code> and rename to avoid confusion.<a href="#issue-27865f4d"> ↵ </a></div>
   <div class="issue"> Make it clear that no reporting is done when <em>disposition</em> is <code>unsafe-allow</code>.<a href="#issue-5437ea14"> ↵ </a></div>
   <div class="issue"> In step 1, refer to the internal slot in Document or the IDL additions to document that store the configuration.<a href="#issue-e10bac35"> ↵ </a></div>
   <div class="issue"> Do we need some "resume below" language?<a href="#issue-90794f3a"> ↵ </a></div>
   <div class="issue"> can we use "<em>compliantValue</em> is an error" language here?<a href="#issue-bb8c9be7"> ↵ </a></div>
   <div class="issue"> TODO: write and link to it<a href="#issue-d9f0b628"> ↵ </a></div>
   <div class="issue"> Check that this algorithm is complete.<a href="#issue-d66da75e"> ↵ </a></div>
   <div class="issue"> removed <a href="https://heycam.github.io/webidl/#TreatNullAs">TreatNullAs=EmptyString</a> from
features parameter which is not recognized by bikeshed.  Maybe there’s
additional configuration required.  See "It should not be used in
specifications unless ..."<a href="#issue-f74e9f32"> ↵ </a></div>
   <div class="issue"> Issue: Might require modifying the more-generic <a href="https://html.spec.whatwg.org/multipage/#dom-innertext">HTML Standard §dom-innertext</a> setter algorithm. <a href="#issue-7fe0f731"> ↵ </a></div>
   <div class="issue"> Issue: Might require modifying the more-generic <a href="https://dom.spec.whatwg.org/#dom-node-textcontent">DOM Standard §dom-node-textcontent</a> setter algorithm. <a href="#issue-7fe0f731①"> ↵ </a></div>
   <div class="issue"> Issue: IDL linking does not recognize HTMLInputElement/formAction even though
    it is defined in <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>. <a href="#issue-f5fb6f99"> ↵ </a></div>
   <div class="issue"> removed <a href="https://heycam.github.io/webidl/#TreatNullAs">TreatNullAs=EmptyString</a> from
features parameter which is not recognized by bikeshed.  Maybe there’s
additional configuration required.  See "It should not be used in
specifications unless ..."<a href="#issue-f74e9f32①"> ↵ </a></div>
   <div class="issue"> TreatNullAs is confusing, as for TrustedHTML, for some sinks a ull value will result in "", and "null" for others. This already caused problems in the polyfill. <a href="https://github.com/WICG/trusted-types/issues/2">&lt;https://github.com/WICG/trusted-types/issues/2></a><a href="#issue-d48d676e"> ↵ </a></div>
   <div class="issue"> IDL linkage broken for SupportedType but I don’t want DOMParser to not
show up in the IDL summary.<a href="#issue-8efca2f1"> ↵ </a></div>
   <div class="issue"> Do we need to specify that the enforcement type is <code class="idl"><a data-link-type="idl" href="#trustedhtml">TrustedHTML</a></code>, or
that it is dependent on <em>type</em> which may be <code>"image/svg+xml"</code> or generic XML?<a href="#issue-4b9885e1"> ↵ </a></div>
   <div class="issue"> Mention node-adoption bypass vectors. <a href="https://github.com/WICG/trusted-types/issues/49">&lt;https://github.com/WICG/trusted-types/issues/49></a><a href="#issue-31966331"> ↵ </a></div>
   <div class="issue"> Mention anchor element properties bypass. <a href="https://github.com/WICG/trusted-types/issues/64">&lt;https://github.com/WICG/trusted-types/issues/64></a><a href="#issue-1c3973fc"> ↵ </a></div>
   <div class="issue"> Mention text/attribute node copy bypass vectors. <a href="https://github.com/WICG/trusted-types/issues/47">&lt;https://github.com/WICG/trusted-types/issues/47></a><a href="#issue-fb0cfdf0"> ↵ </a></div>
   <div class="issue"> Mention bypass vectors with template elements. <a href="https://github.com/WICG/trusted-types/issues/42">&lt;https://github.com/WICG/trusted-types/issues/42></a><a href="#issue-80906c67"> ↵ </a></div>
   <div class="issue"> Mention corner cases with types that depend on a different attribute value. <a href="https://github.com/WICG/trusted-types/issues/6">&lt;https://github.com/WICG/trusted-types/issues/6></a><a href="#issue-f9e3242a"> ↵ </a></div>
   <div class="issue"> Mention the policy is global state-dependant. <a href="https://github.com/WICG/trusted-types/issues/78">&lt;https://github.com/WICG/trusted-types/issues/78></a><a href="#issue-fe3b0564"> ↵ </a></div>
   <div class="issue"> Refer to the external document on secure policy design.<a href="#issue-2eb927d2"> ↵ </a></div>
  </div>
  <aside class="dfn-panel" data-for="injection-sink">
   <b><a href="#injection-sink">#injection-sink</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-injection-sink">2.1. Injection sinks</a>
    <li><a href="#ref-for-injection-sink①">2.2. Trusted Types</a>
    <li><a href="#ref-for-injection-sink②">2.2.1. TrustedHTML</a>
    <li><a href="#ref-for-injection-sink③">2.2.2. TrustedScript</a>
    <li><a href="#ref-for-injection-sink④">2.2.3. TrustedScriptURL</a>
    <li><a href="#ref-for-injection-sink⑤">2.2.4. TrustedURL</a>
    <li><a href="#ref-for-injection-sink⑥">2.3. Policies</a>
    <li><a href="#ref-for-injection-sink⑦">2.3.4. Default policy</a>
    <li><a href="#ref-for-injection-sink⑧">2.4. Enforcement</a>
    <li><a href="#ref-for-injection-sink⑨">2.4.2. Trusted-Types HTTP Response Header</a> <a href="#ref-for-injection-sink①⓪">(2)</a> <a href="#ref-for-injection-sink①①">(3)</a> <a href="#ref-for-injection-sink①②">(4)</a> <a href="#ref-for-injection-sink①③">(5)</a> <a href="#ref-for-injection-sink①④">(6)</a>
    <li><a href="#ref-for-injection-sink①⑤">3.2.2. Get Trusted Type compliant string</a>
    <li><a href="#ref-for-injection-sink①⑥">3.2.3. Enforce a Trusted Type</a> <a href="#ref-for-injection-sink①⑦">(2)</a>
    <li><a href="#ref-for-injection-sink①⑧">6.1. Vendor-specific Extensions and Addons</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trusted-type">
   <b><a href="#trusted-type">#trusted-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trusted-type">2.3. Policies</a>
    <li><a href="#ref-for-trusted-type①">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trusted-type②">2.3.3. TrustedTypePolicyOptions</a>
    <li><a href="#ref-for-trusted-type③">2.4. Enforcement</a>
    <li><a href="#ref-for-trusted-type④">2.4.1. TrustedTypeConfiguration</a>
    <li><a href="#ref-for-trusted-type⑤">3.2.2. Get Trusted Type compliant string</a>
    <li><a href="#ref-for-trusted-type⑥">3.2.3. Enforce a Trusted Type</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedhtml">
   <b><a href="#trustedhtml">#trustedhtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedhtml">2.3. Policies</a>
    <li><a href="#ref-for-trustedhtml①">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trustedhtml②">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-trustedhtml③">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-trustedhtml④">4. Integrations</a> <a href="#ref-for-trustedhtml⑤">(2)</a>
    <li><a href="#ref-for-trustedhtml⑥">4.1.6. Enforcement in document write steps</a>
    <li><a href="#ref-for-trustedhtml⑦">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedscript">
   <b><a href="#trustedscript">#trustedscript</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedscript">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trustedscript①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-trustedscript②">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-trustedscript③">4. Integrations</a> <a href="#ref-for-trustedscript④">(2)</a>
    <li><a href="#ref-for-trustedscript⑤">4.1.8. Enforcement in timer functions</a> <a href="#ref-for-trustedscript⑥">(2)</a>
    <li><a href="#ref-for-trustedscript⑦">4.1.9. Enforcement in event handler content attributes</a>
    <li><a href="#ref-for-trustedscript⑧">4.1.10. String compilation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedscripturl">
   <b><a href="#trustedscripturl">#trustedscripturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedscripturl">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trustedscripturl①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-trustedscripturl②">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-trustedscripturl③">4. Integrations</a> <a href="#ref-for-trustedscripturl④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedurl">
   <b><a href="#trustedurl">#trustedurl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedurl">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trustedurl①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-trustedurl②">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-trustedurl③">4. Integrations</a> <a href="#ref-for-trustedurl④">(2)</a>
    <li><a href="#ref-for-trustedurl⑤">4.1.4. Enforcement in window open steps algorithm</a>
    <li><a href="#ref-for-trustedurl⑥">4.1.5. Enforcement in Location navigation algorithm</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedtypepolicyfactory">
   <b><a href="#trustedtypepolicyfactory">#trustedtypepolicyfactory</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedtypepolicyfactory">3.1.1. Initialize policy factory</a> <a href="#ref-for-trustedtypepolicyfactory①">(2)</a>
    <li><a href="#ref-for-trustedtypepolicyfactory②">3.1.2. Create a Trusted Type Policy</a>
    <li><a href="#ref-for-trustedtypepolicyfactory③">4.1. Integration with HTML</a>
    <li><a href="#ref-for-trustedtypepolicyfactory④">4.1.2. Extensions to the Window interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-createpolicy">
   <b><a href="#dom-trustedtypepolicyfactory-createpolicy">#dom-trustedtypepolicyfactory-createpolicy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-createpolicy">2.3. Policies</a> <a href="#ref-for-dom-trustedtypepolicyfactory-createpolicy①">(2)</a>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-createpolicy②">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-getpolicynames">
   <b><a href="#dom-trustedtypepolicyfactory-getpolicynames">#dom-trustedtypepolicyfactory-getpolicynames</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-getpolicynames">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-getexposedpolicy">
   <b><a href="#dom-trustedtypepolicyfactory-getexposedpolicy">#dom-trustedtypepolicyfactory-getexposedpolicy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-getexposedpolicy">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-dom-trustedtypepolicyfactory-getexposedpolicy①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-ishtml">
   <b><a href="#dom-trustedtypepolicyfactory-ishtml">#dom-trustedtypepolicyfactory-ishtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-ishtml">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-isscript">
   <b><a href="#dom-trustedtypepolicyfactory-isscript">#dom-trustedtypepolicyfactory-isscript</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-isscript">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-isscripturl">
   <b><a href="#dom-trustedtypepolicyfactory-isscripturl">#dom-trustedtypepolicyfactory-isscripturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-isscripturl">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyfactory-isurl">
   <b><a href="#dom-trustedtypepolicyfactory-isurl">#dom-trustedtypepolicyfactory-isurl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyfactory-isurl">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trustedtypepolicy">
   <b><a href="#trustedtypepolicy">#trustedtypepolicy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trustedtypepolicy">2.2.1. TrustedHTML</a>
    <li><a href="#ref-for-trustedtypepolicy①">2.2.2. TrustedScript</a>
    <li><a href="#ref-for-trustedtypepolicy②">2.2.3. TrustedScriptURL</a>
    <li><a href="#ref-for-trustedtypepolicy③">2.2.4. TrustedURL</a>
    <li><a href="#ref-for-trustedtypepolicy④">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-trustedtypepolicy⑤">(2)</a> <a href="#ref-for-trustedtypepolicy⑥">(3)</a>
    <li><a href="#ref-for-trustedtypepolicy⑦">2.3.3. TrustedTypePolicyOptions</a>
    <li><a href="#ref-for-trustedtypepolicy⑧">3.1.2. Create a Trusted Type Policy</a> <a href="#ref-for-trustedtypepolicy⑨">(2)</a>
    <li><a href="#ref-for-trustedtypepolicy①⓪">3.1.7. Create a Trusted Type</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicy-createhtml">
   <b><a href="#dom-trustedtypepolicy-createhtml">#dom-trustedtypepolicy-createhtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicy-createhtml">2.2.1. TrustedHTML</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createhtml①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createhtml②">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicy-createscript">
   <b><a href="#dom-trustedtypepolicy-createscript">#dom-trustedtypepolicy-createscript</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscript">2.2.2. TrustedScript</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscript①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscript②">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicy-createscripturl">
   <b><a href="#dom-trustedtypepolicy-createscripturl">#dom-trustedtypepolicy-createscripturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscripturl">2.2.3. TrustedScriptURL</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscripturl①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createscripturl②">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicy-createurl">
   <b><a href="#dom-trustedtypepolicy-createurl">#dom-trustedtypepolicy-createurl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicy-createurl">2.2.4. TrustedURL</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createurl①">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-dom-trustedtypepolicy-createurl②">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-trustedtypepolicyoptions">
   <b><a href="#dictdef-trustedtypepolicyoptions">#dictdef-trustedtypepolicyoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-trustedtypepolicyoptions">2.3.1. TrustedTypePolicyFactory</a> <a href="#ref-for-dictdef-trustedtypepolicyoptions①">(2)</a>
    <li><a href="#ref-for-dictdef-trustedtypepolicyoptions②">2.3.2. TrustedTypePolicy</a>
    <li><a href="#ref-for-dictdef-trustedtypepolicyoptions③">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyoptions-createhtml">
   <b><a href="#dom-trustedtypepolicyoptions-createhtml">#dom-trustedtypepolicyoptions-createhtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyoptions-createhtml">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyoptions-createscript">
   <b><a href="#dom-trustedtypepolicyoptions-createscript">#dom-trustedtypepolicyoptions-createscript</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyoptions-createscript">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyoptions-createurl">
   <b><a href="#dom-trustedtypepolicyoptions-createurl">#dom-trustedtypepolicyoptions-createurl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyoptions-createurl">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyoptions-createscripturl">
   <b><a href="#dom-trustedtypepolicyoptions-createscripturl">#dom-trustedtypepolicyoptions-createscripturl</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyoptions-createscripturl">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypepolicyoptions-exposed">
   <b><a href="#dom-trustedtypepolicyoptions-exposed">#dom-trustedtypepolicyoptions-exposed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypepolicyoptions-exposed">3.1.3. Get exposed policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-createhtmlcallback">
   <b><a href="#callbackdef-createhtmlcallback">#callbackdef-createhtmlcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-createhtmlcallback">2.3.3. TrustedTypePolicyOptions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-createscriptcallback">
   <b><a href="#callbackdef-createscriptcallback">#callbackdef-createscriptcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-createscriptcallback">2.3.3. TrustedTypePolicyOptions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-createurlcallback">
   <b><a href="#callbackdef-createurlcallback">#callbackdef-createurlcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-createurlcallback">2.3.3. TrustedTypePolicyOptions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-createscripturlcallback">
   <b><a href="#callbackdef-createscripturlcallback">#callbackdef-createscripturlcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-createscripturlcallback">2.3.3. TrustedTypePolicyOptions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-policy">
   <b><a href="#default-policy">#default-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-policy">2.4.2. Trusted-Types HTTP Response Header</a>
    <li><a href="#ref-for-default-policy①">3.1.4. Get default policy</a>
    <li><a href="#ref-for-default-policy②">6.1. Vendor-specific Extensions and Addons</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-stringatsinkdisposition">
   <b><a href="#enumdef-stringatsinkdisposition">#enumdef-stringatsinkdisposition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-stringatsinkdisposition">2.4.1. TrustedTypeConfiguration</a> <a href="#ref-for-enumdef-stringatsinkdisposition①">(2)</a>
    <li><a href="#ref-for-enumdef-stringatsinkdisposition②">3.2.1. Obtain a Trusted Type Configuration for a response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-unknownpolicynamedisposition">
   <b><a href="#enumdef-unknownpolicynamedisposition">#enumdef-unknownpolicynamedisposition</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-unknownpolicynamedisposition">2.4.1. TrustedTypeConfiguration</a> <a href="#ref-for-enumdef-unknownpolicynamedisposition①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-trustedtypeconfiguration">
   <b><a href="#dictdef-trustedtypeconfiguration">#dictdef-trustedtypeconfiguration</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration①">2.4.3. Violation</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration②">3.1.1. Initialize policy factory</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration③">3.2.1. Obtain a Trusted Type Configuration for a response</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration④">3.2.5. Report sink type mismatch violation</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration⑤">4.1. Integration with HTML</a>
    <li><a href="#ref-for-dictdef-trustedtypeconfiguration⑥">6.1. Vendor-specific Extensions and Addons</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypeconfiguration-unknownpolicyname">
   <b><a href="#dom-trustedtypeconfiguration-unknownpolicyname">#dom-trustedtypeconfiguration-unknownpolicyname</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-unknownpolicyname">3.1.5. Is policy name allowed</a>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-unknownpolicyname①">3.2.1. Obtain a Trusted Type Configuration for a response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypeconfiguration-domsinks">
   <b><a href="#dom-trustedtypeconfiguration-domsinks">#dom-trustedtypeconfiguration-domsinks</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-domsinks">3.2.1. Obtain a Trusted Type Configuration for a response</a>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-domsinks①">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypeconfiguration-allowednames">
   <b><a href="#dom-trustedtypeconfiguration-allowednames">#dom-trustedtypeconfiguration-allowednames</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-allowednames">3.1.5. Is policy name allowed</a>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-allowednames①">3.2.1. Obtain a Trusted Type Configuration for a response</a> <a href="#ref-for-dom-trustedtypeconfiguration-allowednames②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-trustedtypeconfiguration-reportinggroup">
   <b><a href="#dom-trustedtypeconfiguration-reportinggroup">#dom-trustedtypeconfiguration-reportinggroup</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-reportinggroup">3.2.1. Obtain a Trusted Type Configuration for a response</a>
    <li><a href="#ref-for-dom-trustedtypeconfiguration-reportinggroup①">3.2.5. Report sink type mismatch violation</a> <a href="#ref-for-dom-trustedtypeconfiguration-reportinggroup②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="trusted-types-http-response-header">
   <b><a href="#trusted-types-http-response-header">#trusted-types-http-response-header</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-trusted-types-http-response-header">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-trusted-types-http-response-header①">3.2.1. Obtain a Trusted Type Configuration for a response</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-initialize-policy-factory">
   <b><a href="#abstract-opdef-initialize-policy-factory">#abstract-opdef-initialize-policy-factory</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-initialize-policy-factory">4.1.1. Initialize a Document’s trusted type configuration algorithm</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-create-a-trusted-type-policy">
   <b><a href="#abstract-opdef-create-a-trusted-type-policy">#abstract-opdef-create-a-trusted-type-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-create-a-trusted-type-policy">2.3.1. TrustedTypePolicyFactory</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-get-exposed-policy">
   <b><a href="#abstract-opdef-get-exposed-policy">#abstract-opdef-get-exposed-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-get-exposed-policy">2.3.1. TrustedTypePolicyFactory</a>
    <li><a href="#ref-for-abstract-opdef-get-exposed-policy①">3.1.4. Get default policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-get-default-policy">
   <b><a href="#abstract-opdef-get-default-policy">#abstract-opdef-get-default-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-get-default-policy">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-is-policy-name-allowed">
   <b><a href="#abstract-opdef-is-policy-name-allowed">#abstract-opdef-is-policy-name-allowed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-is-policy-name-allowed">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-is-a-default-policy">
   <b><a href="#abstract-opdef-is-a-default-policy">#abstract-opdef-is-a-default-policy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-is-a-default-policy">3.1.2. Create a Trusted Type Policy</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-create-a-trusted-type">
   <b><a href="#abstract-opdef-create-a-trusted-type">#abstract-opdef-create-a-trusted-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-create-a-trusted-type">2.3.2. TrustedTypePolicy</a> <a href="#ref-for-abstract-opdef-create-a-trusted-type①">(2)</a> <a href="#ref-for-abstract-opdef-create-a-trusted-type②">(3)</a> <a href="#ref-for-abstract-opdef-create-a-trusted-type③">(4)</a>
    <li><a href="#ref-for-abstract-opdef-create-a-trusted-type④">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">
   <b><a href="#abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">#abstract-opdef-obtain-a-trusted-type-configuration-for-a-response</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-obtain-a-trusted-type-configuration-for-a-response">4.1.1. Initialize a Document’s trusted type configuration algorithm</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-get-trusted-type-compliant-string">
   <b><a href="#abstract-opdef-get-trusted-type-compliant-string">#abstract-opdef-get-trusted-type-compliant-string</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string①">4.1.4. Enforcement in window open steps algorithm</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string②">4.1.5. Enforcement in Location navigation algorithm</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string③">4.1.6. Enforcement in document write steps</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string④">4.1.8. Enforcement in timer functions</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string⑤">4.1.9. Enforcement in event handler content attributes</a>
    <li><a href="#ref-for-abstract-opdef-get-trusted-type-compliant-string⑥">4.1.10. String compilation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-enforce-a-trusted-type">
   <b><a href="#abstract-opdef-enforce-a-trusted-type">#abstract-opdef-enforce-a-trusted-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-enforce-a-trusted-type">4.2.1. Extensions to the Element interface</a> <a href="#ref-for-abstract-opdef-enforce-a-trusted-type①">(2)</a>
    <li><a href="#ref-for-abstract-opdef-enforce-a-trusted-type②">4.2.2. Extensions to the Range interface</a>
    <li><a href="#ref-for-abstract-opdef-enforce-a-trusted-type③">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enforcement①">
   <b><a href="#enforcement①">#enforcement①</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enforcement①">2.3. Policies</a> <a href="#ref-for-enforcement①①">(2)</a>
    <li><a href="#ref-for-enforcement①②">2.3.4. Default policy</a>
    <li><a href="#ref-for-enforcement①③">2.4.1. TrustedTypeConfiguration</a>
    <li><a href="#ref-for-enforcement①④">3.2.1. Obtain a Trusted Type Configuration for a response</a>
    <li><a href="#ref-for-enforcement①⑤">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-report-sink-type-mismatch-violation">
   <b><a href="#abstract-opdef-report-sink-type-mismatch-violation">#abstract-opdef-report-sink-type-mismatch-violation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-report-sink-type-mismatch-violation">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-htmlstring">
   <b><a href="#typedefdef-htmlstring">#typedefdef-htmlstring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-htmlstring">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-typedefdef-htmlstring①">4.1.3. Extensions to the Document interface</a> <a href="#ref-for-typedefdef-htmlstring②">(2)</a>
    <li><a href="#ref-for-typedefdef-htmlstring③">4.1.6. Enforcement in document write steps</a>
    <li><a href="#ref-for-typedefdef-htmlstring④">4.1.7. Enforcement in property sinks</a> <a href="#ref-for-typedefdef-htmlstring⑤">(2)</a>
    <li><a href="#ref-for-typedefdef-htmlstring⑥">4.2.1. Extensions to the Element interface</a> <a href="#ref-for-typedefdef-htmlstring⑦">(2)</a> <a href="#ref-for-typedefdef-htmlstring⑧">(3)</a>
    <li><a href="#ref-for-typedefdef-htmlstring⑨">4.2.2. Extensions to the Range interface</a>
    <li><a href="#ref-for-typedefdef-htmlstring①⓪">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-scriptstring">
   <b><a href="#typedefdef-scriptstring">#typedefdef-scriptstring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-scriptstring">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-typedefdef-scriptstring①">4.1.7. Enforcement in property sinks</a> <a href="#ref-for-typedefdef-scriptstring②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-scripturlstring">
   <b><a href="#typedefdef-scripturlstring">#typedefdef-scripturlstring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-scripturlstring">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-typedefdef-scripturlstring①">4.1.7. Enforcement in property sinks</a> <a href="#ref-for-typedefdef-scripturlstring②">(2)</a> <a href="#ref-for-typedefdef-scripturlstring③">(3)</a> <a href="#ref-for-typedefdef-scripturlstring④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-urlstring">
   <b><a href="#typedefdef-urlstring">#typedefdef-urlstring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-urlstring">3.2.3. Enforce a Trusted Type</a>
    <li><a href="#ref-for-typedefdef-urlstring①">4.1.2. Extensions to the Window interface</a> <a href="#ref-for-typedefdef-urlstring②">(2)</a>
    <li><a href="#ref-for-typedefdef-urlstring③">4.1.3. Extensions to the Document interface</a>
    <li><a href="#ref-for-typedefdef-urlstring④">4.1.4. Enforcement in window open steps algorithm</a>
    <li><a href="#ref-for-typedefdef-urlstring⑤">4.1.7. Enforcement in property sinks</a> <a href="#ref-for-typedefdef-urlstring⑥">(2)</a> <a href="#ref-for-typedefdef-urlstring⑦">(3)</a> <a href="#ref-for-typedefdef-urlstring⑧">(4)</a> <a href="#ref-for-typedefdef-urlstring⑨">(5)</a> <a href="#ref-for-typedefdef-urlstring①⓪">(6)</a> <a href="#ref-for-typedefdef-urlstring①①">(7)</a> <a href="#ref-for-typedefdef-urlstring①②">(8)</a> <a href="#ref-for-typedefdef-urlstring①③">(9)</a> <a href="#ref-for-typedefdef-urlstring①④">(10)</a> <a href="#ref-for-typedefdef-urlstring①⑤">(11)</a> <a href="#ref-for-typedefdef-urlstring①⑥">(12)</a> <a href="#ref-for-typedefdef-urlstring①⑦">(13)</a> <a href="#ref-for-typedefdef-urlstring①⑧">(14)</a> <a href="#ref-for-typedefdef-urlstring①⑨">(15)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-trustedtype">
   <b><a href="#typedefdef-trustedtype">#typedefdef-trustedtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-trustedtype">3.2.2. Get Trusted Type compliant string</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-window-trustedtypes">
   <b><a href="#dom-window-trustedtypes">#dom-window-trustedtypes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-trustedtypes">4.1. Integration with HTML</a>
    <li><a href="#ref-for-dom-window-trustedtypes①">4.1.1. Initialize a Document’s trusted type configuration algorithm</a>
    <li><a href="#ref-for-dom-window-trustedtypes②">4.1.2. Extensions to the Window interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-window-open">
   <b><a href="#dom-window-open">#dom-window-open</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-window-open">4.1.2. Extensions to the Window interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-innerhtml">
   <b><a href="#dom-element-innerhtml">#dom-element-innerhtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-innerhtml">4.2.1. Extensions to the Element interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-outerhtml">
   <b><a href="#dom-element-outerhtml">#dom-element-outerhtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-outerhtml">4.2.1. Extensions to the Element interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-element-insertadjacenthtml">
   <b><a href="#dom-element-insertadjacenthtml">#dom-element-insertadjacenthtml</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-element-insertadjacenthtml">4.2.1. Extensions to the Element interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-range-createcontextualfragment">
   <b><a href="#dom-range-createcontextualfragment">#dom-range-createcontextualfragment</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-range-createcontextualfragment">4.2.2. Extensions to the Range interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="domparser">
   <b><a href="#domparser">#domparser</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-domparser">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-domparser-parsefromstring">
   <b><a href="#dom-domparser-parsefromstring">#dom-domparser-parsefromstring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-domparser-parsefromstring">2.1. Injection sinks</a>
    <li><a href="#ref-for-dom-domparser-parsefromstring①">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-supportedtype">
   <b><a href="#enumdef-supportedtype">#enumdef-supportedtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-supportedtype">4.2.3. Extensions to the DOMParser interface</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>