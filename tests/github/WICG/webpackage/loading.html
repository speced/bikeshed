<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Loading Signed Exchanges</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <link href="https://www.w3.org/StyleSheets/TR/2021/cg-draft" rel="stylesheet">
  <link href="https://wicg.github.io/webpackage/loading.html" rel="canonical">
<style>/* Boilerplate: style-autolinks */
.css.css, .property.property, .descriptor.descriptor {
    color: var(--a-normal-text);
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}

@media (prefers-color-scheme: dark) {
    :root {
        --selflink-text: black;
        --selflink-bg: silver;
        --selflink-hover-text: white;
    }
}
</style>
<style>/* Boilerplate: style-colors */

/* Any --*-text not paired with a --*-bg is assumed to have a transparent bg */
:root {
    color-scheme: light dark;

    --text: black;
    --bg: white;

    --unofficial-watermark: url(https://www.w3.org/StyleSheets/TR/2016/logos/UD-watermark);

    --logo-bg: #1a5e9a;
    --logo-active-bg: #c00;
    --logo-text: white;

    --tocnav-normal-text: #707070;
    --tocnav-normal-bg: var(--bg);
    --tocnav-hover-text: var(--tocnav-normal-text);
    --tocnav-hover-bg: #f8f8f8;
    --tocnav-active-text: #c00;
    --tocnav-active-bg: var(--tocnav-normal-bg);

    --tocsidebar-text: var(--text);
    --tocsidebar-bg: #f7f8f9;
    --tocsidebar-shadow: rgba(0,0,0,.1);
    --tocsidebar-heading-text: hsla(203,20%,40%,.7);

    --toclink-text: var(--text);
    --toclink-underline: #3980b5;
    --toclink-visited-text: var(--toclink-text);
    --toclink-visited-underline: #054572;

    --heading-text: #005a9c;

    --hr-text: var(--text);

    --algo-border: #def;

    --del-text: red;
    --del-bg: transparent;
    --ins-text: #080;
    --ins-bg: transparent;

    --a-normal-text: #034575;
    --a-normal-underline: #bbb;
    --a-visited-text: var(--a-normal-text);
    --a-visited-underline: #707070;
    --a-hover-bg: rgba(75%, 75%, 75%, .25);
    --a-active-text: #c00;
    --a-active-underline: #c00;

    --blockquote-border: silver;
    --blockquote-bg: transparent;
    --blockquote-text: currentcolor;

    --issue-border: #e05252;
    --issue-bg: #fbe9e9;
    --issue-text: var(--text);
    --issueheading-text: #831616;

    --example-border: #e0cb52;
    --example-bg: #fcfaee;
    --example-text: var(--text);
    --exampleheading-text: #574b0f;

    --note-border: #52e052;
    --note-bg: #e9fbe9;
    --note-text: var(--text);
    --noteheading-text: hsl(120, 70%, 30%);
    --notesummary-underline: silver;

    --assertion-border: #aaa;
    --assertion-bg: #eee;
    --assertion-text: black;

    --advisement-border: orange;
    --advisement-bg: #fec;
    --advisement-text: var(--text);
    --advisementheading-text: #b35f00;

    --warning-border: red;
    --warning-bg: hsla(40,100%,50%,0.95);
    --warning-text: var(--text);

    --amendment-border: #330099;
    --amendment-bg: #F5F0FF;
    --amendment-text: var(--text);
    --amendmentheading-text: #220066;

    --def-border: #8ccbf2;
    --def-bg: #def;
    --def-text: var(--text);
    --defrow-border: #bbd7e9;

    --datacell-border: silver;

    --indexinfo-text: #707070;

    --indextable-hover-text: black;
    --indextable-hover-bg: #f7f8f9;

    --outdatedspec-bg: rgba(0, 0, 0, .5);
    --outdatedspec-text: black;
    --outdated-bg: maroon;
    --outdated-text: white;
    --outdated-shadow: red;

    --editedrec-bg: darkorange;
}

@media (prefers-color-scheme: dark) {
    :root {
        --text: #ddd;
        --bg: black;

        --unofficial-watermark: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cg fill='%23100808' transform='translate(200 200) rotate(-45) translate(-200 -200)' stroke='%23100808' stroke-width='3'%3E%3Ctext x='50%25' y='220' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EUNOFFICIAL%3C/text%3E%3Ctext x='50%25' y='305' style='font: bold 70px sans-serif; text-anchor: middle; letter-spacing: 6px;'%3EDRAFT%3C/text%3E%3C/g%3E%3C/svg%3E");

        --logo-bg: #1a5e9a;
        --logo-active-bg: #c00;
        --logo-text: white;

        --tocnav-normal-text: #999;
        --tocnav-normal-bg: var(--bg);
        --tocnav-hover-text: var(--tocnav-normal-text);
        --tocnav-hover-bg: #080808;
        --tocnav-active-text: #f44;
        --tocnav-active-bg: var(--tocnav-normal-bg);

        --tocsidebar-text: var(--text);
        --tocsidebar-bg: #080808;
        --tocsidebar-shadow: rgba(255,255,255,.1);
        --tocsidebar-heading-text: hsla(203,20%,40%,.7);

        --toclink-text: var(--text);
        --toclink-underline: #6af;
        --toclink-visited-text: var(--toclink-text);
        --toclink-visited-underline: #054572;

        --heading-text: #8af;

        --hr-text: var(--text);

        --algo-border: #456;

        --del-text: #f44;
        --del-bg: transparent;
        --ins-text: #4a4;
        --ins-bg: transparent;

        --a-normal-text: #6af;
        --a-normal-underline: #555;
        --a-visited-text: var(--a-normal-text);
        --a-visited-underline: var(--a-normal-underline);
        --a-hover-bg: rgba(25%, 25%, 25%, .2);
        --a-active-text: #f44;
        --a-active-underline: var(--a-active-text);

        --borderedblock-bg: rgba(255, 255, 255, .05);

        --blockquote-border: silver;
        --blockquote-bg: var(--borderedblock-bg);
        --blockquote-text: currentcolor;

        --issue-border: #e05252;
        --issue-bg: var(--borderedblock-bg);
        --issue-text: var(--text);
        --issueheading-text: hsl(0deg, 70%, 70%);

        --example-border: hsl(50deg, 90%, 60%);
        --example-bg: var(--borderedblock-bg);
        --example-text: var(--text);
        --exampleheading-text: hsl(50deg, 70%, 70%);

        --note-border: hsl(120deg, 100%, 35%);
        --note-bg: var(--borderedblock-bg);
        --note-text: var(--text);
        --noteheading-text: hsl(120, 70%, 70%);
        --notesummary-underline: silver;

        --assertion-border: #444;
        --assertion-bg: var(--borderedblock-bg);
        --assertion-text: var(--text);

        --advisement-border: orange;
        --advisement-bg: #222218;
        --advisement-text: var(--text);
        --advisementheading-text: #f84;

        --warning-border: red;
        --warning-bg: hsla(40,100%,20%,0.95);
        --warning-text: var(--text);

        --amendment-border: #330099;
        --amendment-bg: #080010;
        --amendment-text: var(--text);
        --amendmentheading-text: #cc00ff;

        --def-border: #8ccbf2;
        --def-bg: #080818;
        --def-text: var(--text);
        --defrow-border: #136;

        --datacell-border: silver;

        --indexinfo-text: #aaa;

        --indextable-hover-text: var(--text);
        --indextable-hover-bg: #181818;

        --outdatedspec-bg: rgba(255, 255, 255, .5);
        --outdatedspec-text: black;
        --outdated-bg: maroon;
        --outdated-text: white;
        --outdated-shadow: red;

        --editedrec-bg: darkorange;
    }
    /* In case a transparent-bg image doesn't expect to be on a dark bg,
       which is quite common in practice... */
    img { background: white; }
}
</style>
<style>/* Boilerplate: style-counters */
body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    /* white-space: pre; /* Do we need this? */
    /* display: inline-block; /* This forces multiple refs to wrap */
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }
</style>
<style>/* Boilerplate: style-dfn-panel */
:root {
    --dfnpanel-bg: #ddd;
    --dfnpanel-text: var(--text);
}
@media (prefers-color-scheme: dark) {
    :root {
        --dfnpanel-bg: #222;
        --dfnpanel-text: var(--text);
    }
}
.dfn-panel {
    position: absolute;
    z-index: 35;
    width: 20em;
    width: 300px;
    height: auto;
    max-height: 500px;
    overflow: auto;
    padding: 0.5em 0.75em;
    font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
    background: var(--dfnpanel-bg);
    color: var(--dfnpanel-text);
    border: outset 0.2em;
    white-space: normal; /* in case it's moved into a pre */
}
.dfn-panel:not(.on) { display: none; }
.dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
.dfn-panel > b { display: block; }
.dfn-panel a { color: var(--dfnpanel-text); }
.dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
.dfn-panel > b + b { margin-top: 0.25em; }
.dfn-panel ul { padding: 0 0 0 1em; list-style: none; }
.dfn-panel li a {
    /* white-space: pre; /* Do we need this? */
    /* display: inline-block; /* This forces multiple refs to wrap */
    max-width: calc(300px - 1.5em - 1em);
    overflow: hidden;
    text-overflow: ellipsis;
}

.dfn-panel.activated {
    display: inline-block;
    position: fixed;
    left: .5em;
    bottom: 2em;
    margin: 0 auto;
    max-width: calc(100vw - 1.5em - .4em - .5em);
    max-height: 30vh;
}

.dfn-panel .link-item:hover {
    text-decoration: underline;
}
.dfn-panel .link-item .copy-icon {
    opacity: 0;
}
.dfn-panel .link-item:hover .copy-icon,
.dfn-panel .link-item .copy-icon:focus {
    opacity: 1;
}

.dfn-panel .copy-icon {
    display: inline-block;
    margin-right: 0.5em;
    width: 0.85em;
    height: 1em;
    border-radius: 3;
    background-color: #ccc;
    cursor: pointer;
}

.dfn-panel .copy-icon .icon {
    width: 100%;
    height: 100%;
    background-color: #fff;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
}

.dfn-panel .copy-icon .icon::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border: 1px solid black;
    background-color: #ccc;
    opacity: 0.25;
    transform: translate(3px, -3px);
}

.dfn-panel .copy-icon:active .icon::before {
    opacity: 1;
}

.dfn-paneled[role="button"] { cursor: help; }
</style>
<style>/* Boilerplate: style-issues */
a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* Boilerplate: style-md-lists */
/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}
</style>
<style>/* Boilerplate: style-selflinks */

:root {
    --selflink-text: white;
    --selflink-bg: gray;
    --selflink-hover-text: black;
}
.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
.example > a.self-link,
.note > a.self-link,
.issue > a.self-link {
    /* These blocks are overflow:auto, so positioning outside
       doesn't work. */
    left: auto;
    right: 0;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: var(--selflink-bg);
    color: var(--selflink-text);
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: var(--selflink-hover-text);
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }
</style>
<style>/* Boilerplate: style-syntax-highlighting */

code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }

.highlight:not(.idl) { background: rgba(0, 0, 0, .03); }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */


@media (prefers-color-scheme: dark) {
    .highlight:not(.idl) { background: rgba(255, 255, 255, .05); }

    c-[a] { color: #d33682 } /* Keyword.Declaration */
    c-[b] { color: #d33682 } /* Keyword.Type */
    c-[c] { color: #2aa198 } /* Comment */
    c-[d] { color: #2aa198 } /* Comment.Multiline */
    c-[e] { color: #268bd2 } /* Name.Attribute */
    c-[f] { color: #b58900 } /* Name.Tag */
    c-[g] { color: #cb4b16 } /* Name.Variable */
    c-[k] { color: #d33682 } /* Keyword */
    c-[l] { color: #657b83 } /* Literal */
    c-[m] { color: #657b83 } /* Literal.Number */
    c-[n] { color: #268bd2 } /* Name */
    c-[o] { color: #657b83 } /* Operator */
    c-[p] { color: #657b83 } /* Punctuation */
    c-[s] { color: #6c71c4 } /* Literal.String */
    c-[t] { color: #6c71c4 } /* Literal.String.Single */
    c-[u] { color: #6c71c4 } /* Literal.String.Double */
    c-[ch] { color: #2aa198 } /* Comment.Hashbang */
    c-[cp] { color: #2aa198 } /* Comment.Preproc */
    c-[cpf] { color: #2aa198 } /* Comment.PreprocFile */
    c-[c1] { color: #2aa198 } /* Comment.Single */
    c-[cs] { color: #2aa198 } /* Comment.Special */
    c-[kc] { color: #d33682 } /* Keyword.Constant */
    c-[kn] { color: #d33682 } /* Keyword.Namespace */
    c-[kp] { color: #d33682 } /* Keyword.Pseudo */
    c-[kr] { color: #d33682 } /* Keyword.Reserved */
    c-[ld] { color: #657b83 } /* Literal.Date */
    c-[nc] { color: #268bd2 } /* Name.Class */
    c-[no] { color: #268bd2 } /* Name.Constant */
    c-[nd] { color: #268bd2 } /* Name.Decorator */
    c-[ni] { color: #268bd2 } /* Name.Entity */
    c-[ne] { color: #268bd2 } /* Name.Exception */
    c-[nf] { color: #268bd2 } /* Name.Function */
    c-[nl] { color: #268bd2 } /* Name.Label */
    c-[nn] { color: #268bd2 } /* Name.Namespace */
    c-[py] { color: #268bd2 } /* Name.Property */
    c-[ow] { color: #657b83 } /* Operator.Word */
    c-[mb] { color: #657b83 } /* Literal.Number.Bin */
    c-[mf] { color: #657b83 } /* Literal.Number.Float */
    c-[mh] { color: #657b83 } /* Literal.Number.Hex */
    c-[mi] { color: #657b83 } /* Literal.Number.Integer */
    c-[mo] { color: #657b83 } /* Literal.Number.Oct */
    c-[sa] { color: #6c71c4 } /* Literal.String.Affix */
    c-[sb] { color: #6c71c4 } /* Literal.String.Backtick */
    c-[sc] { color: #6c71c4 } /* Literal.String.Char */
    c-[dl] { color: #6c71c4 } /* Literal.String.Delimiter */
    c-[sd] { color: #6c71c4 } /* Literal.String.Doc */
    c-[se] { color: #6c71c4 } /* Literal.String.Escape */
    c-[sh] { color: #6c71c4 } /* Literal.String.Heredoc */
    c-[si] { color: #6c71c4 } /* Literal.String.Interpol */
    c-[sx] { color: #6c71c4 } /* Literal.String.Other */
    c-[sr] { color: #6c71c4 } /* Literal.String.Regex */
    c-[ss] { color: #6c71c4 } /* Literal.String.Symbol */
    c-[fm] { color: #268bd2 } /* Name.Function.Magic */
    c-[vc] { color: #cb4b16 } /* Name.Variable.Class */
    c-[vg] { color: #cb4b16 } /* Name.Variable.Global */
    c-[vi] { color: #cb4b16 } /* Name.Variable.Instance */
    c-[vm] { color: #cb4b16 } /* Name.Variable.Magic */
    c-[il] { color: #657b83 } /* Literal.Number.Integer.Long */
}
</style>
<style>/* Boilerplate: style-var-click-highlighting */
/*
Colors were chosen in Lab using https://nixsensor.com/free-color-converter/
D50 2deg illuminant, L in [0,100], a and b in [-128, 128]
0 = lab(85,0,85)
1 = lab(85,80,30)
2 = lab(85,-40,40)
3 = lab(85,-50,0)
4 = lab(85,5,15)
5 = lab(85,-10,-50)
6 = lab(85,35,-15)
*/
var { cursor: pointer; }
var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2021/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Loading Signed Exchanges</h1>
   <p id="w3c-state"><a href="https://www.w3.org/standards/types#CG-DRAFT">Draft Community Group Report</a>, <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></p>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://wicg.github.io/webpackage/loading.html">https://wicg.github.io/webpackage/loading.html</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard" data-editor-id="72192"><a class="p-name fn u-email email" href="mailto:jyasskin@chromium.org">Jeffrey Yasskin</a> (<a class="p-org org" href="https://google.com/">Google Inc.</a>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 1970 the Contributors to the Loading Signed Exchanges Specification, published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a> under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a>.
A human-readable <a href="http://www.w3.org/community/about/agreements/cla-deed/">summary</a> is available. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>How UAs load signed exchanges.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> This specification was published by the <a href="https://www.w3.org/community/wicg/">Web Platform Incubator Community Group</a>.
  It is not a W3C Standard nor is it on the W3C Standards Track.

  Please note that under the <a href="https://www.w3.org/community/about/agreements/cla/">W3C Community Contributor License Agreement (CLA)</a> there is a limited opt-out and other conditions apply.

  Learn more about <a href="http://www.w3.org/community/">W3C Community and Business Groups</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li><a href="#overview"><span class="secno">1.1</span> <span class="content">Overview</span></a>
      <li><a href="#details"><span class="secno">1.2</span> <span class="content">Other interesting details</span></a>
     </ol>
    <li>
     <a href="#monkeypatches"><span class="secno">2</span> <span class="content">Fetch monkeypatches</span></a>
     <ol class="toc">
      <li><a href="#mp-request-stashed-exchange"><span class="secno">2.1</span> <span class="content">A request’s stashed exchange</span></a>
      <li><a href="#mp-request-clone"><span class="secno">2.2</span> <span class="content">Request clone</span></a>
      <li><a href="#mp-response"><span class="secno">2.3</span> <span class="content">New response fields</span></a>
      <li><a href="#mp-response-date"><span class="secno">2.4</span> <span class="content">Response date</span></a>
      <li><a href="#mp-http-fetch"><span class="secno">2.5</span> <span class="content">Monkeypatch HTTP fetch</span></a>
      <li><a href="#mp-http-network-or-cache-fetch"><span class="secno">2.6</span> <span class="content">Monkeypatch HTTP-network-or-cache fetch</span></a>
     </ol>
    <li>
     <a href="#subresource-substitution"><span class="secno">3</span> <span class="content">Subresource substitution</span></a>
     <ol class="toc">
      <li><a href="#mp-document"><span class="secno">3.1</span> <span class="content">New Document fields</span></a>
      <li><a href="#mp-navigation-params"><span class="secno">3.2</span> <span class="content">New navigation params struct field</span></a>
      <li><a href="#mp-link-type-prefetch"><span class="secno">3.3</span> <span class="content">Monkeypatch Link type "prefetch"</span></a>
      <li><a href="#mp-process-a-navigate-fetch"><span class="secno">3.4</span> <span class="content">Monkeypatch process a navigate fetch</span></a>
      <li><a href="#mp-page-load-processing-model-for-html-fiiles"><span class="secno">3.5</span> <span class="content"> Monkeypatch Page load processing model for HTML files</span></a>
     </ol>
    <li>
     <a href="#structs"><span class="secno">4</span> <span class="content">Structures</span></a>
     <ol class="toc">
      <li><a href="#exchange"><span class="secno">4.1</span> <span class="content">Exchange</span></a>
      <li><a href="#read-buffer"><span class="secno">4.2</span> <span class="content">Read buffer</span></a>
      <li><a href="#augmented-certificate"><span class="secno">4.3</span> <span class="content">Augmented Certificate</span></a>
      <li><a href="#signed-exchange-report"><span class="secno">4.4</span> <span class="content">Signed Exchange report</span></a>
      <li><a href="#exchange-signature"><span class="secno">4.5</span> <span class="content">Exchange Signature</span></a>
      <li><a href="#allowed-signed-exchange-link-info"><span class="secno">4.6</span> <span class="content">Allowed signed exchange link info</span></a>
      <li><a href="#alternate-signed-exchange-link-info"><span class="secno">4.7</span> <span class="content">Alternate signed exchange link info</span></a>
      <li><a href="#alternate-signed-exchange-preload-info"><span class="secno">4.8</span> <span class="content">Alternate signed exchange preload info</span></a>
     </ol>
    <li>
     <a href="#algorithms"><span class="secno">5</span> <span class="content">Algorithms</span></a>
     <ol class="toc">
      <li><a href="#identifying-sxg"><span class="secno">5.1</span> <span class="content">Identifying signed exchanges</span></a>
      <li><a href="#parsing-fallback"><span class="secno">5.2</span> <span class="content">Extracting the fallback URL</span></a>
      <li><a href="#parsing"><span class="secno">5.3</span> <span class="content">Parsing signed exchanges</span></a>
      <li><a href="#parsing-prefix"><span class="secno">5.4</span> <span class="content">Parsing the invariant prefix</span></a>
      <li>
       <a href="#parsing-signature"><span class="secno">5.5</span> <span class="content">Parsing a Signature Header Field</span></a>
       <ol class="toc">
        <li><a href="#handling-cert-url"><span class="secno">5.5.1</span> <span class="content">Handling the certificate reference</span></a>
       </ol>
      <li><a href="#the-signed-message"><span class="secno">5.6</span> <span class="content">The signed message</span></a>
      <li><a href="#validating-signature"><span class="secno">5.7</span> <span class="content">Validating a signature</span></a>
      <li><a href="#cross-origin-trust"><span class="secno">5.8</span> <span class="content">Cross-origin trust</span></a>
      <li><a href="#trusting-certificate"><span class="secno">5.9</span> <span class="content">Establishing trust in a certificate</span></a>
      <li><a href="#parse-b2-cbor-headers"><span class="secno">5.10</span> <span class="content">Parsing b2 CBOR headers</span></a>
      <li>
       <a href="#parse-cbor-headers"><span class="secno">5.11</span> <span class="content">Parsing b3 CBOR headers</span></a>
       <ol class="toc">
        <li><a href="#headers-from-map"><span class="secno">5.11.1</span> <span class="content">Converting a map to a header list</span></a>
       </ol>
      <li><a href="#read-a-body"><span class="secno">5.12</span> <span class="content">Creating the response stream.</span></a>
      <li><a href="#request-matching"><span class="secno">5.13</span> <span class="content">Request matching</span></a>
      <li><a href="#create-a-new-report"><span class="secno">5.14</span> <span class="content">Create a new signed exchange report</span></a>
      <li><a href="#wait-and-queue-a-report"><span class="secno">5.15</span> <span class="content">Wait and queue a report</span></a>
      <li><a href="#queue-report"><span class="secno">5.16</span> <span class="content">Queuing signed exchange report</span></a>
      <li>
       <a href="#stream-algs"><span class="secno">5.17</span> <span class="content">Stream algorithms</span></a>
       <ol class="toc">
        <li><a href="#create-read-buffer"><span class="secno">5.17.1</span> <span class="content">Create a read buffer</span></a>
        <li><a href="#read-up-to-bytes"><span class="secno">5.17.2</span> <span class="content">Read up to bytes</span></a>
        <li><a href="#read-bytes"><span class="secno">5.17.3</span> <span class="content">Read bytes</span></a>
        <li><a href="#dump-stream"><span class="secno">5.17.4</span> <span class="content">Dump to another stream</span></a>
       </ol>
      <li><a href="#dump-value-of-target-attributes"><span class="secno">5.18</span> <span class="content">Get value of <span>Target Attributes</span></span></a>
      <li><a href="#get-allowed-signed-exchange-links"><span class="secno">5.19</span> <span class="content">Get allowed signed exchange link info</span></a>
      <li><a href="#get-alternate-signed-exchange-links"><span class="secno">5.20</span> <span class="content">Get alternate signed
exchange link info</span></a>
     </ol>
    <li>
     <a href="#seccons"><span class="secno">6</span> <span class="content">Security Considerations</span></a>
     <ol class="toc">
      <li><a href="#seccons-ct"><span class="secno">6.1</span> <span class="content">Certificate Transparency</span></a>
     </ol>
    <li>
     <a href="#w3c-conformance"><span class="secno"></span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#w3c-conventions"><span class="secno"></span> <span class="content">Document conventions</span></a>
      <li><a href="#w3c-conformant-algorithms"><span class="secno"></span> <span class="content">Conformant Algorithms</span></a>
     </ol>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <section class="non-normative">
    <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
    <p><em>This section is non-normative.</em></p>
    <p>The Signed Exchanges specification <a data-link-type="biblio" href="#biblio-draft-yasskin-http-origin-signed-responses" title="Signed HTTP Exchanges">[draft-yasskin-http-origin-signed-responses]</a> describes a way to provide one or
more signatures for an HTTP exchange and to check whether any of those
signatures is trusted as authoritative for a particular origin. This
specification describes how web browsers load those exchanges. It is expressed
as several monkeypatches to the <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> specification which call algorithms
defined here.</p>
    <h3 class="heading settled" data-level="1.1" id="overview"><span class="secno">1.1. </span><span class="content">Overview</span><a class="self-link" href="#overview"></a></h3>
    <p>When fetching a resource (<code>https://distributor.example.org/foo.sxg</code>) with the <code>application/signed-exchange</code> <a data-link-type="dfn" href="https://mimesniff.spec.whatwg.org/#mime-type" id="ref-for-mime-type">MIME type</a>, the UA parses it, checks its
signatures, and then if all is well, redirects to its request URL
(<code>https://publisher.example.org/foo</code>) with a "stashed" exchange attached to the
request. The redirect applies all the usual processing, and then when it would
normally check for an HTTP cache hit, it also checks whether the stashed request
matches the redirected request and which of the stashed exchange or HTTP cache
contents is newer. If the stashed exchange matches and is newer, the UA returns
the stashed response.</p>
    <p>A Service Worker for <code>https://distributor.example.org/</code> gets to handle the
original request. A Service Worker for <code>https://publisher.example.org/</code> can then
handle the redirect. If it needs to know that signed exchange content is
available for the request it’s handling, it has two options:</p>
    <ol>
     <li data-md>
      <p>If <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#dom-serviceworkerregistration-navigationpreload" id="ref-for-dom-serviceworkerregistration-navigationpreload">navigationPreload</a></code> is enabled, the signed
response will be available in the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#fetchevent" id="ref-for-fetchevent">FetchEvent</a></code>'s <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#dom-fetchevent-preloadresponse" id="ref-for-dom-fetchevent-preloadresponse">preloadResponse</a></code>. Note that this will also cause a network
request for requests that aren’t served from a signed exchange.</p>
     <li data-md>
      <p><code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-request-clone" id="ref-for-dom-request-clone">clone()</a></code> the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#dom-fetchevent-request" id="ref-for-dom-fetchevent-request">request</a></code> and set its <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-request-cache" id="ref-for-dom-request-cache">cache</a></code> to <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-requestcache-only-if-cached" id="ref-for-dom-requestcache-only-if-cached">"only-if-cached"</a></code>, to retrieve the matching response from
either the signed exchange or the HTTP cache. Note that <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-global-fetch" id="ref-for-dom-global-fetch">fetch()</a></code>ing a <em>new</em> <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#request" id="ref-for-request">Request</a></code> with the same <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-request-url" id="ref-for-dom-request-url">url</a></code> will <em>not</em> retrieve the response from the signed exchange.</p>
    </ol>
    <h3 class="heading settled" data-level="1.2" id="details"><span class="secno">1.2. </span><span class="content">Other interesting details</span><a class="self-link" href="#details"></a></h3>
    <ul>
     <li data-md>
      <p>Like with <code>&lt;link rel="prefetch"></code> and <code>&lt;link rel="preload"></code>, the UA will use
the stashed response even if its HTTP cache headers have expired. This makes
it easier to specify that the contents of the signed exchange don’t wind up
in the HTTP cache before our security reviewers have gotten comfortable with
that idea. The publisher can still control resource expiration by setting
the Signature header’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time">expiration time</a> to the cache
expiration time if that’s sooner than they’d otherwise have the signature
expire.</p>
    </ul>
   </section>
   <h2 class="heading settled" data-level="2" id="monkeypatches"><span class="secno">2. </span><span class="content">Fetch monkeypatches</span><a class="self-link" href="#monkeypatches"></a></h2>
   <p>When fetching a signed exchange, the UA needs to look for a trusted and valid
signature and then redirect to the contained resource. We don’t put the
contained resource in the HTTP cache, so redirects get a new field to store it.</p>
   <h3 class="heading settled" data-level="2.1" id="mp-request-stashed-exchange"><span class="secno">2.1. </span><span class="content">A request’s stashed exchange</span><a class="self-link" href="#mp-request-stashed-exchange"></a></h3>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request">request</a> has an associated <dfn class="dfn-paneled" data-dfn-for="request" data-dfn-type="dfn" data-noexport id="request-stashed-exchange">stashed exchange</dfn>, which
is null or an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange">exchange</a>.</p>
   <h3 class="heading settled algorithm" data-algorithm="Request clone" data-level="2.2" id="mp-request-clone"><span class="secno">2.2. </span><span class="content">Request clone</span><a class="self-link" href="#mp-request-clone"></a></h3>
   <p>Rewrite <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-clone" id="ref-for-concept-request-clone">clone a request</a> to run these steps:</p>
   <ol>
    <li>
     Let <var>newRequest</var> be a copy of <var>request</var>, except for its <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body">body</a> 
     <ins>and <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange">stashed exchange</a></ins>
     . 
    <li>If <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body①">body</a> is non-null, set <var>newRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body②">body</a> to the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-clone" id="ref-for-concept-body-clone">cloning</a> <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body③">body</a>. 
    <li>
     <ins>If <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange①">stashed exchange</a> is non-null, set <var>newRequest</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange②">stashed exchange</a> to an exchange whose <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url">request URL</a> is a copy of <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange③">stashed
  exchange</a>'s <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url①">request URL</a> and whose <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response">response</a> is the <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-clone" id="ref-for-concept-response-clone">clone</a> of <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange④">stashed exchange</a>'s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①">response</a>.</ins>
    <li>Return <var>newRequest</var>. 
   </ol>
   <h3 class="heading settled" data-level="2.3" id="mp-response"><span class="secno">2.3. </span><span class="content">New response fields</span><a class="self-link" href="#mp-response"></a></h3>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response">response</a> has an associated <dfn class="dfn-paneled" data-dfn-for="response" data-dfn-type="dfn" data-lt="came from a signed
exchange|did not come from a signed exchange" data-noexport id="response-came-from-a-signed-exchange">came from a signed exchange</dfn> boolean. Unless stated otherwise, it is false.</p>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①">response</a> has an associated <dfn class="dfn-paneled" data-dfn-for="response" data-dfn-type="dfn" data-lt="signed exchange outer header list" data-noexport id="response-signed-exchange-outer-header-list">signed exchange outer
header list</dfn> (a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list">header list</a>). Unless stated otherwise it is empty.</p>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response②">response</a> has an associated <dfn class="dfn-paneled" data-dfn-for="response" data-dfn-type="dfn" data-lt="header integrity value" data-noexport id="response-header-integrity-value">header integrity
value</dfn>, either null or, for responses that <a data-link-type="dfn" href="#response-came-from-a-signed-exchange" id="ref-for-response-came-from-a-signed-exchange">came from a signed
exchange</a>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a> holding the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something">SHA-256</a> hash that verified the <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response②">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list">header list</a>. Unless stated otherwise, it is
null.</p>
   <p class="note" role="note"><span class="marker">Note:</span> The <a data-link-type="dfn" href="#response-header-integrity-value" id="ref-for-response-header-integrity-value">header integrity value</a> doesn’t change even if the
publisher signs the content again or changes the signing key, but it does change
if any of the headers or body change. (It catches changes to the body because a
valid signed exchange’s headers have to include a <code>Digest</code> value that covers the
body.)</p>
   <h3 class="heading settled algorithm" data-algorithm="Response date" data-level="2.4" id="mp-response-date"><span class="secno">2.4. </span><span class="content">Response date</span><a class="self-link" href="#mp-response-date"></a></h3>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response③">response</a> <var>response</var>’s <dfn class="dfn-paneled" data-dfn-for="response" data-dfn-type="dfn" data-noexport id="response-date">date</dfn> is the result of:</p>
   <ol>
    <li data-md>
     <p>Let <var>date</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#extract-header-list-values" id="ref-for-extract-header-list-values">extracting header list values</a> given <code>`Date` </code> and <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①">header list</a>.</p>
    <li data-md>
     <p>If <var>date</var> is a failure, return the point in time of the beginning of the
universe.</p>
    <li data-md>
     <p>Return the point in time represented by <var>date</var>, as interpreted for the <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc7231#section-7.1.1.2" id="ref-for-section-7.1.1.2">Date</a> header field.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Monkeypatch HTTP fetch" data-level="2.5" id="mp-http-fetch"><span class="secno">2.5. </span><span class="content">Monkeypatch HTTP fetch</span><a class="self-link" href="#mp-http-fetch"></a></h3>
   <p>In <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-fetch" id="ref-for-concept-http-fetch">HTTP fetch</a>, before</p>
   <blockquote>
    <ol start="5">
     <li data-md>
      <p>If <var>actualResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status">status</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#redirect-status" id="ref-for-redirect-status">redirect status</a>, then:
...</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol start="5">
    <li data-md>
     <p>If the <a data-link-type="dfn" href="#signed-exchange-version" id="ref-for-signed-exchange-version">signed exchange version</a> of <var>actualResponse</var> is:</p>
     <dl class="switch">
      <dt data-md>undefined
      <dd data-md>
       <p>Do nothing.</p>
      <dt data-md><code>"b2"</code> or <code>"b3"</code>
      <dd data-md>
       <ol>
        <li data-md>
         <p>Let <var>report</var> be the result of <a data-link-type="dfn" href="#create-a-new-signed-exchange-report" id="ref-for-create-a-new-signed-exchange-report">create a new signed exchange report</a> with <var>request</var> and <var>actualResponse</var>.</p>
        <li data-md>
         <p>Let <var>parsedExchange</var> be the result of <a data-link-type="dfn" href="#parsing-a-signed-exchange" id="ref-for-parsing-a-signed-exchange">parsing a signed
exchange</a> of version <code>b2</code> or <code>b3</code>, respectively, from <var>actualResponse</var> in the context of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client">client</a>,
reporting to <var>report</var>.</p>
        <li data-md>
         <p>If <var>parsedExchange</var> is not an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①">exchange</a>, run <a data-link-type="dfn" href="#queue-a-signed-exchange-report" id="ref-for-queue-a-signed-exchange-report">queue a signed exchange report</a> <var>report</var> with <var>parsedExchange</var> as the result, and return a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error">network error</a>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">In parallel</a>, <a data-link-type="dfn" href="#wait-and-queue-a-report-for" id="ref-for-wait-and-queue-a-report-for">wait and queue a report for</a> <var>parsedExchange</var> and <var>report</var>.</p>
        <li data-md>
         <p>Set <var>actualResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-status" id="ref-for-concept-status">status</a> to <code>303</code>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set">Set</a> <var>actualResponse</var>’s <code>`Location`</code> header to
the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-encode" id="ref-for-ascii-encode">ASCII encoding</a> of the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer">serialization</a> of <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url②">request URL</a>.</p>
        <li data-md>
         <p>Set <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange⑤">stashed exchange</a> to <var>parsedExchange</var>.</p>
       </ol>
      <dt data-md>Anything else
      <dd data-md>
       <ol>
        <li data-md>
         <p>Let <var>fallbackUrlBytes</var> be the result of <a data-link-type="dfn" href="#extracting-the-fallback-url" id="ref-for-extracting-the-fallback-url">extracting the fallback
URL</a> from <var>actualResponse</var>.</p>
        <li data-md>
         <p>If <var>fallbackUrlBytes</var> is a failure, return a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error①">network error</a>.</p>
        <li data-md>
         <p>Set <var>actualResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-status" id="ref-for-concept-status①">status</a> to <code>303</code>.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set①">Set</a> <var>actualResponse</var>’s <code>`Location`</code> header to <var>fallbackUrlBytes</var>.</p>
       </ol>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> The final <a data-link-type="biblio" href="#biblio-draft-yasskin-http-origin-signed-responses" title="Signed HTTP Exchanges">[draft-yasskin-http-origin-signed-responses]</a> will use a
version of <code>`1`</code>, but this specification tracks what’s actually
implemented in browsers, which still uses draft versions.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Monkeypatch HTTP-network-or-cache fetch" data-level="2.6" id="mp-http-network-or-cache-fetch"><span class="secno">2.6. </span><span class="content">Monkeypatch HTTP-network-or-cache fetch</span><a class="self-link" href="#mp-http-network-or-cache-fetch"></a></h3>
   <p>In <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch" id="ref-for-concept-http-network-or-cache-fetch">HTTP-network-or-cache fetch</a>, after</p>
   <blockquote>
    <p>5.19. If <var>httpRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-cache-mode" id="ref-for-concept-request-cache-mode">cache mode</a> is neither "<code>no-store</code>" nor
"<code>reload</code>", then: ...</p>
   </blockquote>
   <p>add the following steps:</p>
   <ol start="20">
    <li data-md>
     <p>If <var>httpRequest</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange⑥">stashed exchange</a> isn’t null:</p>
     <ol>
      <li data-md>
       <p>Let <var>stashedExchange</var> be <var>httpRequest</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange⑦">stashed exchange</a>.</p>
      <li data-md>
       <p>If</p>
       <ul>
        <li data-md>
         <p><var>httpRequest</var> <a data-link-type="dfn" href="#matches-the-stored-exchange" id="ref-for-matches-the-stored-exchange">matches the stored exchange</a> <var>stashedExchange</var> and</p>
        <li data-md>
         <p><var>response</var> is null or <var>response</var>’s <a data-link-type="dfn" href="#response-date" id="ref-for-response-date">date</a> is earlier than <var>httpRequest</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange⑧">stashed exchange</a>'s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response③">response</a>'s <a data-link-type="dfn" href="#response-date" id="ref-for-response-date①">date</a></p>
       </ul>
       <p>then set <var>response</var> to <var>httpRequest</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange⑨">stashed exchange</a>'s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response④">response</a>.</p>
      <li data-md>
       <p>If <var>response</var> is null and <var>httpRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-initiator" id="ref-for-concept-request-initiator">initiator</a> is
"<code>prefetch</code>" or "<code>preload</code>", return a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-network-error" id="ref-for-concept-network-error②">network error</a>.</p>
       <p class="note" role="note"><span class="marker">Note:</span> This ensures that prefetching a signed exchange from one origin
won’t accidentally do a network request from another origin, which could <a href="https://wicg.github.io/webpackage/draft-yasskin-wpack-use-cases.html#private-prefetch">compromise the user’s
privacy</a>.</p>
     </ol>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> Applying the signed exchange’s response here has the effect of letting a
newer HTTP cache entry override a signed exchange’s content, and of not storing
the signed exchange’s response in the HTTP cache.</p>
   <h2 class="heading settled" data-level="3" id="subresource-substitution"><span class="secno">3. </span><span class="content">Subresource substitution</span><a class="self-link" href="#subresource-substitution"></a></h2>
   <p>When prenavigating to a page held in a signed exchange, it can be useful to
also prefetch subresources of that page as signed exchanges from the same
server. To identify those transitive prefetchable resources, this section
introduces an extension to the HTTP <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3">Link</a> header.</p>
   <div class="example" id="example-alternate-signed-exchange-link">
    <a class="self-link" href="#example-alternate-signed-exchange-link"></a> 
    <p>The following is an example HTTP response for <code>https://feed.example/sxg.publisher.example/page.html.wbn</code> showing the right
Link headers to let a browser prefetch subresources.</p>
<pre class="language-http highlight">Content-Type: application/signed-exchange;v=b3
Link: &lt;https://feed.example/sxg.publisher.example/lib.js.sxg>;
    rel="alternate";
    type="application/signed-exchange";
    anchor="https://cdn.publisher.example/lib.js"

A signed exchange, whose request URL is https://sxg.publisher.example/page.html:

    Content-Type: text/html
    Link: &lt;https://cdn.publisher.example/lib.js>;
        rel="preload";
        as="script"
    Link: &lt;https://cdn.publisher.example/lib.js>;
        rel="allowed-alt-sxg";
        header-integrity="sha256-XXXXXX"

    &lt;html>
      &lt;head>
        &lt;script src="https://cdn.publisher.example/lib.js">&lt;/script>
      &lt;/head>
      ...
    &lt;/html>
</pre>
    <p>If another page includes a <code>&lt;link rel="prefetch" href="https://feed.example/sxg.publisher.example/page.html.wbn"></code>, the above
response allows it to transitively prefetch a signed exchange that it can use to
satisfy the <code>https://cdn.publisher.example/lib.js</code> <code>&lt;script></code> element.</p>
   </div>
   <ul>
    <li data-md>
     <p>Link type "<dfn class="dfn-paneled" data-dfn-for="link/rel" data-dfn-type="attr-value" data-export id="attr-valuedef-link-rel-allowed-alt-sxg"><code>allowed-alt-sxg</code></dfn>"</p>
     <p>The <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg">allowed-alt-sxg</a></code> keyword may be used in the HTTP <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3①">Link</a> header of the inner HTTP response of the main resource
signed exchange to indicate that the content of the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1">Link Target</a> is also
available as a particular signed exchange identified by the <code><a data-link-type="element-sub" href="#element-attrdef-link-header-integrity" id="ref-for-element-attrdef-link-header-integrity">header-integrity</a></code> parameter. The <dfn class="dfn-paneled" data-dfn-for="link" data-dfn-type="element-attr" data-export id="element-attrdef-link-header-integrity"><code>header-integrity</code></dfn> parameter holds the value of the <a data-link-type="dfn" href="#response-header-integrity-value" id="ref-for-response-header-integrity-value①">header integrity value</a> of the <a data-link-type="dfn" href="#alternate-signed-exchange" id="ref-for-alternate-signed-exchange">alternate signed exchange</a>,
encoded as a <a data-link-type="biblio" href="#biblio-csp" title="Content Security Policy Level 3">[CSP]</a> <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-hash-source" id="ref-for-grammardef-hash-source">hash-source</a>.</p>
    <li data-md>
     <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-link">alternate signed exchange link</dfn> is a <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3②">Link</a> header sent with a signed exchange <var>S</var>, with the <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#rel-alternate" id="ref-for-rel-alternate">alternate</a></code> link
type, the <code>type</code> parameter set to <code>application/signed-exchange</code>, and a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.2" id="ref-for-section-3.2">Link Context</a> (an <code>anchor</code> parameter). The <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.2" id="ref-for-section-3.2①">Link Context</a> MUST be the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1①">Link Target</a> of a <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-preload" id="ref-for-link-type-preload">preload</a></code> <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3③">Link</a> header
inside the signed content of <var>S</var>, and the <a data-link-type="dfn" href="#alternate-signed-exchange-link" id="ref-for-alternate-signed-exchange-link">alternate signed exchange link</a> means that this resource can also be found inside the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange">alternate signed exchange</dfn> at the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1②">Link Target</a> of the <a data-link-type="dfn" href="#alternate-signed-exchange-link" id="ref-for-alternate-signed-exchange-link①">alternate signed exchange link</a>.</p>
    <li data-md>
     <p>New <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.4" id="ref-for-section-3.4">serialisation-defined Target Attributes</a> on the <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3④">Link</a> header.</p>
     <ul>
      <li data-md>
       <p>The <dfn class="dfn-paneled" data-dfn-for="link" data-dfn-type="element-attr" data-export id="element-attrdef-link-variants"><code>variants</code></dfn> target attribute has the
same values as the <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variants" id="ref-for-variants">Variants</a> Header Field.  There MUST
NOT be more than one <code><a data-link-type="element-sub" href="#element-attrdef-link-variants" id="ref-for-element-attrdef-link-variants">variants</a></code> attribute in a link-value;
occurrences after the first MUST be ignored by parsers. It is serialized
to an HTTP link-param by first encoding as if it were a <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variants" id="ref-for-variants①">Variants</a> Header Field value, and then if there are
characters that don’t match the <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6">token</a> production,
encoding as a <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6①">quoted-string</a>.</p>
       <p>This parameter is used in <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg①">allowed-alt-sxg</a></code> links and <a data-link-type="dfn" href="#alternate-signed-exchange-link" id="ref-for-alternate-signed-exchange-link②">alternate signed exchange links</a> to indicate what representations are
available for the resource at the time that the response is produced.</p>
      <li data-md>
       <p>The <dfn class="dfn-paneled" data-dfn-for="link" data-dfn-type="element-attr" data-export id="element-attrdef-link-variant-key"><code>variant-key</code></dfn> target attribute has
the same values as the <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variant-key" id="ref-for-variant-key">Variant-Key</a> Header Field.
There MUST NOT be more than one <code><a data-link-type="element-sub" href="#element-attrdef-link-variant-key" id="ref-for-element-attrdef-link-variant-key">variant-key</a></code> attribute in a
link-value; occurrences after the first MUST be ignored by parsers. It
is serialized to an HTTP link-param by first encoding as if it were a <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variant-key" id="ref-for-variant-key①">Variant-Key</a> Header Field value, and then if there are
characters that don’t match the <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6②">token</a> production,
encoding as a <a data-link-type="grammar" href="https://tools.ietf.org/html/rfc7230#section-3.2.6" id="ref-for-section-3.2.6③">quoted-string</a>.</p>
       <p>This parameter is used in <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg②">allowed-alt-sxg</a></code> links and <a data-link-type="dfn" href="#alternate-signed-exchange-link" id="ref-for-alternate-signed-exchange-link③">alternate signed exchange links</a> to indicate one or more sets of
available-values that identify the representation of the resource.</p>
     </ul>
   </ul>
   <h3 class="heading settled algorithm" data-algorithm="New Document fields" data-level="3.1" id="mp-document"><span class="secno">3.1. </span><span class="content">New Document fields</span><a class="self-link" href="#mp-document"></a></h3>
   <p>At the end of <a href="https://html.spec.whatwg.org/multipage/dom.html#the-document-object">the Document object</a> section, add the following lines:</p>
   <blockquote>
    <p>The <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document">Document</a></code> has a map of <dfn class="dfn-paneled" data-dfn-for="Document" data-dfn-type="dfn" data-lt="prefetched signed exchanges for navigation" data-noexport id="document-prefetched-signed-exchanges-for-navigation">prefetched signed exchanges for
navigation</dfn>, which is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-map" id="ref-for-ordered-map">map</a> of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url">URLs</a> to <a data-link-type="dfn" href="#exchange" id="ref-for-exchange②">exchanges</a>, initially
empty. <span class="note">This might merge with the set of prefetched resources
when <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch" id="ref-for-link-type-prefetch">prefetch</a></code> is specified more completely.</span></p>
    <p>The <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#document" id="ref-for-document①">Document</a></code> has a set of <dfn class="dfn-paneled" data-dfn-for="Document" data-dfn-type="dfn" data-lt="prefetched subresource signed exchanges" data-noexport id="document-prefetched-subresource-signed-exchanges">prefetched
subresource signed exchanges</dfn>, which is a set of <a data-link-type="dfn" href="#exchange" id="ref-for-exchange③">exchanges</a>, initially
empty.</p>
   </blockquote>
   <h3 class="heading settled algorithm" data-algorithm="New navigation params struct field" data-level="3.2" id="mp-navigation-params"><span class="secno">3.2. </span><span class="content">New navigation params struct field</span><a class="self-link" href="#mp-navigation-params"></a></h3>
   <p>In the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-params">navigation params</a> struct, add the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="navigation params" data-dfn-type="dfn" data-noexport id="navigation-params-prefetched-subresource-signed-exchanges">prefetched subresource signed exchanges</dfn>
    <dd data-md>
     <p>A set of <a data-link-type="dfn" href="#exchange" id="ref-for-exchange④">exchanges</a>, empty unless specified otherwise.</p>
   </dl>
   <h3 class="heading settled algorithm" data-algorithm="Monkeypatch Link type &quot;prefetch&quot;" data-level="3.3" id="mp-link-type-prefetch"><span class="secno">3.3. </span><span class="content">Monkeypatch Link type "prefetch"</span><a class="self-link" href="#mp-link-type-prefetch"></a></h3>
   <p class="note" role="note"><span class="marker">Note:</span> To prefetch the <a data-link-type="dfn" href="#alternate-signed-exchange" id="ref-for-alternate-signed-exchange①">alternate signed exchanges</a> when the UA receives a
prefetched main resource signed exchange, this section monkeypatches Link type
"<code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch" id="ref-for-link-type-prefetch①">prefetch</a></code>". This algorithm gets all the <a data-link-type="dfn" href="#alternate-signed-exchange-link" id="ref-for-alternate-signed-exchange-link④">alternate signed exchange
links</a> from the outer response, checks if they are allowed by the inner
response’s <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg③">allowed-alt-sxg</a></code> links, and if they are, associates them
with the inner response’s <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-preload" id="ref-for-link-type-preload①">preload</a></code> links.</p>
   <p class="issue" id="issue-f0ea812f"><a class="self-link" href="#issue-f0ea812f"></a> Currently the behavior of recursive prefetch is
not specified. This section monkeypatches Link type "<code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch" id="ref-for-link-type-prefetch②">prefetch</a></code>" to
add support only for the <a data-link-type="dfn" href="#alternate-signed-exchange" id="ref-for-alternate-signed-exchange②">alternate signed exchanges</a> subresources. When we
change the HTML spec to support general recursive prefetching, this section
needs to align with that change. <a href="https://github.com/w3c/resource-hints/issues/77">[Issue #w3c/resource-hints#77]</a></p>
   <p>To <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/semantics.html#process-the-linked-resource" id="ref-for-process-the-linked-resource">process this type of linked resource</a> ("<code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch" id="ref-for-link-type-prefetch③">prefetch</a></code>"), given a link element <var>el</var>, boolean <var>success</var>, and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response④">response</a> <var>response</var>:</p>
   <ol>
    <li data-md>
     <p>If <var>success</var> is true, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire">fire an event</a> named <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-load" id="ref-for-event-load">load</a></code> at <var>el</var>.</p>
    <li data-md>
     <p>Otherwise, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-event-fire" id="ref-for-concept-event-fire①">fire an event</a> named <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-error" id="ref-for-event-error">error</a></code> at <var>el</var>.</p>
    <li data-md>
     <p>If <var>success</var> is false, then return.</p>
    <li data-md>
     <p>If the <var>response</var> <a data-link-type="dfn" href="#response-came-from-a-signed-exchange" id="ref-for-response-came-from-a-signed-exchange①">did not come from a signed exchange</a>, then
return.</p>
    <li data-md>
     <p>Let <var>requestUrl</var> be the first item of <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url-list" id="ref-for-concept-response-url-list">URL list</a>.</p>
    <li data-md>
     <p>Let <var>clonedExchange</var> be the result of creating a new <a data-link-type="dfn" href="#exchange" id="ref-for-exchange⑤">exchange</a> with <var>requestUrl</var> and the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-clone" id="ref-for-concept-response-clone①">cloning</a> <var>response</var>.</p>
    <li data-md>
     <p>Let <var>prefetchedSignedExchanges</var> be <var>el</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document">node document</a>'s <a data-link-type="dfn" href="#document-prefetched-signed-exchanges-for-navigation" id="ref-for-document-prefetched-signed-exchanges-for-navigation">prefetched signed exchanges for navigation</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-set" id="ref-for-map-set">Set</a> <var>prefetchedSignedExchanges</var>[<var>requestUrl</var>] to <var>clonedExchange</var>.</p>
    <li data-md>
     <p>Let <var>outerLinkHeader</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get">getting</a> <code>`Link`</code> from <var>response</var>’s <a data-link-type="dfn" href="#response-signed-exchange-outer-header-list" id="ref-for-response-signed-exchange-outer-header-list">signed exchange outer header list</a>.</p>
    <li data-md>
     <p>If <var>outerLinkHeader</var> is null, then return.</p>
    <li data-md>
     <p>Let <var>outerLinks</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#appendix-B.2" id="ref-for-appendix-B.2">Parsing a Link Field Value</a> from <var>outerLinkHeader</var>.</p>
    <li data-md>
     <p>If <var>outerLinks</var> is empty, then return.</p>
    <li data-md>
     <p>Let <var>innerLinkHeader</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get①">getting</a> <code>`Link`</code> from <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list②">header list</a>.</p>
    <li data-md>
     <p>If <var>innerLinkHeader</var> is null, then return.</p>
    <li data-md>
     <p>Let <var>innerLinks</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#appendix-B.2" id="ref-for-appendix-B.2①">Parsing a Link Field Value</a> from <var>innerLinkHeader</var>.</p>
    <li data-md>
     <p>If <var>innerLinks</var> is empty, then return.</p>
    <li data-md>
     <p>Let <var>alternateLinks</var> be the result of <a data-link-type="dfn" href="#getting-alternate-signed-exchange-link-info" id="ref-for-getting-alternate-signed-exchange-link-info">getting alternate signed exchange
link info</a> from <var>outerLinks</var>.</p>
    <li data-md>
     <p>Let <var>allowedSxgLinks</var> be the result of <a data-link-type="dfn" href="#getting-allowed-signed-exchange-link-info" id="ref-for-getting-allowed-signed-exchange-link-info">getting allowed signed exchange link
info</a> from <var>innerLink</var>.</p>
    <li data-md>
     <p>For each <var>innerLink</var> of <var>innerLinks</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>innerLink</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.3" id="ref-for-section-3.3">Relation Type</a> is not 'preload', then continue.</p>
      <li data-md>
       <p>Let <var>linkTarget</var> be <var>innerLink</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1③">Link Target</a>.</p>
      <li data-md>
       <p>Let <var>asAttribute</var> be <var>innerLink</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named">Target Attribute named</a> <code>"as"</code>.</p>
      <li data-md>
       <p>If <var>asAttribute</var> is not a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination" id="ref-for-concept-potential-destination">potential destination</a>, continue.</p>
      <li data-md>
       <p>If <var>asAttribute</var> is <code>"image"</code>, then:</p>
       <ol>
        <li data-md>
         <p>Let <var>imagesrcset</var> be <var>innerLink</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①">Target Attribute named</a> <code>"imagesrcset"</code>.</p>
        <li data-md>
         <p>Let <var>imagesizes</var> be <var>innerLink</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named②">Target Attribute named</a> <code>"imagesizes"</code>.</p>
        <li data-md>
         <p>Create a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element">link</a></code> element <var>linkElement</var> whose <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-href" id="ref-for-attr-link-href">href</a></code> attribute
is <var>linkTarget</var>, and <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesrcset" id="ref-for-attr-link-imagesrcset">imagesrcset</a></code> attribute is <var>imagesrcset</var>, and <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesizes" id="ref-for-attr-link-imagesizes">imagesizes</a></code> attribute is <var>imagesizes</var>.</p>
        <li data-md>
         <p>Let <var>selected source</var> and <var>selected pixel density</var> be the URL and pixel density that results from <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/images.html#select-an-image-source" id="ref-for-select-an-image-source">selecting an image
source</a> given <var>linkElement</var>, respectively.</p>
        <li data-md>
         <p>If <var>selected source</var> is not null, then set <var>linkTarget</var> to the result
of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser">parsing</a> <var>selected source</var>, with a base URL of <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url">URL</a>.</p>
       </ol>
      <li data-md>
       <p>For each <var>allowedSxgLink</var> of <var>allowedSxgLinks</var>:</p>
       <ol>
        <li data-md>
         <p>If <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-target" id="ref-for-allowed-signed-exchange-link-info-target">target</a> isn’t the same as <var>linkTarget</var>, then continue.</p>
        <li data-md>
         <p>Let <var>storedExchange</var> be the result of creating an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange⑥">exchange</a> with <var>linkTarget</var> and a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑤">response</a>.</p>
        <li data-md>
         <p>If <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variants" id="ref-for-allowed-signed-exchange-link-info-variants">variants</a> is not null, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set②">set</a> <code>`Variants`</code>/<var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variants" id="ref-for-allowed-signed-exchange-link-info-variants①">variants</a> in <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response⑤">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list③">header list</a>.</p>
        <li data-md>
         <p>If <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variant-key" id="ref-for-allowed-signed-exchange-link-info-variant-key">variant
key</a> is not null, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set③">set</a> <code>`Variant-Key` </code>/<var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variant-key" id="ref-for-allowed-signed-exchange-link-info-variant-key①">variant
key</a> in <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response⑥">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list④">header list</a>.</p>
        <li data-md>
         <p>Let <var>requestForMatch</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#create-a-potential-cors-request" id="ref-for-create-a-potential-cors-request">creating a potential-CORS
request</a> given a url of <var>linkTarget</var>, a destination of the result
of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination-translate" id="ref-for-concept-potential-destination-translate">translating</a> <var>asAttribute</var>, and a
corsAttributeState of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-crossorigin-none" id="ref-for-attr-crossorigin-none">No CORS</a>.</p>
        <li data-md>
         <p>If <var>requestForMatch</var> <a data-link-type="dfn" href="#matches-the-stored-exchange" id="ref-for-matches-the-stored-exchange①">doesn’t match the stored exchange</a> <var>storedExchange</var>, then continue.</p>
        <li data-md>
         <p>Let <var>alternateSxgUrl</var> be the <a data-link-type="dfn" href="#alternate-signed-exchange-link-info-target" id="ref-for-alternate-signed-exchange-link-info-target">target</a> of the first <a data-link-type="dfn" href="#alternate-signed-exchange-link-info" id="ref-for-alternate-signed-exchange-link-info">alternate signed exchange link info</a> of <var>alternateLinks</var> whose</p>
         <ul>
          <li data-md>
           <p><a data-link-type="dfn" href="#alternate-signed-exchange-link-info-variants" id="ref-for-alternate-signed-exchange-link-info-variants">variants</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is">identical to</a> <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variants" id="ref-for-allowed-signed-exchange-link-info-variants②">variants</a>,</p>
          <li data-md>
           <p><a data-link-type="dfn" href="#alternate-signed-exchange-link-info-variant-key" id="ref-for-alternate-signed-exchange-link-info-variant-key">variant key</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string-is" id="ref-for-string-is①">identical to</a> <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variant-key" id="ref-for-allowed-signed-exchange-link-info-variant-key②">variant key</a>, and</p>
          <li data-md>
           <p><a data-link-type="dfn" href="#alternate-signed-exchange-link-info-context" id="ref-for-alternate-signed-exchange-link-info-context">context</a> <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-equals" id="ref-for-concept-url-equals">equals</a> <var>linkTarget</var></p>
         </ul>
         <p>or continue if no such link is present.</p>
        <li data-md>
         <p>Let <var>sxgRequest</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#create-a-potential-cors-request" id="ref-for-create-a-potential-cors-request①">creating a potential-CORS
request</a> given a url of <var>alternateSxgUrl</var>, a destination of the
result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination-translate" id="ref-for-concept-potential-destination-translate①">translating</a> <var>asAttribute</var>, and a
corsAttributeState of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-crossorigin-none" id="ref-for-attr-crossorigin-none①">No CORS</a>.</p>
        <li data-md>
         <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①">in parallel</a>:</p>
         <ol>
          <li data-md>
           <p>Let <var>sxgResponse</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch">fetching</a> <var>sxgRequest</var>.</p>
          <li data-md>
           <p>If <var>sxgResponse</var>’s <a data-link-type="dfn" href="#response-came-from-a-signed-exchange" id="ref-for-response-came-from-a-signed-exchange②">came from a signed exchange</a> is
true, and <var>sxgResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url①">URL</a> is the same as <var>linkTarget</var>, then <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task" id="ref-for-queue-a-task">queue a task</a> on the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source" id="ref-for-networking-task-source">networking task source</a> to:</p>
           <ol>
            <li data-md>
             <p>Let <var>sxgExchange</var> be a new <a data-link-type="dfn" href="#exchange" id="ref-for-exchange⑦">exchange</a> with a <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url③">request URL</a> of <var>linkTarget</var> and a <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response⑦">response</a> of <var>sxgResponse</var>.</p>
            <li data-md>
             <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">Append</a> <var>sxgExchange</var> to <var>el</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#concept-node-document" id="ref-for-concept-node-document①">node
document</a>'s <a data-link-type="dfn" href="#document-prefetched-subresource-signed-exchanges" id="ref-for-document-prefetched-subresource-signed-exchanges">prefetched subresource signed
exchanges</a>.</p>
           </ol>
         </ol>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Monkeypatch process a navigate fetch" data-level="3.4" id="mp-process-a-navigate-fetch"><span class="secno">3.4. </span><span class="content">Monkeypatch process a navigate fetch</span><a class="self-link" href="#mp-process-a-navigate-fetch"></a></h3>
   <p>In <a href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#process-a-navigate-fetch">process a navigate fetch</a> before</p>
   <blockquote>
    <ol start="4">
     <li data-md>
      <p>Let <var>reservedEnvironment</var> be null.</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol start="4">
    <li data-md>
     <p>If <var>sourceBrowsingContext</var>’s <a data-link-type="dfn">active document</a>'s <a data-link-type="dfn" href="#document-prefetched-signed-exchanges-for-navigation" id="ref-for-document-prefetched-signed-exchanges-for-navigation①">prefetched
signed exchanges for navigation</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">contains</a> an entry for a key of <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url">url</a>, then:</p>
     <ol>
      <li data-md>
       <p>Let <var>prefetchedExchange</var> be <var>sourceBrowsingContext</var>’s <a data-link-type="dfn">active
document</a>'s <a data-link-type="dfn" href="#document-prefetched-signed-exchanges-for-navigation" id="ref-for-document-prefetched-signed-exchanges-for-navigation②">prefetched signed exchanges for
navigation</a>[<var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url①">url</a>].</p>
      <li data-md>
       <p>Set <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange①⓪">stashed exchange</a> to the result of creating a
new <a data-link-type="dfn" href="#exchange" id="ref-for-exchange⑧">exchange</a> with <var>prefetchedExchange</var>’s <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url④">request URL</a> and the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-clone" id="ref-for-concept-response-clone②">cloning</a> <var>prefetchedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response⑧">response</a>.</p>
     </ol>
   </ol>
   <p>And in</p>
   <blockquote>
    <ol start="16">
     <li data-md>
      <p>Let <var>navigationParams</var> be a new <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params" id="ref-for-navigation-params①">navigation params</a> whose ...</p>
    </ol>
   </blockquote>
   <p>add:</p>
   <ol start="16">
    <li data-md>
     <p>... <a data-link-type="dfn" href="#navigation-params-prefetched-subresource-signed-exchanges" id="ref-for-navigation-params-prefetched-subresource-signed-exchanges">prefetched subresource signed exchanges</a> is <var>sourceBrowsingContext</var>’s <a data-link-type="dfn">active document</a>'s <a data-link-type="dfn" href="#document-prefetched-subresource-signed-exchanges" id="ref-for-document-prefetched-subresource-signed-exchanges①">prefetched
subresource signed exchanges</a>, ...</p>
   </ol>
   <p class="note" role="note"><span class="marker">Note:</span> As browsers move toward partitioned HTTP caches, the source document’s
    cache will likely be separate from the target’s cache, so we can’t just pass
    prefetched content through the cache.</p>
   <h3 class="heading settled algorithm" data-algorithm="Monkeypatch Page load processing model for HTML files" data-level="3.5" id="mp-page-load-processing-model-for-html-fiiles"><span class="secno">3.5. </span><span class="content"> Monkeypatch Page load processing model for HTML files</span><a class="self-link" href="#mp-page-load-processing-model-for-html-fiiles"></a></h3>
   <p class="note" role="note"><span class="marker">Note:</span> To use the <a data-link-type="dfn" href="#navigation-params-prefetched-subresource-signed-exchanges" id="ref-for-navigation-params-prefetched-subresource-signed-exchanges①">prefetched subresource signed exchanges</a> after the navigation, this section monkeypatches <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#read-html" id="ref-for-read-html">Page load processing model
for HTML files</a>. This gets all the <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg④">allowed-alt-sxg</a></code> links from the
inner response that are also preloaded and uses the <a data-link-type="dfn" href="#navigation-params-prefetched-subresource-signed-exchanges" id="ref-for-navigation-params-prefetched-subresource-signed-exchanges②">prefetched subresource signed exchanges</a> if all of those links were
prefetched.</p>
   <p class="issue" id="issue-12fd0d51"><a class="self-link" href="#issue-12fd0d51"></a> Currently the processing model of the HTTP <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3⑤">Link</a> header is not defined in the HTML spec. This section
monkeypatches only for <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3⑥">Link</a> rel=preload HTTP headers. When we
will change the HTML spec to generally support <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3⑦">Link</a> HTTP
headers, this section must be made to align with the change. <a href="https://github.com/whatwg/html/issues/4224">[Issue #whatwg/html#4224]</a></p>
   <p>In <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#read-html" id="ref-for-read-html①">Page load processing model for HTML files</a> before</p>
   <blockquote>
    <ol start="2">
     <li data-md>
      <p>Create an HTML parser and ...</p>
    </ol>
   </blockquote>
   <p>add the following steps:</p>
   <ol start="2">
    <li data-md>
     <p>Run the following steps <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel②">in parallel</a>:</p>
     <ol>
      <li data-md>
       <p>Wait until <var>document</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css2/#viewport" id="ref-for-viewport">viewport</a> is known.</p>
       <p class="note" role="note"><span class="marker">Note:</span> When the <var>document</var>’s <a data-link-type="dfn" href="https://drafts.csswg.org/css2/#viewport" id="ref-for-viewport①">viewport</a> is known is not normatively
defined in the HTML spec. Need to define the behavior of
the preload scanner to define this.</p>
      <li data-md>
       <p>Let <var>linkHeader</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get②">getting</a> <code>`Link` </code> from <var>navigationParams</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response" id="ref-for-navigation-params-response">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list⑤">header list</a>.</p>
      <li data-md>
       <p>If <var>linkHeader</var> is null, then return.</p>
      <li data-md>
       <p>Let <var>links</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#appendix-B.2" id="ref-for-appendix-B.2②">Parsing a Link Field Value</a> from <var>linkHeader</var>.</p>
      <li data-md>
       <p>Let <var>allowedSxgLinks</var> be the result of <a data-link-type="dfn" href="#getting-allowed-signed-exchange-link-info" id="ref-for-getting-allowed-signed-exchange-link-info①">getting allowed signed
exchange link info</a> from <var>links</var>.</p>
      <li data-md>
       <p>Let <var>preloadLinkItems</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a>.</p>
      <li data-md>
       <p>Let <var>canLoadAlternateSxg</var> be true.</p>
      <li data-md>
       <p>For each <var>link</var> of <var>links</var>:</p>
       <ol>
        <li data-md>
         <p>If <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.3" id="ref-for-section-3.3①">Relation Type</a> is not 'preload', then continue.</p>
        <li data-md>
         <p>Let <var>linkTarget</var> be <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1④">Link Target</a>.</p>
        <li data-md>
         <p>Let <var>asAttribute</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named③">Target Attribute named</a> <code>"as"</code>.</p>
        <li data-md>
         <p>If <var>asAttribute</var> is not a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination" id="ref-for-concept-potential-destination①">potential destination</a>, continue.</p>
        <li data-md>
         <p>If <var>asAttribute</var> is <code>"image"</code>, then:</p>
         <ol>
          <li data-md>
           <p>Let <var>imagesrcset</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named④">Target Attribute named</a> <code>"imagesrcset"</code>.</p>
          <li data-md>
           <p>Let <var>imagesizes</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named⑤">Target Attribute named</a> <code>"imagesizes"</code>.</p>
          <li data-md>
           <p>Create a <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/semantics.html#the-link-element" id="ref-for-the-link-element①">link</a></code> element <var>linkElement</var> whose <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-href" id="ref-for-attr-link-href①">href</a></code> attribute is <var>linkTarget</var>, and <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesrcset" id="ref-for-attr-link-imagesrcset①">imagesrcset</a></code> attribute is <var>imagesrcset</var>, and <code><a data-link-type="element-sub" href="https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesizes" id="ref-for-attr-link-imagesizes①">imagesizes</a></code> attribute is <var>imagesizes</var>.</p>
          <li data-md>
           <p>Let <var>selected source</var> and <var>selected pixel
density</var> be the URL and pixel density that results from <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/images.html#select-an-image-source" id="ref-for-select-an-image-source①">selecting an image source</a> given <var>linkElement</var>,
respectively.</p>
          <li data-md>
           <p>If <var>selected source</var> is not null, then set <var>linkTarget</var> to
the result of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser①">parsing</a> <var>selected source</var>, with
a base URL of <var>navigationParams</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response" id="ref-for-navigation-params-response①">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url②">URL</a>.</p>
         </ol>
        <li data-md>
         <p>Let <var>headerIntegrity</var> be null.</p>
        <li data-md>
         <p>For each <var>allowedSxgLink</var> of <var>allowedSxgLinks</var>:</p>
         <ol>
          <li data-md>
           <p>Let <var>storedExchange</var> be the result of creating an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange⑨">exchange</a> with the URL of <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-target" id="ref-for-allowed-signed-exchange-link-info-target①">target</a> and a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑥">response</a>.</p>
          <li data-md>
           <p>If <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variants" id="ref-for-allowed-signed-exchange-link-info-variants③">variants</a> is null, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set④">set</a> <code>`Variants` </code>/<var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variants" id="ref-for-allowed-signed-exchange-link-info-variants④">variants</a> in <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response⑨">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list⑥">header list</a>.</p>
          <li data-md>
           <p>If <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variant-key" id="ref-for-allowed-signed-exchange-link-info-variant-key③">variant key</a> is not null, <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set⑤">set</a> <code> `Variant-Key`</code>/<var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-variant-key" id="ref-for-allowed-signed-exchange-link-info-variant-key④">variant key</a> in <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⓪">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list⑦">header list</a>.</p>
          <li data-md>
           <p>Let <var>requestForMatch</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#create-a-potential-cors-request" id="ref-for-create-a-potential-cors-request②">creating a
potential-CORS request</a> given a url of <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-target" id="ref-for-allowed-signed-exchange-link-info-target②">target</a>, a destination of
the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination-translate" id="ref-for-concept-potential-destination-translate②">translating</a> <var>asAttribute</var>, and a
corsAttributeState of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-crossorigin-none" id="ref-for-attr-crossorigin-none②">No CORS</a>.</p>
          <li data-md>
           <p>If <var>requestForMatch</var> <a data-link-type="dfn" href="#matches-the-stored-exchange" id="ref-for-matches-the-stored-exchange②">matches the stored exchange</a> <var>storedExchange</var>, then:</p>
           <ol>
            <li data-md>
             <p>Set <var>headerIntegrity</var> to <var>allowedSxgLink</var>’s <a data-link-type="dfn" href="#allowed-signed-exchange-link-info-header-integrity" id="ref-for-allowed-signed-exchange-link-info-header-integrity">header integrity</a>.</p>
            <li data-md>
             <p>Break out of the <var>allowedSxgLinks</var> loop.</p>
           </ol>
         </ol>
        <li data-md>
         <p>Let <var>prefetched alternate exchange</var> be null.</p>
        <li data-md>
         <p>For each <var>sxg</var> of <var>navigationParams</var>’s <a data-link-type="dfn" href="#navigation-params-prefetched-subresource-signed-exchanges" id="ref-for-navigation-params-prefetched-subresource-signed-exchanges③">prefetched subresource signed exchanges</a>:</p>
         <ol>
          <li data-md>
           <p>If <var>headerIntegrity</var> is the same as the value of <var>sxg</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①①">response</a>'s <a data-link-type="dfn" href="#response-header-integrity-value" id="ref-for-response-header-integrity-value②">header integrity value</a> encoded as a <a data-link-type="biblio" href="#biblio-csp" title="Content Security Policy Level 3">[CSP]</a> <a data-link-type="grammar" href="https://w3c.github.io/webappsec-csp/#grammardef-hash-source" id="ref-for-grammardef-hash-source①">hash-source</a>, then set <var>prefetched alternate exchange</var> to <var>sxg</var>.</p>
         </ol>
        <li data-md>
         <p>If <var>headerIntegrity</var> is not null and <var>prefetched alternate
exchange</var> is null, then set <var>canLoadAlternateSxg</var> to false.</p>
         <p class="note" role="note"><span class="marker">Note:</span> This means that there is a matching <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg⑤">allowed-alt-sxg</a></code> link for the <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-preload" id="ref-for-link-type-preload②">preload</a></code> <var>link</var>, but the matching signed exchange has not been
prefetched. In this case the UA can’t use the prefetched
subresource signed exchanges for other <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-preload" id="ref-for-link-type-preload③">preload</a></code> links. This is intended to prevent the referrer page from
encoding a tracking ID into the set of subresources it
prefetches.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> the <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info" id="ref-for-alternate-signed-exchange-preload-info">alternate signed exchange preload info</a> (<var>link</var>, <var>linkTarget</var>, <var>prefetched alternate exchange</var>) to <var>preloadLinkItems</var>.</p>
       </ol>
      <li data-md>
       <p>For each <var>preloadLinkItem</var> of <var>preloadLinkItems</var>:</p>
       <ol>
        <li data-md>
         <p>Let <var>asAttribute</var> be <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link">link</a>'s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named⑥">Target Attribute named</a> <code>"as"</code>.</p>
        <li data-md>
         <p class="assertion">Assert: <var>asAttribute</var> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination" id="ref-for-concept-potential-destination②">potential destination</a>.</p>
        <li data-md>
         <p>Let <var>corsAttributeState</var> be the state of a synthetic <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-settings-attribute" id="ref-for-cors-settings-attribute">CORS settings
attribute</a> with a value of <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link①">link</a>'s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named⑦">Target Attribute named</a> <code>"crossorigin"</code>.</p>
        <li data-md>
         <p>Let <var>request</var> be the result of <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#create-a-potential-cors-request" id="ref-for-create-a-potential-cors-request③">creating a potential-CORS request</a> given a url of <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-target" id="ref-for-alternate-signed-exchange-preload-info-target">target</a>, a destination of the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-potential-destination-translate" id="ref-for-concept-potential-destination-translate③">translating</a> <var>asAttribute</var>, and a corsAttributeState
of <var>corsAttributeState</var>.</p>
        <li data-md>
         <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client①">client</a> to <var>document</var>.</p>
        <li data-md>
         <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-nonce-metadata" id="ref-for-concept-request-nonce-metadata">cryptographic nonce metadata</a> to <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link②">link</a>'s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named⑧">Target Attribute named</a> <code>"nonce"</code>.</p>
        <li data-md>
         <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-integrity-metadata" id="ref-for-concept-request-integrity-metadata">integrity metadata</a> to <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link③">link</a>'s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named⑨">Target Attribute named</a> <code>"integrity"</code>.</p>
        <li data-md>
         <p>Set <var>request</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-referrer-policy" id="ref-for-concept-request-referrer-policy">referrer policy</a> to be the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/urls-and-fetching.html#referrer-policy-attribute" id="ref-for-referrer-policy-attribute">referrer
policy attribute</a> of <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link④">link</a>'s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①⓪">Target Attribute named</a> <code>"referrerpolicy"</code>.</p>
        <li data-md>
         <p>If <var>canLoadAlternateSxg</var> is true, then set <var>request</var>’s <a data-link-type="dfn" href="#request-stashed-exchange" id="ref-for-request-stashed-exchange①①">stashed exchange</a> to <var>preloadLinkItem</var>’s <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-prefetched-alternate-exchange" id="ref-for-alternate-signed-exchange-preload-info-prefetched-alternate-exchange">prefetched alternate exchange</a>.</p>
         <p class="note" role="note"><span class="marker">Note:</span> When <var>canLoadAlternateSxg</var> if false or there is no
matching prefetched alternate exchange, the original resource
declared in the <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-preload" id="ref-for-link-type-preload④">preload</a></code> <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3⑧">Link</a> header <var>link</var> will be fetched.</p>
        <li data-md>
         <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch①">Fetch</a> <var>request</var> <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel③">in parallel</a>.</p>
       </ol>
     </ol>
   </ol>
   <h2 class="heading settled" data-level="4" id="structs"><span class="secno">4. </span><span class="content">Structures</span><a class="self-link" href="#structs"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.1" data-lt="Exchange" id="exchange"><span class="secno">4.1. </span><span class="content">Exchange</span><a class="self-link" href="#exchange" id="ref-for-exchange①⑦"></a></h3>
   <p>An exchange is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> with the following items:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="exchange" data-dfn-type="dfn" data-export id="exchange-request-url">request URL</dfn>, a <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url①">URL</a>.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="exchange" data-dfn-type="dfn" data-export id="exchange-response">response</dfn>, a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑦">response</a>.</p>
   </ul>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="4.2" data-lt="Read buffer" data-noexport id="read-buffer"><span class="secno">4.2. </span><span class="content">Read buffer</span><a class="self-link" href="#read-buffer" id="ref-for-read-buffer"></a></h3>
   <p>A read buffer is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> with the following items:</p>
   <ul>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-noexport id="read-buffer-stream">stream</dfn>: A <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream">ReadableStream</a></code>.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-noexport id="read-buffer-reader">reader</dfn>: A <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader">ReadableStreamDefaultReader</a></code> whose stream is <a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream">stream</a>.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-noexport id="read-buffer-bytes">bytes</dfn>: A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①">byte sequence</a> holding the bytes that have been read
from <a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream①">stream</a> but not returned to a calling algorithm yet.</p>
   </ul>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-level="4.3" data-lt="Augmented Certificate" data-noexport id="augmented-certificate"><span class="secno">4.3. </span><span class="content">Augmented Certificate</span><a class="self-link" href="#augmented-certificate" id="ref-for-augmented-certificate"></a></h3>
   <p>An augmented certificate is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#tuple" id="ref-for-tuple">tuple</a> with the following items:</p>
   <ol>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="augmented certificate" data-dfn-type="dfn" data-noexport id="augmented-certificate-certificate">certificate</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence②">byte sequence</a> that’s expected to hold a
DER-encoded X.509v3 certificate (<a data-link-type="biblio" href="#biblio-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</a>).</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="augmented certificate" data-dfn-type="dfn" data-noexport id="augmented-certificate-ocsp-response">OCSP response</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence③">byte sequence</a> that’s expected to hold a
DER-encoded <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6960#section-4.2.1" id="ref-for-section-4.2.1">OCSPResponse</a> for the <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate">certificate</a>.</p>
    <li data-md>
     <p><dfn class="dfn-paneled" data-dfn-for="augmented certificate" data-dfn-type="dfn" data-noexport id="augmented-certificate-sct">SCT</dfn>, a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence④">byte sequence</a> that’s expected to hold a <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc6962#section-3.3" id="ref-for-section-3.3②">SignedCertificateTimestampList</a> for the <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate①">certificate</a>.</p>
   </ol>
   <p>These fields are <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑤">byte sequences</a> instead of parsed and validated structures
because we expect some UAs to pass them to other systems for validation, and
some of those systems expect plain byte sequences.</p>
   <p>A <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate②">certificate</a> contains a <dfn class="dfn-paneled" data-dfn-for="certificate" data-dfn-type="dfn" data-lt="public key" data-noexport id="certificate-public-key">public
key</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5280#section-4.1.2.7" id="ref-for-section-4.1.2.7">Subject Public Key Info</a>), which has an <dfn class="dfn-paneled" data-dfn-for="public
key" data-dfn-type="dfn" data-noexport id="public-key-algorithm">algorithm</dfn> (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5280#section-4.1.1.2" id="ref-for-section-4.1.1.2">AlgorithmIdentifier</a>).</p>
   <p>A <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate③">certificate</a> contains an <dfn class="dfn-paneled" data-dfn-for="certificate" data-dfn-type="dfn" data-noexport id="certificate-extensions">extensions</dfn> map (<a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5280#section-4.2" id="ref-for-section-4.2">Certificate Extensions</a>) from OIDs to <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑥">byte sequences</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="certificate-chain">certificate chain</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <a data-link-type="dfn" href="#augmented-certificate" id="ref-for-augmented-certificate①">augmented certificates</a>, of
which the first <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item">item</a> is the <dfn class="dfn-paneled" data-dfn-for="certificate chain" data-dfn-type="dfn" data-noexport id="certificate-chain-leaf">leaf</dfn>.</p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.4" data-lt="Signed Exchange report" id="signed-exchange-report"><span class="secno">4.4. </span><span class="content">Signed Exchange report</span><a class="self-link" href="#signed-exchange-report" id="ref-for-signed-exchange-report"></a></h3>
   <p>A signed exchange report is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct②">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-result">result</dfn>
    <dd data-md>
     <p>The result string of loading signed exchange. This must be unset or one of
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-ok"><code>ok</code></dfn>", "<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-mi_error"><code>mi_error</code></dfn>",
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-non_secure_distributor"><code>non_secure_distributor</code></dfn>", "<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-parse_error"><code>parse_error</code></dfn>",
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-invalid_integrity_header"><code>invalid_integrity_header</code></dfn>",
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-signature_verification_error"><code>signature_verification_error</code></dfn>",
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-cert_verification_error"><code>cert_verification_error</code></dfn>", "<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-cert_fetch_error"><code>cert_fetch_error</code></dfn>",
"<dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-cert_parse_error"><code>cert_parse_error</code></dfn>",</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-outer-request">outer request</dfn>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request①">request</a> which the user agent sent to the server to load the signed exchange.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-outer-response">outer response</dfn>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑧">response</a> which the user agent received from the server.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-inner-url">inner URL</dfn>
    <dd data-md>
     <p>The logical <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url②">URL</a> of the signed exchange, if available. Otherwise, an empty
string.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-cert-url-list">cert URL list</dfn>
    <dd data-md>
     <p>The list of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url③">URLs</a> in "<code>cert-url</code>" parameters for the signed exchange’s
signatures, if available. Otherwise, an empty list.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-server-ip">server IP</dfn>
    <dd data-md>
     <p>The IP address of the server from which the user agent received the signed
exchange, if available. Otherwise, an empty string.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="signed exchange report" data-dfn-type="dfn" data-noexport id="signed-exchange-report-cert-server-ip-list">cert server IP list</dfn>
    <dd data-md>
     <p>The list of IP addresses of the servers from which the user agent received
the certificates listed in <a data-link-type="dfn" href="#signed-exchange-report-cert-url-list" id="ref-for-signed-exchange-report-cert-url-list">cert URL list</a>.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.5" data-lt="Exchange Signature" id="exchange-signature"><span class="secno">4.5. </span><span class="content">Exchange Signature</span><a class="self-link" href="#exchange-signature" id="ref-for-exchange-signature"></a></h3>
   <p>An exchange signature is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct③">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-signature">signature</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑦">byte sequence</a> holding a signature of the exchange.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-certificate-chain">certificate chain</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="#certificate-chain" id="ref-for-certificate-chain">certificate chain</a> whose <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf">leaf</a>'s <a data-link-type="dfn" href="#certificate-public-key" id="ref-for-certificate-public-key">public key</a> can verify the <a data-link-type="dfn" href="#exchange-signature-signature" id="ref-for-exchange-signature-signature">signature</a> and from which the UA will try to build a path from the <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf①">leaf</a> to a trusted root.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-certsha256">certSha256</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑧">byte sequence</a> holding the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something①">SHA-256</a> hash that verified the <a data-link-type="dfn" href="#exchange-signature-certificate-chain" id="ref-for-exchange-signature-certificate-chain">certificate chain</a>'s <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf②">leaf</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-integrity-header">integrity header</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-string" id="ref-for-ascii-string">ASCII strings</a> that describes the response header and any of
its parameters that guard the integrity of the response payload.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-validityurl">validityUrl</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url④">URL</a> describing where to update this signature.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-validityurlbytes">validityUrlBytes</dfn>
    <dd data-md>
     <p>The bytes that <a data-link-type="dfn" href="#exchange-signature-validityurl" id="ref-for-exchange-signature-validityurl">validityUrl</a> was parsed from.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-date">date</dfn>
    <dd data-md>
     <p>The POSIX time at which the signature starts being valid.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-noexport id="exchange-signature-expiration-time">expiration time</dfn>
    <dd data-md>
     <p>The POSIX time at which the signature stops being valid.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.6" data-lt="Allowed signed exchange link info" id="allowed-signed-exchange-link-info"><span class="secno">4.6. </span><span class="content">Allowed signed exchange link info</span><a class="self-link" href="#allowed-signed-exchange-link-info" id="ref-for-allowed-signed-exchange-link-info"></a></h3>
   <p>An allowed signed exchange link info is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct④">struct</a> with the following items,
holding a parsed <code><a data-link-type="attr-value" href="#attr-valuedef-link-rel-allowed-alt-sxg" id="ref-for-attr-valuedef-link-rel-allowed-alt-sxg⑥">allowed-alt-sxg</a></code> link:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="allowed signed exchange link info" data-dfn-type="dfn" data-noexport id="allowed-signed-exchange-link-info-target">target</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑤">URL</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1⑤">Link Target</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="allowed signed exchange link info" data-dfn-type="dfn" data-noexport id="allowed-signed-exchange-link-info-header-integrity">header integrity</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string">string</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2">Target Attribute</a> named <code>"header-integrity"</code>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="allowed signed exchange link info" data-dfn-type="dfn" data-noexport id="allowed-signed-exchange-link-info-variants">variants</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string①">string</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2①">Target Attribute</a> named <code>"variants"</code>, or null.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="allowed signed exchange link info" data-dfn-type="dfn" data-noexport id="allowed-signed-exchange-link-info-variant-key">variant key</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string②">string</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2②">Target Attribute</a> named <code>"variant key"</code>, or null.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.7" data-lt="Alternate signed exchange link info" id="alternate-signed-exchange-link-info"><span class="secno">4.7. </span><span class="content">Alternate signed exchange link info</span><a class="self-link" href="#alternate-signed-exchange-link-info" id="ref-for-alternate-signed-exchange-link-info②"></a></h3>
   <p>An alternate signed exchange link info is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑤">struct</a> with the following items,
holding a parsed <code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#rel-alternate" id="ref-for-rel-alternate①">alternate</a></code> link:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange link info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-link-info-target">target</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑥">URL</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1⑥">Link Target</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange link info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-link-info-context">context</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑦">URL</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.2" id="ref-for-section-3.2②">Link Context</a>.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange link info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-link-info-variants">variants</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string③">string</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2③">Target Attribute</a> named <code>"variants"</code>, or null.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange link info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-link-info-variant-key">variant key</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#string" id="ref-for-string④">string</a> holding the value of the link’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2④">Target Attribute</a> named <code>"variant key"</code>, or null.</p>
   </dl>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export data-level="4.8" data-lt="Alternate signed exchange preload info" id="alternate-signed-exchange-preload-info"><span class="secno">4.8. </span><span class="content">Alternate signed exchange preload info</span><a class="self-link" href="#alternate-signed-exchange-preload-info" id="ref-for-alternate-signed-exchange-preload-info①"></a></h3>
   <p>An alternate signed exchange preload info is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑥">struct</a> with the following items:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange preload info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-preload-info-link">link</dfn>
    <dd data-md>
     <p>A link object <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#appendix-B.2" id="ref-for-appendix-B.2③">parsed</a> from a HTTP <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3" id="ref-for-section-3⑨">Link</a> header.</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange preload info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-preload-info-target">target</dfn>
    <dd data-md>
     <p>A URL to be preloaded. <span class="note">This can be different from <a data-link-type="dfn" href="#alternate-signed-exchange-preload-info-link" id="ref-for-alternate-signed-exchange-preload-info-link⑤">link</a>'s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1⑦">Link Target</a>, when <code>"imagesrcset"</code> is used for image preload.</span></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="alternate signed exchange preload info" data-dfn-type="dfn" data-noexport id="alternate-signed-exchange-preload-info-prefetched-alternate-exchange">prefetched alternate exchange</dfn>
    <dd data-md>
     <p>The <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①⓪">exchange</a> of the prefetched <a data-link-type="dfn" href="#alternate-signed-exchange" id="ref-for-alternate-signed-exchange③">alternate signed exchange</a>, or null.</p>
   </dl>
   <h2 class="heading settled" data-level="5" id="algorithms"><span class="secno">5. </span><span class="content">Algorithms</span><a class="self-link" href="#algorithms"></a></h2>
   <h3 class="heading settled algorithm" data-algorithm="Identifying signed exchanges" data-level="5.1" id="identifying-sxg"><span class="secno">5.1. </span><span class="content">Identifying signed exchanges</span><a class="self-link" href="#identifying-sxg"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="signed-exchange-version">signed exchange version</dfn> of a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response⑨">response</a> <var>response</var> is the
result of the following steps:</p>
   <ol>
    <li data-md>
     <p>If <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#determine-nosniff" id="ref-for-determine-nosniff">determine nosniff</a> on <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list⑧">header
list</a> returns false, return undefined.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This requires servers to include the <code>X-Content-Type-Options: nosniff</code> header when they serve signed exchanges, which prevents some clients that
don’t understand signed exchanges from interpreting one as another content
type.</p>
    <li data-md>
     <p>Let <var>mimeType</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-extract-mime-type" id="ref-for-concept-header-extract-mime-type">extracting a MIME type</a> from <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list⑨">header list</a>.</p>
    <li data-md>
     <p>If <var>mimeType</var> is a failure, return undefined.</p>
    <li data-md>
     <p>If <var>mimeType</var>’s <a data-link-type="dfn" href="https://mimesniff.spec.whatwg.org/#mime-type-essence" id="ref-for-mime-type-essence">essence</a> is not <code>"application/signed-exchange"</code>,
return undefined.</p>
    <li data-md>
     <p>Let <var>params</var> be <var>mimeType</var>’s <a data-link-type="dfn" href="https://mimesniff.spec.whatwg.org/#parameters" id="ref-for-parameters">parameters</a></p>
    <li data-md>
     <p>If <var>params</var>["v"] exists, return it. Otherwise, return undefined.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Extracting the fallback URL" data-level="5.2" id="parsing-fallback"><span class="secno">5.2. </span><span class="content">Extracting the fallback URL</span><a class="self-link" href="#parsing-fallback"></a></h3>
   <p>This section defines how to load a the fallback URL from its invariant location
in an unrecognized signed exchange version.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="extracting-the-fallback-url">Extracting the fallback URL</dfn> from a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①⓪">response</a> <var>response</var> returns
the result of the following steps:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel④">in parallel</a>.</p>
    <li data-md>
     <p class="assertion">Assert: The <a data-link-type="dfn" href="#signed-exchange-version" id="ref-for-signed-exchange-version①">signed exchange version</a> of <var>response</var> is not undefined.</p>
    <li data-md>
     <p>Let <var>bodyStream</var> be <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream">stream</a>.</p>
    <li data-md>
     <p>If <var>bodyStream</var> is null, return failure.</p>
    <li data-md>
     <p>Let <var>stream</var> be a <a data-link-type="dfn" href="#new-read-buffer" id="ref-for-new-read-buffer">new read buffer</a> for <var>bodyStream</var>.</p>
    <li data-md>
     <p>Let (<var>magic</var>, <var>fallbackUrlBytes</var>, <var>fallbackUrl</var>) be the result of <a data-link-type="dfn" href="#parsing-the-invariant-prefix" id="ref-for-parsing-the-invariant-prefix">parsing the invariant prefix</a> from <var>stream</var>. If returns a failure, return that failure.</p>
    <li data-md>
     <p>Return <var>fallbackUrlBytes</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing signed exchanges" data-level="5.3" id="parsing"><span class="secno">5.3. </span><span class="content">Parsing signed exchanges</span><a class="self-link" href="#parsing"></a></h3>
   <p>This section defines how to load the formats defined in <a data-link-type="biblio" href="#biblio-draft-yasskin-httpbis-origin-signed-exchanges-impl-02" title="Signed HTTP Exchanges Implementation Checkpoints">[draft-yasskin-httpbis-origin-signed-exchanges-impl-02]</a> and <a data-link-type="biblio" href="#biblio-draft-yasskin-httpbis-origin-signed-exchanges-impl-03" title="Signed HTTP Exchanges Implementation Checkpoints">[draft-yasskin-httpbis-origin-signed-exchanges-impl-03]</a>.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing-a-signed-exchange">Parsing a signed exchange</dfn> of version <var>version</var> from a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①①">response</a> <var>response</var> in the context of an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object">environment settings object</a> <var>client</var>,
reporting to a <a data-link-type="dfn" href="#signed-exchange-report" id="ref-for-signed-exchange-report④">signed exchange report</a> <var>report</var>, returns an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①①">exchange</a> or a
string which indicates a <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result">result</a> as described by the
following steps</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel⑤">in parallel</a>.</p>
    <li data-md>
     <p class="assertion">Assert: The <a data-link-type="dfn" href="#signed-exchange-version" id="ref-for-signed-exchange-version②">signed exchange version</a> of <var>response</var> is, if <var>version</var> is</p>
     <dl class="switch">
      <dt data-md><code>b2</code>
      <dd data-md>
       <p><code>"b2"</code></p>
      <dt data-md><code>b3</code>
      <dd data-md>
       <p><code>"b3"</code></p>
     </dl>
    <li data-md>
     <p>If <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-url" id="ref-for-concept-response-url③">URL</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin">origin</a> is not a <a data-link-type="dfn" href="https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin" id="ref-for-potentially-trustworthy-origin">potentially
trustworthy origin</a>, return
"<a data-link-type="dfn" href="#signed-exchange-report-non_secure_distributor" id="ref-for-signed-exchange-report-non_secure_distributor">non_secure_distributor</a>".</p>
     <p class="note" role="note"><span class="marker">Note:</span> This ensures that the privacy properties of retrieving an HTTPS
resource via a signed exchange are no worse than retrieving it via TLS.</p>
    <li data-md>
     <p>Let <var>bodyStream</var> be <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body①">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream①">stream</a>.</p>
    <li data-md>
     <p>If <var>bodyStream</var> is null, return "<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error">parse_error</a>".</p>
    <li data-md>
     <p>Let <var>stream</var> be a <a data-link-type="dfn" href="#new-read-buffer" id="ref-for-new-read-buffer①">new read buffer</a> for <var>bodyStream</var>.</p>
    <li data-md>
     <p>Let (<var>magic</var>, <var>requestUrlBytes</var>, <var>requestUrl</var>) be the result of <a data-link-type="dfn" href="#parsing-the-invariant-prefix" id="ref-for-parsing-the-invariant-prefix①">parsing the
invariant prefix</a> from <var>stream</var>. If returns a failure, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①">parse_error</a>".</p>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-inner-url" id="ref-for-signed-exchange-report-inner-url">inner URL</a> to <var>requestUrl</var>.</p>
    <li data-md>
     <p>If <var>magic</var> is not the following value, depending on <var>version</var>, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error②">parse_error</a>":</p>
     <dl class="switch">
      <dt data-md><code>b2</code>
      <dd data-md>
       <p><code>`sxg1-b2\0`</code></p>
      <dt data-md><code>b3</code>
      <dd data-md>
       <p><code>`sxg1-b3\0`</code></p>
     </dl>
    <li data-md>
     <p class="assertion">Assert: <var>requestUrlBytes</var> should match the result of <a data-link-type="dfn" href="#extracting-the-fallback-url" id="ref-for-extracting-the-fallback-url①">extracting the
fallback URL</a> from <var>response</var>.</p>
    <li data-md>
     <p>Let <var>encodedSigLength</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read">reading</a> 3 bytes from <var>stream</var>.</p>
    <li data-md>
     <p>Let <var>encodedHeaderLength</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read①">reading</a> 3 bytes
from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>encodedSigLength</var> or <var>encodedHeaderLength</var> is a failure, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error③">parse_error</a>".</p>
    <li data-md>
     <p>Let <var>sigLength</var> be the result of decoding <var>encodedSigLength</var> as a big-endian
integer.</p>
    <li data-md>
     <p>Let <var>headerLength</var> be the result of decoding <var>encodedHeaderLength</var> as a
big-endian integer.</p>
    <li data-md>
     <p>If <var>sigLength</var> > 16384 or <var>headerLength</var> > 524288, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error④">parse_error</a>".</p>
    <li data-md>
     <p>Let <var>signature</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read②">reading</a> <var>sigLength</var> bytes
from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>signature</var> is a failure, return "<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error⑤">parse_error</a>".</p>
    <li data-md>
     <p>Let <var>parsedSignature</var> be the result of <a data-link-type="dfn" href="#parsing-the-signature-header-field" id="ref-for-parsing-the-signature-header-field">parsing the Signature header field</a> <var>signature</var> in the context of <var>client</var> reporting to with <var>report</var>.</p>
    <li data-md>
     <p>If <var>parsedSignature</var> is not an <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature⑦">exchange signature</a>, return it.</p>
    <li data-md>
     <p>Let <var>headerBytes</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read③">reading</a> <var>headerLength</var> bytes from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>headerBytes</var> is a failure, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error⑥">parse_error</a>".</p>
    <li data-md>
     <p>If <var>parsedSignature</var> <a data-link-type="dfn" href="#exchange-signature-is-valid" id="ref-for-exchange-signature-is-valid">is not valid</a> for <var>headerBytes</var> and <var>requestUrlBytes</var>, and signed exchange version <var>version</var>, return
"<a data-link-type="dfn" href="#signed-exchange-report-signature_verification_error" id="ref-for-signed-exchange-report-signature_verification_error">signature_verification_error</a>".</p>
    <li data-md>
     <p>Let <var>parsedExchange</var> be, if <var>version</var> is:</p>
     <dl class="switch">
      <dt data-md><code>b2</code>
      <dd data-md>
       <p>the result of <a data-link-type="dfn" href="#parsing-b2-cbor-headers" id="ref-for-parsing-b2-cbor-headers">parsing b2 CBOR headers</a> given <var>headerBytes</var> and <var>requestUrl</var>.</p>
      <dt data-md><code>b3</code>
      <dd data-md>
       <p>the result of <a data-link-type="dfn" href="#parsing-b3-cbor-headers" id="ref-for-parsing-b3-cbor-headers">parsing b3 CBOR headers</a> given <var>headerBytes</var> and <var>requestUrl</var>.</p>
     </dl>
    <li data-md>
     <p>Set <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①②">response</a>'s <a data-link-type="dfn" href="#response-came-from-a-signed-exchange" id="ref-for-response-came-from-a-signed-exchange③">came from a signed
exchange</a> to true.</p>
    <li data-md>
     <p>Set <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①③">response</a>'s <a data-link-type="dfn" href="#response-signed-exchange-outer-header-list" id="ref-for-response-signed-exchange-outer-header-list①">signed exchange
outer header list</a> to <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⓪">header list</a>.</p>
    <li data-md>
     <p>Set <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①④">response</a>'s <a data-link-type="dfn" href="#response-header-integrity-value" id="ref-for-response-header-integrity-value③">header integrity
value</a> to the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something②">SHA-256</a> hash of <var>headerBytes</var>.</p>
    <li data-md>
     <p>If <var>parsedSignature</var> <a data-link-type="dfn" href="#exchange-signature-establishes-cross-origin-trust" id="ref-for-exchange-signature-establishes-cross-origin-trust">does not establish cross-origin
trust</a> for <var>parsedExchange</var>, return
"<a data-link-type="dfn" href="#signed-exchange-report-cert_verification_error" id="ref-for-signed-exchange-report-cert_verification_error">cert_verification_error</a>".</p>
    <li data-md>
     <p>If <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⑤">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status①">status</a> is a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#redirect-status" id="ref-for-redirect-status①">redirect status</a> or the <a data-link-type="dfn" href="#signed-exchange-version" id="ref-for-signed-exchange-version③">signed exchange version</a> of <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⑥">response</a> is not undefined, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error⑦">parse_error</a>".</p>
     <p class="note" role="note"><span class="marker">Note:</span> This might simplify the UA’s implementation, since it doesn’t have to
handle nested signed exchanges.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="#reading-a-body" id="ref-for-reading-a-body">Read a body</a> from <var>stream</var> into <var>parsedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⑦">response</a> using <var>parsedSignature</var> to check its integrity. If
this returns an error string, return it.</p>
     <p class="note" role="note"><span class="marker">Note:</span> Typically this body’s stream is still being enqueued to after
returning.</p>
    <li data-md>
     <p>Return <var>parsedExchange</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing the invariant prefix" data-level="5.4" id="parsing-prefix"><span class="secno">5.4. </span><span class="content">Parsing the invariant prefix</span><a class="self-link" href="#parsing-prefix"></a></h3>
   <p>All signed exchange versions start with the same initial bytes, parsed by this
section.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing-the-invariant-prefix">Parsing the invariant prefix</dfn> from a <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer⑥">read buffer</a> <var>stream</var> returns
a failure or the triple of a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence⑨">byte sequence</a> <var>magic</var>, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⓪">byte sequence</a> <var>fallbackUrlBytes</var>, and <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url" id="ref-for-concept-url⑧">URL</a> <var>fallbackUrl</var>, as described by the following
steps:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel⑥">in parallel</a>.</p>
    <li data-md>
     <p>Let <var>magic</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read④">reading</a> 8 bytes from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>magic</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>encodedFallbackUrlLength</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read⑤">reading</a> 2
bytes from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>encodedFallbackUrlLength</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>fallbackUrlLength</var> be the result of decoding <var>encodedFallbackUrlLength</var> as a big-endian integer.</p>
    <li data-md>
     <p>Let <var>fallbackUrlBytes</var> be the result of <a data-link-type="dfn" href="#read-buffer-read" id="ref-for-read-buffer-read⑥">reading</a> <var>fallbackUrlLength</var> bytes from <var>stream</var>.</p>
    <li data-md>
     <p>If <var>fallbackUrlBytes</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>fallbackUrlString</var> be the result of <a data-link-type="dfn" href="https://encoding.spec.whatwg.org/#utf-8-decode-without-bom-or-fail" id="ref-for-utf-8-decode-without-bom-or-fail">UTF-8 decode without BOM or fail</a> on <var>fallbackUrlBytes</var>.</p>
    <li data-md>
     <p>If <var>fallbackUrlString</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>fallbackUrl</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser②">URL parser</a> on <var>fallbackUrlString</var>.</p>
    <li data-md>
     <p>If <var>fallbackUrl</var> is a failure, if it has a non-null <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment">fragment</a>, or if
its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme">scheme</a> is something other than <code>"https"</code>, return a failure.</p>
    <li data-md>
     <p>Return (<var>magic</var>, <var>fallbackUrlBytes</var>, <var>fallbackUrl</var>).</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing a Signature Header Field" data-level="5.5" id="parsing-signature"><span class="secno">5.5. </span><span class="content">Parsing a Signature Header Field</span><a class="self-link" href="#parsing-signature"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing-the-signature-header-field">Parsing the Signature header field</dfn> <var>signatureString</var> in the context
of an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object①">environment settings object</a> <var>client</var>, reporting to a <a data-link-type="dfn" href="#signed-exchange-report" id="ref-for-signed-exchange-report①">signed exchange report</a> <var>report</var>, returns an <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature①">exchange signature</a> or
a string which indicates a <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result①">result</a>, as described by
the following steps:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel⑦">in parallel</a>.</p>
    <li data-md>
     <p>If <var>signatureString</var> contains any bytes that aren’t <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte" id="ref-for-ascii-byte">ASCII bytes</a>, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error⑧">parse_error</a>".</p>
    <li data-md>
     <p>Let <var>parsed</var> be the result of <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-07#section-4.2" id="ref-for-section-4.2①">Parsing HTTP1 Header Fields into Structured
Headers</a> given an <var>input_string</var> of the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-decode" id="ref-for-ascii-decode">ASCII decoding</a> of <var>signatureString</var> and a <var>header_type</var> of "param-list".</p>
    <li data-md>
     <p>If <var>parsed</var> has more than one element, "<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error⑨">parse_error</a>".</p>
     <p class="note" role="note"><span class="marker">Note:</span> This limitation of current implementations will go away in the future.</p>
    <li data-md>
     <p>If any of the parameters of <var>parsed</var>[0] listed here doesn’t have the
associated type, "<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①⓪">parse_error</a>".</p>
     <dl>
      <dt data-md>Byte sequence
      <dd data-md>
       <p>"sig", "cert-sha256"</p>
      <dt data-md>String
      <dd data-md>
       <p>"integrity", "cert-url", "validity-url"</p>
      <dt data-md>Integer
      <dd data-md>
       <p>"date", "expires"</p>
     </dl>
    <li data-md>
     <p>Let <var>result</var> be a new <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature②">exchange signature</a> struct.</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-signature" id="ref-for-exchange-signature-signature①">signature</a> to the "sig" parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-integrity-header" id="ref-for-exchange-signature-integrity-header">integrity header</a> to the result of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#strictly-split" id="ref-for-strictly-split">strictly splitting</a> the "integrity" parameter of <var>parsed</var>[0] on U+002F
(<code>/</code>).</p>
    <li data-md>
     <p>Let <var>certUrl</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser③">URL parser</a> on the "cert-url"
parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>Append <var>certUrl</var> to <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-cert-url-list" id="ref-for-signed-exchange-report-cert-url-list①">cert URL list</a>.</p>
    <li data-md>
     <p>If <var>certUrl</var> is a failure, if it has a non-null <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment①">fragment</a>, or if its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme①">scheme</a> is something other than <code>"https"</code> or <code>"data"</code>, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①①">parse_error</a>".</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-certsha256" id="ref-for-exchange-signature-certsha256">certSha256</a> to the "cert-sha256"
parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-validityurlbytes" id="ref-for-exchange-signature-validityurlbytes">validityUrlBytes</a> to the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-encode" id="ref-for-ascii-encode①">ASCII
encoding</a> of the "validity-url" parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>Let <var>validityUrl</var> be the result of running the <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-parser" id="ref-for-concept-url-parser④">URL parser</a> on the
"validity-url" parameter of <var>parsed</var>[0]..</p>
    <li data-md>
     <p>If <var>validityUrl</var> is a failure, if it has a non-null <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-fragment" id="ref-for-concept-url-fragment②">fragment</a>, or if
its <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme②">scheme</a> is something other than <code>"https"</code>, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①②">parse_error</a>".</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-validityurl" id="ref-for-exchange-signature-validityurl①">validityUrl</a> to <var>validityUrl</var>.</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date">date</a> to the "date" parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time①">expiration time</a> to the "expires"
parameter of <var>parsed</var>[0].</p>
    <li data-md>
     <p>If <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time②">expiration time</a> or <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date①">date</a> is less than 0 or greater than 2<sup>63</sup>-1, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①③">parse_error</a>".</p>
    <li data-md>
     <p>If <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time③">expiration time</a> &lt;= <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date②">date</a>, return
"<a data-link-type="dfn" href="#signed-exchange-report-parse_error" id="ref-for-signed-exchange-report-parse_error①④">parse_error</a>".</p>
    <li data-md>
     <p>Set <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-certificate-chain" id="ref-for-exchange-signature-certificate-chain①">certificate chain</a> to the result of <a data-link-type="dfn" href="#handling-the-certificate-reference" id="ref-for-handling-the-certificate-reference">handling the certificate reference</a> <var>certUrl</var> with a hash of <var>result</var>’s <a data-link-type="dfn" href="#exchange-signature-certsha256" id="ref-for-exchange-signature-certsha256①">certSha256</a> and <var>report</var> in the context of <var>client</var>.
If this is not a <a data-link-type="dfn" href="#certificate-chain" id="ref-for-certificate-chain①">certificate chain</a>, return it.</p>
    <li data-md>
     <p>Return <var>result</var>.</p>
   </ol>
   <h4 class="heading settled algorithm" data-algorithm="Handling the certificate reference" data-level="5.5.1" id="handling-cert-url"><span class="secno">5.5.1. </span><span class="content">Handling the certificate reference</span><a class="self-link" href="#handling-cert-url"></a></h4>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="handling-the-certificate-reference">Handling the certificate reference</dfn> <var>certUrl</var> with the SHA-256 hash <var>certSha256</var> in the context of an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object" id="ref-for-environment-settings-object②">environment settings object</a> <var>client</var>,
reporting to a <a data-link-type="dfn" href="#signed-exchange-report" id="ref-for-signed-exchange-report②">signed exchange report</a> <var>report</var>, returns a <a data-link-type="dfn" href="#certificate-chain" id="ref-for-certificate-chain②">certificate chain</a> or a string which indicates a <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result②">result</a>, as described by the following steps:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel⑧">in parallel</a>.</p>
    <li data-md>
     <p>Let <var>certRequest</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request②">request</a> with the following items:</p>
     <dl>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url②">url</a>
      <dd data-md>
       <p><var>certUrl</var></p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-header-list" id="ref-for-concept-request-header-list">header list</a>
      <dd data-md>
       <p>«<code>`Accept`</code>: <code>`application/cert-chain+cbor`</code>»</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-client" id="ref-for-concept-request-client②">client</a>
      <dd data-md>
       <p><var>client</var></p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#request-service-workers-mode" id="ref-for-request-service-workers-mode">service-workers mode</a>
      <dd data-md>
       <p>"<code>none</code>"</p>
      <dt data-md><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-mode" id="ref-for-concept-request-mode">mode</a>
      <dd data-md>
       <p>"<code>cors</code>"</p>
     </dl>
    <li data-md>
     <p>Let <var>certResponse</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-fetch" id="ref-for-concept-fetch②">fetching</a> <var>certRequest</var>.</p>
    <li data-md>
     <p>Append the IP address of the server from which the user agent received the <var>certResponse</var> to <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-cert-server-ip-list" id="ref-for-signed-exchange-report-cert-server-ip-list">cert server IP list</a>,
if available.</p>
    <li data-md>
     <p>If <var>certResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status②">status</a> is not <code>200</code>, return
"<a data-link-type="dfn" href="#signed-exchange-report-cert_fetch_error" id="ref-for-signed-exchange-report-cert_fetch_error">cert_fetch_error</a>".</p>
    <li data-md>
     <p>Let <var>certMimeType</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-extract-mime-type" id="ref-for-concept-header-extract-mime-type①">extracting a MIME type</a> from <var>certResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①①">header list</a>.</p>
    <li data-md>
     <p>If <var>certMimeType</var> is a failure or its <a data-link-type="dfn" href="https://mimesniff.spec.whatwg.org/#mime-type-essence" id="ref-for-mime-type-essence①">essence</a> is not <code>"application/cert-chain+cbor"</code>, return
"<a data-link-type="dfn" href="#signed-exchange-report-cert_fetch_error" id="ref-for-signed-exchange-report-cert_fetch_error①">cert_fetch_error</a>".</p>
    <li data-md>
     <p>If <var>certResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body②">body</a> is null or that body’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream②">stream</a> is null, return "<a data-link-type="dfn" href="#signed-exchange-report-cert_parse_error" id="ref-for-signed-exchange-report-cert_parse_error">cert_parse_error</a>".</p>
    <li data-md>
     <p>Let <var>reader</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-get-a-reader" id="ref-for-readablestream-get-a-reader">getting a reader</a> for <var>certResponse</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body③">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream③">stream</a>.</p>
    <li data-md>
     <p class="assertion">Assert: Getting a reader did not throw an exception, because the response was
created in this algorithm and not passed anywhere that could create a reader
for its body.</p>
    <li data-md>
     <p>Let <var>bytes</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-all-bytes" id="ref-for-readablestreamdefaultreader-read-all-bytes">reading all
bytes</a> from <var>reader</var>.</p>
    <li data-md>
     <p>Wait for <var>bytes</var> to settle.</p>
    <li data-md>
     <p>If <var>bytes</var> was rejected, return "<a data-link-type="dfn" href="#signed-exchange-report-cert_parse_error" id="ref-for-signed-exchange-report-cert_parse_error①">cert_parse_error</a>".</p>
    <li data-md>
     <p>Let <var>chain</var> be the <a data-link-type="dfn" href="#certificate-chain" id="ref-for-certificate-chain③">certificate chain</a> produced by parsing <var>bytes</var>’ value
using the <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-3.3" id="ref-for-section-3.3③">cert-chain CDDL</a>. If <var>bytes</var>’s value doesn’t match this CDDL or
isn’t <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-3.4" id="ref-for-section-3.4①">canonically-encoded CBOR</a>, return
 "<a data-link-type="dfn" href="#signed-exchange-report-cert_parse_error" id="ref-for-signed-exchange-report-cert_parse_error②">cert_parse_error</a>".</p>
    <li data-md>
     <p class="assertion">Assert: <var>chain</var> has at least one <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-item" id="ref-for-list-item①">item</a>.</p>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#" id="ref-for-something③">SHA-256</a> hash of <var>chain</var>’s <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf③">leaf</a>'s <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate④">certificate</a> is not equal to <var>certSha256</var>, return
 "<a data-link-type="dfn" href="#signed-exchange-report-signature_verification_error" id="ref-for-signed-exchange-report-signature_verification_error①">signature_verification_error</a>".</p>
    <li data-md>
     <p>Return <var>chain</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="The signed message" data-level="5.6" id="the-signed-message"><span class="secno">5.6. </span><span class="content">The signed message</span><a class="self-link" href="#the-signed-message"></a></h3>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="signed-message">signed message</dfn> for a version <var>version</var>, an <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature③">exchange signature</a> <var>signature</var> and <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①①">byte sequences</a> <var>requestUrlBytes</var> and <var>headerBytes</var> is the
concatenation of the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①②">byte sequences</a>:</p>
   <ol>
    <li data-md>
     <p>The byte 0x20 (SP) repeated 64 times. This matches the TLS 1.3 (<a data-link-type="biblio" href="#biblio-rfc8446" title="The Transport Layer Security (TLS) Protocol Version 1.3">[RFC8446]</a>)
format to avoid cross- protocol attacks if anyone uses the same key in a TLS
certificate and an exchange-signing certificate.</p>
    <li data-md>
     <p>A context string consisting of, if <var>version</var> is:</p>
     <dl class="switch">
      <dt data-md><code>b2</code>
      <dd data-md>
       <p><code>`HTTP Exchange 1 b2`</code></p>
      <dt data-md><code>b3</code>
      <dd data-md>
       <p><code>`HTTP Exchange 1 b3`</code></p>
     </dl>
     <p class="note" role="note"><span class="marker">Note:</span> Each draft of <a data-link-type="biblio" href="#biblio-draft-yasskin-httpbis-origin-signed-exchanges-impl-02" title="Signed HTTP Exchanges Implementation Checkpoints">[draft-yasskin-httpbis-origin-signed-exchanges-impl-02]</a> and the final RFC
for <a data-link-type="biblio" href="#biblio-draft-yasskin-http-origin-signed-responses" title="Signed HTTP Exchanges">[draft-yasskin-http-origin-signed-responses]</a> will use distinct context
strings.</p>
    <li data-md>
     <p>A single 0x00 byte which serves as a separator.</p>
    <li data-md>
     <p>A single 0x20 (SP) byte, representing the length of the next field.</p>
    <li data-md>
     <p><var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-certsha256" id="ref-for-exchange-signature-certsha256②">certSha256</a>.</p>
    <li data-md>
     <p>The 8-byte big-endian encoding of the length in bytes of <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-validityurlbytes" id="ref-for-exchange-signature-validityurlbytes①">validityUrlBytes</a>.</p>
    <li data-md>
     <p><var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-validityurlbytes" id="ref-for-exchange-signature-validityurlbytes②">validityUrlBytes</a>.</p>
    <li data-md>
     <p>The 8-byte big-endian encoding of <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date③">date</a>.</p>
    <li data-md>
     <p>The 8-byte big-endian encoding of <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time④">expiration time</a>.</p>
    <li data-md>
     <p>The 8-byte big-endian encoding of the length in bytes of <var>requestUrlBytes</var>.</p>
    <li data-md>
     <p><var>requestUrlBytes</var>.</p>
    <li data-md>
     <p>The 8-byte big-endian encoding of the length in bytes of <var>headerBytes</var>.</p>
    <li data-md>
     <p><var>headerBytes</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Validating a signature" data-level="5.7" id="validating-signature"><span class="secno">5.7. </span><span class="content">Validating a signature</span><a class="self-link" href="#validating-signature"></a></h3>
   <p>An <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature④">exchange signature</a> <var>signature</var> <dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-lt="is
valid|is not valid" data-noexport id="exchange-signature-is-valid">is valid</dfn> for <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①③">byte sequences</a> <var>requestUrlBytes</var> and <var>headerBytes</var>, and signed exchange version <var>version</var>, if the following steps
return <code>valid</code>:</p>
   <ol>
    <li data-md>
     <p>Let <var>clockSkew</var> be the uncertainty in the UA’s estimate of the current time
caused by clock skew on the client. The UA MAY set this to 0 or use a more
sophisticated estimate.</p>
    <li data-md>
     <p>If the UA’s estimate of the current time is more than <var>clockSkew</var> before <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date④">date</a>, return "untrusted".</p>
     <p class="note" role="note"><span class="marker">Note:</span> We take estimated clock skew into account when checking the
signature’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date⑤">date</a> because we want well-behaved servers
to use the time they created the signature, but if they immediately start
serving that signature, and skewed clients don’t try to correct for their
skew, those clients will reject the signature.</p>
     <p class="issue" id="issue-a7ea6416"><a class="self-link" href="#issue-a7ea6416"></a> Our security reviewers aren’t sure we should
allow UAs to take clock skew into account. <a href="https://github.com/WICG/webpackage/issues/141">[Issue #WICG/webpackage#141]</a></p>
    <li data-md>
     <p>If the UA’s estimate of the current time is after <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time⑤">expiration time</a>, return "untrusted".</p>
     <p class="note" role="note"><span class="marker">Note:</span> We use the client’s best guess of the current time to check the <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time⑥">expiration time</a> so that attackers trying to get an
exchange trusted for longer, are constrained to modify the client’s clock
and can’t also attack its estimate of its skew.</p>
    <li data-md>
     <p>Let <var>message</var> be the <a data-link-type="dfn" href="#signed-message" id="ref-for-signed-message">signed message</a> for <var>version</var>, <var>signature</var>, <var>requestUrlBytes</var>, and <var>headerBytes</var>.</p>
    <li data-md>
     <p>Let <var>publicKey</var> be the <a data-link-type="dfn" href="#certificate-public-key" id="ref-for-certificate-public-key①">public key</a> of <var>parsedSignature</var>’s <a data-link-type="dfn" href="#exchange-signature-certificate-chain" id="ref-for-exchange-signature-certificate-chain②">certificate chain</a>'s <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf④">leaf</a>. If
the certificate can’t be parsed enough to find this public key, return <code>invalid</code>.</p>
    <li data-md>
     <p>If <var>publicKey</var>’s <a data-link-type="dfn" href="#public-key-algorithm" id="ref-for-public-key-algorithm">algorithm</a> is not <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5480#section-2.1.1" id="ref-for-section-2.1.1">id-ecPublicKey</a> on the <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc5480#section-2.1.1.1" id="ref-for-section-2.1.1.1">secp256r1</a> named curve, return <code>invalid</code>.</p>
    <li data-md>
     <p>If <var>parsedSignature</var>’s <a data-link-type="dfn" href="#exchange-signature-signature" id="ref-for-exchange-signature-signature②">signature</a> is not a valid
signature of <var>message</var> by <var>publicKey</var> using the <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-ietf-tls-tls13-28#section-4.2.3" id="ref-for-section-4.2.3">ecdsa_secp256r1_sha256</a> algorithm, return <code>invalid</code>.</p>
    <li data-md>
     <p>Return <code>valid</code>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Cross-origin trust" data-level="5.8" id="cross-origin-trust"><span class="secno">5.8. </span><span class="content">Cross-origin trust</span><a class="self-link" href="#cross-origin-trust"></a></h3>
   <p>A <a data-link-type="dfn" href="#exchange-signature-is-valid" id="ref-for-exchange-signature-is-valid①">valid</a> <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature⑤">exchange signature</a> <var>signature</var> <dfn class="dfn-paneled" data-dfn-for="exchange signature" data-dfn-type="dfn" data-lt="establishes cross-origin trust|does not establish
cross-origin trust" data-noexport id="exchange-signature-establishes-cross-origin-trust">establishes cross-origin trust</dfn> in an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①②">exchange</a> <var>exchange</var> if the following steps return "trusted":</p>
   <ol>
    <li data-md>
     <p>Let <var>requestUrl</var> be <var>exchange</var>’s <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url⑤">request URL</a>.</p>
    <li data-md>
     <p>If <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-validityurl" id="ref-for-exchange-signature-validityurl②">validityUrl</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin①">origin</a> is not <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#same-origin" id="ref-for-same-origin">same origin</a> with <var>requestUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin②">origin</a>, return "untrusted".</p>
    <li data-md>
     <p>If <var>exchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⑧">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①②">header list</a> includes an <a data-link-type="dfn" href="https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html#uncached-headers" id="ref-for-uncached-headers">uncached response header</a>, return "untrusted".</p>
    <li data-md>
     <p>If <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-expiration-time" id="ref-for-exchange-signature-expiration-time⑦">expiration time</a> is more than 604800
seconds (7 days) after <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-date" id="ref-for-exchange-signature-date⑥">date</a>, return
"untrusted".</p>
    <li data-md>
     <p>If <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-certificate-chain" id="ref-for-exchange-signature-certificate-chain③">certificate chain</a> <a data-link-type="dfn" href="#certificate-chain-has-a-trusted-leaf" id="ref-for-certificate-chain-has-a-trusted-leaf">does not have a trusted leaf</a> for <var>requestUrl</var>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin③">origin</a>,
return "untrusted".</p>
    <li data-md>
     <p>Return "trusted".</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Establishing trust in a certificate" data-level="5.9" id="trusting-certificate"><span class="secno">5.9. </span><span class="content">Establishing trust in a certificate</span><a class="self-link" href="#trusting-certificate"></a></h3>
   <p>The <a data-link-type="dfn" href="#certificate-chain" id="ref-for-certificate-chain④">certificate chain</a> <var>chain</var> <dfn class="dfn-paneled" data-dfn-for="certificate chain" data-dfn-type="dfn" data-lt="has a trusted
leaf|does not have a trusted leaf" data-noexport id="certificate-chain-has-a-trusted-leaf">has a trusted leaf</dfn> for an <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin" id="ref-for-concept-origin">origin</a> <var>origin</var> if the following steps return <code>trusted</code>:</p>
   <ol>
    <li data-md>
     <p>Let <var>leaf</var> be <var>chain</var>’s <a data-link-type="dfn" href="#certificate-chain-leaf" id="ref-for-certificate-chain-leaf⑤">leaf</a>.</p>
    <li data-md>
     <p>Attempt to build a trustworthy path from <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate⑤">certificate</a> to a trusted root with</p>
     <ul>
      <li data-md>
       <p><var>chain</var>,</p>
      <li data-md>
       <p><var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-ocsp-response" id="ref-for-augmented-certificate-ocsp-response">OCSP response</a>,</p>
      <li data-md>
       <p>any SCTs from</p>
       <ul>
        <li data-md>
         <p><var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-sct" id="ref-for-augmented-certificate-sct">SCT</a>.</p>
        <li data-md>
         <p>An OCSP extension in <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-ocsp-response" id="ref-for-augmented-certificate-ocsp-response①">OCSP response</a>.</p>
        <li data-md>
         <p>An X.509 extension in <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate⑥">certificate</a>.</p>
       </ul>
     </ul>
     <p>as input, using <a data-link-type="biblio" href="#biblio-rfc5280" title="Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile">[RFC5280]</a> and any other conventions used in making TLS
(<a data-link-type="biblio" href="#biblio-rfc8446" title="The Transport Layer Security (TLS) Protocol Version 1.3">[RFC8446]</a>) connections. The UA SHOULD support Certificate Transparency
(<a data-link-type="biblio" href="#biblio-rfc6962" title="Certificate Transparency Version 2.0">[RFC6962]</a>) for this check. (See <a href="#seccons-ct">§ 6.1 Certificate Transparency</a>.) The UA MUST check that
it has evidence the <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate⑦">certificate</a> was not
revoked 7 or more days ago (for example using the <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-ocsp-response" id="ref-for-augmented-certificate-ocsp-response②">OCSP response</a>). If no such path can be built, return <code>untrusted</code>.</p>
    <li data-md>
     <p>If <var>leaf</var>’s <a data-link-type="dfn" href="#augmented-certificate-certificate" id="ref-for-augmented-certificate-certificate⑧">certificate</a> is not trusted for <var>origin</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host" id="ref-for-concept-origin-host">host</a>, return <code>untrusted</code>.</p>
    <li data-md>
     <p>If <var>leaf</var>’s <a data-link-type="dfn" href="#certificate-extensions" id="ref-for-certificate-extensions">extensions</a> don’t map a <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-4.2" id="ref-for-section-4.2②">CanSignHttpExchanges</a> OID to the ASN.1/DER encoding of NULL (0x05 0x00), return <code>untrusted</code>.</p>
    <li data-md>
     <p>Return <code>trusted</code>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing b2 CBOR headers" data-level="5.10" id="parse-b2-cbor-headers"><span class="secno">5.10. </span><span class="content">Parsing b2 CBOR headers</span><a class="self-link" href="#parse-b2-cbor-headers"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing-b2-cbor-headers">Parsing b2 CBOR headers</dfn> from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①④">byte sequence</a> <var>headerBytes</var> and
a URL <var>requestUrl</var> returns a failure or an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①③">exchange</a> via the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>headers</var> be the result of <a data-link-type="dfn" href="https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html#parse-known-length" id="ref-for-parse-known-length">parsing a CBOR item</a> from <var>headerBytes</var>,
matching the following CDDL rule:</p>
<pre>headers = [
  {
    ':method': bstr,
    * bstr => bstr,
  },
  {
    ':status': bstr,
    * bstr => bstr,
  }
]
</pre>
    <li data-md>
     <p>If any of the following is true, return a failure:</p>
     <ul>
      <li data-md>
       <p><var>headers</var> is an error.</p>
      <li data-md>
       <p><var>headers</var>[0] contains any key starting with <code>`:`</code> that isn’t <code>`:method`</code>.</p>
      <li data-md>
       <p><var>headers</var>[0] contains a <code>`host`</code> key.</p>
      <li data-md>
       <p><var>headers</var>[0][<code>`:method`</code>] is not <code>`GET`</code>.</p>
      <li data-md>
       <p><var>headers</var>[1] contains any key starting with <code>`:`</code> that isn’t <code>`:status`</code>.</p>
      <li data-md>
       <p><var>headers</var>[1][<code>`:status`</code>] is not <code>200</code>.</p>
     </ul>
    <li data-md>
     <p>Let <var>requestHeaders</var> be the result of <a data-link-type="dfn" href="#creating-a-header-list-from-the-cbor-map" id="ref-for-creating-a-header-list-from-the-cbor-map">creating a header list from the CBOR
map</a> <var>headers</var>[0].</p>
    <li data-md>
     <p>If <var>requestHeaders</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>responseHeaders</var> be the result of <a data-link-type="dfn" href="#creating-a-header-list-from-the-cbor-map" id="ref-for-creating-a-header-list-from-the-cbor-map①">creating a header list from the CBOR
map</a> <var>headers</var>[1].</p>
    <li data-md>
     <p>If <var>responseHeaders</var> is a failure, return it.</p>
    <li data-md>
     <p>If <var>responseHeaders</var> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains">does not contain</a> <code>`Content-Type`</code>,
return a failure.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-set" id="ref-for-concept-header-list-set⑥">Set</a> <code>`X-Content-Type-Options`</code>/<code>`nosniff`</code> in <var>responseHeaders</var>.</p>
    <li data-md>
     <p>Let <var>response</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①②">response</a> with <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status③">status</a> <var>headers</var>[1][<code> `:status`</code>] and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①③">header list</a> <var>responseHeaders</var>.</p>
    <li data-md>
     <p>Return an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①④">exchange</a> of <var>requestUrl</var> and <var>response</var>.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This ignores <var>requestHeaders</var>, which can’t be encoded in b3 and later.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Parsing b3 CBOR headers" data-level="5.11" id="parse-cbor-headers"><span class="secno">5.11. </span><span class="content">Parsing b3 CBOR headers</span><a class="self-link" href="#parse-cbor-headers"></a></h3>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="parsing-b3-cbor-headers">Parsing b3 CBOR headers</dfn> from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑤">byte sequence</a> <var>headerBytes</var> and
a URL <var>requestUrl</var> returns a failure or an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①⑤">exchange</a> via the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>headers</var> be the result of <a data-link-type="dfn" href="https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html#parse-known-length" id="ref-for-parse-known-length①">parsing a CBOR item</a> from <var>headerBytes</var>,
matching the following CDDL rule:</p>
<pre>headers = {
  ':status': bstr,
  * bstr => bstr,
}
</pre>
    <li data-md>
     <p>If any of the following is true, return a failure:</p>
     <ul>
      <li data-md>
       <p><var>headers</var> is an error.</p>
      <li data-md>
       <p><var>headers</var> contains any key starting with <code>`:`</code> that isn’t <code>`:status`</code>.</p>
      <li data-md>
       <p><var>headers</var>[<code>`:status`</code>] is not <code>200</code>.</p>
     </ul>
    <li data-md>
     <p>Let <var>responseHeaders</var> be the result of <a data-link-type="dfn" href="#creating-a-header-list-from-the-cbor-map" id="ref-for-creating-a-header-list-from-the-cbor-map②">creating a header list from the CBOR
map</a> <var>headers</var>.</p>
    <li data-md>
     <p>If <var>responseHeaders</var> is a failure, return it.</p>
    <li data-md>
     <p>Let <var>response</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①③">response</a> with <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-status" id="ref-for-concept-response-status④">status</a> <var>headers</var>[<code> `:status`</code>] and <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①④">header list</a> <var>responseHeaders</var>.</p>
    <li data-md>
     <p>Return an <a data-link-type="dfn" href="#exchange" id="ref-for-exchange①⑥">exchange</a> of <var>requestUrl</var> and <var>response</var>.</p>
   </ol>
   <h4 class="heading settled algorithm" data-algorithm="Converting a map to a header list" data-level="5.11.1" id="headers-from-map"><span class="secno">5.11.1. </span><span class="content">Converting a map to a header list</span><a class="self-link" href="#headers-from-map"></a></h4>
   <p>The result of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="creating-a-header-list-from-the-cbor-map">creating a header list from the CBOR map</dfn> <var>map</var> is
returned by the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>headers</var> be a new empty <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list" id="ref-for-concept-header-list①">header list</a>.</p>
    <li data-md>
     <p>For each <var>key</var> → <var>value</var> of <var>map</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>key</var> starts with <code>`:`</code>, continue.</p>
      <li data-md>
       <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#isomorphic-decode" id="ref-for-isomorphic-decode">isomorphic decoding</a> of <var>key</var> contains any <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-upper-alpha" id="ref-for-ascii-upper-alpha">ASCII upper
alpha</a>, return a failure.</p>
      <li data-md>
       <p>If <var>key</var> doesn’t match the constraints on a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-name" id="ref-for-concept-header-name">name</a> or <var>value</var> doesn’t match the constraints on a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-value" id="ref-for-concept-header-value">value</a>, return a failure.</p>
      <li data-md>
       <p class="assertion">Assert: <var>headers</var> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains①">does not contain</a> <var>key</var>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-append" id="ref-for-concept-header-list-append">Append</a> <var>key</var>/<var>value</var> to <var>headers</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>headers</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Creating the response stream." data-level="5.12" id="read-a-body"><span class="secno">5.12. </span><span class="content">Creating the response stream.</span><a class="self-link" href="#read-a-body"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="reading a body|read a body" data-noexport id="reading-a-body">read a body</dfn> from a <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer①">read buffer</a> <var>stream</var> into a <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response" id="ref-for-concept-response①④">response</a> <var>response</var> using an <a data-link-type="dfn" href="#exchange-signature" id="ref-for-exchange-signature⑥">exchange signature</a> <var>signature</var> to check its integrity, the UA MUST:</p>
   <ol>
    <li data-md>
     <p>If <var>signature</var>’s <a data-link-type="dfn" href="#exchange-signature-integrity-header" id="ref-for-exchange-signature-integrity-header①">integrity header</a> is:</p>
     <dl class="switch">
      <dt data-md>«"<code>digest</code>", "<code>mi-sha256-03</code>"»
      <dd data-md>
       <ol>
        <li data-md>
         <p>Let <var>instance-digests</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-decode-split" id="ref-for-concept-header-list-get-decode-split">getting,
decoding, and splitting</a> <code>`digest`</code> from <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⑤">header list</a>.</p>
         <p class="note" role="note"><span class="marker">Note:</span> No <a data-link-type="dfn" href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml#http-dig-alg-1" id="ref-for-http-dig-alg-1">Digest algorithm</a> uses non-ASCII characters or 0x22
(<code>"</code>), so this is equivalent to parsing from the <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc3230#section-4.3.2" id="ref-for-section-4.3.2">Digest</a> ABNF <code>&lt;encoded digest output></code>.</p>
        <li data-md>
         <p>Let <var>mi</var> be the element of <var>instance-digests</var> that starts with <code>"mi-sha256-03="</code>. If there is no such element, return an error
string "<a data-link-type="dfn" href="#signed-exchange-report-invalid_integrity_header" id="ref-for-signed-exchange-report-invalid_integrity_header">invalid_integrity_header</a>".</p>
        <li data-md>
         <p>Let <var>codings</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get-decode-split" id="ref-for-concept-header-list-get-decode-split①">getting, decoding, and
splitting</a> <code>`content-encoding`</code> in <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⑥">header list</a>.</p>
        <li data-md>
         <p>If <var>codings</var> doesn’t include <code>"mi-sha256-03"</code>, return an error string
"<a data-link-type="dfn" href="#signed-exchange-report-invalid_integrity_header" id="ref-for-signed-exchange-report-invalid_integrity_header①">invalid_integrity_header</a>".</p>
        <li data-md>
         <p class="assertion">Assert: <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#handle-content-codings" id="ref-for-handle-content-codings">Handle content codings</a> used the value of <var>mi</var> as the <a data-link-type="dfn" href="https://tools.ietf.org/html/draft-thomson-http-mice-03#section-2.2" id="ref-for-section-2.2⑤">integrity proof for the first record</a> when decoding the <code>mi-sha256-03</code> content encoding to produce the bytes in <var>stream</var>.</p>
       </ol>
      <dt data-md>Anything else
      <dd data-md>
       <p>Return an error string
"<a data-link-type="dfn" href="#signed-exchange-report-invalid_integrity_header" id="ref-for-signed-exchange-report-invalid_integrity_header②">invalid_integrity_header</a>".</p>
     </dl>
    <li data-md>
     <p>Let <var>body</var> be a new <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body" id="ref-for-concept-body">body</a>.</p>
    <li data-md>
     <p>Let <var>cancel</var> be the following steps, taking <var>reason</var> as an argument:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-cancel" id="ref-for-readablestream-cancel">Cancel</a> <var>stream</var>’s <a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream②">stream</a> with <var>reason</var>.</p>
     </ol>
    <li data-md>
     <p>Let <var>outputStream</var> be the result of <a data-link-type="dfn">creating</a> a <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream①">ReadableStream</a></code> with a <a data-link-type="dfn">cancelAlgorithm</a> of <var>cancel</var>.</p>
    <li data-md>
     <p>Set <var>body</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream④">stream</a> to <var>outputStream</var>.</p>
    <li data-md>
     <p>Set <var>response</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body④">body</a> to <var>body</var>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel⑨">In parallel</a>:</p>
     <ol>
      <li data-md>
       <p><a data-link-type="dfn" href="#read-buffer-dump" id="ref-for-read-buffer-dump">Dump</a> <var>stream</var> to <var>outputStream</var>.</p>
     </ol>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Request matching" data-level="5.13" id="request-matching"><span class="secno">5.13. </span><span class="content">Request matching</span><a class="self-link" href="#request-matching"></a></h3>
   <p>A <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request" id="ref-for-concept-request③">request</a> <var>browserRequest</var> <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="matches the stored exchange|doesn’t match the stored exchange" data-noexport id="matches-the-stored-exchange">matches the stored exchange</dfn> <var>storedExchange</var> if the following steps return "match":</p>
   <ol>
    <li data-md>
     <p>If <var>browserRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-method" id="ref-for-concept-request-method">method</a> is not <code>`GET`</code> or <code>`HEAD`</code>,
return "mismatch".</p>
     <p class="note" role="note"><span class="marker">Note:</span> The <var>browserRequest</var>’s method can be something other than <code>`GET`</code> if a Service Worker intercepts the redirect and modifies the request before
re-fetching it.</p>
    <li data-md>
     <p>If <var>browserRequest</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url③">url</a> is not <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-equals" id="ref-for-concept-url-equals①">equal</a> to <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-request-url" id="ref-for-exchange-request-url⑥">request URL</a>, return "mismatch".</p>
    <li data-md>
     <p>If <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response①⑨">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⑦">header list</a> <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#header-list-contains" id="ref-for-header-list-contains②">contains</a>:</p>
     <dl class="switch">
      <dt data-md>Neither a <code>`Variants`</code> nor a <code>`Variant-Key`</code> header
      <dd data-md>
       <p>Return "match".</p>
       <p class="note" role="note"><span class="marker">Note:</span> This states that exactly one resource lives at the request URL, and
no content negotiation is intended.</p>
      <dt data-md>A <code>`Variant-Key`</code> header but no <code>`Variants`</code> header
      <dd data-md>
       <p>Return "mismatch".</p>
       <p class="note" role="note"><span class="marker">Note:</span> This indicates a likely misconfiguration, and returning "mismatch"
makes that fail fast.</p>
      <dt data-md>A <code>`Variants`</code> header but no <code>`Variant-Key`</code> header
      <dd data-md>
       <p>Return "mismatch".</p>
       <p class="note" role="note"><span class="marker">Note:</span> This behavior is implied by the below steps, but we make it
explicit here.</p>
      <dt data-md>Both a <code>`Variants`</code> and a <code>`Variant-Key`</code> header
      <dd data-md>
       <p>Proceed to the following steps.</p>
     </dl>
    <li data-md>
     <p>If <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get③">getting</a> <code>`Variants`</code> from <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response②⓪">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⑧">header list</a> returns a value that fails
to parse according to the instructions for the <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variants" id="ref-for-variants②">Variants</a> Header Field, return "mismatch".</p>
    <li data-md>
     <p>Let <var>acceptableVariantKeys</var> be the result of running the <a data-link-type="dfn" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#cache" id="ref-for-cache">Variants Cache
Behavior</a> on an incoming-request of <var>browserRequest</var> and stored-responses
of a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a> containing <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response②①">response</a>.</p>
    <li data-md>
     <p>Let <var>variantKeys</var> be the result of <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-header-list-get" id="ref-for-concept-header-list-get④">getting</a> <code>`Variant-Key` </code> from <var>storedExchange</var>’s <a data-link-type="dfn" href="#exchange-response" id="ref-for-exchange-response②②">response</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-header-list" id="ref-for-concept-response-header-list①⑨">header list</a>,
and parsing it into a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a> of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">lists</a> as described in the <a data-link-type="http-header" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variant-key" id="ref-for-variant-key②">Variant-Key</a> Header Field.</p>
    <li data-md>
     <p>If parsing <var>variantKeys</var> failed, return "mismatch".</p>
    <li data-md>
     <p>If the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-intersection" id="ref-for-set-intersection">intersection</a> of <var>acceptableVariantKeys</var> and <var>variantKeys</var> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-empty" id="ref-for-list-empty">empty</a>, return "mismatch".</p>
     <p class="issue" id="issue-e1733bef"><a class="self-link" href="#issue-e1733bef"></a> This depends on the <a data-link-type="dfn" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#cache" id="ref-for-cache①">Variants Cache
Behavior</a> returning a list of lists. <a href="https://github.com/httpwg/http-extensions/issues/744">[Issue #httpwg/http-extensions#744]</a></p>
    <li data-md>
     <p>Return "match".</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Create a new signed exchange report" data-level="5.14" id="create-a-new-report"><span class="secno">5.14. </span><span class="content">Create a new signed exchange report</span><a class="self-link" href="#create-a-new-report"></a></h3>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="create-a-new-signed-exchange-report">create a new signed exchange report</dfn> with <var>request</var> and <var>actualResponse</var>, the UA MUST: 
   <ol>
    <li data-md>
     <p>Let <var>report</var> be a new <a data-link-type="dfn" href="#signed-exchange-report" id="ref-for-signed-exchange-report③">signed exchange report</a> struct.</p>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-request" id="ref-for-signed-exchange-report-outer-request">outer request</a> to <var>request</var>.</p>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-response" id="ref-for-signed-exchange-report-outer-response">outer response</a> to <var>actualResponse</var>.</p>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-server-ip" id="ref-for-signed-exchange-report-server-ip">server IP</a> to the IP address of the
server from which the user agent received the <var>actualResponse</var>, if
available.</p>
    <li data-md>
     <p>Return <var>report</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Wait and queue a report" data-level="5.15" id="wait-and-queue-a-report"><span class="secno">5.15. </span><span class="content">Wait and queue a report</span><a class="self-link" href="#wait-and-queue-a-report"></a></h3>
    To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="wait-and-queue-a-report-for">wait and queue a report for</dfn> <var>parsedExchange</var> and <var>report</var>, the UA
MUST: 
   <ol>
    <li data-md>
     <p>Wait until <var>parsedExchange</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body⑤">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream⑤">stream</a> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-closed" id="ref-for-readablestream-closed">closed</a> or <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-errored" id="ref-for-readablestream-errored">errored</a>.</p>
    <li data-md>
     <p>If <var>parsedExchange</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body⑥">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream⑥">stream</a> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-closed" id="ref-for-readablestream-closed①">closed</a>, run <a data-link-type="dfn" href="#queue-a-signed-exchange-report" id="ref-for-queue-a-signed-exchange-report①">queue a signed exchange report</a> <var>report</var> with "<a data-link-type="dfn" href="#signed-exchange-report-ok" id="ref-for-signed-exchange-report-ok">ok</a>" as the result and abort these steps.</p>
    <li data-md>
     <p>If <var>parsedExchange</var>’s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-response-body" id="ref-for-concept-response-body⑦">body</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-body-stream" id="ref-for-concept-body-stream⑦">stream</a> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-errored" id="ref-for-readablestream-errored①">errored</a>, run <a data-link-type="dfn" href="#queue-a-signed-exchange-report" id="ref-for-queue-a-signed-exchange-report②">queue a signed exchange report</a> <var>report</var> with "<a data-link-type="dfn" href="#signed-exchange-report-mi_error" id="ref-for-signed-exchange-report-mi_error">mi_error</a>" as the result.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Queuing signed exchange report" data-level="5.16" id="queue-report"><span class="secno">5.16. </span><span class="content">Queuing signed exchange report</span><a class="self-link" href="#queue-report"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="queue-a-signed-exchange-report">queue a signed exchange report</dfn> <var>report</var> with <var>result</var> as the
result, the UA MUST:</p>
   <ol>
    <li data-md>
     <p>Set <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result③">result</a> to <var>result</var>.</p>
    <li data-md>
     <p>Let <var>report body</var> and <var>policy</var> be the result of <a data-link-type="dfn">generate a network error report</a> with <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-request" id="ref-for-signed-exchange-report-outer-request①">outer request</a>. If the result is null, abort
these steps.</p>
    <li data-md>
     <p>If <var>report body</var>’s <code>"type"</code> is <code>"dns.address_changed"</code>, abort these steps.</p>
     <p class="note" role="note"><span class="marker">Note:</span> This means that the NEL report was downgraded because the IP addresses
of the server and the <var>policy</var> don’t match. In this case, the UA has called <a data-link-type="dfn">deliver a network report</a> algorithm with the error report while handling
the response. So we don’t need to send the same error report while
processing the response as a signed exchange.</p>
    <li data-md>
     <p>Add a new property <code>"sxg"</code> to <var>report body</var> with a new ECMAScript object with
 the following properties:</p>
     <ul>
      <li data-md>
       <p><code>outer_url</code>: The <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer①">serialization</a> of <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-request" id="ref-for-signed-exchange-report-outer-request②">outer request</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url④">url</a>.</p>
      <li data-md>
       <p><code>inner_url</code>: The <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer②">serialization</a> of <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-inner-url" id="ref-for-signed-exchange-report-inner-url①">inner URL</a>.</p>
      <li data-md>
       <p><code>cert_url</code>: The <a data-link-type="dfn" href="https://webidl.spec.whatwg.org/#sequence-type" id="ref-for-sequence-type">sequence type</a> of the result of <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-serializer" id="ref-for-concept-url-serializer③">serialization</a> of each element of <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-cert-url-list" id="ref-for-signed-exchange-report-cert-url-list②">cert URL list</a>.</p>
     </ul>
    <li data-md>
     <p>Set <var>report body</var>’s <code>"phase"</code> to <code>"sxg"</code>.</p>
    <li data-md>
     <p>If the <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result④">result</a> is
"<a data-link-type="dfn" href="#signed-exchange-report-ok" id="ref-for-signed-exchange-report-ok①">ok</a>", set <var>report body</var>’s <code>"type"</code> to <code>"ok"</code>.
Otherwise, set <var>report body</var>’s <code>"type"</code> to the result of concatenating a
string <code>"sxg."</code> and the <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result⑤">result</a>.</p>
    <li data-md>
     <p>If <var>report body</var>’s <code>"sxg"</code>’s <code>"cert_url"</code>’s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-scheme" id="ref-for-concept-url-scheme③">scheme</a> is not <code>"data"</code> and <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-result" id="ref-for-signed-exchange-report-result⑥">result</a> is
"<a data-link-type="dfn" href="#signed-exchange-report-signature_verification_error" id="ref-for-signed-exchange-report-signature_verification_error②">signature_verification_error</a>" or
"<a data-link-type="dfn" href="#signed-exchange-report-cert_verification_error" id="ref-for-signed-exchange-report-cert_verification_error①">cert_verification_error</a>" or
"<a data-link-type="dfn" href="#signed-exchange-report-cert_fetch_error" id="ref-for-signed-exchange-report-cert_fetch_error②">cert_fetch_error</a>" or
"<a data-link-type="dfn" href="#signed-exchange-report-cert_parse_error" id="ref-for-signed-exchange-report-cert_parse_error③">cert_parse_error</a>":</p>
     <ol>
      <li data-md>
       <p>If <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-request" id="ref-for-signed-exchange-report-outer-request③">outer request</a>'s <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-url" id="ref-for-concept-request-url⑤">url</a>'s <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin④">origin</a> is different from any <a data-link-type="dfn" href="https://url.spec.whatwg.org/#concept-url-origin" id="ref-for-concept-url-origin⑤">origin</a> of
the URLs in <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-cert-url-list" id="ref-for-signed-exchange-report-cert-url-list③">cert URL list</a>, or <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-server-ip" id="ref-for-signed-exchange-report-server-ip①">server IP</a> is different from
any of the IP address in <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-cert-server-ip-list" id="ref-for-signed-exchange-report-cert-server-ip-list①">cert server IP list</a>:</p>
       <ol>
        <li data-md>
         <p>Set <var>report body</var>’s <code>"type"</code> to <code>"sxg.failed"</code>.</p>
        <li data-md>
         <p>Set <var>report body</var>’s <code>"elapsed_time"</code> to 0.</p>
       </ol>
     </ol>
     <p class="note" role="note"><span class="marker">Note:</span> This step "downgrades" a Signed Exchange report if the certificate
was served from the different server from the server of <code>"outer_url"</code>. This
is intended to avoid leaking the information about the certificate server.</p>
    <li data-md>
     <p><a data-link-type="dfn">Deliver a network report</a> with <var>report body</var> and <var>policy</var> and <var>report</var>’s <a data-link-type="dfn" href="#signed-exchange-report-outer-request" id="ref-for-signed-exchange-report-outer-request④">outer request</a>.</p>
     <div class="example" id="example-network-error-log">
      <a class="self-link" href="#example-network-error-log"></a> If a <a data-link-type="dfn" href="https://w3c.github.io/network-error-logging/#dfn-nel-policies" id="ref-for-dfn-nel-policies">NEL policy</a> was received from the distributor’s origin, <code>distributor.example</code>, this step  will send the following JSON data to
describe an invalid signature: 
<pre class="highlight"><c- p>{</c->
  <c- f>"type"</c-><c- p>:</c-> <c- u>"network-error"</c-><c- p>,</c->
  <c- f>"url"</c-><c- p>:</c-> <c- u>"https://publisher.example/article.html"</c-><c- p>,</c->
  <c- f>"age"</c-><c- p>:</c-> <c- mi>234</c-><c- p>,</c->
  <c- f>"user_agent"</c-><c- p>:</c-> <c- u>"Mozilla/5.0 (X11; Linux x86_64; rv:60.0) ..."</c-><c- p>,</c->
  <c- f>"body"</c-><c- p>:</c-> <c- p>{</c->
    <c- f>"referrer"</c-><c- p>:</c-> <c- u>"https://aggregator.example/article.html"</c-><c- p>,</c->
    <c- f>"sampling_fraction"</c-><c- p>:</c-> <c- mi>1</c-><c- p>,</c->
    <c- f>"server_ip"</c-><c- p>:</c-> <c- u>"192.0.2.42"</c-><c- p>,</c->  <c- c1>// The IP address of distributor.example.</c->
    <c- f>"protocol"</c-><c- p>:</c-> <c- u>"http/1.1"</c-><c- p>,</c->
    <c- f>"method"</c-><c- p>:</c-> <c- u>"GET"</c-><c- p>,</c->
    <c- f>"status_code"</c-><c- p>:</c-> <c- mi>200</c-><c- p>,</c->
    <c- f>"elapsed_time"</c-><c- p>:</c-> <c- mi>1234</c-><c- p>,</c->
    <c- f>"phase"</c-><c- p>:</c-> <c- u>"sxg"</c-><c- p>,</c->
    <c- f>"type"</c-><c- p>:</c-> <c- u>"sxg.signature_verification_error"</c-><c- p>,</c->
    <c- f>"sxg"</c-><c- p>:</c-> <c- p>{</c->
      <c- f>"outer_url"</c-><c- p>:</c-> <c- u>"https://distributor.example/publisher.example/article.html.sxg"</c-><c- p>,</c->
      <c- f>"inner_url"</c-><c- p>:</c-> <c- u>"https://publisher.example/article.html"</c-><c- p>,</c->
      <c- f>"cert_url"</c-><c- p>:</c-> <c- p>[</c-><c- u>"https://distributor.example/publisher.example/cert"</c-><c- p>]</c->
    <c- p>},</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     </div>
   </ol>
   <h3 class="heading settled" data-level="5.17" id="stream-algs"><span class="secno">5.17. </span><span class="content">Stream algorithms</span><a class="self-link" href="#stream-algs"></a></h3>
   <p class="issue" id="issue-3ffca592"><a class="self-link" href="#issue-3ffca592"></a> The algorithms in this section create and operate over
ECMAScript objects like <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream②">ReadableStream</a></code> despite not having a Realm to attach
them to. <a href="https://github.com/whatwg/fetch/issues/730">[Issue #whatwg/fetch#730]</a></p>
   <h4 class="heading settled algorithm" data-algorithm="Create a read buffer" data-level="5.17.1" id="create-read-buffer"><span class="secno">5.17.1. </span><span class="content">Create a read buffer</span><a class="self-link" href="#create-read-buffer"></a></h4>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="new-read-buffer">new read buffer</dfn> for a <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream③">ReadableStream</a></code> <var>stream</var> is a new <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer②">read
buffer</a> struct whose items are:</p>
   <dl>
    <dt data-md><a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream③">stream</a>
    <dd data-md>
     <p><var>stream</var></p>
    <dt data-md><a data-link-type="dfn" href="#read-buffer-reader" id="ref-for-read-buffer-reader">reader</a>
    <dd data-md>
     <p>The result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-get-a-reader" id="ref-for-readablestream-get-a-reader①">getting a reader</a> from <var>stream</var>.</p>
    <dt data-md><a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes">bytes</a>
    <dd data-md>
     <p>An empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑥">byte sequence</a>.</p>
   </dl>
   <h4 class="heading settled algorithm" data-algorithm="Read up to bytes" data-level="5.17.2" id="read-up-to-bytes"><span class="secno">5.17.2. </span><span class="content">Read up to bytes</span><a class="self-link" href="#read-up-to-bytes"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-lt="reading up to" data-noexport id="read-buffer-reading-up-to">read up to</dfn> <var>N</var> bytes from a <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer③">read buffer</a> <var>buffer</var>, the UA MUST:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①⓪">in parallel</a>.</p>
    <li data-md>
     <p>Let <var>done</var> be <code>false</code>.</p>
    <li data-md>
     <p>While <var>done</var> is <code>false</code> and the length of <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes①">bytes</a> item is less than <var>N</var> bytes:</p>
     <ol>
      <li data-md>
       <p>Let <var>chunk</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk" id="ref-for-readablestreamdefaultreader-read-a-chunk">reading a chunk</a> from <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-reader" id="ref-for-read-buffer-reader①">reader</a>.</p>
      <li data-md>
       <p>Wait for <var>chunk</var> to settle.</p>
      <li data-md>
       <p>If <var>chunk</var> is :</p>
       <dl class="switch">
        <dt data-md>Fulfilled with an object whose <code>done</code> property is <code>false</code> and whose <code>value</code> property is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array">Uint8Array</a></code> object:
        <dd data-md>
         <ol>
          <li data-md>
           <p>Let <var>bs</var> be the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑦">byte sequence</a> represented by the <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array①">Uint8Array</a></code> object.</p>
          <li data-md>
           <p>Set <var>buffer</var> to the concatenation of <var>buffer</var> and <var>bs</var>.</p>
         </ol>
        <dt data-md>Fulfilled with an object whose <code>done</code> property is <code>true</code>:
        <dd data-md>
         <p>Set <var>done</var> to <code>true</code>.</p>
        <dt data-md>Rejected with <var>e</var>:
        <dd data-md>
         <p>Return a failure with reason <var>e</var>.</p>
       </dl>
     </ol>
    <li data-md>
     <p>If <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes②">bytes</a> item is at least <var>N</var> bytes long:</p>
     <ol>
      <li data-md>
       <p>Let <var>result</var> be a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑧">byte sequence</a> consisting of the first N bytes of <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes③">bytes</a> item.</p>
      <li data-md>
       <p>Set <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes④">bytes</a> item to a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①⑨">byte sequence</a> consisting of the bytes after the <var>N</var>th from its old value.</p>
     </ol>
    <li data-md>
     <p>Otherwise:</p>
     <ol>
      <li data-md>
       <p>Let <var>result</var> be <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes⑤">bytes</a> item.</p>
      <li data-md>
       <p>Set <var>buffer</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes⑥">bytes</a> item to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence②⓪">byte sequence</a>.</p>
     </ol>
    <li data-md>
     <p>Return <var>result</var>.</p>
   </ol>
   <h4 class="heading settled algorithm" data-algorithm="Read bytes" data-level="5.17.3" id="read-bytes"><span class="secno">5.17.3. </span><span class="content">Read bytes</span><a class="self-link" href="#read-bytes"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-noexport id="read-buffer-read">read</dfn> <var>N</var> bytes from a <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer④">read buffer</a> <var>buffer</var>,
the UA MUST:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①①">in parallel</a>.</p>
    <li data-md>
     <p>Let <var>bytes</var> be the result of <a data-link-type="dfn" href="#read-buffer-reading-up-to" id="ref-for-read-buffer-reading-up-to">reading up to</a> <var>N</var> bytes from <var>buffer</var>.</p>
    <li data-md>
     <p>If <var>bytes</var> is a failure, return it.</p>
    <li data-md>
     <p>If <var>bytes</var> is exactly <var>N</var> bytes long, return it.</p>
    <li data-md>
     <p>Otherwise, return a failure.</p>
   </ol>
   <h4 class="heading settled algorithm" data-algorithm="Dump to another stream" data-level="5.17.4" id="dump-stream"><span class="secno">5.17.4. </span><span class="content">Dump to another stream</span><a class="self-link" href="#dump-stream"></a></h4>
   <p>To <dfn class="dfn-paneled" data-dfn-for="read buffer" data-dfn-type="dfn" data-noexport id="read-buffer-dump">Dump</dfn> a <a data-link-type="dfn" href="#read-buffer" id="ref-for-read-buffer⑤">read buffer</a> <var>input</var> to a <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream" id="ref-for-readablestream④">ReadableStream</a></code> <var>output</var>, the UA MUST:</p>
   <ol>
    <li data-md>
     <p class="assertion">Assert: This algorithm is running <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel①②">in parallel</a>.</p>
    <li data-md>
     <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-enqueue" id="ref-for-readablestream-enqueue">Enqueue</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array②">Uint8Array</a></code> wrapping an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer">ArrayBuffer</a></code> containing <var>input</var>’s <a data-link-type="dfn" href="#read-buffer-bytes" id="ref-for-read-buffer-bytes⑦">bytes</a> into <var>output</var>.</p>
    <li data-md>
     <p>While <var>input</var>’s <a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream④">stream</a> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-readable" id="ref-for-readablestream-readable">readable</a>:</p>
     <ol>
      <li data-md>
       <p>Wait until <var>output</var> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-closed" id="ref-for-readablestream-closed②">closed</a>, <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-errored" id="ref-for-readablestream-errored②">errored</a>, or <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-need-more-data" id="ref-for-readablestream-need-more-data">needs
more data</a>.</p>
      <li data-md>
       <p>If <var>output</var> is <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-closed" id="ref-for-readablestream-closed③">closed</a> or <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-errored" id="ref-for-readablestream-errored③">errored</a>, <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-cancel" id="ref-for-readablestream-cancel①">cancel</a> <var>input</var>’s <a data-link-type="dfn" href="#read-buffer-stream" id="ref-for-read-buffer-stream⑤">stream</a> and abort
these steps.</p>
      <li data-md>
       <p>Let <var>chunk</var> be the result of <a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk" id="ref-for-readablestreamdefaultreader-read-a-chunk①">reading a chunk</a> with <var>input</var>’s <a data-link-type="dfn" href="#read-buffer-reader" id="ref-for-read-buffer-reader②">reader</a>.</p>
      <li data-md>
       <p>Wait for <var>chunk</var> to settle.</p>
      <li data-md>
       <p>If <var>chunk</var> is:</p>
       <dl class="switch">
        <dt data-md>Fulfilled with an object whose <code>done</code> property is <code>false</code> and whose <code>value</code> property is a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array③">Uint8Array</a></code> object <var>bytes</var>:
        <dd data-md>
         <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-enqueue" id="ref-for-readablestream-enqueue①">Enqueue</a> a <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-Uint8Array" id="ref-for-idl-Uint8Array④">Uint8Array</a></code> wrapping an <code class="idl"><a data-link-type="idl" href="https://webidl.spec.whatwg.org/#idl-ArrayBuffer" id="ref-for-idl-ArrayBuffer①">ArrayBuffer</a></code> containing <var>bytes</var> into <var>output</var>.</p>
        <dt data-md>Fulfilled with an object whose <code>done</code> property is <code>true</code>:
        <dd data-md>
         <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-close" id="ref-for-readablestream-close">Close</a> <var>output</var>.</p>
        <dt data-md>Rejected with <var>e</var>:
        <dd data-md>
         <p><a data-link-type="dfn" href="https://streams.spec.whatwg.org/#readablestream-error" id="ref-for-readablestream-error">Error</a> <var>output</var> with reason <var>e</var>.</p>
       </dl>
     </ol>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Get value of Target Attributes" data-level="5.18" id="dump-value-of-target-attributes"><span class="secno">5.18. </span><span class="content">Get value of <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2⑥">Target Attributes</a></span><a class="self-link" href="#dump-value-of-target-attributes"></a></h3>
   <p>A link header value <var>link</var>’s <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="target-attribute-named">Target Attribute named</dfn> <var>name</var> is the second item of the first tuple of <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2⑦">Target Attributes</a> whose
first item matches the string <var>name</var>, or null if no such tuple is present.</p>
   <h3 class="heading settled algorithm" data-algorithm="Get allowed signed exchange link info" data-level="5.19" id="get-allowed-signed-exchange-links"><span class="secno">5.19. </span><span class="content">Get allowed signed exchange link info</span><a class="self-link" href="#get-allowed-signed-exchange-links"></a></h3>
   <p>The result of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="getting-allowed-signed-exchange-link-info">getting allowed signed exchange link info</dfn> from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a> <var>links</var> is returned by the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>allowedSxgLinks</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑦">list</a>.</p>
    <li data-md>
     <p>For each <var>link</var> of <var>links</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.3" id="ref-for-section-3.3④">Relation Type</a> is not 'allowed-alt-sxg', then continue.</p>
      <li data-md>
       <p>Let <var>linkTarget</var> be <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1⑧">Link Target</a>.</p>
      <li data-md>
       <p>Let <var>headerIntegrity</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①①">Target Attribute named</a> <code>"header-integrity"</code>.</p>
      <li data-md>
       <p>If <var>headerIntegrity</var> is null, then continue.</p>
      <li data-md>
       <p>Let <var>linkVariants</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①②">Target Attribute named</a> <code>"variants"</code>.</p>
      <li data-md>
       <p>Let <var>linkVariantKey</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①③">Target Attribute named</a> <code>"variant-key"</code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> the <a data-link-type="dfn" href="#allowed-signed-exchange-link-info" id="ref-for-allowed-signed-exchange-link-info①">allowed signed exchange link info</a> (<var>linkTarget</var>, <var>headerIntegrity</var>, <var>linkVariants</var>, <var>linkVariantKey</var>) to <var>allowedSxgLinks</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>allowedSxgLinks</var>.</p>
   </ol>
   <h3 class="heading settled algorithm" data-algorithm="Get alternate signed
exchange link info" data-level="5.20" id="get-alternate-signed-exchange-links"><span class="secno">5.20. </span><span class="content">Get alternate signed
exchange link info</span><a class="self-link" href="#get-alternate-signed-exchange-links"></a></h3>
   <p>The result of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="getting-alternate-signed-exchange-link-info">getting alternate signed exchange link info</dfn> from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑧">list</a> <var>links</var> is returned by the following steps:</p>
   <ol>
    <li data-md>
     <p>Let <var>alternateSxgLinks</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑨">list</a>.</p>
    <li data-md>
     <p>For each <var>link</var> of <var>links</var>:</p>
     <ol>
      <li data-md>
       <p>If <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.3" id="ref-for-section-3.3⑤">Relation Type</a> is not 'alternate', then continue.</p>
      <li data-md>
       <p>If <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-2.2" id="ref-for-section-2.2⑧">Target Attributes</a> doesn’t <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-contain" id="ref-for-list-contain">contain</a> (<code>"type"</code>,<code>"application/signed-exchange"</code>), then continue.</p>
      <li data-md>
       <p>Let <var>linkTarget</var> be <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.1" id="ref-for-section-3.1⑨">Link Target</a>.</p>
      <li data-md>
       <p>Let <var>linkContext</var> be <var>link</var>’s <a data-link-type="dfn" href="https://tools.ietf.org/html/rfc8288#section-3.2" id="ref-for-section-3.2③">Link Context</a>.</p>
      <li data-md>
       <p>Let <var>linkVariants</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①④">Target Attribute named</a> <code>"variants"</code>.</p>
      <li data-md>
       <p>Let <var>linkVariantKey</var> be <var>link</var>’s <a data-link-type="dfn" href="#target-attribute-named" id="ref-for-target-attribute-named①⑤">Target Attribute named</a> <code>"variant-key"</code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">Append</a> the <a data-link-type="dfn" href="#alternate-signed-exchange-link-info" id="ref-for-alternate-signed-exchange-link-info①">alternate signed exchange link info</a> (<var>linkTarget</var>, <var>linkContext</var>, <var>linkVariants</var>, <var>linkVariantKey</var>) to <var>alternateSxgLinks</var>.</p>
     </ol>
    <li data-md>
     <p>Return <var>alternateSxgLinks</var>.</p>
   </ol>
   <h2 class="heading settled" data-level="6" id="seccons"><span class="secno">6. </span><span class="content">Security Considerations</span><a class="self-link" href="#seccons"></a></h2>
   <p>The Security Considerations of <a data-link-type="biblio" href="#biblio-draft-yasskin-http-origin-signed-responses" title="Signed HTTP Exchanges">[draft-yasskin-http-origin-signed-responses]</a> apply.</p>
   <h3 class="heading settled" data-level="6.1" id="seccons-ct"><span class="secno">6.1. </span><span class="content">Certificate Transparency</span><a class="self-link" href="#seccons-ct"></a></h3>
   <p>To identify <a data-link-type="dfn" href="https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html#seccons-off-path" id="ref-for-seccons-off-path">off-path attackers</a>, <a href="#trusting-certificate">§ 5.9 Establishing trust in a certificate</a> encourages UAs to
implement Certificate Transparency, which requires that, in order for a
certificate to be trusted, it must be logged publicly. This means that an
off-path attacker who has managed to get a mis-issued certificate has to at
least announce that certificate in a place the legitimate domain owner has a
chance to notice. Once they notice, they can revoke the certificate, which will
stop the UA from trusting it no more than 7 days later.</p>
  </main>
  <div data-fill-with="conformance">
   <h2 class="no-ref no-num heading settled" id="w3c-conformance"><span class="content">Conformance</span><a class="self-link" href="#w3c-conformance"></a></h2>
   <h3 class="no-ref no-num heading settled" id="w3c-conventions"><span class="content">Document conventions</span><a class="self-link" href="#w3c-conventions"></a></h3>
   <p>Conformance requirements are expressed
    with a combination of descriptive assertions
    and RFC 2119 terminology.
    The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL”
    in the normative parts of this document
    are to be interpreted as described in RFC 2119.
    However, for readability,
    these words do not appear in all uppercase letters in this specification. </p>
   <p>All of the text of this specification is normative
    except sections explicitly marked as non-normative, examples, and notes. <a data-link-type="biblio" href="#biblio-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</a> </p>
   <p>Examples in this specification are introduced with the words “for example”
    or are set apart from the normative text
    with <code>class="example"</code>,
    like this: </p>
   <div class="example" id="w3c-example">
    <a class="self-link" href="#w3c-example"></a> 
    <p>This is an example of an informative example. </p>
   </div>
   <p>Informative notes begin with the word “Note”
    and are set apart from the normative text
    with <code>class="note"</code>,
    like this: </p>
   <p class="note" role="note">Note, this is an informative note.</p>
   <h3 class="no-ref no-num heading settled" id="w3c-conformant-algorithms"><span class="content">Conformant Algorithms</span><a class="self-link" href="#w3c-conformant-algorithms"></a></h3>
   <p>Requirements phrased in the imperative as part of algorithms
    (such as "strip any leading space characters"
    or "return false and abort these steps")
    are to be interpreted with the meaning of the key word
    ("must", "should", "may", etc)
    used in introducing the algorithm. </p>
   <p>Conformance requirements phrased as algorithms or specific steps
    can be implemented in any manner,
    so long as the end result is equivalent.
    In particular, the algorithms defined in this specification
    are intended to be easy to understand
    and are not intended to be performant.
    Implementers are encouraged to optimize. </p>
  </div>
<script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#public-key-algorithm">algorithm</a><span>, in § 4.3</span>
   <li><a href="#attr-valuedef-link-rel-allowed-alt-sxg">allowed-alt-sxg</a><span>, in § 3</span>
   <li><a href="#allowed-signed-exchange-link-info">Allowed signed exchange link info</a><span>, in § 4.5</span>
   <li><a href="#alternate-signed-exchange">alternate signed exchange</a><span>, in § 3</span>
   <li><a href="#alternate-signed-exchange-link">alternate signed exchange link</a><span>, in § 3</span>
   <li><a href="#alternate-signed-exchange-link-info">Alternate signed exchange link info</a><span>, in § 4.6</span>
   <li><a href="#alternate-signed-exchange-preload-info">Alternate signed exchange preload info</a><span>, in § 4.7</span>
   <li><a href="#augmented-certificate">Augmented Certificate</a><span>, in § 4.2</span>
   <li><a href="#read-buffer-bytes">bytes</a><span>, in § 4.2</span>
   <li><a href="#response-came-from-a-signed-exchange">came from a signed exchange</a><span>, in § 2.3</span>
   <li><a href="#signed-exchange-report-cert_fetch_error">cert_fetch_error</a><span>, in § 4.4</span>
   <li><a href="#augmented-certificate-certificate">certificate</a><span>, in § 4.3</span>
   <li>
    certificate chain
    <ul>
     <li><a href="#certificate-chain">definition of</a><span>, in § 4.3</span>
     <li><a href="#exchange-signature-certificate-chain">dfn for exchange signature</a><span>, in § 4.5</span>
    </ul>
   <li><a href="#signed-exchange-report-cert_parse_error">cert_parse_error</a><span>, in § 4.4</span>
   <li><a href="#signed-exchange-report-cert-server-ip-list">cert server IP list</a><span>, in § 4.4</span>
   <li><a href="#exchange-signature-certsha256">certSha256</a><span>, in § 4.5</span>
   <li><a href="#signed-exchange-report-cert-url-list">cert URL list</a><span>, in § 4.4</span>
   <li><a href="#signed-exchange-report-cert_verification_error">cert_verification_error</a><span>, in § 4.4</span>
   <li><a href="#alternate-signed-exchange-link-info-context">context</a><span>, in § 4.7</span>
   <li><a href="#create-a-new-signed-exchange-report">create a new signed exchange report</a><span>, in § 5.14</span>
   <li><a href="#creating-a-header-list-from-the-cbor-map">creating a header list from the CBOR map</a><span>, in § 5.11.1</span>
   <li>
    date
    <ul>
     <li><a href="#exchange-signature-date">dfn for exchange signature</a><span>, in § 4.5</span>
     <li><a href="#response-date">dfn for response</a><span>, in § 2.4</span>
    </ul>
   <li><a href="#response-came-from-a-signed-exchange">did not come from a signed exchange</a><span>, in § 2.3</span>
   <li><a href="#exchange-signature-establishes-cross-origin-trust">does not establish cross-origin trust</a><span>, in § 5.8</span>
   <li><a href="#certificate-chain-has-a-trusted-leaf">does not have a trusted leaf</a><span>, in § 5.9</span>
   <li><a href="#matches-the-stored-exchange">doesn’t match the stored exchange</a><span>, in § 5.13</span>
   <li><a href="#read-buffer-dump">Dump</a><span>, in § 5.17.4</span>
   <li><a href="#exchange-signature-establishes-cross-origin-trust">establishes cross-origin trust</a><span>, in § 5.8</span>
   <li><a href="#exchange">Exchange</a><span>, in § 4</span>
   <li><a href="#exchange-signature">Exchange Signature</a><span>, in § 4.4</span>
   <li><a href="#exchange-signature-expiration-time">expiration time</a><span>, in § 4.5</span>
   <li><a href="#certificate-extensions">extensions</a><span>, in § 4.3</span>
   <li><a href="#extracting-the-fallback-url">Extracting the fallback URL</a><span>, in § 5.2</span>
   <li><a href="#getting-allowed-signed-exchange-link-info">getting allowed signed exchange link info</a><span>, in § 5.19</span>
   <li><a href="#getting-alternate-signed-exchange-link-info">getting alternate signed exchange link info</a><span>, in § 5.20</span>
   <li><a href="#handling-the-certificate-reference">Handling the certificate reference</a><span>, in § 5.5.1</span>
   <li><a href="#certificate-chain-has-a-trusted-leaf">has a trusted leaf</a><span>, in § 5.9</span>
   <li><a href="#allowed-signed-exchange-link-info-header-integrity">header integrity</a><span>, in § 4.6</span>
   <li><a href="#element-attrdef-link-header-integrity">header-integrity</a><span>, in § 3</span>
   <li><a href="#response-header-integrity-value">header integrity value</a><span>, in § 2.3</span>
   <li><a href="#signed-exchange-report-inner-url">inner URL</a><span>, in § 4.4</span>
   <li><a href="#exchange-signature-integrity-header">integrity header</a><span>, in § 4.5</span>
   <li><a href="#signed-exchange-report-invalid_integrity_header">invalid_integrity_header</a><span>, in § 4.4</span>
   <li><a href="#exchange-signature-is-valid">is not valid</a><span>, in § 5.7</span>
   <li><a href="#exchange-signature-is-valid">is valid</a><span>, in § 5.7</span>
   <li><a href="#certificate-chain-leaf">leaf</a><span>, in § 4.3</span>
   <li><a href="#alternate-signed-exchange-preload-info-link">link</a><span>, in § 4.8</span>
   <li><a href="#matches-the-stored-exchange">matches the stored exchange</a><span>, in § 5.13</span>
   <li><a href="#signed-exchange-report-mi_error">mi_error</a><span>, in § 4.4</span>
   <li><a href="#new-read-buffer">new read buffer</a><span>, in § 5.17.1</span>
   <li><a href="#signed-exchange-report-non_secure_distributor">non_secure_distributor</a><span>, in § 4.4</span>
   <li><a href="#augmented-certificate-ocsp-response">OCSP response</a><span>, in § 4.3</span>
   <li><a href="#signed-exchange-report-ok">ok</a><span>, in § 4.4</span>
   <li><a href="#signed-exchange-report-outer-request">outer request</a><span>, in § 4.4</span>
   <li><a href="#signed-exchange-report-outer-response">outer response</a><span>, in § 4.4</span>
   <li><a href="#signed-exchange-report-parse_error">parse_error</a><span>, in § 4.4</span>
   <li><a href="#parsing-a-signed-exchange">Parsing a signed exchange</a><span>, in § 5.3</span>
   <li><a href="#parsing-b2-cbor-headers">Parsing b2 CBOR headers</a><span>, in § 5.10</span>
   <li><a href="#parsing-b3-cbor-headers">Parsing b3 CBOR headers</a><span>, in § 5.11</span>
   <li><a href="#parsing-the-invariant-prefix">Parsing the invariant prefix</a><span>, in § 5.4</span>
   <li><a href="#parsing-the-signature-header-field">Parsing the Signature header field</a><span>, in § 5.5</span>
   <li><a href="#alternate-signed-exchange-preload-info-prefetched-alternate-exchange">prefetched alternate exchange</a><span>, in § 4.8</span>
   <li><a href="#document-prefetched-signed-exchanges-for-navigation">prefetched signed exchanges for navigation</a><span>, in § 3.1</span>
   <li>
    prefetched subresource signed exchanges
    <ul>
     <li><a href="#document-prefetched-subresource-signed-exchanges">dfn for Document</a><span>, in § 3.1</span>
     <li><a href="#navigation-params-prefetched-subresource-signed-exchanges">dfn for navigation params</a><span>, in § 3.2</span>
    </ul>
   <li><a href="#certificate-public-key">public key</a><span>, in § 4.3</span>
   <li><a href="#queue-a-signed-exchange-report">queue a signed exchange report</a><span>, in § 5.16</span>
   <li><a href="#read-buffer-read">read</a><span>, in § 5.17.3</span>
   <li><a href="#reading-a-body">read a body</a><span>, in § 5.12</span>
   <li><a href="#read-buffer">Read buffer</a><span>, in § 4.1</span>
   <li><a href="#read-buffer-reader">reader</a><span>, in § 4.2</span>
   <li><a href="#reading-a-body">reading a body</a><span>, in § 5.12</span>
   <li><a href="#read-buffer-reading-up-to">reading up to</a><span>, in § 5.17.2</span>
   <li><a href="#exchange-request-url">request URL</a><span>, in § 4.1</span>
   <li><a href="#exchange-response">response</a><span>, in § 4.1</span>
   <li><a href="#signed-exchange-report-result">result</a><span>, in § 4.4</span>
   <li><a href="#augmented-certificate-sct">SCT</a><span>, in § 4.3</span>
   <li><a href="#signed-exchange-report-server-ip">server IP</a><span>, in § 4.4</span>
   <li><a href="#exchange-signature-signature">signature</a><span>, in § 4.5</span>
   <li><a href="#signed-exchange-report-signature_verification_error">signature_verification_error</a><span>, in § 4.4</span>
   <li><a href="#response-signed-exchange-outer-header-list">signed exchange outer header list</a><span>, in § 2.3</span>
   <li><a href="#signed-exchange-report">Signed Exchange report</a><span>, in § 4.3</span>
   <li><a href="#signed-exchange-version">signed exchange version</a><span>, in § 5.1</span>
   <li><a href="#signed-message">signed message</a><span>, in § 5.6</span>
   <li><a href="#request-stashed-exchange">stashed exchange</a><span>, in § 2.1</span>
   <li><a href="#read-buffer-stream">stream</a><span>, in § 4.2</span>
   <li>
    target
    <ul>
     <li><a href="#allowed-signed-exchange-link-info-target">dfn for allowed signed exchange link info</a><span>, in § 4.6</span>
     <li><a href="#alternate-signed-exchange-link-info-target">dfn for alternate signed exchange link info</a><span>, in § 4.7</span>
     <li><a href="#alternate-signed-exchange-preload-info-target">dfn for alternate signed exchange preload info</a><span>, in § 4.8</span>
    </ul>
   <li><a href="#target-attribute-named">Target Attribute named</a><span>, in § 5.18</span>
   <li><a href="#exchange-signature-validityurl">validityUrl</a><span>, in § 4.5</span>
   <li><a href="#exchange-signature-validityurlbytes">validityUrlBytes</a><span>, in § 4.5</span>
   <li>
    variant key
    <ul>
     <li><a href="#allowed-signed-exchange-link-info-variant-key">dfn for allowed signed exchange link info</a><span>, in § 4.6</span>
     <li><a href="#alternate-signed-exchange-link-info-variant-key">dfn for alternate signed exchange link info</a><span>, in § 4.7</span>
    </ul>
   <li><a href="#element-attrdef-link-variant-key">variant-key</a><span>, in § 3</span>
   <li>
    variants
    <ul>
     <li><a href="#allowed-signed-exchange-link-info-variants">dfn for allowed signed exchange link info</a><span>, in § 4.6</span>
     <li><a href="#alternate-signed-exchange-link-info-variants">dfn for alternate signed exchange link info</a><span>, in § 4.7</span>
     <li><a href="#element-attrdef-link-variants">element-attr for link</a><span>, in § 3</span>
    </ul>
   <li><a href="#wait-and-queue-a-report-for">wait and queue a report for</a><span>, in § 5.15</span>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[7230]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c5610ee2">quoted-string</span>
     <li><span class="dfn-paneled" id="4a4e79bc">token</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSP]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="550c8676">hash-source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[CSS21]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="bd9733eb">viewport</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="85394472">Document</span>
     <li><span class="dfn-paneled" id="5fd23811">fire an event</span>
     <li><span class="dfn-paneled" id="5216e1a0">node document</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-IETF-HTTPBIS-HEADER-STRUCTURE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="07515298">parsing http1 header fields into structured headers</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-IETF-HTTPBIS-VARIANTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a71d0ab2">variant-key</span>
     <li><span class="dfn-paneled" id="9690c542">variants</span>
     <li><span class="dfn-paneled" id="297e6fa0">variants cache behavior</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-THOMSON-HTTP-MICE]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="ad42c685">integrity proof for the first record</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-YASSKIN-HTTP-ORIGIN-SIGNED-RESPONSES]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2757da59">off-path attackers</span>
     <li><span class="dfn-paneled" id="4a3b8911">uncached response header</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-YASSKIN-HTTPBIS-ORIGIN-SIGNED-EXCHANGES-IMPL-02]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b281a3ef">canonically-encoded cbor</span>
     <li><span class="dfn-paneled" id="b030d96e">cansignhttpexchanges</span>
     <li><span class="dfn-paneled" id="be867a47">cert-chain cddl</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DRAFT-YASSKIN-WPACK-BUNDLED-EXCHANGES]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2546a400">parsing a cbor item</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f256859a">utf-8 decode without bom or fail</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c34eab22">"only-if-cached"</span>
     <li><span class="dfn-paneled" id="f9da6f1f">Request</span>
     <li><span class="dfn-paneled" id="a6a8ec88">append</span>
     <li><span class="dfn-paneled" id="644cb530">body</span>
     <li><span class="dfn-paneled" id="8e9945a0">body <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="81a76425">body <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="ac72672e">cache</span>
     <li><span class="dfn-paneled" id="688f9669">cache mode</span>
     <li><span class="dfn-paneled" id="857d5516">client</span>
     <li><span class="dfn-paneled" id="17c92915">clone <small>(for body)</small></span>
     <li><span class="dfn-paneled" id="8e720892">clone <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="555b1be1">clone <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="0a52fd14">clone()</span>
     <li><span class="dfn-paneled" id="d5434eef">contains</span>
     <li><span class="dfn-paneled" id="784f01de">cryptographic nonce metadata</span>
     <li><span class="dfn-paneled" id="32fd34d7">determine nosniff</span>
     <li><span class="dfn-paneled" id="1ca75be9">does not contain</span>
     <li><span class="dfn-paneled" id="36a75887">extracting a mime type</span>
     <li><span class="dfn-paneled" id="3be1d4ac">extracting header list values</span>
     <li><span class="dfn-paneled" id="a33db89a">fetch</span>
     <li><span class="dfn-paneled" id="2ce6f6bb">fetch(input)</span>
     <li><span class="dfn-paneled" id="d47d0690">get</span>
     <li><span class="dfn-paneled" id="1d2192f2">getting, decoding, and splitting</span>
     <li><span class="dfn-paneled" id="abc9feac">handle content codings</span>
     <li><span class="dfn-paneled" id="d85a6c84">header list</span>
     <li><span class="dfn-paneled" id="6ee0eab1">header list <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="f7b00a8b">header list <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="2aaa2f42">http fetch</span>
     <li><span class="dfn-paneled" id="980528b0">http-network-or-cache fetch</span>
     <li><span class="dfn-paneled" id="fa4ea124">initiator</span>
     <li><span class="dfn-paneled" id="d79a826f">integrity metadata</span>
     <li><span class="dfn-paneled" id="50b05fad">method</span>
     <li><span class="dfn-paneled" id="cb98f71f">mode</span>
     <li><span class="dfn-paneled" id="4b84a0bc">name</span>
     <li><span class="dfn-paneled" id="eb1b1af3">network error</span>
     <li><span class="dfn-paneled" id="143209a3">potential destination</span>
     <li><span class="dfn-paneled" id="a8b25997">redirect status</span>
     <li><span class="dfn-paneled" id="07582c28">referrer policy</span>
     <li><span class="dfn-paneled" id="55213b5b">request</span>
     <li><span class="dfn-paneled" id="ee7bba09">response</span>
     <li><span class="dfn-paneled" id="6d1db60d">service-workers mode</span>
     <li><span class="dfn-paneled" id="d9f4dab1">set</span>
     <li><span class="dfn-paneled" id="28119f64">status</span>
     <li><span class="dfn-paneled" id="a1d47575">status <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="db8aa4d8">stream</span>
     <li><span class="dfn-paneled" id="1d14445d">translate</span>
     <li><span class="dfn-paneled" id="6fd8e3fd">url <small>(for Request)</small></span>
     <li><span class="dfn-paneled" id="dc1cd39b">url <small>(for request)</small></span>
     <li><span class="dfn-paneled" id="3268a8eb">url <small>(for response)</small></span>
     <li><span class="dfn-paneled" id="ff8d2a6f">url list</span>
     <li><span class="dfn-paneled" id="8a608b90">value</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b1e2f688">alternate</span>
     <li><span class="dfn-paneled" id="39de1808">cors settings attribute</span>
     <li><span class="dfn-paneled" id="c918b2c7">creating a potential-cors request</span>
     <li><span class="dfn-paneled" id="3e12e042">environment settings object</span>
     <li><span class="dfn-paneled" id="544fc7df">error</span>
     <li><span class="dfn-paneled" id="77a2ee6e">host</span>
     <li><span class="dfn-paneled" id="a6078b11">href</span>
     <li><span class="dfn-paneled" id="fe78a46c">imagesizes</span>
     <li><span class="dfn-paneled" id="49cb6ed4">imagesrcset</span>
     <li><span class="dfn-paneled" id="a72449dd">in parallel</span>
     <li><span class="dfn-paneled" id="6cfa013d">link</span>
     <li><span class="dfn-paneled" id="18e7dde9">load</span>
     <li><span class="dfn-paneled" id="4437edc6">navigation params</span>
     <li><span class="dfn-paneled" id="b6ae4501">networking task source</span>
     <li><span class="dfn-paneled" id="8c58e049">no cors</span>
     <li><span class="dfn-paneled" id="086e3aff">origin</span>
     <li><span class="dfn-paneled" id="de7fc4bb">page load processing model for html files</span>
     <li><span class="dfn-paneled" id="e1b355b5">prefetch</span>
     <li><span class="dfn-paneled" id="f9529602">preload</span>
     <li><span class="dfn-paneled" id="a0c2dd1b">process the linked resource</span>
     <li><span class="dfn-paneled" id="9a517a7d">queue a task</span>
     <li><span class="dfn-paneled" id="57807ab9">referrer policy attribute</span>
     <li><span class="dfn-paneled" id="1ae60107">response</span>
     <li><span class="dfn-paneled" id="7393da89">same origin</span>
     <li><span class="dfn-paneled" id="0f2125ef">selecting an image source</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTTP-DIG-ALG]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="8e6851d5">digest algorithm</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="53275e46">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a3b18719">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="617d690e">ascii byte</span>
     <li><span class="dfn-paneled" id="0163ec5d">ascii decode</span>
     <li><span class="dfn-paneled" id="297c1527">ascii encode</span>
     <li><span class="dfn-paneled" id="2d5a2765">ascii string</span>
     <li><span class="dfn-paneled" id="e5026bef">ascii upper alpha</span>
     <li><span class="dfn-paneled" id="3de9e659">byte sequence</span>
     <li><span class="dfn-paneled" id="ae8def21">contain <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="a326add7">contain <small>(for map)</small></span>
     <li><span class="dfn-paneled" id="03afaf9c">empty</span>
     <li><span class="dfn-paneled" id="91c016b5">identical to</span>
     <li><span class="dfn-paneled" id="e5ea84f2">intersection</span>
     <li><span class="dfn-paneled" id="d8b963e8">isomorphic decode</span>
     <li><span class="dfn-paneled" id="5afbefcd">item</span>
     <li><span class="dfn-paneled" id="649608b9">list</span>
     <li><span class="dfn-paneled" id="3fca5a9e">map</span>
     <li><span class="dfn-paneled" id="0e6b2056">set</span>
     <li><span class="dfn-paneled" id="e5fc5b88">strictly split</span>
     <li><span class="dfn-paneled" id="0698d556">string</span>
     <li><span class="dfn-paneled" id="984221ca">struct</span>
     <li><span class="dfn-paneled" id="0e8de730">tuple</span>
    </ul>
   <li>
    <a data-link-type="biblio">[MIMESNIFF]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="7c195f8b">essence</span>
     <li><span class="dfn-paneled" id="16785ec4">mime type</span>
     <li><span class="dfn-paneled" id="fc5a3214">parameters</span>
    </ul>
   <li>
    <a data-link-type="biblio">[NETWORK-ERROR-LOGGING-1]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="935cf05e">nel policy</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC3230]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="428c62eb">digest</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC5280]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="c4a50d52">algorithmidentifier</span>
     <li><span class="dfn-paneled" id="0ca08f58">certificate extensions</span>
     <li><span class="dfn-paneled" id="a8684f3b">subject public key info</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC5480]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="b2ea76df">id-ecpublickey</span>
     <li><span class="dfn-paneled" id="f633dbcb">secp256r1</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC6960]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="9f95238c">ocspresponse</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC6962]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="1e6b2e23">signedcertificatetimestamplist</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC7231]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="a01bd864">date</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8288]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="385adf6d">link</span>
     <li><span class="dfn-paneled" id="094eaad3">link context</span>
     <li><span class="dfn-paneled" id="79aa4f80">link target</span>
     <li><span class="dfn-paneled" id="a569f4f7">parsing a link field value</span>
     <li><span class="dfn-paneled" id="a30ecfba">relation type</span>
     <li><span class="dfn-paneled" id="f28efc6c">serialisation-defined target attribute</span>
     <li><span class="dfn-paneled" id="fd14778a">target attribute</span>
    </ul>
   <li>
    <a data-link-type="biblio">[RFC8446]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="e05e2913">ecdsa_secp256r1_sha256</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SECURE-CONTEXTS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="96dabee7">potentially trustworthy origin</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SERVICE-WORKERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="cca60038">FetchEvent</span>
     <li><span class="dfn-paneled" id="00052ed7">navigationPreload</span>
     <li><span class="dfn-paneled" id="754dbcb4">preloadResponse</span>
     <li><span class="dfn-paneled" id="784b8ce5">request</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SHA2]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="f79121fa">sha-256</span>
    </ul>
   <li>
    <a data-link-type="biblio">[STREAMS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="59ed4e57">ReadableStream</span>
     <li><span class="dfn-paneled" id="9cae8b68">ReadableStreamDefaultReader</span>
     <li><span class="dfn-paneled" id="e3e2d506">cancel</span>
     <li><span class="dfn-paneled" id="b3cf1c94">close</span>
     <li><span class="dfn-paneled" id="5a9b9d4f">closed</span>
     <li><span class="dfn-paneled" id="6b6bb798">enqueue</span>
     <li><span class="dfn-paneled" id="3bd18bd6">error</span>
     <li><span class="dfn-paneled" id="41d0ebd7">errored</span>
     <li><span class="dfn-paneled" id="ef28f15d">get a reader</span>
     <li><span class="dfn-paneled" id="bf6531af">getting a reader</span>
     <li><span class="dfn-paneled" id="fcf1f4bd">need more data</span>
     <li><span class="dfn-paneled" id="ad191408">read a chunk</span>
     <li><span class="dfn-paneled" id="45e5c0e5">readable</span>
     <li><span class="dfn-paneled" id="de1558f6">reading all bytes</span>
    </ul>
   <li>
    <a data-link-type="biblio">[URL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="6fbdf145">equal</span>
     <li><span class="dfn-paneled" id="ed948033">fragment</span>
     <li><span class="dfn-paneled" id="959ad97b">origin</span>
     <li><span class="dfn-paneled" id="3a711be7">scheme</span>
     <li><span class="dfn-paneled" id="dcffbccd">url</span>
     <li><span class="dfn-paneled" id="ca3ca4ae">url parser</span>
     <li><span class="dfn-paneled" id="5442ea33">url serializer</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WEBIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="2f8afbfe">ArrayBuffer</span>
     <li><span class="dfn-paneled" id="95d7775a">Uint8Array</span>
     <li><span class="dfn-paneled" id="5eafebb0">sequence type</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-csp">[CSP]
   <dd>Mike West; Antonio Sartori. <a href="https://w3c.github.io/webappsec-csp/"><cite>Content Security Policy Level 3</cite></a>. URL: <a href="https://w3c.github.io/webappsec-csp/">https://w3c.github.io/webappsec-csp/</a>
   <dt id="biblio-css21">[CSS21]
   <dd>Bert Bos; et al. <a href="https://drafts.csswg.org/css2/"><cite>Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification</cite></a>. URL: <a href="https://drafts.csswg.org/css2/">https://drafts.csswg.org/css2/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-draft-ietf-httpbis-variants">[DRAFT-IETF-HTTPBIS-VARIANTS]
   <dd>Mark Nottingham. <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html"><cite>HTTP Representation Variants</cite></a>. WD. URL: <a href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html">https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html</a>
   <dt id="biblio-draft-thomson-http-mice">[DRAFT-THOMSON-HTTP-MICE]
   <dd>Martin Thomson. <a href="https://tools.ietf.org/html/draft-thomson-http-mice-03"><cite>Merkle Integrity Content Encoding</cite></a>. ED. URL: <a href="https://tools.ietf.org/html/draft-thomson-http-mice-03">https://tools.ietf.org/html/draft-thomson-http-mice-03</a>
   <dt id="biblio-draft-yasskin-http-origin-signed-responses">[DRAFT-YASSKIN-HTTP-ORIGIN-SIGNED-RESPONSES]
   <dd>Jeffrey Yasskin. <a href="https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html"><cite>Signed HTTP Exchanges</cite></a>. ED. URL: <a href="https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html">https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html</a>
   <dt id="biblio-draft-yasskin-httpbis-origin-signed-exchanges-impl-02">[DRAFT-YASSKIN-HTTPBIS-ORIGIN-SIGNED-EXCHANGES-IMPL-02]
   <dd>Jeffrey Yasskin; Kouhei Ueno. <a href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02"><cite>Signed HTTP Exchanges Implementation Checkpoints</cite></a>. ED. URL: <a href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02">https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02</a>
   <dt id="biblio-draft-yasskin-wpack-bundled-exchanges">[DRAFT-YASSKIN-WPACK-BUNDLED-EXCHANGES]
   <dd>Jeffrey Yasskin. <a href="https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html"><cite>Web Bundles</cite></a>. ED. URL: <a href="https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html">https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-mimesniff">[MIMESNIFF]
   <dd>Gordon P. Hemsley. <a href="https://mimesniff.spec.whatwg.org/"><cite>MIME Sniffing Standard</cite></a>. Living Standard. URL: <a href="https://mimesniff.spec.whatwg.org/">https://mimesniff.spec.whatwg.org/</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://datatracker.ietf.org/doc/html/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. March 1997. Best Current Practice. URL: <a href="https://datatracker.ietf.org/doc/html/rfc2119">https://datatracker.ietf.org/doc/html/rfc2119</a>
   <dt id="biblio-rfc5280">[RFC5280]
   <dd>D. Cooper; et al. <a href="https://www.rfc-editor.org/rfc/rfc5280"><cite>Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</cite></a>. May 2008. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>
   <dt id="biblio-rfc5480">[RFC5480]
   <dd>S. Turner; et al. <a href="https://www.rfc-editor.org/rfc/rfc5480"><cite>Elliptic Curve Cryptography Subject Public Key Information</cite></a>. March 2009. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc5480">https://www.rfc-editor.org/rfc/rfc5480</a>
   <dt id="biblio-rfc6960">[RFC6960]
   <dd>S. Santesson; et al. <a href="https://www.rfc-editor.org/rfc/rfc6960"><cite>X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</cite></a>. June 2013. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc6960">https://www.rfc-editor.org/rfc/rfc6960</a>
   <dt id="biblio-rfc6962">[RFC6962]
   <dd>B. Laurie; A. Langley; E. Kasper. <a href="https://www.rfc-editor.org/rfc/rfc6962"><cite>Certificate Transparency</cite></a>. June 2013. Experimental. URL: <a href="https://www.rfc-editor.org/rfc/rfc6962">https://www.rfc-editor.org/rfc/rfc6962</a>
   <dt id="biblio-rfc7231">[RFC7231]
   <dd>R. Fielding, Ed.; J. Reschke, Ed.. <a href="https://httpwg.org/specs/rfc7231.html"><cite>Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content</cite></a>. June 2014. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc7231.html">https://httpwg.org/specs/rfc7231.html</a>
   <dt id="biblio-rfc8288">[RFC8288]
   <dd>M. Nottingham. <a href="https://httpwg.org/specs/rfc8288.html"><cite>Web Linking</cite></a>. October 2017. Proposed Standard. URL: <a href="https://httpwg.org/specs/rfc8288.html">https://httpwg.org/specs/rfc8288.html</a>
   <dt id="biblio-rfc8446">[RFC8446]
   <dd>E. Rescorla. <a href="https://tools.ietf.org/html/draft-ietf-tls-tls13"><cite>The Transport Layer Security (TLS) Protocol Version 1.3</cite></a>. WD. URL: <a href="https://tools.ietf.org/html/draft-ietf-tls-tls13">https://tools.ietf.org/html/draft-ietf-tls-tls13</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/"><cite>Secure Contexts</cite></a>. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-sha2">[SHA2]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf"><cite>FIPS PUB 180-4, Secure Hash Standard</cite></a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-streams">[STREAMS]
   <dd>Adam Rice; et al. <a href="https://streams.spec.whatwg.org/"><cite>Streams Standard</cite></a>. Living Standard. URL: <a href="https://streams.spec.whatwg.org/">https://streams.spec.whatwg.org/</a>
   <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/"><cite>URL Standard</cite></a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Edgar Chen; Timothy Gu. <a href="https://webidl.spec.whatwg.org/"><cite>Web IDL Standard</cite></a>. Living Standard. URL: <a href="https://webidl.spec.whatwg.org/">https://webidl.spec.whatwg.org/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-draft-yasskin-httpbis-origin-signed-exchanges-impl-03">[DRAFT-YASSKIN-HTTPBIS-ORIGIN-SIGNED-EXCHANGES-IMPL-03]
   <dd>Jeffrey Yasskin; Kouhei Ueno. <a href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-03"><cite>Signed HTTP Exchanges Implementation Checkpoints</cite></a>. ED. URL: <a href="https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-03">https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-03</a>
   <dt id="biblio-http-dig-alg">[HTTP-DIG-ALG]
   <dd><a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml"><cite>Hypertext Transfer Protocol (HTTP) Digest Algorithm Values</cite></a>. LS. URL: <a href="https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml">https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml</a>
   <dt id="biblio-network-error-logging-1">[NETWORK-ERROR-LOGGING-1]
   <dd>Douglas Creager; et al. <a href="https://w3c.github.io/network-error-logging/"><cite>Network Error Logging</cite></a>. URL: <a href="https://w3c.github.io/network-error-logging/">https://w3c.github.io/network-error-logging/</a>
   <dt id="biblio-rfc3230">[RFC3230]
   <dd>J. Mogul; A. Van Hoff. <a href="https://www.rfc-editor.org/rfc/rfc3230"><cite>Instance Digests in HTTP</cite></a>. January 2002. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3230">https://www.rfc-editor.org/rfc/rfc3230</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Jake Archibald; Marijn Kruisselbrink. <a href="https://w3c.github.io/ServiceWorker/"><cite>Service Workers</cite></a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> Currently the behavior of recursive prefetch is
not specified. This section monkeypatches Link type "<code><a data-link-type="attr-value" href="https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch">prefetch</a></code>" to
add support only for the <a data-link-type="dfn" href="#alternate-signed-exchange">alternate signed exchanges</a> subresources. When we
change the HTML spec to support general recursive prefetching, this section
needs to align with that change. <a href="https://github.com/w3c/resource-hints/issues/77">[Issue #w3c/resource-hints#77]</a> <a class="issue-return" href="#issue-f0ea812f" title="Jump to section">↵</a></div>
   <div class="issue"> Currently the processing model of the HTTP <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3">Link</a> header is not defined in the HTML spec. This section
monkeypatches only for <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3">Link</a> rel=preload HTTP headers. When we
will change the HTML spec to generally support <a data-link-type="http-header" href="https://tools.ietf.org/html/rfc8288#section-3">Link</a> HTTP
headers, this section must be made to align with the change. <a href="https://github.com/whatwg/html/issues/4224">[Issue #whatwg/html#4224]</a> <a class="issue-return" href="#issue-12fd0d51" title="Jump to section">↵</a></div>
   <div class="issue"> Our security reviewers aren’t sure we should
allow UAs to take clock skew into account. <a href="https://github.com/WICG/webpackage/issues/141">[Issue #WICG/webpackage#141]</a> <a class="issue-return" href="#issue-a7ea6416" title="Jump to section">↵</a></div>
   <div class="issue"> This depends on the <a data-link-type="dfn" href="https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#cache">Variants Cache
Behavior</a> returning a list of lists. <a href="https://github.com/httpwg/http-extensions/issues/744">[Issue #httpwg/http-extensions#744]</a> <a class="issue-return" href="#issue-e1733bef" title="Jump to section">↵</a></div>
   <div class="issue"> The algorithms in this section create and operate over
ECMAScript objects like <code class="idl"><a data-link-type="idl" href="https://streams.spec.whatwg.org/#readablestream">ReadableStream</a></code> despite not having a Realm to attach
them to. <a href="https://github.com/whatwg/fetch/issues/730">[Issue #whatwg/fetch#730]</a> <a class="issue-return" href="#issue-3ffca592" title="Jump to section">↵</a></div>
  </div>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    // Functions, divided by link type, that wrap an autolink's
    // contents with the appropriate outer syntax.
    // Alternately, a string naming another type they format
    // the same as.
    const typeFormatters = {
        'dfn': (text) => `[=${text}=]`,
        'abstract-op': (text) => `[\$${text}\$]`,
        'value': (text) => `''${text}''`,
        'http-header': (text) => `[:${text}:]`,
        'idl': (text) => `{{${text}}}`,
        'interface': 'idl',
        'constructor': 'idl',
        'method': 'idl',
        'argument': 'idl',
        'attribute': 'idl',
        'callback': 'idl',
        'dictionary': 'idl',
        'dict-member': 'idl',
        'enum': 'idl',
        'enum-value': 'idl',
        'exception': 'idl',
        'const': 'idl',
        'typedef': 'idl',
        'stringifier': 'idl',
        'serializer': 'idl',
        'iterator': 'idl',
        'maplike': 'idl',
        'setlike': 'idl',
        'extended-attribute': 'idl',
        'event': 'idl',
        'element': (element) => `<{${element}}>`,
        'element-state': 'element',
        'element-attr': 'element',
        'attr-value': 'element',
        'scheme': 'dfn',
        'permission': 'dfn',
        'grammar': (text) => `${text} (within a <pre class=prod>)`,
        'type': (text)=> `<<${text}>>`,
        'property': (text) => `'${text}'`,
        'descriptor': 'property',
        'function': 'value',
        'at-rule': 'value',
        'selector': 'value',
    };
    const typesUsingFor = new Set(
        [
            "descriptor",
            "value",
            "element-attr",
            "attr-value",
            "element-state",
            "method",
            "constructor",
            "argument",
            "attribute",
            "const",
            "dict-member",
            "event",
            "enum-value",
            "stringifier",
            "serializer",
            "iterator",
            "maplike",
            "setlike",
            "state",
            "mode",
            "context",
            "facet",
        ],
    )
    const typesNotUsingFor = new Set(
        [
            "property",
            "element",
            "interface",
            "namespace",
            "callback",
            "dictionary",
            "enum",
            "exception",
            "typedef",
            "http-header",
            "permission",
        ],
    )
    function linkFormatterFromType(type) {
        const fnOrType = typeFormatters[type];
        if(typeof fnOrType === 'string') {
            // follow the alias
            return linkFormatterFromType(fnOrType);
        }
        return fnOrType;
    };

    function genLinkingSyntaxes(dfn) {
        if(dfn.tagName != "DFN") return;

        const type = dfn.getAttribute('data-dfn-type');
        if(!type) {
            console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
            return [];
        }

        // Return a function that wraps link text based on the type
        const linkFormatter = linkFormatterFromType(type);
        if(!linkFormatter) {
            console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
            return [];
        }

        let ltAlts;
        if(dfn.hasAttribute('data-lt')) {
            ltAlts = dfn.getAttribute('data-lt')
                .split("|")
                .map(x=>x.trim());
        } else {
            ltAlts = [dfn.textContent.trim()];
        }
        if(type == "type") {
            // lt of "<foo>", but "foo" is the interior;
            // <<foo/bar>> is how you write it with a for,
            // not <foo/<bar>> or whatever.
            for(var i = 0; i < ltAlts.length; i++) {
                const lt = ltAlts[i];
                const match = /<(.*)>/.exec(lt);
                if(match) { ltAlts[i] = match[1]; }
            }
        }

        let forAlts;
        if(dfn.hasAttribute('data-dfn-for')) {
            forAlts = dfn.getAttribute('data-dfn-for')
                .split(",")
                .map(x=>x.trim());
        } else {
            forAlts = [''];
        }

        let linkingSyntaxes = [];
        if(!typesUsingFor.has(type)) {
            for(const lt of ltAlts) {
                linkingSyntaxes.push(linkFormatter(lt));
            }
        }
        if(!typesNotUsingFor.has(type)) {
            for(const f of forAlts) {
                linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
            }
        }
        return [
            mk.b({}, 'Possible linking syntaxes:'),
            mk.ul({},
                ...linkingSyntaxes.map(link => {
                    const copyLink = async () =>
                        await navigator.clipboard.writeText(link);
                    return mk.li({},
                        mk.div({ class: 'link-item' },
                            mk.button({
                                class: 'copy-icon', title: 'Copy',
                                type: 'button',
                                _onclick: copyLink,
                                tabindex: 0,
                            }, mk.span({ class: 'icon' }) ),
                            mk.span({}, link)
                        )
                    );
                })
            )
        ];
    }

    function genDfnPanel({ dfn, dfnID, url, dfnText, refSections, external }) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
            genLinkingSyntaxes(dfn),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel({ ...panelData, dfn });
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel */
"use strict";
{
    const dfnsJson = window.dfnsJson || {};

    // Functions, divided by link type, that wrap an autolink's
    // contents with the appropriate outer syntax.
    // Alternately, a string naming another type they format
    // the same as.
    const typeFormatters = {
        'dfn': (text) => `[=${text}=]`,
        'abstract-op': (text) => `[\$${text}\$]`,
        'value': (text) => `''${text}''`,
        'http-header': (text) => `[:${text}:]`,
        'idl': (text) => `{{${text}}}`,
        'interface': 'idl',
        'constructor': 'idl',
        'method': 'idl',
        'argument': 'idl',
        'attribute': 'idl',
        'callback': 'idl',
        'dictionary': 'idl',
        'dict-member': 'idl',
        'enum': 'idl',
        'enum-value': 'idl',
        'exception': 'idl',
        'const': 'idl',
        'typedef': 'idl',
        'stringifier': 'idl',
        'serializer': 'idl',
        'iterator': 'idl',
        'maplike': 'idl',
        'setlike': 'idl',
        'extended-attribute': 'idl',
        'event': 'idl',
        'element': (element) => `<{${element}}>`,
        'element-state': 'element',
        'element-attr': 'element',
        'attr-value': 'element',
        'scheme': 'dfn',
        'permission': 'dfn',
        'grammar': (text) => `${text} (within a <pre class=prod>)`,
        'type': (text)=> `<<${text}>>`,
        'property': (text) => `'${text}'`,
        'descriptor': 'property',
        'function': 'value',
        'at-rule': 'value',
        'selector': 'value',
    };
    const typesUsingFor = new Set(
        [
            "descriptor",
            "value",
            "element-attr",
            "attr-value",
            "element-state",
            "method",
            "constructor",
            "argument",
            "attribute",
            "const",
            "dict-member",
            "event",
            "enum-value",
            "stringifier",
            "serializer",
            "iterator",
            "maplike",
            "setlike",
            "state",
            "mode",
            "context",
            "facet",
        ],
    )
    const typesNotUsingFor = new Set(
        [
            "property",
            "element",
            "interface",
            "namespace",
            "callback",
            "dictionary",
            "enum",
            "exception",
            "typedef",
            "http-header",
            "permission",
        ],
    )
    function linkFormatterFromType(type) {
        const fnOrType = typeFormatters[type];
        if(typeof fnOrType === 'string') {
            // follow the alias
            return linkFormatterFromType(fnOrType);
        }
        return fnOrType;
    };

    function genLinkingSyntaxes(dfn) {
        if(dfn.tagName != "DFN") return;

        const type = dfn.getAttribute('data-dfn-type');
        if(!type) {
            console.log(`<dfn> doesn't have a data-dfn-type:`, dfn);
            return [];
        }

        // Return a function that wraps link text based on the type
        const linkFormatter = linkFormatterFromType(type);
        if(!linkFormatter) {
            console.log(`<dfn> has an unknown data-dfn-type:`, dfn);
            return [];
        }

        let ltAlts;
        if(dfn.hasAttribute('data-lt')) {
            ltAlts = dfn.getAttribute('data-lt')
                .split("|")
                .map(x=>x.trim());
        } else {
            ltAlts = [dfn.textContent.trim()];
        }
        if(type == "type") {
            // lt of "<foo>", but "foo" is the interior;
            // <<foo/bar>> is how you write it with a for,
            // not <foo/<bar>> or whatever.
            for(var i = 0; i < ltAlts.length; i++) {
                const lt = ltAlts[i];
                const match = /<(.*)>/.exec(lt);
                if(match) { ltAlts[i] = match[1]; }
            }
        }

        let forAlts;
        if(dfn.hasAttribute('data-dfn-for')) {
            forAlts = dfn.getAttribute('data-dfn-for')
                .split(",")
                .map(x=>x.trim());
        } else {
            forAlts = [''];
        }

        let linkingSyntaxes = [];
        if(!typesUsingFor.has(type)) {
            for(const lt of ltAlts) {
                linkingSyntaxes.push(linkFormatter(lt));
            }
        }
        if(!typesNotUsingFor.has(type)) {
            for(const f of forAlts) {
                linkingSyntaxes.push(linkFormatter(`${f}/${ltAlts[0]}`))
            }
        }
        return [
            mk.b({}, 'Possible linking syntaxes:'),
            mk.ul({},
                ...linkingSyntaxes.map(link => {
                    const copyLink = async () =>
                        await navigator.clipboard.writeText(link);
                    return mk.li({},
                        mk.div({ class: 'link-item' },
                            mk.button({
                                class: 'copy-icon', title: 'Copy',
                                type: 'button',
                                _onclick: copyLink,
                                tabindex: 0,
                            }, mk.span({ class: 'icon' }) ),
                            mk.span({}, link)
                        )
                    );
                })
            )
        ];
    }

    function genDfnPanel({ dfn, dfnID, url, dfnText, refSections, external }) {
        return mk.aside({
            class: "dfn-panel",
            id: `infopanel-for-${dfnID}`,
            "data-for": dfnID,
            "aria-labelled-by":`infopaneltitle-for-${dfnID}`,
            },
            mk.span({id:`infopaneltitle-for-${dfnID}`, style:"display:none"},
                `Info about the '${dfnText}' ${external?"external":""} reference.`),
            mk.a({href:url}, url),
            mk.b({}, "Referenced in:"),
            mk.ul({},
                ...refSections.map(section=>
                    mk.li({},
                        ...section.refs.map((ref, refI)=>
                            [
                                mk.a({
                                    href: `#${ref.id}`
                                    },
                                    (refI == 0) ? section.title : `(${refI + 1})`
                                ),
                                " ",
                            ]
                        ),
                    ),
                ),
            ),
            genLinkingSyntaxes(dfn),
        );
    }

    function genAllDfnPanels() {
        for(const panelData of Object.values(window.dfnpanelData)) {
            const dfnID = panelData.dfnID;
            const dfn = document.getElementById(dfnID);
            if(!dfn) {
                console.log(`Can't find dfn#${dfnID}.`, panelData);
            } else {
                const panel = genDfnPanel({ ...panelData, dfn });
                append(document.body, panel);
                insertDfnPopupAction(dfn, panel)
            }
        }
    }

    document.addEventListener("DOMContentLoaded", ()=>{
        genAllDfnPanels();

        // Add popup behavior to all dfns to show the corresponding dfn-panel.
        var dfns = queryAll('.dfn-paneled');
        for(let dfn of dfns) { ; }

        document.body.addEventListener("click", (e) => {
            // If not handled already, just hide all dfn panels.
            hideAllDfnPanels();
        });
    })


    function hideAllDfnPanels() {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(el=>hideDfnPanel(el));
    }

    function showDfnPanel(dfnPanel, dfn) {
        hideAllDfnPanels(); // Only display one at this time.
        dfn.setAttribute("aria-expanded", "true");
        dfnPanel.classList.add("on");
        dfnPanel.style.left = "5px";
        dfnPanel.style.top = "0px";
        const panelRect = dfnPanel.getBoundingClientRect();
        if (panelRect.right > document.body.scrollWidth) {
            // Panel's overflowing the screen.
            // Just drop it below the dfn and flip it rightward instead.
            // This still wont' fix things if the screen is *really* wide,
            // but fixing that's a lot harder without 'anchor()'.
            dfnPanel.style.top = "1.5em";
            dfnPanel.style.left = "auto";
            dfnPanel.style.right = "0px";
        }
    }

    function pinDfnPanel(dfnPanel) {
        // Switch it to "activated" state, which pins it.
        dfnPanel.classList.add("activated");
        dfnPanel.style.left = null;
        dfnPanel.style.top = null;
    }

    function hideDfnPanel(dfnPanel, dfn) {
        if(!dfn) {
            dfn = document.getElementById(dfnPanel.getAttribute("data-for"));
        }
        dfn.setAttribute("aria-expanded", "false")
        dfnPanel.classList.remove("on");
        dfnPanel.classList.remove("activated");
    }

    function toggleDfnPanel(dfnPanel, dfn) {
        if(dfnPanel.classList.contains("on")) {
            hideDfnPanel(dfnPanel, dfn);
        } else {
            showDfnPanel(dfnPanel, dfn);
        }
    }

    function insertDfnPopupAction(dfn, dfnPanel) {
        // Find dfn panel
        const panelWrapper = document.createElement('span');
        panelWrapper.appendChild(dfnPanel);
        panelWrapper.style.position = "relative";
        panelWrapper.style.height = "0px";
        dfn.insertAdjacentElement("afterend", panelWrapper);
        dfn.setAttribute('role', 'button');
        dfn.setAttribute('aria-expanded', 'false')
        dfn.tabIndex = 0;
        dfn.classList.add('has-dfn-panel');
        dfn.addEventListener('click', (event) => {
            showDfnPanel(dfnPanel, dfn);
            event.stopPropagation();
        });
        dfn.addEventListener('keypress', (event) => {
            const kc = event.keyCode;
            // 32->Space, 13->Enter
            if(kc == 32 || kc == 13) {
                toggleDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        });

        dfnPanel.addEventListener('click', (event) => {
            if (event.target.nodeName == 'A') {
                pinDfnPanel(dfnPanel);
            }
            event.stopPropagation();
        });

        dfnPanel.addEventListener('keydown', (event) => {
            if(event.keyCode == 27) { // Escape key
                hideDfnPanel(dfnPanel, dfn);
                event.stopPropagation();
                event.preventDefault();
            }
        })
    }
}
</script>
<script>/* Boilerplate: script-dfn-panel-json */
window.dfnpanelData = {};
window.dfnpanelData['c5610ee2'] = {"dfnID": "c5610ee2", "url": "https://tools.ietf.org/html/rfc7230#section-3.2.6", "dfnText": "quoted-string", "refSections": [{"refs": [{"id": "ref-for-section-3.2.6"}, {"id": "ref-for-section-3.2.6\u2460"}, {"id": "ref-for-section-3.2.6\u2461"}, {"id": "ref-for-section-3.2.6\u2462"}], "title": "3. Subresource substitution"}], "external": true};
window.dfnpanelData['4a4e79bc'] = {"dfnID": "4a4e79bc", "url": "https://tools.ietf.org/html/rfc7230#section-3.2.6", "dfnText": "token", "refSections": [{"refs": [{"id": "ref-for-section-3.2.6"}, {"id": "ref-for-section-3.2.6\u2460"}, {"id": "ref-for-section-3.2.6\u2461"}, {"id": "ref-for-section-3.2.6\u2462"}], "title": "3. Subresource substitution"}], "external": true};
window.dfnpanelData['550c8676'] = {"dfnID": "550c8676", "url": "https://w3c.github.io/webappsec-csp/#grammardef-hash-source", "dfnText": "hash-source", "refSections": [{"refs": [{"id": "ref-for-grammardef-hash-source"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-grammardef-hash-source\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['bd9733eb'] = {"dfnID": "bd9733eb", "url": "https://drafts.csswg.org/css2/#viewport", "dfnText": "viewport", "refSections": [{"refs": [{"id": "ref-for-viewport"}, {"id": "ref-for-viewport\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['85394472'] = {"dfnID": "85394472", "url": "https://dom.spec.whatwg.org/#document", "dfnText": "Document", "refSections": [{"refs": [{"id": "ref-for-document"}, {"id": "ref-for-document\u2460"}], "title": "3.1. New Document fields"}], "external": true};
window.dfnpanelData['5fd23811'] = {"dfnID": "5fd23811", "url": "https://dom.spec.whatwg.org/#concept-event-fire", "dfnText": "fire an event", "refSections": [{"refs": [{"id": "ref-for-concept-event-fire"}, {"id": "ref-for-concept-event-fire\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['5216e1a0'] = {"dfnID": "5216e1a0", "url": "https://dom.spec.whatwg.org/#concept-node-document", "dfnText": "node document", "refSections": [{"refs": [{"id": "ref-for-concept-node-document"}, {"id": "ref-for-concept-node-document\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['07515298'] = {"dfnID": "07515298", "url": "https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-07#section-4.2", "dfnText": "parsing http1 header fields into structured headers", "refSections": [{"refs": [{"id": "ref-for-section-4.2\u2460"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['a71d0ab2'] = {"dfnID": "a71d0ab2", "url": "https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variant-key", "dfnText": "variant-key", "refSections": [{"refs": [{"id": "ref-for-variant-key"}, {"id": "ref-for-variant-key\u2460"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-variant-key\u2461"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['9690c542'] = {"dfnID": "9690c542", "url": "https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#variants", "dfnText": "variants", "refSections": [{"refs": [{"id": "ref-for-variants"}, {"id": "ref-for-variants\u2460"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-variants\u2461"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['297e6fa0'] = {"dfnID": "297e6fa0", "url": "https://httpwg.org/http-extensions/draft-ietf-httpbis-variants.html#cache", "dfnText": "variants cache behavior", "refSections": [{"refs": [{"id": "ref-for-cache"}, {"id": "ref-for-cache\u2460"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['ad42c685'] = {"dfnID": "ad42c685", "url": "https://tools.ietf.org/html/draft-thomson-http-mice-03#section-2.2", "dfnText": "integrity proof for the first record", "refSections": [{"refs": [{"id": "ref-for-section-2.2\u2464"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['2757da59'] = {"dfnID": "2757da59", "url": "https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html#seccons-off-path", "dfnText": "off-path attackers", "refSections": [{"refs": [{"id": "ref-for-seccons-off-path"}], "title": "6.1. Certificate Transparency"}], "external": true};
window.dfnpanelData['4a3b8911'] = {"dfnID": "4a3b8911", "url": "https://wicg.github.io/webpackage/draft-yasskin-http-origin-signed-responses.html#uncached-headers", "dfnText": "uncached response header", "refSections": [{"refs": [{"id": "ref-for-uncached-headers"}], "title": "5.8. Cross-origin trust"}], "external": true};
window.dfnpanelData['b281a3ef'] = {"dfnID": "b281a3ef", "url": "https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-3.4", "dfnText": "canonically-encoded cbor", "refSections": [{"refs": [{"id": "ref-for-section-3.4\u2460"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['b030d96e'] = {"dfnID": "b030d96e", "url": "https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-4.2", "dfnText": "cansignhttpexchanges", "refSections": [{"refs": [{"id": "ref-for-section-4.2\u2461"}], "title": "5.9. Establishing trust in a certificate"}], "external": true};
window.dfnpanelData['be867a47'] = {"dfnID": "be867a47", "url": "https://tools.ietf.org/html/draft-yasskin-httpbis-origin-signed-exchanges-impl-02#section-3.3", "dfnText": "cert-chain cddl", "refSections": [{"refs": [{"id": "ref-for-section-3.3\u2462"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['2546a400'] = {"dfnID": "2546a400", "url": "https://wicg.github.io/webpackage/draft-yasskin-wpack-bundled-exchanges.html#parse-known-length", "dfnText": "parsing a cbor item", "refSections": [{"refs": [{"id": "ref-for-parse-known-length"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-parse-known-length\u2460"}], "title": "5.11. Parsing b3 CBOR headers"}], "external": true};
window.dfnpanelData['f256859a'] = {"dfnID": "f256859a", "url": "https://encoding.spec.whatwg.org/#utf-8-decode-without-bom-or-fail", "dfnText": "utf-8 decode without bom or fail", "refSections": [{"refs": [{"id": "ref-for-utf-8-decode-without-bom-or-fail"}], "title": "5.4. Parsing the invariant prefix"}], "external": true};
window.dfnpanelData['c34eab22'] = {"dfnID": "c34eab22", "url": "https://fetch.spec.whatwg.org/#dom-requestcache-only-if-cached", "dfnText": "\"only-if-cached\"", "refSections": [{"refs": [{"id": "ref-for-dom-requestcache-only-if-cached"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['f9da6f1f'] = {"dfnID": "f9da6f1f", "url": "https://fetch.spec.whatwg.org/#request", "dfnText": "Request", "refSections": [{"refs": [{"id": "ref-for-request"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['a6a8ec88'] = {"dfnID": "a6a8ec88", "url": "https://fetch.spec.whatwg.org/#concept-header-list-append", "dfnText": "append", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-append"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['644cb530'] = {"dfnID": "644cb530", "url": "https://fetch.spec.whatwg.org/#concept-body", "dfnText": "body", "refSections": [{"refs": [{"id": "ref-for-concept-body"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['8e9945a0'] = {"dfnID": "8e9945a0", "url": "https://fetch.spec.whatwg.org/#concept-request-body", "dfnText": "body (for request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-body"}, {"id": "ref-for-concept-request-body\u2460"}, {"id": "ref-for-concept-request-body\u2461"}, {"id": "ref-for-concept-request-body\u2462"}], "title": "2.2. Request clone"}], "external": true};
window.dfnpanelData['81a76425'] = {"dfnID": "81a76425", "url": "https://fetch.spec.whatwg.org/#concept-response-body", "dfnText": "body (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-body"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-concept-response-body\u2460"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-response-body\u2461"}, {"id": "ref-for-concept-response-body\u2462"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-response-body\u2463"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-concept-response-body\u2464"}, {"id": "ref-for-concept-response-body\u2465"}, {"id": "ref-for-concept-response-body\u2466"}], "title": "5.15. Wait and queue a report"}], "external": true};
window.dfnpanelData['ac72672e'] = {"dfnID": "ac72672e", "url": "https://fetch.spec.whatwg.org/#dom-request-cache", "dfnText": "cache", "refSections": [{"refs": [{"id": "ref-for-dom-request-cache"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['688f9669'] = {"dfnID": "688f9669", "url": "https://fetch.spec.whatwg.org/#concept-request-cache-mode", "dfnText": "cache mode", "refSections": [{"refs": [{"id": "ref-for-concept-request-cache-mode"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}], "external": true};
window.dfnpanelData['857d5516'] = {"dfnID": "857d5516", "url": "https://fetch.spec.whatwg.org/#concept-request-client", "dfnText": "client", "refSections": [{"refs": [{"id": "ref-for-concept-request-client"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-concept-request-client\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-request-client\u2461"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['17c92915'] = {"dfnID": "17c92915", "url": "https://fetch.spec.whatwg.org/#concept-body-clone", "dfnText": "clone (for body)", "refSections": [{"refs": [{"id": "ref-for-concept-body-clone"}], "title": "2.2. Request clone"}], "external": true};
window.dfnpanelData['8e720892'] = {"dfnID": "8e720892", "url": "https://fetch.spec.whatwg.org/#concept-request-clone", "dfnText": "clone (for request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-clone"}], "title": "2.2. Request clone"}], "external": true};
window.dfnpanelData['555b1be1'] = {"dfnID": "555b1be1", "url": "https://fetch.spec.whatwg.org/#concept-response-clone", "dfnText": "clone (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-clone"}], "title": "2.2. Request clone"}, {"refs": [{"id": "ref-for-concept-response-clone\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-response-clone\u2461"}], "title": "3.4. Monkeypatch process a navigate fetch"}], "external": true};
window.dfnpanelData['0a52fd14'] = {"dfnID": "0a52fd14", "url": "https://fetch.spec.whatwg.org/#dom-request-clone", "dfnText": "clone()", "refSections": [{"refs": [{"id": "ref-for-dom-request-clone"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['d5434eef'] = {"dfnID": "d5434eef", "url": "https://fetch.spec.whatwg.org/#header-list-contains", "dfnText": "contains", "refSections": [{"refs": [{"id": "ref-for-header-list-contains"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-header-list-contains\u2460"}], "title": "5.11.1. Converting a map to a header list"}, {"refs": [{"id": "ref-for-header-list-contains\u2461"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['784f01de'] = {"dfnID": "784f01de", "url": "https://fetch.spec.whatwg.org/#concept-request-nonce-metadata", "dfnText": "cryptographic nonce metadata", "refSections": [{"refs": [{"id": "ref-for-concept-request-nonce-metadata"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['32fd34d7'] = {"dfnID": "32fd34d7", "url": "https://fetch.spec.whatwg.org/#determine-nosniff", "dfnText": "determine nosniff", "refSections": [{"refs": [{"id": "ref-for-determine-nosniff"}], "title": "5.1. Identifying signed exchanges"}], "external": true};
window.dfnpanelData['1ca75be9'] = {"dfnID": "1ca75be9", "url": "https://fetch.spec.whatwg.org/#header-list-contains", "dfnText": "does not contain", "refSections": [{"refs": [{"id": "ref-for-header-list-contains"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-header-list-contains\u2460"}], "title": "5.11.1. Converting a map to a header list"}, {"refs": [{"id": "ref-for-header-list-contains\u2461"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['36a75887'] = {"dfnID": "36a75887", "url": "https://fetch.spec.whatwg.org/#concept-header-extract-mime-type", "dfnText": "extracting a mime type", "refSections": [{"refs": [{"id": "ref-for-concept-header-extract-mime-type"}], "title": "5.1. Identifying signed exchanges"}, {"refs": [{"id": "ref-for-concept-header-extract-mime-type\u2460"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['3be1d4ac'] = {"dfnID": "3be1d4ac", "url": "https://fetch.spec.whatwg.org/#extract-header-list-values", "dfnText": "extracting header list values", "refSections": [{"refs": [{"id": "ref-for-extract-header-list-values"}], "title": "2.4. Response date"}], "external": true};
window.dfnpanelData['a33db89a'] = {"dfnID": "a33db89a", "url": "https://fetch.spec.whatwg.org/#concept-fetch", "dfnText": "fetch", "refSections": [{"refs": [{"id": "ref-for-concept-fetch"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-fetch\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-fetch\u2461"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['2ce6f6bb'] = {"dfnID": "2ce6f6bb", "url": "https://fetch.spec.whatwg.org/#dom-global-fetch", "dfnText": "fetch(input)", "refSections": [{"refs": [{"id": "ref-for-dom-global-fetch"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['d47d0690'] = {"dfnID": "d47d0690", "url": "https://fetch.spec.whatwg.org/#concept-header-list-get", "dfnText": "get", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-get"}, {"id": "ref-for-concept-header-list-get\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-header-list-get\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-header-list-get\u2462"}, {"id": "ref-for-concept-header-list-get\u2463"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['1d2192f2'] = {"dfnID": "1d2192f2", "url": "https://fetch.spec.whatwg.org/#concept-header-list-get-decode-split", "dfnText": "getting, decoding, and splitting", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-get-decode-split"}, {"id": "ref-for-concept-header-list-get-decode-split\u2460"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['abc9feac'] = {"dfnID": "abc9feac", "url": "https://fetch.spec.whatwg.org/#handle-content-codings", "dfnText": "handle content codings", "refSections": [{"refs": [{"id": "ref-for-handle-content-codings"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['d85a6c84'] = {"dfnID": "d85a6c84", "url": "https://fetch.spec.whatwg.org/#concept-header-list", "dfnText": "header list", "refSections": [{"refs": [{"id": "ref-for-concept-header-list"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-concept-header-list\u2460"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['6ee0eab1'] = {"dfnID": "6ee0eab1", "url": "https://fetch.spec.whatwg.org/#concept-request-header-list", "dfnText": "header list (for request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-header-list"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['f7b00a8b'] = {"dfnID": "f7b00a8b", "url": "https://fetch.spec.whatwg.org/#concept-response-header-list", "dfnText": "header list (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-header-list"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460"}], "title": "2.4. Response date"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2461"}, {"id": "ref-for-concept-response-header-list\u2462"}, {"id": "ref-for-concept-response-header-list\u2463"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-response-header-list\u2464"}, {"id": "ref-for-concept-response-header-list\u2465"}, {"id": "ref-for-concept-response-header-list\u2466"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2467"}, {"id": "ref-for-concept-response-header-list\u2468"}], "title": "5.1. Identifying signed exchanges"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u24ea"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2460"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2461"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2462"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2463"}], "title": "5.11. Parsing b3 CBOR headers"}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2464"}, {"id": "ref-for-concept-response-header-list\u2460\u2465"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-concept-response-header-list\u2460\u2466"}, {"id": "ref-for-concept-response-header-list\u2460\u2467"}, {"id": "ref-for-concept-response-header-list\u2460\u2468"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['2aaa2f42'] = {"dfnID": "2aaa2f42", "url": "https://fetch.spec.whatwg.org/#concept-http-fetch", "dfnText": "http fetch", "refSections": [{"refs": [{"id": "ref-for-concept-http-fetch"}], "title": "2.5. Monkeypatch HTTP fetch"}], "external": true};
window.dfnpanelData['980528b0'] = {"dfnID": "980528b0", "url": "https://fetch.spec.whatwg.org/#concept-http-network-or-cache-fetch", "dfnText": "http-network-or-cache fetch", "refSections": [{"refs": [{"id": "ref-for-concept-http-network-or-cache-fetch"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}], "external": true};
window.dfnpanelData['fa4ea124'] = {"dfnID": "fa4ea124", "url": "https://fetch.spec.whatwg.org/#concept-request-initiator", "dfnText": "initiator", "refSections": [{"refs": [{"id": "ref-for-concept-request-initiator"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}], "external": true};
window.dfnpanelData['d79a826f'] = {"dfnID": "d79a826f", "url": "https://fetch.spec.whatwg.org/#concept-request-integrity-metadata", "dfnText": "integrity metadata", "refSections": [{"refs": [{"id": "ref-for-concept-request-integrity-metadata"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['50b05fad'] = {"dfnID": "50b05fad", "url": "https://fetch.spec.whatwg.org/#concept-request-method", "dfnText": "method", "refSections": [{"refs": [{"id": "ref-for-concept-request-method"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['cb98f71f'] = {"dfnID": "cb98f71f", "url": "https://fetch.spec.whatwg.org/#concept-request-mode", "dfnText": "mode", "refSections": [{"refs": [{"id": "ref-for-concept-request-mode"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['4b84a0bc'] = {"dfnID": "4b84a0bc", "url": "https://fetch.spec.whatwg.org/#concept-header-name", "dfnText": "name", "refSections": [{"refs": [{"id": "ref-for-concept-header-name"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['eb1b1af3'] = {"dfnID": "eb1b1af3", "url": "https://fetch.spec.whatwg.org/#concept-network-error", "dfnText": "network error", "refSections": [{"refs": [{"id": "ref-for-concept-network-error"}, {"id": "ref-for-concept-network-error\u2460"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-concept-network-error\u2461"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}], "external": true};
window.dfnpanelData['143209a3'] = {"dfnID": "143209a3", "url": "https://fetch.spec.whatwg.org/#concept-potential-destination", "dfnText": "potential destination", "refSections": [{"refs": [{"id": "ref-for-concept-potential-destination"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-potential-destination\u2460"}, {"id": "ref-for-concept-potential-destination\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['a8b25997'] = {"dfnID": "a8b25997", "url": "https://fetch.spec.whatwg.org/#redirect-status", "dfnText": "redirect status", "refSections": [{"refs": [{"id": "ref-for-redirect-status"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-redirect-status\u2460"}], "title": "5.3. Parsing signed exchanges"}], "external": true};
window.dfnpanelData['07582c28'] = {"dfnID": "07582c28", "url": "https://fetch.spec.whatwg.org/#concept-request-referrer-policy", "dfnText": "referrer policy", "refSections": [{"refs": [{"id": "ref-for-concept-request-referrer-policy"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['55213b5b'] = {"dfnID": "55213b5b", "url": "https://fetch.spec.whatwg.org/#concept-request", "dfnText": "request", "refSections": [{"refs": [{"id": "ref-for-concept-request"}], "title": "2.1. A request\u2019s stashed exchange"}, {"refs": [{"id": "ref-for-concept-request\u2460"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-concept-request\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-request\u2462"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['ee7bba09'] = {"dfnID": "ee7bba09", "url": "https://fetch.spec.whatwg.org/#concept-response", "dfnText": "response", "refSections": [{"refs": [{"id": "ref-for-concept-response"}, {"id": "ref-for-concept-response\u2460"}, {"id": "ref-for-concept-response\u2461"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-concept-response\u2462"}], "title": "2.4. Response date"}, {"refs": [{"id": "ref-for-concept-response\u2463"}, {"id": "ref-for-concept-response\u2464"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-response\u2465"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-response\u2466"}], "title": "4.1. Exchange"}, {"refs": [{"id": "ref-for-concept-response\u2467"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-concept-response\u2468"}], "title": "5.1. Identifying signed exchanges"}, {"refs": [{"id": "ref-for-concept-response\u2460\u24ea"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-concept-response\u2460\u2460"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-response\u2460\u2461"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-concept-response\u2460\u2462"}], "title": "5.11. Parsing b3 CBOR headers"}, {"refs": [{"id": "ref-for-concept-response\u2460\u2463"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['6d1db60d'] = {"dfnID": "6d1db60d", "url": "https://fetch.spec.whatwg.org/#request-service-workers-mode", "dfnText": "service-workers mode", "refSections": [{"refs": [{"id": "ref-for-request-service-workers-mode"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['d9f4dab1'] = {"dfnID": "d9f4dab1", "url": "https://fetch.spec.whatwg.org/#concept-header-list-set", "dfnText": "set", "refSections": [{"refs": [{"id": "ref-for-concept-header-list-set"}, {"id": "ref-for-concept-header-list-set\u2460"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-concept-header-list-set\u2461"}, {"id": "ref-for-concept-header-list-set\u2462"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-header-list-set\u2463"}, {"id": "ref-for-concept-header-list-set\u2464"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-header-list-set\u2465"}], "title": "5.10. Parsing b2 CBOR headers"}], "external": true};
window.dfnpanelData['28119f64'] = {"dfnID": "28119f64", "url": "https://fetch.spec.whatwg.org/#concept-status", "dfnText": "status", "refSections": [{"refs": [{"id": "ref-for-concept-status"}, {"id": "ref-for-concept-status\u2460"}], "title": "2.5. Monkeypatch HTTP fetch"}], "external": true};
window.dfnpanelData['a1d47575'] = {"dfnID": "a1d47575", "url": "https://fetch.spec.whatwg.org/#concept-response-status", "dfnText": "status (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-status"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-concept-response-status\u2460"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-response-status\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-response-status\u2462"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-concept-response-status\u2463"}], "title": "5.11. Parsing b3 CBOR headers"}], "external": true};
window.dfnpanelData['db8aa4d8'] = {"dfnID": "db8aa4d8", "url": "https://fetch.spec.whatwg.org/#concept-body-stream", "dfnText": "stream", "refSections": [{"refs": [{"id": "ref-for-concept-body-stream"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-concept-body-stream\u2460"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-body-stream\u2461"}, {"id": "ref-for-concept-body-stream\u2462"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-body-stream\u2463"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-concept-body-stream\u2464"}, {"id": "ref-for-concept-body-stream\u2465"}, {"id": "ref-for-concept-body-stream\u2466"}], "title": "5.15. Wait and queue a report"}], "external": true};
window.dfnpanelData['1d14445d'] = {"dfnID": "1d14445d", "url": "https://fetch.spec.whatwg.org/#concept-potential-destination-translate", "dfnText": "translate", "refSections": [{"refs": [{"id": "ref-for-concept-potential-destination-translate"}, {"id": "ref-for-concept-potential-destination-translate\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-potential-destination-translate\u2461"}, {"id": "ref-for-concept-potential-destination-translate\u2462"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['6fd8e3fd'] = {"dfnID": "6fd8e3fd", "url": "https://fetch.spec.whatwg.org/#dom-request-url", "dfnText": "url (for Request)", "refSections": [{"refs": [{"id": "ref-for-dom-request-url"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['dc1cd39b'] = {"dfnID": "dc1cd39b", "url": "https://fetch.spec.whatwg.org/#concept-request-url", "dfnText": "url (for request)", "refSections": [{"refs": [{"id": "ref-for-concept-request-url"}, {"id": "ref-for-concept-request-url\u2460"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-concept-request-url\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-concept-request-url\u2462"}], "title": "5.13. Request matching"}, {"refs": [{"id": "ref-for-concept-request-url\u2463"}, {"id": "ref-for-concept-request-url\u2464"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['3268a8eb'] = {"dfnID": "3268a8eb", "url": "https://fetch.spec.whatwg.org/#concept-response-url", "dfnText": "url (for response)", "refSections": [{"refs": [{"id": "ref-for-concept-response-url"}, {"id": "ref-for-concept-response-url\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-response-url\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-response-url\u2462"}], "title": "5.3. Parsing signed exchanges"}], "external": true};
window.dfnpanelData['ff8d2a6f'] = {"dfnID": "ff8d2a6f", "url": "https://fetch.spec.whatwg.org/#concept-response-url-list", "dfnText": "url list", "refSections": [{"refs": [{"id": "ref-for-concept-response-url-list"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['8a608b90'] = {"dfnID": "8a608b90", "url": "https://fetch.spec.whatwg.org/#concept-header-value", "dfnText": "value", "refSections": [{"refs": [{"id": "ref-for-concept-header-value"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['b1e2f688'] = {"dfnID": "b1e2f688", "url": "https://html.spec.whatwg.org/multipage/links.html#rel-alternate", "dfnText": "alternate", "refSections": [{"refs": [{"id": "ref-for-rel-alternate"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-rel-alternate\u2460"}], "title": "4.7. Alternate signed exchange link info"}], "external": true};
window.dfnpanelData['39de1808'] = {"dfnID": "39de1808", "url": "https://html.spec.whatwg.org/multipage/urls-and-fetching.html#cors-settings-attribute", "dfnText": "cors settings attribute", "refSections": [{"refs": [{"id": "ref-for-cors-settings-attribute"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['c918b2c7'] = {"dfnID": "c918b2c7", "url": "https://html.spec.whatwg.org/multipage/urls-and-fetching.html#create-a-potential-cors-request", "dfnText": "creating a potential-cors request", "refSections": [{"refs": [{"id": "ref-for-create-a-potential-cors-request"}, {"id": "ref-for-create-a-potential-cors-request\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-create-a-potential-cors-request\u2461"}, {"id": "ref-for-create-a-potential-cors-request\u2462"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['3e12e042'] = {"dfnID": "3e12e042", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#environment-settings-object", "dfnText": "environment settings object", "refSections": [{"refs": [{"id": "ref-for-environment-settings-object"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-environment-settings-object\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-environment-settings-object\u2461"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['544fc7df'] = {"dfnID": "544fc7df", "url": "https://html.spec.whatwg.org/multipage/indices.html#event-error", "dfnText": "error", "refSections": [{"refs": [{"id": "ref-for-event-error"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['77a2ee6e'] = {"dfnID": "77a2ee6e", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin-host", "dfnText": "host", "refSections": [{"refs": [{"id": "ref-for-concept-origin-host"}], "title": "5.9. Establishing trust in a certificate"}], "external": true};
window.dfnpanelData['a6078b11'] = {"dfnID": "a6078b11", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-link-href", "dfnText": "href", "refSections": [{"refs": [{"id": "ref-for-attr-link-href"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-attr-link-href\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['fe78a46c'] = {"dfnID": "fe78a46c", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesizes", "dfnText": "imagesizes", "refSections": [{"refs": [{"id": "ref-for-attr-link-imagesizes"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-attr-link-imagesizes\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['49cb6ed4'] = {"dfnID": "49cb6ed4", "url": "https://html.spec.whatwg.org/multipage/semantics.html#attr-link-imagesrcset", "dfnText": "imagesrcset", "refSections": [{"refs": [{"id": "ref-for-attr-link-imagesrcset"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-attr-link-imagesrcset\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['a72449dd'] = {"dfnID": "a72449dd", "url": "https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel", "dfnText": "in parallel", "refSections": [{"refs": [{"id": "ref-for-in-parallel"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-in-parallel\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-in-parallel\u2461"}, {"id": "ref-for-in-parallel\u2462"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-in-parallel\u2463"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-in-parallel\u2464"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-in-parallel\u2465"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-in-parallel\u2466"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-in-parallel\u2467"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-in-parallel\u2468"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-in-parallel\u2460\u24ea"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-in-parallel\u2460\u2460"}], "title": "5.17.3. Read bytes"}, {"refs": [{"id": "ref-for-in-parallel\u2460\u2461"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['6cfa013d'] = {"dfnID": "6cfa013d", "url": "https://html.spec.whatwg.org/multipage/semantics.html#the-link-element", "dfnText": "link", "refSections": [{"refs": [{"id": "ref-for-the-link-element"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-the-link-element\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['18e7dde9'] = {"dfnID": "18e7dde9", "url": "https://html.spec.whatwg.org/multipage/indices.html#event-load", "dfnText": "load", "refSections": [{"refs": [{"id": "ref-for-event-load"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['4437edc6'] = {"dfnID": "4437edc6", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params", "dfnText": "navigation params", "refSections": [{"refs": [{"id": "ref-for-navigation-params"}], "title": "3.2. New navigation params struct field"}, {"refs": [{"id": "ref-for-navigation-params\u2460"}], "title": "3.4. Monkeypatch process a navigate fetch"}], "external": true};
window.dfnpanelData['b6ae4501'] = {"dfnID": "b6ae4501", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#networking-task-source", "dfnText": "networking task source", "refSections": [{"refs": [{"id": "ref-for-networking-task-source"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['8c58e049'] = {"dfnID": "8c58e049", "url": "https://html.spec.whatwg.org/multipage/urls-and-fetching.html#attr-crossorigin-none", "dfnText": "no cors", "refSections": [{"refs": [{"id": "ref-for-attr-crossorigin-none"}, {"id": "ref-for-attr-crossorigin-none\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-attr-crossorigin-none\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['086e3aff'] = {"dfnID": "086e3aff", "url": "https://html.spec.whatwg.org/multipage/browsers.html#concept-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-origin"}], "title": "5.9. Establishing trust in a certificate"}], "external": true};
window.dfnpanelData['de7fc4bb'] = {"dfnID": "de7fc4bb", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#read-html", "dfnText": "page load processing model for html files", "refSections": [{"refs": [{"id": "ref-for-read-html"}, {"id": "ref-for-read-html\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['e1b355b5'] = {"dfnID": "e1b355b5", "url": "https://html.spec.whatwg.org/multipage/links.html#link-type-prefetch", "dfnText": "prefetch", "refSections": [{"refs": [{"id": "ref-for-link-type-prefetch"}], "title": "3.1. New Document fields"}, {"refs": [{"id": "ref-for-link-type-prefetch\u2460"}, {"id": "ref-for-link-type-prefetch\u2461"}, {"id": "ref-for-link-type-prefetch\u2462"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['f9529602'] = {"dfnID": "f9529602", "url": "https://html.spec.whatwg.org/multipage/links.html#link-type-preload", "dfnText": "preload", "refSections": [{"refs": [{"id": "ref-for-link-type-preload"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-link-type-preload\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-link-type-preload\u2461"}, {"id": "ref-for-link-type-preload\u2462"}, {"id": "ref-for-link-type-preload\u2463"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['a0c2dd1b'] = {"dfnID": "a0c2dd1b", "url": "https://html.spec.whatwg.org/multipage/semantics.html#process-the-linked-resource", "dfnText": "process the linked resource", "refSections": [{"refs": [{"id": "ref-for-process-the-linked-resource"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['9a517a7d'] = {"dfnID": "9a517a7d", "url": "https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-task", "dfnText": "queue a task", "refSections": [{"refs": [{"id": "ref-for-queue-a-task"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['57807ab9'] = {"dfnID": "57807ab9", "url": "https://html.spec.whatwg.org/multipage/urls-and-fetching.html#referrer-policy-attribute", "dfnText": "referrer policy attribute", "refSections": [{"refs": [{"id": "ref-for-referrer-policy-attribute"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['1ae60107'] = {"dfnID": "1ae60107", "url": "https://html.spec.whatwg.org/multipage/browsing-the-web.html#navigation-params-response", "dfnText": "response", "refSections": [{"refs": [{"id": "ref-for-navigation-params-response"}, {"id": "ref-for-navigation-params-response\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['7393da89'] = {"dfnID": "7393da89", "url": "https://html.spec.whatwg.org/multipage/browsers.html#same-origin", "dfnText": "same origin", "refSections": [{"refs": [{"id": "ref-for-same-origin"}], "title": "5.8. Cross-origin trust"}], "external": true};
window.dfnpanelData['0f2125ef'] = {"dfnID": "0f2125ef", "url": "https://html.spec.whatwg.org/multipage/images.html#select-an-image-source", "dfnText": "selecting an image source", "refSections": [{"refs": [{"id": "ref-for-select-an-image-source"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-select-an-image-source\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": true};
window.dfnpanelData['8e6851d5'] = {"dfnID": "8e6851d5", "url": "https://www.iana.org/assignments/http-dig-alg/http-dig-alg.xhtml#http-dig-alg-1", "dfnText": "digest algorithm", "refSections": [{"refs": [{"id": "ref-for-http-dig-alg-1"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['53275e46'] = {"dfnID": "53275e46", "url": "https://infra.spec.whatwg.org/#list-append", "dfnText": "append (for list)", "refSections": [{"refs": [{"id": "ref-for-list-append"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-list-append\u2460"}], "title": "5.19. Get allowed signed exchange link info"}, {"refs": [{"id": "ref-for-list-append\u2461"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['a3b18719'] = {"dfnID": "a3b18719", "url": "https://infra.spec.whatwg.org/#set-append", "dfnText": "append (for set)", "refSections": [{"refs": [{"id": "ref-for-set-append"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['617d690e'] = {"dfnID": "617d690e", "url": "https://infra.spec.whatwg.org/#ascii-byte", "dfnText": "ascii byte", "refSections": [{"refs": [{"id": "ref-for-ascii-byte"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['0163ec5d'] = {"dfnID": "0163ec5d", "url": "https://infra.spec.whatwg.org/#ascii-decode", "dfnText": "ascii decode", "refSections": [{"refs": [{"id": "ref-for-ascii-decode"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['297c1527'] = {"dfnID": "297c1527", "url": "https://infra.spec.whatwg.org/#ascii-encode", "dfnText": "ascii encode", "refSections": [{"refs": [{"id": "ref-for-ascii-encode"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-ascii-encode\u2460"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['2d5a2765'] = {"dfnID": "2d5a2765", "url": "https://infra.spec.whatwg.org/#ascii-string", "dfnText": "ascii string", "refSections": [{"refs": [{"id": "ref-for-ascii-string"}], "title": "4.5. Exchange Signature"}], "external": true};
window.dfnpanelData['e5026bef'] = {"dfnID": "e5026bef", "url": "https://infra.spec.whatwg.org/#ascii-upper-alpha", "dfnText": "ascii upper alpha", "refSections": [{"refs": [{"id": "ref-for-ascii-upper-alpha"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['3de9e659'] = {"dfnID": "3de9e659", "url": "https://infra.spec.whatwg.org/#byte-sequence", "dfnText": "byte sequence", "refSections": [{"refs": [{"id": "ref-for-byte-sequence"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-byte-sequence\u2460"}], "title": "4.2. Read buffer"}, {"refs": [{"id": "ref-for-byte-sequence\u2461"}, {"id": "ref-for-byte-sequence\u2462"}, {"id": "ref-for-byte-sequence\u2463"}, {"id": "ref-for-byte-sequence\u2464"}, {"id": "ref-for-byte-sequence\u2465"}], "title": "4.3. Augmented Certificate"}, {"refs": [{"id": "ref-for-byte-sequence\u2466"}, {"id": "ref-for-byte-sequence\u2467"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-byte-sequence\u2468"}, {"id": "ref-for-byte-sequence\u2460\u24ea"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2460"}, {"id": "ref-for-byte-sequence\u2460\u2461"}], "title": "5.6. The signed message"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2462"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2463"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2464"}], "title": "5.11. Parsing b3 CBOR headers"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2465"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-byte-sequence\u2460\u2466"}, {"id": "ref-for-byte-sequence\u2460\u2467"}, {"id": "ref-for-byte-sequence\u2460\u2468"}, {"id": "ref-for-byte-sequence\u2461\u24ea"}], "title": "5.17.2. Read up to bytes"}], "external": true};
window.dfnpanelData['ae8def21'] = {"dfnID": "ae8def21", "url": "https://infra.spec.whatwg.org/#list-contain", "dfnText": "contain (for list)", "refSections": [{"refs": [{"id": "ref-for-list-contain"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['a326add7'] = {"dfnID": "a326add7", "url": "https://infra.spec.whatwg.org/#map-exists", "dfnText": "contain (for map)", "refSections": [{"refs": [{"id": "ref-for-map-exists"}], "title": "3.4. Monkeypatch process a navigate fetch"}], "external": true};
window.dfnpanelData['03afaf9c'] = {"dfnID": "03afaf9c", "url": "https://infra.spec.whatwg.org/#list-empty", "dfnText": "empty", "refSections": [{"refs": [{"id": "ref-for-list-empty"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['91c016b5'] = {"dfnID": "91c016b5", "url": "https://infra.spec.whatwg.org/#string-is", "dfnText": "identical to", "refSections": [{"refs": [{"id": "ref-for-string-is"}, {"id": "ref-for-string-is\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['e5ea84f2'] = {"dfnID": "e5ea84f2", "url": "https://infra.spec.whatwg.org/#set-intersection", "dfnText": "intersection", "refSections": [{"refs": [{"id": "ref-for-set-intersection"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['d8b963e8'] = {"dfnID": "d8b963e8", "url": "https://infra.spec.whatwg.org/#isomorphic-decode", "dfnText": "isomorphic decode", "refSections": [{"refs": [{"id": "ref-for-isomorphic-decode"}], "title": "5.11.1. Converting a map to a header list"}], "external": true};
window.dfnpanelData['5afbefcd'] = {"dfnID": "5afbefcd", "url": "https://infra.spec.whatwg.org/#list-item", "dfnText": "item", "refSections": [{"refs": [{"id": "ref-for-list-item"}], "title": "4.3. Augmented Certificate"}, {"refs": [{"id": "ref-for-list-item\u2460"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['649608b9'] = {"dfnID": "649608b9", "url": "https://infra.spec.whatwg.org/#list", "dfnText": "list", "refSections": [{"refs": [{"id": "ref-for-list"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-list\u2460"}], "title": "4.3. Augmented Certificate"}, {"refs": [{"id": "ref-for-list\u2461"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-list\u2462"}, {"id": "ref-for-list\u2463"}, {"id": "ref-for-list\u2464"}], "title": "5.13. Request matching"}, {"refs": [{"id": "ref-for-list\u2465"}, {"id": "ref-for-list\u2466"}], "title": "5.19. Get allowed signed exchange link info"}, {"refs": [{"id": "ref-for-list\u2467"}, {"id": "ref-for-list\u2468"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['3fca5a9e'] = {"dfnID": "3fca5a9e", "url": "https://infra.spec.whatwg.org/#ordered-map", "dfnText": "map", "refSections": [{"refs": [{"id": "ref-for-ordered-map"}], "title": "3.1. New Document fields"}], "external": true};
window.dfnpanelData['0e6b2056'] = {"dfnID": "0e6b2056", "url": "https://infra.spec.whatwg.org/#map-set", "dfnText": "set", "refSections": [{"refs": [{"id": "ref-for-map-set"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": true};
window.dfnpanelData['e5fc5b88'] = {"dfnID": "e5fc5b88", "url": "https://infra.spec.whatwg.org/#strictly-split", "dfnText": "strictly split", "refSections": [{"refs": [{"id": "ref-for-strictly-split"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['0698d556'] = {"dfnID": "0698d556", "url": "https://infra.spec.whatwg.org/#string", "dfnText": "string", "refSections": [{"refs": [{"id": "ref-for-string"}, {"id": "ref-for-string\u2460"}, {"id": "ref-for-string\u2461"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-string\u2462"}, {"id": "ref-for-string\u2463"}], "title": "4.7. Alternate signed exchange link info"}], "external": true};
window.dfnpanelData['984221ca'] = {"dfnID": "984221ca", "url": "https://infra.spec.whatwg.org/#struct", "dfnText": "struct", "refSections": [{"refs": [{"id": "ref-for-struct"}], "title": "4.1. Exchange"}, {"refs": [{"id": "ref-for-struct\u2460"}], "title": "4.2. Read buffer"}, {"refs": [{"id": "ref-for-struct\u2461"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-struct\u2462"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-struct\u2463"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-struct\u2464"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-struct\u2465"}], "title": "4.8. Alternate signed exchange preload info"}], "external": true};
window.dfnpanelData['0e8de730'] = {"dfnID": "0e8de730", "url": "https://infra.spec.whatwg.org/#tuple", "dfnText": "tuple", "refSections": [{"refs": [{"id": "ref-for-tuple"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['7c195f8b'] = {"dfnID": "7c195f8b", "url": "https://mimesniff.spec.whatwg.org/#mime-type-essence", "dfnText": "essence", "refSections": [{"refs": [{"id": "ref-for-mime-type-essence"}], "title": "5.1. Identifying signed exchanges"}, {"refs": [{"id": "ref-for-mime-type-essence\u2460"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['16785ec4'] = {"dfnID": "16785ec4", "url": "https://mimesniff.spec.whatwg.org/#mime-type", "dfnText": "mime type", "refSections": [{"refs": [{"id": "ref-for-mime-type"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['fc5a3214'] = {"dfnID": "fc5a3214", "url": "https://mimesniff.spec.whatwg.org/#parameters", "dfnText": "parameters", "refSections": [{"refs": [{"id": "ref-for-parameters"}], "title": "5.1. Identifying signed exchanges"}], "external": true};
window.dfnpanelData['935cf05e'] = {"dfnID": "935cf05e", "url": "https://w3c.github.io/network-error-logging/#dfn-nel-policies", "dfnText": "nel policy", "refSections": [{"refs": [{"id": "ref-for-dfn-nel-policies"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['428c62eb'] = {"dfnID": "428c62eb", "url": "https://tools.ietf.org/html/rfc3230#section-4.3.2", "dfnText": "digest", "refSections": [{"refs": [{"id": "ref-for-section-4.3.2"}], "title": "5.12. Creating the response stream."}], "external": true};
window.dfnpanelData['c4a50d52'] = {"dfnID": "c4a50d52", "url": "https://tools.ietf.org/html/rfc5280#section-4.1.1.2", "dfnText": "algorithmidentifier", "refSections": [{"refs": [{"id": "ref-for-section-4.1.1.2"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['0ca08f58'] = {"dfnID": "0ca08f58", "url": "https://tools.ietf.org/html/rfc5280#section-4.2", "dfnText": "certificate extensions", "refSections": [{"refs": [{"id": "ref-for-section-4.2"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['a8684f3b'] = {"dfnID": "a8684f3b", "url": "https://tools.ietf.org/html/rfc5280#section-4.1.2.7", "dfnText": "subject public key info", "refSections": [{"refs": [{"id": "ref-for-section-4.1.2.7"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['b2ea76df'] = {"dfnID": "b2ea76df", "url": "https://tools.ietf.org/html/rfc5480#section-2.1.1", "dfnText": "id-ecpublickey", "refSections": [{"refs": [{"id": "ref-for-section-2.1.1"}], "title": "5.7. Validating a signature"}], "external": true};
window.dfnpanelData['f633dbcb'] = {"dfnID": "f633dbcb", "url": "https://tools.ietf.org/html/rfc5480#section-2.1.1.1", "dfnText": "secp256r1", "refSections": [{"refs": [{"id": "ref-for-section-2.1.1.1"}], "title": "5.7. Validating a signature"}], "external": true};
window.dfnpanelData['9f95238c'] = {"dfnID": "9f95238c", "url": "https://tools.ietf.org/html/rfc6960#section-4.2.1", "dfnText": "ocspresponse", "refSections": [{"refs": [{"id": "ref-for-section-4.2.1"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['1e6b2e23'] = {"dfnID": "1e6b2e23", "url": "https://tools.ietf.org/html/rfc6962#section-3.3", "dfnText": "signedcertificatetimestamplist", "refSections": [{"refs": [{"id": "ref-for-section-3.3\u2461"}], "title": "4.3. Augmented Certificate"}], "external": true};
window.dfnpanelData['a01bd864'] = {"dfnID": "a01bd864", "url": "https://tools.ietf.org/html/rfc7231#section-7.1.1.2", "dfnText": "date", "refSections": [{"refs": [{"id": "ref-for-section-7.1.1.2"}], "title": "2.4. Response date"}], "external": true};
window.dfnpanelData['385adf6d'] = {"dfnID": "385adf6d", "url": "https://tools.ietf.org/html/rfc8288#section-3", "dfnText": "link", "refSections": [{"refs": [{"id": "ref-for-section-3"}, {"id": "ref-for-section-3\u2460"}, {"id": "ref-for-section-3\u2461"}, {"id": "ref-for-section-3\u2462"}, {"id": "ref-for-section-3\u2463"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-section-3\u2464"}, {"id": "ref-for-section-3\u2465"}, {"id": "ref-for-section-3\u2466"}, {"id": "ref-for-section-3\u2467"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-section-3\u2468"}], "title": "4.8. Alternate signed exchange preload info"}], "external": true};
window.dfnpanelData['094eaad3'] = {"dfnID": "094eaad3", "url": "https://tools.ietf.org/html/rfc8288#section-3.2", "dfnText": "link context", "refSections": [{"refs": [{"id": "ref-for-section-3.2"}, {"id": "ref-for-section-3.2\u2460"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-section-3.2\u2461"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-section-3.2\u2462"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['79aa4f80'] = {"dfnID": "79aa4f80", "url": "https://tools.ietf.org/html/rfc8288#section-3.1", "dfnText": "link target", "refSections": [{"refs": [{"id": "ref-for-section-3.1"}, {"id": "ref-for-section-3.1\u2460"}, {"id": "ref-for-section-3.1\u2461"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-section-3.1\u2462"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-section-3.1\u2463"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-section-3.1\u2464"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-section-3.1\u2465"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-section-3.1\u2466"}], "title": "4.8. Alternate signed exchange preload info"}, {"refs": [{"id": "ref-for-section-3.1\u2467"}], "title": "5.19. Get allowed signed exchange link info"}, {"refs": [{"id": "ref-for-section-3.1\u2468"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['a569f4f7'] = {"dfnID": "a569f4f7", "url": "https://tools.ietf.org/html/rfc8288#appendix-B.2", "dfnText": "parsing a link field value", "refSections": [{"refs": [{"id": "ref-for-appendix-B.2"}, {"id": "ref-for-appendix-B.2\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-appendix-B.2\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-appendix-B.2\u2462"}], "title": "4.8. Alternate signed exchange preload info"}], "external": true};
window.dfnpanelData['a30ecfba'] = {"dfnID": "a30ecfba", "url": "https://tools.ietf.org/html/rfc8288#section-3.3", "dfnText": "relation type", "refSections": [{"refs": [{"id": "ref-for-section-3.3"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-section-3.3\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-section-3.3\u2463"}], "title": "5.19. Get allowed signed exchange link info"}, {"refs": [{"id": "ref-for-section-3.3\u2464"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['f28efc6c'] = {"dfnID": "f28efc6c", "url": "https://tools.ietf.org/html/rfc8288#section-3.4", "dfnText": "serialisation-defined target attribute", "refSections": [{"refs": [{"id": "ref-for-section-3.4"}], "title": "3. Subresource substitution"}], "external": true};
window.dfnpanelData['fd14778a'] = {"dfnID": "fd14778a", "url": "https://tools.ietf.org/html/rfc8288#section-2.2", "dfnText": "target attribute", "refSections": [{"refs": [{"id": "ref-for-section-2.2"}, {"id": "ref-for-section-2.2\u2460"}, {"id": "ref-for-section-2.2\u2461"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-section-2.2\u2462"}, {"id": "ref-for-section-2.2\u2463"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-section-2.2\u2465"}, {"id": "ref-for-section-2.2\u2466"}], "title": "5.18. Get value of Target Attributes"}, {"refs": [{"id": "ref-for-section-2.2\u2467"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": true};
window.dfnpanelData['e05e2913'] = {"dfnID": "e05e2913", "url": "https://tools.ietf.org/html/draft-ietf-tls-tls13-28#section-4.2.3", "dfnText": "ecdsa_secp256r1_sha256", "refSections": [{"refs": [{"id": "ref-for-section-4.2.3"}], "title": "5.7. Validating a signature"}], "external": true};
window.dfnpanelData['96dabee7'] = {"dfnID": "96dabee7", "url": "https://w3c.github.io/webappsec-secure-contexts/#potentially-trustworthy-origin", "dfnText": "potentially trustworthy origin", "refSections": [{"refs": [{"id": "ref-for-potentially-trustworthy-origin"}], "title": "5.3. Parsing signed exchanges"}], "external": true};
window.dfnpanelData['cca60038'] = {"dfnID": "cca60038", "url": "https://w3c.github.io/ServiceWorker/#fetchevent", "dfnText": "FetchEvent", "refSections": [{"refs": [{"id": "ref-for-fetchevent"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['00052ed7'] = {"dfnID": "00052ed7", "url": "https://w3c.github.io/ServiceWorker/#dom-serviceworkerregistration-navigationpreload", "dfnText": "navigationPreload", "refSections": [{"refs": [{"id": "ref-for-dom-serviceworkerregistration-navigationpreload"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['754dbcb4'] = {"dfnID": "754dbcb4", "url": "https://w3c.github.io/ServiceWorker/#dom-fetchevent-preloadresponse", "dfnText": "preloadResponse", "refSections": [{"refs": [{"id": "ref-for-dom-fetchevent-preloadresponse"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['784b8ce5'] = {"dfnID": "784b8ce5", "url": "https://w3c.github.io/ServiceWorker/#dom-fetchevent-request", "dfnText": "request", "refSections": [{"refs": [{"id": "ref-for-dom-fetchevent-request"}], "title": "1.1. Overview"}], "external": true};
window.dfnpanelData['f79121fa'] = {"dfnID": "f79121fa", "url": "http://csrc.nist.gov/publications/fips/fips180-4/fips-180-4.pdf#", "dfnText": "sha-256", "refSections": [{"refs": [{"id": "ref-for-something"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-something\u2460"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-something\u2461"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-something\u2462"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['59ed4e57'] = {"dfnID": "59ed4e57", "url": "https://streams.spec.whatwg.org/#readablestream", "dfnText": "ReadableStream", "refSections": [{"refs": [{"id": "ref-for-readablestream"}], "title": "4.2. Read buffer"}, {"refs": [{"id": "ref-for-readablestream\u2460"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-readablestream\u2461"}], "title": "5.17. Stream algorithms"}, {"refs": [{"id": "ref-for-readablestream\u2462"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-readablestream\u2463"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['9cae8b68'] = {"dfnID": "9cae8b68", "url": "https://streams.spec.whatwg.org/#readablestreamdefaultreader", "dfnText": "ReadableStreamDefaultReader", "refSections": [{"refs": [{"id": "ref-for-readablestreamdefaultreader"}], "title": "4.2. Read buffer"}], "external": true};
window.dfnpanelData['e3e2d506'] = {"dfnID": "e3e2d506", "url": "https://streams.spec.whatwg.org/#readablestream-cancel", "dfnText": "cancel", "refSections": [{"refs": [{"id": "ref-for-readablestream-cancel"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-readablestream-cancel\u2460"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['b3cf1c94'] = {"dfnID": "b3cf1c94", "url": "https://streams.spec.whatwg.org/#readablestream-close", "dfnText": "close", "refSections": [{"refs": [{"id": "ref-for-readablestream-close"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['5a9b9d4f'] = {"dfnID": "5a9b9d4f", "url": "https://streams.spec.whatwg.org/#readablestream-closed", "dfnText": "closed", "refSections": [{"refs": [{"id": "ref-for-readablestream-closed"}, {"id": "ref-for-readablestream-closed\u2460"}], "title": "5.15. Wait and queue a report"}, {"refs": [{"id": "ref-for-readablestream-closed\u2461"}, {"id": "ref-for-readablestream-closed\u2462"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['6b6bb798'] = {"dfnID": "6b6bb798", "url": "https://streams.spec.whatwg.org/#readablestream-enqueue", "dfnText": "enqueue", "refSections": [{"refs": [{"id": "ref-for-readablestream-enqueue"}, {"id": "ref-for-readablestream-enqueue\u2460"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['3bd18bd6'] = {"dfnID": "3bd18bd6", "url": "https://streams.spec.whatwg.org/#readablestream-error", "dfnText": "error", "refSections": [{"refs": [{"id": "ref-for-readablestream-error"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['41d0ebd7'] = {"dfnID": "41d0ebd7", "url": "https://streams.spec.whatwg.org/#readablestream-errored", "dfnText": "errored", "refSections": [{"refs": [{"id": "ref-for-readablestream-errored"}, {"id": "ref-for-readablestream-errored\u2460"}], "title": "5.15. Wait and queue a report"}, {"refs": [{"id": "ref-for-readablestream-errored\u2461"}, {"id": "ref-for-readablestream-errored\u2462"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['ef28f15d'] = {"dfnID": "ef28f15d", "url": "https://streams.spec.whatwg.org/#readablestream-get-a-reader", "dfnText": "get a reader", "refSections": [{"refs": [{"id": "ref-for-readablestream-get-a-reader"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-readablestream-get-a-reader\u2460"}], "title": "5.17.1. Create a read buffer"}], "external": true};
window.dfnpanelData['bf6531af'] = {"dfnID": "bf6531af", "url": "https://streams.spec.whatwg.org/#readablestream-get-a-reader", "dfnText": "getting a reader", "refSections": [{"refs": [{"id": "ref-for-readablestream-get-a-reader"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-readablestream-get-a-reader\u2460"}], "title": "5.17.1. Create a read buffer"}], "external": true};
window.dfnpanelData['fcf1f4bd'] = {"dfnID": "fcf1f4bd", "url": "https://streams.spec.whatwg.org/#readablestream-need-more-data", "dfnText": "need more data", "refSections": [{"refs": [{"id": "ref-for-readablestream-need-more-data"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['ad191408'] = {"dfnID": "ad191408", "url": "https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-a-chunk", "dfnText": "read a chunk", "refSections": [{"refs": [{"id": "ref-for-readablestreamdefaultreader-read-a-chunk"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-readablestreamdefaultreader-read-a-chunk\u2460"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['45e5c0e5'] = {"dfnID": "45e5c0e5", "url": "https://streams.spec.whatwg.org/#readablestream-readable", "dfnText": "readable", "refSections": [{"refs": [{"id": "ref-for-readablestream-readable"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['de1558f6'] = {"dfnID": "de1558f6", "url": "https://streams.spec.whatwg.org/#readablestreamdefaultreader-read-all-bytes", "dfnText": "reading all bytes", "refSections": [{"refs": [{"id": "ref-for-readablestreamdefaultreader-read-all-bytes"}], "title": "5.5.1. Handling the certificate reference"}], "external": true};
window.dfnpanelData['6fbdf145'] = {"dfnID": "6fbdf145", "url": "https://url.spec.whatwg.org/#concept-url-equals", "dfnText": "equal", "refSections": [{"refs": [{"id": "ref-for-concept-url-equals"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-url-equals\u2460"}], "title": "5.13. Request matching"}], "external": true};
window.dfnpanelData['ed948033'] = {"dfnID": "ed948033", "url": "https://url.spec.whatwg.org/#concept-url-fragment", "dfnText": "fragment", "refSections": [{"refs": [{"id": "ref-for-concept-url-fragment"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-concept-url-fragment\u2460"}, {"id": "ref-for-concept-url-fragment\u2461"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['959ad97b'] = {"dfnID": "959ad97b", "url": "https://url.spec.whatwg.org/#concept-url-origin", "dfnText": "origin", "refSections": [{"refs": [{"id": "ref-for-concept-url-origin"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-concept-url-origin\u2460"}, {"id": "ref-for-concept-url-origin\u2461"}, {"id": "ref-for-concept-url-origin\u2462"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-concept-url-origin\u2463"}, {"id": "ref-for-concept-url-origin\u2464"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['3a711be7'] = {"dfnID": "3a711be7", "url": "https://url.spec.whatwg.org/#concept-url-scheme", "dfnText": "scheme", "refSections": [{"refs": [{"id": "ref-for-concept-url-scheme"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-concept-url-scheme\u2460"}, {"id": "ref-for-concept-url-scheme\u2461"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-concept-url-scheme\u2462"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['dcffbccd'] = {"dfnID": "dcffbccd", "url": "https://url.spec.whatwg.org/#concept-url", "dfnText": "url", "refSections": [{"refs": [{"id": "ref-for-concept-url"}], "title": "3.1. New Document fields"}, {"refs": [{"id": "ref-for-concept-url\u2460"}], "title": "4.1. Exchange"}, {"refs": [{"id": "ref-for-concept-url\u2461"}, {"id": "ref-for-concept-url\u2462"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-concept-url\u2463"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-concept-url\u2464"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-concept-url\u2465"}, {"id": "ref-for-concept-url\u2466"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-concept-url\u2467"}], "title": "5.4. Parsing the invariant prefix"}], "external": true};
window.dfnpanelData['ca3ca4ae'] = {"dfnID": "ca3ca4ae", "url": "https://url.spec.whatwg.org/#concept-url-parser", "dfnText": "url parser", "refSections": [{"refs": [{"id": "ref-for-concept-url-parser"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-concept-url-parser\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-concept-url-parser\u2461"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-concept-url-parser\u2462"}, {"id": "ref-for-concept-url-parser\u2463"}], "title": "5.5. Parsing a Signature Header Field"}], "external": true};
window.dfnpanelData['5442ea33'] = {"dfnID": "5442ea33", "url": "https://url.spec.whatwg.org/#concept-url-serializer", "dfnText": "url serializer", "refSections": [{"refs": [{"id": "ref-for-concept-url-serializer"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-concept-url-serializer\u2460"}, {"id": "ref-for-concept-url-serializer\u2461"}, {"id": "ref-for-concept-url-serializer\u2462"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['2f8afbfe'] = {"dfnID": "2f8afbfe", "url": "https://webidl.spec.whatwg.org/#idl-ArrayBuffer", "dfnText": "ArrayBuffer", "refSections": [{"refs": [{"id": "ref-for-idl-ArrayBuffer"}, {"id": "ref-for-idl-ArrayBuffer\u2460"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['95d7775a'] = {"dfnID": "95d7775a", "url": "https://webidl.spec.whatwg.org/#idl-Uint8Array", "dfnText": "Uint8Array", "refSections": [{"refs": [{"id": "ref-for-idl-Uint8Array"}, {"id": "ref-for-idl-Uint8Array\u2460"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-idl-Uint8Array\u2461"}, {"id": "ref-for-idl-Uint8Array\u2462"}, {"id": "ref-for-idl-Uint8Array\u2463"}], "title": "5.17.4. Dump to another stream"}], "external": true};
window.dfnpanelData['5eafebb0'] = {"dfnID": "5eafebb0", "url": "https://webidl.spec.whatwg.org/#sequence-type", "dfnText": "sequence type", "refSections": [{"refs": [{"id": "ref-for-sequence-type"}], "title": "5.16. Queuing signed exchange report"}], "external": true};
window.dfnpanelData['request-stashed-exchange'] = {"dfnID": "request-stashed-exchange", "url": "#request-stashed-exchange", "dfnText": "stashed exchange", "refSections": [{"refs": [{"id": "ref-for-request-stashed-exchange"}, {"id": "ref-for-request-stashed-exchange\u2460"}, {"id": "ref-for-request-stashed-exchange\u2461"}, {"id": "ref-for-request-stashed-exchange\u2462"}, {"id": "ref-for-request-stashed-exchange\u2463"}], "title": "2.2. Request clone"}, {"refs": [{"id": "ref-for-request-stashed-exchange\u2464"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-request-stashed-exchange\u2465"}, {"id": "ref-for-request-stashed-exchange\u2466"}, {"id": "ref-for-request-stashed-exchange\u2467"}, {"id": "ref-for-request-stashed-exchange\u2468"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}, {"refs": [{"id": "ref-for-request-stashed-exchange\u2460\u24ea"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-request-stashed-exchange\u2460\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['response-came-from-a-signed-exchange'] = {"dfnID": "response-came-from-a-signed-exchange", "url": "#response-came-from-a-signed-exchange", "dfnText": "came from a signed exchange", "refSections": [{"refs": [{"id": "ref-for-response-came-from-a-signed-exchange"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-response-came-from-a-signed-exchange\u2460"}, {"id": "ref-for-response-came-from-a-signed-exchange\u2461"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-response-came-from-a-signed-exchange\u2462"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['response-signed-exchange-outer-header-list'] = {"dfnID": "response-signed-exchange-outer-header-list", "url": "#response-signed-exchange-outer-header-list", "dfnText": "signed exchange outer\nheader list", "refSections": [{"refs": [{"id": "ref-for-response-signed-exchange-outer-header-list"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-response-signed-exchange-outer-header-list\u2460"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['response-header-integrity-value'] = {"dfnID": "response-header-integrity-value", "url": "#response-header-integrity-value", "dfnText": "header integrity\nvalue", "refSections": [{"refs": [{"id": "ref-for-response-header-integrity-value"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-response-header-integrity-value\u2460"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-response-header-integrity-value\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-response-header-integrity-value\u2462"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['response-date'] = {"dfnID": "response-date", "url": "#response-date", "dfnText": "date", "refSections": [{"refs": [{"id": "ref-for-response-date"}, {"id": "ref-for-response-date\u2460"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}], "external": false};
window.dfnpanelData['attr-valuedef-link-rel-allowed-alt-sxg'] = {"dfnID": "attr-valuedef-link-rel-allowed-alt-sxg", "url": "#attr-valuedef-link-rel-allowed-alt-sxg", "dfnText": "allowed-alt-sxg", "refSections": [{"refs": [{"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg"}, {"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2460"}, {"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2461"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2462"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2463"}, {"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2464"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-attr-valuedef-link-rel-allowed-alt-sxg\u2465"}], "title": "4.6. Allowed signed exchange link info"}], "external": false};
window.dfnpanelData['element-attrdef-link-header-integrity'] = {"dfnID": "element-attrdef-link-header-integrity", "url": "#element-attrdef-link-header-integrity", "dfnText": "header-integrity", "refSections": [{"refs": [{"id": "ref-for-element-attrdef-link-header-integrity"}], "title": "3. Subresource substitution"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link'] = {"dfnID": "alternate-signed-exchange-link", "url": "#alternate-signed-exchange-link", "dfnText": "alternate signed exchange link", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link"}, {"id": "ref-for-alternate-signed-exchange-link\u2460"}, {"id": "ref-for-alternate-signed-exchange-link\u2461"}, {"id": "ref-for-alternate-signed-exchange-link\u2462"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-alternate-signed-exchange-link\u2463"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
window.dfnpanelData['alternate-signed-exchange'] = {"dfnID": "alternate-signed-exchange", "url": "#alternate-signed-exchange", "dfnText": "alternate signed exchange", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange"}], "title": "3. Subresource substitution"}, {"refs": [{"id": "ref-for-alternate-signed-exchange\u2460"}, {"id": "ref-for-alternate-signed-exchange\u2461"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-alternate-signed-exchange\u2462"}], "title": "4.8. Alternate signed exchange preload info"}], "external": false};
window.dfnpanelData['element-attrdef-link-variants'] = {"dfnID": "element-attrdef-link-variants", "url": "#element-attrdef-link-variants", "dfnText": "variants", "refSections": [{"refs": [{"id": "ref-for-element-attrdef-link-variants"}], "title": "3. Subresource substitution"}], "external": false};
window.dfnpanelData['element-attrdef-link-variant-key'] = {"dfnID": "element-attrdef-link-variant-key", "url": "#element-attrdef-link-variant-key", "dfnText": "variant-key", "refSections": [{"refs": [{"id": "ref-for-element-attrdef-link-variant-key"}], "title": "3. Subresource substitution"}], "external": false};
window.dfnpanelData['document-prefetched-signed-exchanges-for-navigation'] = {"dfnID": "document-prefetched-signed-exchanges-for-navigation", "url": "#document-prefetched-signed-exchanges-for-navigation", "dfnText": "prefetched signed exchanges for\nnavigation", "refSections": [{"refs": [{"id": "ref-for-document-prefetched-signed-exchanges-for-navigation"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-document-prefetched-signed-exchanges-for-navigation\u2460"}, {"id": "ref-for-document-prefetched-signed-exchanges-for-navigation\u2461"}], "title": "3.4. Monkeypatch process a navigate fetch"}], "external": false};
window.dfnpanelData['document-prefetched-subresource-signed-exchanges'] = {"dfnID": "document-prefetched-subresource-signed-exchanges", "url": "#document-prefetched-subresource-signed-exchanges", "dfnText": "prefetched\nsubresource signed exchanges", "refSections": [{"refs": [{"id": "ref-for-document-prefetched-subresource-signed-exchanges"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-document-prefetched-subresource-signed-exchanges\u2460"}], "title": "3.4. Monkeypatch process a navigate fetch"}], "external": false};
window.dfnpanelData['navigation-params-prefetched-subresource-signed-exchanges'] = {"dfnID": "navigation-params-prefetched-subresource-signed-exchanges", "url": "#navigation-params-prefetched-subresource-signed-exchanges", "dfnText": "prefetched subresource signed exchanges", "refSections": [{"refs": [{"id": "ref-for-navigation-params-prefetched-subresource-signed-exchanges"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-navigation-params-prefetched-subresource-signed-exchanges\u2460"}, {"id": "ref-for-navigation-params-prefetched-subresource-signed-exchanges\u2461"}, {"id": "ref-for-navigation-params-prefetched-subresource-signed-exchanges\u2462"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['exchange'] = {"dfnID": "exchange", "url": "#exchange", "dfnText": "4.1. Exchange", "refSections": [{"refs": [{"id": "ref-for-exchange"}], "title": "2.1. A request\u2019s stashed exchange"}, {"refs": [{"id": "ref-for-exchange\u2460"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-exchange\u2461"}, {"id": "ref-for-exchange\u2462"}], "title": "3.1. New Document fields"}, {"refs": [{"id": "ref-for-exchange\u2463"}], "title": "3.2. New navigation params struct field"}, {"refs": [{"id": "ref-for-exchange\u2464"}, {"id": "ref-for-exchange\u2465"}, {"id": "ref-for-exchange\u2466"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-exchange\u2467"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-exchange\u2468"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-exchange"}], "title": "4.1. Exchange"}, {"refs": [{"id": "ref-for-exchange\u2460\u24ea"}], "title": "4.8. Alternate signed exchange preload info"}, {"refs": [{"id": "ref-for-exchange\u2460\u2460"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-exchange\u2460\u2461"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-exchange\u2460\u2462"}, {"id": "ref-for-exchange\u2460\u2463"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-exchange\u2460\u2464"}, {"id": "ref-for-exchange\u2460\u2465"}], "title": "5.11. Parsing b3 CBOR headers"}], "external": false};
window.dfnpanelData['exchange-request-url'] = {"dfnID": "exchange-request-url", "url": "#exchange-request-url", "dfnText": "request URL", "refSections": [{"refs": [{"id": "ref-for-exchange-request-url"}, {"id": "ref-for-exchange-request-url\u2460"}], "title": "2.2. Request clone"}, {"refs": [{"id": "ref-for-exchange-request-url\u2461"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-exchange-request-url\u2462"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-exchange-request-url\u2463"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-exchange-request-url\u2464"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-exchange-request-url\u2465"}], "title": "5.13. Request matching"}], "external": false};
window.dfnpanelData['exchange-response'] = {"dfnID": "exchange-response", "url": "#exchange-response", "dfnText": "response", "refSections": [{"refs": [{"id": "ref-for-exchange-response"}, {"id": "ref-for-exchange-response\u2460"}], "title": "2.2. Request clone"}, {"refs": [{"id": "ref-for-exchange-response\u2461"}], "title": "2.3. New response fields"}, {"refs": [{"id": "ref-for-exchange-response\u2462"}, {"id": "ref-for-exchange-response\u2463"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}, {"refs": [{"id": "ref-for-exchange-response\u2464"}, {"id": "ref-for-exchange-response\u2465"}, {"id": "ref-for-exchange-response\u2466"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-exchange-response\u2467"}], "title": "3.4. Monkeypatch process a navigate fetch"}, {"refs": [{"id": "ref-for-exchange-response\u2468"}, {"id": "ref-for-exchange-response\u2460\u24ea"}, {"id": "ref-for-exchange-response\u2460\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-exchange-response\u2460\u2461"}, {"id": "ref-for-exchange-response\u2460\u2462"}, {"id": "ref-for-exchange-response\u2460\u2463"}, {"id": "ref-for-exchange-response\u2460\u2464"}, {"id": "ref-for-exchange-response\u2460\u2465"}, {"id": "ref-for-exchange-response\u2460\u2466"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-exchange-response\u2460\u2467"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-exchange-response\u2460\u2468"}, {"id": "ref-for-exchange-response\u2461\u24ea"}, {"id": "ref-for-exchange-response\u2461\u2460"}, {"id": "ref-for-exchange-response\u2461\u2461"}], "title": "5.13. Request matching"}], "external": false};
window.dfnpanelData['read-buffer'] = {"dfnID": "read-buffer", "url": "#read-buffer", "dfnText": "4.2. Read buffer", "refSections": [{"refs": [{"id": "ref-for-read-buffer"}], "title": "4.2. Read buffer"}, {"refs": [{"id": "ref-for-read-buffer"}], "title": "5.4. Parsing the invariant prefix"}, {"refs": [{"id": "ref-for-read-buffer\u2460"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-read-buffer\u2461"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-read-buffer\u2462"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-read-buffer\u2463"}], "title": "5.17.3. Read bytes"}, {"refs": [{"id": "ref-for-read-buffer\u2464"}], "title": "5.17.4. Dump to another stream"}], "external": false};
window.dfnpanelData['read-buffer-stream'] = {"dfnID": "read-buffer-stream", "url": "#read-buffer-stream", "dfnText": "stream", "refSections": [{"refs": [{"id": "ref-for-read-buffer-stream"}, {"id": "ref-for-read-buffer-stream\u2460"}], "title": "4.2. Read buffer"}, {"refs": [{"id": "ref-for-read-buffer-stream\u2461"}], "title": "5.12. Creating the response stream."}, {"refs": [{"id": "ref-for-read-buffer-stream\u2462"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-read-buffer-stream\u2463"}, {"id": "ref-for-read-buffer-stream\u2464"}], "title": "5.17.4. Dump to another stream"}], "external": false};
window.dfnpanelData['read-buffer-reader'] = {"dfnID": "read-buffer-reader", "url": "#read-buffer-reader", "dfnText": "reader", "refSections": [{"refs": [{"id": "ref-for-read-buffer-reader"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-read-buffer-reader\u2460"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-read-buffer-reader\u2461"}], "title": "5.17.4. Dump to another stream"}], "external": false};
window.dfnpanelData['read-buffer-bytes'] = {"dfnID": "read-buffer-bytes", "url": "#read-buffer-bytes", "dfnText": "bytes", "refSections": [{"refs": [{"id": "ref-for-read-buffer-bytes"}], "title": "5.17.1. Create a read buffer"}, {"refs": [{"id": "ref-for-read-buffer-bytes\u2460"}, {"id": "ref-for-read-buffer-bytes\u2461"}, {"id": "ref-for-read-buffer-bytes\u2462"}, {"id": "ref-for-read-buffer-bytes\u2463"}, {"id": "ref-for-read-buffer-bytes\u2464"}, {"id": "ref-for-read-buffer-bytes\u2465"}], "title": "5.17.2. Read up to bytes"}, {"refs": [{"id": "ref-for-read-buffer-bytes\u2466"}], "title": "5.17.4. Dump to another stream"}], "external": false};
window.dfnpanelData['augmented-certificate'] = {"dfnID": "augmented-certificate", "url": "#augmented-certificate", "dfnText": "4.3. Augmented Certificate", "refSections": [{"refs": [{"id": "ref-for-augmented-certificate"}, {"id": "ref-for-augmented-certificate"}], "title": "4.3. Augmented Certificate"}], "external": false};
window.dfnpanelData['augmented-certificate-certificate'] = {"dfnID": "augmented-certificate-certificate", "url": "#augmented-certificate-certificate", "dfnText": "certificate", "refSections": [{"refs": [{"id": "ref-for-augmented-certificate-certificate"}, {"id": "ref-for-augmented-certificate-certificate\u2460"}, {"id": "ref-for-augmented-certificate-certificate\u2461"}, {"id": "ref-for-augmented-certificate-certificate\u2462"}], "title": "4.3. Augmented Certificate"}, {"refs": [{"id": "ref-for-augmented-certificate-certificate\u2463"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-augmented-certificate-certificate\u2464"}, {"id": "ref-for-augmented-certificate-certificate\u2465"}, {"id": "ref-for-augmented-certificate-certificate\u2466"}, {"id": "ref-for-augmented-certificate-certificate\u2467"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['augmented-certificate-ocsp-response'] = {"dfnID": "augmented-certificate-ocsp-response", "url": "#augmented-certificate-ocsp-response", "dfnText": "OCSP response", "refSections": [{"refs": [{"id": "ref-for-augmented-certificate-ocsp-response"}, {"id": "ref-for-augmented-certificate-ocsp-response\u2460"}, {"id": "ref-for-augmented-certificate-ocsp-response\u2461"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['augmented-certificate-sct'] = {"dfnID": "augmented-certificate-sct", "url": "#augmented-certificate-sct", "dfnText": "SCT", "refSections": [{"refs": [{"id": "ref-for-augmented-certificate-sct"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['certificate-public-key'] = {"dfnID": "certificate-public-key", "url": "#certificate-public-key", "dfnText": "public\nkey", "refSections": [{"refs": [{"id": "ref-for-certificate-public-key"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-certificate-public-key\u2460"}], "title": "5.7. Validating a signature"}], "external": false};
window.dfnpanelData['public-key-algorithm'] = {"dfnID": "public-key-algorithm", "url": "#public-key-algorithm", "dfnText": "algorithm", "refSections": [{"refs": [{"id": "ref-for-public-key-algorithm"}], "title": "5.7. Validating a signature"}], "external": false};
window.dfnpanelData['certificate-extensions'] = {"dfnID": "certificate-extensions", "url": "#certificate-extensions", "dfnText": "extensions", "refSections": [{"refs": [{"id": "ref-for-certificate-extensions"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['certificate-chain'] = {"dfnID": "certificate-chain", "url": "#certificate-chain", "dfnText": "certificate chain", "refSections": [{"refs": [{"id": "ref-for-certificate-chain"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-certificate-chain\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-certificate-chain\u2461"}, {"id": "ref-for-certificate-chain\u2462"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-certificate-chain\u2463"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['certificate-chain-leaf'] = {"dfnID": "certificate-chain-leaf", "url": "#certificate-chain-leaf", "dfnText": "leaf", "refSections": [{"refs": [{"id": "ref-for-certificate-chain-leaf"}, {"id": "ref-for-certificate-chain-leaf\u2460"}, {"id": "ref-for-certificate-chain-leaf\u2461"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-certificate-chain-leaf\u2462"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-certificate-chain-leaf\u2463"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-certificate-chain-leaf\u2464"}], "title": "5.9. Establishing trust in a certificate"}], "external": false};
window.dfnpanelData['signed-exchange-report'] = {"dfnID": "signed-exchange-report", "url": "#signed-exchange-report", "dfnText": "4.4. Signed Exchange report", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-signed-exchange-report"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-signed-exchange-report\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report\u2462"}], "title": "5.14. Create a new signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-result'] = {"dfnID": "signed-exchange-report-result", "url": "#signed-exchange-report-result", "dfnText": "result", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-result"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report-result\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-signed-exchange-report-result\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report-result\u2462"}, {"id": "ref-for-signed-exchange-report-result\u2463"}, {"id": "ref-for-signed-exchange-report-result\u2464"}, {"id": "ref-for-signed-exchange-report-result\u2465"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-ok'] = {"dfnID": "signed-exchange-report-ok", "url": "#signed-exchange-report-ok", "dfnText": "ok", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-ok"}], "title": "5.15. Wait and queue a report"}, {"refs": [{"id": "ref-for-signed-exchange-report-ok\u2460"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-mi_error'] = {"dfnID": "signed-exchange-report-mi_error", "url": "#signed-exchange-report-mi_error", "dfnText": "mi_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-mi_error"}], "title": "5.15. Wait and queue a report"}], "external": false};
window.dfnpanelData['signed-exchange-report-non_secure_distributor'] = {"dfnID": "signed-exchange-report-non_secure_distributor", "url": "#signed-exchange-report-non_secure_distributor", "dfnText": "non_secure_distributor", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-non_secure_distributor"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['signed-exchange-report-parse_error'] = {"dfnID": "signed-exchange-report-parse_error", "url": "#signed-exchange-report-parse_error", "dfnText": "parse_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-parse_error"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460"}, {"id": "ref-for-signed-exchange-report-parse_error\u2461"}, {"id": "ref-for-signed-exchange-report-parse_error\u2462"}, {"id": "ref-for-signed-exchange-report-parse_error\u2463"}, {"id": "ref-for-signed-exchange-report-parse_error\u2464"}, {"id": "ref-for-signed-exchange-report-parse_error\u2465"}, {"id": "ref-for-signed-exchange-report-parse_error\u2466"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report-parse_error\u2467"}, {"id": "ref-for-signed-exchange-report-parse_error\u2468"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460\u24ea"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460\u2460"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460\u2461"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460\u2462"}, {"id": "ref-for-signed-exchange-report-parse_error\u2460\u2463"}], "title": "5.5. Parsing a Signature Header Field"}], "external": false};
window.dfnpanelData['signed-exchange-report-invalid_integrity_header'] = {"dfnID": "signed-exchange-report-invalid_integrity_header", "url": "#signed-exchange-report-invalid_integrity_header", "dfnText": "invalid_integrity_header", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-invalid_integrity_header"}, {"id": "ref-for-signed-exchange-report-invalid_integrity_header\u2460"}, {"id": "ref-for-signed-exchange-report-invalid_integrity_header\u2461"}], "title": "5.12. Creating the response stream."}], "external": false};
window.dfnpanelData['signed-exchange-report-signature_verification_error'] = {"dfnID": "signed-exchange-report-signature_verification_error", "url": "#signed-exchange-report-signature_verification_error", "dfnText": "signature_verification_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-signature_verification_error"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report-signature_verification_error\u2460"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report-signature_verification_error\u2461"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-cert_verification_error'] = {"dfnID": "signed-exchange-report-cert_verification_error", "url": "#signed-exchange-report-cert_verification_error", "dfnText": "cert_verification_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-cert_verification_error"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert_verification_error\u2460"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-cert_fetch_error'] = {"dfnID": "signed-exchange-report-cert_fetch_error", "url": "#signed-exchange-report-cert_fetch_error", "dfnText": "cert_fetch_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-cert_fetch_error"}, {"id": "ref-for-signed-exchange-report-cert_fetch_error\u2460"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert_fetch_error\u2461"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-cert_parse_error'] = {"dfnID": "signed-exchange-report-cert_parse_error", "url": "#signed-exchange-report-cert_parse_error", "dfnText": "cert_parse_error", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-cert_parse_error"}, {"id": "ref-for-signed-exchange-report-cert_parse_error\u2460"}, {"id": "ref-for-signed-exchange-report-cert_parse_error\u2461"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert_parse_error\u2462"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-outer-request'] = {"dfnID": "signed-exchange-report-outer-request", "url": "#signed-exchange-report-outer-request", "dfnText": "outer request", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-outer-request"}], "title": "5.14. Create a new signed exchange report"}, {"refs": [{"id": "ref-for-signed-exchange-report-outer-request\u2460"}, {"id": "ref-for-signed-exchange-report-outer-request\u2461"}, {"id": "ref-for-signed-exchange-report-outer-request\u2462"}, {"id": "ref-for-signed-exchange-report-outer-request\u2463"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-outer-response'] = {"dfnID": "signed-exchange-report-outer-response", "url": "#signed-exchange-report-outer-response", "dfnText": "outer response", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-outer-response"}], "title": "5.14. Create a new signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-inner-url'] = {"dfnID": "signed-exchange-report-inner-url", "url": "#signed-exchange-report-inner-url", "dfnText": "inner URL", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-inner-url"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-signed-exchange-report-inner-url\u2460"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-cert-url-list'] = {"dfnID": "signed-exchange-report-cert-url-list", "url": "#signed-exchange-report-cert-url-list", "dfnText": "cert URL list", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-cert-url-list"}], "title": "4.4. Signed Exchange report"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert-url-list\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert-url-list\u2461"}, {"id": "ref-for-signed-exchange-report-cert-url-list\u2462"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-server-ip'] = {"dfnID": "signed-exchange-report-server-ip", "url": "#signed-exchange-report-server-ip", "dfnText": "server IP", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-server-ip"}], "title": "5.14. Create a new signed exchange report"}, {"refs": [{"id": "ref-for-signed-exchange-report-server-ip\u2460"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['signed-exchange-report-cert-server-ip-list'] = {"dfnID": "signed-exchange-report-cert-server-ip-list", "url": "#signed-exchange-report-cert-server-ip-list", "dfnText": "cert server IP list", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-report-cert-server-ip-list"}], "title": "5.5.1. Handling the certificate reference"}, {"refs": [{"id": "ref-for-signed-exchange-report-cert-server-ip-list\u2460"}], "title": "5.16. Queuing signed exchange report"}], "external": false};
window.dfnpanelData['exchange-signature'] = {"dfnID": "exchange-signature", "url": "#exchange-signature", "dfnText": "4.5. Exchange Signature", "refSections": [{"refs": [{"id": "ref-for-exchange-signature"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-exchange-signature"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-exchange-signature\u2460"}, {"id": "ref-for-exchange-signature\u2461"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature\u2462"}], "title": "5.6. The signed message"}, {"refs": [{"id": "ref-for-exchange-signature\u2463"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-exchange-signature\u2464"}], "title": "5.8. Cross-origin trust"}, {"refs": [{"id": "ref-for-exchange-signature\u2465"}], "title": "5.12. Creating the response stream."}], "external": false};
window.dfnpanelData['exchange-signature-signature'] = {"dfnID": "exchange-signature-signature", "url": "#exchange-signature-signature", "dfnText": "signature", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-signature"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-exchange-signature-signature\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-signature\u2461"}], "title": "5.7. Validating a signature"}], "external": false};
window.dfnpanelData['exchange-signature-certificate-chain'] = {"dfnID": "exchange-signature-certificate-chain", "url": "#exchange-signature-certificate-chain", "dfnText": "certificate chain", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-certificate-chain"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-exchange-signature-certificate-chain\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-certificate-chain\u2461"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-exchange-signature-certificate-chain\u2462"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['exchange-signature-certsha256'] = {"dfnID": "exchange-signature-certsha256", "url": "#exchange-signature-certsha256", "dfnText": "certSha256", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-certsha256"}, {"id": "ref-for-exchange-signature-certsha256\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-certsha256\u2461"}], "title": "5.6. The signed message"}], "external": false};
window.dfnpanelData['exchange-signature-integrity-header'] = {"dfnID": "exchange-signature-integrity-header", "url": "#exchange-signature-integrity-header", "dfnText": "integrity header", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-integrity-header"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-integrity-header\u2460"}], "title": "5.12. Creating the response stream."}], "external": false};
window.dfnpanelData['exchange-signature-validityurl'] = {"dfnID": "exchange-signature-validityurl", "url": "#exchange-signature-validityurl", "dfnText": "validityUrl", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-validityurl"}], "title": "4.5. Exchange Signature"}, {"refs": [{"id": "ref-for-exchange-signature-validityurl\u2460"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-validityurl\u2461"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['exchange-signature-validityurlbytes'] = {"dfnID": "exchange-signature-validityurlbytes", "url": "#exchange-signature-validityurlbytes", "dfnText": "validityUrlBytes", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-validityurlbytes"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-validityurlbytes\u2460"}, {"id": "ref-for-exchange-signature-validityurlbytes\u2461"}], "title": "5.6. The signed message"}], "external": false};
window.dfnpanelData['exchange-signature-date'] = {"dfnID": "exchange-signature-date", "url": "#exchange-signature-date", "dfnText": "date", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-date"}, {"id": "ref-for-exchange-signature-date\u2460"}, {"id": "ref-for-exchange-signature-date\u2461"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-date\u2462"}], "title": "5.6. The signed message"}, {"refs": [{"id": "ref-for-exchange-signature-date\u2463"}, {"id": "ref-for-exchange-signature-date\u2464"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-exchange-signature-date\u2465"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['exchange-signature-expiration-time'] = {"dfnID": "exchange-signature-expiration-time", "url": "#exchange-signature-expiration-time", "dfnText": "expiration time", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-expiration-time"}], "title": "1.2. Other interesting details"}, {"refs": [{"id": "ref-for-exchange-signature-expiration-time\u2460"}, {"id": "ref-for-exchange-signature-expiration-time\u2461"}, {"id": "ref-for-exchange-signature-expiration-time\u2462"}], "title": "5.5. Parsing a Signature Header Field"}, {"refs": [{"id": "ref-for-exchange-signature-expiration-time\u2463"}], "title": "5.6. The signed message"}, {"refs": [{"id": "ref-for-exchange-signature-expiration-time\u2464"}, {"id": "ref-for-exchange-signature-expiration-time\u2465"}], "title": "5.7. Validating a signature"}, {"refs": [{"id": "ref-for-exchange-signature-expiration-time\u2466"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['allowed-signed-exchange-link-info'] = {"dfnID": "allowed-signed-exchange-link-info", "url": "#allowed-signed-exchange-link-info", "dfnText": "4.6. Allowed signed exchange link info", "refSections": [{"refs": [{"id": "ref-for-allowed-signed-exchange-link-info"}], "title": "4.6. Allowed signed exchange link info"}, {"refs": [{"id": "ref-for-allowed-signed-exchange-link-info"}], "title": "5.19. Get allowed signed exchange link info"}], "external": false};
window.dfnpanelData['allowed-signed-exchange-link-info-target'] = {"dfnID": "allowed-signed-exchange-link-info-target", "url": "#allowed-signed-exchange-link-info-target", "dfnText": "target", "refSections": [{"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-target"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-target\u2460"}, {"id": "ref-for-allowed-signed-exchange-link-info-target\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['allowed-signed-exchange-link-info-header-integrity'] = {"dfnID": "allowed-signed-exchange-link-info-header-integrity", "url": "#allowed-signed-exchange-link-info-header-integrity", "dfnText": "header integrity", "refSections": [{"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-header-integrity"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['allowed-signed-exchange-link-info-variants'] = {"dfnID": "allowed-signed-exchange-link-info-variants", "url": "#allowed-signed-exchange-link-info-variants", "dfnText": "variants", "refSections": [{"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-variants"}, {"id": "ref-for-allowed-signed-exchange-link-info-variants\u2460"}, {"id": "ref-for-allowed-signed-exchange-link-info-variants\u2461"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-variants\u2462"}, {"id": "ref-for-allowed-signed-exchange-link-info-variants\u2463"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['allowed-signed-exchange-link-info-variant-key'] = {"dfnID": "allowed-signed-exchange-link-info-variant-key", "url": "#allowed-signed-exchange-link-info-variant-key", "dfnText": "variant key", "refSections": [{"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-variant-key"}, {"id": "ref-for-allowed-signed-exchange-link-info-variant-key\u2460"}, {"id": "ref-for-allowed-signed-exchange-link-info-variant-key\u2461"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-allowed-signed-exchange-link-info-variant-key\u2462"}, {"id": "ref-for-allowed-signed-exchange-link-info-variant-key\u2463"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link-info'] = {"dfnID": "alternate-signed-exchange-link-info", "url": "#alternate-signed-exchange-link-info", "dfnText": "4.7. Alternate signed exchange link info", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link-info"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-alternate-signed-exchange-link-info"}], "title": "4.7. Alternate signed exchange link info"}, {"refs": [{"id": "ref-for-alternate-signed-exchange-link-info\u2460"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link-info-target'] = {"dfnID": "alternate-signed-exchange-link-info-target", "url": "#alternate-signed-exchange-link-info-target", "dfnText": "target", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link-info-target"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link-info-context'] = {"dfnID": "alternate-signed-exchange-link-info-context", "url": "#alternate-signed-exchange-link-info-context", "dfnText": "context", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link-info-context"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link-info-variants'] = {"dfnID": "alternate-signed-exchange-link-info-variants", "url": "#alternate-signed-exchange-link-info-variants", "dfnText": "variants", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link-info-variants"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
window.dfnpanelData['alternate-signed-exchange-link-info-variant-key'] = {"dfnID": "alternate-signed-exchange-link-info-variant-key", "url": "#alternate-signed-exchange-link-info-variant-key", "dfnText": "variant key", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-link-info-variant-key"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
window.dfnpanelData['alternate-signed-exchange-preload-info'] = {"dfnID": "alternate-signed-exchange-preload-info", "url": "#alternate-signed-exchange-preload-info", "dfnText": "4.8. Alternate signed exchange preload info", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info"}], "title": "4.8. Alternate signed exchange preload info"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-preload-info-link'] = {"dfnID": "alternate-signed-exchange-preload-info-link", "url": "#alternate-signed-exchange-preload-info-link", "dfnText": "link", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info-link"}, {"id": "ref-for-alternate-signed-exchange-preload-info-link\u2460"}, {"id": "ref-for-alternate-signed-exchange-preload-info-link\u2461"}, {"id": "ref-for-alternate-signed-exchange-preload-info-link\u2462"}, {"id": "ref-for-alternate-signed-exchange-preload-info-link\u2463"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info-link\u2464"}], "title": "4.8. Alternate signed exchange preload info"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-preload-info-target'] = {"dfnID": "alternate-signed-exchange-preload-info-target", "url": "#alternate-signed-exchange-preload-info-target", "dfnText": "target", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info-target"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['alternate-signed-exchange-preload-info-prefetched-alternate-exchange'] = {"dfnID": "alternate-signed-exchange-preload-info-prefetched-alternate-exchange", "url": "#alternate-signed-exchange-preload-info-prefetched-alternate-exchange", "dfnText": "prefetched alternate exchange", "refSections": [{"refs": [{"id": "ref-for-alternate-signed-exchange-preload-info-prefetched-alternate-exchange"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['signed-exchange-version'] = {"dfnID": "signed-exchange-version", "url": "#signed-exchange-version", "dfnText": "signed exchange version", "refSections": [{"refs": [{"id": "ref-for-signed-exchange-version"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-signed-exchange-version\u2460"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-signed-exchange-version\u2461"}, {"id": "ref-for-signed-exchange-version\u2462"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['extracting-the-fallback-url'] = {"dfnID": "extracting-the-fallback-url", "url": "#extracting-the-fallback-url", "dfnText": "Extracting the fallback URL", "refSections": [{"refs": [{"id": "ref-for-extracting-the-fallback-url"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-extracting-the-fallback-url\u2460"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['parsing-a-signed-exchange'] = {"dfnID": "parsing-a-signed-exchange", "url": "#parsing-a-signed-exchange", "dfnText": "Parsing a signed exchange", "refSections": [{"refs": [{"id": "ref-for-parsing-a-signed-exchange"}], "title": "2.5. Monkeypatch HTTP fetch"}], "external": false};
window.dfnpanelData['parsing-the-invariant-prefix'] = {"dfnID": "parsing-the-invariant-prefix", "url": "#parsing-the-invariant-prefix", "dfnText": "Parsing the invariant prefix", "refSections": [{"refs": [{"id": "ref-for-parsing-the-invariant-prefix"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-parsing-the-invariant-prefix\u2460"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['parsing-the-signature-header-field'] = {"dfnID": "parsing-the-signature-header-field", "url": "#parsing-the-signature-header-field", "dfnText": "Parsing the Signature header field", "refSections": [{"refs": [{"id": "ref-for-parsing-the-signature-header-field"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['handling-the-certificate-reference'] = {"dfnID": "handling-the-certificate-reference", "url": "#handling-the-certificate-reference", "dfnText": "Handling the certificate reference", "refSections": [{"refs": [{"id": "ref-for-handling-the-certificate-reference"}], "title": "5.5. Parsing a Signature Header Field"}], "external": false};
window.dfnpanelData['signed-message'] = {"dfnID": "signed-message", "url": "#signed-message", "dfnText": "signed message", "refSections": [{"refs": [{"id": "ref-for-signed-message"}], "title": "5.7. Validating a signature"}], "external": false};
window.dfnpanelData['exchange-signature-is-valid'] = {"dfnID": "exchange-signature-is-valid", "url": "#exchange-signature-is-valid", "dfnText": "is valid", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-is-valid"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-exchange-signature-is-valid\u2460"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['exchange-signature-establishes-cross-origin-trust'] = {"dfnID": "exchange-signature-establishes-cross-origin-trust", "url": "#exchange-signature-establishes-cross-origin-trust", "dfnText": "establishes cross-origin trust", "refSections": [{"refs": [{"id": "ref-for-exchange-signature-establishes-cross-origin-trust"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['certificate-chain-has-a-trusted-leaf'] = {"dfnID": "certificate-chain-has-a-trusted-leaf", "url": "#certificate-chain-has-a-trusted-leaf", "dfnText": "has a trusted leaf", "refSections": [{"refs": [{"id": "ref-for-certificate-chain-has-a-trusted-leaf"}], "title": "5.8. Cross-origin trust"}], "external": false};
window.dfnpanelData['parsing-b2-cbor-headers'] = {"dfnID": "parsing-b2-cbor-headers", "url": "#parsing-b2-cbor-headers", "dfnText": "Parsing b2 CBOR headers", "refSections": [{"refs": [{"id": "ref-for-parsing-b2-cbor-headers"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['parsing-b3-cbor-headers'] = {"dfnID": "parsing-b3-cbor-headers", "url": "#parsing-b3-cbor-headers", "dfnText": "Parsing b3 CBOR headers", "refSections": [{"refs": [{"id": "ref-for-parsing-b3-cbor-headers"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['creating-a-header-list-from-the-cbor-map'] = {"dfnID": "creating-a-header-list-from-the-cbor-map", "url": "#creating-a-header-list-from-the-cbor-map", "dfnText": "creating a header list from the CBOR map", "refSections": [{"refs": [{"id": "ref-for-creating-a-header-list-from-the-cbor-map"}, {"id": "ref-for-creating-a-header-list-from-the-cbor-map\u2460"}], "title": "5.10. Parsing b2 CBOR headers"}, {"refs": [{"id": "ref-for-creating-a-header-list-from-the-cbor-map\u2461"}], "title": "5.11. Parsing b3 CBOR headers"}], "external": false};
window.dfnpanelData['reading-a-body'] = {"dfnID": "reading-a-body", "url": "#reading-a-body", "dfnText": "read a body", "refSections": [{"refs": [{"id": "ref-for-reading-a-body"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['matches-the-stored-exchange'] = {"dfnID": "matches-the-stored-exchange", "url": "#matches-the-stored-exchange", "dfnText": "matches the stored exchange", "refSections": [{"refs": [{"id": "ref-for-matches-the-stored-exchange"}], "title": "2.6. Monkeypatch HTTP-network-or-cache fetch"}, {"refs": [{"id": "ref-for-matches-the-stored-exchange\u2460"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-matches-the-stored-exchange\u2461"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['create-a-new-signed-exchange-report'] = {"dfnID": "create-a-new-signed-exchange-report", "url": "#create-a-new-signed-exchange-report", "dfnText": "create a new signed exchange report", "refSections": [{"refs": [{"id": "ref-for-create-a-new-signed-exchange-report"}], "title": "2.5. Monkeypatch HTTP fetch"}], "external": false};
window.dfnpanelData['wait-and-queue-a-report-for'] = {"dfnID": "wait-and-queue-a-report-for", "url": "#wait-and-queue-a-report-for", "dfnText": "wait and queue a report for", "refSections": [{"refs": [{"id": "ref-for-wait-and-queue-a-report-for"}], "title": "2.5. Monkeypatch HTTP fetch"}], "external": false};
window.dfnpanelData['queue-a-signed-exchange-report'] = {"dfnID": "queue-a-signed-exchange-report", "url": "#queue-a-signed-exchange-report", "dfnText": "queue a signed exchange report", "refSections": [{"refs": [{"id": "ref-for-queue-a-signed-exchange-report"}], "title": "2.5. Monkeypatch HTTP fetch"}, {"refs": [{"id": "ref-for-queue-a-signed-exchange-report\u2460"}, {"id": "ref-for-queue-a-signed-exchange-report\u2461"}], "title": "5.15. Wait and queue a report"}], "external": false};
window.dfnpanelData['new-read-buffer'] = {"dfnID": "new-read-buffer", "url": "#new-read-buffer", "dfnText": "new read buffer", "refSections": [{"refs": [{"id": "ref-for-new-read-buffer"}], "title": "5.2. Extracting the fallback URL"}, {"refs": [{"id": "ref-for-new-read-buffer\u2460"}], "title": "5.3. Parsing signed exchanges"}], "external": false};
window.dfnpanelData['read-buffer-reading-up-to'] = {"dfnID": "read-buffer-reading-up-to", "url": "#read-buffer-reading-up-to", "dfnText": "read up to", "refSections": [{"refs": [{"id": "ref-for-read-buffer-reading-up-to"}], "title": "5.17.3. Read bytes"}], "external": false};
window.dfnpanelData['read-buffer-read'] = {"dfnID": "read-buffer-read", "url": "#read-buffer-read", "dfnText": "read", "refSections": [{"refs": [{"id": "ref-for-read-buffer-read"}, {"id": "ref-for-read-buffer-read\u2460"}, {"id": "ref-for-read-buffer-read\u2461"}, {"id": "ref-for-read-buffer-read\u2462"}], "title": "5.3. Parsing signed exchanges"}, {"refs": [{"id": "ref-for-read-buffer-read\u2463"}, {"id": "ref-for-read-buffer-read\u2464"}, {"id": "ref-for-read-buffer-read\u2465"}], "title": "5.4. Parsing the invariant prefix"}], "external": false};
window.dfnpanelData['read-buffer-dump'] = {"dfnID": "read-buffer-dump", "url": "#read-buffer-dump", "dfnText": "Dump", "refSections": [{"refs": [{"id": "ref-for-read-buffer-dump"}], "title": "5.12. Creating the response stream."}], "external": false};
window.dfnpanelData['target-attribute-named'] = {"dfnID": "target-attribute-named", "url": "#target-attribute-named", "dfnText": "Target Attribute named", "refSections": [{"refs": [{"id": "ref-for-target-attribute-named"}, {"id": "ref-for-target-attribute-named\u2460"}, {"id": "ref-for-target-attribute-named\u2461"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-target-attribute-named\u2462"}, {"id": "ref-for-target-attribute-named\u2463"}, {"id": "ref-for-target-attribute-named\u2464"}, {"id": "ref-for-target-attribute-named\u2465"}, {"id": "ref-for-target-attribute-named\u2466"}, {"id": "ref-for-target-attribute-named\u2467"}, {"id": "ref-for-target-attribute-named\u2468"}, {"id": "ref-for-target-attribute-named\u2460\u24ea"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}, {"refs": [{"id": "ref-for-target-attribute-named\u2460\u2460"}, {"id": "ref-for-target-attribute-named\u2460\u2461"}, {"id": "ref-for-target-attribute-named\u2460\u2462"}], "title": "5.19. Get allowed signed exchange link info"}, {"refs": [{"id": "ref-for-target-attribute-named\u2460\u2463"}, {"id": "ref-for-target-attribute-named\u2460\u2464"}], "title": "5.20. Get alternate signed\nexchange link info"}], "external": false};
window.dfnpanelData['getting-allowed-signed-exchange-link-info'] = {"dfnID": "getting-allowed-signed-exchange-link-info", "url": "#getting-allowed-signed-exchange-link-info", "dfnText": "getting allowed signed exchange link info", "refSections": [{"refs": [{"id": "ref-for-getting-allowed-signed-exchange-link-info"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}, {"refs": [{"id": "ref-for-getting-allowed-signed-exchange-link-info\u2460"}], "title": "3.5. \nMonkeypatch Page load processing model for HTML files"}], "external": false};
window.dfnpanelData['getting-alternate-signed-exchange-link-info'] = {"dfnID": "getting-alternate-signed-exchange-link-info", "url": "#getting-alternate-signed-exchange-link-info", "dfnText": "getting alternate signed exchange link info", "refSections": [{"refs": [{"id": "ref-for-getting-alternate-signed-exchange-link-info"}], "title": "3.3. Monkeypatch Link type \"prefetch\""}], "external": false};
</script>
<script>/* Boilerplate: script-dom-helper */
function query(sel) { return document.querySelector(sel); }

function queryAll(sel) { return [...document.querySelectorAll(sel)]; }

function iter(obj) {
	if(!obj) return [];
	var it = obj[Symbol.iterator];
	if(it) return it;
	return Object.entries(obj);
}

function mk(tagname, attrs, ...children) {
	const el = document.createElement(tagname);
	for(const [k,v] of iter(attrs)) {
		if(k.slice(0,3) == "_on") {
			const eventName = k.slice(3);
			el.addEventListener(eventName, v);
		} else if(k[0] == "_") {
			// property, not attribute
			el[k.slice(1)] = v;
		} else {
			if(v === false || v == null) {
        continue;
      } else if(v === true) {
        el.setAttribute(k, "");
        continue;
      } else {
  			el.setAttribute(k, v);
      }
		}
	}
	append(el, children);
	return el;
}

/* Create shortcuts for every known HTML element */
[
  "a",
  "abbr",
  "acronym",
  "address",
  "applet",
  "area",
  "article",
  "aside",
  "audio",
  "b",
  "base",
  "basefont",
  "bdo",
  "big",
  "blockquote",
  "body",
  "br",
  "button",
  "canvas",
  "caption",
  "center",
  "cite",
  "code",
  "col",
  "colgroup",
  "datalist",
  "dd",
  "del",
  "details",
  "dfn",
  "dialog",
  "div",
  "dl",
  "dt",
  "em",
  "embed",
  "fieldset",
  "figcaption",
  "figure",
  "font",
  "footer",
  "form",
  "frame",
  "frameset",
  "head",
  "header",
  "h1",
  "h2",
  "h3",
  "h4",
  "h5",
  "h6",
  "hr",
  "html",
  "i",
  "iframe",
  "img",
  "input",
  "ins",
  "kbd",
  "label",
  "legend",
  "li",
  "link",
  "main",
  "map",
  "mark",
  "meta",
  "meter",
  "nav",
  "nobr",
  "noscript",
  "object",
  "ol",
  "optgroup",
  "option",
  "output",
  "p",
  "param",
  "pre",
  "progress",
  "q",
  "s",
  "samp",
  "script",
  "section",
  "select",
  "small",
  "source",
  "span",
  "strike",
  "strong",
  "style",
  "sub",
  "summary",
  "sup",
  "table",
  "tbody",
  "td",
  "template",
  "textarea",
  "tfoot",
  "th",
  "thead",
  "time",
  "title",
  "tr",
  "u",
  "ul",
  "var",
  "video",
  "wbr",
  "xmp",
].forEach(tagname=>{
	mk[tagname] = (...args) => mk(tagname, ...args);
});

function* nodesFromChildList(children) {
	for(const child of children.flat(Infinity)) {
		if(child instanceof Node) {
			yield child;
		} else {
			yield new Text(child);
		}
	}
}
function append(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		if(el instanceof Node) el.appendChild(child);
		else el.push(child);
	}
	return el;
}

function insertAfter(el, ...children) {
	for(const child of nodesFromChildList(children)) {
		el.parentNode.insertBefore(child, el.nextSibling);
	}
	return el;
}

function clearContents(el) {
	el.innerHTML = "";
	return el;
}

function parseHTML(markup) {
	if(markup.toLowerCase().trim().indexOf('<!doctype') === 0) {
		const doc = document.implementation.createHTMLDocument("");
		doc.documentElement.innerHTML = markup;
		return doc;
	} else {
		const el = mk.template({});
		el.innerHTML = markup;
		return el.content;
	}
}
</script>
<script>/* Boilerplate: script-var-click-highlighting */
/*
Color-choosing design:

Colors are ordered by goodness.
Each color has a usage count (initially zero).
Each variable has a last-used color.

* If the var has a last-used color, and that color's usage is 0,
    return that color.
* Otherwise, return the lowest-indexed color with the lowest usage.
    Increment the color's usage and set it as the last-used color
    for that var.
* On unclicking, decrement usage of the color.
*/
"use strict";
{
    document.addEventListener("click", e=>{
        if(e.target.nodeName == "VAR") {
            highlightSameAlgoVars(e.target);
        }
    });
    const indexCounts = new Map();
    const indexNames = new Map();
    function highlightSameAlgoVars(v) {
        // Find the algorithm container.
        let algoContainer = null;
        let searchEl = v;
        while(algoContainer == null && searchEl != document.body) {
            searchEl = searchEl.parentNode;
            if(searchEl.hasAttribute("data-algorithm")) {
                algoContainer = searchEl;
            }
        }

        // Not highlighting document-global vars,
        // too likely to be unrelated.
        if(algoContainer == null) return;

        const algoName = algoContainer.getAttribute("data-algorithm");
        const varName = getVarName(v);
        const addClass = !v.classList.contains("selected");
        let highlightClass = null;
        if(addClass) {
            const index = chooseHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] += 1;
            indexNames.set(algoName+"///"+varName, index);
            highlightClass = nameFromIndex(index);
        } else {
            const index = previousHighlightIndex(algoName, varName);
            indexCounts.get(algoName)[index] -= 1;
            highlightClass = nameFromIndex(index);
        }

        // Find all same-name vars, and toggle their class appropriately.
        for(const el of algoContainer.querySelectorAll("var")) {
            if(getVarName(el) == varName) {
                el.classList.toggle("selected", addClass);
                el.classList.toggle(highlightClass, addClass);
            }
        }
    }
    function getVarName(el) {
        return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
    }
    function chooseHighlightIndex(algoName, varName) {
        let indexes = null;
        if(indexCounts.has(algoName)) {
            indexes = indexCounts.get(algoName);
        } else {
            // 7 classes right now
            indexes = [0,0,0,0,0,0,0];
            indexCounts.set(algoName, indexes);
        }

        // If the element was recently unclicked,
        // *and* that color is still unclaimed,
        // give it back the same color.
        const lastIndex = previousHighlightIndex(algoName, varName);
        if(indexes[lastIndex] === 0) return lastIndex;

        // Find the earliest index with the lowest count.
        const minCount = Math.min.apply(null, indexes);
        let index = null;
        for(var i = 0; i < indexes.length; i++) {
            if(indexes[i] == minCount) {
                return i;
            }
        }
    }
    function previousHighlightIndex(algoName, varName) {
        return indexNames.get(algoName+"///"+varName);
    }
    function nameFromIndex(index) {
        return "selected" + index;
    }
}
</script>