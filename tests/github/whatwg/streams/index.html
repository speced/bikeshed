<!doctype html><html lang="en">
 <head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="#3c790a" name="theme-color">
  <title>Streams Standard</title>
  <link crossorigin href="https://resources.whatwg.org/spec.css" rel="stylesheet">
  <link crossorigin href="https://resources.whatwg.org/standard.css" rel="stylesheet">
  <link crossorigin href="https://resources.whatwg.org/standard-shared-with-dev.css" rel="stylesheet">
  <link crossorigin href="https://resources.whatwg.org/logo-streams.svg" rel="icon">
<script async crossorigin src="https://resources.whatwg.org/file-issue.js"></script>
<script async crossorigin src="https://resources.whatwg.org/commit-snapshot-shortcut-key.js"></script>
<script crossorigin defer src="https://resources.whatwg.org/standard-mdn-annos.js"></script>
<style>
  div.algorithm + div.algorithm { margin-top: 3em; }
</style>
<style>/* style-issues */

a[href].issue-return {
    float: right;
    float: inline-end;
    color: var(--issueheading-text);
    font-weight: bold;
    text-decoration: none;
}
</style>
<style>/* style-var-click-highlighting */

    var { cursor: pointer; }
    var.selected0 { background-color: #F4D200; box-shadow: 0 0 0 2px #F4D200; }
    var.selected1 { background-color: #FF87A2; box-shadow: 0 0 0 2px #FF87A2; }
    var.selected2 { background-color: #96E885; box-shadow: 0 0 0 2px #96E885; }
    var.selected3 { background-color: #3EEED2; box-shadow: 0 0 0 2px #3EEED2; }
    var.selected4 { background-color: #EACFB6; box-shadow: 0 0 0 2px #EACFB6; }
    var.selected5 { background-color: #82DDFF; box-shadow: 0 0 0 2px #82DDFF; }
    var.selected6 { background-color: #FFBCF2; box-shadow: 0 0 0 2px #FFBCF2; }
    </style>
 <body class="h-entry status-LS">
  <div class="head">
    <a class="logo" href="https://whatwg.org/"> <img alt="WHATWG" crossorigin height="100" src="https://resources.whatwg.org/logo-streams.svg"> </a> 
   <hgroup>
    <h1 class="p-name no-ref" id="title">Streams</h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Living Standard — Last Updated <time class="dt-updated" datetime="1970-01-01">1 January 1970</time></span></h2>
   </hgroup>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Participate:
     <dd><a href="https://github.com/whatwg/streams">GitHub whatwg/streams</a> (<a href="https://github.com/whatwg/streams/issues/new">new issue</a>, <a href="https://github.com/whatwg/streams/issues">open issues</a>)
     <dd><a href="https://whatwg.org/chat">Chat on Matrix</a>
     <dt>Commits:
     <dd><a href="https://github.com/whatwg/streams/commits">GitHub whatwg/streams/commits</a>
     <dd><a href="/commit-snapshots/[COMMIT-SHA]/" id="commit-snapshot-link">Snapshot as of this commit</a>
     <dd><a href="https://twitter.com/streamsstandard">@streamsstandard</a>
     <dt>Tests:
     <dd><a href="https://github.com/web-platform-tests/wpt/tree/master/streams">web-platform-tests streams/</a> (<a href="https://github.com/web-platform-tests/wpt/labels/streams">ongoing work</a>)
     <dt>Translations <small>(non-normative)</small>:
     <dd><span title="Japanese"><a href="https://triple-underscore.github.io/Streams-ja.html" hreflang="ja" lang="ja" rel="alternate">日本語</a></span>
     <dt>Demos:
     <dd><a href="https://streams.spec.whatwg.org/demos/">streams.spec.whatwg.org/demos</a>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>This specification provides APIs for creating, composing, and consuming streams of data

that map efficiently to low-level I/O primitives.</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li>
     <a href="#model"><span class="secno">2</span> <span class="content">Model</span></a>
     <ol class="toc">
      <li><a href="#rs-model"><span class="secno">2.1</span> <span class="content">Readable streams</span></a>
      <li><a href="#ws-model"><span class="secno">2.2</span> <span class="content">Writable streams</span></a>
      <li><a href="#ts-model"><span class="secno">2.3</span> <span class="content">Transform streams</span></a>
      <li><a href="#pipe-chains"><span class="secno">2.4</span> <span class="content">Pipe chains and backpressure</span></a>
      <li><a href="#queuing-strategies"><span class="secno">2.5</span> <span class="content">Internal queues and queuing strategies</span></a>
      <li><a href="#locking"><span class="secno">2.6</span> <span class="content">Locking</span></a>
     </ol>
    <li><a href="#conventions"><span class="secno">3</span> <span class="content">Conventions</span></a>
    <li>
     <a href="#rs"><span class="secno">4</span> <span class="content">Readable streams</span></a>
     <ol class="toc">
      <li><a href="#rs-intro"><span class="secno">4.1</span> <span class="content">Using readable streams</span></a>
      <li>
       <a href="#rs-class"><span class="secno">4.2</span> <span class="content">The <code class="idl"><span>ReadableStream</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#rs-class-definition"><span class="secno">4.2.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#rs-internal-slots"><span class="secno">4.2.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#underlying-source-api"><span class="secno">4.2.3</span> <span class="content">The underlying source API</span></a>
        <li><a href="#rs-prototype"><span class="secno">4.2.4</span> <span class="content">Constructor, methods, and properties</span></a>
        <li><a href="#rs-asynciterator"><span class="secno">4.2.5</span> <span class="content">Asynchronous iteration</span></a>
        <li><a href="#rs-transfer"><span class="secno">4.2.6</span> <span class="content">Transfer via <code>postMessage()</code></span></a>
       </ol>
      <li>
       <a href="#generic-reader-mixin"><span class="secno">4.3</span> <span class="content">The <code class="idl"><span>ReadableStreamGenericReader</span></code> mixin</span></a>
       <ol class="toc">
        <li><a href="#generic-reader-mixin-definition"><span class="secno">4.3.1</span> <span class="content">Mixin definition</span></a>
        <li><a href="#generic-reader-internal-slots"><span class="secno">4.3.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#generic-reader-prototype"><span class="secno">4.3.3</span> <span class="content">Methods and properties</span></a>
       </ol>
      <li>
       <a href="#default-reader-class"><span class="secno">4.4</span> <span class="content">The <code class="idl"><span>ReadableStreamDefaultReader</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#default-reader-class-definition"><span class="secno">4.4.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#default-reader-internal-slots"><span class="secno">4.4.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#default-reader-prototype"><span class="secno">4.4.3</span> <span class="content">Constructor, methods, and properties</span></a>
       </ol>
      <li>
       <a href="#byob-reader-class"><span class="secno">4.5</span> <span class="content">The <code class="idl"><span>ReadableStreamBYOBReader</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#byob-reader-class-definition"><span class="secno">4.5.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#byob-reader-internal-slots"><span class="secno">4.5.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#byob-reader-prototype"><span class="secno">4.5.3</span> <span class="content">Constructor, methods, and properties</span></a>
       </ol>
      <li>
       <a href="#rs-default-controller-class"><span class="secno">4.6</span> <span class="content">The <code class="idl"><span>ReadableStreamDefaultController</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#rs-default-controller-class-definition"><span class="secno">4.6.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#rs-default-controller-internal-slots"><span class="secno">4.6.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#rs-default-controller-prototype"><span class="secno">4.6.3</span> <span class="content">Methods and properties</span></a>
        <li><a href="#rs-default-controller-internal-methods"><span class="secno">4.6.4</span> <span class="content">Internal methods</span></a>
       </ol>
      <li>
       <a href="#rbs-controller-class"><span class="secno">4.7</span> <span class="content">The <code class="idl"><span>ReadableByteStreamController</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#rbs-controller-class-definition"><span class="secno">4.7.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#rbs-controller-internal-slots"><span class="secno">4.7.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#rbs-controller-prototype"><span class="secno">4.7.3</span> <span class="content">Methods and properties</span></a>
        <li><a href="#rbs-controller-internal-methods"><span class="secno">4.7.4</span> <span class="content">Internal methods</span></a>
       </ol>
      <li>
       <a href="#rs-byob-request-class"><span class="secno">4.8</span> <span class="content">The <code class="idl"><span>ReadableStreamBYOBRequest</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#rs-byob-request-class-definition"><span class="secno">4.8.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#rs-byob-request-internal-slots"><span class="secno">4.8.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#rs-byob-request-prototype"><span class="secno">4.8.3</span> <span class="content">Methods and properties</span></a>
       </ol>
      <li>
       <a href="#rs-all-abstract-ops"><span class="secno">4.9</span> <span class="content">Abstract operations</span></a>
       <ol class="toc">
        <li><a href="#rs-abstract-ops"><span class="secno">4.9.1</span> <span class="content">Working with readable streams</span></a>
        <li><a href="#rs-abstract-ops-used-by-controllers"><span class="secno">4.9.2</span> <span class="content">Interfacing with controllers</span></a>
        <li><a href="#rs-reader-abstract-ops"><span class="secno">4.9.3</span> <span class="content">Readers</span></a>
        <li><a href="#rs-default-controller-abstract-ops"><span class="secno">4.9.4</span> <span class="content">Default controllers</span></a>
        <li><a href="#rbs-controller-abstract-ops"><span class="secno">4.9.5</span> <span class="content">Byte stream controllers</span></a>
       </ol>
     </ol>
    <li>
     <a href="#ws"><span class="secno">5</span> <span class="content">Writable streams</span></a>
     <ol class="toc">
      <li><a href="#ws-intro"><span class="secno">5.1</span> <span class="content">Using writable streams</span></a>
      <li>
       <a href="#ws-class"><span class="secno">5.2</span> <span class="content">The <code class="idl"><span>WritableStream</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#ws-class-definition"><span class="secno">5.2.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#ws-internal-slots"><span class="secno">5.2.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#underlying-sink-api"><span class="secno">5.2.3</span> <span class="content">The underlying sink API</span></a>
        <li><a href="#ws-prototype"><span class="secno">5.2.4</span> <span class="content">Constructor, methods, and properties</span></a>
        <li><a href="#ws-transfer"><span class="secno">5.2.5</span> <span class="content">Transfer via <code>postMessage()</code></span></a>
       </ol>
      <li>
       <a href="#default-writer-class"><span class="secno">5.3</span> <span class="content">The <code class="idl"><span>WritableStreamDefaultWriter</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#default-writer-class-definition"><span class="secno">5.3.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#default-writer-internal-slots"><span class="secno">5.3.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#default-writer-prototype"><span class="secno">5.3.3</span> <span class="content">Constructor, methods, and properties</span></a>
       </ol>
      <li>
       <a href="#ws-default-controller-class"><span class="secno">5.4</span> <span class="content">The <code class="idl"><span>WritableStreamDefaultController</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#ws-default-controller-class-definition"><span class="secno">5.4.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#ws-default-controller-internal-slots"><span class="secno">5.4.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#ws-default-controller-prototype"><span class="secno">5.4.3</span> <span class="content">Methods</span></a>
        <li><a href="#ws-default-controller-internal-methods"><span class="secno">5.4.4</span> <span class="content">Internal methods</span></a>
       </ol>
      <li>
       <a href="#ws-all-abstract-ops"><span class="secno">5.5</span> <span class="content">Abstract operations</span></a>
       <ol class="toc">
        <li><a href="#ws-abstract-ops"><span class="secno">5.5.1</span> <span class="content">Working with writable streams</span></a>
        <li><a href="#ws-abstract-ops-used-by-controllers"><span class="secno">5.5.2</span> <span class="content">Interfacing with controllers</span></a>
        <li><a href="#ws-writer-abstract-ops"><span class="secno">5.5.3</span> <span class="content">Writers</span></a>
        <li><a href="#ws-default-controller-abstract-ops"><span class="secno">5.5.4</span> <span class="content">Default controllers</span></a>
       </ol>
     </ol>
    <li>
     <a href="#ts"><span class="secno">6</span> <span class="content">Transform streams</span></a>
     <ol class="toc">
      <li><a href="#ts-intro"><span class="secno">6.1</span> <span class="content">Using transform streams</span></a>
      <li>
       <a href="#ts-class"><span class="secno">6.2</span> <span class="content">The <code class="idl"><span>TransformStream</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#ts-class-definition"><span class="secno">6.2.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#ts-internal-slots"><span class="secno">6.2.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#transformer-api"><span class="secno">6.2.3</span> <span class="content">The transformer API</span></a>
        <li><a href="#ts-prototype"><span class="secno">6.2.4</span> <span class="content">Constructor and properties</span></a>
        <li><a href="#ts-transfer"><span class="secno">6.2.5</span> <span class="content">Transfer via <code>postMessage()</code></span></a>
       </ol>
      <li>
       <a href="#ts-default-controller-class"><span class="secno">6.3</span> <span class="content">The <code class="idl"><span>TransformStreamDefaultController</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#ts-default-controller-class-definition"><span class="secno">6.3.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#ts-default-controller-internal-slots"><span class="secno">6.3.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#ts-default-controller-prototype"><span class="secno">6.3.3</span> <span class="content">Methods and properties</span></a>
       </ol>
      <li>
       <a href="#ts-all-abstract-ops"><span class="secno">6.4</span> <span class="content">Abstract operations</span></a>
       <ol class="toc">
        <li><a href="#ts-abstract-ops"><span class="secno">6.4.1</span> <span class="content">Working with transform streams</span></a>
        <li><a href="#ts-default-controller-abstract-ops"><span class="secno">6.4.2</span> <span class="content">Default controllers</span></a>
        <li><a href="#ts-default-sink-abstract-ops"><span class="secno">6.4.3</span> <span class="content">Default sinks</span></a>
        <li><a href="#ts-default-source-abstract-ops"><span class="secno">6.4.4</span> <span class="content">Default sources</span></a>
       </ol>
     </ol>
    <li>
     <a href="#qs"><span class="secno">7</span> <span class="content">Queuing strategies</span></a>
     <ol class="toc">
      <li><a href="#qs-api"><span class="secno">7.1</span> <span class="content">The queuing strategy API</span></a>
      <li>
       <a href="#blqs-class"><span class="secno">7.2</span> <span class="content">The <code class="idl"><span>ByteLengthQueuingStrategy</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#blqs-class-definition"><span class="secno">7.2.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#blqs-internal-slots"><span class="secno">7.2.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#blqs-prototype"><span class="secno">7.2.3</span> <span class="content">Constructor and properties</span></a>
       </ol>
      <li>
       <a href="#cqs-class"><span class="secno">7.3</span> <span class="content">The <code class="idl"><span>CountQueuingStrategy</span></code> class</span></a>
       <ol class="toc">
        <li><a href="#cqs-class-definition"><span class="secno">7.3.1</span> <span class="content">Interface definition</span></a>
        <li><a href="#cqs-internal-slots"><span class="secno">7.3.2</span> <span class="content">Internal slots</span></a>
        <li><a href="#cqs-prototype"><span class="secno">7.3.3</span> <span class="content">Constructor and properties</span></a>
       </ol>
      <li><a href="#qs-abstract-ops"><span class="secno">7.4</span> <span class="content">Abstract operations</span></a>
     </ol>
    <li>
     <a href="#other-stuff"><span class="secno">8</span> <span class="content">Supporting abstract operations</span></a>
     <ol class="toc">
      <li><a href="#queue-with-sizes"><span class="secno">8.1</span> <span class="content">Queue-with-sizes</span></a>
      <li><a href="#transferrable-streams"><span class="secno">8.2</span> <span class="content">Transferable streams</span></a>
      <li><a href="#misc-abstract-ops"><span class="secno">8.3</span> <span class="content">Miscellaneous</span></a>
     </ol>
    <li>
     <a href="#other-specs"><span class="secno">9</span> <span class="content">Using streams in other specifications</span></a>
     <ol class="toc">
      <li>
       <a href="#other-specs-rs"><span class="secno">9.1</span> <span class="content">Readable streams</span></a>
       <ol class="toc">
        <li><a href="#other-specs-rs-create"><span class="secno">9.1.1</span> <span class="content">Creation and manipulation</span></a>
        <li><a href="#other-specs-rs-reading"><span class="secno">9.1.2</span> <span class="content">Reading</span></a>
        <li><a href="#other-specs-rs-introspect"><span class="secno">9.1.3</span> <span class="content">Introspection</span></a>
       </ol>
      <li>
       <a href="#other-specs-ws"><span class="secno">9.2</span> <span class="content">Writable streams</span></a>
       <ol class="toc">
        <li><a href="#other-specs-ws-creation"><span class="secno">9.2.1</span> <span class="content">Creation</span></a>
        <li><a href="#other-specs-ws-writing"><span class="secno">9.2.2</span> <span class="content">Writing</span></a>
       </ol>
      <li>
       <a href="#other-specs-ts"><span class="secno">9.3</span> <span class="content">Transform streams</span></a>
       <ol class="toc">
        <li><a href="#other-specs-ts-creation"><span class="secno">9.3.1</span> <span class="content">Creation and manipulation</span></a>
        <li><a href="#other-specs-ts-wrapping"><span class="secno">9.3.2</span> <span class="content">Wrapping into a custom class</span></a>
       </ol>
      <li>
       <a href="#other-specs-pairs"><span class="secno">9.4</span> <span class="content">Other stream pairs</span></a>
       <ol class="toc">
        <li><a href="#other-specs-duplex"><span class="secno">9.4.1</span> <span class="content">Duplex streams</span></a>
        <li><a href="#other-specs-endpoints"><span class="secno">9.4.2</span> <span class="content">Endpoint pairs</span></a>
       </ol>
      <li><a href="#other-specs-piping"><span class="secno">9.5</span> <span class="content">Piping</span></a>
     </ol>
    <li>
     <a href="#creating-examples"><span class="secno">10</span> <span class="content">Examples of creating streams</span></a>
     <ol class="toc">
      <li><a href="#example-rs-push-no-backpressure"><span class="secno">10.1</span> <span class="content">A readable stream with an underlying push source (no
backpressure support)</span></a>
      <li><a href="#example-rs-push-backpressure"><span class="secno">10.2</span> <span class="content">A readable stream with an underlying push source and
backpressure support</span></a>
      <li><a href="#example-rbs-push"><span class="secno">10.3</span> <span class="content">A readable byte stream with an underlying push source (no backpressure
support)</span></a>
      <li><a href="#example-rs-pull"><span class="secno">10.4</span> <span class="content">A readable stream with an underlying pull source</span></a>
      <li><a href="#example-rbs-pull"><span class="secno">10.5</span> <span class="content">A readable byte stream with an underlying pull source</span></a>
      <li><a href="#example-ws-no-backpressure"><span class="secno">10.6</span> <span class="content">A writable stream with no backpressure or success signals</span></a>
      <li><a href="#example-ws-backpressure"><span class="secno">10.7</span> <span class="content">A writable stream with backpressure and success signals</span></a>
      <li><a href="#example-both"><span class="secno">10.8</span> <span class="content">A { readable, writable } stream pair wrapping the same underlying
resource</span></a>
      <li><a href="#example-ts-lipfuzz"><span class="secno">10.9</span> <span class="content">A transform stream that replaces template tags</span></a>
      <li><a href="#example-ts-sync-mapper"><span class="secno">10.10</span> <span class="content">A transform stream created from a sync mapper function</span></a>
      <li><a href="#example-identity-transform-usages"><span class="secno">10.11</span> <span class="content">Using an identity transform stream as a primitive to
create new readable streams</span></a>
     </ol>
    <li><a href="#acks"><span class="secno"></span> <span class="content">Acknowledgments</span></a>
    <li><a href="#ipr"><span class="secno"></span> <span class="content">Intellectual property rights</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <div class="non-normative">
    <p><em>This section is non-normative.</em></p>
    <p>Large swathes of the web platform are built on streaming data: that is, data that is created,
processed, and consumed in an incremental fashion, without ever reading all of it into memory. The
Streams Standard provides a common set of APIs for creating and interfacing with such streaming
data, embodied in <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream">readable streams</a>, <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream">writable streams</a>, and <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream">transform streams</a>.</p>
    <p>These APIs have been designed to efficiently map to low-level I/O primitives, including
specializations for byte streams where appropriate. They allow easy composition of multiple streams
into <a data-link-type="dfn" href="#pipe-chain" id="ref-for-pipe-chain">pipe chains</a>, or can be used directly via <a data-link-type="dfn" href="#reader" id="ref-for-reader">readers</a> and <a data-link-type="dfn" href="#writer" id="ref-for-writer">writers</a>. Finally, they are
designed to automatically provide <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure">backpressure</a> and queuing.</p>
    <p>This standard provides the base stream primitives which other parts of the web platform can use to
expose their streaming data. For example, <a data-link-type="biblio" href="#biblio-fetch" title="Fetch Standard">[FETCH]</a> exposes <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#response" id="ref-for-response">Response</a></code> bodies as <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream">ReadableStream</a></code> instances. More generally, the platform is full of streaming abstractions waiting
to be expressed as streams: multimedia streams, file streams, inter-global communication, and more
benefit from being able to process data incrementally instead of buffering it all into memory and
processing it in one go. By providing the foundation for these streams to be exposed to developers,
the Streams Standard enables use cases like:</p>
    <ul>
     <li data-md>
      <p>Video effects: piping a readable video stream through a transform stream that applies effects in
 real time.</p>
     <li data-md>
      <p>Decompression: piping a file stream through a transform stream that selectively decompresses files
 from a <kbd>.tgz</kbd> archive, turning them into <code><a data-link-type="element" href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element">img</a></code> elements as the user scrolls through an
 image gallery.</p>
     <li data-md>
      <p>Image decoding: piping an HTTP response stream through a transform stream that decodes bytes into
 bitmap data, and then through another transform that translates bitmaps into PNGs. If installed
 inside the <code class="idl"><a data-link-type="idl" href="https://w3c.github.io/ServiceWorker/#service-worker-global-scope-fetch-event" id="ref-for-service-worker-global-scope-fetch-event">fetch</a></code> hook of a service worker, this would allow
 developers to transparently polyfill new image formats. <a data-link-type="biblio" href="#biblio-service-workers" title="Service Workers 1">[SERVICE-WORKERS]</a></p>
    </ul>
    <p>Web developers can also use the APIs described here to create their own streams, with the same APIs
as those provided by the platform. Other developers can then transparently compose platform-provided
streams with those supplied by libraries. In this way, the APIs described here provide unifying
abstraction for all streams, encouraging an ecosystem to grow around these shared and composable
interfaces.</p>
   </div>
   <h2 class="heading settled" data-level="2" id="model"><span class="secno">2. </span><span class="content">Model</span><a class="self-link" href="#model"></a></h2>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="chunk">chunk</dfn> is a single piece of data that is written to or read from a stream. It can
be of any type; streams can even contain chunks of different types. A chunk will often not be the
most atomic unit of data for a given stream; for example a byte stream might contain chunks
consisting of 16 KiB <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects">Uint8Array</a></code>s, instead of single bytes.</p>
   <h3 class="heading settled" data-level="2.1" id="rs-model"><span class="secno">2.1. </span><span class="content">Readable streams</span><a class="self-link" href="#rs-model"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="readable-stream">readable stream</dfn> represents a source of data, from which you can read. In other
words, data comes <em>out</em> of a readable stream. Concretely, a readable stream is an instance of the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①">ReadableStream</a></code> class.</p>
   <p>Although a readable stream can be created with arbitrary behavior, most readable streams wrap a
lower-level I/O source, called the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="underlying-source">underlying source</dfn>. There are two types of underlying
source: push sources and pull sources.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="push source" data-noexport id="push-source">Push sources</dfn> push data at you, whether or not you are listening for it.
They may also provide a mechanism for pausing and resuming the flow of data. An example push source
is a TCP socket, where data is constantly being pushed from the OS level, at a rate that can be
controlled by changing the TCP window size.</p>
   <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="pull source" data-noexport id="pull-source">Pull sources</dfn> require you to request data from them. The data may be
available synchronously, e.g. if it is held by the operating system’s in-memory buffers, or
asynchronously, e.g. if it has to be read from disk. An example pull source is a file handle, where
you seek to specific locations and read specific amounts.</p>
   <p>Readable streams are designed to wrap both types of sources behind a single, unified interface. For
web developer–created streams, the implementation details of a source are provided by <a href="#underlying-source-api">an object with certain methods and properties</a> that is passed to
the <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor">ReadableStream()</a></code> constructor.</p>
   <p><a data-link-type="dfn" href="#chunk" id="ref-for-chunk">Chunks</a> are enqueued into the stream by the stream’s <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source">underlying source</a>. They can then be read
one at a time via the stream’s public interface, in particular by using a <a data-link-type="dfn" href="#reader" id="ref-for-reader①">readable stream reader</a> acquired using the stream’s <code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader">getReader()</a></code> method.</p>
   <p>Code that reads from a readable stream using its public interface is known as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="consumer">consumer</dfn>.</p>
   <p>Consumers also have the ability to <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="cancel a readable stream" data-noexport id="cancel-a-readable-stream">cancel</dfn> a readable
stream, using its <code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel">cancel()</a></code> method. This indicates that the consumer has lost
interest in the stream, and will immediately close the stream, throw away any queued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①">chunks</a>, and
execute any cancellation mechanism of the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①">underlying source</a>.</p>
   <p>Consumers can also <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="tee a readable stream" data-noexport id="tee-a-readable-stream">tee</dfn> a readable stream using its <code class="idl"><a data-link-type="idl" href="#rs-tee" id="ref-for-rs-tee">tee()</a></code> method. This will <a data-link-type="dfn" href="#lock" id="ref-for-lock">lock</a> the stream, making it
no longer directly usable; however, it will create two new streams, called <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="branches of a
readable stream tee" data-noexport id="branches-of-a-readable-stream-tee">branches</dfn>, which can be consumed independently.</p>
   <p>For streams representing bytes, an extended version of the <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①">readable stream</a> is provided to handle
bytes efficiently, in particular by minimizing copies. The <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②">underlying source</a> for such a readable
stream is called an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="underlying-byte-source">underlying byte source</dfn>. A readable stream whose underlying source is
an underlying byte source is sometimes called a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="readable-byte-stream">readable byte stream</dfn>. Consumers of a
readable byte stream can acquire a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers">BYOB reader</a> using the stream’s <code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader①">getReader()</a></code> method.</p>
   <h3 class="heading settled" data-level="2.2" id="ws-model"><span class="secno">2.2. </span><span class="content">Writable streams</span><a class="self-link" href="#ws-model"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="writable-stream">writable stream</dfn> represents a destination for data, into which you can write. In
other words, data goes <em>in</em> to a writable stream. Concretely, a writable stream is an
instance of the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream">WritableStream</a></code> class.</p>
   <p>Analogously to readable streams, most writable streams wrap a lower-level I/O sink, called the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="underlying-sink">underlying sink</dfn>. Writable streams work to abstract away some of the complexity of the
underlying sink, by queuing subsequent writes and only delivering them to the underlying sink one by
one.</p>
   <p><a data-link-type="dfn" href="#chunk" id="ref-for-chunk②">Chunks</a> are written to the stream via its public interface, and are passed one at a time to the
stream’s <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink">underlying sink</a>. For web developer-created streams, the implementation details of the
sink are provided by <a href="#underlying-sink-api">an object with certain methods</a> that is
passed to the <code class="idl"><a data-link-type="idl" href="#ws-constructor" id="ref-for-ws-constructor">WritableStream()</a></code> constructor.</p>
   <p>Code that writes into a writable stream using its public interface is known as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="producer">producer</dfn>.</p>
   <p>Producers also have the ability to <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="abort a writable stream" data-noexport id="abort-a-writable-stream">abort</dfn> a writable stream,
using its <code class="idl"><a data-link-type="idl" href="#ws-abort" id="ref-for-ws-abort">abort()</a></code> method. This indicates that the producer believes something has
gone wrong, and that future writes should be discontinued. It puts the stream in an errored state,
even without a signal from the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①">underlying sink</a>, and it discards all writes in the stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues">internal queue</a>.</p>
   <h3 class="heading settled" data-level="2.3" id="ts-model"><span class="secno">2.3. </span><span class="content">Transform streams</span><a class="self-link" href="#ts-model"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="transform-stream">transform stream</dfn> consists of a pair of streams: a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①">writable stream</a>, known as
its <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="writable-side">writable side</dfn>, and a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream②">readable stream</a>, known as its <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="readable side" id="readable-side">readable
side</dfn>. In a manner specific to the transform stream in question, writes to the writable side
result in new data being made available for reading from the readable side.</p>
   <p>Concretely, any object with a <code>writable</code> property and a <code>readable</code> property
can serve as a transform stream. However, the standard <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream">TransformStream</a></code> class makes it much
easier to create such a pair that is properly entangled. It wraps a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="transformer">transformer</dfn>, which
defines algorithms for the specific transformation to be performed. For web developer–created
streams, the implementation details of a transformer are provided by <a href="#transformer-api">an
object with certain methods and properties</a> that is passed to the <code class="idl"><a data-link-type="idl" href="#ts-constructor" id="ref-for-ts-constructor">TransformStream()</a></code> constructor. Other specifications might use the <code class="idl"><a data-link-type="idl" href="#generictransformstream" id="ref-for-generictransformstream">GenericTransformStream</a></code> mixin to create classes
with the same <code>writable</code>/<code>readable</code> property pair but other custom APIs
layered on top.</p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="identity-transform-stream">identity transform stream</dfn> is a type of transform stream which forwards all <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③">chunks</a> written to its <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side">writable side</a> to its <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side">readable side</a>, without any changes. This can
be useful in <a href="#example-transform-identity">a variety of scenarios</a>. By default, the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①">TransformStream</a></code> constructor will create an identity transform stream, when no <code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform">transform()</a></code> method is present on the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer">transformer</a> object.</p>
   <p>Some examples of potential transform streams include:</p>
   <ul>
    <li data-md>
     <p>A GZIP compressor, to which uncompressed bytes are written and from which compressed bytes are
 read;</p>
    <li data-md>
     <p>A video decoder, to which encoded bytes are written and from which uncompressed video frames are
 read;</p>
    <li data-md>
     <p>A text decoder, to which bytes are written and from which strings are read;</p>
    <li data-md>
     <p>A CSV-to-JSON converter, to which strings representing lines of a CSV file are written and from
 which corresponding JavaScript objects are read.</p>
   </ul>
   <h3 class="heading settled" data-level="2.4" id="pipe-chains"><span class="secno">2.4. </span><span class="content">Pipe chains and backpressure</span><a class="self-link" href="#pipe-chains"></a></h3>
   <p>Streams are primarily used by <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="piping">piping</dfn> them to each other. A readable stream can be piped
directly to a writable stream, using its <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to">pipeTo()</a></code> method, or it can be piped
through one or more transform streams first, using its <code class="idl"><a data-link-type="idl" href="#rs-pipe-through" id="ref-for-rs-pipe-through">pipeThrough()</a></code> method.</p>
   <p>A set of streams piped together in this way is referred to as a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pipe-chain">pipe chain</dfn>. In a pipe
chain, the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="original-source">original source</dfn> is the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source③">underlying source</a> of the first readable stream in
the chain; the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="ultimate-sink">ultimate sink</dfn> is the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②">underlying sink</a> of the final writable stream in
the chain.</p>
   <p>Once a pipe chain is constructed, it will propagate signals regarding how fast <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④">chunks</a> should
flow through it. If any step in the chain cannot yet accept chunks, it propagates a signal backwards
through the pipe chain, until eventually the original source is told to stop producing chunks so
fast. This process of normalizing flow from the original source according to how fast the chain can
process chunks is called <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="backpressure">backpressure</dfn>.</p>
   <p>Concretely, the <a data-link-type="dfn" href="#original-source" id="ref-for-original-source">original source</a> is given the <code class="idl"><a data-link-type="idl" href="#rs-default-controller-desired-size" id="ref-for-rs-default-controller-desired-size">controller.desiredSize</a></code> (or <code class="idl"><a data-link-type="idl" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size">byteController.desiredSize</a></code>) value, and can then adjust
its rate of data flow accordingly. This value is derived from the <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size">writer.desiredSize</a></code> corresponding to the <a data-link-type="dfn" href="#ultimate-sink" id="ref-for-ultimate-sink">ultimate
sink</a>, which gets updated as the ultimate sink finishes writing <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤">chunks</a>. The <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to①">pipeTo()</a></code> method used to construct the chain automatically ensures this
information propagates back through the <a data-link-type="dfn" href="#pipe-chain" id="ref-for-pipe-chain①">pipe chain</a>.</p>
   <p>When <a data-link-type="dfn" href="#tee-a-readable-stream" id="ref-for-tee-a-readable-stream">teeing</a> a readable stream, the <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①">backpressure</a> signals from its two <a data-link-type="dfn" href="#branches-of-a-readable-stream-tee" id="ref-for-branches-of-a-readable-stream-tee">branches</a> will aggregate, such that if neither branch is read
from, a backpressure signal will be sent to the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source④">underlying source</a> of the original stream.</p>
   <p>Piping <a data-link-type="dfn" href="#lock" id="ref-for-lock①">locks</a> the readable and writable streams, preventing them from being manipulated for the
duration of the pipe operation. This allows the implementation to perform important optimizations,
such as directly shuttling data from the underlying source to the underlying sink while bypassing
many of the intermediate queues.</p>
   <h3 class="heading settled" data-level="2.5" id="queuing-strategies"><span class="secno">2.5. </span><span class="content">Internal queues and queuing strategies</span><a class="self-link" href="#queuing-strategies"></a></h3>
   <p>Both readable and writable streams maintain <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="internal-queues">internal queues</dfn>, which they use for similar
purposes. In the case of a readable stream, the internal queue contains <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥">chunks</a> that have been
enqueued by the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source⑤">underlying source</a>, but not yet read by the consumer. In the case of a writable
stream, the internal queue contains <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦">chunks</a> which have been written to the stream by the
producer, but not yet processed and acknowledged by the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink③">underlying sink</a>.</p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="queuing-strategy">queuing strategy</dfn> is an object that determines how a stream should signal <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure②">backpressure</a> based on the state of its <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues①">internal queue</a>. The queuing strategy assigns a size
to each <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧">chunk</a>, and compares the total size of all chunks in the queue to a specified number,
known as the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="high-water-mark">high water mark</dfn>. The resulting difference, high water mark minus total size,
is used to determine the <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="desired size to fill a stream’s internal queue" data-noexport id="desired-size-to-fill-a-streams-internal-queue">desired size to
fill the stream’s queue</dfn>.</p>
   <p>For readable streams, an underlying source can use this desired size as a backpressure signal,
slowing down chunk generation so as to try to keep the desired size above or at zero. For writable
streams, a producer can behave similarly, avoiding writes that would cause the desired size to go
negative.</p>
   <p><a href="#qs-api">Concretely</a>, a queuing strategy for web developer–created streams is given by
any JavaScript object with a <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark">highWaterMark</a></code> property. For byte streams the <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark①">highWaterMark</a></code> always has units of bytes. For other streams the default unit is <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑨">chunks</a>, but a <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-size" id="ref-for-dom-queuingstrategy-size">size()</a></code> function can be included in the strategy object
which returns the size for a given chunk. This permits the <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark②">highWaterMark</a></code> to be
specified in arbitrary floating-point units.</p>
   <div class="example" id="example-simple-queuing-strategy">
    <a class="self-link" href="#example-simple-queuing-strategy"></a> A simple example of a queuing strategy would be one that assigns a size of one to each chunk, and
 has a high water mark of three. This would mean that up to three chunks could be enqueued in a
 readable stream, or three chunks written to a writable stream, before the streams are considered to
 be applying backpressure. 
    <p>In JavaScript, such a strategy could be written manually as <code class="highlight"><c- p>{</c-> highWaterMark<c- o>:</c-> <c- mf>3</c-><c- p>,</c-> size<c- p>()</c-> <c- p>{</c-> <c- k>return</c-> <c- mf>1</c-><c- p>;</c-> <c- p>}}</c-></code>, or using the built-in <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy">CountQueuingStrategy</a></code> class, as <code class="highlight"><c- ow>new</c-> CountQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>3</c-> <c- p>})</c-></code>.</p>
   </div>
   <h3 class="heading settled" data-level="2.6" id="locking"><span class="secno">2.6. </span><span class="content">Locking</span><a class="self-link" href="#locking"></a></h3>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="reader|readable stream reader" data-noexport id="reader">readable stream reader</dfn>, or simply reader, is an
object that allows direct reading of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⓪">chunks</a> from a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream③">readable stream</a>. Without a reader, a <a data-link-type="dfn" href="#consumer" id="ref-for-consumer">consumer</a> can only perform high-level operations on the readable stream: <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream">canceling</a> the stream, or <a data-link-type="dfn" href="#piping" id="ref-for-piping">piping</a> the readable stream to a writable stream. A reader is
acquired via the stream’s <code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader②">getReader()</a></code> method.</p>
   <p>A <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream">readable byte stream</a> has the ability to vend two types of readers: <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="default-readers">default readers</dfn> and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="byob-readers">BYOB readers</dfn>. BYOB ("bring your own buffer") readers allow reading into a
developer-supplied buffer, thus minimizing copies. A non-byte readable stream can only vend default
readers. Default readers are instances of the <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader">ReadableStreamDefaultReader</a></code> class, while BYOB
readers are instances of <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader">ReadableStreamBYOBReader</a></code>.</p>
   <p>Similarly, a <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="writer|writable stream writer" data-noexport id="writer">writable stream writer</dfn>, or simply
writer, is an object that allows direct writing of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①①">chunks</a> to a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream②">writable stream</a>. Without a
writer, a <a data-link-type="dfn" href="#producer" id="ref-for-producer">producer</a> can only perform the high-level operations of <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream">aborting</a> the stream or <a data-link-type="dfn" href="#piping" id="ref-for-piping①">piping</a> a readable stream to the writable stream. Writers are
represented by the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter">WritableStreamDefaultWriter</a></code> class.</p>
   <p class="note" role="note">Under the covers, these high-level operations actually use a reader or writer
themselves.</p>
   <p>A given readable or writable stream only has at most one reader or writer at a time. We say in this
case the stream is <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="lock|locked to a reader|locked to a writer" data-noexport id="lock">locked</dfn>, and that the
reader or writer is <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="active|active reader|active writer" data-noexport id="active">active</dfn>. This state can be
determined using the <code class="idl"><a data-link-type="idl" href="#rs-locked" id="ref-for-rs-locked">readableStream.locked</a></code> or <code class="idl"><a data-link-type="idl" href="#ws-locked" id="ref-for-ws-locked">writableStream.locked</a></code> properties.</p>
   <p>A reader or writer also has the capability to <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="release a lock|release a read lock|release a
write lock" data-noexport id="release-a-lock">release its lock</dfn>, which makes it no longer active, and allows further readers or
writers to be acquired. This is done via the <code class="idl"><a data-link-type="idl" href="#default-reader-release-lock" id="ref-for-default-reader-release-lock">defaultReader.releaseLock()</a></code>, <code class="idl"><a data-link-type="idl" href="#byob-reader-release-lock" id="ref-for-byob-reader-release-lock">byobReader.releaseLock()</a></code>, or <code class="idl"><a data-link-type="idl" href="#default-writer-release-lock" id="ref-for-default-writer-release-lock">writer.releaseLock()</a></code> method, as appropriate.</p>
   <h2 class="heading settled" data-level="3" id="conventions"><span class="secno">3. </span><span class="content">Conventions</span><a class="self-link" href="#conventions"></a></h2>
   <p>This specification depends on the Infra Standard. <a data-link-type="biblio" href="#biblio-infra" title="Infra Standard">[INFRA]</a></p>
   <p>This specification uses the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-algorithm-conventions-abstract-operations" id="ref-for-sec-algorithm-conventions-abstract-operations">abstract operation</a> concept from the JavaScript specification for its
internal algorithms. This includes treating their return values as <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-completion-record-specification-type" id="ref-for-sec-completion-record-specification-type">completion records</a>, and the
use of ! and ? prefixes for unwrapping those completion records. <a data-link-type="biblio" href="#biblio-ecmascript" title="ECMAScript Language Specification">[ECMASCRIPT]</a></p>
   <p>This specification also uses the <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots" id="ref-for-sec-object-internal-methods-and-internal-slots">internal slot</a> concept and notation from the JavaScript
specification. (Although, the internal slots are on Web IDL <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-platform-object" id="ref-for-dfn-platform-object">platform objects</a> instead of on
JavaScript objects.)</p>
   <p class="note" role="note">The reasons for the usage of these foreign JavaScript specification conventions are
largely historical. We urge you to avoid following our example when writing your own web
specifications. </p>
   <p>In this specification, all numbers are represented as double-precision 64-bit IEEE 754 floating
point values (like the JavaScript <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type" id="ref-for-sec-ecmascript-language-types-number-type">Number type</a> or Web IDL <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double">unrestricted double</a></code> type), and all
arithmetic operations performed on them must be done in the standard way for such values. This is
particularly important for the data structure described in <a href="#queue-with-sizes">§ 8.1 Queue-with-sizes</a>. <a data-link-type="biblio" href="#biblio-ieee-754" title="IEEE Standard for Floating-Point Arithmetic">[IEEE-754]</a></p>
   <h2 class="heading settled" data-level="4" id="rs"><span class="secno">4. </span><span class="content">Readable streams</span><a class="self-link" href="#rs"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="rs-intro"><span class="secno">4.1. </span><span class="content">Using readable streams</span><a class="self-link" href="#rs-intro"></a></h3>
   <div class="example" id="example-basic-pipe-to">
    <a class="self-link" href="#example-basic-pipe-to"></a> The simplest way to consume a readable stream is to simply <a data-link-type="dfn" href="#piping" id="ref-for-piping②">pipe</a> it to a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream③">writable
 stream</a>. This ensures that <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure③">backpressure</a> is respected, and any errors (either writing or
 reading) are propagated through the chain: 
<pre class="highlight">readableStream<c- p>.</c->pipeTo<c- p>(</c->writableStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully written!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
   </div>
   <div class="example" id="example-pipe-as-chunks-receiver">
    <a class="self-link" href="#example-pipe-as-chunks-receiver"></a> If you simply want to be alerted of each new chunk from a readable stream, you can <a data-link-type="dfn" href="#piping" id="ref-for-piping③">pipe</a> it to a new <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream④">writable stream</a> that you custom-create for that purpose: 
<pre class="highlight">readableStream<c- p>.</c->pipeTo<c- p>(</c-><c- ow>new</c-> WritableStream<c- p>({</c->
  write<c- p>(</c->chunk<c- p>)</c-> <c- p>{</c->
    console<c- p>.</c->log<c- p>(</c-><c- u>"Chunk received"</c-><c- p>,</c-> chunk<c- p>);</c->
  <c- p>},</c->
  close<c- p>()</c-> <c- p>{</c->
    console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully read!"</c-><c- p>);</c->
  <c- p>},</c->
  abort<c- p>(</c->e<c- p>)</c-> <c- p>{</c->
    console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>);</c->
  <c- p>}</c->
<c- p>}));</c->
</pre>
    <p>By returning promises from your <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write">write()</a></code> implementation, you can signal <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure④">backpressure</a> to the readable stream.</p>
   </div>
   <div class="example" id="example-manual-read">
    <a class="self-link" href="#example-manual-read"></a> Although readable streams will usually be used by piping them to a writable stream, you can also
 read them directly by acquiring a <a data-link-type="dfn" href="#reader" id="ref-for-reader②">reader</a> and using its <code>read()</code> method to get
 successive chunks. For example, this code logs the next <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①②">chunk</a> in the stream, if available: 
<pre class="highlight"><c- a>const</c-> reader <c- o>=</c-> readableStream<c- p>.</c->getReader<c- p>();</c->

reader<c- p>.</c->read<c- p>().</c->then<c- p>(</c->
  <c- p>({</c-> value<c- p>,</c-> done <c- p>})</c-> <c- p>=></c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c->done<c- p>)</c-> <c- p>{</c->
      console<c- p>.</c->log<c- p>(</c-><c- u>"The stream was already closed!"</c-><c- p>);</c->
    <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
      console<c- p>.</c->log<c- p>(</c->value<c- p>);</c->
    <c- p>}</c->
  <c- p>},</c->
  e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"The stream became errored and cannot be read from!"</c-><c- p>,</c-> e<c- p>)</c->
<c- p>);</c->
</pre>
    <p>This more manual method of reading a stream is mainly useful for library authors building new
 high-level operations on streams, beyond the provided ones of <a data-link-type="dfn" href="#piping" id="ref-for-piping④">piping</a> and <a data-link-type="dfn" href="#tee-a-readable-stream" id="ref-for-tee-a-readable-stream①">teeing</a>.</p>
   </div>
   <div class="example" id="example-manual-read-bytes">
    <a class="self-link" href="#example-manual-read-bytes"></a> The above example showed using the readable stream’s <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers">default reader</a>. If the stream is a <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①">readable byte stream</a>, you can also acquire a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers①">BYOB reader</a> for it, which allows more
 precise control over buffer allocation in order to avoid copies. For example, this code reads the
 first 1024 bytes from the stream into a single memory buffer: 
<pre class="highlight"><c- a>const</c-> reader <c- o>=</c-> readableStream<c- p>.</c->getReader<c- p>({</c-> mode<c- o>:</c-> <c- u>"byob"</c-> <c- p>});</c->

<c- a>let</c-> startingAB <c- o>=</c-> <c- ow>new</c-> ArrayBuffer<c- p>(</c-><c- mf>1024</c-><c- p>);</c->
<c- a>const</c-> buffer <c- o>=</c-> <c- k>await</c-> readInto<c- p>(</c->startingAB<c- p>);</c->
console<c- p>.</c->log<c- p>(</c-><c- u>"The first 1024 bytes: "</c-><c- p>,</c-> buffer<c- p>);</c->

<c- k>async</c-> <c- a>function</c-> readInto<c- p>(</c->buffer<c- p>)</c-> <c- p>{</c->
  <c- a>let</c-> offset <c- o>=</c-> <c- mf>0</c-><c- p>;</c->

  <c- k>while</c-> <c- p>(</c->offset <c- o>&lt;</c-> buffer<c- p>.</c->byteLength<c- p>)</c-> <c- p>{</c->
    <c- a>const</c-> <c- p>{</c->value<c- o>:</c-> view<c- p>,</c-> done<c- p>}</c-> <c- o>=</c->
     <c- k>await</c-> reader<c- p>.</c->read<c- p>(</c-><c- ow>new</c-> Uint8Array<c- p>(</c->buffer<c- p>,</c-> offset<c- p>,</c-> buffer<c- p>.</c->byteLength <c- o>-</c-> offset<c- p>));</c->
    buffer <c- o>=</c-> view<c- p>.</c->buffer<c- p>;</c->
    <c- k>if</c-> <c- p>(</c->done<c- p>)</c-> <c- p>{</c->
      <c- k>break</c-><c- p>;</c->
    <c- p>}</c->
    offset <c- o>+=</c-> view<c- p>.</c->byteLength<c- p>;</c->
  <c- p>}</c->

  <c- k>return</c-> buffer<c- p>;</c->
<c- p>}</c->
</pre>
    <p>An important thing to note here is that the final <code>buffer</code> value is different from the <code>startingAB</code>, but it (and all intermediate buffers) shares the same backing memory
 allocation. At each step, the buffer is <a href="#transfer-array-buffer" id="ref-for-transfer-array-buffer">transferred</a> to a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects">ArrayBuffer</a></code> object. The <code>view</code> is destructured from the return value of reading a
 new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects①">Uint8Array</a></code>, with that <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects①">ArrayBuffer</a></code> object as its <code>buffer</code> property, the
 offset that bytes were written to as its <code>byteOffset</code> property, and the number of
 bytes that were written as its <code>byteLength</code> property.</p>
   </div>
   <h3 class="heading settled" data-level="4.2" id="rs-class"><span class="secno">4.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②">ReadableStream</a></code> class</span><a class="self-link" href="#rs-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream" title="The ReadableStream interface of the Streams API represents a readable stream of byte data. The Fetch API offers a concrete instance of a ReadableStream through the body property of a Response object.">ReadableStream</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>14+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③">ReadableStream</a></code> class is a concrete instance of the general <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream④">readable stream</a> concept. It
is adaptable to any <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①③">chunk</a> type, and maintains an internal queue to keep track of data supplied
by the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source⑥">underlying source</a> but not yet read by any consumer.</p>
   <h4 class="heading settled" data-level="4.2.1" id="rs-class-definition"><span class="secno">4.2.1. </span><span class="content">Interface definition</span><a class="self-link" href="#rs-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④">ReadableStream</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable" id="ref-for-transferable"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestream"><code><c- g>ReadableStream</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#rs-constructor" id="ref-for-rs-constructor①"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/ReadableStream(underlyingSource, strategy), ReadableStream/constructor(underlyingSource, strategy), ReadableStream/ReadableStream(underlyingSource), ReadableStream/constructor(underlyingSource), ReadableStream/ReadableStream(), ReadableStream/constructor()" data-dfn-type="argument" data-export id="dom-readablestream-readablestream-underlyingsource-strategy-underlyingsource"><code><c- g>underlyingSource</c-></code><a class="self-link" href="#dom-readablestream-readablestream-underlyingsource-strategy-underlyingsource"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy" id="ref-for-dictdef-queuingstrategy"><c- n>QueuingStrategy</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/ReadableStream(underlyingSource, strategy), ReadableStream/constructor(underlyingSource, strategy), ReadableStream/ReadableStream(underlyingSource), ReadableStream/constructor(underlyingSource), ReadableStream/ReadableStream(), ReadableStream/constructor()" data-dfn-type="argument" data-export id="dom-readablestream-readablestream-underlyingsource-strategy-strategy"><code><c- g>strategy</c-></code><a class="self-link" href="#dom-readablestream-readablestream-underlyingsource-strategy-strategy"></a></dfn> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#rs-locked" id="ref-for-rs-locked①"><c- g>locked</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-cancel" id="ref-for-rs-cancel①"><c- g>cancel</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/cancel(reason), ReadableStream/cancel()" data-dfn-type="argument" data-export id="dom-readablestream-cancel-reason-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-readablestream-cancel-reason-reason"></a></dfn>);
  <a data-link-type="idl-name" href="#typedefdef-readablestreamreader" id="ref-for-typedefdef-readablestreamreader"><c- n>ReadableStreamReader</c-></a> <a class="idl-code" data-link-type="method" href="#rs-get-reader" id="ref-for-rs-get-reader③"><c- g>getReader</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-readablestreamgetreaderoptions" id="ref-for-dictdef-readablestreamgetreaderoptions"><c- n>ReadableStreamGetReaderOptions</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/getReader(options), ReadableStream/getReader()" data-dfn-type="argument" data-export id="dom-readablestream-getreader-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-readablestream-getreader-options-options"></a></dfn> = {});
  <a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream⑤"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="method" href="#rs-pipe-through" id="ref-for-rs-pipe-through①"><c- g>pipeThrough</c-></a>(<a data-link-type="idl-name" href="#dictdef-readablewritablepair" id="ref-for-dictdef-readablewritablepair"><c- n>ReadableWritablePair</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/pipeThrough(transform, options), ReadableStream/pipeThrough(transform)" data-dfn-type="argument" data-export id="dom-readablestream-pipethrough-transform-options-transform"><code><c- g>transform</c-></code><a class="self-link" href="#dom-readablestream-pipethrough-transform-options-transform"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-streampipeoptions" id="ref-for-dictdef-streampipeoptions"><c- n>StreamPipeOptions</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/pipeThrough(transform, options), ReadableStream/pipeThrough(transform)" data-dfn-type="argument" data-export id="dom-readablestream-pipethrough-transform-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-readablestream-pipethrough-transform-options-options"></a></dfn> = {});
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-pipe-to" id="ref-for-rs-pipe-to②"><c- g>pipeTo</c-></a>(<a data-link-type="idl-name" href="#writablestream" id="ref-for-writablestream①"><c- n>WritableStream</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/pipeTo(destination, options), ReadableStream/pipeTo(destination)" data-dfn-type="argument" data-export id="dom-readablestream-pipeto-destination-options-destination"><code><c- g>destination</c-></code><a class="self-link" href="#dom-readablestream-pipeto-destination-options-destination"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-streampipeoptions" id="ref-for-dictdef-streampipeoptions①"><c- n>StreamPipeOptions</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream/pipeTo(destination, options), ReadableStream/pipeTo(destination)" data-dfn-type="argument" data-export id="dom-readablestream-pipeto-destination-options-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-readablestream-pipeto-destination-options-options"></a></dfn> = {});
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence" id="ref-for-idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream⑥"><c- n>ReadableStream</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-tee" id="ref-for-rs-tee①"><c- g>tee</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①"><c- b>any</c-></a>>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-readablestreamiteratoroptions" id="ref-for-dictdef-readablestreamiteratoroptions"><c- n>ReadableStreamIteratorOptions</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStream" data-dfn-type="argument" data-export id="dom-readablestream-options"><code><c- g>options</c-></code><a class="self-link" href="#dom-readablestream-options"></a></dfn> = {});
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①"><c- n>ReadableStreamDefaultReader</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①"><c- n>ReadableStreamBYOBReader</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-readablestreamreader"><code><c- g>ReadableStreamReader</c-></code></dfn>;

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-readablestreamreadermode"><code><c- g>ReadableStreamReaderMode</c-></code></dfn> { <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamReaderMode" data-dfn-type="enum-value" data-export id="dom-readablestreamreadermode-byob"><code><c- s>"byob"</c-></code></dfn> };

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-readablestreamgetreaderoptions"><code><c- g>ReadableStreamGetReaderOptions</c-></code></dfn> {
  <a data-link-type="idl-name" href="#enumdef-readablestreamreadermode" id="ref-for-enumdef-readablestreamreadermode"><c- n>ReadableStreamReaderMode</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamGetReaderOptions" data-dfn-type="dict-member" data-export data-type="ReadableStreamReaderMode " id="dom-readablestreamgetreaderoptions-mode"><code><c- g>mode</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-readablestreamiteratoroptions"><code><c- g>ReadableStreamIteratorOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean①"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="ReadableStreamIteratorOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-readablestreamiteratoroptions-preventcancel"><code><c- g>preventCancel</c-></code></dfn> = <c- b>false</c->;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-readablewritablepair"><code><c- g>ReadableWritablePair</c-></code></dfn> {
  <c- b>required</c-> <a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream⑦"><c- n>ReadableStream</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableWritablePair" data-dfn-type="dict-member" data-export data-type="ReadableStream " id="dom-readablewritablepair-readable"><code><c- g>readable</c-></code></dfn>;
  <c- b>required</c-> <a data-link-type="idl-name" href="#writablestream" id="ref-for-writablestream②"><c- n>WritableStream</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableWritablePair" data-dfn-type="dict-member" data-export data-type="WritableStream " id="dom-readablewritablepair-writable"><code><c- g>writable</c-></code></dfn>;
};

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-streampipeoptions"><code><c- g>StreamPipeOptions</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean②"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="StreamPipeOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-streampipeoptions-preventclose"><code><c- g>preventClose</c-></code></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean③"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="StreamPipeOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-streampipeoptions-preventabort"><code><c- g>preventAbort</c-></code></dfn> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean④"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-default="false" data-dfn-for="StreamPipeOptions" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-streampipeoptions-preventcancel"><code><c- g>preventCancel</c-></code></dfn> = <c- b>false</c->;
  <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal"><c- n>AbortSignal</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="StreamPipeOptions" data-dfn-type="dict-member" data-export data-type="AbortSignal " id="dom-streampipeoptions-signal"><code><c- g>signal</c-></code></dfn>;
};
</pre>
   <h4 class="heading settled" data-level="4.2.2" id="rs-internal-slots"><span class="secno">4.2.2. </span><span class="content">Internal slots</span><a class="self-link" href="#rs-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑧">ReadableStream</a></code> are created with the internal slots described in the following
table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-noexport id="readablestream-controller">[[controller]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller">ReadableStreamDefaultController</a></code> or <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller">ReadableByteStreamController</a></code> created with the ability to control the state and queue of this
   stream 
     <tr>
      <td><dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-detached">[[Detached]]<a class="self-link" href="#readablestream-detached"></a></dfn> 
      <td class="non-normative">A boolean flag set to true when the stream is transferred 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-noexport id="readablestream-disturbed">[[disturbed]]</dfn> 
      <td class="non-normative">A boolean flag set to true when the stream has been read from or
   canceled 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-noexport id="readablestream-reader">[[reader]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader②">ReadableStreamDefaultReader</a></code> or <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader②">ReadableStreamBYOBReader</a></code> instance, if the stream is <a data-link-type="dfn" href="#lock" id="ref-for-lock②">locked to a reader</a>, or undefined if it is not 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-noexport id="readablestream-state">[[state]]</dfn> 
      <td class="non-normative">A string containing the stream’s current state, used internally; one
   of "<code>readable</code>", "<code>closed</code>", or "<code>errored</code>" 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-noexport id="readablestream-storederror">[[storedError]]</dfn> 
      <td class="non-normative">A value indicating how the stream failed, to be given as a failure
   reason or exception when trying to operate on an errored stream 
   </table>
   <h4 class="heading settled" data-level="4.2.3" id="underlying-source-api"><span class="secno">4.2.3. </span><span class="content">The underlying source API</span><a class="self-link" href="#underlying-source-api"></a></h4>
   <p>The <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor②">ReadableStream()</a></code> constructor accepts as its first argument a JavaScript object representing
the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source⑦">underlying source</a>. Such objects can contain any of the following properties:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-underlyingsource"><code><c- g>UnderlyingSource</c-></code></dfn> {
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcestartcallback" id="ref-for-callbackdef-underlyingsourcestartcallback"><c- n>UnderlyingSourceStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourceStartCallback " href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcepullcallback" id="ref-for-callbackdef-underlyingsourcepullcallback"><c- n>UnderlyingSourcePullCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourcePullCallback " href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull"><c- g>pull</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcecancelcallback" id="ref-for-callbackdef-underlyingsourcecancelcallback"><c- n>UnderlyingSourceCancelCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourceCancelCallback " href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel"><c- g>cancel</c-></a>;
  <a data-link-type="idl-name" href="#enumdef-readablestreamtype" id="ref-for-enumdef-readablestreamtype"><c- n>ReadableStreamType</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="ReadableStreamType " href="#dom-underlyingsource-type" id="ref-for-dom-underlyingsource-type"><c- g>type</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#EnforceRange" id="ref-for-EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="unsigned long long " href="#dom-underlyingsource-autoallocatechunksize" id="ref-for-dom-underlyingsource-autoallocatechunksize"><c- g>autoAllocateChunkSize</c-></a>;
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①"><c- n>ReadableStreamDefaultController</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①"><c- n>ReadableByteStreamController</c-></a>) <dfn class="dfn-paneled idl-code" data-dfn-type="typedef" data-export id="typedefdef-readablestreamcontroller"><code><c- g>ReadableStreamController</c-></code></dfn>;

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsourcestartcallback"><code><c- g>UnderlyingSourceStartCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#typedefdef-readablestreamcontroller" id="ref-for-typedefdef-readablestreamcontroller"><c- n>ReadableStreamController</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSourceStartCallback" data-dfn-type="argument" data-export id="dom-underlyingsourcestartcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-underlyingsourcestartcallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsourcepullcallback"><code><c- g>UnderlyingSourcePullCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②"><c- b>undefined</c-></a>> (<a data-link-type="idl-name" href="#typedefdef-readablestreamcontroller" id="ref-for-typedefdef-readablestreamcontroller①"><c- n>ReadableStreamController</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSourcePullCallback" data-dfn-type="argument" data-export id="dom-underlyingsourcepullcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-underlyingsourcepullcallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsourcecancelcallback"><code><c- g>UnderlyingSourceCancelCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise③"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined③"><c- b>undefined</c-></a>> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any③"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSourceCancelCallback" data-dfn-type="argument" data-export id="dom-underlyingsourcecancelcallback-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-underlyingsourcecancelcallback-reason"></a></dfn>);

<c- b>enum</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export id="enumdef-readablestreamtype"><code><c- g>ReadableStreamType</c-></code></dfn> { <a class="idl-code" data-link-type="enum-value" href="#dom-readablestreamtype-bytes" id="ref-for-dom-readablestreamtype-bytes"><c- s>"bytes"</c-></a> };
</pre>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSource" data-dfn-type="dict-member" data-export data-lt="start" id="dom-underlyingsource-start"><code>start(<var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsourcestartcallback" id="ref-for-callbackdef-underlyingsourcestartcallback①">UnderlyingSourceStartCallback</a></span>
    <dd>
     <p>A function that is called immediately during creation of the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑨">ReadableStream</a></code>. </p>
     <p>Typically this is used to adapt a <a data-link-type="dfn" href="#push-source" id="ref-for-push-source">push source</a> by setting up relevant event listeners, as
   in the example of <a href="#example-rs-push-no-backpressure">§ 10.1 A readable stream with an underlying push source (no
backpressure support)</a>, or to acquire access to a <a data-link-type="dfn" href="#pull-source" id="ref-for-pull-source">pull source</a>, as in <a href="#example-rs-pull">§ 10.4 A readable stream with an underlying pull source</a>. </p>
     <p>If this setup process is asynchronous, it can return a promise to signal success or failure;
   a rejected promise will error the stream. Any thrown exceptions will be re-thrown by the <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor③">ReadableStream()</a></code> constructor. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSource" data-dfn-type="dict-member" data-export data-lt="pull" id="dom-underlyingsource-pull"><code>pull(<var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsourcepullcallback" id="ref-for-callbackdef-underlyingsourcepullcallback①">UnderlyingSourcePullCallback</a></span>
    <dd>
     <p>A function that is called whenever the stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues②">internal queue</a> of chunks becomes not full,
  i.e. whenever the queue’s <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue">desired size</a> becomes
  positive. Generally, it will be called repeatedly until the queue reaches its <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark">high water mark</a> (i.e. until the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue①">desired size</a> becomes
  non-positive). </p>
     <p>For <a data-link-type="dfn" href="#push-source" id="ref-for-push-source①">push sources</a>, this can be used to resume a paused flow, as in <a href="#example-rs-push-backpressure">§ 10.2 A readable stream with an underlying push source and
backpressure support</a>. For <a data-link-type="dfn" href="#pull-source" id="ref-for-pull-source①">pull sources</a>, it is used to acquire new <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①④">chunks</a> to
  enqueue into the stream, as in <a href="#example-rs-pull">§ 10.4 A readable stream with an underlying pull source</a>. </p>
     <p>This function will not be called until <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start①">start()</a></code> successfully
  completes. Additionally, it will only be called repeatedly if it enqueues at least one chunk or
  fulfills a BYOB request; a no-op <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull①">pull()</a></code> implementation will not be
  continually called. </p>
     <p>If the function returns a promise, then it will not be called again until that promise
  fulfills. (If the promise rejects, the stream will become errored.) This is mainly used in the
  case of pull sources, where the promise returned represents the process of acquiring a new chunk.
  Throwing an exception is treated the same as returning a rejected promise. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSource" data-dfn-type="dict-member" data-export data-lt="cancel" id="dom-underlyingsource-cancel"><code>cancel(<var>reason</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsourcecancelcallback" id="ref-for-callbackdef-underlyingsourcecancelcallback①">UnderlyingSourceCancelCallback</a></span>
    <dd>
     <p>A function that is called whenever the <a data-link-type="dfn" href="#consumer" id="ref-for-consumer①">consumer</a> <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream①">cancels</a> the
  stream, via <code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel②">stream.cancel()</a></code> or <code class="idl"><a data-link-type="idl" href="#generic-reader-cancel" id="ref-for-generic-reader-cancel">reader.cancel()</a></code>. It takes as its argument the same
  value as was passed to those methods by the consumer. </p>
     <p>Readable streams can additionally be canceled under certain conditions during <a data-link-type="dfn" href="#piping" id="ref-for-piping⑤">piping</a>; see
  the definition of the <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to③">pipeTo()</a></code> method for more details. </p>
     <p>For all streams, this is generally used to release access to the underlying resource; see for
  example <a href="#example-rs-push-no-backpressure">§ 10.1 A readable stream with an underlying push source (no
backpressure support)</a>. </p>
     <p>If the shutdown process is asynchronous, it can return a promise to signal success or failure;
  the result will be communicated via the return value of the <code>cancel()</code> method that was called. Additionally, a rejected promise will error the stream, instead of
  letting it close. Throwing an exception is treated the same as returning a rejected promise. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSource" data-dfn-type="dict-member" data-export id="dom-underlyingsource-type"><code>type</code></dfn> (byte streams
 only), <span> of type <a data-link-type="idl-name" href="#enumdef-readablestreamtype" id="ref-for-enumdef-readablestreamtype①">ReadableStreamType</a></span>
    <dd>
     <p>Can be set to "<dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamType" data-dfn-type="enum-value" data-export data-lt="&quot;bytes&quot;|bytes" id="dom-readablestreamtype-bytes"><code>bytes</code></dfn>" to signal that the
  constructed <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⓪">ReadableStream</a></code> is a <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream②">readable byte stream</a>. This ensures that the resulting <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①①">ReadableStream</a></code> will successfully be able to vend <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers②">BYOB readers</a> via its <code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader④">getReader()</a></code> method. It also affects the <var>controller</var> argument passed to the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start②">start()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull②">pull()</a></code> methods; see below. </p>
     <p>For an example of how to set up a readable byte stream, including using the different
  controller interface, see <a href="#example-rbs-push">§ 10.3 A readable byte stream with an underlying push source (no backpressure
support)</a>. </p>
     <p>Setting any value other than "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamtype-bytes" id="ref-for-dom-readablestreamtype-bytes①">bytes</a></code>" or undefined will cause the <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor④">ReadableStream()</a></code> constructor to throw an exception. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSource" data-dfn-type="dict-member" data-export id="dom-underlyingsource-autoallocatechunksize"><code>autoAllocateChunkSize</code></dfn> (byte streams only), <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long①">unsigned long long</a></span>
    <dd>
     <p>Can be set to a positive integer to cause the implementation to automatically allocate buffers
  for the underlying source code to write into. In this case, when a <a data-link-type="dfn" href="#consumer" id="ref-for-consumer②">consumer</a> is using a <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers①">default reader</a>, the stream implementation will automatically allocate an <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects②">ArrayBuffer</a></code> of
  the given size, so that <code class="idl"><a data-link-type="idl" href="#rbs-controller-byob-request" id="ref-for-rbs-controller-byob-request">controller.byobRequest</a></code> is
  always present, as if the consumer was using a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers③">BYOB reader</a>. </p>
     <p>This is generally used to cut down on the amount of code needed to handle consumers that use
  default readers, as can be seen by comparing <a href="#example-rbs-push">§ 10.3 A readable byte stream with an underlying push source (no backpressure
support)</a> without auto-allocation to <a href="#example-rbs-pull">§ 10.5 A readable byte stream with an underlying pull source</a> with auto-allocation. </p>
   </dl>
   <p>The type of the <var>controller</var> argument passed to the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start③">start()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull③">pull()</a></code> methods depends on the value of the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-type" id="ref-for-dom-underlyingsource-type①">type</a></code> option. If <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-type" id="ref-for-dom-underlyingsource-type②">type</a></code> is set to undefined (including via omission), then <var>controller</var> will be a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller②">ReadableStreamDefaultController</a></code>. If it’s set to
"<code class="idl"><a data-link-type="idl" href="#dom-readablestreamtype-bytes" id="ref-for-dom-readablestreamtype-bytes②">bytes</a></code>", then <var>controller</var> will be a <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller②">ReadableByteStreamController</a></code>.</p>
   <h4 class="heading settled" data-level="4.2.4" id="rs-prototype"><span class="secno">4.2.4. </span><span class="content">Constructor, methods, and properties</span><a class="self-link" href="#rs-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>stream</var> = new <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor⑤">ReadableStream</a></code>(<var>underlyingSource</var>[, <var>strategy</var>])</code> 
    <dd>
     <p>Creates a new <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①②">ReadableStream</a></code> wrapping the provided <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source⑧">underlying source</a>. See <a href="#underlying-source-api">§ 4.2.3 The underlying source API</a> for more details on the <var>underlyingSource</var> argument. </p>
     <p>The <var>strategy</var> argument represents the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy">queuing strategy</a>, as described in <a href="#qs-api">§ 7.1 The queuing strategy API</a>. If it is not provided, the default behavior will be the same as a <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy①">CountQueuingStrategy</a></code> with a <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark①">high water mark</a> of 1. </p>
    <dt><code><var>isLocked</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-locked" id="ref-for-rs-locked②">locked</a></code></code> 
    <dd>
     <p>Returns whether or not the readable stream is <a data-link-type="dfn" href="#lock" id="ref-for-lock③">locked to a reader</a>. </p>
    <dt><code>await <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel③">cancel</a></code>([ <var>reason</var> ])</code> 
    <dd>
     <p><a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream②">Cancels</a> the stream, signaling a loss of interest in the stream by
  a consumer. The supplied <var>reason</var> argument will be given to the underlying
  source’s <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel①">cancel()</a></code> method, which might or might not use it. </p>
     <p>The returned promise will fulfill if the stream shuts down successfully, or reject if the
  underlying source signaled that there was an error doing so. Additionally, it will reject with a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror">TypeError</a></code> (without attempting to cancel the stream) if the stream is currently <a data-link-type="dfn" href="#lock" id="ref-for-lock④">locked</a>. </p>
    <dt><code><var>reader</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader⑤">getReader</a></code>()</code> 
    <dd>
     <p>Creates a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader③">ReadableStreamDefaultReader</a></code> and <a data-link-type="dfn" href="#lock" id="ref-for-lock⑤">locks</a> the stream to the
  new reader. While the stream is locked, no other reader can be acquired until this one is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock">released</a>. </p>
     <p>This functionality is especially useful for creating abstractions that desire the ability to
  consume a stream in its entirety. By getting a reader for the stream, you can ensure nobody else
  can interleave reads with yours or cancel the stream, which would interfere with your
  abstraction. </p>
    <dt><code><var>reader</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader⑥">getReader</a></code>({ <code class="idl"><a data-link-type="idl" href="#dom-readablestreamgetreaderoptions-mode" id="ref-for-dom-readablestreamgetreaderoptions-mode">mode</a></code>: "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamreadermode-byob" id="ref-for-dom-readablestreamreadermode-byob">byob</a></code>" })</code> 
    <dd>
     <p>Creates a <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader③">ReadableStreamBYOBReader</a></code> and <a data-link-type="dfn" href="#lock" id="ref-for-lock⑥">locks</a> the stream to the new
   reader. </p>
     <p>This call behaves the same way as the no-argument variant, except that it only works on <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream③">readable byte streams</a>, i.e. streams which were constructed specifically with the ability to
   handle "bring your own buffer" reading. The returned <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers④">BYOB reader</a> provides the ability to
   directly read individual <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⑤">chunks</a> from the stream via its <code class="idl"><a data-link-type="idl" href="#byob-reader-read" id="ref-for-byob-reader-read">read()</a></code> method, into developer-supplied buffers, allowing more precise control over allocation. </p>
    <dt><code><var>readable</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-pipe-through" id="ref-for-rs-pipe-through②">pipeThrough</a></code>({ <code class="idl"><a data-link-type="idl" href="#dom-readablewritablepair-writable" id="ref-for-dom-readablewritablepair-writable">writable</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-readablewritablepair-readable" id="ref-for-dom-readablewritablepair-readable">readable</a></code> }[, { <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventclose" id="ref-for-dom-streampipeoptions-preventclose">preventClose</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort">preventAbort</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel">preventCancel</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-signal" id="ref-for-dom-streampipeoptions-signal">signal</a></code> }])</code>
    <dd>
     <p>Provides a convenient, chainable way of <a data-link-type="dfn" href="#piping" id="ref-for-piping⑥">piping</a> this <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream⑤">readable stream</a> through a <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream①">transform stream</a> (or any other <code>{ writable, readable }</code> pair). It simply pipes the
  stream into the writable side of the supplied pair, and returns the readable side for further use. </p>
     <p>Piping a stream will <a data-link-type="dfn" href="#lock" id="ref-for-lock⑦">lock</a> it for the duration of the pipe, preventing
  any other consumer from acquiring a reader. </p>
    <dt><code>await <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to④">pipeTo</a></code>(<var>destination</var>[, { <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventclose" id="ref-for-dom-streampipeoptions-preventclose①">preventClose</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort①">preventAbort</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel①">preventCancel</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-signal" id="ref-for-dom-streampipeoptions-signal①">signal</a></code> }])</code>
    <dd>
     <p><a data-link-type="dfn" href="#piping" id="ref-for-piping⑦">Pipes</a> this <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream⑥">readable stream</a> to a given <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream⑤">writable stream</a> <var>destination</var>. The
  way in which the piping process behaves under various error conditions can be customized with a
  number of passed options. It returns a promise that fulfills when the piping process completes
  successfully, or rejects if any errors were encountered. </p>
     <p>Piping a stream will <a data-link-type="dfn" href="#lock" id="ref-for-lock⑧">lock</a> it for the duration of the pipe, preventing any
  other consumer from acquiring a reader.</p>
     <p>Errors and closures of the source and destination streams propagate as follows:</p>
     <ul>
      <li data-md>
       <p>An error in this source <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream⑦">readable stream</a> will <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream①">abort</a> <var>destination</var>, unless <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort②">preventAbort</a></code> is truthy. The returned promise will be
 rejected with the source’s error, or with any error that occurs during aborting the destination.</p>
      <li data-md>
       <p>An error in <var>destination</var> will <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream③">cancel</a> this source <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream⑧">readable
 stream</a>, unless <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel②">preventCancel</a></code> is truthy. The returned promise will be
 rejected with the destination’s error, or with any error that occurs during canceling the
 source.</p>
      <li data-md>
       <p>When this source <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream⑨">readable stream</a> closes, <var>destination</var> will be closed, unless <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventclose" id="ref-for-dom-streampipeoptions-preventclose②">preventClose</a></code> is truthy. The returned promise will be fulfilled once this
 process completes, unless an error is encountered while closing the destination, in which case
 it will be rejected with that error.</p>
      <li data-md>
       <p>If <var>destination</var> starts out closed or closing, this source <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⓪">readable stream</a> will be <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream④">canceled</a>, unless <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel③">preventCancel</a></code> is true. The returned
 promise will be rejected with an error indicating piping to a closed stream failed, or with any
 error that occurs during canceling the source.</p>
     </ul>
     <p>The <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-signal" id="ref-for-dom-streampipeoptions-signal②">signal</a></code> option can be set to an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal①">AbortSignal</a></code> to allow aborting an
  ongoing pipe operation via the corresponding <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortcontroller" id="ref-for-abortcontroller">AbortController</a></code>. In this case, this source <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①①">readable stream</a> will be <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream⑤">canceled</a>, and <var>destination</var> <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream②">aborted</a>, unless the respective options <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel④">preventCancel</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort③">preventAbort</a></code> are set. </p>
    <dt><code>[<var>branch1</var>, <var>branch2</var>] = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-tee" id="ref-for-rs-tee②">tee</a></code>()</code> 
    <dd>
     <p><a data-link-type="dfn" href="#tee-a-readable-stream" id="ref-for-tee-a-readable-stream②">Tees</a> this readable stream, returning a two-element array containing
  the two resulting branches as new <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①③">ReadableStream</a></code> instances. </p>
     <p>Teeing a stream will <a data-link-type="dfn" href="#lock" id="ref-for-lock⑨">lock</a> it, preventing any other consumer from
  acquiring a reader. To <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream⑥">cancel</a> the stream, cancel both of the
  resulting branches; a composite cancellation reason will then be propagated to the stream’s <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source⑨">underlying source</a>. </p>
     <p>Note that the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⑥">chunks</a> seen in each branch will be the same object. If the chunks are not
  immutable, this could allow interference between the two branches. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/ReadableStream" title="The ReadableStream() constructor creates and returns a readable stream object from the given handlers.">ReadableStream/ReadableStream</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="ReadableStream(underlyingSource, strategy)" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="constructor" data-export data-lt="ReadableStream(underlyingSource, strategy)|constructor(underlyingSource, strategy)|ReadableStream(underlyingSource)|constructor(underlyingSource)|ReadableStream()|constructor()" id="rs-constructor"><code>new ReadableStream(<var>underlyingSource</var>, <var>strategy</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>If <var>underlyingSource</var> is missing, set it to null.</p>
     <li data-md>
      <p>Let <var>underlyingSourceDict</var> be <var>underlyingSource</var>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value" id="ref-for-dfn-convert-ecmascript-to-idl-value">converted to an IDL value</a> of type <code class="idl"><a data-link-type="idl" href="#dictdef-underlyingsource" id="ref-for-dictdef-underlyingsource">UnderlyingSource</a></code>.</p>
      <p class="note" role="note">We cannot declare the <var>underlyingSource</var> argument as having the <code class="idl"><a data-link-type="idl" href="#dictdef-underlyingsource" id="ref-for-dictdef-underlyingsource①">UnderlyingSource</a></code> type directly, because doing so would lose the reference to the original
  object. We need to retain the object so we can <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function">invoke</a> the various methods on it. </p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-readable-stream" id="ref-for-initialize-readable-stream">InitializeReadableStream</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this">this</a>).</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-type" id="ref-for-dom-underlyingsource-type③">type</a></code>"] is "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamtype-bytes" id="ref-for-dom-readablestreamtype-bytes③">bytes</a></code>":</p>
      <ol>
       <li data-md>
        <p>If <var>strategy</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-size" id="ref-for-dom-queuingstrategy-size①">size</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists">exists</a>, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror">RangeError</a></code> exception.</p>
       <li data-md>
        <p>Let <var>highWaterMark</var> be ? <a data-link-type="abstract-op" href="#validate-and-normalize-high-water-mark" id="ref-for-validate-and-normalize-high-water-mark">ExtractHighWaterMark</a>(<var>strategy</var>, 0).</p>
       <li data-md>
        <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-byte-stream-controller-from-underlying-source" id="ref-for-set-up-readable-byte-stream-controller-from-underlying-source">SetUpReadableByteStreamControllerFromUnderlyingSource</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①">this</a>, <var>underlyingSource</var>, <var>underlyingSourceDict</var>, <var>highWaterMark</var>).</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-type" id="ref-for-dom-underlyingsource-type④">type</a></code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①">exist</a>.</p>
       <li data-md>
        <p>Let <var>sizeAlgorithm</var> be ! <a data-link-type="abstract-op" href="#make-size-algorithm-from-size-function" id="ref-for-make-size-algorithm-from-size-function">ExtractSizeAlgorithm</a>(<var>strategy</var>).</p>
       <li data-md>
        <p>Let <var>highWaterMark</var> be ? <a data-link-type="abstract-op" href="#validate-and-normalize-high-water-mark" id="ref-for-validate-and-normalize-high-water-mark①">ExtractHighWaterMark</a>(<var>strategy</var>, 1).</p>
       <li data-md>
        <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-default-controller-from-underlying-source" id="ref-for-set-up-readable-stream-default-controller-from-underlying-source">SetUpReadableStreamDefaultControllerFromUnderlyingSource</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②">this</a>, <var>underlyingSource</var>, <var>underlyingSourceDict</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/locked" title="The locked read-only property of the ReadableStream interface returns whether or not the readable stream is locked to a reader.">ReadableStream/locked</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>14+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="locked" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="attribute" data-export id="rs-locked"><code>locked</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked">IsReadableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/cancel" title="The cancel() method of the ReadableStream interface returns a Promise that resolves when the stream is canceled.">ReadableStream/cancel</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>14+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="cancel(reason)" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="method" data-export data-lt="cancel(reason)|cancel()" id="rs-cancel"><code>cancel(<var>reason</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①">IsReadableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④">this</a>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel">ReadableStreamCancel</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤">this</a>, <var>reason</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/getReader" title="The getReader() method of the ReadableStream interface creates a reader and locks the stream to it. While the stream is locked, no other reader can be acquired until this one is released. ">ReadableStream/getReader</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>14+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="getReader(options)" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="method" data-export data-lt="getReader(options)|getReader()" id="rs-get-reader"><code>getReader(<var>options</var>)</code></dfn> method steps
 are: 
    <ol>
     <li data-md>
      <p>If <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-readablestreamgetreaderoptions-mode" id="ref-for-dom-readablestreamgetreaderoptions-mode①">mode</a></code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②">exist</a>, return ? <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader">AcquireReadableStreamDefaultReader</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥">this</a>).</p>
     <li data-md>
      <p class="assertion">Assert: <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-readablestreamgetreaderoptions-mode" id="ref-for-dom-readablestreamgetreaderoptions-mode②">mode</a></code>"] is
  "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamreadermode-byob" id="ref-for-dom-readablestreamreadermode-byob①">byob</a></code>".</p>
     <li data-md>
      <p>Return ? <a data-link-type="abstract-op" href="#acquire-readable-stream-byob-reader" id="ref-for-acquire-readable-stream-byob-reader">AcquireReadableStreamBYOBReader</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦">this</a>).</p>
    </ol>
    <div class="example" id="example-read-all-chunks">
     <a class="self-link" href="#example-read-all-chunks"></a> An example of an abstraction that might benefit from using a reader is a function like the
  following, which is designed to read an entire readable stream into memory as an array of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⑦">chunks</a>. 
<pre class="highlight"><c- a>function</c-> readAllChunks<c- p>(</c->readableStream<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> reader <c- o>=</c-> readableStream<c- p>.</c->getReader<c- p>();</c->
  <c- a>const</c-> chunks <c- o>=</c-> <c- p>[];</c->

  <c- k>return</c-> pump<c- p>();</c->

  <c- a>function</c-> pump<c- p>()</c-> <c- p>{</c->
    <c- k>return</c-> reader<c- p>.</c->read<c- p>().</c->then<c- p>(({</c-> value<c- p>,</c-> done <c- p>})</c-> <c- p>=></c-> <c- p>{</c->
      <c- k>if</c-> <c- p>(</c->done<c- p>)</c-> <c- p>{</c->
        <c- k>return</c-> chunks<c- p>;</c->
      <c- p>}</c->

      chunks<c- p>.</c->push<c- p>(</c->value<c- p>);</c->
      <c- k>return</c-> pump<c- p>();</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
     <p>Note how the first thing it does is obtain a reader, and from then on it uses the reader
  exclusively. This ensures that no other consumer can interfere with the stream, either by reading
  chunks or by <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream⑦">canceling</a> the stream.</p>
    </div>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/pipeThrough" title="The pipeThrough() method of the ReadableStream interface provides a chainable way of piping the current stream through a transform stream or any other writable/readable pair.">ReadableStream/pipeThrough</a></p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="pipeThrough(transform, options)" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="method" data-export data-lt="pipeThrough(transform, options)|pipeThrough(transform)" id="rs-pipe-through"><code>pipeThrough(<var>transform</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked②">IsReadableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧">this</a>) is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked">IsWritableStreamLocked</a>(<var>transform</var>["<code class="idl"><a data-link-type="idl" href="#dom-readablewritablepair-writable" id="ref-for-dom-readablewritablepair-writable①">writable</a></code>"]) is true, throw
  a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>signal</var> be <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-signal" id="ref-for-dom-streampipeoptions-signal③">signal</a></code>"] if it <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists③">exists</a>, or undefined
  otherwise.</p>
     <li data-md>
      <p>Let <var>promise</var> be ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to">ReadableStreamPipeTo</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨">this</a>, <var>transform</var>["<code class="idl"><a data-link-type="idl" href="#dom-readablewritablepair-writable" id="ref-for-dom-readablewritablepair-writable②">writable</a></code>"], <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventclose" id="ref-for-dom-streampipeoptions-preventclose③">preventClose</a></code>"], <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort④">preventAbort</a></code>"], <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel⑤">preventCancel</a></code>"], <var>signal</var>).</p>
     <li data-md>
      <p>Set <var>promise</var>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>Return <var>transform</var>["<code class="idl"><a data-link-type="idl" href="#dom-readablewritablepair-readable" id="ref-for-dom-readablewritablepair-readable①">readable</a></code>"].</p>
    </ol>
    <div class="example" id="example-pipe-chain">
     <a class="self-link" href="#example-pipe-chain"></a> A typical example of constructing <a data-link-type="dfn" href="#pipe-chain" id="ref-for-pipe-chain②">pipe chain</a> using <code class="idl"><a data-link-type="idl" href="#rs-pipe-through" id="ref-for-rs-pipe-through③">pipeThrough(transform,
  options)</a></code> would look like 
<pre class="highlight">httpResponseBody
  <c- p>.</c->pipeThrough<c- p>(</c->decompressorTransform<c- p>)</c->
  <c- p>.</c->pipeThrough<c- p>(</c->ignoreNonImageFilesTransform<c- p>)</c->
  <c- p>.</c->pipeTo<c- p>(</c->mediaGallery<c- p>);</c->
</pre>
    </div>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/pipeTo" title="The pipeTo() method of the ReadableStream interface pipes the current ReadableStream to a given WritableStream and returns a Promise that fulfills when the piping process completes successfully, or rejects if any errors were encountered.">ReadableStream/pipeTo</a></p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="pipeTo(destination, options)" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="method" data-export data-lt="pipeTo(destination, options)|pipeTo(destination)" id="rs-pipe-to"><code>pipeTo(<var>destination</var>, <var>options</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked③">IsReadableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪">this</a>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked①">IsWritableStreamLocked</a>(<var>destination</var>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>signal</var> be <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-signal" id="ref-for-dom-streampipeoptions-signal④">signal</a></code>"] if it <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists④">exists</a>, or undefined
  otherwise.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to①">ReadableStreamPipeTo</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①">this</a>, <var>destination</var>, <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventclose" id="ref-for-dom-streampipeoptions-preventclose④">preventClose</a></code>"], <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort⑤">preventAbort</a></code>"], <var>options</var>["<code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel⑥">preventCancel</a></code>"], <var>signal</var>).</p>
    </ol>
    <div class="example" id="example-pipe-abortsignal">
     <a class="self-link" href="#example-pipe-abortsignal"></a> An ongoing <a data-link-type="dfn" href="#readablestream-pipe" id="ref-for-readablestream-pipe">pipe</a> operation can be stopped using an <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal②">AbortSignal</a></code>, as follows: 
<pre class="highlight"><c- a>const</c-> controller <c- o>=</c-> <c- ow>new</c-> AbortController<c- p>();</c->
readable<c- p>.</c->pipeTo<c- p>(</c->writable<c- p>,</c-> <c- p>{</c-> signal<c- o>:</c-> controller<c- p>.</c->signal <c- p>});</c->

<c- c1>// ... some time later ...</c->
controller<c- p>.</c->abort<c- p>();</c->
</pre>
     <p>(The above omits error handling for the promise returned by <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to⑤">pipeTo()</a></code>.
  Additionally, the impact of the <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventabort" id="ref-for-dom-streampipeoptions-preventabort⑥">preventAbort</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-streampipeoptions-preventcancel" id="ref-for-dom-streampipeoptions-preventcancel⑦">preventCancel</a></code> options what happens when piping is stopped are worth
  considering.)</p>
    </div>
    <div class="example" id="example-pipe-switch-dest">
     <a class="self-link" href="#example-pipe-switch-dest"></a> The above technique can be used to switch the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①④">ReadableStream</a></code> being piped, while writing into
  the same <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③">WritableStream</a></code>: 
<pre class="highlight"><c- a>const</c-> controller <c- o>=</c-> <c- ow>new</c-> AbortController<c- p>();</c->
<c- a>const</c-> pipePromise <c- o>=</c-> readable1<c- p>.</c->pipeTo<c- p>(</c->writable<c- p>,</c-> <c- p>{</c-> preventAbort<c- o>:</c-> <c- kc>true</c-><c- p>,</c-> signal<c- o>:</c-> controller<c- p>.</c->signal <c- p>});</c->

<c- c1>// ... some time later ...</c->
controller<c- p>.</c->abort<c- p>();</c->

<c- c1>// Wait for the pipe to complete before starting a new one:</c->
<c- k>try</c-> <c- p>{</c->
 <c- k>await</c-> pipePromise<c- p>;</c->
<c- p>}</c-> <c- k>catch</c-> <c- p>(</c->e<c- p>)</c-> <c- p>{</c->
 <c- c1>// Swallow "AbortError" DOMExceptions as expected, but rethrow any unexpected failures.</c->
 <c- k>if</c-> <c- p>(</c->e<c- p>.</c->name <c- o>!==</c-> <c- u>"AbortError"</c-><c- p>)</c-> <c- p>{</c->
  <c- k>throw</c-> e<c- p>;</c->
 <c- p>}</c->
<c- p>}</c->

<c- c1>// Start the new pipe!</c->
readable2<c- p>.</c->pipeTo<c- p>(</c->writable<c- p>);</c->
</pre>
    </div>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStream/tee" title="The tee() method of the ReadableStream interface tees the current readable stream, returning a two-element array containing the two resulting branches as new ReadableStream instances.">ReadableStream/tee</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>43+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>30+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>43+</span></span><span class="webview_android yes"><span>Android WebView</span><span>43+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>4.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>30+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="tee()" data-algorithm-for="ReadableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStream" data-dfn-type="method" data-export id="rs-tee"><code>tee()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Return ? <a data-link-type="abstract-op" href="#readable-stream-tee" id="ref-for-readable-stream-tee">ReadableStreamTee</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②">this</a>, false).</p>
    </ol>
    <div class="example" id="example-tee-and-pipe">
     <a class="self-link" href="#example-tee-and-pipe"></a> Teeing a stream is most useful when you wish to let two independent consumers read from the stream
  in parallel, perhaps even at different speeds. For example, given a writable stream <code>cacheEntry</code> representing an on-disk file, and another writable stream <code>httpRequestBody</code> representing an upload to a remote server, you could pipe the same
  readable stream to both destinations at once: 
<pre class="highlight"><c- a>const</c-> <c- p>[</c->forLocal<c- p>,</c-> forRemote<c- p>]</c-> <c- o>=</c-> readableStream<c- p>.</c->tee<c- p>();</c->

Promise<c- p>.</c->all<c- p>([</c->
  forLocal<c- p>.</c->pipeTo<c- p>(</c->cacheEntry<c- p>),</c->
  forRemote<c- p>.</c->pipeTo<c- p>(</c->httpRequestBody<c- p>)</c->
<c- p>])</c->
<c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"Saved the stream to the cache and also uploaded it!"</c-><c- p>))</c->
<c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Either caching or uploading failed: "</c-><c- p>,</c-> e<c- p>));</c->
</pre>
    </div>
   </div>
   <h4 class="heading settled" data-level="4.2.5" id="rs-asynciterator"><span class="secno">4.2.5. </span><span class="content">Asynchronous iteration</span><span id="rs-asynciterator-prototype"></span><span id="default-reader-asynciterator-prototype-internal-slots"></span><a class="self-link" href="#rs-asynciterator"></a></h4>
   <dl class="domintro">
    <dt><code>for await (const <var>chunk</var> of <var>stream</var>) { ... }</code> 
    <dt><code>for await (const <var>chunk</var> of <var>stream</var>.values({ <code class="idl"><a data-link-type="idl" href="#dom-readablestreamiteratoroptions-preventcancel" id="ref-for-dom-readablestreamiteratoroptions-preventcancel">preventCancel</a></code>: true })) { ... }</code> 
    <dd>
     <p>Asynchronously iterates over the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⑧">chunks</a> in the stream’s internal queue. </p>
     <p>Asynchronously iterating over the stream will <a data-link-type="dfn" href="#lock" id="ref-for-lock①⓪">lock</a> it, preventing any
  other consumer from acquiring a reader. The lock will be released if the async iterator’s <code>return()</code> method is called, e.g. by <code>break</code>ing out of the loop. </p>
     <p>By default, calling the async iterator’s <code>return()</code> method will also <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream⑧">cancel</a> the stream. To prevent this, use the stream’s <code>values()</code> method, passing true for
  the <code class="idl"><a data-link-type="idl" href="#dom-readablestreamiteratoroptions-preventcancel" id="ref-for-dom-readablestreamiteratoroptions-preventcancel①">preventCancel</a></code> option. </p>
   </dl>
   <div class="algorithm" data-algorithm="ReadableStream asynchronous iterator initialization steps" id="rs-get-iterator">
     The <a data-link-type="dfn" href="https://heycam.github.io/webidl/#asynchronous-iterator-initialization-steps" id="ref-for-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</a> for a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⑤">ReadableStream</a></code>, given <var>stream</var>, <var>iterator</var>, and <var>args</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be ? <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader①">AcquireReadableStreamDefaultReader</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Set <var>iterator</var>’s <dfn class="dfn-paneled" data-dfn-for="ReadableStream async iterator" data-dfn-type="dfn" data-noexport id="readablestream-async-iterator-reader">reader</dfn> to <var>reader</var>.</p>
     <li data-md>
      <p>Let <var>preventCancel</var> be <var>args</var>[0]["<code class="idl"><a data-link-type="idl" href="#dom-readablestreamiteratoroptions-preventcancel" id="ref-for-dom-readablestreamiteratoroptions-preventcancel②">preventCancel</a></code>"].</p>
     <li data-md>
      <p>Set <var>iterator</var>’s <dfn class="dfn-paneled" data-dfn-for="ReadableStream async iterator" data-dfn-type="dfn" data-noexport id="readablestream-async-iterator-prevent-cancel">prevent cancel</dfn> to <var>preventCancel</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStream get the next iteration result" id="rs-asynciterator-prototype-next">
     The <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-get-the-next-iteration-result" id="ref-for-dfn-get-the-next-iteration-result">get the next iteration result</a> steps for a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⑥">ReadableStream</a></code>, given <var>stream</var> and <var>iterator</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be <var>iterator</var>’s <a data-link-type="dfn" href="#readablestream-async-iterator-reader" id="ref-for-readablestream-async-iterator-reader">reader</a>.</p>
     <li data-md>
      <p>If <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑥">TypeError</a></code>.</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise">a new promise</a>.</p>
     <li data-md>
      <p>Let <var>readRequest</var> be a new <a data-link-type="dfn" href="#read-request" id="ref-for-read-request">read request</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item">items</a>:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps">chunk steps</a>, given <var>chunk</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve">Resolve</a> <var>promise</var> with <var>chunk</var>.</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps">close steps</a>
       <dd data-md>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release">ReadableStreamReaderGenericRelease</a>(<var>reader</var>).</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①">Resolve</a> <var>promise</var> with <a data-link-type="dfn" href="https://heycam.github.io/webidl/#end-of-iteration" id="ref-for-end-of-iteration">end of iteration</a>.</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps">error steps</a>, given <var>e</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release①">ReadableStreamReaderGenericRelease</a>(<var>reader</var>).</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject">Reject</a> <var>promise</var> with <var>e</var>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-reader-read" id="ref-for-readable-stream-default-reader-read">ReadableStreamDefaultReaderRead</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①③">this</a>, <var>readRequest</var>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStream asynchronous iterator return" id="rs-asynciterator-prototype-return">
     The <a data-link-type="dfn" href="https://heycam.github.io/webidl/#asynchronous-iterator-return" id="ref-for-asynchronous-iterator-return">asynchronous iterator return</a> steps for a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⑦">ReadableStream</a></code>, given <var>stream</var>, <var>iterator</var>, and <var>arg</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be <var>iterator</var>’s <a data-link-type="dfn" href="#readablestream-async-iterator-reader" id="ref-for-readablestream-async-iterator-reader①">reader</a>.</p>
     <li data-md>
      <p>If <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with">a promise resolved
  with</a> undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests">[[readRequests]]</a> is <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty">empty</a>,
  as the async iterator machinery guarantees that any previous calls to <code>next()</code> have settled
  before this is called.</p>
     <li data-md>
      <p>If <var>iterator</var>’s <a data-link-type="dfn" href="#readablestream-async-iterator-prevent-cancel" id="ref-for-readablestream-async-iterator-prevent-cancel">prevent cancel</a> is false:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-cancel" id="ref-for-readable-stream-reader-generic-cancel">ReadableStreamReaderGenericCancel</a>(<var>reader</var>, <var>arg</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release②">ReadableStreamReaderGenericRelease</a>(<var>reader</var>).</p>
       <li data-md>
        <p>Return <var>result</var>.</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release③">ReadableStreamReaderGenericRelease</a>(<var>reader</var>).</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①">a promise resolved with</a> undefined.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.2.6" id="rs-transfer"><span class="secno">4.2.6. </span><span class="content">Transfer via <code>postMessage()</code></span><a class="self-link" href="#rs-transfer"></a></h4>
   <dl class="domintro">
    <dt><code>destination.postMessage(rs, { transfer: [rs] });</code> 
    <dd>
     <p>Sends a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⑧">ReadableStream</a></code> to another frame, window, or worker. </p>
     <p>The transferred stream can be used exactly like the original. The original will become <a data-link-type="dfn" href="#lock" id="ref-for-lock①①">locked</a> and no longer directly usable. </p>
   </dl>
   <div class="algorithm" data-algorithm="ReadableStream transfer steps">
     <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream①⑨">ReadableStream</a></code> objects are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects" id="ref-for-transferable-objects">transferable objects</a>. Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-steps" id="ref-for-transfer-steps">transfer steps</a>, given <var>value</var> and <var>dataHolder</var>, are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked④">IsReadableStreamLocked</a>(<var>value</var>) is true, throw a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException">DOMException</a></code>.</p>
     <li data-md>
      <p>Let <var>port1</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new">new</a> <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport">MessagePort</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm">the current Realm</a>.</p>
     <li data-md>
      <p>Let <var>port2</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①">new</a> <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport①">MessagePort</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①">the current Realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#entangle" id="ref-for-entangle">Entangle</a> <var>port1</var> and <var>port2</var>.</p>
     <li data-md>
      <p>Let <var>writable</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②">new</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream④">WritableStream</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm②">the current Realm</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-setupcrossrealmtransformwritable" id="ref-for-abstract-opdef-setupcrossrealmtransformwritable">SetUpCrossRealmTransformWritable</a>(<var>writable</var>, <var>port1</var>).</p>
     <li data-md>
      <p>Let <var>promise</var> be ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to②">ReadableStreamPipeTo</a>(<var>value</var>, <var>writable</var>, false, false, false).</p>
     <li data-md>
      <p>Set <var>promise</var>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>Set <var>dataHolder</var>.[[port]] to ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer">StructuredSerializeWithTransfer</a>(<var>port2</var>, « <var>port2</var> »).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStream transfer-receiving steps">
     Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-receiving-steps" id="ref-for-transfer-receiving-steps">transfer-receiving steps</a>, given <var>dataHolder</var> and <var>value</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>deserializedRecord</var> be ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer" id="ref-for-structureddeserializewithtransfer">StructuredDeserializeWithTransfer</a>(<var>dataHolder</var>.[[port]], <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm③">the current Realm</a>).</p>
     <li data-md>
      <p>Let <var>port</var> be <var>deserializedRecord</var>.[[Deserialized]].</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-setupcrossrealmtransformreadable" id="ref-for-abstract-opdef-setupcrossrealmtransformreadable">SetUpCrossRealmTransformReadable</a>(<var>value</var>, <var>port</var>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.3" id="generic-reader-mixin"><span class="secno">4.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader">ReadableStreamGenericReader</a></code> mixin</span><a class="self-link" href="#generic-reader-mixin"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader①">ReadableStreamGenericReader</a></code> mixin defines common internal slots, getters and methods that
are shared between <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader④">ReadableStreamDefaultReader</a></code> and <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader④">ReadableStreamBYOBReader</a></code> objects.</p>
   <h4 class="heading settled" data-level="4.3.1" id="generic-reader-mixin-definition"><span class="secno">4.3.1. </span><span class="content">Mixin definition</span><a class="self-link" href="#generic-reader-mixin-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader②">ReadableStreamGenericReader</a></code> mixin is given as follows:</p>
<pre class="idl highlight def"><c- b>interface</c-> <c- b>mixin</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestreamgenericreader"><code><c- g>ReadableStreamGenericReader</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise④"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined④"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#generic-reader-closed" id="ref-for-generic-reader-closed"><c- g>closed</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined⑤"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#generic-reader-cancel" id="ref-for-generic-reader-cancel①"><c- g>cancel</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any④"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamGenericReader/cancel(reason), ReadableStreamGenericReader/cancel()" data-dfn-type="argument" data-export id="dom-readablestreamgenericreader-cancel-reason-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-readablestreamgenericreader-cancel-reason-reason"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="4.3.2" id="generic-reader-internal-slots"><span class="secno">4.3.2. </span><span class="content">Internal slots</span><a class="self-link" href="#generic-reader-internal-slots"></a></h4>
   <p>Instances of classes including the <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader③">ReadableStreamGenericReader</a></code> mixin are created with the
internal slots described in the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamGenericReader" data-dfn-type="dfn" data-noexport id="readablestreamgenericreader-closedpromise">[[closedPromise]]</dfn> 
      <td class="non-normative">A promise returned by the reader’s <code class="idl"><a data-link-type="idl" href="#generic-reader-closed" id="ref-for-generic-reader-closed①">closed</a></code> getter 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamGenericReader" data-dfn-type="dfn" data-noexport id="readablestreamgenericreader-stream">[[stream]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⓪">ReadableStream</a></code> instance that owns this reader 
   </table>
   <h4 class="heading settled" data-level="4.3.3" id="generic-reader-prototype"><span class="secno">4.3.3. </span><span class="content">Methods and properties</span><a class="self-link" href="#generic-reader-prototype"></a></h4>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader/closed" title="The closed read-only property of the ReadableStreamBYOBReader interface returns a Promise that fulfills when the stream closes or the reader&apos;s lock is released, or rejects if the stream throws an error. This property enables you to write code that responds to an end to the streaming process.">ReadableStreamBYOBReader/closed</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader/closed" title="The closed read-only property of the ReadableStreamDefaultReader interface returns a Promise that fulfills when the stream closes or the reader&apos;s lock is released, or rejects if the stream throws an error. This property enables you to write code that responds to an end to the streaming process.">ReadableStreamDefaultReader/closed</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="closed" data-algorithm-for="ReadableStreamGenericReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamGenericReader" data-dfn-type="attribute" data-export id="generic-reader-closed"><code><code>closed</code><span id="default-reader-closed"></span><span id="byob-reader-closed"></span></code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①④">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise">[[closedPromise]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader/cancel" title="The cancel() method of the ReadableStreamBYOBReader interface returns a Promise that resolves when the stream is canceled. Calling this method signals a loss of interest in the stream by a consumer.">ReadableStreamBYOBReader/cancel</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader/cancel" title="The cancel() method of the ReadableStreamDefaultReader interface returns a Promise that resolves when the stream is canceled. Calling this method signals a loss of interest in the stream by a consumer.">ReadableStreamDefaultReader/cancel</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="cancel(reason)" data-algorithm-for="ReadableStreamGenericReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamGenericReader" data-dfn-type="method" data-export data-lt="cancel(reason)|cancel()" id="generic-reader-cancel"><code><code>cancel(<var>reason</var>)</code><span id="default-reader-cancel"></span><span id="byob-reader-cancel"></span></code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⑤">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream②">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with④">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑦">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-cancel" id="ref-for-readable-stream-reader-generic-cancel①">ReadableStreamReaderGenericCancel</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⑥">this</a>, <var>reason</var>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.4" id="default-reader-class"><span class="secno">4.4. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader⑤">ReadableStreamDefaultReader</a></code> class</span><a class="self-link" href="#default-reader-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader" title="The ReadableStreamDefaultReader interface of the Streams API represents a default reader that can be used to read stream data supplied from a network (e.g. a fetch request). ">ReadableStreamDefaultReader</a></p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>52+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>39+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>52+</span></span><span class="webview_android yes"><span>Android WebView</span><span>52+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>6.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader⑥">ReadableStreamDefaultReader</a></code> class represents a <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers②">default reader</a> designed to be vended by a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②①">ReadableStream</a></code> instance.</p>
   <h4 class="heading settled" data-level="4.4.1" id="default-reader-class-definition"><span class="secno">4.4.1. </span><span class="content">Interface definition</span><a class="self-link" href="#default-reader-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader⑦">ReadableStreamDefaultReader</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestreamdefaultreader"><code><c- g>ReadableStreamDefaultReader</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#default-reader-constructor" id="ref-for-default-reader-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream②②"><c- n>ReadableStream</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamDefaultReader/ReadableStreamDefaultReader(stream), ReadableStreamDefaultReader/constructor(stream)" data-dfn-type="argument" data-export id="dom-readablestreamdefaultreader-readablestreamdefaultreader-stream-stream"><code><c- g>stream</c-></code><a class="self-link" href="#dom-readablestreamdefaultreader-readablestreamdefaultreader-stream-stream"></a></dfn>);

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise⑥"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-readablestreamdefaultreadresult" id="ref-for-dictdef-readablestreamdefaultreadresult"><c- n>ReadableStreamDefaultReadResult</c-></a>> <a class="idl-code" data-link-type="method" href="#default-reader-read" id="ref-for-default-reader-read"><c- g>read</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined⑥"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#default-reader-release-lock" id="ref-for-default-reader-release-lock①"><c- g>releaseLock</c-></a>();
};
<a data-link-type="idl-name" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader⑧"><c- n>ReadableStreamDefaultReader</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader④"><c- n>ReadableStreamGenericReader</c-></a>;

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-readablestreamdefaultreadresult"><code><c- g>ReadableStreamDefaultReadResult</c-></code></dfn> {
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any⑤"><c- b>any</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultReadResult" data-dfn-type="dict-member" data-export data-type="any " id="dom-readablestreamdefaultreadresult-value"><code><c- g>value</c-></code></dfn>;
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑤"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultReadResult" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-readablestreamdefaultreadresult-done"><code><c- g>done</c-></code></dfn>;
};
</pre>
   <h4 class="heading settled" data-level="4.4.2" id="default-reader-internal-slots"><span class="secno">4.4.2. </span><span class="content">Internal slots</span><a class="self-link" href="#default-reader-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader⑨">ReadableStreamDefaultReader</a></code> are created with the internal slots defined by <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader⑤">ReadableStreamGenericReader</a></code>, and those described in the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="dfn" data-noexport id="readablestreamdefaultreader-readrequests">[[readRequests]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list">list</a> of <a data-link-type="dfn" href="#read-request" id="ref-for-read-request①">read requests</a>, used when a <a data-link-type="dfn" href="#consumer" id="ref-for-consumer③">consumer</a> requests <a data-link-type="dfn" href="#chunk" id="ref-for-chunk①⑨">chunks</a> sooner than they are available 
   </table>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="read-request">read request</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct">struct</a> containing three algorithms to perform in reaction
to filling the <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①②">readable stream</a>'s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues③">internal queue</a> or changing its state. It has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read request" data-dfn-type="dfn" data-export id="read-request-chunk-steps">chunk steps</dfn>
    <dd data-md>
     <p>An algorithm taking a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⓪">chunk</a>, called when a chunk is available for reading</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read request" data-dfn-type="dfn" data-export id="read-request-close-steps">close steps</dfn>
    <dd data-md>
     <p>An algorithm taking no arguments, called when no <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②①">chunks</a> are available because the stream is
  closed</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read request" data-dfn-type="dfn" data-export id="read-request-error-steps">error steps</dfn>
    <dd data-md>
     <p>An algorithm taking a JavaScript value, called when no <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②②">chunks</a> are available because the
  stream is errored</p>
   </dl>
   <h4 class="heading settled" data-level="4.4.3" id="default-reader-prototype"><span class="secno">4.4.3. </span><span class="content">Constructor, methods, and properties</span><a class="self-link" href="#default-reader-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>reader</var> = new <code class="idl"><a data-link-type="idl" href="#default-reader-constructor" id="ref-for-default-reader-constructor①">ReadableStreamDefaultReader</a></code>(<var>stream</var>)</code> 
    <dd>
     <p>This is equivalent to calling <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader⑦">getReader()</a></code></code>. </p>
    <dt><code>await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#generic-reader-closed" id="ref-for-generic-reader-closed②">closed</a></code></code> 
    <dd>
     <p>Returns a promise that will be fulfilled when the stream becomes closed, or rejected if the
  stream ever errors or the reader’s lock is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock①">released</a> before the stream
  finishes closing. </p>
    <dt><code>await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#generic-reader-cancel" id="ref-for-generic-reader-cancel②">cancel</a></code>([ <var>reason</var> ])</code> 
    <dd>
     <p>If the reader is <a data-link-type="dfn" href="#active" id="ref-for-active">active</a>, behaves the same as <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel④">cancel</a></code>(<var>reason</var>)</code>. </p>
    <dt><code>{ <var>value</var>, <var>done</var> } = await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#default-reader-read" id="ref-for-default-reader-read①">read</a></code>()</code> 
    <dd>
     <p>Returns a promise that allows access to the next <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②③">chunk</a> from the stream’s internal queue, if
  available. </p>
     <ul>
      <li>If the chunk does become available, the promise will be fulfilled with an object of the form <code class="highlight"><c- p>{</c-> value<c- o>:</c-> theChunk<c- p>,</c-> done<c- o>:</c-> <c- kc>false</c-> <c- p>}</c-></code>. 
      <li>If the stream becomes closed, the promise will be fulfilled with an object of the form <code class="highlight"><c- p>{</c-> value<c- o>:</c-> <c- kc>undefined</c-><c- p>,</c-> done<c- o>:</c-> <c- kc>true</c-> <c- p>}</c-></code>. 
      <li>If the stream becomes errored, the promise will be rejected with the relevant error. 
     </ul>
     <p>If reading a chunk causes the queue to become empty, more data will be pulled from the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⓪">underlying source</a>. </p>
    <dt><code><var>reader</var>.<code class="idl"><a data-link-type="idl" href="#default-reader-release-lock" id="ref-for-default-reader-release-lock②">releaseLock</a></code>()</code> 
    <dd>
     <p><a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock②">Releases the reader’s lock</a> on the corresponding stream. After the lock
  is released, the reader is no longer <a data-link-type="dfn" href="#active" id="ref-for-active①">active</a>. If the associated stream is errored
  when the lock is released, the reader will appear errored in the same way from now on; otherwise,
  the reader will appear closed. </p>
     <p>A reader’s lock cannot be released while it still has a pending read request, i.e., if a
  promise returned by the reader’s <code class="idl"><a data-link-type="idl" href="#default-reader-read" id="ref-for-default-reader-read②">read()</a></code> method has not yet been
  settled. Attempting to do so will throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑧">TypeError</a></code> and leave the reader locked to the stream. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader/ReadableStreamDefaultReader" title="The ReadableStreamDefaultReader() constructor creates and returns a ReadableStreamDefaultReader object instance.">ReadableStreamDefaultReader/ReadableStreamDefaultReader</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultReader(stream)" data-algorithm-for="ReadableStreamDefaultReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="constructor" data-export data-lt="ReadableStreamDefaultReader(stream)|constructor(stream)" id="default-reader-constructor"><code>new ReadableStreamDefaultReader(<var>stream</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-default-reader" id="ref-for-set-up-readable-stream-default-reader">SetUpReadableStreamDefaultReader</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⑦">this</a>, <var>stream</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader/read" title="The read() method of the ReadableStreamDefaultReader interface returns a Promise providing access to the next chunk in the stream&apos;s internal queue.">ReadableStreamDefaultReader/read</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="read()" data-algorithm-for="ReadableStreamDefaultReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="method" data-export id="default-reader-read"><code>read()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⑧">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream③">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑤">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑨">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①">a new promise</a>.</p>
     <li data-md>
      <p>Let <var>readRequest</var> be a new <a data-link-type="dfn" href="#read-request" id="ref-for-read-request②">read request</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item②">items</a>:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps①">chunk steps</a>, given <var>chunk</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②">Resolve</a> <var>promise</var> with «[ "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamdefaultreadresult-value" id="ref-for-dom-readablestreamdefaultreadresult-value">value</a></code>" → <var>chunk</var>,
  "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamdefaultreadresult-done" id="ref-for-dom-readablestreamdefaultreadresult-done">done</a></code>" → false ]».</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps①">close steps</a>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve③">Resolve</a> <var>promise</var> with «[ "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamdefaultreadresult-value" id="ref-for-dom-readablestreamdefaultreadresult-value①">value</a></code>" → undefined,
  "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamdefaultreadresult-done" id="ref-for-dom-readablestreamdefaultreadresult-done①">done</a></code>" → true ]».</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps①">error steps</a>, given <var>e</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①">Reject</a> <var>promise</var> with <var>e</var>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-reader-read" id="ref-for-readable-stream-default-reader-read①">ReadableStreamDefaultReaderRead</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⑨">this</a>, <var>readRequest</var>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultReader/releaseLock" title="The releaseLock() method of the ReadableStreamDefaultReader interface releases the reader&apos;s lock on the stream.">ReadableStreamDefaultReader/releaseLock</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/releaseLock" title="The releaseLock() method of the WritableStreamDefaultWriter interface releases the writer&apos;s lock on the corresponding stream. After the lock is released, the writer is no longer active. If the associated stream is errored when the lock is released, the writer will appear errored in the same way from now on; otherwise, the writer will appear closed.">WritableStreamDefaultWriter/releaseLock</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="releaseLock()" data-algorithm-for="ReadableStreamDefaultReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="method" data-export id="default-reader-release-lock"><code>releaseLock()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⓪">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream④">[[stream]]</a> is undefined, return.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②①">this</a>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests①">[[readRequests]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①">empty</a>,
  throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⓪">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release④">ReadableStreamReaderGenericRelease</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②②">this</a>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.5" id="byob-reader-class"><span class="secno">4.5. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader⑤">ReadableStreamBYOBReader</a></code> class</span><a class="self-link" href="#byob-reader-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader" title="The ReadableStreamBYOBReader interface of the Streams API represents a BYOB (&quot;bring your own buffer&quot;) reader that can be used to read stream data supplied by the developer (e.g. a custom ReadableStream() constructor).">ReadableStreamBYOBReader</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader⑥">ReadableStreamBYOBReader</a></code> class represents a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers⑤">BYOB reader</a> designed to be vended by a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②③">ReadableStream</a></code> instance.</p>
   <h4 class="heading settled" data-level="4.5.1" id="byob-reader-class-definition"><span class="secno">4.5.1. </span><span class="content">Interface definition</span><a class="self-link" href="#byob-reader-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader⑦">ReadableStreamBYOBReader</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestreambyobreader"><code><c- g>ReadableStreamBYOBReader</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#byob-reader-constructor" id="ref-for-byob-reader-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream②④"><c- n>ReadableStream</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamBYOBReader/ReadableStreamBYOBReader(stream), ReadableStreamBYOBReader/constructor(stream)" data-dfn-type="argument" data-export id="dom-readablestreambyobreader-readablestreambyobreader-stream-stream"><code><c- g>stream</c-></code><a class="self-link" href="#dom-readablestreambyobreader-readablestreambyobreader-stream-stream"></a></dfn>);

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise⑦"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-readablestreambyobreadresult" id="ref-for-dictdef-readablestreambyobreadresult"><c- n>ReadableStreamBYOBReadResult</c-></a>> <a class="idl-code" data-link-type="method" href="#byob-reader-read" id="ref-for-byob-reader-read①"><c- g>read</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView"><c- n>ArrayBufferView</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamBYOBReader/read(view)" data-dfn-type="argument" data-export id="dom-readablestreambyobreader-read-view-view"><code><c- g>view</c-></code><a class="self-link" href="#dom-readablestreambyobreader-read-view-view"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined⑦"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#byob-reader-release-lock" id="ref-for-byob-reader-release-lock①"><c- g>releaseLock</c-></a>();
};
<a data-link-type="idl-name" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader⑧"><c- n>ReadableStreamBYOBReader</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader⑥"><c- n>ReadableStreamGenericReader</c-></a>;

<c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-readablestreambyobreadresult"><code><c- g>ReadableStreamBYOBReadResult</c-></code></dfn> {
 <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView①"><c- n>ArrayBufferView</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBReadResult" data-dfn-type="dict-member" data-export data-type="ArrayBufferView " id="dom-readablestreambyobreadresult-value"><code><c- g>value</c-></code></dfn>;
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑥"><c- b>boolean</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBReadResult" data-dfn-type="dict-member" data-export data-type="boolean " id="dom-readablestreambyobreadresult-done"><code><c- g>done</c-></code></dfn>;
};
</pre>
   <h4 class="heading settled" data-level="4.5.2" id="byob-reader-internal-slots"><span class="secno">4.5.2. </span><span class="content">Internal slots</span><a class="self-link" href="#byob-reader-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader⑨">ReadableStreamBYOBReader</a></code> are created with the internal slots defined by <code class="idl"><a data-link-type="idl" href="#readablestreamgenericreader" id="ref-for-readablestreamgenericreader⑦">ReadableStreamGenericReader</a></code>, and those described in the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamBYOBReader" data-dfn-type="dfn" data-noexport id="readablestreambyobreader-readintorequests">[[readIntoRequests]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①">list</a> of <a data-link-type="dfn" href="#read-into-request" id="ref-for-read-into-request">read-into requests</a>, used when a <a data-link-type="dfn" href="#consumer" id="ref-for-consumer④">consumer</a> requests <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②④">chunks</a> sooner than they are available 
   </table>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-export id="read-into-request">read-into request</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct①">struct</a> containing three algorithms to perform in
reaction to filling the <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream④">readable byte stream</a>'s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues④">internal queue</a> or changing its state. It has
the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item③">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read-into request" data-dfn-type="dfn" data-export id="read-into-request-chunk-steps">chunk steps</dfn>
    <dd data-md>
     <p>An algorithm taking a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⑤">chunk</a>, called when a chunk is available for reading</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read-into request" data-dfn-type="dfn" data-export id="read-into-request-close-steps">close steps</dfn>
    <dd data-md>
     <p>An algorithm taking a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⑥">chunk</a>, called when no chunks are available because the stream is
  closed</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="read-into request" data-dfn-type="dfn" data-export id="read-into-request-error-steps">error steps</dfn>
    <dd data-md>
     <p>An algorithm taking a JavaScript value, called when no <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⑦">chunks</a> are available because the
  stream is errored</p>
   </dl>
   <p class="note" role="note">The <a data-link-type="dfn" href="#read-into-request-close-steps" id="ref-for-read-into-request-close-steps">close steps</a> take a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⑧">chunk</a> so that it can return the
backing memory to the caller if possible. For example, <code class="idl"><a data-link-type="idl" href="#byob-reader-read" id="ref-for-byob-reader-read②">byobReader.read(chunk)</a></code> will fulfill with <code class="highlight"><c- p>{</c-> value<c- o>:</c-> newViewOnSameMemory<c- p>,</c-> done<c- o>:</c-> <c- kc>true</c-> <c- p>}</c-></code> for closed streams, instead of the more traditional <code class="highlight"><c- p>{</c-> value<c- o>:</c-> <c- kc>undefined</c-><c- p>,</c-> done<c- o>:</c-> <c- kc>true</c-> <c- p>}</c-></code>. </p>
   <h4 class="heading settled" data-level="4.5.3" id="byob-reader-prototype"><span class="secno">4.5.3. </span><span class="content">Constructor, methods, and properties</span><a class="self-link" href="#byob-reader-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>reader</var> = new <code class="idl"><a data-link-type="idl" href="#byob-reader-constructor" id="ref-for-byob-reader-constructor①">ReadableStreamBYOBReader</a></code>(<var>stream</var>)</code> 
    <dd>
     <p>This is equivalent to calling <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-get-reader" id="ref-for-rs-get-reader⑧">getReader</a></code>({ <code class="idl"><a data-link-type="idl" href="#dom-readablestreamgetreaderoptions-mode" id="ref-for-dom-readablestreamgetreaderoptions-mode③">mode</a></code>: "<code class="idl"><a data-link-type="idl" href="#dom-readablestreamreadermode-byob" id="ref-for-dom-readablestreamreadermode-byob②">byob</a></code>" })</code>. </p>
    <dt><code>await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#generic-reader-closed" id="ref-for-generic-reader-closed③">closed</a></code></code> 
    <dd>
     <p>Returns a promise that will be fulfilled when the stream becomes closed, or rejected if the
  stream ever errors or the reader’s lock is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock③">released</a> before the stream
  finishes closing. </p>
    <dt><code>await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#generic-reader-cancel" id="ref-for-generic-reader-cancel③">cancel</a></code>([ <var>reason</var> ])</code> 
    <dd>
     <p>If the reader is <a data-link-type="dfn" href="#active" id="ref-for-active②">active</a>, behaves the same <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel⑤">cancel</a></code>(<var>reason</var>)</code>. </p>
    <dt><code>{ <var>value</var>, <var>done</var> } = await <var>reader</var>.<code class="idl"><a data-link-type="idl" href="#byob-reader-read" id="ref-for-byob-reader-read③">read</a></code>(<var>view</var>)</code> 
    <dd>
     <p>Attempts to reads bytes into <var>view</var>, and returns a promise resolved with the result: </p>
     <ul>
      <li>If the chunk does become available, the promise will be fulfilled with an object of the form <code class="highlight"><c- p>{</c-> value<c- o>:</c-> theChunk<c- p>,</c-> done<c- o>:</c-> <c- kc>false</c-> <c- p>}</c-></code>. In this case, <var>view</var> will be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-detach" id="ref-for-dfn-detach">detached</a> and no longer usable, but <code>theChunk</code> will be a new view (of
   the same type) onto the same backing memory region, with the chunk’s data written into it. 
      <li>If the stream becomes closed, the promise will be fulfilled with an object of the form <code class="highlight"><c- p>{</c-> value<c- o>:</c-> theChunk<c- p>,</c-> done<c- o>:</c-> <c- kc>true</c-> <c- p>}</c-></code>. In this case, <var>view</var> will be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-detach" id="ref-for-dfn-detach①">detached</a> and no longer usable, but <code>theChunk</code> will be a new view (of
   the same type) onto the same backing memory region, with no modifications, to ensure the memory
   is returned to the caller. 
      <li>If the stream becomes errored, the promise will be rejected with the relevant error. 
     </ul>
     <p>If reading a chunk causes the queue to become empty, more data will be pulled from the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①①">underlying source</a>. </p>
    <dt><code><var>reader</var>.<code class="idl"><a data-link-type="idl" href="#byob-reader-release-lock" id="ref-for-byob-reader-release-lock②">releaseLock</a></code>()</code> 
    <dd>
     <p><a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock④">Releases the reader’s lock</a> on the corresponding stream. After the lock
  is released, the reader is no longer <a data-link-type="dfn" href="#active" id="ref-for-active③">active</a>. If the associated stream is errored
  when the lock is released, the reader will appear errored in the same way from now on; otherwise,
  the reader will appear closed. </p>
     <p>A reader’s lock cannot be released while it still has a pending read request, i.e., if a
  promise returned by the reader’s <code class="idl"><a data-link-type="idl" href="#byob-reader-read" id="ref-for-byob-reader-read④">read()</a></code> method has not yet been
  settled. Attempting to do so will throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①①">TypeError</a></code> and leave the reader locked to the stream. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader/ReadableStreamBYOBReader" title="The ReadableStreamBYOBReader() constructor creates and returns a ReadableStreamBYOBReader object instance. ">ReadableStreamBYOBReader/ReadableStreamBYOBReader</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamBYOBReader(stream)" data-algorithm-for="ReadableStreamBYOBReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBReader" data-dfn-type="constructor" data-export data-lt="ReadableStreamBYOBReader(stream)|constructor(stream)" id="byob-reader-constructor"><code>new ReadableStreamBYOBReader(<var>stream</var>)</code></dfn> constructor
 steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-byob-reader" id="ref-for-set-up-readable-stream-byob-reader">SetUpReadableStreamBYOBReader</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②③">this</a>, <var>stream</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader/read" title="The read() method of the ReadableStreamBYOBReader interface returns a Promise that resolves with an obect representing the next chunk in the stream&apos;s queue.">ReadableStreamBYOBReader/read</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="read(view)" data-algorithm-for="ReadableStreamBYOBReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBReader" data-dfn-type="method" data-export id="byob-reader-read"><code>read(<var>view</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <var>view</var>.[[ByteLength]] is 0, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑥">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①②">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>view</var>.[[ViewedArrayBuffer]].[[ArrayBufferByteLength]] is 0, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑦">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①③">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②④">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream⑤">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑧">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise②">a new promise</a>.</p>
     <li data-md>
      <p>Let <var>readIntoRequest</var> be a new <a data-link-type="dfn" href="#read-into-request" id="ref-for-read-into-request①">read-into request</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item④">items</a>:</p>
      <dl>
       <dt data-md><a data-link-type="dfn" href="#read-into-request-chunk-steps" id="ref-for-read-into-request-chunk-steps">chunk steps</a>, given <var>chunk</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve④">Resolve</a> <var>promise</var> with «[ "<code class="idl"><a data-link-type="idl" href="#dom-readablestreambyobreadresult-value" id="ref-for-dom-readablestreambyobreadresult-value">value</a></code>" → <var>chunk</var>,
  "<code class="idl"><a data-link-type="idl" href="#dom-readablestreambyobreadresult-done" id="ref-for-dom-readablestreambyobreadresult-done">done</a></code>" → false ]».</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-into-request-close-steps" id="ref-for-read-into-request-close-steps①">close steps</a>, given <var>chunk</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve⑤">Resolve</a> <var>promise</var> with «[ "<code class="idl"><a data-link-type="idl" href="#dom-readablestreambyobreadresult-value" id="ref-for-dom-readablestreambyobreadresult-value①">value</a></code>" → <var>chunk</var>,
  "<code class="idl"><a data-link-type="idl" href="#dom-readablestreambyobreadresult-done" id="ref-for-dom-readablestreambyobreadresult-done①">done</a></code>" → true ]».</p>
        </ol>
       <dt data-md><a data-link-type="dfn" href="#read-into-request-error-steps" id="ref-for-read-into-request-error-steps">error steps</a>, given <var>e</var>
       <dd data-md>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject②">Reject</a> <var>promise</var> with <var>e</var>.</p>
        </ol>
      </dl>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-byob-reader-read" id="ref-for-readable-stream-byob-reader-read">ReadableStreamBYOBReaderRead</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⑤">this</a>, <var>view</var>, <var>readIntoRequest</var>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBReader/releaseLock" title="The releaseLock() method of the ReadableStreamBYOBReader interface releases the reader&apos;s lock on the stream. After the lock is released, the reader is no longer active.">ReadableStreamBYOBReader/releaseLock</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="releaseLock()" data-algorithm-for="ReadableStreamBYOBReader">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBReader" data-dfn-type="method" data-export id="byob-reader-release-lock"><code>releaseLock()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⑥">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream⑥">[[stream]]</a> is undefined, return.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⑦">this</a>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests">[[readIntoRequests]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty②">empty</a>,
  throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑤">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release⑤">ReadableStreamReaderGenericRelease</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⑧">this</a>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.6" id="rs-default-controller-class"><span class="secno">4.6. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller③">ReadableStreamDefaultController</a></code> class</span><a class="self-link" href="#rs-default-controller-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultController" title="The ReadableStreamDefaultController interface of the Streams API represents a controller allowing control of a ReadableStream&apos;s state and internal queue. Default controllers are for streams that are not byte streams. ">ReadableStreamDefaultController</a></p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>52+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>39+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>52+</span></span><span class="webview_android yes"><span>Android WebView</span><span>52+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>6.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>41+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller④">ReadableStreamDefaultController</a></code> class has methods that allow control of a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⑤">ReadableStream</a></code>'s state and <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues⑤">internal queue</a>. When constructing a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⑥">ReadableStream</a></code> that is
not a <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream⑤">readable byte stream</a>, the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①②">underlying source</a> is given a corresponding <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller⑤">ReadableStreamDefaultController</a></code> instance to manipulate.</p>
   <h4 class="heading settled" data-level="4.6.1" id="rs-default-controller-class-definition"><span class="secno">4.6.1. </span><span class="content">Interface definition</span><a class="self-link" href="#rs-default-controller-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller⑥">ReadableStreamDefaultController</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed③"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestreamdefaultcontroller"><code><c- g>ReadableStreamDefaultController</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double①"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#rs-default-controller-desired-size" id="ref-for-rs-default-controller-desired-size①"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined⑧"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-close" id="ref-for-rs-default-controller-close"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined⑨"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-enqueue" id="ref-for-rs-default-controller-enqueue"><c- g>enqueue</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any⑥"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamDefaultController/enqueue(chunk), ReadableStreamDefaultController/enqueue()" data-dfn-type="argument" data-export id="dom-readablestreamdefaultcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-readablestreamdefaultcontroller-enqueue-chunk-chunk"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⓪"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-error" id="ref-for-rs-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any⑦"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamDefaultController/error(e), ReadableStreamDefaultController/error()" data-dfn-type="argument" data-export id="dom-readablestreamdefaultcontroller-error-e-e"><code><c- g>e</c-></code><a class="self-link" href="#dom-readablestreamdefaultcontroller-error-e-e"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="4.6.2" id="rs-default-controller-internal-slots"><span class="secno">4.6.2. </span><span class="content">Internal slots</span><a class="self-link" href="#rs-default-controller-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller⑦">ReadableStreamDefaultController</a></code> are created with the internal slots described in
the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-cancelalgorithm">[[cancelAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm, taking one argument (the cancel reason),
   which communicates a requested cancelation to the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①③">underlying source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-closerequested">[[closeRequested]]</dfn> 
      <td class="non-normative">A boolean flag indicating whether the stream has been closed by its <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①④">underlying source</a>, but still has <a data-link-type="dfn" href="#chunk" id="ref-for-chunk②⑨">chunks</a> in its internal queue that have not yet been
   read 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-pullagain">[[pullAgain]]</dfn> 
      <td class="non-normative">A boolean flag set to true if the stream’s mechanisms requested a call
   to the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⑤">underlying source</a>'s pull algorithm to pull more data, but the pull could not yet be
   done since a previous call is still executing 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-pullalgorithm">[[pullAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm that pulls data from the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⑥">underlying
   source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-pulling">[[pulling]]</dfn> 
      <td class="non-normative">A boolean flag set to true while the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⑦">underlying source</a>'s pull
   algorithm is executing and the returned promise has not yet fulfilled, used to prevent reentrant
   calls 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-queue">[[queue]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list②">list</a> representing the stream’s internal queue of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⓪">chunks</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-queuetotalsize">[[queueTotalSize]]</dfn> 
      <td class="non-normative">The total size of all the chunks stored in <a data-link-type="dfn" href="#readablestreamdefaultcontroller-queue" id="ref-for-readablestreamdefaultcontroller-queue">[[queue]]</a> (see <a href="#queue-with-sizes">§ 8.1 Queue-with-sizes</a>) 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-started">[[started]]</dfn> 
      <td class="non-normative">A boolean flag indicating whether the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⑧">underlying source</a> has
   finished starting 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-strategyhwm">[[strategyHWM]]</dfn> 
      <td class="non-normative">A number supplied to the constructor as part of the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy①">queuing
   strategy</a>, indicating the point at which the stream will apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure⑤">backpressure</a> to its <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source①⑨">underlying source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-strategysizealgorithm">[[strategySizeAlgorithm]]</dfn> 
      <td class="non-normative">An algorithm to calculate the size of enqueued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③①">chunks</a>, as part of
   the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy②">queuing strategy</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="dfn" data-noexport id="readablestreamdefaultcontroller-stream">[[stream]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⑦">ReadableStream</a></code> instance controlled 
   </table>
   <h4 class="heading settled" data-level="4.6.3" id="rs-default-controller-prototype"><span class="secno">4.6.3. </span><span class="content">Methods and properties</span><a class="self-link" href="#rs-default-controller-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>desiredSize</var> = <var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rs-default-controller-desired-size" id="ref-for-rs-default-controller-desired-size②">desiredSize</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue②">desired size to fill the
  controlled stream’s internal queue</a>. It can be negative, if the queue is over-full. An <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⓪">underlying source</a> ought to use this information to determine when and how to apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure⑥">backpressure</a>. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rs-default-controller-close" id="ref-for-rs-default-controller-close①">close</a></code>()</code> 
    <dd>
     <p>Closes the controlled readable stream. <a data-link-type="dfn" href="#consumer" id="ref-for-consumer⑤">Consumers</a> will still be able to read any
  previously-enqueued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③②">chunks</a> from the stream, but once those are read, the stream will become
  closed. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rs-default-controller-enqueue" id="ref-for-rs-default-controller-enqueue①">enqueue</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Enqueues the given <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③③">chunk</a> <var>chunk</var> in the controlled readable stream. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rs-default-controller-error" id="ref-for-rs-default-controller-error①">error</a></code>(<var>e</var>)</code> 
    <dd>
     <p>Errors the controlled readable stream, making all future interactions with it fail with the
  given error <var>e</var>. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultController/desiredSize" title="The desiredSize read-only property of the ReadableStreamDefaultController interface returns the desired size required to fill the stream&apos;s internal queue.">ReadableStreamDefaultController/desiredSize</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="desiredSize" data-algorithm-for="ReadableStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="attribute" data-export id="rs-default-controller-desired-size"><code>desiredSize</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-get-desired-size" id="ref-for-readable-stream-default-controller-get-desired-size">ReadableStreamDefaultControllerGetDesiredSize</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this②⑨">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultController/close" title="The close() method of the ReadableStreamDefaultController interface closes the associated stream. ">ReadableStreamDefaultController/close</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="close()" data-algorithm-for="ReadableStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="method" data-export id="rs-default-controller-close"><code>close()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⓪">this</a>) is false, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑥">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close">ReadableStreamDefaultControllerClose</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③①">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultController/enqueue" title="The enqueue() method of the ReadableStreamDefaultController interface enqueues a given chunk in the associated stream.">ReadableStreamDefaultController/enqueue</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="enqueue(chunk)" data-algorithm-for="ReadableStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="method" data-export data-lt="enqueue(chunk)|enqueue()" id="rs-default-controller-enqueue"><code>enqueue(<var>chunk</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue①">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③②">this</a>) is false, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑦">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue">ReadableStreamDefaultControllerEnqueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③③">this</a>, <var>chunk</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamDefaultController/error" title="The error() method of the ReadableStreamDefaultController interface causes any future interactions with the associated stream to error.">ReadableStreamDefaultController/error</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>?</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="error(e)" data-algorithm-for="ReadableStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamDefaultController" data-dfn-type="method" data-export data-lt="error(e)|error()" id="rs-default-controller-error"><code>error(<var>e</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error">ReadableStreamDefaultControllerError</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③④">this</a>, <var>e</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.6.4" id="rs-default-controller-internal-methods"><span class="secno">4.6.4. </span><span class="content">Internal methods</span><a class="self-link" href="#rs-default-controller-internal-methods"></a></h4>
   <p>The following are internal methods implemented by each <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller⑧">ReadableStreamDefaultController</a></code> instance.
The readable stream implementation will polymorphically call to either these, or to their
counterparts for BYOB controllers, as discussed in <a href="#rs-abstract-ops-used-by-controllers">§ 4.9.2 Interfacing with controllers</a>.</p>
   <div class="algorithm" data-algorithm="[[CancelSteps]]" data-algorithm-for="ReadableStreamDefaultController">
     <dfn data-dfn-for="ReadableStreamDefaultController" data-dfn-type="abstract-op" data-export data-lt="[[CancelSteps]]" id="rs-default-controller-private-cancel">[[CancelSteps]](<var>reason</var>)<a class="self-link" href="#rs-default-controller-private-cancel"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-cancelsteps" id="ref-for-abstract-opdef-readablestreamcontroller-cancelsteps">[[CancelSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue">ResetQueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⑤">this</a>).</p>
     <li data-md>
      <p>Let <var>result</var> be the result of performing <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⑥">this</a>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-cancelalgorithm" id="ref-for-readablestreamdefaultcontroller-cancelalgorithm">[[cancelAlgorithm]]</a>, passing <var>reason</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-clear-algorithms" id="ref-for-readable-stream-default-controller-clear-algorithms">ReadableStreamDefaultControllerClearAlgorithms</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⑦">this</a>).</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="[[PullSteps]]" data-algorithm-for="ReadableStreamDefaultController">
     <dfn data-dfn-for="ReadableStreamDefaultController" data-dfn-type="abstract-op" data-export data-lt="[[PullSteps]]" id="rs-default-controller-private-pull">[[PullSteps]](<var>readRequest</var>)<a class="self-link" href="#rs-default-controller-private-pull"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-pullsteps" id="ref-for-abstract-opdef-readablestreamcontroller-pullsteps">[[PullSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⑧">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream⑦">[[stream]]</a>.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this③⑨">this</a>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-queue" id="ref-for-readablestreamdefaultcontroller-queue①">[[queue]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty③">empty</a>,</p>
      <ol>
       <li data-md>
        <p>Let <var>chunk</var> be ! <a data-link-type="abstract-op" href="#dequeue-value" id="ref-for-dequeue-value">DequeueValue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⓪">this</a>).</p>
       <li data-md>
        <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④①">this</a>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-closerequested" id="ref-for-readablestreamdefaultcontroller-closerequested">[[closeRequested]]</a> is true and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④②">this</a>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-queue" id="ref-for-readablestreamdefaultcontroller-queue②">[[queue]]</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty④">is empty</a>,</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-clear-algorithms" id="ref-for-readable-stream-default-controller-clear-algorithms①">ReadableStreamDefaultControllerClearAlgorithms</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④③">this</a>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-close" id="ref-for-readable-stream-close">ReadableStreamClose</a>(<var>stream</var>).</p>
        </ol>
       <li data-md>
        <p>Otherwise, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-call-pull-if-needed" id="ref-for-readable-stream-default-controller-call-pull-if-needed">ReadableStreamDefaultControllerCallPullIfNeeded</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④④">this</a>).</p>
       <li data-md>
        <p>Perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps②">chunk steps</a>, given <var>chunk</var>.</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-add-read-request" id="ref-for-readable-stream-add-read-request">ReadableStreamAddReadRequest</a>(<var>stream</var>, <var>readRequest</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-call-pull-if-needed" id="ref-for-readable-stream-default-controller-call-pull-if-needed①">ReadableStreamDefaultControllerCallPullIfNeeded</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⑤">this</a>).</p>
      </ol>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.7" id="rbs-controller-class"><span class="secno">4.7. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller③">ReadableByteStreamController</a></code> class</span><a class="self-link" href="#rbs-controller-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController" title="The ReadableByteStreamController interface of the Streams API represents a controller allowing control of a ReadableStream&apos;s state and internal queue. Byte stream controllers are for byte streams.">ReadableByteStreamController</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller④">ReadableByteStreamController</a></code> class has methods that allow control of a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⑧">ReadableStream</a></code>'s
state and <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues⑥">internal queue</a>. When constructing a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream②⑨">ReadableStream</a></code> that is a <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream⑥">readable byte
stream</a>, the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②①">underlying source</a> is given a corresponding <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller⑤">ReadableByteStreamController</a></code> instance to manipulate.</p>
   <h4 class="heading settled" data-level="4.7.1" id="rbs-controller-class-definition"><span class="secno">4.7.1. </span><span class="content">Interface definition</span><a class="self-link" href="#rbs-controller-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller⑥">ReadableByteStreamController</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed④"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablebytestreamcontroller"><code><c- g>ReadableByteStreamController</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest"><c- n>ReadableStreamBYOBRequest</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStreamBYOBRequest?" href="#rbs-controller-byob-request" id="ref-for-rbs-controller-byob-request①"><c- g>byobRequest</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double②"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size①"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①①"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-close" id="ref-for-rbs-controller-close"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①②"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-enqueue" id="ref-for-rbs-controller-enqueue"><c- g>enqueue</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView②"><c- n>ArrayBufferView</c-></a> <dfn class="idl-code" data-dfn-for="ReadableByteStreamController/enqueue(chunk)" data-dfn-type="argument" data-export id="dom-readablebytestreamcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-readablebytestreamcontroller-enqueue-chunk-chunk"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①③"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-error" id="ref-for-rbs-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any⑧"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="ReadableByteStreamController/error(e), ReadableByteStreamController/error()" data-dfn-type="argument" data-export id="dom-readablebytestreamcontroller-error-e-e"><code><c- g>e</c-></code><a class="self-link" href="#dom-readablebytestreamcontroller-error-e-e"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="4.7.2" id="rbs-controller-internal-slots"><span class="secno">4.7.2. </span><span class="content">Internal slots</span><a class="self-link" href="#rbs-controller-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller⑦">ReadableByteStreamController</a></code> are created with the internal slots described in the
following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-autoallocatechunksize">[[autoAllocateChunkSize]]</dfn> 
      <td class="non-normative">A positive integer, when the automatic buffer allocation feature is
   enabled. In that case, this value specifies the size of buffer to allocate. It is undefined
   otherwise. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-byobrequest">[[byobRequest]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest①">ReadableStreamBYOBRequest</a></code> instance representing the current BYOB
   pull request, or null if there are no pending requests 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-cancelalgorithm">[[cancelAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm, taking one argument (the cancel reason),
   which communicates a requested cancelation to the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source">underlying byte source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-closerequested">[[closeRequested]]</dfn> 
      <td class="non-normative">A boolean flag indicating whether the stream has been closed by its <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①">underlying byte source</a>, but still has <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③④">chunks</a> in its internal queue that have not yet been
   read 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-pullagain">[[pullAgain]]</dfn> 
      <td class="non-normative">A boolean flag set to true if the stream’s mechanisms requested a call
   to the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source②">underlying byte source</a>'s pull algorithm to pull more data, but the pull could not yet
   be done since a previous call is still executing 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-pullalgorithm">[[pullAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm that pulls data from the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source③">underlying
   byte source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-pulling">[[pulling]]</dfn> 
      <td class="non-normative">A boolean flag set to true while the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source④">underlying byte source</a>'s pull
   algorithm is executing and the returned promise has not yet fulfilled, used to prevent reentrant
   calls 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-pendingpullintos">[[pendingPullIntos]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list③">list</a> of <a data-link-type="dfn" href="#pull-into-descriptor" id="ref-for-pull-into-descriptor">pull-into descriptors</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-queue">[[queue]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list④">list</a> of <a data-link-type="dfn" href="#readable-byte-stream-queue-entry" id="ref-for-readable-byte-stream-queue-entry">readable byte stream
   queue entries</a> representing the stream’s internal queue of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⑤">chunks</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-queuetotalsize">[[queueTotalSize]]</dfn> 
      <td class="non-normative">The total size, in bytes, of all the chunks stored in <a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue">[[queue]]</a> (see <a href="#queue-with-sizes">§ 8.1 Queue-with-sizes</a>) 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-started">[[started]]</dfn> 
      <td class="non-normative">A boolean flag indicating whether the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source⑤">underlying byte source</a> has
   finished starting 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-strategyhwm">[[strategyHWM]]</dfn> 
      <td class="non-normative">A number supplied to the constructor as part of the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy③">queuing
   strategy</a>, indicating the point at which the stream will apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure⑦">backpressure</a> to its <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source⑥">underlying byte source</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableByteStreamController" data-dfn-type="dfn" data-noexport id="readablebytestreamcontroller-stream">[[stream]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⓪">ReadableStream</a></code> instance controlled 
   </table>
   <div class="note" role="note">
    <p>Although <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller⑧">ReadableByteStreamController</a></code> instances have <a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue①">[[queue]]</a> and <a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize">[[queueTotalSize]]</a> slots, we do not use most of the abstract operations in <a href="#queue-with-sizes">§ 8.1 Queue-with-sizes</a> on them, as the way
 in which we manipulate this queue is rather different than the others in the spec. Instead, we
 update the two slots together manually. </p>
    <p>This might be cleaned up in a future spec refactoring. </p>
   </div>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="readable-byte-stream-queue-entry">readable byte stream queue entry</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct②">struct</a> encapsulating the important aspects of
a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⑥">chunk</a> for the specific case of <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream⑦">readable byte streams</a>. It has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item⑤">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="readable byte stream queue entry" data-dfn-type="dfn" data-noexport id="readable-byte-stream-queue-entry-buffer">buffer</dfn>
    <dd data-md>
     <p>An <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects③">ArrayBuffer</a></code>, which will be a <a href="#transfer-array-buffer" id="ref-for-transfer-array-buffer④">transferred</a> version of
  the one originally supplied by the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source⑦">underlying byte source</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="readable byte stream queue entry" data-dfn-type="dfn" data-noexport id="readable-byte-stream-queue-entry-byte-offset">byte offset</dfn>
    <dd data-md>
     <p>A nonnegative integer number giving the byte offset derived from the view originally supplied by
  the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source⑧">underlying byte source</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="readable byte stream queue entry" data-dfn-type="dfn" data-noexport id="readable-byte-stream-queue-entry-byte-length">byte length</dfn>
    <dd data-md>
     <p>A nonnegative integer number giving the byte length derived from the view originally supplied by
  the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source⑨">underlying byte source</a></p>
   </dl>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pull-into-descriptor">pull-into descriptor</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct③">struct</a> used to represent pending BYOB pull requests. It
has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item⑥">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-buffer">buffer</dfn>
    <dd data-md>
     <p>An <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects④">ArrayBuffer</a></code></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-byte-offset">byte offset</dfn>
    <dd data-md>
     <p>A nonnegative integer byte offset into the <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer">buffer</a> where the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①⓪">underlying byte source</a> will start writing</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-byte-length">byte length</dfn>
    <dd data-md>
     <p>A nonnegative integer number of bytes which can be written into the <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①">buffer</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-bytes-filled">bytes filled</dfn>
    <dd data-md>
     <p>A nonnegative integer number of bytes that have been written into the <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer②">buffer</a> so far</p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-element-size">element size</dfn>
    <dd data-md>
     <p>A positive integer representing the number of bytes that can be written into the <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer③">buffer</a> at a time, using views of the type described by the <a data-link-type="dfn" href="#pull-into-descriptor-view-constructor" id="ref-for-pull-into-descriptor-view-constructor">view constructor</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-view-constructor">view constructor</dfn>
    <dd data-md>
     <p>A <a data-link-type="dfn" href="https://tc39.es/ecma262/#table-49" id="ref-for-table-49">typed array constructor</a> or <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-dataview-constructor" id="ref-for-sec-dataview-constructor">%DataView%</a></code>, which will be
  used for constructing a view with which to write into the <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer④">buffer</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pull-into descriptor" data-dfn-type="dfn" data-noexport id="pull-into-descriptor-reader-type">reader type</dfn>
    <dd data-md>
     <p>Either "<code>default</code>" or "<code>byob</code>", indicating what type of <a data-link-type="dfn" href="#reader" id="ref-for-reader③">readable stream reader</a> initiated this
  request</p>
   </dl>
   <h4 class="heading settled" data-level="4.7.3" id="rbs-controller-prototype"><span class="secno">4.7.3. </span><span class="content">Methods and properties</span><a class="self-link" href="#rbs-controller-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>byobRequest</var> = <var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rbs-controller-byob-request" id="ref-for-rbs-controller-byob-request②">byobRequest</a></code></code> 
    <dd>
     <p>Returns the current BYOB pull request, or null if there isn’t one. </p>
    <dt><code><var>desiredSize</var> = <var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size②">desiredSize</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue③">desired size to fill the
  controlled stream’s internal queue</a>. It can be negative, if the queue is over-full. An <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①①">underlying byte source</a> ought to use this information to determine when and how to apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure⑧">backpressure</a>. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rbs-controller-close" id="ref-for-rbs-controller-close①">close</a></code>()</code> 
    <dd>
     <p>Closes the controlled readable stream. <a data-link-type="dfn" href="#consumer" id="ref-for-consumer⑥">Consumers</a> will still be able to read any
  previously-enqueued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⑦">chunks</a> from the stream, but once those are read, the stream will become
  closed. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rbs-controller-enqueue" id="ref-for-rbs-controller-enqueue①">enqueue</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Enqueues the given <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⑧">chunk</a> <var>chunk</var> in the controlled readable stream. The
  chunk has to be an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView③">ArrayBufferView</a></code> instance, or else a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑧">TypeError</a></code> will be thrown. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#rbs-controller-error" id="ref-for-rbs-controller-error①">error</a></code>(<var>e</var>)</code> 
    <dd>
     <p>Errors the controlled readable stream, making all future interactions with it fail with the
  given error <var>e</var>. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController/byobRequest" title="The byobRequest read-only property of the ReadableByteStreamController interface returns the current BYOB pull request, or undefined if there are no pending requests.">ReadableByteStreamController/byobRequest</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="byobRequest" data-algorithm-for="ReadableByteStreamController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableByteStreamController" data-dfn-type="attribute" data-export id="rbs-controller-byob-request"><code>byobRequest</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⑥">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest">[[byobRequest]]</a> is null and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⑦">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos">[[pendingPullIntos]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑤">empty</a>,</p>
      <ol>
       <li data-md>
        <p>Let <var>firstDescriptor</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⑧">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①">[[pendingPullIntos]]</a>[0].</p>
       <li data-md>
        <p>Let <var>view</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct">Construct</a>(<code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects②">%Uint8Array%</a></code>, « <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer⑤">buffer</a>, <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset">byte offset</a> + <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled">bytes filled</a>, <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length">byte length</a> − <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①">bytes filled</a> »).</p>
       <li data-md>
        <p>Let <var>byobRequest</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new③">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest②">ReadableStreamBYOBRequest</a></code>.</p>
       <li data-md>
        <p>Set <var>byobRequest</var>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller">[[controller]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this④⑨">this</a>.</p>
       <li data-md>
        <p>Set <var>byobRequest</var>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view">[[view]]</a> to <var>view</var>.</p>
       <li data-md>
        <p>Set <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⓪">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest①">[[byobRequest]]</a> to <var>byobRequest</var>.</p>
      </ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤①">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest②">[[byobRequest]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController/desiredSize" title="The desiredSize read-only property of the ReadableByteStreamController interface returns the desired size required to fill the stream&apos;s internal queue.">ReadableByteStreamController/desiredSize</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="desiredSize" data-algorithm-for="ReadableByteStreamController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableByteStreamController" data-dfn-type="attribute" data-export id="rbs-controller-desired-size"><code>desiredSize</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-get-desired-size" id="ref-for-readable-byte-stream-controller-get-desired-size">ReadableByteStreamControllerGetDesiredSize</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤②">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController/close" title="The close() method of the ReadableByteStreamController interface closes the associated stream.">ReadableByteStreamController/close</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="close()" data-algorithm-for="ReadableByteStreamController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableByteStreamController" data-dfn-type="method" data-export id="rbs-controller-close"><code>close()</code></dfn> method
 steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤③">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested">[[closeRequested]]</a> is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑨">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤④">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream⑧">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state">[[state]]</a> is not
  "<code>readable</code>", throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⓪">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-close" id="ref-for-readable-byte-stream-controller-close">ReadableByteStreamControllerClose</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⑤">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController/enqueue" title="The enqueue() method of the ReadableByteStreamController interface enqueues a given chunk in the associated stream.">ReadableByteStreamController/enqueue</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="enqueue(chunk)" data-algorithm-for="ReadableByteStreamController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableByteStreamController" data-dfn-type="method" data-export id="rbs-controller-enqueue"><code>enqueue(<var>chunk</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <var>chunk</var>.[[ByteLength]] is 0, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②①">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>chunk</var>.[[ViewedArrayBuffer]].[[ArrayBufferByteLength]] is 0, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②②">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⑥">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested①">[[closeRequested]]</a> is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②③">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⑦">this</a>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream⑨">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①">[[state]]</a> is not
  "<code>readable</code>", throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-enqueue" id="ref-for-readable-byte-stream-controller-enqueue">ReadableByteStreamControllerEnqueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⑧">this</a>, <var>chunk</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableByteStreamController/error" title="The error() method of the ReadableByteStreamController interface causes any future interactions with the associated stream to error.">ReadableByteStreamController/error</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>89+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>75+</span></span><span class="edge_blink yes"><span>Edge</span><span>89+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>89+</span></span><span class="webview_android yes"><span>Android WebView</span><span>89+</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="error(e)" data-algorithm-for="ReadableByteStreamController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableByteStreamController" data-dfn-type="method" data-export data-lt="error(e)|error()" id="rbs-controller-error"><code>error(<var>e</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-error" id="ref-for-readable-byte-stream-controller-error">ReadableByteStreamControllerError</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑤⑨">this</a>, <var>e</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.7.4" id="rbs-controller-internal-methods"><span class="secno">4.7.4. </span><span class="content">Internal methods</span><a class="self-link" href="#rbs-controller-internal-methods"></a></h4>
   <p>The following are internal methods implemented by each <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller⑨">ReadableByteStreamController</a></code> instance.
The readable stream implementation will polymorphically call to either these, or to their
counterparts for default controllers, as discussed in <a href="#rs-abstract-ops-used-by-controllers">§ 4.9.2 Interfacing with controllers</a>.</p>
   <div class="algorithm" data-algorithm="[[CancelSteps]]" data-algorithm-for="ReadableByteStreamController">
     <dfn data-dfn-for="ReadableByteStreamController" data-dfn-type="abstract-op" data-export data-lt="[[CancelSteps]]" id="rbs-controller-private-cancel">[[CancelSteps]](<var>reason</var>)<a class="self-link" href="#rbs-controller-private-cancel"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-cancelsteps" id="ref-for-abstract-opdef-readablestreamcontroller-cancelsteps①">[[CancelSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⓪">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos②">[[pendingPullIntos]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑥">empty</a>,</p>
      <ol>
       <li data-md>
        <p>Let <var>firstDescriptor</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥①">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos③">[[pendingPullIntos]]</a>[0].</p>
       <li data-md>
        <p>Set <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②">bytes filled</a> to 0.</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue①">ResetQueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥②">this</a>).</p>
     <li data-md>
      <p>Let <var>result</var> be the result of performing <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥③">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-cancelalgorithm" id="ref-for-readablebytestreamcontroller-cancelalgorithm">[[cancelAlgorithm]]</a>, passing in <var>reason</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-clear-algorithms" id="ref-for-readable-byte-stream-controller-clear-algorithms">ReadableByteStreamControllerClearAlgorithms</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥④">this</a>).</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="[[PullSteps]]" data-algorithm-for="ReadableByteStreamController">
     <dfn data-dfn-for="ReadableByteStreamController" data-dfn-type="abstract-op" data-export data-lt="[[PullSteps]]" id="rbs-controller-private-pull">[[PullSteps]](<var>readRequest</var>)<a class="self-link" href="#rbs-controller-private-pull"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-pullsteps" id="ref-for-abstract-opdef-readablestreamcontroller-pullsteps①">[[PullSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⑤">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-has-default-reader" id="ref-for-readable-stream-has-default-reader">ReadableStreamHasDefaultReader</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⑥">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①">[[queueTotalSize]]</a> > 0,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-requests" id="ref-for-readable-stream-get-num-read-requests">ReadableStreamGetNumReadRequests</a>(<var>stream</var>) is 0.</p>
       <li data-md>
        <p>Let <var>entry</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⑦">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue②">[[queue]]</a>[0].</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove">Remove</a> <var>entry</var> from <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⑧">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue③">[[queue]]</a>.</p>
       <li data-md>
        <p>Set <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑥⑨">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize②">[[queueTotalSize]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⓪">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize③">[[queueTotalSize]]</a> − <var>entry</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length">byte length</a>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-handle-queue-drain" id="ref-for-readable-byte-stream-controller-handle-queue-drain">ReadableByteStreamControllerHandleQueueDrain</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦①">this</a>).</p>
       <li data-md>
        <p>Let <var>view</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct①">Construct</a>(<code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects③">%Uint8Array%</a></code>, « <var>entry</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-buffer" id="ref-for-readable-byte-stream-queue-entry-buffer">buffer</a>, <var>entry</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-offset" id="ref-for-readable-byte-stream-queue-entry-byte-offset">byte offset</a>, <var>entry</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length①">byte length</a> »).</p>
       <li data-md>
        <p>Perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps③">chunk steps</a>, given <var>view</var>.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>Let <var>autoAllocateChunkSize</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦②">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-autoallocatechunksize" id="ref-for-readablebytestreamcontroller-autoallocatechunksize">[[autoAllocateChunkSize]]</a>.</p>
     <li data-md>
      <p>If <var>autoAllocateChunkSize</var> is not undefined,</p>
      <ol>
       <li data-md>
        <p>Let <var>buffer</var> be <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct②">Construct</a>(<code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-constructor" id="ref-for-sec-arraybuffer-constructor">%ArrayBuffer%</a></code>, « <var>autoAllocateChunkSize</var> »).</p>
       <li data-md>
        <p>If <var>buffer</var> is an abrupt completion,</p>
        <ol>
         <li data-md>
          <p>Perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps②">error steps</a>, given <var>buffer</var>.[[Value]].</p>
         <li data-md>
          <p>Return.</p>
        </ol>
       <li data-md>
        <p>Let <var>pullIntoDescriptor</var> be a new <a data-link-type="dfn" href="#pull-into-descriptor" id="ref-for-pull-into-descriptor①">pull-into descriptor</a> with <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer⑥">buffer</a> <var>buffer</var>.[[Value]], <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset①">byte offset</a> 0, <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length①">byte
  length</a> <var>autoAllocateChunkSize</var>, <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled③">bytes filled</a> 0, <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size">element size</a> 1, <a data-link-type="dfn" href="#pull-into-descriptor-view-constructor" id="ref-for-pull-into-descriptor-view-constructor①">view constructor</a> <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects④">%Uint8Array%</a></code>, and <a data-link-type="dfn" href="#pull-into-descriptor-reader-type" id="ref-for-pull-into-descriptor-reader-type">reader type</a> "<code>default</code>".</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append">Append</a> <var>pullIntoDescriptor</var> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦③">this</a>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos④">[[pendingPullIntos]]</a>.</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-add-read-request" id="ref-for-readable-stream-add-read-request①">ReadableStreamAddReadRequest</a>(<var>stream</var>, <var>readRequest</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed">ReadableByteStreamControllerCallPullIfNeeded</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦④">this</a>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.8" id="rs-byob-request-class"><span class="secno">4.8. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest③">ReadableStreamBYOBRequest</a></code> class</span><a class="self-link" href="#rs-byob-request-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBRequest" title="The ReadableStreamBYOBRequest interface of the Streams API represents a pull request into a ReadableByteStreamController view.">ReadableStreamBYOBRequest</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest④">ReadableStreamBYOBRequest</a></code> class represents a pull-into request in a <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①⓪">ReadableByteStreamController</a></code>.</p>
   <h4 class="heading settled" data-level="4.8.1" id="rs-byob-request-class-definition"><span class="secno">4.8.1. </span><span class="content">Interface definition</span><a class="self-link" href="#rs-byob-request-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest⑤">ReadableStreamBYOBRequest</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑤"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="readablestreambyobrequest"><code><c- g>ReadableStreamBYOBRequest</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView④"><c- n>ArrayBufferView</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ArrayBufferView?" href="#rs-byob-request-view" id="ref-for-rs-byob-request-view"><c- g>view</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①④"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-byob-request-respond" id="ref-for-rs-byob-request-respond"><c- g>respond</c-></a>([<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#EnforceRange" id="ref-for-EnforceRange①"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long" id="ref-for-idl-unsigned-long-long②"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamBYOBRequest/respond(bytesWritten)" data-dfn-type="argument" data-export id="dom-readablestreambyobrequest-respond-byteswritten-byteswritten"><code><c- g>bytesWritten</c-></code><a class="self-link" href="#dom-readablestreambyobrequest-respond-byteswritten-byteswritten"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⑤"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-byob-request-respond-with-new-view" id="ref-for-rs-byob-request-respond-with-new-view"><c- g>respondWithNewView</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView⑤"><c- n>ArrayBufferView</c-></a> <dfn class="idl-code" data-dfn-for="ReadableStreamBYOBRequest/respondWithNewView(view)" data-dfn-type="argument" data-export id="dom-readablestreambyobrequest-respondwithnewview-view-view"><code><c- g>view</c-></code><a class="self-link" href="#dom-readablestreambyobrequest-respondwithnewview-view-view"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="4.8.2" id="rs-byob-request-internal-slots"><span class="secno">4.8.2. </span><span class="content">Internal slots</span><a class="self-link" href="#rs-byob-request-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#readablestreambyobrequest" id="ref-for-readablestreambyobrequest⑥">ReadableStreamBYOBRequest</a></code> are created with the internal slots described in the
following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamBYOBRequest" data-dfn-type="dfn" data-noexport id="readablestreambyobrequest-controller">[[controller]]</dfn> 
      <td class="non-normative">The parent <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①①">ReadableByteStreamController</a></code> instance 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="ReadableStreamBYOBRequest" data-dfn-type="dfn" data-noexport id="readablestreambyobrequest-view">[[view]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects⑤">typed array</a> representing the destination region to which the
  controller can write generated data, or null after the BYOB request has been invalidated. 
   </table>
   <h4 class="heading settled" data-level="4.8.3" id="rs-byob-request-prototype"><span class="secno">4.8.3. </span><span class="content">Methods and properties</span><a class="self-link" href="#rs-byob-request-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>view</var> = <var>byobRequest</var>.<code class="idl"><a data-link-type="idl" href="#rs-byob-request-view" id="ref-for-rs-byob-request-view①">view</a></code></code> 
    <dd>
     <p>Returns the view for writing in to, or null if the BYOB request has already been responded to. </p>
    <dt><code><var>byobRequest</var>.<code class="idl"><a data-link-type="idl" href="#rs-byob-request-respond" id="ref-for-rs-byob-request-respond①">respond</a></code>(<var>bytesWritten</var>)</code> 
    <dd>
     <p>Indicates to the associated <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream⑧">readable byte stream</a> that <var>bytesWritten</var> bytes
  were written into <code class="idl"><a data-link-type="idl" href="#rs-byob-request-view" id="ref-for-rs-byob-request-view②">view</a></code>, causing the result be surfaced to the <a data-link-type="dfn" href="#consumer" id="ref-for-consumer⑦">consumer</a>. </p>
     <p>After this method is called, <code class="idl"><a data-link-type="idl" href="#rs-byob-request-view" id="ref-for-rs-byob-request-view③">view</a></code> will be <a href="#transfer-array-buffer" id="ref-for-transfer-array-buffer⑤">transferred</a> and no longer modifiable. </p>
    <dt><code><var>byobRequest</var>.<code class="idl"><a data-link-type="idl" href="#rs-byob-request-respond-with-new-view" id="ref-for-rs-byob-request-respond-with-new-view①">respondWithNewView</a></code>(<var>view</var>)</code> 
    <dd>
     <p>Indicates to the associated <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream⑨">readable byte stream</a> that instead of writing into <code class="idl"><a data-link-type="idl" href="#rs-byob-request-view" id="ref-for-rs-byob-request-view④">view</a></code>, the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①②">underlying byte source</a> is providing a new <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#ArrayBufferView" id="ref-for-ArrayBufferView⑥">ArrayBufferView</a></code>, which will be given to the <a data-link-type="dfn" href="#consumer" id="ref-for-consumer⑧">consumer</a> of the <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①⓪">readable byte stream</a>. </p>
     <p>After this method is called, <var>view</var> will be <a href="#transfer-array-buffer" id="ref-for-transfer-array-buffer⑥">transferred</a> and no longer modifiable. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBRequest/view" title="The view getter property of the ReadableStreamBYOBRequest interface returns the current view.">ReadableStreamBYOBRequest/view</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="view" data-algorithm-for="ReadableStreamBYOBRequest">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBRequest" data-dfn-type="attribute" data-export id="rs-byob-request-view"><code>view</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⑤">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view①">[[view]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBRequest/respond" title="The error() method of the ReadableStreamBYOBRequest interface xxx">ReadableStreamBYOBRequest/respond</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="respond(bytesWritten)" data-algorithm-for="ReadableStreamBYOBRequest">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBRequest" data-dfn-type="method" data-export id="rs-byob-request-respond"><code>respond(<var>bytesWritten</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⑥">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller①">[[controller]]</a> is undefined, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑤">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-isdetachedbuffer" id="ref-for-sec-isdetachedbuffer">IsDetachedBuffer</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⑦">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view②">[[view]]</a>.[[ArrayBuffer]]) is
  true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑥">TypeError</a></code> exception.</p>
     <li data-md>
      <p class="assertion">Assert: <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⑧">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view③">[[view]]</a>.[[ByteLength]] > 0.</p>
     <li data-md>
      <p class="assertion">Assert: <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑦⑨">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view④">[[view]]</a>.[[ViewedArrayBuffer]].[[ByteLength]]
  > 0.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond" id="ref-for-readable-byte-stream-controller-respond">ReadableByteStreamControllerRespond</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⓪">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller②">[[controller]]</a>, <var>bytesWritten</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ReadableStreamBYOBRequest/respondWithNewView" title="The respondWithNewView() method of the ReadableStreamBYOBRequest interface xxx">ReadableStreamBYOBRequest/respondWithNewView</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>None</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>None</span></span><span class="edge_blink no"><span>Edge</span><span>None</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>None</span></span><span class="webview_android no"><span>Android WebView</span><span>None</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>None</span></span><span class="opera_android no"><span>Opera Mobile</span><span>None</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="respondWithNewView(view)" data-algorithm-for="ReadableStreamBYOBRequest">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ReadableStreamBYOBRequest" data-dfn-type="method" data-export id="rs-byob-request-respond-with-new-view"><code>respondWithNewView(<var>view</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <var>view</var>.[[ByteLength]] is 0, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑦">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>view</var>.[[ViewedArrayBuffer]].[[ArrayBufferByteLength]] is 0, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑧">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧①">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller③">[[controller]]</a> is undefined, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑨">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond-with-new-view" id="ref-for-readable-byte-stream-controller-respond-with-new-view">ReadableByteStreamControllerRespondWithNewView</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧②">this</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller④">[[controller]]</a>, <var>view</var>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="4.9" id="rs-all-abstract-ops"><span class="secno">4.9. </span><span class="content">Abstract operations</span><a class="self-link" href="#rs-all-abstract-ops"></a></h3>
   <h4 class="heading settled" data-level="4.9.1" id="rs-abstract-ops"><span class="secno">4.9.1. </span><span class="content">Working with readable streams</span><a class="self-link" href="#rs-abstract-ops"></a></h4>
   <p>The following abstract operations operate on <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③①">ReadableStream</a></code> instances at a higher level.</p>
   <div class="algorithm" data-algorithm="AcquireReadableStreamBYOBReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="AcquireReadableStreamBYOBReader" id="acquire-readable-stream-byob-reader">AcquireReadableStreamBYOBReader(<var>stream</var>)</dfn> performs
 the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new④">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①⓪">ReadableStreamBYOBReader</a></code>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-byob-reader" id="ref-for-set-up-readable-stream-byob-reader①">SetUpReadableStreamBYOBReader</a>(<var>reader</var>, <var>stream</var>).</p>
     <li data-md>
      <p>Return <var>reader</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="AcquireReadableStreamDefaultReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="AcquireReadableStreamDefaultReader" id="acquire-readable-stream-reader">AcquireReadableStreamDefaultReader(<var>stream</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new⑤">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⓪">ReadableStreamDefaultReader</a></code>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-default-reader" id="ref-for-set-up-readable-stream-default-reader①">SetUpReadableStreamDefaultReader</a>(<var>reader</var>, <var>stream</var>).</p>
     <li data-md>
      <p>Return <var>reader</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="CreateReadableStream">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="CreateReadableStream" id="create-readable-stream">CreateReadableStream(<var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>[, <var>highWaterMark</var>, [, <var>sizeAlgorithm</var>]])</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>highWaterMark</var> was not passed, set it to 1.</p>
     <li data-md>
      <p>If <var>sizeAlgorithm</var> was not passed, set it to an algorithm that returns 1.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-non-negative-number" id="ref-for-is-non-negative-number">IsNonNegativeNumber</a>(<var>highWaterMark</var>) is true.</p>
     <li data-md>
      <p>Let <var>stream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new⑥">new</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③②">ReadableStream</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-readable-stream" id="ref-for-initialize-readable-stream①">InitializeReadableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new⑦">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller⑨">ReadableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-default-controller" id="ref-for-set-up-readable-stream-default-controller">SetUpReadableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
     <li data-md>
      <p>Return <var>stream</var>.</p>
    </ol>
    <p class="note" role="note">This abstract operation will throw an exception if and only if the supplied <var>startAlgorithm</var> throws. </p>
   </div>
   <div class="algorithm" data-algorithm="InitializeReadableStream">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="InitializeReadableStream" id="initialize-readable-stream">InitializeReadableStream(<var>stream</var>)</dfn> performs the following
 steps: 
    <ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②">[[state]]</a> to "<code>readable</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader">[[reader]]</a> and <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror">[[storedError]]</a> to
  undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed">[[disturbed]]</a> to false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="IsReadableStreamLocked">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="IsReadableStreamLocked" id="is-readable-stream-locked">IsReadableStreamLocked(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①">[[reader]]</a> is undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamPipeTo">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamPipeTo" id="readable-stream-pipe-to">ReadableStreamPipeTo(<var>source</var>, <var>dest</var>, <var>preventClose</var>, <var>preventAbort</var>, <var>preventCancel</var>[, <var>signal</var>])</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>source</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③③">ReadableStream</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>dest</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①">implements</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream⑤">WritableStream</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>preventClose</var>, <var>preventAbort</var>, and <var>preventCancel</var> are all booleans.</p>
     <li data-md>
      <p>If <var>signal</var> was not given, let <var>signal</var> be undefined.</p>
     <li data-md>
      <p class="assertion">Assert: either <var>signal</var> is undefined, or <var>signal</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements②">implements</a> <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal③">AbortSignal</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked⑤">IsReadableStreamLocked</a>(<var>source</var>) is false.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked②">IsWritableStreamLocked</a>(<var>dest</var>) is false.</p>
     <li data-md>
      <p>If <var>source</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller">[[controller]]</a> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements③">implements</a> <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①②">ReadableByteStreamController</a></code>,
  let <var>reader</var> be either ! <a data-link-type="abstract-op" href="#acquire-readable-stream-byob-reader" id="ref-for-acquire-readable-stream-byob-reader①">AcquireReadableStreamBYOBReader</a>(<var>source</var>) or ! <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader②">AcquireReadableStreamDefaultReader</a>(<var>source</var>), at the user agent’s discretion.</p>
     <li data-md>
      <p>Otherwise, let <var>reader</var> be ! <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader③">AcquireReadableStreamDefaultReader</a>(<var>source</var>).</p>
     <li data-md>
      <p>Let <var>writer</var> be ! <a data-link-type="abstract-op" href="#acquire-writable-stream-default-writer" id="ref-for-acquire-writable-stream-default-writer">AcquireWritableStreamDefaultWriter</a>(<var>dest</var>).</p>
     <li data-md>
      <p>Set <var>source</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed①">[[disturbed]]</a> to true.</p>
     <li data-md>
      <p>Let <var>shuttingDown</var> be false.</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise③">a new promise</a>.</p>
     <li data-md>
      <p>If <var>signal</var> is not undefined,</p>
      <ol>
       <li data-md>
        <p>Let <var>abortAlgorithm</var> be the following steps:</p>
        <ol>
         <li data-md>
          <p>Let <var>error</var> be a new "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#aborterror" id="ref-for-aborterror">AbortError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException①">DOMException</a></code>.</p>
         <li data-md>
          <p>Let <var>actions</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ordered-set" id="ref-for-ordered-set">ordered set</a>.</p>
         <li data-md>
          <p>If <var>preventAbort</var> is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append">append</a> the following action to <var>actions</var>:</p>
          <ol>
           <li data-md>
            <p>If <var>dest</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state">[[state]]</a> is "<code>writable</code>", return ! <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort">WritableStreamAbort</a>(<var>dest</var>, <var>error</var>).</p>
           <li data-md>
            <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②">a promise resolved with</a> undefined.</p>
          </ol>
         <li data-md>
          <p>If <var>preventCancel</var> is false, <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#set-append" id="ref-for-set-append①">append</a> the following action action to <var>actions</var>:</p>
          <ol>
           <li data-md>
            <p>If <var>source</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③">[[state]]</a> is "<code>readable</code>", return ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel①">ReadableStreamCancel</a>(<var>source</var>, <var>error</var>).</p>
           <li data-md>
            <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③">a promise resolved with</a> undefined.</p>
          </ol>
         <li data-md>
          <p><a data-link-type="dfn" href="#rs-pipeTo-shutdown-with-action" id="ref-for-rs-pipeTo-shutdown-with-action">Shutdown with an action</a> consisting of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#waiting-for-all-promise" id="ref-for-waiting-for-all-promise">getting a promise to wait for all</a> of the actions
  in <var>actions</var>, and with <var>error</var>.</p>
        </ol>
       <li data-md>
        <p>If <var>signal</var>’s <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#abortsignal-aborted-flag" id="ref-for-abortsignal-aborted-flag">aborted flag</a> is set, perform <var>abortAlgorithm</var> and return <var>promise</var>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://dom.spec.whatwg.org/#abortsignal-add" id="ref-for-abortsignal-add">Add</a> <var>abortAlgorithm</var> to <var>signal</var>.</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel" id="ref-for-in-parallel">In parallel</a> <span class="XXX">but not really; see <a href="https://github.com/whatwg/streams/issues/905">#905</a></span>, using <var>reader</var> and <var>writer</var>, read all <a data-link-type="dfn" href="#chunk" id="ref-for-chunk③⑨">chunks</a> from <var>source</var> and write them to <var>dest</var>. Due to the locking
  provided by the reader and writer, the exact manner in which this happens is not observable to
  author code, and so there is flexibility in how this is done. The following constraints apply
  regardless of the exact algorithm used:</p>
      <ul>
       <li data-md>
        <p><strong>Public API must not be used:</strong> while reading or writing, or performing any of
 the operations below, the JavaScript-modifiable reader, writer, and stream APIs (i.e. methods
 on the appropriate prototypes) must not be used. Instead, the streams must be manipulated
 directly.</p>
       <li data-md>
        <p><strong>Backpressure must be enforced:</strong></p>
        <ul>
         <li data-md>
          <p>While <a data-link-type="abstract-op" href="#writable-stream-default-writer-get-desired-size" id="ref-for-writable-stream-default-writer-get-desired-size">WritableStreamDefaultWriterGetDesiredSize</a>(<var>writer</var>) is ≤ 0 or is null, the user
 agent must not read from <var>reader</var>.</p>
         <li data-md>
          <p>If <var>reader</var> is a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers⑥">BYOB reader</a>, <a data-link-type="abstract-op" href="#writable-stream-default-writer-get-desired-size" id="ref-for-writable-stream-default-writer-get-desired-size①">WritableStreamDefaultWriterGetDesiredSize</a>(<var>writer</var>)
 should be used as a basis to determine the size of the chunks read from <var>reader</var>.</p>
          <p class="note" role="note">It’s frequently inefficient to read chunks that are too small or too large.
 Other information might be factored in to determine the optimal chunk size. </p>
         <li data-md>
          <p>Reads or writes should not be delayed for reasons other than these backpressure signals.</p>
          <p class="example" id="example-bad-backpressure"><a class="self-link" href="#example-bad-backpressure"></a>An implementation that waits for each write
 to successfully complete before proceeding to the next read/write operation violates this
 recommendation. In doing so, such an implementation makes the <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues⑦">internal queue</a> of <var>dest</var> useless, as it ensures <var>dest</var> always contains at most one queued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⓪">chunk</a>. </p>
        </ul>
       <li data-md>
        <p><strong>Shutdown must stop activity:</strong> if <var>shuttingDown</var> becomes true, the user agent
 must not initiate further reads from <var>reader</var>, and must only perform writes of already-read <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④①">chunks</a>, as described below. In particular, the user agent must check the below conditions
 before performing any reads or writes, since they might lead to immediate shutdown.</p>
       <li data-md>
        <p><strong>Error and close states must be propagated:</strong> the following conditions must be
 applied in order.</p>
        <ol>
         <li data-md>
          <p><strong>Errors must be propagated forward:</strong> if <var>source</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state④">[[state]]</a> is or becomes "<code>errored</code>", then</p>
          <ol>
           <li data-md>
            <p>If <var>preventAbort</var> is false, <a data-link-type="dfn" href="#rs-pipeTo-shutdown-with-action" id="ref-for-rs-pipeTo-shutdown-with-action①">shutdown with an action</a> of ! <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort①">WritableStreamAbort</a>(<var>dest</var>, <var>source</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror①">[[storedError]]</a>) and with <var>source</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror②">[[storedError]]</a>.</p>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="#rs-pipeTo-shutdown" id="ref-for-rs-pipeTo-shutdown">shutdown</a> with <var>source</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror③">[[storedError]]</a>.</p>
          </ol>
         <li data-md>
          <p><strong>Errors must be propagated backward:</strong> if <var>dest</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①">[[state]]</a> is or becomes "<code>errored</code>", then</p>
          <ol>
           <li data-md>
            <p>If <var>preventCancel</var> is false, <a data-link-type="dfn" href="#rs-pipeTo-shutdown-with-action" id="ref-for-rs-pipeTo-shutdown-with-action②">shutdown with an action</a> of ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel②">ReadableStreamCancel</a>(<var>source</var>, <var>dest</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror">[[storedError]]</a>) and with <var>dest</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①">[[storedError]]</a>.</p>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="#rs-pipeTo-shutdown" id="ref-for-rs-pipeTo-shutdown①">shutdown</a> with <var>dest</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror②">[[storedError]]</a>.</p>
          </ol>
         <li data-md>
          <p><strong>Closing must be propagated forward:</strong> if <var>source</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state⑤">[[state]]</a> is or becomes "<code>closed</code>", then</p>
          <ol>
           <li data-md>
            <p>If <var>preventClose</var> is false, <a data-link-type="dfn" href="#rs-pipeTo-shutdown-with-action" id="ref-for-rs-pipeTo-shutdown-with-action③">shutdown with an action</a> of ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-close-with-error-propagation" id="ref-for-writable-stream-default-writer-close-with-error-propagation">WritableStreamDefaultWriterCloseWithErrorPropagation</a>(<var>writer</var>).</p>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="#rs-pipeTo-shutdown" id="ref-for-rs-pipeTo-shutdown②">shutdown</a>.</p>
          </ol>
         <li data-md>
          <p><strong>Closing must be propagated backward:</strong> if ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight">WritableStreamCloseQueuedOrInFlight</a>(<var>dest</var>) is true or <var>dest</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②">[[state]]</a> is "<code>closed</code>", then</p>
          <ol>
           <li data-md>
            <p class="assertion">Assert: no <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④②">chunks</a> have been read or written.</p>
           <li data-md>
            <p>Let <var>destClosed</var> be a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⓪">TypeError</a></code>.</p>
           <li data-md>
            <p>If <var>preventCancel</var> is false, <a data-link-type="dfn" href="#rs-pipeTo-shutdown-with-action" id="ref-for-rs-pipeTo-shutdown-with-action④">shutdown with an action</a> of ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel③">ReadableStreamCancel</a>(<var>source</var>, <var>destClosed</var>) and with <var>destClosed</var>.</p>
           <li data-md>
            <p>Otherwise, <a data-link-type="dfn" href="#rs-pipeTo-shutdown" id="ref-for-rs-pipeTo-shutdown③">shutdown</a> with <var>destClosed</var>.</p>
          </ol>
        </ol>
       <li data-md>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rs-pipeTo-shutdown-with-action"><i>Shutdown with an action</i></dfn>: if any of the
 above requirements ask to shutdown with an action <var>action</var>, optionally with an error <var>originalError</var>, then:</p>
        <ol>
         <li data-md>
          <p>If <var>shuttingDown</var> is true, abort these substeps.</p>
         <li data-md>
          <p>Set <var>shuttingDown</var> to true.</p>
         <li data-md>
          <p>If <var>dest</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③">[[state]]</a> is "<code>writable</code>" and ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight①">WritableStreamCloseQueuedOrInFlight</a>(<var>dest</var>) is false,</p>
          <ol>
           <li data-md>
            <p>If any <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④③">chunks</a> have been read but not yet written, write them to <var>dest</var>.</p>
           <li data-md>
            <p>Wait until every <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④④">chunk</a> that has been read has been written (i.e. the corresponding
  promises have settled).</p>
          </ol>
         <li data-md>
          <p>Let <var>p</var> be the result of performing <var>action</var>.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment">Upon fulfillment</a> of <var>p</var>, <a data-link-type="dfn" href="#rs-pipeTo-finalize" id="ref-for-rs-pipeTo-finalize">finalize</a>, passing along <var>originalError</var> if it was given.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection">Upon rejection</a> of <var>p</var> with reason <var>newError</var>, <a data-link-type="dfn" href="#rs-pipeTo-finalize" id="ref-for-rs-pipeTo-finalize①">finalize</a> with <var>newError</var>.</p>
        </ol>
       <li data-md>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rs-pipeTo-shutdown"><i>Shutdown</i></dfn>: if any of the above requirements or steps
 ask to shutdown, optionally with an error <var>error</var>, then:</p>
        <ol>
         <li data-md>
          <p>If <var>shuttingDown</var> is true, abort these substeps.</p>
         <li data-md>
          <p>Set <var>shuttingDown</var> to true.</p>
         <li data-md>
          <p>If <var>dest</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state④">[[state]]</a> is "<code>writable</code>" and ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight②">WritableStreamCloseQueuedOrInFlight</a>(<var>dest</var>) is false,</p>
          <ol>
           <li data-md>
            <p>If any <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⑤">chunks</a> have been read but not yet written, write them to <var>dest</var>.</p>
           <li data-md>
            <p>Wait until every <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⑥">chunk</a> that has been read has been written (i.e. the corresponding
  promises have settled).</p>
          </ol>
         <li data-md>
          <p><a data-link-type="dfn" href="#rs-pipeTo-finalize" id="ref-for-rs-pipeTo-finalize②">Finalize</a>, passing along <var>error</var> if it was given.</p>
        </ol>
       <li data-md>
        <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="rs-pipeTo-finalize"><i>Finalize</i></dfn>: both forms of shutdown will eventually ask
 to finalize, optionally with an error <var>error</var>, which means to perform the following steps:</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-release" id="ref-for-writable-stream-default-writer-release">WritableStreamDefaultWriterRelease</a>(<var>writer</var>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release⑥">ReadableStreamReaderGenericRelease</a>(<var>reader</var>).</p>
         <li data-md>
          <p>If <var>signal</var> is not undefined, <a data-link-type="dfn" href="https://dom.spec.whatwg.org/#abortsignal-remove" id="ref-for-abortsignal-remove">remove</a> <var>abortAlgorithm</var> from <var>signal</var>.</p>
         <li data-md>
          <p>If <var>error</var> was given, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject③">reject</a> <var>promise</var> with <var>error</var>.</p>
         <li data-md>
          <p>Otherwise, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve⑥">resolve</a> <var>promise</var> with undefined.</p>
        </ol>
      </ul>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <p class="note" role="note">Various abstract operations performed here include object creation (often of
promises), which usually would require specifying a realm for the created object. However, because
of the locking, none of these objects can be observed by author code. As such, the realm used to
create them does not matter. </p>
   <div class="algorithm" data-algorithm="ReadableStreamTee">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamTee" id="readable-stream-tee">ReadableStreamTee(<var>stream</var>, <var>cloneForBranch2</var>)</dfn> will <a data-link-type="dfn" href="#tee-a-readable-stream" id="ref-for-tee-a-readable-stream③">tee</a> a given readable stream. 
    <p>The second argument, <var>cloneForBranch2</var>, governs whether or not the data from the original stream
 will be cloned (using HTML’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#serializable-objects" id="ref-for-serializable-objects">serializable objects</a> framework) before appearing in the second of
 the returned branches. This is useful for scenarios where both branches are to be consumed in such
 a way that they might otherwise interfere with each other, such as by <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects" id="ref-for-transferable-objects①">transferring</a> their <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⑦">chunks</a>. However, it does introduce a noticeable asymmetry between
 the two branches, and limits the possible <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⑧">chunks</a> to serializable ones. <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a></p>
    <p class="note" role="note">In this standard ReadableStreamTee is always called with <var>cloneForBranch2</var> set to
 false; other specifications pass true via the <a data-link-type="dfn" href="#readablestream-tee" id="ref-for-readablestream-tee">tee</a> wrapper algorithm. </p>
    <p>It performs the following steps:</p>
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements④">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③④">ReadableStream</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>cloneForBranch2</var> is a boolean.</p>
     <li data-md>
      <p>Let <var>reader</var> be ? <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader④">AcquireReadableStreamDefaultReader</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>reading</var> be false.</p>
     <li data-md>
      <p>Let <var>canceled1</var> be false.</p>
     <li data-md>
      <p>Let <var>canceled2</var> be false.</p>
     <li data-md>
      <p>Let <var>reason1</var> be undefined.</p>
     <li data-md>
      <p>Let <var>reason2</var> be undefined.</p>
     <li data-md>
      <p>Let <var>branch1</var> be undefined.</p>
     <li data-md>
      <p>Let <var>branch2</var> be undefined.</p>
     <li data-md>
      <p>Let <var>cancelPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise④">a new promise</a>.</p>
     <li data-md>
      <p>Let <var>pullAlgorithm</var> be the following steps:</p>
      <ol>
       <li data-md>
        <p>If <var>reading</var> is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with④">a promise resolved with</a> undefined.</p>
       <li data-md>
        <p>Set <var>reading</var> to true.</p>
       <li data-md>
        <p>Let <var>readRequest</var> be a <a data-link-type="dfn" href="#read-request" id="ref-for-read-request③">read request</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item⑦">items</a>:</p>
        <dl>
         <dt data-md><a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps④">chunk steps</a>, given <var>value</var>
         <dd data-md>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask" id="ref-for-queue-a-microtask">Queue a microtask</a> to perform the following steps:</p>
            <ol>
             <li data-md>
              <p>Set <var>reading</var> to false.</p>
             <li data-md>
              <p>Let <var>value1</var> and <var>value2</var> be <var>value</var>.</p>
             <li data-md>
              <p>If <var>canceled2</var> is false and <var>cloneForBranch2</var> is true, set <var>value2</var> to ? <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize" id="ref-for-structureddeserialize">StructuredDeserialize</a>(? <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserialize" id="ref-for-structuredserialize">StructuredSerialize</a>(<var>value2</var>), <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm④">the current Realm</a>).</p>
             <li data-md>
              <p>If <var>canceled1</var> is false, perform ? <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue①">ReadableStreamDefaultControllerEnqueue</a>(<var>branch1</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①">[[controller]]</a>, <var>value1</var>).</p>
             <li data-md>
              <p>If <var>canceled2</var> is false, perform ? <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue②">ReadableStreamDefaultControllerEnqueue</a>(<var>branch2</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller②">[[controller]]</a>, <var>value2</var>).</p>
            </ol>
          </ol>
          <p class="note" role="note">The microtask delay here is necessary because it takes at least a microtask to
detect errors, when we use <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise①">[[closedPromise]]</a> below.
We want errors in <var>stream</var> to error both branches immediately, so we cannot let successful
synchronously-available reads happen ahead of asynchronously-available errors. </p>
         <dt data-md><a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps②">close steps</a>
         <dd data-md>
          <ol>
           <li data-md>
            <p>Set <var>reading</var> to false.</p>
           <li data-md>
            <p>If <var>canceled1</var> is false, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close①">ReadableStreamDefaultControllerClose</a>(<var>branch1</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller③">[[controller]]</a>).</p>
           <li data-md>
            <p>If <var>canceled2</var> is false, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close②">ReadableStreamDefaultControllerClose</a>(<var>branch2</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller④">[[controller]]</a>).</p>
           <li data-md>
            <p>If <var>canceled1</var> is false or <var>canceled2</var> is false, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve⑦">resolve</a> <var>cancelPromise</var> with undefined.</p>
          </ol>
         <dt data-md><a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps③">error steps</a>
         <dd data-md>
          <ol>
           <li data-md>
            <p>Set <var>reading</var> to false.</p>
          </ol>
        </dl>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-reader-read" id="ref-for-readable-stream-default-reader-read②">ReadableStreamDefaultReaderRead</a>(<var>reader</var>, <var>readRequest</var>).</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with⑤">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>cancel1Algorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Set <var>canceled1</var> to true.</p>
       <li data-md>
        <p>Set <var>reason1</var> to <var>reason</var>.</p>
       <li data-md>
        <p>If <var>canceled2</var> is true,</p>
        <ol>
         <li data-md>
          <p>Let <var>compositeReason</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createarrayfromlist" id="ref-for-sec-createarrayfromlist">CreateArrayFromList</a>(« <var>reason1</var>, <var>reason2</var> »).</p>
         <li data-md>
          <p>Let <var>cancelResult</var> be ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel④">ReadableStreamCancel</a>(<var>stream</var>, <var>compositeReason</var>).</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve⑧">Resolve</a> <var>cancelPromise</var> with <var>cancelResult</var>.</p>
        </ol>
       <li data-md>
        <p>Return <var>cancelPromise</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>cancel2Algorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Set <var>canceled2</var> to true.</p>
       <li data-md>
        <p>Set <var>reason2</var> to <var>reason</var>.</p>
       <li data-md>
        <p>If <var>canceled1</var> is true,</p>
        <ol>
         <li data-md>
          <p>Let <var>compositeReason</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createarrayfromlist" id="ref-for-sec-createarrayfromlist①">CreateArrayFromList</a>(« <var>reason1</var>, <var>reason2</var> »).</p>
         <li data-md>
          <p>Let <var>cancelResult</var> be ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel⑤">ReadableStreamCancel</a>(<var>stream</var>, <var>compositeReason</var>).</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve⑨">Resolve</a> <var>cancelPromise</var> with <var>cancelResult</var>.</p>
        </ol>
       <li data-md>
        <p>Return <var>cancelPromise</var>.</p>
      </ol>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Set <var>branch1</var> to ! <a data-link-type="abstract-op" href="#create-readable-stream" id="ref-for-create-readable-stream">CreateReadableStream</a>(<var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancel1Algorithm</var>).</p>
     <li data-md>
      <p>Set <var>branch2</var> to ! <a data-link-type="abstract-op" href="#create-readable-stream" id="ref-for-create-readable-stream①">CreateReadableStream</a>(<var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancel2Algorithm</var>).</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection①">Upon rejection</a> of <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise②">[[closedPromise]]</a> with reason <var>r</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error①">ReadableStreamDefaultControllerError</a>(<var>branch1</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller⑤">[[controller]]</a>, <var>r</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error②">ReadableStreamDefaultControllerError</a>(<var>branch2</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller⑥">[[controller]]</a>, <var>r</var>).</p>
       <li data-md>
        <p>If <var>canceled1</var> is false or <var>canceled2</var> is false, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⓪">resolve</a> <var>cancelPromise</var> with undefined.</p>
      </ol>
     <li data-md>
      <p>Return « <var>branch1</var>, <var>branch2</var> ».</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.9.2" id="rs-abstract-ops-used-by-controllers"><span class="secno">4.9.2. </span><span class="content">Interfacing with controllers</span><a class="self-link" href="#rs-abstract-ops-used-by-controllers"></a></h4>
   <p>In terms of specification factoring, the way that the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⑤">ReadableStream</a></code> class encapsulates the
behavior of both simple readable streams and <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①①">readable byte streams</a> into a single class is by
centralizing most of the potentially-varying logic inside the two controller classes, <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①⓪">ReadableStreamDefaultController</a></code> and <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①③">ReadableByteStreamController</a></code>. Those classes define most
of the stateful internal slots and abstract operations for how a stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues⑧">internal queue</a> is
managed and how it interfaces with its <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②②">underlying source</a> or <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①③">underlying byte source</a>.</p>
   <p>Each controller class defines two internal methods, which are called by the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⑥">ReadableStream</a></code> algorithms:</p>
   <dl>
    <dt><dfn class="dfn-paneled" data-dfn-for="ReadableStreamController" data-dfn-type="abstract-op" data-export data-lt="[[CancelSteps]]" id="abstract-opdef-readablestreamcontroller-cancelsteps">[[CancelSteps]](<var>reason</var>)</dfn> 
    <dd>The controller’s steps that run in reaction to the stream being <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream⑨">canceled</a>, used to clean up the state stored in the controller and inform the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②③">underlying source</a>. 
    <dt><dfn class="dfn-paneled" data-dfn-for="ReadableStreamController" data-dfn-type="abstract-op" data-export data-lt="[[PullSteps]]" id="abstract-opdef-readablestreamcontroller-pullsteps">[[PullSteps]](<var>readRequest</var>)</dfn> 
    <dd>The controller’s steps that run when a <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers③">default reader</a> is read from, used to pull from the
  controller any queued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk④⑨">chunks</a>, or pull from the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②④">underlying source</a> to get more chunks. 
   </dl>
   <p>(These are defined as internal methods, instead of as abstract operations, so that they can be
called polymorphically by the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⑦">ReadableStream</a></code> algorithms, without having to branch on which type
of controller is present.)</p>
   <p>The rest of this section concerns abstract operations that go in the other direction: they are
used by the controller implementations to affect their associated <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⑧">ReadableStream</a></code> object. This
translates internal state changes of the controller into developer-facing results visible through
the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream③⑨">ReadableStream</a></code>'s public API.</p>
   <div class="algorithm" data-algorithm="ReadableStreamAddReadIntoRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamAddReadIntoRequest" id="readable-stream-add-read-into-request">ReadableStreamAddReadIntoRequest(<var>stream</var>, <var>readRequest</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader②">[[reader]]</a> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements⑤">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①①">ReadableStreamBYOBReader</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state⑥">[[state]]</a> is "<code>readable</code>" or "<code>closed</code>".</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append①">Append</a> <var>readRequest</var> to <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader③">[[reader]]</a>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests①">[[readIntoRequests]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamAddReadRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamAddReadRequest" id="readable-stream-add-read-request">ReadableStreamAddReadRequest(<var>stream</var>, <var>readRequest</var></dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader④">[[reader]]</a> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements⑥">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①①">ReadableStreamDefaultReader</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state⑦">[[state]]</a> is "<code>readable</code>".</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append②">Append</a> <var>readRequest</var> to <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader⑤">[[reader]]</a>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests②">[[readRequests]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamCancel">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamCancel" id="readable-stream-cancel">ReadableStreamCancel(<var>stream</var>, <var>reason</var>)</dfn> performs the following
 steps: 
    <ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed②">[[disturbed]]</a> to true.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state⑧">[[state]]</a> is "<code>closed</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with⑥">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state⑨">[[state]]</a> is "<code>errored</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with⑨">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror④">[[storedError]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-close" id="ref-for-readable-stream-close①">ReadableStreamClose</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>sourceCancelPromise</var> be ! <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller⑦">[[controller]]</a>.<a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-cancelsteps" id="ref-for-abstract-opdef-readablestreamcontroller-cancelsteps②">[[CancelSteps]]</a>(<var>reason</var>).</p>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled" id="ref-for-dfn-perform-steps-once-promise-is-settled">reacting</a> to <var>sourceCancelPromise</var> with a fulfillment step that returns
  undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamClose" id="readable-stream-close">ReadableStreamClose(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⓪">[[state]]</a> is "<code>readable</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①①">[[state]]</a> to "<code>closed</code>".</p>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader⑥">[[reader]]</a>.</p>
     <li data-md>
      <p>If <var>reader</var> is undefined, return.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①①">Resolve</a> <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise③">[[closedPromise]]</a> with undefined.</p>
     <li data-md>
      <p>If <var>reader</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements⑦">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①②">ReadableStreamDefaultReader</a></code>,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate">For each</a> <var>readRequest</var> of <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests③">[[readRequests]]</a>,</p>
        <ol>
         <li data-md>
          <p>Perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps③">close steps</a>.</p>
        </ol>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests④">[[readRequests]]</a> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑤">list</a>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamError" id="readable-stream-error">ReadableStreamError(<var>stream</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①②">[[state]]</a> is "<code>readable</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①③">[[state]]</a> to "<code>errored</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror⑤">[[storedError]]</a> to <var>e</var>.</p>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader⑦">[[reader]]</a>.</p>
     <li data-md>
      <p>If <var>reader</var> is undefined, return.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject④">Reject</a> <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise④">[[closedPromise]]</a> with <var>e</var>.</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise⑤">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>If <var>reader</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements⑧">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①③">ReadableStreamDefaultReader</a></code>,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate①">For each</a> <var>readRequest</var> of <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests⑤">[[readRequests]]</a>,</p>
        <ol>
         <li data-md>
          <p>Perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps④">error steps</a>, given <var>e</var>.</p>
        </ol>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests⑥">[[readRequests]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑥">list</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>reader</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements⑨">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①②">ReadableStreamBYOBReader</a></code>.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate②">For each</a> <var>readIntoRequest</var> of <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests②">[[readIntoRequests]]</a>,</p>
        <ol>
         <li data-md>
          <p>Perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-error-steps" id="ref-for-read-into-request-error-steps①">error steps</a>, given <var>e</var>.</p>
        </ol>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests③">[[readIntoRequests]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑦">list</a>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamFulfillReadIntoRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamFulfillReadIntoRequest" id="readable-stream-fulfill-read-into-request">ReadableStreamFulfillReadIntoRequest(<var>stream</var>, <var>chunk</var>, <var>done</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-has-byob-reader" id="ref-for-readable-stream-has-byob-reader">ReadableStreamHasBYOBReader</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader⑧">[[reader]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests④">[[readIntoRequests]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑦">empty</a>.</p>
     <li data-md>
      <p>Let <var>readIntoRequest</var> be <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests⑤">[[readIntoRequests]]</a>[0].</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove①">Remove</a> <var>readIntoRequest</var> from <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests⑥">[[readIntoRequests]]</a>.</p>
     <li data-md>
      <p>If <var>done</var> is true, perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-close-steps" id="ref-for-read-into-request-close-steps②">close steps</a>, given <var>chunk</var>.</p>
     <li data-md>
      <p>Otherwise, perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-chunk-steps" id="ref-for-read-into-request-chunk-steps①">chunk steps</a>, given <var>chunk</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamFulfillReadRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamFulfillReadRequest" id="readable-stream-fulfill-read-request">ReadableStreamFulfillReadRequest(<var>stream</var>, <var>chunk</var>, <var>done</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-has-default-reader" id="ref-for-readable-stream-has-default-reader①">ReadableStreamHasDefaultReader</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader⑨">[[reader]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests⑦">[[readRequests]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑧">empty</a>.</p>
     <li data-md>
      <p>Let <var>readRequest</var> be <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests⑧">[[readRequests]]</a>[0].</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove②">Remove</a> <var>readRequest</var> from <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests⑨">[[readRequests]]</a>.</p>
     <li data-md>
      <p>If <var>done</var> is true, perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps④">close steps</a>.</p>
     <li data-md>
      <p>Otherwise, perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps⑤">chunk steps</a>, given <var>chunk</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamGetNumReadIntoRequests">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamGetNumReadIntoRequests" id="readable-stream-get-num-read-into-requests">ReadableStreamGetNumReadIntoRequests(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-has-byob-reader" id="ref-for-readable-stream-has-byob-reader①">ReadableStreamHasBYOBReader</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p>Return <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①⓪">[[reader]]</a>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests⑦">[[readIntoRequests]]</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size">size</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamGetNumReadRequests">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamGetNumReadRequests" id="readable-stream-get-num-read-requests">ReadableStreamGetNumReadRequests(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#readable-stream-has-default-reader" id="ref-for-readable-stream-has-default-reader②">ReadableStreamHasDefaultReader</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p>Return <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①①">[[reader]]</a>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests①⓪">[[readRequests]]</a>'s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-size" id="ref-for-list-size①">size</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamHasBYOBReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamHasBYOBReader" id="readable-stream-has-byob-reader">ReadableStreamHasBYOBReader(<var>stream</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①②">[[reader]]</a>.</p>
     <li data-md>
      <p>If <var>reader</var> is undefined, return false.</p>
     <li data-md>
      <p>If <var>reader</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①⓪">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①③">ReadableStreamBYOBReader</a></code>, return true.</p>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamHasDefaultReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamHasDefaultReader" id="readable-stream-has-default-reader">ReadableStreamHasDefaultReader(<var>stream</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p>Let <var>reader</var> be <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①③">[[reader]]</a>.</p>
     <li data-md>
      <p>If <var>reader</var> is undefined, return false.</p>
     <li data-md>
      <p>If <var>reader</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①①">implements</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①④">ReadableStreamDefaultReader</a></code>, return true.</p>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.9.3" id="rs-reader-abstract-ops"><span class="secno">4.9.3. </span><span class="content">Readers</span><a class="self-link" href="#rs-reader-abstract-ops"></a></h4>
   <p>The following abstract operations support the implementation and manipulation of <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⑤">ReadableStreamDefaultReader</a></code> and <code class="idl"><a data-link-type="idl" href="#readablestreambyobreader" id="ref-for-readablestreambyobreader①④">ReadableStreamBYOBReader</a></code> instances.</p>
   <div class="algorithm" data-algorithm="ReadableStreamReaderGenericCancel">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamReaderGenericCancel" id="readable-stream-reader-generic-cancel">ReadableStreamReaderGenericCancel(<var>reader</var>, <var>reason</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①⓪">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel⑥">ReadableStreamCancel</a>(<var>stream</var>, <var>reason</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamReaderGenericInitialize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamReaderGenericInitialize" id="readable-stream-reader-generic-initialize">ReadableStreamReaderGenericInitialize(<var>reader</var>, <var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①①">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①④">[[reader]]</a> to <var>reader</var>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①④">[[state]]</a> is "<code>readable</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise⑥">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise⑤">a new promise</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise, if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⑤">[[state]]</a> is "<code>closed</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise⑦">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with⑦">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⑥">[[state]]</a> is "<code>errored</code>".</p>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise⑧">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⓪">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror⑥">[[storedError]]</a>.</p>
       <li data-md>
        <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise⑨">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamReaderGenericRelease">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamReaderGenericRelease" id="readable-stream-reader-generic-release">ReadableStreamReaderGenericRelease(<var>reader</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①②">[[stream]]</a> is not undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①③">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①⑤">[[reader]]</a> is <var>reader</var>.</p>
     <li data-md>
      <p>If <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①④">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⑦">[[state]]</a> is
  "<code>readable</code>", <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject⑤">reject</a> <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise①⓪">[[closedPromise]]</a> with a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③①">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Otherwise, set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise①①">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①①">a promise
  rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③②">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-closedpromise" id="ref-for-readablestreamgenericreader-closedpromise①②">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①⑤">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-reader" id="ref-for-readablestream-reader①⑥">[[reader]]</a> to
  undefined.</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①⑥">[[stream]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamBYOBReaderRead">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamBYOBReaderRead" id="readable-stream-byob-reader-read">ReadableStreamBYOBReaderRead(<var>reader</var>, <var>view</var>, <var>readIntoRequest</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①⑦">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed③">[[disturbed]]</a> to true.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⑧">[[state]]</a> is "<code>errored</code>", perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-error-steps" id="ref-for-read-into-request-error-steps②">error steps</a> given <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror⑦">[[storedError]]</a>.</p>
     <li data-md>
      <p>Otherwise, perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-pull-into" id="ref-for-readable-byte-stream-controller-pull-into">ReadableByteStreamControllerPullInto</a>(<var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller⑧">[[controller]]</a>, <var>view</var>, <var>readIntoRequest</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultReaderRead">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultReaderRead" id="readable-stream-default-reader-read">ReadableStreamDefaultReaderRead(<var>reader</var>, <var>readRequest</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>reader</var>.<a data-link-type="dfn" href="#readablestreamgenericreader-stream" id="ref-for-readablestreamgenericreader-stream①⑧">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed④">[[disturbed]]</a> to true.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state①⑨">[[state]]</a> is "<code>closed</code>", perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps⑤">close steps</a>.</p>
     <li data-md>
      <p>Otherwise, if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⓪">[[state]]</a> is "<code>errored</code>", perform <var>readRequest</var>’s <a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps⑤">error steps</a> given <var>stream</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror⑧">[[storedError]]</a>.</p>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②①">[[state]]</a> is "<code>readable</code>".</p>
       <li data-md>
        <p>Perform ! <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller⑨">[[controller]]</a>.<a data-link-type="abstract-op" href="#abstract-opdef-readablestreamcontroller-pullsteps" id="ref-for-abstract-opdef-readablestreamcontroller-pullsteps②">[[PullSteps]]</a>(<var>readRequest</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableStreamBYOBReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableStreamBYOBReader" id="set-up-readable-stream-byob-reader">SetUpReadableStreamBYOBReader(<var>reader</var>, <var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked⑥">IsReadableStreamLocked</a>(<var>stream</var>) is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③③">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⓪">[[controller]]</a> does not <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①②">implement</a> <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①④">ReadableByteStreamController</a></code>, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-initialize" id="ref-for-readable-stream-reader-generic-initialize">ReadableStreamReaderGenericInitialize</a>(<var>reader</var>, <var>stream</var>).</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreambyobreader-readintorequests" id="ref-for-readablestreambyobreader-readintorequests⑧">[[readIntoRequests]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑧">list</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableStreamDefaultReader">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableStreamDefaultReader" id="set-up-readable-stream-default-reader">SetUpReadableStreamDefaultReader(<var>reader</var>, <var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked⑦">IsReadableStreamLocked</a>(<var>stream</var>) is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑤">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-initialize" id="ref-for-readable-stream-reader-generic-initialize①">ReadableStreamReaderGenericInitialize</a>(<var>reader</var>, <var>stream</var>).</p>
     <li data-md>
      <p>Set <var>reader</var>.<a data-link-type="dfn" href="#readablestreamdefaultreader-readrequests" id="ref-for-readablestreamdefaultreader-readrequests①①">[[readRequests]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list⑨">list</a>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.9.4" id="rs-default-controller-abstract-ops"><span class="secno">4.9.4. </span><span class="content">Default controllers</span><a class="self-link" href="#rs-default-controller-abstract-ops"></a></h4>
   <p>The following abstract operations support the implementation of the <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①①">ReadableStreamDefaultController</a></code> class.</p>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerCallPullIfNeeded">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerCallPullIfNeeded" id="readable-stream-default-controller-call-pull-if-needed">ReadableStreamDefaultControllerCallPullIfNeeded(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>shouldPull</var> be ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-should-call-pull" id="ref-for-readable-stream-default-controller-should-call-pull">ReadableStreamDefaultControllerShouldCallPull</a>(<var>controller</var>).</p>
     <li data-md>
      <p>If <var>shouldPull</var> is false, return.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pulling" id="ref-for-readablestreamdefaultcontroller-pulling">[[pulling]]</a> is true,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain">[[pullAgain]]</a> to true.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain①">[[pullAgain]]</a> is false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pulling" id="ref-for-readablestreamdefaultcontroller-pulling①">[[pulling]]</a> to true.</p>
     <li data-md>
      <p>Let <var>pullPromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullalgorithm" id="ref-for-readablestreamdefaultcontroller-pullalgorithm">[[pullAlgorithm]]</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment①">Upon fulfillment</a> of <var>pullPromise</var>,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pulling" id="ref-for-readablestreamdefaultcontroller-pulling②">[[pulling]]</a> to false.</p>
       <li data-md>
        <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain②">[[pullAgain]]</a> is true,</p>
        <ol>
         <li data-md>
          <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain③">[[pullAgain]]</a> to false.</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-call-pull-if-needed" id="ref-for-readable-stream-default-controller-call-pull-if-needed②">ReadableStreamDefaultControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
        </ol>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection②">Upon rejection</a> of <var>pullPromise</var> with reason <var>e</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error③">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>e</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerShouldCallPull">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerShouldCallPull" id="readable-stream-default-controller-should-call-pull">ReadableStreamDefaultControllerShouldCallPull(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream">[[stream]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue②">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<var>controller</var>) is false, return false.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-started" id="ref-for-readablestreamdefaultcontroller-started">[[started]]</a> is false, return false.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked⑧">IsReadableStreamLocked</a>(<var>stream</var>) is true and ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-requests" id="ref-for-readable-stream-get-num-read-requests①">ReadableStreamGetNumReadRequests</a>(<var>stream</var>) > 0, return true.</p>
     <li data-md>
      <p>Let <var>desiredSize</var> be ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-get-desired-size" id="ref-for-readable-stream-default-controller-get-desired-size①">ReadableStreamDefaultControllerGetDesiredSize</a>(<var>controller</var>).</p>
     <li data-md>
      <p class="assertion">Assert: <var>desiredSize</var> is not null.</p>
     <li data-md>
      <p>If <var>desiredSize</var> > 0, return true.</p>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerClearAlgorithms">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerClearAlgorithms" id="readable-stream-default-controller-clear-algorithms">ReadableStreamDefaultControllerClearAlgorithms(<var>controller</var>)</dfn> is called once the stream is closed or errored and the algorithms will not be executed any more. By
 removing the algorithm references it permits the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⑤">underlying source</a> object to be garbage
 collected even if the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⓪">ReadableStream</a></code> itself is still referenced. 
    <p class="note" role="note">This is observable using <a href="https://github.com/tc39/proposal-weakrefs/">weak
 references</a>. See <a href="https://github.com/tc39/proposal-weakrefs/issues/31">tc39/proposal-weakrefs#31</a> for more
 detail. </p>
    <p>It performs the following steps:</p>
    <ol>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullalgorithm" id="ref-for-readablestreamdefaultcontroller-pullalgorithm①">[[pullAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-cancelalgorithm" id="ref-for-readablestreamdefaultcontroller-cancelalgorithm①">[[cancelAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-readablestreamdefaultcontroller-strategysizealgorithm">[[strategySizeAlgorithm]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerClose" id="readable-stream-default-controller-close">ReadableStreamDefaultControllerClose(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue③">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<var>controller</var>) is false, return.</p>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream①">[[stream]]</a>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-closerequested" id="ref-for-readablestreamdefaultcontroller-closerequested①">[[closeRequested]]</a> to true.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-queue" id="ref-for-readablestreamdefaultcontroller-queue③">[[queue]]</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty⑨">is empty</a>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-clear-algorithms" id="ref-for-readable-stream-default-controller-clear-algorithms②">ReadableStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-close" id="ref-for-readable-stream-close②">ReadableStreamClose</a>(<var>stream</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerEnqueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerEnqueue" id="readable-stream-default-controller-enqueue">ReadableStreamDefaultControllerEnqueue(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue④">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<var>controller</var>) is false, return.</p>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream②">[[stream]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked⑨">IsReadableStreamLocked</a>(<var>stream</var>) is true and ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-requests" id="ref-for-readable-stream-get-num-read-requests②">ReadableStreamGetNumReadRequests</a>(<var>stream</var>) > 0, perform ! <a data-link-type="abstract-op" href="#readable-stream-fulfill-read-request" id="ref-for-readable-stream-fulfill-read-request">ReadableStreamFulfillReadRequest</a>(<var>stream</var>, <var>chunk</var>, false).</p>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-readablestreamdefaultcontroller-strategysizealgorithm①">[[strategySizeAlgorithm]]</a>, passing in <var>chunk</var>,
  and interpreting the result as a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-completion-record-specification-type" id="ref-for-sec-completion-record-specification-type①">completion record</a>.</p>
       <li data-md>
        <p>If <var>result</var> is an abrupt completion,</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error④">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>result</var>.[[Value]]).</p>
         <li data-md>
          <p>Return <var>result</var>.</p>
        </ol>
       <li data-md>
        <p>Let <var>chunkSize</var> be <var>result</var>.[[Value]].</p>
       <li data-md>
        <p>Let <var>enqueueResult</var> be <a data-link-type="abstract-op" href="#enqueue-value-with-size" id="ref-for-enqueue-value-with-size">EnqueueValueWithSize</a>(<var>controller</var>, <var>chunk</var>, <var>chunkSize</var>).</p>
       <li data-md>
        <p>If <var>enqueueResult</var> is an abrupt completion,</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error⑤">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>enqueueResult</var>.[[Value]]).</p>
         <li data-md>
          <p>Return <var>enqueueResult</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-call-pull-if-needed" id="ref-for-readable-stream-default-controller-call-pull-if-needed③">ReadableStreamDefaultControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerError" id="readable-stream-default-controller-error">ReadableStreamDefaultControllerError(<var>controller</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream③">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②②">[[state]]</a> is not "<code>readable</code>", return.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue②">ResetQueue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-clear-algorithms" id="ref-for-readable-stream-default-controller-clear-algorithms③">ReadableStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-error" id="ref-for-readable-stream-error">ReadableStreamError</a>(<var>stream</var>, <var>e</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerGetDesiredSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerGetDesiredSize" id="readable-stream-default-controller-get-desired-size">ReadableStreamDefaultControllerGetDesiredSize(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream④">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②③">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>errored</code>", return null.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>", return 0.</p>
     <li data-md>
      <p>Return <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-strategyhwm" id="ref-for-readablestreamdefaultcontroller-strategyhwm">[[strategyHWM]]</a> − <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-queuetotalsize" id="ref-for-readablestreamdefaultcontroller-queuetotalsize">[[queueTotalSize]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerHasBackpressure">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerHasBackpressure" id="rs-default-controller-has-backpressure">ReadableStreamDefaultControllerHasBackpressure(<var>controller</var>)</dfn> is used in the implementation of <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②">TransformStream</a></code>. It performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-should-call-pull" id="ref-for-readable-stream-default-controller-should-call-pull①">ReadableStreamDefaultControllerShouldCallPull</a>(<var>controller</var>) is true, return false.</p>
     <li data-md>
      <p>Otherwise, return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableStreamDefaultControllerCanCloseOrEnqueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableStreamDefaultControllerCanCloseOrEnqueue" id="readable-stream-default-controller-can-close-or-enqueue">ReadableStreamDefaultControllerCanCloseOrEnqueue(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream⑤">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②④">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-closerequested" id="ref-for-readablestreamdefaultcontroller-closerequested②">[[closeRequested]]</a> is false and <var>state</var> is
  "<code>readable</code>", return true.</p>
     <li data-md>
      <p>Otherwise, return false.</p>
    </ol>
    <p class="note" role="note">The case where <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-closerequested" id="ref-for-readablestreamdefaultcontroller-closerequested③">[[closeRequested]]</a> is false, but <var>state</var> is not "<code>readable</code>", happens when the stream is errored via <code class="idl"><a data-link-type="idl" href="#rs-default-controller-error" id="ref-for-rs-default-controller-error②">controller.error()</a></code>, or when it is closed without its
 controller’s <code class="idl"><a data-link-type="idl" href="#rs-default-controller-close" id="ref-for-rs-default-controller-close②">controller.close()</a></code> method ever being
 called: e.g., if the stream was closed by a call to <code class="idl"><a data-link-type="idl" href="#rs-cancel" id="ref-for-rs-cancel⑥">stream.cancel()</a></code>. </p>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableStreamDefaultController">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableStreamDefaultController" id="set-up-readable-stream-default-controller">SetUpReadableStreamDefaultController(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①①">[[controller]]</a> is undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-stream" id="ref-for-readablestreamdefaultcontroller-stream⑥">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue③">ResetQueue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-started" id="ref-for-readablestreamdefaultcontroller-started①">[[started]]</a>, <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-closerequested" id="ref-for-readablestreamdefaultcontroller-closerequested④">[[closeRequested]]</a>, <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain④">[[pullAgain]]</a>, and <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pulling" id="ref-for-readablestreamdefaultcontroller-pulling③">[[pulling]]</a> to false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-readablestreamdefaultcontroller-strategysizealgorithm②">[[strategySizeAlgorithm]]</a> to <var>sizeAlgorithm</var> and <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-strategyhwm" id="ref-for-readablestreamdefaultcontroller-strategyhwm①">[[strategyHWM]]</a> to <var>highWaterMark</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullalgorithm" id="ref-for-readablestreamdefaultcontroller-pullalgorithm②">[[pullAlgorithm]]</a> to <var>pullAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-cancelalgorithm" id="ref-for-readablestreamdefaultcontroller-cancelalgorithm②">[[cancelAlgorithm]]</a> to <var>cancelAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①②">[[controller]]</a> to <var>controller</var>.</p>
     <li data-md>
      <p>Let <var>startResult</var> be the result of performing <var>startAlgorithm</var>. (This might throw an exception.)</p>
     <li data-md>
      <p>Let <var>startPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with⑧">a promise resolved with</a> <var>startResult</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment②">Upon fulfillment</a> of <var>startPromise</var>,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-started" id="ref-for-readablestreamdefaultcontroller-started②">[[started]]</a> to true.</p>
       <li data-md>
        <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pulling" id="ref-for-readablestreamdefaultcontroller-pulling④">[[pulling]]</a> is false.</p>
       <li data-md>
        <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablestreamdefaultcontroller-pullagain" id="ref-for-readablestreamdefaultcontroller-pullagain⑤">[[pullAgain]]</a> is false.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-call-pull-if-needed" id="ref-for-readable-stream-default-controller-call-pull-if-needed④">ReadableStreamDefaultControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection③">Upon rejection</a> of <var>startPromise</var> with reason <var>r</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error⑥">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>r</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableStreamDefaultControllerFromUnderlyingSource">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableStreamDefaultControllerFromUnderlyingSource" id="set-up-readable-stream-default-controller-from-underlying-source">SetUpReadableStreamDefaultControllerFromUnderlyingSource(<var>stream</var>, <var>controller</var>, <var>underlyingSource</var>, <var>underlyingSourceDict</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new⑧">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①②">ReadableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>pullAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with⑨">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>Let <var>cancelAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⓪">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start④">start</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑤">exists</a>, then set <var>startAlgorithm</var> to an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start⑤">start</a></code>"] with argument list
  « <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull④">pull</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑥">exists</a>, then set <var>pullAlgorithm</var> to an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function②">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull⑤">pull</a></code>"] with argument list
  « <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value①">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel②">cancel</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑦">exists</a>, then set <var>cancelAlgorithm</var> to an algorithm which takes an argument <var>reason</var> and returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function③">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel③">cancel</a></code>"] with argument list
  « <var>reason</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value②">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-stream-default-controller" id="ref-for-set-up-readable-stream-default-controller①">SetUpReadableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="4.9.5" id="rbs-controller-abstract-ops"><span class="secno">4.9.5. </span><span class="content">Byte stream controllers</span><a class="self-link" href="#rbs-controller-abstract-ops"></a></h4>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerCallPullIfNeeded">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerCallPullIfNeeded" id="readable-byte-stream-controller-call-pull-if-needed">ReadableByteStreamControllerCallPullIfNeeded(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>shouldPull</var> be ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-should-call-pull" id="ref-for-readable-byte-stream-controller-should-call-pull">ReadableByteStreamControllerShouldCallPull</a>(<var>controller</var>).</p>
     <li data-md>
      <p>If <var>shouldPull</var> is false, return.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pulling" id="ref-for-readablebytestreamcontroller-pulling">[[pulling]]</a> is true,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain">[[pullAgain]]</a> to true.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain①">[[pullAgain]]</a> is false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pulling" id="ref-for-readablebytestreamcontroller-pulling①">[[pulling]]</a> to true.</p>
     <li data-md>
      <p>Let <var>pullPromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullalgorithm" id="ref-for-readablebytestreamcontroller-pullalgorithm">[[pullAlgorithm]]</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment③">Upon fulfillment</a> of <var>pullPromise</var>,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pulling" id="ref-for-readablebytestreamcontroller-pulling②">[[pulling]]</a> to false.</p>
       <li data-md>
        <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain②">[[pullAgain]]</a> is true,</p>
        <ol>
         <li data-md>
          <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain③">[[pullAgain]]</a> to false.</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed①">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
        </ol>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection④">Upon rejection</a> of <var>pullPromise</var> with reason <var>e</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-error" id="ref-for-readable-byte-stream-controller-error①">ReadableByteStreamControllerError</a>(<var>controller</var>, <var>e</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerClearAlgorithms">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerClearAlgorithms" id="readable-byte-stream-controller-clear-algorithms">ReadableByteStreamControllerClearAlgorithms(<var>controller</var>)</dfn> is called once the stream is closed or errored and the algorithms will not be executed any more. By
 removing the algorithm references it permits the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①④">underlying byte source</a> object to be garbage
 collected even if the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④①">ReadableStream</a></code> itself is still referenced. 
    <p class="note" role="note">This is observable using <a href="https://github.com/tc39/proposal-weakrefs/">weak
 references</a>. See <a href="https://github.com/tc39/proposal-weakrefs/issues/31">tc39/proposal-weakrefs#31</a> for more
 detail. </p>
    <p>It performs the following steps:</p>
    <ol>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullalgorithm" id="ref-for-readablebytestreamcontroller-pullalgorithm①">[[pullAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-cancelalgorithm" id="ref-for-readablebytestreamcontroller-cancelalgorithm①">[[cancelAlgorithm]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerClearPendingPullIntos">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerClearPendingPullIntos" id="readable-byte-stream-controller-clear-pending-pull-intos">ReadableByteStreamControllerClearPendingPullIntos(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-invalidate-byob-request" id="ref-for-readable-byte-stream-controller-invalidate-byob-request">ReadableByteStreamControllerInvalidateBYOBRequest</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos⑤">[[pendingPullIntos]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①⓪">list</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerClose" id="readable-byte-stream-controller-close">ReadableByteStreamControllerClose(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream①">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested②">[[closeRequested]]</a> is true or <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⑤">[[state]]</a> is not "<code>readable</code>", return.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize④">[[queueTotalSize]]</a> > 0,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested③">[[closeRequested]]</a> to true.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos⑥">[[pendingPullIntos]]</a> is not empty,</p>
      <ol>
       <li data-md>
        <p>Let <var>firstPendingPullInto</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos⑦">[[pendingPullIntos]]</a>[0].</p>
       <li data-md>
        <p>If <var>firstPendingPullInto</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled④">bytes filled</a> > 0,</p>
        <ol>
         <li data-md>
          <p>Let <var>e</var> be a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑥">TypeError</a></code> exception.</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-error" id="ref-for-readable-byte-stream-controller-error②">ReadableByteStreamControllerError</a>(<var>controller</var>, <var>e</var>).</p>
         <li data-md>
          <p>Throw <var>e</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-clear-algorithms" id="ref-for-readable-byte-stream-controller-clear-algorithms①">ReadableByteStreamControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-close" id="ref-for-readable-stream-close③">ReadableStreamClose</a>(<var>stream</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerCommitPullIntoDescriptor">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerCommitPullIntoDescriptor" id="readable-byte-stream-controller-commit-pull-into-descriptor">ReadableByteStreamControllerCommitPullIntoDescriptor(<var>stream</var>, <var>pullIntoDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⑥">[[state]]</a> is not "<code>errored</code>".</p>
     <li data-md>
      <p>Let <var>done</var> be false.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⑦">[[state]]</a> is "<code>closed</code>",</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled⑤">bytes filled</a> is 0.</p>
       <li data-md>
        <p>Set <var>done</var> to true.</p>
      </ol>
     <li data-md>
      <p>Let <var>filledView</var> be ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-convert-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-convert-pull-into-descriptor">ReadableByteStreamControllerConvertPullIntoDescriptor</a>(<var>pullIntoDescriptor</var>).</p>
     <li data-md>
      <p>If <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-reader-type" id="ref-for-pull-into-descriptor-reader-type①">reader type</a> is "<code>default</code>",</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-fulfill-read-request" id="ref-for-readable-stream-fulfill-read-request①">ReadableStreamFulfillReadRequest</a>(<var>stream</var>, <var>filledView</var>, <var>done</var>).</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-reader-type" id="ref-for-pull-into-descriptor-reader-type②">reader type</a> is "<code>byob</code>".</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-fulfill-read-into-request" id="ref-for-readable-stream-fulfill-read-into-request">ReadableStreamFulfillReadIntoRequest</a>(<var>stream</var>, <var>filledView</var>, <var>done</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerConvertPullIntoDescriptor">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerConvertPullIntoDescriptor" id="readable-byte-stream-controller-convert-pull-into-descriptor">ReadableByteStreamControllerConvertPullIntoDescriptor(<var>pullIntoDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>bytesFilled</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled⑥">bytes filled</a>.</p>
     <li data-md>
      <p>Let <var>elementSize</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size①">element size</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>bytesFilled</var> ≤ <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length②">byte length</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>bytesFilled</var> mod <var>elementSize</var> is 0.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct③">Construct</a>(<var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-view-constructor" id="ref-for-pull-into-descriptor-view-constructor②">view constructor</a>, « <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer⑦">buffer</a>, <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset②">byte offset</a>, <var>bytesFilled</var> ÷ <var>elementSize</var> »).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerEnqueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerEnqueue" id="readable-byte-stream-controller-enqueue">ReadableByteStreamControllerEnqueue(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream②">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested④">[[closeRequested]]</a> is true or <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⑧">[[state]]</a> is not "<code>readable</code>", return.</p>
     <li data-md>
      <p>Let <var>buffer</var> be <var>chunk</var>.[[ViewedArrayBuffer]].</p>
     <li data-md>
      <p>Let <var>byteOffset</var> be <var>chunk</var>.[[ByteOffset]].</p>
     <li data-md>
      <p>Let <var>byteLength</var> be <var>chunk</var>.[[ByteLength]].</p>
     <li data-md>
      <p>Let <var>transferredBuffer</var> be ! <a data-link-type="abstract-op" href="#transfer-array-buffer" id="ref-for-transfer-array-buffer⑦">TransferArrayBuffer</a>(<var>buffer</var>).</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-has-default-reader" id="ref-for-readable-stream-has-default-reader③">ReadableStreamHasDefaultReader</a>(<var>stream</var>) is true</p>
      <ol>
       <li data-md>
        <p>If ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-requests" id="ref-for-readable-stream-get-num-read-requests③">ReadableStreamGetNumReadRequests</a>(<var>stream</var>) is 0,</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-enqueue-chunk-to-queue" id="ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue">ReadableByteStreamControllerEnqueueChunkToQueue</a>(<var>controller</var>, <var>transferredBuffer</var>, <var>byteOffset</var>, <var>byteLength</var>).</p>
        </ol>
       <li data-md>
        <p>Otherwise,</p>
        <ol>
         <li data-md>
          <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue④">[[queue]]</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①⓪">is empty</a>.</p>
         <li data-md>
          <p>Let <var>transferredView</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct④">Construct</a>(<code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects⑥">%Uint8Array%</a></code>, « <var>transferredBuffer</var>, <var>byteOffset</var>, <var>byteLength</var> »).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-fulfill-read-request" id="ref-for-readable-stream-fulfill-read-request②">ReadableStreamFulfillReadRequest</a>(<var>stream</var>, <var>transferredView</var>, false).</p>
        </ol>
      </ol>
     <li data-md>
      <p>Otherwise, if ! <a data-link-type="abstract-op" href="#readable-stream-has-byob-reader" id="ref-for-readable-stream-has-byob-reader②">ReadableStreamHasBYOBReader</a>(<var>stream</var>) is true,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-enqueue-chunk-to-queue" id="ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue①">ReadableByteStreamControllerEnqueueChunkToQueue</a>(<var>controller</var>, <var>transferredBuffer</var>, <var>byteOffset</var>, <var>byteLength</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-process-pull-into-descriptors-using-queue" id="ref-for-readable-byte-stream-controller-process-pull-into-descriptors-using-queue">ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue</a>(<var>controller</var>).</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①⓪">IsReadableStreamLocked</a>(<var>stream</var>) is false.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-enqueue-chunk-to-queue" id="ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue②">ReadableByteStreamControllerEnqueueChunkToQueue</a>(<var>controller</var>, <var>transferredBuffer</var>, <var>byteOffset</var>, <var>byteLength</var>).</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed②">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerEnqueueChunkToQueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerEnqueueChunkToQueue" id="readable-byte-stream-controller-enqueue-chunk-to-queue">ReadableByteStreamControllerEnqueueChunkToQueue(<var>controller</var>, <var>buffer</var>, <var>byteOffset</var>, <var>byteLength</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append③">Append</a> a new <a data-link-type="dfn" href="#readable-byte-stream-queue-entry" id="ref-for-readable-byte-stream-queue-entry①">readable byte stream queue entry</a> with <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-buffer" id="ref-for-readable-byte-stream-queue-entry-buffer①">buffer</a> <var>buffer</var>, <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-offset" id="ref-for-readable-byte-stream-queue-entry-byte-offset①">byte offset</a> <var>byteOffset</var>, and <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length②">byte length</a> <var>byteLength</var> to <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue⑤">[[queue]]</a>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize⑤">[[queueTotalSize]]</a> to <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize⑥">[[queueTotalSize]]</a> + <var>byteLength</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerError" id="readable-byte-stream-controller-error">ReadableByteStreamControllerError(<var>controller</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream③">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state②⑨">[[state]]</a> is not "<code>readable</code>", return.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-clear-pending-pull-intos" id="ref-for-readable-byte-stream-controller-clear-pending-pull-intos">ReadableByteStreamControllerClearPendingPullIntos</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue④">ResetQueue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-clear-algorithms" id="ref-for-readable-byte-stream-controller-clear-algorithms②">ReadableByteStreamControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-error" id="ref-for-readable-stream-error①">ReadableStreamError</a>(<var>stream</var>, <var>e</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerFillHeadPullIntoDescriptor">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerFillHeadPullIntoDescriptor" id="readable-byte-stream-controller-fill-head-pull-into-descriptor">ReadableByteStreamControllerFillHeadPullIntoDescriptor(<var>controller</var>, <var>size</var>, <var>pullIntoDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: either <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos⑧">[[pendingPullIntos]]</a> <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①①">is empty</a>, or <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos⑨">[[pendingPullIntos]]</a>[0]
  is <var>pullIntoDescriptor</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-invalidate-byob-request" id="ref-for-readable-byte-stream-controller-invalidate-byob-request①">ReadableByteStreamControllerInvalidateBYOBRequest</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Set <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled⑦">bytes filled</a> to <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled⑧">bytes filled</a> + <var>size</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerFillPullIntoDescriptorFromQueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerFillPullIntoDescriptorFromQueue" id="readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(<var>controller</var>, <var>pullIntoDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>elementSize</var> be <var>pullIntoDescriptor</var>.[[elementSize]].</p>
     <li data-md>
      <p>Let <var>currentAlignedBytes</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled⑨">bytes filled</a> −
  (<var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⓪">bytes filled</a> mod <var>elementSize</var>).</p>
     <li data-md>
      <p>Let <var>maxBytesToCopy</var> be min(<var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize⑦">[[queueTotalSize]]</a>, <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length③">byte length</a> − <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①①">bytes filled</a>).</p>
     <li data-md>
      <p>Let <var>maxBytesFilled</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①②">bytes filled</a> + <var>maxBytesToCopy</var>.</p>
     <li data-md>
      <p>Let <var>maxAlignedBytes</var> be <var>maxBytesFilled</var> − (<var>maxBytesFilled</var> mod <var>elementSize</var>).</p>
     <li data-md>
      <p>Let <var>totalBytesToCopyRemaining</var> be <var>maxBytesToCopy</var>.</p>
     <li data-md>
      <p>Let <var>ready</var> be false.</p>
     <li data-md>
      <p>If <var>maxAlignedBytes</var> > <var>currentAlignedBytes</var>,</p>
      <ol>
       <li data-md>
        <p>Set <var>totalBytesToCopyRemaining</var> to <var>maxAlignedBytes</var> − <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①③">bytes filled</a>.</p>
       <li data-md>
        <p>Set <var>ready</var> to true.</p>
      </ol>
     <li data-md>
      <p>Let <var>queue</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queue" id="ref-for-readablebytestreamcontroller-queue⑥">[[queue]]</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-while" id="ref-for-iteration-while">While</a> <var>totalBytesToCopyRemaining</var> > 0,</p>
      <ol>
       <li data-md>
        <p>Let <var>headOfQueue</var> be <var>queue</var>[0].</p>
       <li data-md>
        <p>Let <var>bytesToCopy</var> be min(<var>totalBytesToCopyRemaining</var>, <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length③">byte length</a>).</p>
       <li data-md>
        <p>Let <var>destStart</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset③">byte offset</a> + <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①④">bytes filled</a>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-copydatablockbytes" id="ref-for-sec-copydatablockbytes">CopyDataBlockBytes</a>(<var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer⑧">buffer</a>.[[ArrayBufferData]], <var>destStart</var>, <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-buffer" id="ref-for-readable-byte-stream-queue-entry-buffer②">buffer</a>.[[ArrayBufferData]], <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-offset" id="ref-for-readable-byte-stream-queue-entry-byte-offset②">byte offset</a>, <var>bytesToCopy</var>).</p>
       <li data-md>
        <p>If <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length④">byte length</a> is <var>bytesToCopy</var>,</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove③">Remove</a> <var>queue</var>[0].</p>
        </ol>
       <li data-md>
        <p>Otherwise,</p>
        <ol>
         <li data-md>
          <p>Set <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-offset" id="ref-for-readable-byte-stream-queue-entry-byte-offset③">byte offset</a> to <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-offset" id="ref-for-readable-byte-stream-queue-entry-byte-offset④">byte offset</a> + <var>bytesToCopy</var>.</p>
         <li data-md>
          <p>Set <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length⑤">byte length</a> to <var>headOfQueue</var>’s <a data-link-type="dfn" href="#readable-byte-stream-queue-entry-byte-length" id="ref-for-readable-byte-stream-queue-entry-byte-length⑥">byte length</a> − <var>bytesToCopy</var>.</p>
        </ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize⑧">[[queueTotalSize]]</a> to <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize⑨">[[queueTotalSize]]</a> − <var>bytesToCopy</var>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-fill-head-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-fill-head-pull-into-descriptor">ReadableByteStreamControllerFillHeadPullIntoDescriptor</a>(<var>controller</var>, <var>bytesToCopy</var>, <var>pullIntoDescriptor</var>).</p>
       <li data-md>
        <p>Set <var>totalBytesToCopyRemaining</var> to <var>totalBytesToCopyRemaining</var> − <var>bytesToCopy</var>.</p>
      </ol>
     <li data-md>
      <p>If <var>ready</var> is false,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①⓪">[[queueTotalSize]]</a> is 0.</p>
       <li data-md>
        <p class="assertion">Assert: <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⑤">bytes filled</a> > 0.</p>
       <li data-md>
        <p class="assertion">Assert: <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⑥">bytes filled</a> &lt; <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size②">element size</a>.</p>
      </ol>
     <li data-md>
      <p>Return <var>ready</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerGetDesiredSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerGetDesiredSize" id="readable-byte-stream-controller-get-desired-size">ReadableByteStreamControllerGetDesiredSize(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream④">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③⓪">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>errored</code>", return null.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>", return 0.</p>
     <li data-md>
      <p>Return <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-strategyhwm" id="ref-for-readablebytestreamcontroller-strategyhwm">[[strategyHWM]]</a> − <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①①">[[queueTotalSize]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerHandleQueueDrain">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerHandleQueueDrain" id="readable-byte-stream-controller-handle-queue-drain">ReadableByteStreamControllerHandleQueueDrain(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream⑤">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③①">[[state]]</a> is
  "<code>readable</code>".</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①②">[[queueTotalSize]]</a> is 0 and <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested⑤">[[closeRequested]]</a> is true,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-clear-algorithms" id="ref-for-readable-byte-stream-controller-clear-algorithms③">ReadableByteStreamControllerClearAlgorithms</a>(<var>controller</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-close" id="ref-for-readable-stream-close④">ReadableStreamClose</a>(<var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream⑥">[[stream]]</a>).</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed③">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerInvalidateBYOBRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerInvalidateBYOBRequest" id="readable-byte-stream-controller-invalidate-byob-request">ReadableByteStreamControllerInvalidateBYOBRequest(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest③">[[byobRequest]]</a> is null, return.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest④">[[byobRequest]]</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-controller" id="ref-for-readablestreambyobrequest-controller⑤">[[controller]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest⑤">[[byobRequest]]</a>.<a data-link-type="dfn" href="#readablestreambyobrequest-view" id="ref-for-readablestreambyobrequest-view⑤">[[view]]</a> to null.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest⑥">[[byobRequest]]</a> to null.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue" id="readable-byte-stream-controller-process-pull-into-descriptors-using-queue">ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested⑥">[[closeRequested]]</a> is false.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-while" id="ref-for-iteration-while①">While</a> <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⓪">[[pendingPullIntos]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①②">empty</a>,</p>
      <ol>
       <li data-md>
        <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①③">[[queueTotalSize]]</a> is 0, return.</p>
       <li data-md>
        <p>Let <var>pullIntoDescriptor</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①①">[[pendingPullIntos]]</a>[0].</p>
       <li data-md>
        <p>If ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-fill-pull-into-descriptor-from-queue" id="ref-for-readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">ReadableByteStreamControllerFillPullIntoDescriptorFromQueue</a>(<var>controller</var>, <var>pullIntoDescriptor</var>) is true,</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-shift-pending-pull-into" id="ref-for-readable-byte-stream-controller-shift-pending-pull-into">ReadableByteStreamControllerShiftPendingPullInto</a>(<var>controller</var>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-commit-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-commit-pull-into-descriptor">ReadableByteStreamControllerCommitPullIntoDescriptor</a>(<var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream⑦">[[stream]]</a>, <var>pullIntoDescriptor</var>).</p>
        </ol>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerPullInto">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerPullInto" id="readable-byte-stream-controller-pull-into">ReadableByteStreamControllerPullInto(<var>controller</var>, <var>view</var>, <var>readIntoRequest</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream⑧">[[stream]]</a>.</p>
     <li data-md>
      <p>Let <var>elementSize</var> be 1.</p>
     <li data-md>
      <p>Let <var>ctor</var> be <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-dataview-constructor" id="ref-for-sec-dataview-constructor①">%DataView%</a></code>.</p>
     <li data-md>
      <p>If <var>view</var> has a [[TypedArrayName]] internal slot (i.e., it is not a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-dataview-objects" id="ref-for-sec-dataview-objects">DataView</a></code>),</p>
      <ol>
       <li data-md>
        <p>Set <var>elementSize</var> to the element size specified in <a data-link-type="dfn" href="https://tc39.es/ecma262/#table-49" id="ref-for-table-49①">the typed array constructors table</a> for <var>view</var>.[[TypedArrayName]].</p>
       <li data-md>
        <p>Set <var>ctor</var> to the constructor specified in <a data-link-type="dfn" href="https://tc39.es/ecma262/#table-49" id="ref-for-table-49②">the typed array constructors table</a> for <var>view</var>.[[TypedArrayName]].</p>
      </ol>
     <li data-md>
      <p>Let <var>byteOffset</var> be <var>view</var>.[[ByteOffset]].</p>
     <li data-md>
      <p>Let <var>byteLength</var> be <var>view</var>.[[ByteLength]].</p>
     <li data-md>
      <p>Let <var>buffer</var> be ! <a data-link-type="abstract-op" href="#transfer-array-buffer" id="ref-for-transfer-array-buffer①">TransferArrayBuffer</a>(<var>view</var>.[[ViewedArrayBuffer]]).</p>
     <li data-md>
      <p>Let <var>pullIntoDescriptor</var> be a new <a data-link-type="dfn" href="#pull-into-descriptor" id="ref-for-pull-into-descriptor②">pull-into descriptor</a> with <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer⑨">buffer</a> <var>buffer</var>, <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset④">byte offset</a> <var>byteOffset</var>, <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length④">byte
  length</a> <var>byteLength</var>, <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⑦">bytes filled</a> 0, <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size③">element
  size</a> <var>elementSize</var>, <a data-link-type="dfn" href="#pull-into-descriptor-view-constructor" id="ref-for-pull-into-descriptor-view-constructor③">view constructor</a> <var>ctor</var>, and <a data-link-type="dfn" href="#pull-into-descriptor-reader-type" id="ref-for-pull-into-descriptor-reader-type③">reader type</a> "<code>byob</code>".</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①②">[[pendingPullIntos]]</a> is not empty,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append④">Append</a> <var>pullIntoDescriptor</var> to <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①③">[[pendingPullIntos]]</a>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-add-read-into-request" id="ref-for-readable-stream-add-read-into-request">ReadableStreamAddReadIntoRequest</a>(<var>stream</var>, <var>readIntoRequest</var>).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③②">[[state]]</a> is "<code>closed</code>",</p>
      <ol>
       <li data-md>
        <p>Let <var>emptyView</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-construct" id="ref-for-sec-construct⑤">Construct</a>(<var>ctor</var>, « <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①⓪">buffer</a>, <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset⑤">byte offset</a>, 0 »).</p>
       <li data-md>
        <p>Perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-close-steps" id="ref-for-read-into-request-close-steps③">close steps</a>, given <var>emptyView</var>.</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-queuetotalsize" id="ref-for-readablebytestreamcontroller-queuetotalsize①④">[[queueTotalSize]]</a> > 0,</p>
      <ol>
       <li data-md>
        <p>If ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-fill-pull-into-descriptor-from-queue" id="ref-for-readable-byte-stream-controller-fill-pull-into-descriptor-from-queue①">ReadableByteStreamControllerFillPullIntoDescriptorFromQueue</a>(<var>controller</var>, <var>pullIntoDescriptor</var>) is true,</p>
        <ol>
         <li data-md>
          <p>Let <var>filledView</var> be ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-convert-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-convert-pull-into-descriptor①">ReadableByteStreamControllerConvertPullIntoDescriptor</a>(<var>pullIntoDescriptor</var>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-handle-queue-drain" id="ref-for-readable-byte-stream-controller-handle-queue-drain①">ReadableByteStreamControllerHandleQueueDrain</a>(<var>controller</var>).</p>
         <li data-md>
          <p>Perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-chunk-steps" id="ref-for-read-into-request-chunk-steps②">chunk steps</a>, given <var>filledView</var>.</p>
         <li data-md>
          <p>Return.</p>
        </ol>
       <li data-md>
        <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested⑦">[[closeRequested]]</a> is true,</p>
        <ol>
         <li data-md>
          <p>Let <var>e</var> be a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑦">TypeError</a></code> exception.</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-error" id="ref-for-readable-byte-stream-controller-error③">ReadableByteStreamControllerError</a>(<var>controller</var>, <var>e</var>).</p>
         <li data-md>
          <p>Perform <var>readIntoRequest</var>’s <a data-link-type="dfn" href="#read-into-request-error-steps" id="ref-for-read-into-request-error-steps③">error steps</a>, given <var>e</var>.</p>
         <li data-md>
          <p>Return.</p>
        </ol>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑤">Append</a> <var>pullIntoDescriptor</var> to <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①④">[[pendingPullIntos]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-add-read-into-request" id="ref-for-readable-stream-add-read-into-request①">ReadableStreamAddReadIntoRequest</a>(<var>stream</var>, <var>readIntoRequest</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed④">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerRespond">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerRespond" id="readable-byte-stream-controller-respond">ReadableByteStreamControllerRespond(<var>controller</var>, <var>bytesWritten</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⑤">[[pendingPullIntos]]</a> is not empty.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond-internal" id="ref-for-readable-byte-stream-controller-respond-internal">ReadableByteStreamControllerRespondInternal</a>(<var>controller</var>, <var>bytesWritten</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerRespondInClosedState">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerRespondInClosedState" id="readable-byte-stream-controller-respond-in-closed-state">ReadableByteStreamControllerRespondInClosedState(<var>controller</var>, <var>firstDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Set <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①①">buffer</a> to ! <a data-link-type="abstract-op" href="#transfer-array-buffer" id="ref-for-transfer-array-buffer②">TransferArrayBuffer</a>(<var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①②">buffer</a>).</p>
     <li data-md>
      <p class="assertion">Assert: <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⑧">bytes filled</a> is 0.</p>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream⑨">[[stream]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-has-byob-reader" id="ref-for-readable-stream-has-byob-reader③">ReadableStreamHasBYOBReader</a>(<var>stream</var>) is true,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#iteration-while" id="ref-for-iteration-while②">While</a> ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-into-requests" id="ref-for-readable-stream-get-num-read-into-requests">ReadableStreamGetNumReadIntoRequests</a>(<var>stream</var>) > 0,</p>
        <ol>
         <li data-md>
          <p>Let <var>pullIntoDescriptor</var> be ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-shift-pending-pull-into" id="ref-for-readable-byte-stream-controller-shift-pending-pull-into①">ReadableByteStreamControllerShiftPendingPullInto</a>(<var>controller</var>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-commit-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-commit-pull-into-descriptor①">ReadableByteStreamControllerCommitPullIntoDescriptor</a>(<var>stream</var>, <var>pullIntoDescriptor</var>).</p>
        </ol>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerRespondInReadableState">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerRespondInReadableState" id="readable-byte-stream-controller-respond-in-readable-state">ReadableByteStreamControllerRespondInReadableState(<var>controller</var>, <var>bytesWritten</var>, <var>pullIntoDescriptor</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled①⑨">bytes filled</a> + <var>bytesWritten</var> > <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length⑤">byte length</a>, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror①">RangeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-fill-head-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-fill-head-pull-into-descriptor①">ReadableByteStreamControllerFillHeadPullIntoDescriptor</a>(<var>controller</var>, <var>bytesWritten</var>, <var>pullIntoDescriptor</var>).</p>
     <li data-md>
      <p>If <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②⓪">bytes filled</a> &lt; <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size④">element size</a>, return.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-shift-pending-pull-into" id="ref-for-readable-byte-stream-controller-shift-pending-pull-into②">ReadableByteStreamControllerShiftPendingPullInto</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Let <var>remainderSize</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②①">bytes filled</a> mod <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-element-size" id="ref-for-pull-into-descriptor-element-size⑤">element size</a>.</p>
     <li data-md>
      <p>If <var>remainderSize</var> > 0,</p>
      <ol>
       <li data-md>
        <p>Let <var>end</var> be <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset⑥">byte offset</a> + <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②②">bytes filled</a>.</p>
       <li data-md>
        <p>Let <var>remainder</var> be ? <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-clonearraybuffer" id="ref-for-sec-clonearraybuffer">CloneArrayBuffer</a>(<var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①③">buffer</a>, <var>end</var> − <var>remainderSize</var>, <var>remainderSize</var>, <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-constructor" id="ref-for-sec-arraybuffer-constructor①">%ArrayBuffer%</a></code>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-enqueue-chunk-to-queue" id="ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue③">ReadableByteStreamControllerEnqueueChunkToQueue</a>(<var>controller</var>, <var>remainder</var>, 0, <var>remainder</var>.[[ByteLength]]).</p>
      </ol>
     <li data-md>
      <p>Set <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①④">buffer</a> to ! <a data-link-type="abstract-op" href="#transfer-array-buffer" id="ref-for-transfer-array-buffer③">TransferArrayBuffer</a>(<var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①⑤">buffer</a>).</p>
     <li data-md>
      <p>Set <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②③">bytes filled</a> to <var>pullIntoDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②④">bytes filled</a> − <var>remainderSize</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-commit-pull-into-descriptor" id="ref-for-readable-byte-stream-controller-commit-pull-into-descriptor②">ReadableByteStreamControllerCommitPullIntoDescriptor</a>(<var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream①⓪">[[stream]]</a>, <var>pullIntoDescriptor</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-process-pull-into-descriptors-using-queue" id="ref-for-readable-byte-stream-controller-process-pull-into-descriptors-using-queue①">ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerRespondInternal">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerRespondInternal" id="readable-byte-stream-controller-respond-internal">ReadableByteStreamControllerRespondInternal(<var>controller</var>, <var>bytesWritten</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>firstDescriptor</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⑥">[[pendingPullIntos]]</a>[0].</p>
     <li data-md>
      <p>Let <var>state</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream①①">[[stream]]</a>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③③">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>",</p>
      <ol>
       <li data-md>
        <p>If <var>bytesWritten</var> is not 0, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑧">TypeError</a></code> exception.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond-in-closed-state" id="ref-for-readable-byte-stream-controller-respond-in-closed-state">ReadableByteStreamControllerRespondInClosedState</a>(<var>controller</var>, <var>firstDescriptor</var>).</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>state</var> is "<code>readable</code>".</p>
       <li data-md>
        <p>Perform ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond-in-readable-state" id="ref-for-readable-byte-stream-controller-respond-in-readable-state">ReadableByteStreamControllerRespondInReadableState</a>(<var>controller</var>, <var>bytesWritten</var>, <var>firstDescriptor</var>).</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed⑤">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerRespondWithNewView">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerRespondWithNewView" id="readable-byte-stream-controller-respond-with-new-view">ReadableByteStreamControllerRespondWithNewView(<var>controller</var>, <var>view</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⑦">[[pendingPullIntos]]</a> is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①③">empty</a>.</p>
     <li data-md>
      <p>Let <var>firstDescriptor</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⑧">[[pendingPullIntos]]</a>[0].</p>
     <li data-md>
      <p>If <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-offset" id="ref-for-pull-into-descriptor-byte-offset⑦">byte offset</a> + <var>firstDescriptor</var>’ <a data-link-type="dfn" href="#pull-into-descriptor-bytes-filled" id="ref-for-pull-into-descriptor-bytes-filled②⑤">bytes filled</a> is not <var>view</var>.[[ByteOffset]], throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror②">RangeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-byte-length" id="ref-for-pull-into-descriptor-byte-length⑥">byte length</a> is not <var>view</var>.[[ByteLength]], throw
  a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror③">RangeError</a></code> exception.</p>
     <li data-md>
      <p>Set <var>firstDescriptor</var>’s <a data-link-type="dfn" href="#pull-into-descriptor-buffer" id="ref-for-pull-into-descriptor-buffer①⑥">buffer</a> to <var>view</var>.[[ViewedArrayBuffer]].</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#readable-byte-stream-controller-respond-internal" id="ref-for-readable-byte-stream-controller-respond-internal①">ReadableByteStreamControllerRespondInternal</a>(<var>controller</var>, <var>view</var>.[[ByteLength]]).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerShiftPendingPullInto">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerShiftPendingPullInto" id="readable-byte-stream-controller-shift-pending-pull-into">ReadableByteStreamControllerShiftPendingPullInto(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>descriptor</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos①⑨">[[pendingPullIntos]]</a>[0].</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove④">Remove</a> <var>descriptor</var> from <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos②⓪">[[pendingPullIntos]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-invalidate-byob-request" id="ref-for-readable-byte-stream-controller-invalidate-byob-request②">ReadableByteStreamControllerInvalidateBYOBRequest</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Return <var>descriptor</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ReadableByteStreamControllerShouldCallPull">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ReadableByteStreamControllerShouldCallPull" id="readable-byte-stream-controller-should-call-pull">ReadableByteStreamControllerShouldCallPull(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream①②">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③④">[[state]]</a> is not "<code>readable</code>", return false.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested⑧">[[closeRequested]]</a> is true, return false.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-started" id="ref-for-readablebytestreamcontroller-started">[[started]]</a> is false, return false.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-has-default-reader" id="ref-for-readable-stream-has-default-reader④">ReadableStreamHasDefaultReader</a>(<var>stream</var>) is true and ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-requests" id="ref-for-readable-stream-get-num-read-requests④">ReadableStreamGetNumReadRequests</a>(<var>stream</var>) > 0, return true.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-has-byob-reader" id="ref-for-readable-stream-has-byob-reader④">ReadableStreamHasBYOBReader</a>(<var>stream</var>) is true and ! <a data-link-type="abstract-op" href="#readable-stream-get-num-read-into-requests" id="ref-for-readable-stream-get-num-read-into-requests①">ReadableStreamGetNumReadIntoRequests</a>(<var>stream</var>) > 0, return true.</p>
     <li data-md>
      <p>Let <var>desiredSize</var> be  ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-get-desired-size" id="ref-for-readable-byte-stream-controller-get-desired-size①">ReadableByteStreamControllerGetDesiredSize</a>(<var>controller</var>).</p>
     <li data-md>
      <p class="assertion">Assert: <var>desiredSize</var> is not null.</p>
     <li data-md>
      <p>If <var>desiredSize</var> > 0, return true.</p>
     <li data-md>
      <p>Return false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableByteStreamController">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableByteStreamController" id="set-up-readable-byte-stream-controller">SetUpReadableByteStreamController(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>highWaterMark</var>, <var>autoAllocateChunkSize</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①③">[[controller]]</a> is undefined.</p>
     <li data-md>
      <p>If <var>autoAllocateChunkSize</var> is not undefined,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-isinteger" id="ref-for-sec-isinteger">IsInteger</a>(<var>autoAllocateChunkSize</var>) is true.</p>
       <li data-md>
        <p class="assertion">Assert: <var>autoAllocateChunkSize</var> is positive.</p>
      </ol>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-stream" id="ref-for-readablebytestreamcontroller-stream①③">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain④">[[pullAgain]]</a> and <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pulling" id="ref-for-readablebytestreamcontroller-pulling③">[[pulling]]</a> to false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-byobrequest" id="ref-for-readablebytestreamcontroller-byobrequest⑦">[[byobRequest]]</a> to null.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue⑤">ResetQueue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-closerequested" id="ref-for-readablebytestreamcontroller-closerequested⑨">[[closeRequested]]</a> and <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-started" id="ref-for-readablebytestreamcontroller-started①">[[started]]</a> to false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-strategyhwm" id="ref-for-readablebytestreamcontroller-strategyhwm①">[[strategyHWM]]</a> to <var>highWaterMark</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullalgorithm" id="ref-for-readablebytestreamcontroller-pullalgorithm②">[[pullAlgorithm]]</a> to <var>pullAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-cancelalgorithm" id="ref-for-readablebytestreamcontroller-cancelalgorithm②">[[cancelAlgorithm]]</a> to <var>cancelAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-autoallocatechunksize" id="ref-for-readablebytestreamcontroller-autoallocatechunksize①">[[autoAllocateChunkSize]]</a> to <var>autoAllocateChunkSize</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pendingpullintos" id="ref-for-readablebytestreamcontroller-pendingpullintos②①">[[pendingPullIntos]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①①">list</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①④">[[controller]]</a> to <var>controller</var>.</p>
     <li data-md>
      <p>Let <var>startResult</var> be the result of performing <var>startAlgorithm</var>.</p>
     <li data-md>
      <p>Let <var>startPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①①">a promise resolved with</a> <var>startResult</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment④">Upon fulfillment</a> of <var>startPromise</var>,</p>
      <ol>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-started" id="ref-for-readablebytestreamcontroller-started②">[[started]]</a> to true.</p>
       <li data-md>
        <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pulling" id="ref-for-readablebytestreamcontroller-pulling④">[[pulling]]</a> is false.</p>
       <li data-md>
        <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#readablebytestreamcontroller-pullagain" id="ref-for-readablebytestreamcontroller-pullagain⑤">[[pullAgain]]</a> is false.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-call-pull-if-needed" id="ref-for-readable-byte-stream-controller-call-pull-if-needed⑥">ReadableByteStreamControllerCallPullIfNeeded</a>(<var>controller</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection⑤">Upon rejection</a> of <var>startPromise</var> with reason <var>r</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-byte-stream-controller-error" id="ref-for-readable-byte-stream-controller-error④">ReadableByteStreamControllerError</a>(<var>controller</var>, <var>r</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpReadableByteStreamControllerFromUnderlyingSource">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpReadableByteStreamControllerFromUnderlyingSource" id="set-up-readable-byte-stream-controller-from-underlying-source">SetUpReadableByteStreamControllerFromUnderlyingSource(<var>stream</var>, <var>underlyingSource</var>, <var>underlyingSourceDict</var>, <var>highWaterMark</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new⑨">new</a> <code class="idl"><a data-link-type="idl" href="#readablebytestreamcontroller" id="ref-for-readablebytestreamcontroller①⑤">ReadableByteStreamController</a></code>.</p>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>pullAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①②">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>Let <var>cancelAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①③">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start⑥">start</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑧">exists</a>, then set <var>startAlgorithm</var> to an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function④">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start⑦">start</a></code>"] with argument list
  « <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value③">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull⑥">pull</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists⑨">exists</a>, then set <var>pullAlgorithm</var> to an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function⑤">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull⑦">pull</a></code>"] with argument list
  « <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value④">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>If <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel④">cancel</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⓪">exists</a>, then set <var>cancelAlgorithm</var> to an algorithm which takes an argument <var>reason</var> and returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function⑥">invoking</a> <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-cancel" id="ref-for-dom-underlyingsource-cancel⑤">cancel</a></code>"] with argument list
  « <var>reason</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value⑤">callback this value</a> <var>underlyingSource</var>.</p>
     <li data-md>
      <p>Let <var>autoAllocateChunkSize</var> be <var>underlyingSourceDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-autoallocatechunksize" id="ref-for-dom-underlyingsource-autoallocatechunksize①">autoAllocateChunkSize</a></code>"], if it <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①①">exists</a>, or
  undefined otherwise.</p>
     <li data-md>
      <p>If <var>autoAllocateChunkSize</var> is 0, then throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑨">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-readable-byte-stream-controller" id="ref-for-set-up-readable-byte-stream-controller">SetUpReadableByteStreamController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>highWaterMark</var>, <var>autoAllocateChunkSize</var>).</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="5" id="ws"><span class="secno">5. </span><span class="content">Writable streams</span><a class="self-link" href="#ws"></a></h2>
   <h3 class="heading settled" data-level="5.1" id="ws-intro"><span class="secno">5.1. </span><span class="content">Using writable streams</span><a class="self-link" href="#ws-intro"></a></h3>
   <div class="example" id="example-basic-pipe-to-2">
    <a class="self-link" href="#example-basic-pipe-to-2"></a> The usual way to write to a writable stream is to simply <a data-link-type="dfn" href="#piping" id="ref-for-piping⑧">pipe</a> a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①③">readable stream</a> to
 it. This ensures that <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure⑨">backpressure</a> is respected, so that if the writable stream’s <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink④">underlying
 sink</a> is not able to accept data as fast as the readable stream can produce it, the readable
 stream is informed of this and has a chance to slow down its data production. 
<pre class="highlight">readableStream<c- p>.</c->pipeTo<c- p>(</c->writableStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully written!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
   </div>
   <div class="example" id="example-manual-write-batch">
    <a class="self-link" href="#example-manual-write-batch"></a> You can also write directly to writable streams by acquiring a <a data-link-type="dfn" href="#writer" id="ref-for-writer①">writer</a> and using its <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write">write()</a></code> and <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close">close()</a></code> methods. Since
 writable streams queue any incoming writes, and take care internally to forward them to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink⑤">underlying sink</a> in sequence, you can indiscriminately write to a writable stream without much
 ceremony: 
<pre class="highlight"><c- a>function</c-> writeArrayToStream<c- p>(</c->array<c- p>,</c-> writableStream<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> writer <c- o>=</c-> writableStream<c- p>.</c->getWriter<c- p>();</c->
  array<c- p>.</c->forEach<c- p>(</c->chunk <c- p>=></c-> writer<c- p>.</c->write<c- p>(</c->chunk<c- p>).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{}));</c->

  <c- k>return</c-> writer<c- p>.</c->close<c- p>();</c->
<c- p>}</c->

writeArrayToStream<c- p>([</c-><c- mf>1</c-><c- p>,</c-> <c- mf>2</c-><c- p>,</c-> <c- mf>3</c-><c- p>,</c-> <c- mf>4</c-><c- p>,</c-> <c- mf>5</c-><c- p>],</c-> writableStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All done!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Error with the stream: "</c-> <c- o>+</c-> e<c- p>));</c->
</pre>
    <p>Note how we use <code>.catch(() => {})</code> to suppress any rejections from the <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write①">write()</a></code> method; we’ll be notified of any fatal errors via a
 rejection of the <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close①">close()</a></code> method, and leaving them un-caught would
 cause potential <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-unhandledrejection" id="ref-for-event-unhandledrejection">unhandledrejection</a></code> events and console warnings.</p>
   </div>
   <div class="example" id="example-manual-write-with-error-handling">
    <a class="self-link" href="#example-manual-write-with-error-handling"></a> In the previous example we only paid attention to the success or failure of the entire stream, by
 looking at the promise returned by the writer’s <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close②">close()</a></code> method.
 That promise will reject if anything goes wrong with the stream—initializing it, writing to it, or
 closing it. And it will fulfill once the stream is successfully closed. Often this is all you care
 about. 
    <p>However, if you care about the success of writing a specific <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⓪">chunk</a>, you can use the promise
 returned by the writer’s <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write②">write()</a></code> method:</p>
<pre class="highlight">writer<c- p>.</c->write<c- p>(</c-><c- u>"i am a chunk of data"</c-><c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"chunk successfully written!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c->e<c- p>));</c->
</pre>
    <p>What "success" means is up to a given stream instance (or more precisely, its <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink⑥">underlying sink</a>)
 to decide. For example, for a file stream it could simply mean that the OS has accepted the write,
 and not necessarily that the chunk has been flushed to disk. Some streams might not be able to
 give such a signal at all, in which case the returned promise will fulfill immediately.</p>
   </div>
   <div class="example" id="example-manual-write-with-backpressure">
    <a class="self-link" href="#example-manual-write-with-backpressure"></a> The <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size①">desiredSize</a></code> and <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready">ready</a></code> properties of <a data-link-type="dfn" href="#writer" id="ref-for-writer②">writable stream writers</a> allow <a data-link-type="dfn" href="#producer" id="ref-for-producer①">producers</a> to more precisely respond to flow
 control signals from the stream, to keep memory usage below the stream’s specified <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark②">high water
 mark</a>. The following example writes an infinite sequence of random bytes to a stream, using <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size②">desiredSize</a></code> to determine how many bytes to generate at a given
 time, and using <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready①">ready</a></code> to wait for the <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⓪">backpressure</a> to subside. 
<pre class="highlight"><c- k>async</c-> <c- a>function</c-> writeRandomBytesForever<c- p>(</c->writableStream<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> writer <c- o>=</c-> writableStream<c- p>.</c->getWriter<c- p>();</c->

  <c- k>while</c-> <c- p>(</c-><c- kc>true</c-><c- p>)</c-> <c- p>{</c->
    <c- k>await</c-> writer<c- p>.</c->ready<c- p>;</c->

    <c- a>const</c-> bytes <c- o>=</c-> <c- ow>new</c-> Uint8Array<c- p>(</c->writer<c- p>.</c->desiredSize<c- p>);</c->
    crypto<c- p>.</c->getRandomValues<c- p>(</c->bytes<c- p>);</c->

    <c- c1>// Purposefully don’t await; awaiting writer.ready is enough.</c->
    writer<c- p>.</c->write<c- p>(</c->bytes<c- p>).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{});</c->
  <c- p>}</c->
<c- p>}</c->

writeRandomBytesForever<c- p>(</c->myWritableStream<c- p>).</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something broke"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
    <p>Note how we don’t <code>await</code> the promise returned by <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write③">write()</a></code>; this would be redundant with <code>await</code>ing the <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready②">ready</a></code> promise. Additionally, similar to <a href="#example-manual-write-batch">a previous example</a>, we use the <code>.catch(() =>
 {})</code> pattern on the promises returned by <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write④">write()</a></code>; in this
 case we’ll be notified about any failures <code>await</code>ing the <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready③">ready</a></code> promise.</p>
   </div>
   <div class="example" id="example-manual-write-dont-await">
    <a class="self-link" href="#example-manual-write-dont-await"></a> To further emphasize how it’s a bad idea to <code>await</code> the promise returned by <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write⑤">write()</a></code>, consider a modification of the above example, where we
 continue to use the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter①">WritableStreamDefaultWriter</a></code> interface directly, but we don’t control how
 many bytes we have to write at a given time. In that case, the <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①①">backpressure</a>-respecting code
 looks the same: 
<pre class="highlight"><c- k>async</c-> <c- a>function</c-> writeSuppliedBytesForever<c- p>(</c->writableStream<c- p>,</c-> getBytes<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> writer <c- o>=</c-> writableStream<c- p>.</c->getWriter<c- p>();</c->

  <c- k>while</c-> <c- p>(</c-><c- kc>true</c-><c- p>)</c-> <c- p>{</c->
    <c- k>await</c-> writer<c- p>.</c->ready<c- p>;</c->

    <c- a>const</c-> bytes <c- o>=</c-> getBytes<c- p>();</c->
    writer<c- p>.</c->write<c- p>(</c->bytes<c- p>).</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{});</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>Unlike the previous example, where—because we were always writing exactly <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size③">writer.desiredSize</a></code> bytes each time—the <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write⑥">write()</a></code> and <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready④">ready</a></code> promises were
 synchronized, in this case it’s quite possible that the <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready⑤">ready</a></code> promise fulfills before the one returned by <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write⑦">write()</a></code> does.
 Remember, the <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready⑥">ready</a></code> promise fulfills when the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue④">desired size</a> becomes positive, which might be before the write
 succeeds (especially in cases with a larger <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark③">high water mark</a>).</p>
    <p>In other words, <code>await</code>ing the return value of <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write⑧">write()</a></code> means you never queue up writes in the stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues⑨">internal queue</a>, instead only executing a write
 after the previous one succeeds, which can result in low throughput.</p>
   </div>
   <h3 class="heading settled" data-level="5.2" id="ws-class"><span class="secno">5.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream⑥">WritableStream</a></code> class</span><a class="self-link" href="#ws-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStream" title="The WritableStream interface of the Streams API provides a standard abstraction for writing streaming data to a destination, known as a sink. This object comes with built-in backpressure and queuing.">WritableStream</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>47+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream⑦">WritableStream</a></code> represents a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream⑥">writable stream</a>.</p>
   <h4 class="heading settled" data-level="5.2.1" id="ws-class-definition"><span class="secno">5.2.1. </span><span class="content">Interface definition</span><a class="self-link" href="#ws-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream⑧">WritableStream</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑥"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable" id="ref-for-transferable①"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="writablestream"><code><c- g>WritableStream</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#ws-constructor" id="ref-for-ws-constructor①"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object①"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="WritableStream/WritableStream(underlyingSink, strategy), WritableStream/constructor(underlyingSink, strategy), WritableStream/WritableStream(underlyingSink), WritableStream/constructor(underlyingSink), WritableStream/WritableStream(), WritableStream/constructor()" data-dfn-type="argument" data-export id="dom-writablestream-writablestream-underlyingsink-strategy-underlyingsink"><code><c- g>underlyingSink</c-></code><a class="self-link" href="#dom-writablestream-writablestream-underlyingsink-strategy-underlyingsink"></a></dfn>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy" id="ref-for-dictdef-queuingstrategy①"><c- n>QueuingStrategy</c-></a> <dfn class="idl-code" data-dfn-for="WritableStream/WritableStream(underlyingSink, strategy), WritableStream/constructor(underlyingSink, strategy), WritableStream/WritableStream(underlyingSink), WritableStream/constructor(underlyingSink), WritableStream/WritableStream(), WritableStream/constructor()" data-dfn-type="argument" data-export id="dom-writablestream-writablestream-underlyingsink-strategy-strategy"><code><c- g>strategy</c-></code><a class="self-link" href="#dom-writablestream-writablestream-underlyingsink-strategy-strategy"></a></dfn> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean" id="ref-for-idl-boolean⑦"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#ws-locked" id="ref-for-ws-locked①"><c- g>locked</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⑥"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#ws-abort" id="ref-for-ws-abort①"><c- g>abort</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any⑨"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="WritableStream/abort(reason), WritableStream/abort()" data-dfn-type="argument" data-export id="dom-writablestream-abort-reason-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-writablestream-abort-reason-reason"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⑦"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#ws-close" id="ref-for-ws-close"><c- g>close</c-></a>();
  <a data-link-type="idl-name" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter②"><c- n>WritableStreamDefaultWriter</c-></a> <a class="idl-code" data-link-type="method" href="#ws-get-writer" id="ref-for-ws-get-writer"><c- g>getWriter</c-></a>();
};
</pre>
   <h4 class="heading settled" data-level="5.2.2" id="ws-internal-slots"><span class="secno">5.2.2. </span><span class="content">Internal slots</span><a class="self-link" href="#ws-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream⑨">WritableStream</a></code> are created with the internal slots described in the following
table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-backpressure">[[backpressure]]</dfn> 
      <td class="non-normative">A boolean indicating the backpressure signal set by the controller 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-closerequest">[[closeRequest]]</dfn> 
      <td class="non-normative">The promise returned from the writer’s <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close③">close()</a></code> method 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-controller">[[controller]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller">WritableStreamDefaultController</a></code> created with the ability to
  control the state and queue of this stream 
     <tr>
      <td><dfn data-dfn-for="WritableStream" data-dfn-type="dfn" data-export id="writablestream-detached">[[Detached]]<a class="self-link" href="#writablestream-detached"></a></dfn> 
      <td class="non-normative">A boolean flag set to true when the stream is transferred 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-inflightwriterequest">[[inFlightWriteRequest]]</dfn> 
      <td class="non-normative">A slot set to the promise for the current in-flight write operation
  while the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink⑦">underlying sink</a>'s write algorithm is executing and has not yet fulfilled, used to
  prevent reentrant calls 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-inflightcloserequest">[[inFlightCloseRequest]]</dfn> 
      <td class="non-normative">A slot set to the promise for the current in-flight close operation
  while the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink⑧">underlying sink</a>'s close algorithm is executing and has not yet fulfilled, used to
  prevent the <code class="idl"><a data-link-type="idl" href="#default-writer-abort" id="ref-for-default-writer-abort">abort()</a></code> method from interrupting close 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-pendingabortrequest">[[pendingAbortRequest]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="#pending-abort-request" id="ref-for-pending-abort-request">pending abort request</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-state">[[state]]</dfn> 
      <td class="non-normative">A string containing the stream’s current state, used internally; one of
  "<code>writable</code>", "<code>closed</code>", "<code>erroring</code>", or "<code>errored</code>" 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-storederror">[[storedError]]</dfn> 
      <td class="non-normative">A value indicating how the stream failed, to be given as a failure
  reason or exception when trying to operate on the stream while in the "<code>errored</code>" state 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-writer">[[writer]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter③">WritableStreamDefaultWriter</a></code> instance, if the stream is <a data-link-type="dfn" href="#lock" id="ref-for-lock①②">locked to
  a writer</a>, or undefined if it is not 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-noexport id="writablestream-writerequests">[[writeRequests]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①②">list</a> of promises representing the stream’s internal queue of write
  requests not yet processed by the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink⑨">underlying sink</a> 
   </table>
   <p class="note" role="note">The <a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest">[[inFlightCloseRequest]]</a> slot and <a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest">[[closeRequest]]</a> slot are mutually exclusive. Similarly, no element will be
removed from <a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests">[[writeRequests]]</a> while <a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest">[[inFlightWriteRequest]]</a> is not undefined. Implementations can optimize storage for these slots based on these invariants. </p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="pending-abort-request">pending abort request</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct④">struct</a> used to track a request to abort the stream
before that request is finally processed. It has the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item⑧">items</a>:</p>
   <dl>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pending abort request" data-dfn-type="dfn" data-noexport id="pending-abort-request-promise">promise</dfn>
    <dd data-md>
     <p>A promise returned from <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort②">WritableStreamAbort</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pending abort request" data-dfn-type="dfn" data-noexport id="pending-abort-request-reason">reason</dfn>
    <dd data-md>
     <p>A JavaScript value that was passed as the abort reason to <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort③">WritableStreamAbort</a></p>
    <dt data-md><dfn class="dfn-paneled" data-dfn-for="pending abort request" data-dfn-type="dfn" data-noexport id="pending-abort-request-was-already-erroring">was already erroring</dfn>
    <dd data-md>
     <p>A boolean indicating whether or not the stream was in the "<code>erroring</code>" state when <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort④">WritableStreamAbort</a> was called, which impacts the outcome of the abort request</p>
   </dl>
   <h4 class="heading settled" data-level="5.2.3" id="underlying-sink-api"><span class="secno">5.2.3. </span><span class="content">The underlying sink API</span><a class="self-link" href="#underlying-sink-api"></a></h4>
   <p>The <code class="idl"><a data-link-type="idl" href="#ws-constructor" id="ref-for-ws-constructor②">WritableStream()</a></code> constructor accepts as its first argument a JavaScript object representing
the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⓪">underlying sink</a>. Such objects can contain any of the following properties:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-underlyingsink"><code><c- g>UnderlyingSink</c-></code></dfn> {
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkstartcallback" id="ref-for-callbackdef-underlyingsinkstartcallback"><c- n>UnderlyingSinkStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkStartCallback " href="#dom-underlyingsink-start" id="ref-for-dom-underlyingsink-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkwritecallback" id="ref-for-callbackdef-underlyingsinkwritecallback"><c- n>UnderlyingSinkWriteCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkWriteCallback " href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write①"><c- g>write</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkclosecallback" id="ref-for-callbackdef-underlyingsinkclosecallback"><c- n>UnderlyingSinkCloseCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkCloseCallback " href="#dom-underlyingsink-close" id="ref-for-dom-underlyingsink-close"><c- g>close</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkabortcallback" id="ref-for-callbackdef-underlyingsinkabortcallback"><c- n>UnderlyingSinkAbortCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkAbortCallback " href="#dom-underlyingsink-abort" id="ref-for-dom-underlyingsink-abort"><c- g>abort</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⓪"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-underlyingsink-type" id="ref-for-dom-underlyingsink-type"><c- g>type</c-></a>;
};

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsinkstartcallback"><code><c- g>UnderlyingSinkStartCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①①"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①"><c- n>WritableStreamDefaultController</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSinkStartCallback" data-dfn-type="argument" data-export id="dom-underlyingsinkstartcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-underlyingsinkstartcallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsinkwritecallback"><code><c- g>UnderlyingSinkWriteCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⓪"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⑧"><c- b>undefined</c-></a>> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①②"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSinkWriteCallback" data-dfn-type="argument" data-export id="dom-underlyingsinkwritecallback-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-underlyingsinkwritecallback-chunk"></a></dfn>, <a data-link-type="idl-name" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller②"><c- n>WritableStreamDefaultController</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSinkWriteCallback" data-dfn-type="argument" data-export id="dom-underlyingsinkwritecallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-underlyingsinkwritecallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsinkclosecallback"><code><c- g>UnderlyingSinkCloseCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①①"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined①⑨"><c- b>undefined</c-></a>> ();
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-underlyingsinkabortcallback"><code><c- g>UnderlyingSinkAbortCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①②"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⓪"><c- b>undefined</c-></a>> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①③"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="UnderlyingSinkAbortCallback" data-dfn-type="argument" data-export id="dom-underlyingsinkabortcallback-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-underlyingsinkabortcallback-reason"></a></dfn>);
</pre>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSink" data-dfn-type="dict-member" data-export data-lt="start" id="dom-underlyingsink-start"><code>start(<var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsinkstartcallback" id="ref-for-callbackdef-underlyingsinkstartcallback①">UnderlyingSinkStartCallback</a></span>
    <dd>
     <p>A function that is called immediately during creation of the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①⓪">WritableStream</a></code>. </p>
     <p>Typically this is used to acquire access to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①①">underlying sink</a> resource being
  represented. </p>
     <p>If this setup process is asynchronous, it can return a promise to signal success or failure; a
  rejected promise will error the stream. Any thrown exceptions will be re-thrown by the <code class="idl"><a data-link-type="idl" href="#ws-constructor" id="ref-for-ws-constructor③">WritableStream()</a></code> constructor. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSink" data-dfn-type="dict-member" data-export data-lt="write" id="dom-underlyingsink-write"><code>write(<var>chunk</var>, <var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsinkwritecallback" id="ref-for-callbackdef-underlyingsinkwritecallback①">UnderlyingSinkWriteCallback</a></span>
    <dd>
     <p>A function that is called when a new <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤①">chunk</a> of data is ready to be written to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①②">underlying sink</a>. The stream implementation guarantees that this function will be called only
   after previous writes have succeeded, and never before <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-start" id="ref-for-dom-underlyingsink-start①">start()</a></code> has
   succeeded or after <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-close" id="ref-for-dom-underlyingsink-close①">close()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-abort" id="ref-for-dom-underlyingsink-abort①">abort()</a></code> have
   been called. </p>
     <p>This function is used to actually send the data to the resource presented by the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①③">underlying
   sink</a>, for example by calling a lower-level API. </p>
     <p>If the process of writing data is asynchronous, and communicates success or failure signals
   back to its user, then this function can return a promise to signal success or failure. This
   promise return value will be communicated back to the caller of <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write⑨">writer.write()</a></code>, so they can monitor that individual
   write. Throwing an exception is treated the same as returning a rejected promise. </p>
     <p>Note that such signals are not always available; compare e.g. <a href="#example-ws-no-backpressure">§ 10.6 A writable stream with no backpressure or success signals</a> with <a href="#example-ws-backpressure">§ 10.7 A writable stream with backpressure and success signals</a>. In such cases, it’s best to not return anything. </p>
     <p>The promise potentially returned by this function also governs whether the given chunk counts
   as written for the purposes of computed the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue⑤">desired size to fill the stream’s internal queue</a>. That is, during the time it takes the
   promise to settle, <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size④">writer.desiredSize</a></code> will stay at
   its previous value, only increasing to signal the desire for more chunks once the write
   succeeds. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSink" data-dfn-type="dict-member" data-export data-lt="close" id="dom-underlyingsink-close"><code>close()</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsinkclosecallback" id="ref-for-callbackdef-underlyingsinkclosecallback①">UnderlyingSinkCloseCallback</a></span>
    <dd>
     <p>A function that is called after the <a data-link-type="dfn" href="#producer" id="ref-for-producer②">producer</a> signals, via <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close④">writer.close()</a></code>, that they are done writing <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤②">chunks</a> to
   the stream, and subsequently all queued-up writes have successfully completed. </p>
     <p>This function can perform any actions necessary to finalize or flush writes to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①④">underlying sink</a>, and release access to any held resources. </p>
     <p>If the shutdown process is asynchronous, the function can return a promise to signal success
   or failure; the result will be communicated via the return value of the called <code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close⑤">writer.close()</a></code> method. Additionally, a rejected promise
   will error the stream, instead of letting it close successfully. Throwing an exception is
   treated the same as returning a rejected promise. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSink" data-dfn-type="dict-member" data-export data-lt="abort" id="dom-underlyingsink-abort"><code>abort(<var>reason</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-underlyingsinkabortcallback" id="ref-for-callbackdef-underlyingsinkabortcallback①">UnderlyingSinkAbortCallback</a></span>
    <dd>
     <p>A function that is called after the <a data-link-type="dfn" href="#producer" id="ref-for-producer③">producer</a> signals, via <code class="idl"><a data-link-type="idl" href="#ws-abort" id="ref-for-ws-abort②">stream.abort()</a></code> or <code class="idl"><a data-link-type="idl" href="#default-writer-abort" id="ref-for-default-writer-abort①">writer.abort()</a></code>, that they wish to <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream③">abort</a> the stream. It takes as its argument the same value as was passed to those
   methods by the producer. </p>
     <p>Writable streams can additionally be aborted under certain conditions during <a data-link-type="dfn" href="#piping" id="ref-for-piping⑨">piping</a>; see
   the definition of the <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to⑥">pipeTo()</a></code> method for more details. </p>
     <p>This function can clean up any held resources, much like <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-close" id="ref-for-dom-underlyingsink-close②">close()</a></code>,
   but perhaps with some custom handling. </p>
     <p>If the shutdown process is asynchronous, the function can return a promise to signal success
   or failure; the result will be communicated via the return value of the called <code class="idl"><a data-link-type="idl" href="#default-writer-abort" id="ref-for-default-writer-abort②">writer.abort()</a></code> method. Throwing an exception is treated
   the same as returning a rejected promise. Regardless, the stream will be errored with a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⓪">TypeError</a></code> indicating that it was aborted. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="UnderlyingSink" data-dfn-type="dict-member" data-export id="dom-underlyingsink-type"><code>type</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①④">any</a></span>
    <dd>
     <p>This property is reserved for future use, so any attempts to supply a value will throw an
   exception. </p>
   </dl>
   <p>The <code>controller</code> argument passed to <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-start" id="ref-for-dom-underlyingsink-start②">start()</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write②">write()</a></code> is an instance of <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller③">WritableStreamDefaultController</a></code>, and has the
ability to error the stream. This is mainly used for bridging the gap with non-promise-based APIs,
as seen for example in <a href="#example-ws-no-backpressure">§ 10.6 A writable stream with no backpressure or success signals</a>.</p>
   <h4 class="heading settled" data-level="5.2.4" id="ws-prototype"><span class="secno">5.2.4. </span><span class="content">Constructor, methods, and properties</span><a class="self-link" href="#ws-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>stream</var> = new <code class="idl"><a data-link-type="idl" href="#ws-constructor" id="ref-for-ws-constructor④">WritableStream</a></code>(<var>underlyingSink</var>[, <var>strategy</var>)</code> 
    <dd>
     <p>Creates a new <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①①">WritableStream</a></code> wrapping the provided <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⑤">underlying sink</a>. See <a href="#underlying-sink-api">§ 5.2.3 The underlying sink API</a> for more details on the <var>underlyingSink</var> argument. </p>
     <p>The <var>strategy</var> argument represents the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy④">queuing strategy</a>, as described in <a href="#qs-api">§ 7.1 The queuing strategy API</a>. If it is not provided, the default behavior will be the same as a <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy②">CountQueuingStrategy</a></code> with a <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark④">high water mark</a> of 1. </p>
    <dt><code><var>isLocked</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-locked" id="ref-for-ws-locked②">locked</a></code></code> 
    <dd>
     <p>Returns whether or not the writable stream is <a data-link-type="dfn" href="#lock" id="ref-for-lock①③">locked to a writer</a>. </p>
    <dt><code>await <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-abort" id="ref-for-ws-abort③">abort</a></code>([ <var>reason</var> ])</code> 
    <dd>
     <p><a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream④">Aborts</a> the stream, signaling that the producer can no longer
  successfully write to the stream and it is to be immediately moved to an errored state, with any
  queued-up writes discarded. This will also execute any abort mechanism of the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⑥">underlying
  sink</a>. </p>
     <p>The returned promise will fulfill if the stream shuts down successfully, or reject if the
  underlying sink signaled that there was an error doing so. Additionally, it will reject with a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④①">TypeError</a></code> (without attempting to cancel the stream) if the stream is currently <a data-link-type="dfn" href="#lock" id="ref-for-lock①④">locked</a>. </p>
    <dt><code>await <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-close" id="ref-for-ws-close①">close</a></code>()</code> 
    <dd>
     <p>Closes the stream. The <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⑦">underlying sink</a> will finish processing any previously-written <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤③">chunks</a>, before invoking its close behavior. During this time any further attempts to write
  will fail (without erroring the stream). </p>
     <p>The method returns a promise that will fulfill if all remaining <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤④">chunks</a> are successfully
  written and the stream successfully closes, or rejects if an error is encountered during this
  process. Additionally, it will reject with a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④②">TypeError</a></code> (without attempting to cancel the
  stream) if the stream is currently <a data-link-type="dfn" href="#lock" id="ref-for-lock①⑤">locked</a>. </p>
    <dt><code><var>writer</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-get-writer" id="ref-for-ws-get-writer①">getWriter</a></code>()</code> 
    <dd>
     <p>Creates a <a data-link-type="dfn" href="#writer" id="ref-for-writer③">writer</a> (an instance of <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter④">WritableStreamDefaultWriter</a></code>) and <a data-link-type="dfn" href="#lock" id="ref-for-lock①⑥">locks</a> the stream to the new writer. While the stream is locked, no other writer can be
  acquired until this one is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock⑤">released</a>. </p>
     <p>This functionality is especially useful for creating abstractions that desire the ability to
  write to a stream without interruption or interleaving. By getting a writer for the stream, you
  can ensure nobody else can write at the same time, which would cause the resulting written data
  to be unpredictable and probably useless. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStream/WritableStream" title="The WritableStream() constructor creates a new WritableStream object instance.">WritableStream/WritableStream</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>47+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="WritableStream(underlyingSink, strategy)" data-algorithm-for="WritableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStream" data-dfn-type="constructor" data-export data-lt="WritableStream(underlyingSink, strategy)|constructor(underlyingSink, strategy)|WritableStream(underlyingSink)|constructor(underlyingSink)|WritableStream()|constructor()" id="ws-constructor"><code>new WritableStream(<var>underlyingSink</var>, <var>strategy</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>If <var>underlyingSink</var> is missing, set it to null.</p>
     <li data-md>
      <p>Let <var>underlyingSinkDict</var> be <var>underlyingSink</var>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value" id="ref-for-dfn-convert-ecmascript-to-idl-value①">converted to an IDL value</a> of type <code class="idl"><a data-link-type="idl" href="#dictdef-underlyingsink" id="ref-for-dictdef-underlyingsink">UnderlyingSink</a></code>.</p>
      <p class="note" role="note">We cannot declare the <var>underlyingSink</var> argument as having the <code class="idl"><a data-link-type="idl" href="#dictdef-underlyingsink" id="ref-for-dictdef-underlyingsink①">UnderlyingSink</a></code> type directly, because doing so would lose the reference to the original object. We need to
  retain the object so we can <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function⑦">invoke</a> the various methods on it. </p>
     <li data-md>
      <p>If <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-type" id="ref-for-dom-underlyingsink-type①">type</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①②">exists</a>, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror④">RangeError</a></code> exception.</p>
      <p class="note" role="note">This is to allow us to add new potential types in the future, without
  backward-compatibility concerns. </p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-writable-stream" id="ref-for-initialize-writable-stream">InitializeWritableStream</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧③">this</a>).</p>
     <li data-md>
      <p>Let <var>sizeAlgorithm</var> be ! <a data-link-type="abstract-op" href="#make-size-algorithm-from-size-function" id="ref-for-make-size-algorithm-from-size-function①">ExtractSizeAlgorithm</a>(<var>strategy</var>).</p>
     <li data-md>
      <p>Let <var>highWaterMark</var> be ? <a data-link-type="abstract-op" href="#validate-and-normalize-high-water-mark" id="ref-for-validate-and-normalize-high-water-mark②">ExtractHighWaterMark</a>(<var>strategy</var>, 1).</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-writable-stream-default-controller-from-underlying-sink" id="ref-for-set-up-writable-stream-default-controller-from-underlying-sink">SetUpWritableStreamDefaultControllerFromUnderlyingSink</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧④">this</a>, <var>underlyingSink</var>, <var>underlyingSinkDict</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStream/locked" title="The locked read-only property of the WritableStream interface returns a boolean indicating whether the WritableStream is locked to a writer. ">WritableStream/locked</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>47+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="locked" data-algorithm-for="WritableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStream" data-dfn-type="attribute" data-export id="ws-locked"><code>locked</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked③">IsWritableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⑤">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStream/abort" title="The abort() method of the WritableStream interface aborts the stream, signaling that the producer can no longer successfully write to the stream and it is to be immediately moved to an error state, with any queued writes discarded.">WritableStream/abort</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>47+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="abort(reason)" data-algorithm-for="WritableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStream" data-dfn-type="method" data-export data-lt="abort(reason)|abort()" id="ws-abort"><code>abort(<var>reason</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked④">IsWritableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⑥">this</a>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①②">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④③">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort⑤">WritableStreamAbort</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⑦">this</a>, <var>reason</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="close()" data-algorithm-for="WritableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStream" data-dfn-type="method" data-export id="ws-close"><code>close()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked⑤">IsWritableStreamLocked</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⑧">this</a>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①③">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight③">WritableStreamCloseQueuedOrInFlight</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑧⑨">this</a>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①④">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑤">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-close" id="ref-for-writable-stream-close">WritableStreamClose</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⓪">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStream/getWriter" title="The getWriter() method of the WritableStream interface returns a new instance of WritableStreamDefaultWriter and locks the stream to that instance. While the stream is locked, no other writer can be acquired until this one is released. ">WritableStream/getWriter</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>47+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>44+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="getWriter()" data-algorithm-for="WritableStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStream" data-dfn-type="method" data-export id="ws-get-writer"><code>getWriter()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Return ? <a data-link-type="abstract-op" href="#acquire-writable-stream-default-writer" id="ref-for-acquire-writable-stream-default-writer①">AcquireWritableStreamDefaultWriter</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨①">this</a>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.2.5" id="ws-transfer"><span class="secno">5.2.5. </span><span class="content">Transfer via <code>postMessage()</code></span><a class="self-link" href="#ws-transfer"></a></h4>
   <dl class="domintro">
    <dt><code>destination.postMessage(ws, { transfer: [ws] });</code> 
    <dd>
     <p>Sends a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①②">WritableStream</a></code> to another frame, window, or worker. </p>
     <p>The transferred stream can be used exactly like the original. The original will become <a data-link-type="dfn" href="#lock" id="ref-for-lock①⑦">locked</a> and no longer directly usable. </p>
   </dl>
   <div class="algorithm" data-algorithm="WritableStream transfer steps">
     <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①③">WritableStream</a></code> objects are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects" id="ref-for-transferable-objects②">transferable objects</a>. Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-steps" id="ref-for-transfer-steps①">transfer steps</a>, given <var>value</var> and <var>dataHolder</var>, are: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked⑥">IsWritableStreamLocked</a>(<var>value</var>) is true, throw a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror①">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException②">DOMException</a></code>.</p>
     <li data-md>
      <p>Let <var>port1</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⓪">new</a> <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport②">MessagePort</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑤">the current Realm</a>.</p>
     <li data-md>
      <p>Let <var>port2</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①①">new</a> <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport" id="ref-for-messageport③">MessagePort</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑥">the current Realm</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#entangle" id="ref-for-entangle①">Entangle</a> <var>port1</var> and <var>port2</var>.</p>
     <li data-md>
      <p>Let <var>readable</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①②">new</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④②">ReadableStream</a></code> in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑦">the current Realm</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-setupcrossrealmtransformreadable" id="ref-for-abstract-opdef-setupcrossrealmtransformreadable①">SetUpCrossRealmTransformReadable</a>(<var>readable</var>, <var>port1</var>).</p>
     <li data-md>
      <p>Let <var>promise</var> be ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to③">ReadableStreamPipeTo</a>(<var>readable</var>, <var>value</var>, false, false, false).</p>
     <li data-md>
      <p>Set <var>promise</var>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>Set <var>dataHolder</var>.[[port]] to ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer①">StructuredSerializeWithTransfer</a>(<var>port2</var>, « <var>port2</var> »).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStream transfer-receiving steps">
     Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-receiving-steps" id="ref-for-transfer-receiving-steps①">transfer-receiving steps</a>, given <var>dataHolder</var> and <var>value</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>deserializedRecord</var> be ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer" id="ref-for-structureddeserializewithtransfer①">StructuredDeserializeWithTransfer</a>(<var>dataHolder</var>.[[port]], <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑧">the current Realm</a>).</p>
     <li data-md>
      <p>Let <var>port</var> be a <var>deserializedRecord</var>.[[Deserialized]].</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-setupcrossrealmtransformwritable" id="ref-for-abstract-opdef-setupcrossrealmtransformwritable①">SetUpCrossRealmTransformWritable</a>(<var>value</var>, <var>port</var>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.3" id="default-writer-class"><span class="secno">5.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter⑤">WritableStreamDefaultWriter</a></code> class</span><a class="self-link" href="#default-writer-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter" title="The WritableStreamDefaultWriter interface of the Streams API is the object returned by WritableStream.getWriter() and once created locks the writer to the WritableStream ensuring that no other streams can write to the underlying sink.">WritableStreamDefaultWriter</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter⑥">WritableStreamDefaultWriter</a></code> class represents a <a data-link-type="dfn" href="#writer" id="ref-for-writer④">writable stream writer</a> designed to be
vended by a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①④">WritableStream</a></code> instance.</p>
   <h4 class="heading settled" data-level="5.3.1" id="default-writer-class-definition"><span class="secno">5.3.1. </span><span class="content">Interface definition</span><a class="self-link" href="#default-writer-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter⑦">WritableStreamDefaultWriter</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑦"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="writablestreamdefaultwriter"><code><c- g>WritableStreamDefaultWriter</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#default-writer-constructor" id="ref-for-default-writer-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#writablestream" id="ref-for-writablestream①⑤"><c- n>WritableStream</c-></a> <dfn class="idl-code" data-dfn-for="WritableStreamDefaultWriter/WritableStreamDefaultWriter(stream), WritableStreamDefaultWriter/constructor(stream)" data-dfn-type="argument" data-export id="dom-writablestreamdefaultwriter-writablestreamdefaultwriter-stream-stream"><code><c- g>stream</c-></code><a class="self-link" href="#dom-writablestreamdefaultwriter-writablestreamdefaultwriter-stream-stream"></a></dfn>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①③"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②①"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#default-writer-closed" id="ref-for-default-writer-closed"><c- g>closed</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double③"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size⑤"><c- g>desiredSize</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①④"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②②"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#default-writer-ready" id="ref-for-default-writer-ready⑦"><c- g>ready</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⑤"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②③"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-abort" id="ref-for-default-writer-abort③"><c- g>abort</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⑤"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="WritableStreamDefaultWriter/abort(reason), WritableStreamDefaultWriter/abort()" data-dfn-type="argument" data-export id="dom-writablestreamdefaultwriter-abort-reason-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-writablestreamdefaultwriter-abort-reason-reason"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⑥"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②④"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-close" id="ref-for-default-writer-close⑥"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⑤"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#default-writer-release-lock" id="ref-for-default-writer-release-lock①"><c- g>releaseLock</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⑦"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⑥"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-write" id="ref-for-default-writer-write①⓪"><c- g>write</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⑥"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="WritableStreamDefaultWriter/write(chunk), WritableStreamDefaultWriter/write()" data-dfn-type="argument" data-export id="dom-writablestreamdefaultwriter-write-chunk-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-writablestreamdefaultwriter-write-chunk-chunk"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="5.3.2" id="default-writer-internal-slots"><span class="secno">5.3.2. </span><span class="content">Internal slots</span><a class="self-link" href="#default-writer-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter⑧">WritableStreamDefaultWriter</a></code> are created with the internal slots described in the
following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot 
      <th>Description (<em>non-normative</em>) 
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="dfn" data-noexport id="writablestreamdefaultwriter-closedpromise">[[closedPromise]]</dfn> 
      <td class="non-normative">A promise returned by the writer’s <code class="idl"><a data-link-type="idl" href="#default-writer-closed" id="ref-for-default-writer-closed①">closed</a></code> getter 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="dfn" data-noexport id="writablestreamdefaultwriter-readypromise">[[readyPromise]]</dfn> 
      <td class="non-normative">A promise returned by the writer’s <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready⑧">ready</a></code> getter 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="dfn" data-noexport id="writablestreamdefaultwriter-stream">[[stream]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①⑥">WritableStream</a></code> instance that owns this reader 
   </table>
   <h4 class="heading settled" data-level="5.3.3" id="default-writer-prototype"><span class="secno">5.3.3. </span><span class="content">Constructor, methods, and properties</span><a class="self-link" href="#default-writer-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>writer</var> = new <code class="idl"><a data-link-type="idl" href="#default-writer-constructor" id="ref-for-default-writer-constructor①">WritableStreamDefaultWriter</a></code>(<var>stream</var>)</code> 
    <dd>
     <p>This is equivalent to calling <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-get-writer" id="ref-for-ws-get-writer②">getWriter()</a></code></code>. </p>
    <dt><code>await <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-closed" id="ref-for-default-writer-closed②">closed</a></code></code> 
    <dd>
     <p>Returns a promise that will be fulfilled when the stream becomes closed, or rejected if the
  stream ever errors or the writer’s lock is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock⑥">released</a> before the stream
  finishes closing. </p>
    <dt><code><var>desiredSize</var> = <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size⑥">desiredSize</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue⑥">desired size to fill the stream’s
  internal queue</a>. It can be negative, if the queue is over-full. A <a data-link-type="dfn" href="#producer" id="ref-for-producer④">producer</a> can use this
  information to determine the right amount of data to write. </p>
     <p>It will be null if the stream cannot be successfully written to (due to either being errored,
  or having an abort queued up). It will return zero if the stream is closed. And the getter will
  throw an exception if invoked when the writer’s lock is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock⑦">released</a>. </p>
    <dt><code>await <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready⑨">ready</a></code></code> 
    <dd>
     <p>Returns a promise that will be fulfilled when the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue⑦">desired size to fill the stream’s internal queue</a> transitions from non-positive to
  positive, signaling that it is no longer applying <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①②">backpressure</a>. Once the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue⑧">desired size</a> dips back to zero or below, the getter will return
  a new promise that stays pending until the next transition. </p>
     <p>If the stream becomes errored or aborted, or the writer’s lock is <a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock⑧">released</a>, the returned promise will become rejected. </p>
    <dt><code>await <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-abort" id="ref-for-default-writer-abort④">abort</a></code>([ <var>reason</var> ])</code> 
    <dd>
     <p>If the reader is <a data-link-type="dfn" href="#active" id="ref-for-active④">active</a>, behaves the same as <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-abort" id="ref-for-ws-abort④">abort</a></code>(<var>reason</var>)</code>. </p>
    <dt><code>await <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-close" id="ref-for-default-writer-close⑦">close</a></code>()</code> 
    <dd>
     <p>If the reader is <a data-link-type="dfn" href="#active" id="ref-for-active⑤">active</a>, behaves the same as <code><var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ws-close" id="ref-for-ws-close②">close</a></code>()</code>. </p>
    <dt><code><var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-release-lock" id="ref-for-default-writer-release-lock②">releaseLock</a></code>()</code> 
    <dd>
     <p><a data-link-type="dfn" href="#release-a-lock" id="ref-for-release-a-lock⑨">Releases the writer’s lock</a> on the corresponding stream. After the lock
  is released, the writer is no longer <a data-link-type="dfn" href="#active" id="ref-for-active⑥">active</a>. If the associated stream is errored
  when the lock is released, the writer will appear errored in the same way from now on; otherwise,
  the writer will appear closed. </p>
     <p>Note that the lock can still be released even if some ongoing writes have not yet finished
  (i.e. even if the promises returned from previous calls to <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write①①">write()</a></code> have not yet settled). It’s not necessary to hold the
  lock on the writer for the duration of the write; the lock instead simply prevents other <a data-link-type="dfn" href="#producer" id="ref-for-producer⑤">producers</a> from writing in an interleaved manner. </p>
    <dt><code>await <var>writer</var>.<code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write①②">write</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Writes the given <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⑤">chunk</a> to the writable stream, by waiting until any previous writes have
  finished successfully, and then sending the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⑥">chunk</a> to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⑧">underlying sink</a>'s <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write③">write()</a></code> method. It will return a promise that fulfills with undefined
  upon a successful write, or rejects if the write fails or stream becomes errored before the
  writing process is initiated. </p>
     <p>Note that what "success" means is up to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink①⑨">underlying sink</a>; it might indicate simply that
  the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⑦">chunk</a> has been accepted, and not necessarily that it is safely saved to its ultimate
  destination. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/WritableStreamDefaultWriter" title="The WritableStreamDefaultWriter() constructor creates a new WritableStreamDefaultWriter object instance. ">WritableStreamDefaultWriter/WritableStreamDefaultWriter</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriter(stream)" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="constructor" data-export data-lt="WritableStreamDefaultWriter(stream)|constructor(stream)" id="default-writer-constructor"><code>new WritableStreamDefaultWriter(<var>stream</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-writable-stream-default-writer" id="ref-for-set-up-writable-stream-default-writer">SetUpWritableStreamDefaultWriter</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨②">this</a>, <var>stream</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/closed" title="The closed read-only property of the WritableStreamDefaultWriter interface returns a promise that fulfills if the stream becomes closed or the writer&apos;s lock is released, or rejects if the stream errors.">WritableStreamDefaultWriter/closed</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="closed" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="attribute" data-export id="default-writer-closed"><code>closed</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨③">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise">[[closedPromise]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/desiredSize" title="The desiredSize read-only property of the WritableStreamDefaultWriter interface returns the desired size required to fill the stream&apos;s internal queue.">WritableStreamDefaultWriter/desiredSize</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="desiredSize" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="attribute" data-export id="default-writer-desired-size"><code>desiredSize</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨④">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream">[[stream]]</a> is undefined, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑥">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-get-desired-size" id="ref-for-writable-stream-default-writer-get-desired-size②">WritableStreamDefaultWriterGetDesiredSize</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⑤">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/ready" title="The ready read-only property of the WritableStreamDefaultWriter interface returns a Promise that resolves when the desired size of the stream&apos;s internal queue transitions from non-positive to positive, signaling that it is no longer applying backpressure.">WritableStreamDefaultWriter/ready</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="ready" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="attribute" data-export id="default-writer-ready"><code>ready</code></dfn> getter
 steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⑥">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise">[[readyPromise]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/abort" title="The abort() method of the WritableStreamDefaultWriter interface aborts the stream, signaling that the producer can no longer successfully write to the stream and it is to be immediately moved to an error state, with any queued writes discarded. ">WritableStreamDefaultWriter/abort</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="abort(reason)" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="method" data-export data-lt="abort(reason)|abort()" id="default-writer-abort"><code>abort(<var>reason</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⑦">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream①">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑤">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑦">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-abort" id="ref-for-writable-stream-default-writer-abort">WritableStreamDefaultWriterAbort</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⑧">this</a>, <var>reason</var>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/close" title="The close() method of the WritableStreamDefaultWriter interface closes the associated writable stream. ">WritableStreamDefaultWriter/close</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="close()" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="method" data-export id="default-writer-close"><code>close()</code></dfn> method
 steps are: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this⑨⑨">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream②">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑥">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑧">TypeError</a></code> exception.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight④">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is true, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑦">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑨">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-close" id="ref-for-writable-stream-default-writer-close">WritableStreamDefaultWriterClose</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⓪">this</a>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="releaseLock()" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="method" data-export id="default-writer-release-lock"><code>releaseLock()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪①">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream③">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var> is undefined, return.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer">[[writer]]</a> is not undefined.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-release" id="ref-for-writable-stream-default-writer-release①">WritableStreamDefaultWriterRelease</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪②">this</a>).</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultWriter/write" title="The write() method of the WritableStreamDefaultWriter interface writes a passed chunk of data to a WritableStream and its underlying sink, then returns a Promise that resolves to indicate the success or failure of the write operation.">WritableStreamDefaultWriter/write</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="write(chunk)" data-algorithm-for="WritableStreamDefaultWriter">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="method" data-export data-lt="write(chunk)|write()" id="default-writer-write"><code>write(<var>chunk</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪③">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream④">[[stream]]</a> is undefined, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑧">a promise rejected
  with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⓪">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-write" id="ref-for-writable-stream-default-writer-write">WritableStreamDefaultWriterWrite</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪④">this</a>, <var>chunk</var>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.4" id="ws-default-controller-class"><span class="secno">5.4. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller④">WritableStreamDefaultController</a></code> class</span><a class="self-link" href="#ws-default-controller-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultController" title="The WritableStreamDefaultController interface of the Streams API represents a controller allowing control of a WritableStream&apos;s state. When constructing a WritableStream, the underlying sink is given a corresponding WritableStreamDefaultController instance to manipulate.">WritableStreamDefaultController</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>58+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>45+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>18</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>58+</span></span><span class="webview_android yes"><span>Android WebView</span><span>58+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller⑤">WritableStreamDefaultController</a></code> class has methods that allow control of a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①⑦">WritableStream</a></code>'s state. When constructing a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①⑧">WritableStream</a></code>, the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⓪">underlying sink</a> is
given a corresponding <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller⑥">WritableStreamDefaultController</a></code> instance to manipulate.</p>
   <h4 class="heading settled" data-level="5.4.1" id="ws-default-controller-class-definition"><span class="secno">5.4.1. </span><span class="content">Interface definition</span><a class="self-link" href="#ws-default-controller-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller⑦">WritableStreamDefaultController</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑧"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="writablestreamdefaultcontroller"><code><c- g>WritableStreamDefaultController</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⑦"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ws-default-controller-error" id="ref-for-ws-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⑦"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="WritableStreamDefaultController/error(e), WritableStreamDefaultController/error()" data-dfn-type="argument" data-export id="dom-writablestreamdefaultcontroller-error-e-e"><code><c- g>e</c-></code><a class="self-link" href="#dom-writablestreamdefaultcontroller-error-e-e"></a></dfn>);
};
</pre>
   <h4 class="heading settled" data-level="5.4.2" id="ws-default-controller-internal-slots"><span class="secno">5.4.2. </span><span class="content">Internal slots</span><a class="self-link" href="#ws-default-controller-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller⑧">WritableStreamDefaultController</a></code> are created with the internal slots described in
the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-abortalgorithm">[[abortAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm, taking one argument (the abort reason),
   which communicates a requested abort to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②①">underlying sink</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-closealgorithm">[[closeAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm which communicates a requested close to
   the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②②">underlying sink</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-queue">[[queue]]</dfn> 
      <td class="non-normative">A <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①③">list</a> representing the stream’s internal queue of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⑧">chunks</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-queuetotalsize">[[queueTotalSize]]</dfn> 
      <td class="non-normative">The total size of all the chunks stored in <a data-link-type="dfn" href="#writablestreamdefaultcontroller-queue" id="ref-for-writablestreamdefaultcontroller-queue">[[queue]]</a> (see <a href="#queue-with-sizes">§ 8.1 Queue-with-sizes</a>) 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-started">[[started]]</dfn> 
      <td class="non-normative">A boolean flag indicating whether the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②③">underlying sink</a> has finished
   starting 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-strategyhwm">[[strategyHWM]]</dfn> 
      <td class="non-normative">A number supplied by the creator of the stream as part of the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy⑤">queuing strategy</a>, indicating the point at which the stream will apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①③">backpressure</a> to its <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②④">underlying sink</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-strategysizealgorithm">[[strategySizeAlgorithm]]</dfn> 
      <td class="non-normative">An algorithm to calculate the size of enqueued <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑤⑨">chunks</a>, as part of
    the stream’s <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy⑥">queuing strategy</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-stream">[[stream]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream①⑨">WritableStream</a></code> instance controlled 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="WritableStreamDefaultController" data-dfn-type="dfn" data-noexport id="writablestreamdefaultcontroller-writealgorithm">[[writeAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm, taking one argument (the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⓪">chunk</a> to
   write), which writes data to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⑤">underlying sink</a> 
   </table>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="close-sentinel">close sentinel</dfn> is a unique value enqueued into <a data-link-type="dfn" href="#writablestreamdefaultcontroller-queue" id="ref-for-writablestreamdefaultcontroller-queue①">[[queue]]</a>, in lieu of a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥①">chunk</a>, to signal that the stream is
closed. It is only used internally, and is never exposed to web developers.</p>
   <h4 class="heading settled" data-level="5.4.3" id="ws-default-controller-prototype"><span class="secno">5.4.3. </span><span class="content">Methods</span><a class="self-link" href="#ws-default-controller-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#ws-default-controller-error" id="ref-for-ws-default-controller-error①">error</a></code>(<var>e</var>)</code> 
    <dd>
     <p>Closes the controlled writable stream, making all future interactions with it fail with the
  given error <var>e</var>. </p>
     <p>This method is rarely used, since usually it suffices to return a rejected promise from one of
  the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⑥">underlying sink</a>'s methods. However, it can be useful for suddenly shutting down a stream
  in response to an event outside the normal lifecycle of interactions with the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⑦">underlying
  sink</a>. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/WritableStreamDefaultController/error" title="The error() method of the WritableStreamDefaultController interface causes any future interactions with the associated stream to error.">WritableStreamDefaultController/error</a></p>
     <p class="less-than-two-engines-text">In no current engines.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome no"><span>Chrome</span><span>?</span></span>
      <hr>
      <span class="opera no"><span>Opera</span><span>?</span></span><span class="edge_blink no"><span>Edge</span><span>?</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android no"><span>Chrome for Android</span><span>?</span></span><span class="webview_android no"><span>Android WebView</span><span>?</span></span><span class="samsunginternet_android no"><span>Samsung Internet</span><span>?</span></span><span class="opera_android no"><span>Opera Mobile</span><span>?</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="error(e)" data-algorithm-for="WritableStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="WritableStreamDefaultController" data-dfn-type="method" data-export data-lt="error(e)|error()" id="ws-default-controller-error"><code>error(<var>e</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⑤">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream">[[stream]]</a>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state⑤">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is not "<code>writable</code>", return.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error" id="ref-for-writable-stream-default-controller-error">WritableStreamDefaultControllerError</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⑥">this</a>, <var>e</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.4.4" id="ws-default-controller-internal-methods"><span class="secno">5.4.4. </span><span class="content">Internal methods</span><a class="self-link" href="#ws-default-controller-internal-methods"></a></h4>
   <p>The following are internal methods implemented by each <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller⑨">WritableStreamDefaultController</a></code> instance.
The writable stream implementation will call into these.</p>
   <p class="note" role="note">The reason these are in method form, instead of as abstract operations, is to make
it clear that the writable stream implementation is decoupled from the controller implementation,
and could in the future be expanded with other controllers, as long as those controllers
implemented such internal methods. A similar scenario is seen for readable streams (see <a href="#rs-abstract-ops-used-by-controllers">§ 4.9.2 Interfacing with controllers</a>), where there actually are multiple controller types and
as such the counterpart internal methods are used polymorphically. </p>
   <div class="algorithm" data-algorithm="[[AbortSteps]]" data-algorithm-for="WritableStreamDefaultController">
     <dfn data-dfn-for="WritableStreamDefaultController" data-dfn-type="abstract-op" data-export data-lt="[[AbortSteps]]" id="ws-default-controller-private-abort">[[AbortSteps]](<var>reason</var>)<span id="writable-stream-default-controller-abort"></span><a class="self-link" href="#ws-default-controller-private-abort"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-writablestreamcontroller-abortsteps" id="ref-for-abstract-opdef-writablestreamcontroller-abortsteps">[[AbortSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>result</var> be the result of performing <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⑦">this</a>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-abortalgorithm" id="ref-for-writablestreamdefaultcontroller-abortalgorithm">[[abortAlgorithm]]</a>, passing <var>reason</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-clear-algorithms" id="ref-for-writable-stream-default-controller-clear-algorithms">WritableStreamDefaultControllerClearAlgorithms</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⑧">this</a>).</p>
     <li data-md>
      <p>Return <var>result</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="[[ErrorSteps]]" data-algorithm-for="WritableStreamDefaultController">
     <dfn data-dfn-for="WritableStreamDefaultController" data-dfn-type="abstract-op" data-export data-lt="[[ErrorSteps]]" id="ws-default-controller-private-error">[[ErrorSteps]]()<a class="self-link" href="#ws-default-controller-private-error"></a></dfn> implements the <a data-link-type="abstract-op" href="#abstract-opdef-writablestreamcontroller-errorsteps" id="ref-for-abstract-opdef-writablestreamcontroller-errorsteps">[[ErrorSteps]]</a> contract. It performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue⑥">ResetQueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①⓪⑨">this</a>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="5.5" id="ws-all-abstract-ops"><span class="secno">5.5. </span><span class="content">Abstract operations</span><a class="self-link" href="#ws-all-abstract-ops"></a></h3>
   <h4 class="heading settled" data-level="5.5.1" id="ws-abstract-ops"><span class="secno">5.5.1. </span><span class="content">Working with writable streams</span><a class="self-link" href="#ws-abstract-ops"></a></h4>
   <p>The following abstract operations operate on <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②⓪">WritableStream</a></code> instances at a higher level.</p>
   <div class="algorithm" data-algorithm="AcquireWritableStreamDefaultWriter">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="AcquireWritableStreamDefaultWriter" id="acquire-writable-stream-default-writer">AcquireWritableStreamDefaultWriter(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>writer</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①③">new</a> <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter⑨">WritableStreamDefaultWriter</a></code>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-writable-stream-default-writer" id="ref-for-set-up-writable-stream-default-writer①">SetUpWritableStreamDefaultWriter</a>(<var>writer</var>, <var>stream</var>).</p>
     <li data-md>
      <p>Return <var>writer</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="CreateWritableStream">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="CreateWritableStream" id="create-writable-stream">CreateWritableStream(<var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>)</dfn> performs the following
 steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-non-negative-number" id="ref-for-is-non-negative-number①">IsNonNegativeNumber</a>(<var>highWaterMark</var>) is true.</p>
     <li data-md>
      <p>Let <var>stream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①④">new</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②①">WritableStream</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-writable-stream" id="ref-for-initialize-writable-stream①">InitializeWritableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⑤">new</a> <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①⓪">WritableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-writable-stream-default-controller" id="ref-for-set-up-writable-stream-default-controller">SetUpWritableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
     <li data-md>
      <p>Return <var>stream</var>.</p>
    </ol>
    <p class="note" role="note">This abstract operation will throw an exception if and only if the supplied <var>startAlgorithm</var> throws. </p>
   </div>
   <div class="algorithm" data-algorithm="InitializeWritableStream">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="InitializeWritableStream" id="initialize-writable-stream">InitializeWritableStream(<var>stream</var>)</dfn> performs the following
 steps: 
    <ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state⑥">[[state]]</a> to "<code>writable</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror③">[[storedError]]</a>, <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer①">[[writer]]</a>, <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller">[[controller]]</a>, <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest①">[[inFlightWriteRequest]]</a>, <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest①">[[closeRequest]]</a>, <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest①">[[inFlightCloseRequest]]</a>, and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest">[[pendingAbortRequest]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests①">[[writeRequests]]</a> to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①④">list</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-backpressure" id="ref-for-writablestream-backpressure">[[backpressure]]</a> to false.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="IsWritableStreamLocked">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="IsWritableStreamLocked" id="is-writable-stream-locked">IsWritableStreamLocked(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer②">[[writer]]</a> is undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpWritableStreamDefaultWriter">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpWritableStreamDefaultWriter" id="set-up-writable-stream-default-writer">SetUpWritableStreamDefaultWriter(<var>writer</var>, <var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked⑦">IsWritableStreamLocked</a>(<var>stream</var>) is true, throw a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤①">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream⑤">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer③">[[writer]]</a> to <var>writer</var>.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state⑦">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>writable</code>",</p>
      <ol>
       <li data-md>
        <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight⑤">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is false and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-backpressure" id="ref-for-writablestream-backpressure①">[[backpressure]]</a> is true, set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise⑥">a new promise</a>.</p>
       <li data-md>
        <p>Otherwise, set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise②">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①④">a promise
  resolved with</a> undefined.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise①">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise⑦">a new promise</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise, if <var>state</var> is "<code>erroring</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise③">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with①⑨">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror④">[[storedError]]</a>.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise④">[[readyPromise]]</a>.[[PromiseIsHandled]] to true.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise②">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise⑧">a new promise</a>.</p>
      </ol>
     <li data-md>
      <p>Otherwise, if <var>state</var> is "<code>closed</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise⑤">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⑤">a promise resolved with</a> undefined.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise③">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⑥">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Otherwise,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>state</var> is "<code>errored</code>".</p>
       <li data-md>
        <p>Let <var>storedError</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror⑤">[[storedError]]</a>.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise⑥">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⓪">a promise rejected with</a> <var>storedError</var>.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise⑦">[[readyPromise]]</a>.[[PromiseIsHandled]] to true.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise④">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②①">a promise rejected with</a> <var>storedError</var>.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise⑤">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamAbort">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamAbort" id="writable-stream-abort">WritableStreamAbort(<var>stream</var>, <var>reason</var>)</dfn> performs the following
 steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state⑧">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>" or "<code>errored</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⑦">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest①">[[pendingAbortRequest]]</a> is not undefined, return <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest②">[[pendingAbortRequest]]</a>'s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise">promise</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p>Let <var>wasAlreadyErroring</var> be false.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>erroring</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>wasAlreadyErroring</var> to true.</p>
       <li data-md>
        <p>Set <var>reason</var> to undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise⑨">a new promise</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest③">[[pendingAbortRequest]]</a> to a new <a data-link-type="dfn" href="#pending-abort-request" id="ref-for-pending-abort-request①">pending abort request</a> whose <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise①">promise</a> is <var>promise</var>, <a data-link-type="dfn" href="#pending-abort-request-reason" id="ref-for-pending-abort-request-reason">reason</a> is <var>reason</var>,
  and <a data-link-type="dfn" href="#pending-abort-request-was-already-erroring" id="ref-for-pending-abort-request-was-already-erroring">was already erroring</a> is <var>wasAlreadyErroring</var>.</p>
     <li data-md>
      <p>If <var>wasAlreadyErroring</var> is false, perform ! <a data-link-type="abstract-op" href="#writable-stream-start-erroring" id="ref-for-writable-stream-start-erroring">WritableStreamStartErroring</a>(<var>stream</var>, <var>reason</var>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamClose" id="writable-stream-close">WritableStreamClose(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state⑨">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>" or "<code>errored</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②②">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤②">TypeError</a></code> exception.</p>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight⑥">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is false.</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①⓪">a new promise</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest②">[[closeRequest]]</a> to <var>promise</var>.</p>
     <li data-md>
      <p>Let <var>writer</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer④">[[writer]]</a>.</p>
     <li data-md>
      <p>If <var>writer</var> is not undefined, and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-backpressure" id="ref-for-writablestream-backpressure②">[[backpressure]]</a> is true, and <var>state</var> is "<code>writable</code>", <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①②">resolve</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise⑧">[[readyPromise]]</a> with undefined.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-close" id="ref-for-writable-stream-default-controller-close">WritableStreamDefaultControllerClose</a>(<var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller①">[[controller]]</a>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.5.2" id="ws-abstract-ops-used-by-controllers"><span class="secno">5.5.2. </span><span class="content">Interfacing with controllers</span><a class="self-link" href="#ws-abstract-ops-used-by-controllers"></a></h4>
   <p>To allow future flexibility to add different writable stream behaviors (similar to the distinction
between default readable streams and <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①②">readable byte streams</a>), much of the internal state of a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream⑦">writable stream</a> is encapsulated by the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①①">WritableStreamDefaultController</a></code> class.</p>
   <p>Each controller class defines two internal methods, which are called by the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②②">WritableStream</a></code> algorithms:</p>
   <dl>
    <dt><dfn class="dfn-paneled" data-dfn-for="WritableStreamController" data-dfn-type="abstract-op" data-export data-lt="[[AbortSteps]]" id="abstract-opdef-writablestreamcontroller-abortsteps">[[AbortSteps]](<var>reason</var>)</dfn> 
    <dd>The controller’s steps that run in reaction to the stream being <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream⑤">aborted</a>, used to clean up the state stored in the controller and inform the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⑧">underlying sink</a>. 
    <dt><dfn class="dfn-paneled" data-dfn-for="WritableStreamController" data-dfn-type="abstract-op" data-export data-lt="[[ErrorSteps]]" id="abstract-opdef-writablestreamcontroller-errorsteps">[[ErrorSteps]]()</dfn> 
    <dd>The controller’s steps that run in reaction to the stream being errored, used to clean up the
   state stored in the controller. 
   </dl>
   <p>(These are defined as internal methods, instead of as abstract operations, so that they can be
called polymorphically by the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②③">WritableStream</a></code> algorithms, without having to branch on which type
of controller is present. This is a bit theoretical for now, given that only <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①②">WritableStreamDefaultController</a></code> exists so far.)</p>
   <p>The rest of this section concerns abstract operations that go in the other direction: they are used
by the controller implementation to affect its associated <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②④">WritableStream</a></code> object. This
translates internal state changes of the controllerinto developer-facing results visible through
the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②⑤">WritableStream</a></code>'s public API.</p>
   <div class="algorithm" data-algorithm="WritableStreamAddWriteRequest">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamAddWriteRequest" id="writable-stream-add-write-request">WritableStreamAddWriteRequest(<var>stream</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked⑧">IsWritableStreamLocked</a>(<var>stream</var>) is true.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⓪">[[state]]</a> is "<code>writable</code>".</p>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①①">a new promise</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑥">Append</a> <var>promise</var> to <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests②">[[writeRequests]]</a>.</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamCloseQueuedOrInFlight">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamCloseQueuedOrInFlight" id="writable-stream-close-queued-or-in-flight">WritableStreamCloseQueuedOrInFlight(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest③">[[closeRequest]]</a> is undefined and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest②">[[inFlightCloseRequest]]</a> is undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDealWithRejection">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDealWithRejection" id="writable-stream-deal-with-rejection">WritableStreamDealWithRejection(<var>stream</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①①">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>writable</code>",</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-start-erroring" id="ref-for-writable-stream-start-erroring①">WritableStreamStartErroring</a>(<var>stream</var>, <var>error</var>).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is "<code>erroring</code>".</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-erroring" id="ref-for-writable-stream-finish-erroring">WritableStreamFinishErroring</a>(<var>stream</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamFinishErroring">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamFinishErroring" id="writable-stream-finish-erroring">WritableStreamFinishErroring(<var>stream</var>, <var>reason</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①②">[[state]]</a> is "<code>erroring</code>".</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#writable-stream-has-operation-marked-in-flight" id="ref-for-writable-stream-has-operation-marked-in-flight">WritableStreamHasOperationMarkedInFlight</a>(<var>stream</var>) is false.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①③">[[state]]</a> to "<code>errored</code>".</p>
     <li data-md>
      <p>Perform ! <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller②">[[controller]]</a>.<a data-link-type="abstract-op" href="#abstract-opdef-writablestreamcontroller-errorsteps" id="ref-for-abstract-opdef-writablestreamcontroller-errorsteps①">[[ErrorSteps]]</a>().</p>
     <li data-md>
      <p>Let <var>storedError</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror⑥">[[storedError]]</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-iterate" id="ref-for-list-iterate③">For each</a> <var>writeRequest</var> of <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests③">[[writeRequests]]</a>:</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject⑥">Reject</a> <var>writeRequest</var> with <var>storedError</var>.</p>
      </ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests④">[[writeRequests]]</a> to an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①⑤">list</a>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest④">[[pendingAbortRequest]]</a> is undefined,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-reject-close-and-closed-promise-if-needed" id="ref-for-writable-stream-reject-close-and-closed-promise-if-needed">WritableStreamRejectCloseAndClosedPromiseIfNeeded</a>(<var>stream</var>).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>Let <var>abortRequest</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest⑤">[[pendingAbortRequest]]</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest⑥">[[pendingAbortRequest]]</a> to undefined.</p>
     <li data-md>
      <p>If <var>abortRequest</var>’s <a data-link-type="dfn" href="#pending-abort-request-was-already-erroring" id="ref-for-pending-abort-request-was-already-erroring①">was already erroring</a> is true,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject⑦">Reject</a> <var>abortRequest</var>’s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise②">promise</a> with <var>storedError</var>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-reject-close-and-closed-promise-if-needed" id="ref-for-writable-stream-reject-close-and-closed-promise-if-needed①">WritableStreamRejectCloseAndClosedPromiseIfNeeded</a>(<var>stream</var>).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>Let <var>promise</var> be ! <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller③">[[controller]]</a>.<a data-link-type="abstract-op" href="#abstract-opdef-writablestreamcontroller-abortsteps" id="ref-for-abstract-opdef-writablestreamcontroller-abortsteps①">[[AbortSteps]]</a>(<var>abortRequest</var>’s <a data-link-type="dfn" href="#pending-abort-request-reason" id="ref-for-pending-abort-request-reason①">reason</a>).</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment⑤">Upon fulfillment</a> of <var>promise</var>,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①③">Resolve</a> <var>abortRequest</var>’s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise③">promise</a> with undefined.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-reject-close-and-closed-promise-if-needed" id="ref-for-writable-stream-reject-close-and-closed-promise-if-needed②">WritableStreamRejectCloseAndClosedPromiseIfNeeded</a>(<var>stream</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection⑥">Upon rejection</a> of <var>promise</var> with reason <var>reason</var>,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject⑧">Reject</a> <var>abortRequest</var>’s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise④">promise</a> with <var>reason</var>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-reject-close-and-closed-promise-if-needed" id="ref-for-writable-stream-reject-close-and-closed-promise-if-needed③">WritableStreamRejectCloseAndClosedPromiseIfNeeded</a>(<var>stream</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamFinishInFlightClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamFinishInFlightClose" id="writable-stream-finish-in-flight-close">WritableStreamFinishInFlightClose(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest③">[[inFlightCloseRequest]]</a> is not undefined.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①④">Resolve</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest④">[[inFlightCloseRequest]]</a> with undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest⑤">[[inFlightCloseRequest]]</a> to undefined.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①④">[[state]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⑤">[[state]]</a> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p>If <var>state</var> is "<code>erroring</code>",</p>
      <ol>
       <li data-md>
        <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror⑦">[[storedError]]</a> to undefined.</p>
       <li data-md>
        <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest⑦">[[pendingAbortRequest]]</a> is not undefined,</p>
        <ol>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⑤">Resolve</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest⑧">[[pendingAbortRequest]]</a>'s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise⑤">promise</a> with undefined.</p>
         <li data-md>
          <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest⑨">[[pendingAbortRequest]]</a> to undefined.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⑥">[[state]]</a> to "<code>closed</code>".</p>
     <li data-md>
      <p>Let <var>writer</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer⑤">[[writer]]</a>.</p>
     <li data-md>
      <p>If <var>writer</var> is not undefined, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⑥">resolve</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise⑥">[[closedPromise]]</a> with undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest①⓪">[[pendingAbortRequest]]</a> is undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror⑧">[[storedError]]</a> is undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamFinishInFlightCloseWithError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamFinishInFlightCloseWithError" id="writable-stream-finish-in-flight-close-with-error">WritableStreamFinishInFlightCloseWithError(<var>stream</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest⑥">[[inFlightCloseRequest]]</a> is not undefined.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject⑨">Reject</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest⑦">[[inFlightCloseRequest]]</a> with <var>error</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest⑧">[[inFlightCloseRequest]]</a> to undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⑦">[[state]]</a> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest①①">[[pendingAbortRequest]]</a> is not undefined,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①⓪">Reject</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest①②">[[pendingAbortRequest]]</a>'s <a data-link-type="dfn" href="#pending-abort-request-promise" id="ref-for-pending-abort-request-promise⑥">promise</a> with <var>error</var>.</p>
       <li data-md>
        <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-pendingabortrequest" id="ref-for-writablestream-pendingabortrequest①③">[[pendingAbortRequest]]</a> to undefined.</p>
      </ol>
     <li data-md>
      <p>Perform ! WritableStreamDealWithRejection(<var>stream</var>, <var>error</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamFinishInFlightWrite">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamFinishInFlightWrite" id="writable-stream-finish-in-flight-write">WritableStreamFinishInFlightWrite(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest②">[[inFlightWriteRequest]]</a> is not undefined.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⑦">Resolve</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest③">[[inFlightWriteRequest]]</a> with undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest④">[[inFlightWriteRequest]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamFinishInFlightWriteWithError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamFinishInFlightWriteWithError" id="writable-stream-finish-in-flight-write-with-error">WritableStreamFinishInFlightWriteWithError(<var>stream</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest⑤">[[inFlightWriteRequest]]</a> is not undefined.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①①">Reject</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest⑥">[[inFlightWriteRequest]]</a> with <var>error</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest⑦">[[inFlightWriteRequest]]</a> to undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⑧">[[state]]</a> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-deal-with-rejection" id="ref-for-writable-stream-deal-with-rejection">WritableStreamDealWithRejection</a>(<var>stream</var>, <var>error</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamHasOperationMarkedInFlight">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamHasOperationMarkedInFlight" id="writable-stream-has-operation-marked-in-flight">WritableStreamHasOperationMarkedInFlight(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest⑧">[[inFlightWriteRequest]]</a> is undefined and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller④">[[controller]]</a>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest⑨">[[inFlightCloseRequest]]</a> is
  undefined, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamMarkCloseRequestInFlight">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamMarkCloseRequestInFlight" id="writable-stream-mark-close-request-in-flight">WritableStreamMarkCloseRequestInFlight(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest①⓪">[[inFlightCloseRequest]]</a> is undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest④">[[closeRequest]]</a> is not undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest①①">[[inFlightCloseRequest]]</a> to <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest⑤">[[closeRequest]]</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest⑥">[[closeRequest]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamMarkFirstWriteRequestInFlight">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamMarkFirstWriteRequestInFlight" id="writable-stream-mark-first-write-request-in-flight">WritableStreamMarkFirstWriteRequestInFlight(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest⑨">[[inFlightWriteRequest]]</a> is undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests⑤">[[writeRequests]]</a> is not empty.</p>
     <li data-md>
      <p>Let <var>writeRequest</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests⑥">[[writeRequests]]</a>[0].</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑤">Remove</a> <var>writeRequest</var> from <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writerequests" id="ref-for-writablestream-writerequests⑦">[[writeRequests]]</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest①⓪">[[inFlightWriteRequest]]</a> to <var>writeRequest</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamRejectCloseAndClosedPromiseIfNeeded">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamRejectCloseAndClosedPromiseIfNeeded" id="writable-stream-reject-close-and-closed-promise-if-needed">WritableStreamRejectCloseAndClosedPromiseIfNeeded(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state①⑨">[[state]]</a> is "<code>errored</code>".</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest⑦">[[closeRequest]]</a> is not undefined,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightcloserequest" id="ref-for-writablestream-inflightcloserequest①②">[[inFlightCloseRequest]]</a> is undefined.</p>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①②">Reject</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest⑧">[[closeRequest]]</a> with <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror⑨">[[storedError]]</a>.</p>
       <li data-md>
        <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-closerequest" id="ref-for-writablestream-closerequest⑨">[[closeRequest]]</a> to undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>writer</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer⑥">[[writer]]</a>.</p>
     <li data-md>
      <p>If <var>writer</var> is not undefined,</p>
      <ol>
       <li data-md>
        <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①③">Reject</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise⑦">[[closedPromise]]</a> with <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①⓪">[[storedError]]</a>.</p>
       <li data-md>
        <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise⑧">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamStartErroring">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamStartErroring" id="writable-stream-start-erroring">WritableStreamStartErroring(<var>stream</var>, <var>reason</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①①">[[storedError]]</a> is undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⓪">[[state]]</a> is "<code>writable</code>".</p>
     <li data-md>
      <p>Let <var>controller</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller⑤">[[controller]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var> is not undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②①">[[state]]</a> to "<code>erroring</code>".</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①②">[[storedError]]</a> to <var>reason</var>.</p>
     <li data-md>
      <p>Let <var>writer</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer⑦">[[writer]]</a>.</p>
     <li data-md>
      <p>If <var>writer</var> is not undefined, perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-ensure-ready-promise-rejected" id="ref-for-writable-stream-default-writer-ensure-ready-promise-rejected">WritableStreamDefaultWriterEnsureReadyPromiseRejected</a>(<var>writer</var>, <var>reason</var>).</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-has-operation-marked-in-flight" id="ref-for-writable-stream-has-operation-marked-in-flight①">WritableStreamHasOperationMarkedInFlight</a>(<var>stream</var>) is false and <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-started" id="ref-for-writablestreamdefaultcontroller-started">[[started]]</a> is true, perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-erroring" id="ref-for-writable-stream-finish-erroring①">WritableStreamFinishErroring</a>(<var>stream</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamUpdateBackpressure">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamUpdateBackpressure" id="writable-stream-update-backpressure">WritableStreamUpdateBackpressure(<var>stream</var>, <var>backpressure</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②②">[[state]]</a> is "<code>writable</code>".</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight⑦">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is false.</p>
     <li data-md>
      <p>Let <var>writer</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer⑧">[[writer]]</a>.</p>
     <li data-md>
      <p>If <var>writer</var> is not undefined and <var>backpressure</var> is not <var>stream</var>.<a data-link-type="dfn" href="#writablestream-backpressure" id="ref-for-writablestream-backpressure③">[[backpressure]]</a>,</p>
      <ol>
       <li data-md>
        <p>If <var>backpressure</var> is true, set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise⑨">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①②">a new promise</a>.</p>
       <li data-md>
        <p>Otherwise,</p>
        <ol>
         <li data-md>
          <p class="assertion">Assert: <var>backpressure</var> is false.</p>
         <li data-md>
          <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⑧">Resolve</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①⓪">[[readyPromise]]</a> with undefined.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-backpressure" id="ref-for-writablestream-backpressure④">[[backpressure]]</a> to <var>backpressure</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.5.3" id="ws-writer-abstract-ops"><span class="secno">5.5.3. </span><span class="content">Writers</span><a class="self-link" href="#ws-writer-abstract-ops"></a></h4>
   <p>The following abstract operations support the implementation and manipulation of <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter①⓪">WritableStreamDefaultWriter</a></code> instances.</p>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterAbort">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterAbort" id="writable-stream-default-writer-abort">WritableStreamDefaultWriterAbort(<var>writer</var>, <var>reason</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream⑥">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort⑥">WritableStreamAbort</a>(<var>stream</var>, <var>reason</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterClose" id="writable-stream-default-writer-close">WritableStreamDefaultWriterClose(<var>writer</var>)</dfn> performs
 the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream⑦">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-close" id="ref-for-writable-stream-close①">WritableStreamClose</a>(<var>stream</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterCloseWithErrorPropagation">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterCloseWithErrorPropagation" id="writable-stream-default-writer-close-with-error-propagation">WritableStreamDefaultWriterCloseWithErrorPropagation(<var>writer</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream⑧">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②③">[[state]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight⑧">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is true or <var>state</var> is "<code>closed</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⑧">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>errored</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②③">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①③">[[storedError]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is "<code>writable</code>" or "<code>erroring</code>".</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-close" id="ref-for-writable-stream-default-writer-close①">WritableStreamDefaultWriterClose</a>(<var>writer</var>).</p>
    </ol>
    <p class="note" role="note">This abstract operation helps implement the error propagation semantics of <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④③">ReadableStream</a></code>'s <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to⑦">pipeTo()</a></code>. </p>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterEnsureClosedPromiseRejected">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterEnsureClosedPromiseRejected" id="writable-stream-default-writer-ensure-closed-promise-rejected">WritableStreamDefaultWriterEnsureClosedPromiseRejected(<var>writer</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise⑨">[[closedPromise]]</a>.[[PromiseState]] is "<code>pending</code>", <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①④">reject</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise①⓪">[[closedPromise]]</a> with <var>error</var>.</p>
     <li data-md>
      <p>Otherwise, set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise①①">[[closedPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②④">a promise
  rejected with</a> <var>error</var>.</p>
     <li data-md>
      <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-closedpromise" id="ref-for-writablestreamdefaultwriter-closedpromise①②">[[closedPromise]]</a>.[[PromiseIsHandled]] to true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterEnsureReadyPromiseRejected">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterEnsureReadyPromiseRejected" id="writable-stream-default-writer-ensure-ready-promise-rejected">WritableStreamDefaultWriterEnsureReadyPromiseRejected(<var>writer</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①①">[[readyPromise]]</a>.[[PromiseState]] is "<code>pending</code>", <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①⑤">reject</a> <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①②">[[readyPromise]]</a> with <var>error</var>.</p>
     <li data-md>
      <p>Otherwise, set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①③">[[readyPromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑤">a promise rejected
  with</a> <var>error</var>.</p>
     <li data-md>
      <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-readypromise" id="ref-for-writablestreamdefaultwriter-readypromise①④">[[readyPromise]]</a>.[[PromiseIsHandled]] to true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterGetDesiredSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterGetDesiredSize" id="writable-stream-default-writer-get-desired-size">WritableStreamDefaultWriterGetDesiredSize(<var>writer</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream⑨">[[stream]]</a>.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②④">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>errored</code>" or "<code>erroring</code>", return null.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>closed</code>", return 0.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-desired-size" id="ref-for-writable-stream-default-controller-get-desired-size">WritableStreamDefaultControllerGetDesiredSize</a>(<var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller⑥">[[controller]]</a>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterRelease">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterRelease" id="writable-stream-default-writer-release">WritableStreamDefaultWriterRelease(<var>writer</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream①⓪">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer⑨">[[writer]]</a> is <var>writer</var>.</p>
     <li data-md>
      <p>Let <var>releasedError</var> be a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤③">TypeError</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-ensure-ready-promise-rejected" id="ref-for-writable-stream-default-writer-ensure-ready-promise-rejected①">WritableStreamDefaultWriterEnsureReadyPromiseRejected</a>(<var>writer</var>, <var>releasedError</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-ensure-closed-promise-rejected" id="ref-for-writable-stream-default-writer-ensure-closed-promise-rejected">WritableStreamDefaultWriterEnsureClosedPromiseRejected</a>(<var>writer</var>, <var>releasedError</var>).</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-writer" id="ref-for-writablestream-writer①⓪">[[writer]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream①①">[[stream]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultWriterWrite">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultWriterWrite" id="writable-stream-default-writer-write">WritableStreamDefaultWriterWrite(<var>writer</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream①②">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> is not undefined.</p>
     <li data-md>
      <p>Let <var>controller</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller⑦">[[controller]]</a>.</p>
     <li data-md>
      <p>Let <var>chunkSize</var> be ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-chunk-size" id="ref-for-writable-stream-default-controller-get-chunk-size">WritableStreamDefaultControllerGetChunkSize</a>(<var>controller</var>, <var>chunk</var>).</p>
     <li data-md>
      <p>If <var>stream</var> is not equal to <var>writer</var>.<a data-link-type="dfn" href="#writablestreamdefaultwriter-stream" id="ref-for-writablestreamdefaultwriter-stream①③">[[stream]]</a>, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑥">a
  promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤④">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⑤">[[state]]</a>.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>errored</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑦">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①④">[[storedError]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight⑨">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is true or <var>state</var> is "<code>closed</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑧">a promise rejected with</a> a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑤">TypeError</a></code> exception indicating that the stream is closing or
  closed.</p>
     <li data-md>
      <p>If <var>state</var> is "<code>erroring</code>", return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with②⑨">a promise rejected with</a> <var>stream</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①⑤">[[storedError]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is "<code>writable</code>".</p>
     <li data-md>
      <p>Let <var>promise</var> be ! <a data-link-type="abstract-op" href="#writable-stream-add-write-request" id="ref-for-writable-stream-add-write-request">WritableStreamAddWriteRequest</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-write" id="ref-for-writable-stream-default-controller-write">WritableStreamDefaultControllerWrite</a>(<var>controller</var>, <var>chunk</var>, <var>chunkSize</var>).</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="5.5.4" id="ws-default-controller-abstract-ops"><span class="secno">5.5.4. </span><span class="content">Default controllers</span><a class="self-link" href="#ws-default-controller-abstract-ops"></a></h4>
   <p>The following abstract operations support the implementation of the <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①③">WritableStreamDefaultController</a></code> class.</p>
   <div class="algorithm" data-algorithm="SetUpWritableStreamDefaultController">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpWritableStreamDefaultController" id="set-up-writable-stream-default-controller">SetUpWritableStreamDefaultController(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①③">implements</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②⑥">WritableStream</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller⑧">[[controller]]</a> is undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream①">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller⑨">[[controller]]</a> to <var>controller</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#reset-queue" id="ref-for-reset-queue⑦">ResetQueue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-started" id="ref-for-writablestreamdefaultcontroller-started①">[[started]]</a> to false.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-writablestreamdefaultcontroller-strategysizealgorithm">[[strategySizeAlgorithm]]</a> to <var>sizeAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-strategyhwm" id="ref-for-writablestreamdefaultcontroller-strategyhwm">[[strategyHWM]]</a> to <var>highWaterMark</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-writealgorithm" id="ref-for-writablestreamdefaultcontroller-writealgorithm">[[writeAlgorithm]]</a> to <var>writeAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-closealgorithm" id="ref-for-writablestreamdefaultcontroller-closealgorithm">[[closeAlgorithm]]</a> to <var>closeAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-abortalgorithm" id="ref-for-writablestreamdefaultcontroller-abortalgorithm①">[[abortAlgorithm]]</a> to <var>abortAlgorithm</var>.</p>
     <li data-md>
      <p>Let <var>backpressure</var> be ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-backpressure" id="ref-for-writable-stream-default-controller-get-backpressure">WritableStreamDefaultControllerGetBackpressure</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-update-backpressure" id="ref-for-writable-stream-update-backpressure">WritableStreamUpdateBackpressure</a>(<var>stream</var>, <var>backpressure</var>).</p>
     <li data-md>
      <p>Let <var>startResult</var> be the result of performing <var>startAlgorithm</var>. (This may throw an exception.)</p>
     <li data-md>
      <p>Let <var>startPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with①⑨">a promise resolved with</a> <var>startResult</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment⑥">Upon fulfillment</a> of <var>startPromise</var>,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⑥">[[state]]</a> is "<code>writable</code>" or "<code>erroring</code>".</p>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-started" id="ref-for-writablestreamdefaultcontroller-started②">[[started]]</a> to true.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-advance-queue-if-needed" id="ref-for-writable-stream-default-controller-advance-queue-if-needed">WritableStreamDefaultControllerAdvanceQueueIfNeeded</a>(<var>controller</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection⑦">Upon rejection</a> of <var>startPromise</var> with reason <var>r</var>,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⑦">[[state]]</a> is "<code>writable</code>" or "<code>erroring</code>".</p>
       <li data-md>
        <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-started" id="ref-for-writablestreamdefaultcontroller-started③">[[started]]</a> to true.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-deal-with-rejection" id="ref-for-writable-stream-deal-with-rejection①">WritableStreamDealWithRejection</a>(<var>stream</var>, <var>r</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpWritableStreamDefaultControllerFromUnderlyingSink">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpWritableStreamDefaultControllerFromUnderlyingSink" id="set-up-writable-stream-default-controller-from-underlying-sink">SetUpWritableStreamDefaultControllerFromUnderlyingSink(<var>stream</var>, <var>underlyingSink</var>, <var>underlyingSinkDict</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⑥">new</a> <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①④">WritableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>writeAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⓪">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>Let <var>closeAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②①">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>Let <var>abortAlgorithm</var> be an algorithm that returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②②">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-start" id="ref-for-dom-underlyingsink-start③">start</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①③">exists</a>, then set <var>startAlgorithm</var> to
  an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function⑧">invoking</a> <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-start" id="ref-for-dom-underlyingsink-start④">start</a></code>"] with argument list « <var>controller</var> »
  and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value⑥">callback this value</a> <var>underlyingSink</var>.</p>
     <li data-md>
      <p>If <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write④">write</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①④">exists</a>, then set <var>writeAlgorithm</var> to
  an algorithm which takes an argument <var>chunk</var> and returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function⑨">invoking</a> <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write⑤">write</a></code>"] with argument list « <var>chunk</var>, <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value⑦">callback this value</a> <var>underlyingSink</var>.</p>
     <li data-md>
      <p>If <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-close" id="ref-for-dom-underlyingsink-close③">close</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑤">exists</a>, then set <var>closeAlgorithm</var> to
  an algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①⓪">invoking</a> <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-close" id="ref-for-dom-underlyingsink-close④">close</a></code>"] with argument list «» and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value⑧">callback this
  value</a> <var>underlyingSink</var>.</p>
     <li data-md>
      <p>If <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-abort" id="ref-for-dom-underlyingsink-abort②">abort</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑥">exists</a>, then set <var>abortAlgorithm</var> to
  an algorithm which takes an argument <var>reason</var> and returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①①">invoking</a> <var>underlyingSinkDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-abort" id="ref-for-dom-underlyingsink-abort③">abort</a></code>"] with argument list « <var>reason</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value⑨">callback this value</a> <var>underlyingSink</var>.</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-writable-stream-default-controller" id="ref-for-set-up-writable-stream-default-controller①">SetUpWritableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerAdvanceQueueIfNeeded">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerAdvanceQueueIfNeeded" id="writable-stream-default-controller-advance-queue-if-needed">WritableStreamDefaultControllerAdvanceQueueIfNeeded(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream②">[[stream]]</a>.</p>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-started" id="ref-for-writablestreamdefaultcontroller-started④">[[started]]</a> is false, return.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-inflightwriterequest" id="ref-for-writablestream-inflightwriterequest①①">[[inFlightWriteRequest]]</a> is not undefined, return.</p>
     <li data-md>
      <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⑧">[[state]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>state</var> is not "<code>closed</code>" or "<code>errored</code>".</p>
     <li data-md>
      <p>If <var>state</var> is "<code>erroring</code>",</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-erroring" id="ref-for-writable-stream-finish-erroring②">WritableStreamFinishErroring</a>(<var>stream</var>).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-queue" id="ref-for-writablestreamdefaultcontroller-queue②">[[queue]]</a> is empty, return.</p>
     <li data-md>
      <p>Let <var>value</var> be ! <a data-link-type="abstract-op" href="#peek-queue-value" id="ref-for-peek-queue-value">PeekQueueValue</a>(<var>controller</var>).</p>
     <li data-md>
      <p>If <var>value</var> is the <a data-link-type="dfn" href="#close-sentinel" id="ref-for-close-sentinel">close sentinel</a>, perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-process-close" id="ref-for-writable-stream-default-controller-process-close">WritableStreamDefaultControllerProcessClose</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Otherwise, perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-process-write" id="ref-for-writable-stream-default-controller-process-write">WritableStreamDefaultControllerProcessWrite</a>(<var>controller</var>, <var>value</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerClearAlgorithms">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerClearAlgorithms" id="writable-stream-default-controller-clear-algorithms">WritableStreamDefaultControllerClearAlgorithms(<var>controller</var>)</dfn> is called once the stream is closed or errored and the algorithms will not be executed any more. By
 removing the algorithm references it permits the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink②⑨">underlying sink</a> object to be garbage
 collected even if the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②⑦">WritableStream</a></code> itself is still referenced. 
    <p class="note" role="note">This is observable using <a href="https://github.com/tc39/proposal-weakrefs/">weak
 references</a>. See <a href="https://github.com/tc39/proposal-weakrefs/issues/31">tc39/proposal-weakrefs#31</a> for more
 detail. </p>
    <p>It performs the following steps:</p>
    <ol>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-writealgorithm" id="ref-for-writablestreamdefaultcontroller-writealgorithm①">[[writeAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-closealgorithm" id="ref-for-writablestreamdefaultcontroller-closealgorithm①">[[closeAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-abortalgorithm" id="ref-for-writablestreamdefaultcontroller-abortalgorithm②">[[abortAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-writablestreamdefaultcontroller-strategysizealgorithm①">[[strategySizeAlgorithm]]</a> to undefined.</p>
    </ol>
    <p class="note" role="note">This algorithm will be performed multiple times in some edge cases. After the first
 time it will do nothing. </p>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerClose" id="writable-stream-default-controller-close">WritableStreamDefaultControllerClose(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#enqueue-value-with-size" id="ref-for-enqueue-value-with-size①">EnqueueValueWithSize</a>(<var>controller</var>, <a data-link-type="dfn" href="#close-sentinel" id="ref-for-close-sentinel①">close sentinel</a>, 0).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-advance-queue-if-needed" id="ref-for-writable-stream-default-controller-advance-queue-if-needed①">WritableStreamDefaultControllerAdvanceQueueIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerError" id="writable-stream-default-controller-error">WritableStreamDefaultControllerError(<var>controller</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream③">[[stream]]</a>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state②⑨">[[state]]</a> is "<code>writable</code>".</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-clear-algorithms" id="ref-for-writable-stream-default-controller-clear-algorithms①">WritableStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-start-erroring" id="ref-for-writable-stream-start-erroring②">WritableStreamStartErroring</a>(<var>stream</var>, <var>error</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerErrorIfNeeded">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerErrorIfNeeded" id="writable-stream-default-controller-error-if-needed">WritableStreamDefaultControllerErrorIfNeeded(<var>controller</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream④">[[stream]]</a>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③⓪">[[state]]</a> is
  "<code>writable</code>", perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error" id="ref-for-writable-stream-default-controller-error①">WritableStreamDefaultControllerError</a>(<var>controller</var>, <var>error</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerGetBackpressure">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerGetBackpressure" id="writable-stream-default-controller-get-backpressure">WritableStreamDefaultControllerGetBackpressure(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>desiredSize</var> be ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-desired-size" id="ref-for-writable-stream-default-controller-get-desired-size①">WritableStreamDefaultControllerGetDesiredSize</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Return true if <var>desiredSize</var> ≤ 0, or false otherwise.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerGetChunkSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerGetChunkSize" id="writable-stream-default-controller-get-chunk-size">WritableStreamDefaultControllerGetChunkSize(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>returnValue</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-strategysizealgorithm" id="ref-for-writablestreamdefaultcontroller-strategysizealgorithm②">[[strategySizeAlgorithm]]</a>, passing in <var>chunk</var>,
  and interpreting the result as a <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-completion-record-specification-type" id="ref-for-sec-completion-record-specification-type②">completion record</a>.</p>
     <li data-md>
      <p>If <var>returnValue</var> is an abrupt completion,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error-if-needed" id="ref-for-writable-stream-default-controller-error-if-needed">WritableStreamDefaultControllerErrorIfNeeded</a>(<var>controller</var>, <var>returnValue</var>.[[Value]]).</p>
       <li data-md>
        <p>Return 1.</p>
      </ol>
     <li data-md>
      <p>Return <var>returnValue</var>.[[Value]].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerGetDesiredSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerGetDesiredSize" id="writable-stream-default-controller-get-desired-size">WritableStreamDefaultControllerGetDesiredSize(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Return <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-strategyhwm" id="ref-for-writablestreamdefaultcontroller-strategyhwm①">[[strategyHWM]]</a> − <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-queuetotalsize" id="ref-for-writablestreamdefaultcontroller-queuetotalsize">[[queueTotalSize]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerProcessClose">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerProcessClose" id="writable-stream-default-controller-process-close">WritableStreamDefaultControllerProcessClose(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream⑤">[[stream]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-mark-close-request-in-flight" id="ref-for-writable-stream-mark-close-request-in-flight">WritableStreamMarkCloseRequestInFlight</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#dequeue-value" id="ref-for-dequeue-value①">DequeueValue</a>(<var>controller</var>).</p>
     <li data-md>
      <p class="assertion">Assert: <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-queue" id="ref-for-writablestreamdefaultcontroller-queue③">[[queue]]</a> is empty.</p>
     <li data-md>
      <p>Let <var>sinkClosePromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-closealgorithm" id="ref-for-writablestreamdefaultcontroller-closealgorithm②">[[closeAlgorithm]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-clear-algorithms" id="ref-for-writable-stream-default-controller-clear-algorithms②">WritableStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment⑦">Upon fulfillment</a> of <var>sinkClosePromise</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-in-flight-close" id="ref-for-writable-stream-finish-in-flight-close">WritableStreamFinishInFlightClose</a>(<var>stream</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection⑧">Upon rejection</a> of <var>sinkClosePromise</var> with reason <var>reason</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-in-flight-close-with-error" id="ref-for-writable-stream-finish-in-flight-close-with-error">WritableStreamFinishInFlightCloseWithError</a>(<var>stream</var>, <var>reason</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerProcessWrite">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerProcessWrite" id="writable-stream-default-controller-process-write">WritableStreamDefaultControllerProcessWrite(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream⑥">[[stream]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-mark-first-write-request-in-flight" id="ref-for-writable-stream-mark-first-write-request-in-flight">WritableStreamMarkFirstWriteRequestInFlight</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>sinkWritePromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-writealgorithm" id="ref-for-writablestreamdefaultcontroller-writealgorithm②">[[writeAlgorithm]]</a>, passing in <var>chunk</var>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-fulfillment" id="ref-for-upon-fulfillment⑧">Upon fulfillment</a> of <var>sinkWritePromise</var>,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-in-flight-write" id="ref-for-writable-stream-finish-in-flight-write">WritableStreamFinishInFlightWrite</a>(<var>stream</var>).</p>
       <li data-md>
        <p>Let <var>state</var> be <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③①">[[state]]</a>.</p>
       <li data-md>
        <p class="assertion">Assert: <var>state</var> is "<code>writable</code>" or "<code>erroring</code>".</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#dequeue-value" id="ref-for-dequeue-value②">DequeueValue</a>(<var>controller</var>).</p>
       <li data-md>
        <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight①⓪">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is false and <var>state</var> is "<code>writable</code>",</p>
        <ol>
         <li data-md>
          <p>Let <var>backpressure</var> be ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-backpressure" id="ref-for-writable-stream-default-controller-get-backpressure①">WritableStreamDefaultControllerGetBackpressure</a>(<var>controller</var>).</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-update-backpressure" id="ref-for-writable-stream-update-backpressure①">WritableStreamUpdateBackpressure</a>(<var>stream</var>, <var>backpressure</var>).</p>
        </ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-advance-queue-if-needed" id="ref-for-writable-stream-default-controller-advance-queue-if-needed②">WritableStreamDefaultControllerAdvanceQueueIfNeeded</a>(<var>controller</var>).</p>
      </ol>
     <li data-md>
      <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#upon-rejection" id="ref-for-upon-rejection⑨">Upon rejection</a> of <var>sinkWritePromise</var> with <var>reason</var>,</p>
      <ol>
       <li data-md>
        <p>If <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③②">[[state]]</a> is "<code>writable</code>", perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-clear-algorithms" id="ref-for-writable-stream-default-controller-clear-algorithms③">WritableStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-finish-in-flight-write-with-error" id="ref-for-writable-stream-finish-in-flight-write-with-error">WritableStreamFinishInFlightWriteWithError</a>(<var>stream</var>, <var>reason</var>).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="WritableStreamDefaultControllerWrite">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="WritableStreamDefaultControllerWrite" id="writable-stream-default-controller-write">WritableStreamDefaultControllerWrite(<var>controller</var>, <var>chunk</var>, <var>chunkSize</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>enqueueResult</var> be <a data-link-type="abstract-op" href="#enqueue-value-with-size" id="ref-for-enqueue-value-with-size②">EnqueueValueWithSize</a>(<var>controller</var>, <var>chunk</var>, <var>chunkSize</var>).</p>
     <li data-md>
      <p>If <var>enqueueResult</var> is an abrupt completion,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error-if-needed" id="ref-for-writable-stream-default-controller-error-if-needed①">WritableStreamDefaultControllerErrorIfNeeded</a>(<var>controller</var>, <var>enqueueResult</var>.[[Value]]).</p>
       <li data-md>
        <p>Return.</p>
      </ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#writablestreamdefaultcontroller-stream" id="ref-for-writablestreamdefaultcontroller-stream⑦">[[stream]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#writable-stream-close-queued-or-in-flight" id="ref-for-writable-stream-close-queued-or-in-flight①①">WritableStreamCloseQueuedOrInFlight</a>(<var>stream</var>) is false and <var>stream</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③③">[[state]]</a> is "<code>writable</code>",</p>
      <ol>
       <li data-md>
        <p>Let <var>backpressure</var> be ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-get-backpressure" id="ref-for-writable-stream-default-controller-get-backpressure②">WritableStreamDefaultControllerGetBackpressure</a>(<var>controller</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-update-backpressure" id="ref-for-writable-stream-update-backpressure②">WritableStreamUpdateBackpressure</a>(<var>stream</var>, <var>backpressure</var>).</p>
      </ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-advance-queue-if-needed" id="ref-for-writable-stream-default-controller-advance-queue-if-needed③">WritableStreamDefaultControllerAdvanceQueueIfNeeded</a>(<var>controller</var>).</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="6" id="ts"><span class="secno">6. </span><span class="content">Transform streams</span><a class="self-link" href="#ts"></a></h2>
   <h3 class="heading settled" data-level="6.1" id="ts-intro"><span class="secno">6.1. </span><span class="content">Using transform streams</span><a class="self-link" href="#ts-intro"></a></h3>
   <div class="example" id="example-basic-pipe-through">
    <a class="self-link" href="#example-basic-pipe-through"></a> The natural way to use a transform stream is to place it in a <a data-link-type="dfn" href="#piping" id="ref-for-piping①⓪">pipe</a> between a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①④">readable
 stream</a> and a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream⑧">writable stream</a>. <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥②">Chunks</a> that travel from the <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⑤">readable stream</a> to the <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream⑨">writable stream</a> will be transformed as they pass through the transform stream. <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①④">Backpressure</a> is respected, so data will not be read faster than it can be transformed and
 consumed. 
<pre class="highlight">readableStream
  <c- p>.</c->pipeThrough<c- p>(</c->transformStream<c- p>)</c->
  <c- p>.</c->pipeTo<c- p>(</c->writableStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully transformed!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
   </div>
   <div class="example" id="example-transform-stream-properties">
    <a class="self-link" href="#example-transform-stream-properties"></a> You can also use the <code class="idl"><a data-link-type="idl" href="#ts-readable" id="ref-for-ts-readable">readable</a></code> and <code class="idl"><a data-link-type="idl" href="#ts-writable" id="ref-for-ts-writable">writable</a></code> properties of a
 transform stream directly to access the usual interfaces of a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⑥">readable stream</a> and <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①⓪">writable
 stream</a>. In this example we supply data to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①">writable side</a> of the stream using its <a data-link-type="dfn" href="#writer" id="ref-for-writer⑤">writer</a> interface. The <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①">readable side</a> is then piped to <code>anotherWritableStream</code>. 
<pre class="highlight"><c- a>const</c-> writer <c- o>=</c-> transformStream<c- p>.</c->writable<c- p>.</c->getWriter<c- p>();</c->
writer<c- p>.</c->write<c- p>(</c-><c- u>"input chunk"</c-><c- p>);</c->
transformStream<c- p>.</c->readable<c- p>.</c->pipeTo<c- p>(</c->anotherWritableStream<c- p>);</c->
</pre>
   </div>
   <div class="example" id="example-transform-identity">
    <a class="self-link" href="#example-transform-identity"></a> One use of <a data-link-type="dfn" href="#identity-transform-stream" id="ref-for-identity-transform-stream">identity transform streams</a> is to easily convert between readable and writable
 streams. For example, the <code class="idl"><a data-link-type="idl" href="https://fetch.spec.whatwg.org/#dom-global-fetch" id="ref-for-dom-global-fetch">fetch()</a></code> API accepts a readable stream <a data-link-type="dfn" href="https://fetch.spec.whatwg.org/#concept-request-body" id="ref-for-concept-request-body">request body</a>,
 but it can be more convenient to write data for uploading via a writable stream interface. Using
 an identity transform stream addresses this: 
<pre class="highlight"><c- a>const</c-> <c- p>{</c-> writable<c- p>,</c-> readable <c- p>}</c-> <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>();</c->
fetch<c- p>(</c-><c- u>"..."</c-><c- p>,</c-> <c- p>{</c-> body<c- o>:</c-> readable <c- p>}).</c->then<c- p>(</c->response <c- p>=></c-> <c- d>/* ... */</c-><c- p>);</c->

<c- a>const</c-> writer <c- o>=</c-> writable<c- p>.</c->getWriter<c- p>();</c->
writer<c- p>.</c->write<c- p>(</c-><c- ow>new</c-> Uint8Array<c- p>([</c-><c- mh>0x73</c-><c- p>,</c-> <c- mh>0x74</c-><c- p>,</c-> <c- mh>0x72</c-><c- p>,</c-> <c- mh>0x65</c-><c- p>,</c-> <c- mh>0x61</c-><c- p>,</c-> <c- mh>0x6D</c-><c- p>,</c-> <c- mh>0x73</c-><c- p>,</c-> <c- mh>0x21</c-><c- p>]));</c->
writer<c- p>.</c->close<c- p>();</c->
</pre>
    <p>Another use of identity transform streams is to add additional buffering to a <a data-link-type="dfn" href="#readablestream-pipe" id="ref-for-readablestream-pipe①">pipe</a>. In this
 example we add extra buffering between <code>readableStream</code> and <code>writableStream</code>.</p>
<pre class="highlight"><c- a>const</c-> writableStrategy <c- o>=</c-> <c- ow>new</c-> ByteLengthQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>1024</c-> <c- o>*</c-> <c- mf>1024</c-> <c- p>});</c->

readableStream
  <c- p>.</c->pipeThrough<c- p>(</c-><c- ow>new</c-> TransformStream<c- p>(</c-><c- kc>undefined</c-><c- p>,</c-> writableStrategy<c- p>))</c->
  <c- p>.</c->pipeTo<c- p>(</c->writableStream<c- p>);</c->
</pre>
   </div>
   <h3 class="heading settled" data-level="6.2" id="ts-class"><span class="secno">6.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③">TransformStream</a></code> class</span><a class="self-link" href="#ts-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="less-than-two-engines-flag" title="This feature is in less than two current engines.">⚠</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/TransformStream" title="The TransformStream interface of the Streams API represents a set of transformable data.">TransformStream</a></p>
     <p class="less-than-two-engines-text">In only one current engine.</p>
     <div class="support">
      <span class="firefox no"><span>Firefox</span><span>None</span></span><span class="safari no"><span>Safari</span><span>None</span></span><span class="chrome yes"><span>Chrome</span><span>67+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>54+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge no"><span>Edge (Legacy)</span><span>None</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android no"><span>Firefox for Android</span><span>None</span></span><span class="safari_ios no"><span>iOS Safari</span><span>None</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>67+</span></span><span class="webview_android yes"><span>Android WebView</span><span>67+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>9.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>48+</span></span>
     </div>
    </div>
   </div>
   <p>The <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream④">TransformStream</a></code> class is a concrete instance of the general <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream②">transform stream</a> concept.</p>
   <h4 class="heading settled" data-level="6.2.1" id="ts-class-definition"><span class="secno">6.2.1. </span><span class="content">Interface definition</span><a class="self-link" href="#ts-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream⑤">TransformStream</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed⑨"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable" id="ref-for-transferable②"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="transformstream"><code><c- g>TransformStream</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#ts-constructor" id="ref-for-ts-constructor①"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object" id="ref-for-idl-object②"><c- b>object</c-></a> <dfn class="idl-code" data-dfn-for="TransformStream/TransformStream(transformer, writableStrategy, readableStrategy), TransformStream/constructor(transformer, writableStrategy, readableStrategy), TransformStream/TransformStream(transformer, writableStrategy), TransformStream/constructor(transformer, writableStrategy), TransformStream/TransformStream(transformer), TransformStream/constructor(transformer), TransformStream/TransformStream(), TransformStream/constructor()" data-dfn-type="argument" data-export id="dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-transformer"><code><c- g>transformer</c-></code><a class="self-link" href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-transformer"></a></dfn>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy" id="ref-for-dictdef-queuingstrategy②"><c- n>QueuingStrategy</c-></a> <dfn class="idl-code" data-dfn-for="TransformStream/TransformStream(transformer, writableStrategy, readableStrategy), TransformStream/constructor(transformer, writableStrategy, readableStrategy), TransformStream/TransformStream(transformer, writableStrategy), TransformStream/constructor(transformer, writableStrategy), TransformStream/TransformStream(transformer), TransformStream/constructor(transformer), TransformStream/TransformStream(), TransformStream/constructor()" data-dfn-type="argument" data-export id="dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-writablestrategy"><code><c- g>writableStrategy</c-></code><a class="self-link" href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-writablestrategy"></a></dfn> = {},
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy" id="ref-for-dictdef-queuingstrategy③"><c- n>QueuingStrategy</c-></a> <dfn class="idl-code" data-dfn-for="TransformStream/TransformStream(transformer, writableStrategy, readableStrategy), TransformStream/constructor(transformer, writableStrategy, readableStrategy), TransformStream/TransformStream(transformer, writableStrategy), TransformStream/constructor(transformer, writableStrategy), TransformStream/TransformStream(transformer), TransformStream/constructor(transformer), TransformStream/TransformStream(), TransformStream/constructor()" data-dfn-type="argument" data-export id="dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-readablestrategy"><code><c- g>readableStrategy</c-></code><a class="self-link" href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-readablestrategy"></a></dfn> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream④④"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#ts-readable" id="ref-for-ts-readable①"><c- g>readable</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#writablestream" id="ref-for-writablestream②⑧"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#ts-writable" id="ref-for-ts-writable①"><c- g>writable</c-></a>;
};
</pre>
   <h4 class="heading settled" data-level="6.2.2" id="ts-internal-slots"><span class="secno">6.2.2. </span><span class="content">Internal slots</span><a class="self-link" href="#ts-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream⑥">TransformStream</a></code> are created with the internal slots described in the following
table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-noexport id="transformstream-backpressure">[[backpressure]]</dfn> 
      <td class="non-normative">Whether there was backpressure on <a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable">[[readable]]</a> the
   last time it was observed 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-noexport id="transformstream-backpressurechangepromise">[[backpressureChangePromise]]</dfn> 
      <td class="non-normative">A promise which is fulfilled and replaced every time the value of <a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure">[[backpressure]]</a> changes 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-noexport id="transformstream-controller">[[controller]]</dfn> 
      <td class="non-normative">A <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller">TransformStreamDefaultController</a></code> created with the ability to
   control <a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable①">[[readable]]</a> and <a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable">[[writable]]</a> 
     <tr>
      <td><dfn data-dfn-for="TransformStream" data-dfn-type="dfn" data-export id="transformstream-detached">[[Detached]]<a class="self-link" href="#transformstream-detached"></a></dfn> 
      <td class="non-normative">A boolean flag set to true when the stream is transferred 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-noexport id="transformstream-readable">[[readable]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⑤">ReadableStream</a></code> instance controlled by this object 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-noexport id="transformstream-writable">[[writable]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream②⑨">WritableStream</a></code> instance controlled by this object 
   </table>
   <h4 class="heading settled" data-level="6.2.3" id="transformer-api"><span class="secno">6.2.3. </span><span class="content">The transformer API</span><a class="self-link" href="#transformer-api"></a></h4>
   <p>The <code class="idl"><a data-link-type="idl" href="#ts-constructor" id="ref-for-ts-constructor②">TransformStream()</a></code> constructor accepts as its first argument a JavaScript object representing
the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer①">transformer</a>. Such objects can contain any of the following methods:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-transformer"><code><c- g>Transformer</c-></code></dfn> {
  <a data-link-type="idl-name" href="#callbackdef-transformerstartcallback" id="ref-for-callbackdef-transformerstartcallback"><c- n>TransformerStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerStartCallback " href="#dom-transformer-start" id="ref-for-dom-transformer-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-transformertransformcallback" id="ref-for-callbackdef-transformertransformcallback"><c- n>TransformerTransformCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerTransformCallback " href="#dom-transformer-transform" id="ref-for-dom-transformer-transform①"><c- g>transform</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-transformerflushcallback" id="ref-for-callbackdef-transformerflushcallback"><c- n>TransformerFlushCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerFlushCallback " href="#dom-transformer-flush" id="ref-for-dom-transformer-flush"><c- g>flush</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⑧"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-transformer-readabletype" id="ref-for-dom-transformer-readabletype"><c- g>readableType</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any①⑨"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-transformer-writabletype" id="ref-for-dom-transformer-writabletype"><c- g>writableType</c-></a>;
};

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-transformerstartcallback"><code><c- g>TransformerStartCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②⓪"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller①"><c- n>TransformStreamDefaultController</c-></a> <dfn class="idl-code" data-dfn-for="TransformerStartCallback" data-dfn-type="argument" data-export id="dom-transformerstartcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-transformerstartcallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-transformerflushcallback"><code><c- g>TransformerFlushCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⑧"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⑧"><c- b>undefined</c-></a>> (<a data-link-type="idl-name" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller②"><c- n>TransformStreamDefaultController</c-></a> <dfn class="idl-code" data-dfn-for="TransformerFlushCallback" data-dfn-type="argument" data-export id="dom-transformerflushcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-transformerflushcallback-controller"></a></dfn>);
<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-transformertransformcallback"><code><c- g>TransformerTransformCallback</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise①⑨"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined②⑨"><c- b>undefined</c-></a>> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②①"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="TransformerTransformCallback" data-dfn-type="argument" data-export id="dom-transformertransformcallback-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-transformertransformcallback-chunk"></a></dfn>, <a data-link-type="idl-name" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller③"><c- n>TransformStreamDefaultController</c-></a> <dfn class="idl-code" data-dfn-for="TransformerTransformCallback" data-dfn-type="argument" data-export id="dom-transformertransformcallback-controller"><code><c- g>controller</c-></code><a class="self-link" href="#dom-transformertransformcallback-controller"></a></dfn>);
</pre>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Transformer" data-dfn-type="dict-member" data-export data-lt="start" id="dom-transformer-start"><code>start(<var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-transformerstartcallback" id="ref-for-callbackdef-transformerstartcallback①">TransformerStartCallback</a></span>
    <dd>
     <p>A function that is called immediately during creation of the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream⑦">TransformStream</a></code>. </p>
     <p>Typically this is used to enqueue prefix <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥③">chunks</a>, using <code class="idl"><a data-link-type="idl" href="#ts-default-controller-enqueue" id="ref-for-ts-default-controller-enqueue">controller.enqueue()</a></code>. Those chunks will be read
   from the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side②">readable side</a> but don’t depend on any writes to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side②">writable side</a>. </p>
     <p>If this initial process is asynchronous, for example because it takes some effort to acquire
   the prefix chunks, the function can return a promise to signal success or failure; a rejected
   promise will error the stream. Any thrown exceptions will be re-thrown by the <code class="idl"><a data-link-type="idl" href="#ts-constructor" id="ref-for-ts-constructor③">TransformStream()</a></code> constructor. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Transformer" data-dfn-type="dict-member" data-export data-lt="transform" id="dom-transformer-transform"><code>transform(<var>chunk</var>, <var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-transformertransformcallback" id="ref-for-callbackdef-transformertransformcallback①">TransformerTransformCallback</a></span>
    <dd>
     <p>A function called when a new <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥④">chunk</a> originally written to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side③">writable side</a> is ready to
  be transformed. The stream implementation guarantees that this function will be called only after
  previous transforms have succeeded, and never before <code class="idl"><a data-link-type="idl" href="#dom-transformer-start" id="ref-for-dom-transformer-start①">start()</a></code> has completed
  or after <code class="idl"><a data-link-type="idl" href="#dom-transformer-flush" id="ref-for-dom-transformer-flush①">flush()</a></code> has been called. </p>
     <p>This function performs the actual transformation work of the transform stream. It can enqueue
  the results using <code class="idl"><a data-link-type="idl" href="#ts-default-controller-enqueue" id="ref-for-ts-default-controller-enqueue①">controller.enqueue()</a></code>. This
  permits a single chunk written to the writable side to result in zero or multiple chunks on the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side③">readable side</a>, depending on how many times <code class="idl"><a data-link-type="idl" href="#ts-default-controller-enqueue" id="ref-for-ts-default-controller-enqueue②">controller.enqueue()</a></code> is called. <a href="#example-ts-lipfuzz">§ 10.9 A transform stream that replaces template tags</a> demonstrates this by sometimes enqueuing zero chunks. </p>
     <p>If the process of transforming is asynchronous, this function can return a promise to signal
  success or failure of the transformation. A rejected promise will error both the readable and
  writable sides of the transform stream. </p>
     <p>If no <code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform②">transform()</a></code> method is supplied, the identity transform is
  used, which enqueues chunks unchanged from the writable side to the readable side. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Transformer" data-dfn-type="dict-member" data-export data-lt="flush" id="dom-transformer-flush"><code>flush(<var>controller</var>)</code></dfn>, <span> of type <a data-link-type="idl-name" href="#callbackdef-transformerflushcallback" id="ref-for-callbackdef-transformerflushcallback①">TransformerFlushCallback</a></span>
    <dd>
     <p>A function called after all <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⑤">chunks</a> written to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side④">writable side</a> have been transformed
   by successfully passing through <code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform③">transform()</a></code>, and the writable side is
   about to be closed. </p>
     <p>Typically this is used to enqueue suffix chunks to the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side④">readable side</a>, before that too
   becomes closed. An example can be seen in <a href="#example-ts-lipfuzz">§ 10.9 A transform stream that replaces template tags</a>. </p>
     <p>If the flushing process is asynchronous, the function can return a promise to signal success
   or failure; the result will be communicated to the caller of <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write①③">stream.writable.write()</a></code>. Additionally, a rejected
   promise will error both the readable and writable sides of the stream. Throwing an exception is
   treated the same as returning a rejected promise. </p>
     <p>(Note that there is no need to call <code class="idl"><a data-link-type="idl" href="#ts-default-controller-terminate" id="ref-for-ts-default-controller-terminate">controller.terminate()</a></code> inside <code class="idl"><a data-link-type="idl" href="#dom-transformer-flush" id="ref-for-dom-transformer-flush②">flush()</a></code>; the stream is already in the process of successfully closing down,
   and terminating it would be counterproductive.) </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Transformer" data-dfn-type="dict-member" data-export id="dom-transformer-readabletype"><code>readableType</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②②">any</a></span>
    <dd>
     <p>This property is reserved for future use, so any attempts to supply a value will throw an
  exception. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="Transformer" data-dfn-type="dict-member" data-export id="dom-transformer-writabletype"><code>writableType</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②③">any</a></span>
    <dd>
     <p>This property is reserved for future use, so any attempts to supply a value will throw an
  exception. </p>
   </dl>
   <p>The <code>controller</code> object passed to <code class="idl"><a data-link-type="idl" href="#dom-transformer-start" id="ref-for-dom-transformer-start②">start()</a></code>, <code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform④">transform()</a></code>, and <code class="idl"><a data-link-type="idl" href="#dom-transformer-flush" id="ref-for-dom-transformer-flush③">flush()</a></code> is an instance of <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller④">TransformStreamDefaultController</a></code>, and has the ability to enqueue <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⑥">chunks</a> to the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side⑤">readable
side</a>, or to terminate or error the stream.</p>
   <h4 class="heading settled" data-level="6.2.4" id="ts-prototype"><span class="secno">6.2.4. </span><span class="content">Constructor and properties</span><a class="self-link" href="#ts-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>stream</var> = new <code class="idl"><a data-link-type="idl" href="#ts-constructor" id="ref-for-ts-constructor④">TransformStream</a></code>([<var>transformer</var>[, <var>writableStrategy</var>[, <var>readableStrategy</var>]]])</code> 
    <dd>
     <p>Creates a new <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream⑧">TransformStream</a></code> wrapping the provided <a data-link-type="dfn" href="#transformer" id="ref-for-transformer②">transformer</a>. See <a href="#transformer-api">§ 6.2.3 The transformer API</a> for more details on the <var>transformer</var> argument. </p>
     <p>If no <var>transformer</var> argument is supplied, then the result will be an <a data-link-type="dfn" href="#identity-transform-stream" id="ref-for-identity-transform-stream①">identity
  transform stream</a>. See <a href="#example-transform-identity">this example</a> for some cases
  where that can be useful. </p>
     <p>The <var>writableStrategy</var> and <var>readableStrategy</var> arguments are
  the <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy⑦">queuing strategy</a> objects for the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side⑤">writable</a> and <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side⑥">readable</a> sides respectively. These are used in the construction of the <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⓪">WritableStream</a></code> and <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⑥">ReadableStream</a></code> objects and can be used to add buffering to a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream⑨">TransformStream</a></code>, in
  order to smooth out variations in the speed of the transformation, or to increase the amount of
  buffering in a <a data-link-type="dfn" href="#readablestream-pipe" id="ref-for-readablestream-pipe②">pipe</a>. If they are not provided, the default behavior will be the same as a <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy③">CountQueuingStrategy</a></code>, with respective <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark⑤">high water marks</a> of 1 and 0. </p>
    <dt><code><var>readable</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ts-readable" id="ref-for-ts-readable②">readable</a></code></code> 
    <dd>
     <p>Returns a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⑦">ReadableStream</a></code> representing the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side⑦">readable side</a> of this transform stream. </p>
    <dt><code><var>writable</var> = <var>stream</var>.<code class="idl"><a data-link-type="idl" href="#ts-writable" id="ref-for-ts-writable②">writable</a></code></code> 
    <dd>
     <p>Returns a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③①">WritableStream</a></code> representing the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side⑥">writable side</a> of this transform stream. </p>
   </dl>
   <div class="algorithm" data-algorithm="TransformStream(transformer, writableStrategy, readableStrategy)" data-algorithm-for="TransformStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStream" data-dfn-type="constructor" data-export data-lt="TransformStream(transformer, writableStrategy, readableStrategy)|constructor(transformer, writableStrategy, readableStrategy)|TransformStream(transformer, writableStrategy)|constructor(transformer, writableStrategy)|TransformStream(transformer)|constructor(transformer)|TransformStream()|constructor()" id="ts-constructor"><code>new TransformStream(<var>transformer</var>, <var>writableStrategy</var>, <var>readableStrategy</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>If <var>transformer</var> is missing, set it to null.</p>
     <li data-md>
      <p>Let <var>transformerDict</var> be <var>transformer</var>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value" id="ref-for-dfn-convert-ecmascript-to-idl-value②">converted to an IDL value</a> of type <code class="idl"><a data-link-type="idl" href="#dictdef-transformer" id="ref-for-dictdef-transformer">Transformer</a></code>.</p>
      <p class="note" role="note">We cannot declare the <var>transformer</var> argument as having the <code class="idl"><a data-link-type="idl" href="#dictdef-transformer" id="ref-for-dictdef-transformer①">Transformer</a></code> type
  directly, because doing so would lose the reference to the original object. We need to retain
  the object so we can <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①②">invoke</a> the various methods on it. </p>
     <li data-md>
      <p>If <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-readabletype" id="ref-for-dom-transformer-readabletype①">readableType</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑦">exists</a>, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror⑤">RangeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-writabletype" id="ref-for-dom-transformer-writabletype①">writableType</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑧">exists</a>, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror⑥">RangeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>readableHighWaterMark</var> be ? <a data-link-type="abstract-op" href="#validate-and-normalize-high-water-mark" id="ref-for-validate-and-normalize-high-water-mark③">ExtractHighWaterMark</a>(<var>readableStrategy</var>, 0).</p>
     <li data-md>
      <p>Let <var>readableSizeAlgorithm</var> be ! <a data-link-type="abstract-op" href="#make-size-algorithm-from-size-function" id="ref-for-make-size-algorithm-from-size-function②">ExtractSizeAlgorithm</a>(<var>readableStrategy</var>).</p>
     <li data-md>
      <p>Let <var>writableHighWaterMark</var> be ? <a data-link-type="abstract-op" href="#validate-and-normalize-high-water-mark" id="ref-for-validate-and-normalize-high-water-mark④">ExtractHighWaterMark</a>(<var>writableStrategy</var>, 1).</p>
     <li data-md>
      <p>Let <var>writableSizeAlgorithm</var> be ! <a data-link-type="abstract-op" href="#make-size-algorithm-from-size-function" id="ref-for-make-size-algorithm-from-size-function③">ExtractSizeAlgorithm</a>(<var>writableStrategy</var>).</p>
     <li data-md>
      <p>Let <var>startPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①③">a new promise</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-transform-stream" id="ref-for-initialize-transform-stream">InitializeTransformStream</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⓪">this</a>, <var>startPromise</var>, <var>writableHighWaterMark</var>, <var>writableSizeAlgorithm</var>, <var>readableHighWaterMark</var>, <var>readableSizeAlgorithm</var>).</p>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#set-up-transform-stream-default-controller-from-transformer" id="ref-for-set-up-transform-stream-default-controller-from-transformer">SetUpTransformStreamDefaultControllerFromTransformer</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①①">this</a>, <var>transformer</var>, <var>transformerDict</var>).</p>
     <li data-md>
      <p>If <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-start" id="ref-for-dom-transformer-start③">start</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists①⑨">exists</a>, then <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve①⑨">resolve</a> <var>startPromise</var> with the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①③">invoking</a> <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-start" id="ref-for-dom-transformer-start④">start</a></code>"] with argument list
  « <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①②">this</a>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller">[[controller]]</a> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value①⓪">callback this value</a> <var>transformer</var>.</p>
     <li data-md>
      <p>Otherwise, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②⓪">resolve</a> <var>startPromise</var> with undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="readable" data-algorithm-for="TransformStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStream" data-dfn-type="attribute" data-export id="ts-readable"><code>readable</code></dfn> getter steps
 are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①③">this</a>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable②">[[readable]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="writable" data-algorithm-for="TransformStream">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStream" data-dfn-type="attribute" data-export id="ts-writable"><code>writable</code></dfn> getter steps
 are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①④">this</a>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable①">[[writable]]</a>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="6.2.5" id="ts-transfer"><span class="secno">6.2.5. </span><span class="content">Transfer via <code>postMessage()</code></span><a class="self-link" href="#ts-transfer"></a></h4>
   <dl class="domintro">
    <dt><code>destination.postMessage(ts, { transfer: [ts] });</code> 
    <dd>
     <p>Sends a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⓪">TransformStream</a></code> to another frame, window, or worker. </p>
     <p>The transferred stream can be used exactly like the original. Its <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side⑧">readable</a> and <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side⑦">writable sides</a> will become locked and no longer directly usable. </p>
   </dl>
   <div class="algorithm" data-algorithm="TransformStream transfer steps">
     <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①①">TransformStream</a></code> objects are <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects" id="ref-for-transferable-objects③">transferable objects</a>. Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-steps" id="ref-for-transfer-steps②">transfer steps</a>, given <var>value</var> and <var>dataHolder</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>readable</var> be <var>value</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable③">[[readable]]</a>.</p>
     <li data-md>
      <p>Let <var>writable</var> be <var>value</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable②">[[writable]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①①">IsReadableStreamLocked</a>(<var>readable</var>) is true, throw a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror②">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException③">DOMException</a></code>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked⑨">IsWritableStreamLocked</a>(<var>writable</var>) is true, throw a "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror③">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException④">DOMException</a></code>.</p>
     <li data-md>
      <p>Set <var>dataHolder</var>.[[readable]] to ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer②">StructuredSerializeWithTransfer</a>(<var>readable</var>,
  « <var>readable</var> »).</p>
     <li data-md>
      <p>Set <var>dataHolder</var>.[[writable]] to ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer" id="ref-for-structuredserializewithtransfer③">StructuredSerializeWithTransfer</a>(<var>writable</var>,
  « <var>writable</var> »).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStream transfer-receiving steps">
     Their <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-receiving-steps" id="ref-for-transfer-receiving-steps②">transfer-receiving steps</a>, given <var>dataHolder</var> and <var>value</var>, are: 
    <ol>
     <li data-md>
      <p>Let <var>readableRecord</var> be ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer" id="ref-for-structureddeserializewithtransfer②">StructuredDeserializeWithTransfer</a>(<var>dataHolder</var>.[[readable]], <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm⑨">the current Realm</a>).</p>
     <li data-md>
      <p>Let <var>writableRecord</var> be ! <a data-link-type="abstract-op" href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer" id="ref-for-structureddeserializewithtransfer③">StructuredDeserializeWithTransfer</a>(<var>dataHolder</var>.[[writable]], <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①⓪">the current Realm</a>).</p>
     <li data-md>
      <p>Set <var>value</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable④">[[readable]]</a> to <var>readableRecord</var>.[[Deserialized]].</p>
     <li data-md>
      <p>Set <var>value</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable③">[[writable]]</a> to <var>writableRecord</var>.[[Deserialized]].</p>
     <li data-md>
      <p>Set <var>value</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure①">[[backpressure]]</a>, <var>value</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise">[[backpressureChangePromise]]</a>, and <var>value</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller①">[[controller]]</a> to undefined.</p>
    </ol>
    <p class="note" role="note">The <a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure②">[[backpressure]]</a>, <a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise①">[[backpressureChangePromise]]</a>, and <a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller②">[[controller]]</a> slots are
 not used in a transferred <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①②">TransformStream</a></code>.</p>
   </div>
   <h3 class="heading settled" data-level="6.3" id="ts-default-controller-class"><span class="secno">6.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller⑤">TransformStreamDefaultController</a></code> class</span><a class="self-link" href="#ts-default-controller-class"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller⑥">TransformStreamDefaultController</a></code> class has methods that allow manipulation of the
associated <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⑧">ReadableStream</a></code> and <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③②">WritableStream</a></code>. When constructing a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①③">TransformStream</a></code>, the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer③">transformer</a> object is given a corresponding <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller⑦">TransformStreamDefaultController</a></code> instance to
manipulate.</p>
   <h4 class="heading settled" data-level="6.3.1" id="ts-default-controller-class-definition"><span class="secno">6.3.1. </span><span class="content">Interface definition</span><a class="self-link" href="#ts-default-controller-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller⑧">TransformStreamDefaultController</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①⓪"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="transformstreamdefaultcontroller"><code><c- g>TransformStreamDefaultController</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double④"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#ts-default-controller-desired-size" id="ref-for-ts-default-controller-desired-size"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined③⓪"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-enqueue" id="ref-for-ts-default-controller-enqueue③"><c- g>enqueue</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②④"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="TransformStreamDefaultController/enqueue(chunk), TransformStreamDefaultController/enqueue()" data-dfn-type="argument" data-export id="dom-transformstreamdefaultcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-transformstreamdefaultcontroller-enqueue-chunk-chunk"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined③①"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-error" id="ref-for-ts-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②⑤"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="TransformStreamDefaultController/error(reason), TransformStreamDefaultController/error()" data-dfn-type="argument" data-export id="dom-transformstreamdefaultcontroller-error-reason-reason"><code><c- g>reason</c-></code><a class="self-link" href="#dom-transformstreamdefaultcontroller-error-reason-reason"></a></dfn>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined" id="ref-for-idl-undefined③②"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-terminate" id="ref-for-ts-default-controller-terminate①"><c- g>terminate</c-></a>();
};
</pre>
   <h4 class="heading settled" data-level="6.3.2" id="ts-default-controller-internal-slots"><span class="secno">6.3.2. </span><span class="content">Internal slots</span><a class="self-link" href="#ts-default-controller-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller⑨">TransformStreamDefaultController</a></code> are created with the internal slots described in
the following table:</p>
   <table>
    <thead>
     <tr>
      <th>Internal Slot
      <th>Description (<em>non-normative</em>)
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStreamDefaultController" data-dfn-type="dfn" data-noexport id="transformstreamdefaultcontroller-flushalgorithm">[[flushAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm which communicates a requested close to
   the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer④">transformer</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStreamDefaultController" data-dfn-type="dfn" data-noexport id="transformstreamdefaultcontroller-stream">[[stream]]</dfn> 
      <td class="non-normative">The <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①④">TransformStream</a></code> instance controlled 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-for="TransformStreamDefaultController" data-dfn-type="dfn" data-noexport id="transformstreamdefaultcontroller-transformalgorithm">[[transformAlgorithm]]</dfn> 
      <td class="non-normative">A promise-returning algorithm, taking one argument (the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⑦">chunk</a> to
   transform), which requests the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer⑤">transformer</a> perform its transformation 
   </table>
   <h4 class="heading settled" data-level="6.3.3" id="ts-default-controller-prototype"><span class="secno">6.3.3. </span><span class="content">Methods and properties</span><a class="self-link" href="#ts-default-controller-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>desiredSize</var> = <var>controller</var>.<code class="idl"><a data-link-type="idl" href="#ts-default-controller-desired-size" id="ref-for-ts-default-controller-desired-size①">desiredSize</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#desired-size-to-fill-a-streams-internal-queue" id="ref-for-desired-size-to-fill-a-streams-internal-queue⑨">desired size to fill the
  readable side’s internal queue</a>. It can be negative, if the queue is over-full. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#ts-default-controller-enqueue" id="ref-for-ts-default-controller-enqueue④">enqueue</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Enqueues the given <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⑧">chunk</a> <var>chunk</var> in the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side⑨">readable side</a> of the controlled
  transform stream. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#ts-default-controller-error" id="ref-for-ts-default-controller-error①">error</a></code>(<var>e</var>)</code> 
    <dd>
     <p>Errors both the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①⓪">readable side</a> and the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side⑧">writable side</a> of the controlled transform
  stream, making all future interactions with it fail with the given error <var>e</var>. Any <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑥⑨">chunks</a> queued for transformation will be discarded. </p>
    <dt><code><var>controller</var>.<code class="idl"><a data-link-type="idl" href="#ts-default-controller-terminate" id="ref-for-ts-default-controller-terminate②">terminate</a></code>()</code> 
    <dd>
     <p>Closes the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①①">readable side</a> and errors the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side⑨">writable side</a> of the controlled transform
  stream. This is useful when the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer⑥">transformer</a> only needs to consume a portion of the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⓪">chunks</a> written to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①⓪">writable side</a>. </p>
   </dl>
   <div class="algorithm" data-algorithm="desiredSize" data-algorithm-for="TransformStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStreamDefaultController" data-dfn-type="attribute" data-export id="ts-default-controller-desired-size"><code>desiredSize</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Let <var>readableController</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⑤">this</a>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream">[[stream]]</a>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable⑤">[[readable]]</a>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⑤">[[controller]]</a>.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-get-desired-size" id="ref-for-readable-stream-default-controller-get-desired-size②">ReadableStreamDefaultControllerGetDesiredSize</a>(<var>readableController</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="enqueue(chunk)" data-algorithm-for="TransformStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStreamDefaultController" data-dfn-type="method" data-export data-lt="enqueue(chunk)|enqueue()" id="ts-default-controller-enqueue"><code>enqueue(<var>chunk</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#transform-stream-default-controller-enqueue" id="ref-for-transform-stream-default-controller-enqueue">TransformStreamDefaultControllerEnqueue</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⑥">this</a>, <var>chunk</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="error(e)" data-algorithm-for="TransformStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStreamDefaultController" data-dfn-type="method" data-export data-lt="error(reason)|error()|error(e)" id="ts-default-controller-error"><code>error(<var>e</var>)</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#transform-stream-default-controller-error" id="ref-for-transform-stream-default-controller-error">TransformStreamDefaultControllerError</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⑦">this</a>, <var>e</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="terminate()" data-algorithm-for="TransformStreamDefaultController">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="TransformStreamDefaultController" data-dfn-type="method" data-export id="ts-default-controller-terminate"><code>terminate()</code></dfn> method steps are: 
    <ol>
     <li data-md>
      <p>Perform ? <a data-link-type="abstract-op" href="#transform-stream-default-controller-terminate" id="ref-for-transform-stream-default-controller-terminate">TransformStreamDefaultControllerTerminate</a>(<a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⑧">this</a>).</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="6.4" id="ts-all-abstract-ops"><span class="secno">6.4. </span><span class="content">Abstract operations</span><a class="self-link" href="#ts-all-abstract-ops"></a></h3>
   <h4 class="heading settled" data-level="6.4.1" id="ts-abstract-ops"><span class="secno">6.4.1. </span><span class="content">Working with transform streams</span><a class="self-link" href="#ts-abstract-ops"></a></h4>
   <p>The following abstract operations operate on <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⑤">TransformStream</a></code> instances at a higher level.</p>
   <div class="algorithm" data-algorithm="InitializeTransformStream">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="InitializeTransformStream" id="initialize-transform-stream">InitializeTransformStream(<var>stream</var>, <var>startPromise</var>, <var>writableHighWaterMark</var>, <var>writableSizeAlgorithm</var>, <var>readableHighWaterMark</var>, <var>readableSizeAlgorithm</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns <var>startPromise</var>.</p>
     <li data-md>
      <p>Let <var>writeAlgorithm</var> be the following steps, taking a <var>chunk</var> argument:</p>
      <ol>
       <li data-md>
        <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-sink-write-algorithm" id="ref-for-transform-stream-default-sink-write-algorithm">TransformStreamDefaultSinkWriteAlgorithm</a>(<var>stream</var>, <var>chunk</var>).</p>
      </ol>
     <li data-md>
      <p>Let <var>abortAlgorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-sink-abort-algorithm" id="ref-for-transform-stream-default-sink-abort-algorithm">TransformStreamDefaultSinkAbortAlgorithm</a>(<var>stream</var>, <var>reason</var>).</p>
      </ol>
     <li data-md>
      <p>Let <var>closeAlgorithm</var> be the following steps:</p>
      <ol>
       <li data-md>
        <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-sink-close-algorithm" id="ref-for-transform-stream-default-sink-close-algorithm">TransformStreamDefaultSinkCloseAlgorithm</a>(<var>stream</var>).</p>
      </ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable④">[[writable]]</a> to ! <a data-link-type="abstract-op" href="#create-writable-stream" id="ref-for-create-writable-stream">CreateWritableStream</a>(<var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, <var>writableHighWaterMark</var>, <var>writableSizeAlgorithm</var>).</p>
     <li data-md>
      <p>Let <var>pullAlgorithm</var> be the following steps:</p>
      <ol>
       <li data-md>
        <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-source-pull" id="ref-for-transform-stream-default-source-pull">TransformStreamDefaultSourcePullAlgorithm</a>(<var>stream</var>).</p>
      </ol>
     <li data-md>
      <p>Let <var>cancelAlgorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error-writable-and-unblock-write" id="ref-for-transform-stream-error-writable-and-unblock-write">TransformStreamErrorWritableAndUnblockWrite</a>(<var>stream</var>, <var>reason</var>).</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②③">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable⑥">[[readable]]</a> to ! <a data-link-type="abstract-op" href="#create-readable-stream" id="ref-for-create-readable-stream②">CreateReadableStream</a>(<var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, <var>readableHighWaterMark</var>, <var>readableSizeAlgorithm</var>).</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure③">[[backpressure]]</a> and <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise②">[[backpressureChangePromise]]</a> to undefined.</p>
      <p class="note" role="note">The <a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure④">[[backpressure]]</a> slot is set to undefined so that it can
  be initialized by <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure">TransformStreamSetBackpressure</a>. Alternatively, implementations can use a
  strictly boolean value for <a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure⑤">[[backpressure]]</a> and change the way it is
  initialized. This will not be visible to user code so long as the initialization is correctly
  completed before the transformer’s <code class="idl"><a data-link-type="idl" href="#dom-transformer-start" id="ref-for-dom-transformer-start⑤">start()</a></code> method is called. </p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure①">TransformStreamSetBackpressure</a>(<var>stream</var>, true).</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller③">[[controller]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamError" id="transform-stream-error">TransformStreamError(<var>stream</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error⑦">ReadableStreamDefaultControllerError</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable⑦">[[readable]]</a>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⑥">[[controller]]</a>, <var>e</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error-writable-and-unblock-write" id="ref-for-transform-stream-error-writable-and-unblock-write①">TransformStreamErrorWritableAndUnblockWrite</a>(<var>stream</var>, <var>e</var>).</p>
    </ol>
    <p class="note" role="note">This operation works correctly when one or both sides are already errored. As a
 result, calling algorithms do not need to check stream states when responding to an error
 condition. </p>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamErrorWritableAndUnblockWrite">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamErrorWritableAndUnblockWrite" id="transform-stream-error-writable-and-unblock-write">TransformStreamErrorWritableAndUnblockWrite(<var>stream</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-clear-algorithms" id="ref-for-transform-stream-default-controller-clear-algorithms">TransformStreamDefaultControllerClearAlgorithms</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller④">[[controller]]</a>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error-if-needed" id="ref-for-writable-stream-default-controller-error-if-needed②">WritableStreamDefaultControllerErrorIfNeeded</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable⑤">[[writable]]</a>.<a data-link-type="dfn" href="#writablestream-controller" id="ref-for-writablestream-controller①⓪">[[controller]]</a>, <var>e</var>).</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure⑥">[[backpressure]]</a> is true, perform ! <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure②">TransformStreamSetBackpressure</a>(<var>stream</var>,
  false).</p>
    </ol>
    <p class="note" role="note">The <a data-link-type="abstract-op" href="#transform-stream-default-sink-write-algorithm" id="ref-for-transform-stream-default-sink-write-algorithm①">TransformStreamDefaultSinkWriteAlgorithm</a> abstract operation could be
 waiting for the promise stored in the <a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise③">[[backpressureChangePromise]]</a> slot to
 resolve. The call to <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure③">TransformStreamSetBackpressure</a> ensures that the promise always resolves. </p>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamSetBackpressure">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamSetBackpressure" id="transform-stream-set-backpressure">TransformStreamSetBackpressure(<var>stream</var>, <var>backpressure</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure⑦">[[backpressure]]</a> is not <var>backpressure</var>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise④">[[backpressureChangePromise]]</a> is not undefined, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②①">resolve</a> stream.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise⑤">[[backpressureChangePromise]]</a> with undefined.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise⑥">[[backpressureChangePromise]]</a> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①④">a new promise</a>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure⑧">[[backpressure]]</a> to <var>backpressure</var>.</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="6.4.2" id="ts-default-controller-abstract-ops"><span class="secno">6.4.2. </span><span class="content">Default controllers</span><a class="self-link" href="#ts-default-controller-abstract-ops"></a></h4>
   <p>The following abstract operations support the implementaiton of the <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller①⓪">TransformStreamDefaultController</a></code> class.</p>
   <div class="algorithm" data-algorithm="SetUpTransformStreamDefaultController">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpTransformStreamDefaultController" id="set-up-transform-stream-default-controller">SetUpTransformStreamDefaultController(<var>stream</var>, <var>controller</var>, <var>transformAlgorithm</var>, <var>flushAlgorithm</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var> <a data-link-type="dfn" href="https://heycam.github.io/webidl/#implements" id="ref-for-implements①④">implements</a> <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⑥">TransformStream</a></code>.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller⑤">[[controller]]</a> is undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream①">[[stream]]</a> to <var>stream</var>.</p>
     <li data-md>
      <p>Set <var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller⑥">[[controller]]</a> to <var>controller</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-transformalgorithm" id="ref-for-transformstreamdefaultcontroller-transformalgorithm">[[transformAlgorithm]]</a> to <var>transformAlgorithm</var>.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-flushalgorithm" id="ref-for-transformstreamdefaultcontroller-flushalgorithm">[[flushAlgorithm]]</a> to <var>flushAlgorithm</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpTransformStreamDefaultControllerFromTransformer">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpTransformStreamDefaultControllerFromTransformer" id="set-up-transform-stream-default-controller-from-transformer">SetUpTransformStreamDefaultControllerFromTransformer(<var>stream</var>, <var>transformer</var>, <var>transformerDict</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⑦">new</a> <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller①①">TransformStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Let <var>transformAlgorithm</var> be the following steps, taking a <var>chunk</var> argument:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be <a data-link-type="abstract-op" href="#transform-stream-default-controller-enqueue" id="ref-for-transform-stream-default-controller-enqueue①">TransformStreamDefaultControllerEnqueue</a>(<var>controller</var>, <var>chunk</var>).</p>
       <li data-md>
        <p>If <var>result</var> is an abrupt completion, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③⓪">a promise rejected with</a> <var>result</var>.[[Value]].</p>
       <li data-md>
        <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②④">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>flushAlgorithm</var> be an algorithm which returns <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⑤">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>If <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform⑤">transform</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②⓪">exists</a>, set <var>transformAlgorithm</var> to an
  algorithm which takes an argument <var>chunk</var> and returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①④">invoking</a> <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-transform" id="ref-for-dom-transformer-transform⑥">transform</a></code>"] with argument list « <var>chunk</var>, <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value①①">callback this value</a> <var>transformer</var>.</p>
     <li data-md>
      <p>If <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-flush" id="ref-for-dom-transformer-flush④">flush</a></code>"] <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②①">exists</a>, set <var>flushAlgorithm</var> to an
  algorithm which returns the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①⑤">invoking</a> <var>transformerDict</var>["<code class="idl"><a data-link-type="idl" href="#dom-transformer-flush" id="ref-for-dom-transformer-flush⑤">flush</a></code>"]
  with argument list « <var>controller</var> » and <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-this-value" id="ref-for-dfn-callback-this-value①②">callback this value</a> <var>transformer</var>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-transform-stream-default-controller" id="ref-for-set-up-transform-stream-default-controller">SetUpTransformStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>transformAlgorithm</var>, <var>flushAlgorithm</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultControllerClearAlgorithms">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultControllerClearAlgorithms" id="transform-stream-default-controller-clear-algorithms">TransformStreamDefaultControllerClearAlgorithms(<var>controller</var>)</dfn> is called once the stream is closed or errored and the algorithms will not be executed any more.
 By removing the algorithm references it permits the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer⑦">transformer</a> object to be garbage collected
 even if the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⑦">TransformStream</a></code> itself is still referenced. 
    <p class="note" role="note">This is observable using <a href="https://github.com/tc39/proposal-weakrefs/">weak
 references</a>. See <a href="https://github.com/tc39/proposal-weakrefs/issues/31">tc39/proposal-weakrefs#31</a> for more
 detail. </p>
    <p>It performs the following steps:</p>
    <ol>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-transformalgorithm" id="ref-for-transformstreamdefaultcontroller-transformalgorithm①">[[transformAlgorithm]]</a> to undefined.</p>
     <li data-md>
      <p>Set <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-flushalgorithm" id="ref-for-transformstreamdefaultcontroller-flushalgorithm①">[[flushAlgorithm]]</a> to undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultControllerEnqueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultControllerEnqueue" id="transform-stream-default-controller-enqueue">TransformStreamDefaultControllerEnqueue(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream②">[[stream]]</a>.</p>
     <li data-md>
      <p>Let <var>readableController</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable⑧">[[readable]]</a>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⑦">[[controller]]</a>.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-can-close-or-enqueue" id="ref-for-readable-stream-default-controller-can-close-or-enqueue⑤">ReadableStreamDefaultControllerCanCloseOrEnqueue</a>(<var>readableController</var>) is false, throw
  a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑥">TypeError</a></code> exception.</p>
     <li data-md>
      <p>Let <var>enqueueResult</var> be <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue③">ReadableStreamDefaultControllerEnqueue</a>(<var>readableController</var>, <var>chunk</var>).</p>
     <li data-md>
      <p>If <var>enqueueResult</var> is an abrupt completion,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error-writable-and-unblock-write" id="ref-for-transform-stream-error-writable-and-unblock-write②">TransformStreamErrorWritableAndUnblockWrite</a>(<var>stream</var>, <var>enqueueResult</var>.[[Value]]).</p>
       <li data-md>
        <p>Throw <var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable⑨">[[readable]]</a>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror⑨">[[storedError]]</a>.</p>
      </ol>
     <li data-md>
      <p>Let <var>backpressure</var> be ! <a data-link-type="abstract-op" href="#rs-default-controller-has-backpressure" id="ref-for-rs-default-controller-has-backpressure">ReadableStreamDefaultControllerHasBackpressure</a>(<var>readableController</var>).</p>
     <li data-md>
      <p>If <var>backpressure</var> is not <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure⑨">[[backpressure]]</a>,</p>
      <ol>
       <li data-md>
        <p class="assertion">Assert: <var>backpressure</var> is true.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure④">TransformStreamSetBackpressure</a>(<var>stream</var>, true).</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultControllerError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultControllerError" id="transform-stream-default-controller-error">TransformStreamDefaultControllerError(<var>controller</var>, <var>e</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error" id="ref-for-transform-stream-error">TransformStreamError</a>(<var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream③">[[stream]]</a>, <var>e</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultControllerPerformTransform">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultControllerPerformTransform" id="transform-stream-default-controller-perform-transform">TransformStreamDefaultControllerPerformTransform(<var>controller</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>transformPromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-transformalgorithm" id="ref-for-transformstreamdefaultcontroller-transformalgorithm②">[[transformAlgorithm]]</a>, passing <var>chunk</var>.</p>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled" id="ref-for-dfn-perform-steps-once-promise-is-settled①">reacting</a> to <var>transformPromise</var> with the following
  rejection steps given the argument <var>r</var>:</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error" id="ref-for-transform-stream-error①">TransformStreamError</a>(<var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream④">[[stream]]</a>, <var>r</var>).</p>
       <li data-md>
        <p>Throw <var>r</var>.</p>
      </ol>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultControllerTerminate">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultControllerTerminate" id="transform-stream-default-controller-terminate">TransformStreamDefaultControllerTerminate(<var>controller</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>stream</var> be <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-stream" id="ref-for-transformstreamdefaultcontroller-stream⑤">[[stream]]</a>.</p>
     <li data-md>
      <p>Let <var>readableController</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable①⓪">[[readable]]</a>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⑧">[[controller]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close③">ReadableStreamDefaultControllerClose</a>(<var>readableController</var>).</p>
     <li data-md>
      <p>Let <var>error</var> be a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑦">TypeError</a></code> exception indicating that the stream has been terminated.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error-writable-and-unblock-write" id="ref-for-transform-stream-error-writable-and-unblock-write③">TransformStreamErrorWritableAndUnblockWrite</a>(<var>stream</var>, <var>error</var>).</p>
    </ol>
   </div>
   <h4 class="heading settled" data-level="6.4.3" id="ts-default-sink-abstract-ops"><span class="secno">6.4.3. </span><span class="content">Default sinks</span><a class="self-link" href="#ts-default-sink-abstract-ops"></a></h4>
   <p>The following abstract operations are used to implement the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink③⓪">underlying sink</a> for the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①①">writable
side</a> of <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream③">transform streams</a>.</p>
   <div class="algorithm" data-algorithm="TransformStreamDefaultSinkWriteAlgorithm">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultSinkWriteAlgorithm" id="transform-stream-default-sink-write-algorithm">TransformStreamDefaultSinkWriteAlgorithm(<var>stream</var>, <var>chunk</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable⑥">[[writable]]</a>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③④">[[state]]</a> is "<code>writable</code>".</p>
     <li data-md>
      <p>Let <var>controller</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller⑦">[[controller]]</a>.</p>
     <li data-md>
      <p>If <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure①⓪">[[backpressure]]</a> is true,</p>
      <ol>
       <li data-md>
        <p>Let <var>backpressureChangePromise</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise⑦">[[backpressureChangePromise]]</a>.</p>
       <li data-md>
        <p class="assertion">Assert: <var>backpressureChangePromise</var> is not undefined.</p>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled" id="ref-for-dfn-perform-steps-once-promise-is-settled②">reacting</a> to <var>backpressureChangePromise</var> with the following fulfillment
  steps:</p>
        <ol>
         <li data-md>
          <p>Let <var>writable</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable⑦">[[writable]]</a>.</p>
         <li data-md>
          <p>Let <var>state</var> be <var>writable</var>.<a data-link-type="dfn" href="#writablestream-state" id="ref-for-writablestream-state③⑤">[[state]]</a>.</p>
         <li data-md>
          <p>If <var>state</var> is "<code>erroring</code>", throw <var>writable</var>.<a data-link-type="dfn" href="#writablestream-storederror" id="ref-for-writablestream-storederror①⑥">[[storedError]]</a>.</p>
         <li data-md>
          <p class="assertion">Assert: <var>state</var> is "<code>writable</code>".</p>
         <li data-md>
          <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-perform-transform" id="ref-for-transform-stream-default-controller-perform-transform">TransformStreamDefaultControllerPerformTransform</a>(<var>controller</var>, <var>chunk</var>).</p>
        </ol>
      </ol>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-perform-transform" id="ref-for-transform-stream-default-controller-perform-transform①">TransformStreamDefaultControllerPerformTransform</a>(<var>controller</var>, <var>chunk</var>).</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultSinkAbortAlgorithm">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultSinkAbortAlgorithm" id="transform-stream-default-sink-abort-algorithm">TransformStreamDefaultSinkAbortAlgorithm(<var>stream</var>, <var>reason</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error" id="ref-for-transform-stream-error②">TransformStreamError</a>(<var>stream</var>, <var>reason</var>).</p>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⑥">a promise resolved with</a> undefined.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransformStreamDefaultSinkCloseAlgorithm">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultSinkCloseAlgorithm" id="transform-stream-default-sink-close-algorithm">TransformStreamDefaultSinkCloseAlgorithm(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>readable</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable①①">[[readable]]</a>.</p>
     <li data-md>
      <p>Let <var>controller</var> be <var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller⑧">[[controller]]</a>.</p>
     <li data-md>
      <p>Let <var>flushPromise</var> be the result of performing <var>controller</var>.<a data-link-type="dfn" href="#transformstreamdefaultcontroller-flushalgorithm" id="ref-for-transformstreamdefaultcontroller-flushalgorithm②">[[flushAlgorithm]]</a>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-clear-algorithms" id="ref-for-transform-stream-default-controller-clear-algorithms①">TransformStreamDefaultControllerClearAlgorithms</a>(<var>controller</var>).</p>
     <li data-md>
      <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled" id="ref-for-dfn-perform-steps-once-promise-is-settled③">reacting</a> to <var>flushPromise</var>:</p>
      <ol>
       <li data-md>
        <p>If <var>flushPromise</var> was fulfilled, then:</p>
        <ol>
         <li data-md>
          <p>If <var>readable</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③⑤">[[state]]</a> is "<code>errored</code>", throw <var>readable</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror①⓪">[[storedError]]</a>.</p>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close④">ReadableStreamDefaultControllerClose</a>(<var>readable</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller①⑨">[[controller]]</a>).</p>
        </ol>
       <li data-md>
        <p>If <var>flushPromise</var> was rejected with reason <var>r</var>, then:</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-error" id="ref-for-transform-stream-error③">TransformStreamError</a>(<var>stream</var>, <var>r</var>).</p>
         <li data-md>
          <p>Throw <var>readable</var>.<a data-link-type="dfn" href="#readablestream-storederror" id="ref-for-readablestream-storederror①①">[[storedError]]</a>.</p>
        </ol>
      </ol>
    </ol>
   </div>
   <h4 class="heading settled" data-level="6.4.4" id="ts-default-source-abstract-ops"><span class="secno">6.4.4. </span><span class="content">Default sources</span><a class="self-link" href="#ts-default-source-abstract-ops"></a></h4>
   <p>The following abstract operation is used to implement the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⑥">underlying source</a> for the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①②">readable
side</a> of <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream④">transform streams</a>.</p>
   <div class="algorithm" data-algorithm="TransformStreamDefaultSourcePullAlgorithm">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransformStreamDefaultSourcePullAlgorithm" id="transform-stream-default-source-pull">TransformStreamDefaultSourcePullAlgorithm(<var>stream</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressure" id="ref-for-transformstream-backpressure①①">[[backpressure]]</a> is true.</p>
     <li data-md>
      <p class="assertion">Assert: <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise⑧">[[backpressureChangePromise]]</a> is not undefined.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#transform-stream-set-backpressure" id="ref-for-transform-stream-set-backpressure⑤">TransformStreamSetBackpressure</a>(<var>stream</var>, false).</p>
     <li data-md>
      <p>Return <var>stream</var>.<a data-link-type="dfn" href="#transformstream-backpressurechangepromise" id="ref-for-transformstream-backpressurechangepromise⑨">[[backpressureChangePromise]]</a>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="7" id="qs"><span class="secno">7. </span><span class="content">Queuing strategies</span><a class="self-link" href="#qs"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="qs-api"><span class="secno">7.1. </span><span class="content">The queuing strategy API</span><a class="self-link" href="#qs-api"></a></h3>
   <p>The <code class="idl"><a data-link-type="idl" href="#rs-constructor" id="ref-for-rs-constructor⑥">ReadableStream()</a></code>, <code class="idl"><a data-link-type="idl" href="#ws-constructor" id="ref-for-ws-constructor⑤">WritableStream()</a></code>, and <code class="idl"><a data-link-type="idl" href="#ts-constructor" id="ref-for-ts-constructor⑤">TransformStream()</a></code> constructors all accept
at least one argument representing an appropriate <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy⑧">queuing strategy</a> for the stream being
created. Such objects contain the following properties:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-queuingstrategy"><code><c- g>QueuingStrategy</c-></code></dfn> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double⑤"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="unrestricted double " href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark③"><c- g>highWaterMark</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-queuingstrategysize" id="ref-for-callbackdef-queuingstrategysize"><c- n>QueuingStrategySize</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="QueuingStrategySize " href="#dom-queuingstrategy-size" id="ref-for-dom-queuingstrategy-size②"><c- g>size</c-></a>;
};

<c- b>callback</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="callback" data-export id="callbackdef-queuingstrategysize"><code><c- g>QueuingStrategySize</c-></code></dfn> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double⑥"><c- b>unrestricted</c-> <c- b>double</c-></a> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any" id="ref-for-idl-any②⑥"><c- b>any</c-></a> <dfn class="idl-code" data-dfn-for="QueuingStrategySize" data-dfn-type="argument" data-export id="dom-queuingstrategysize-chunk"><code><c- g>chunk</c-></code><a class="self-link" href="#dom-queuingstrategysize-chunk"></a></dfn>);
</pre>
   <dl>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="QueuingStrategy" data-dfn-type="dict-member" data-export id="dom-queuingstrategy-highwatermark"><code>highWaterMark</code></dfn>, <span> of type <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double⑦">unrestricted double</a></span>
    <dd>
     <p>A non-negative number indicating the <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark⑥">high water mark</a> of the stream using this queuing
  strategy. </p>
    <dt><dfn class="dfn-paneled idl-code" data-dfn-for="QueuingStrategy" data-dfn-type="dict-member" data-export data-lt="size" id="dom-queuingstrategy-size"><code>size(<var>chunk</var>)</code></dfn> (non-byte streams only), <span> of type <a data-link-type="idl-name" href="#callbackdef-queuingstrategysize" id="ref-for-callbackdef-queuingstrategysize①">QueuingStrategySize</a></span>
    <dd>
     <p>A function that computes and returns the finite non-negative size of the given <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦①">chunk</a> value. </p>
     <p>The result is used to determine <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⑤">backpressure</a>, manifesting via the appropriate <code>desiredSize</code> property: either <code class="idl"><a data-link-type="idl" href="#rs-default-controller-desired-size" id="ref-for-rs-default-controller-desired-size③">defaultController.desiredSize</a></code>, <code class="idl"><a data-link-type="idl" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size③">byteController.desiredSize</a></code>, or <code class="idl"><a data-link-type="idl" href="#default-writer-desired-size" id="ref-for-default-writer-desired-size⑦">writer.desiredSize</a></code>, depending on where the queuing
  strategy is being used. For readable streams, it also governs when the <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⑦">underlying source</a>'s <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull⑧">pull()</a></code> method is called. </p>
     <p>This function has to be idempotent and not cause side effects; very strange results can occur
  otherwise. </p>
     <p>For <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①③">readable byte streams</a>, this function is not used, as chunks are always measured in
  bytes. </p>
   </dl>
   <p>Any object with these properties can be used when a queuing strategy object is expected. However,
we provide two built-in queuing strategy classes that provide a common vocabulary for certain
cases: <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy">ByteLengthQueuingStrategy</a></code> and <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy④">CountQueuingStrategy</a></code>. They both make use of the
following Web IDL fragment for their constructors:</p>
<pre class="idl highlight def"><c- b>dictionary</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export id="dictdef-queuingstrategyinit"><code><c- g>QueuingStrategyInit</c-></code></dfn> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double⑧"><c- b>unrestricted</c-> <c- b>double</c-></a> <dfn class="dfn-paneled idl-code" data-dfn-for="QueuingStrategyInit" data-dfn-type="dict-member" data-export data-type="unrestricted double " id="dom-queuingstrategyinit-highwatermark"><code><c- g>highWaterMark</c-></code></dfn>;
};
</pre>
   <h3 class="heading settled" data-level="7.2" id="blqs-class"><span class="secno">7.2. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy①">ByteLengthQueuingStrategy</a></code> class</span><a class="self-link" href="#blqs-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ByteLengthQueuingStrategy" title="The ByteLengthQueuingStrategy interface of the Streams API provides a built-in byte length queuing strategy that can be used when constructing streams.">ByteLengthQueuingStrategy</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <p>A common <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy⑨">queuing strategy</a> when dealing with bytes is to wait until the accumulated <code>byteLength</code> properties of the incoming <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦②">chunks</a> reaches a specified high-water mark.
As such, this is provided as a built-in <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy①⓪">queuing strategy</a> that can be used when constructing
streams.</p>
   <div class="example" id="example-blqs">
    <a class="self-link" href="#example-blqs"></a> When creating a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⑦">readable stream</a> or <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①①">writable stream</a>, you can supply a byte-length queuing
 strategy directly: 
<pre class="highlight"><c- a>const</c-> stream <c- o>=</c-> <c- ow>new</c-> ReadableStream<c- p>(</c->
  <c- p>{</c-> <c- p>...</c-> <c- p>},</c->
  <c- ow>new</c-> ByteLengthQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>16</c-> <c- o>*</c-> <c- mf>1024</c-> <c- p>})</c->
<c- p>);</c->
</pre>
    <p>In this case, 16 KiB worth of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦③">chunks</a> can be enqueued by the readable stream’s <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⑧">underlying
 source</a> before the readable stream implementation starts sending <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⑥">backpressure</a> signals to the
 underlying source.</p>
<pre class="highlight"><c- a>const</c-> stream <c- o>=</c-> <c- ow>new</c-> WritableStream<c- p>(</c->
  <c- p>{</c-> <c- p>...</c-> <c- p>},</c->
  <c- ow>new</c-> ByteLengthQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>32</c-> <c- o>*</c-> <c- mf>1024</c-> <c- p>})</c->
<c- p>);</c->
</pre>
    <p>In this case, 32 KiB worth of <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦④">chunks</a> can be accumulated in the writable stream’s internal
 queue, waiting for previous writes to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink③①">underlying sink</a> to finish, before the writable
 stream starts sending <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⑦">backpressure</a> signals to any <a data-link-type="dfn" href="#producer" id="ref-for-producer⑥">producers</a>.</p>
   </div>
   <p class="note" role="note">It is not necessary to use <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy②">ByteLengthQueuingStrategy</a></code> with <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①④">readable byte
streams</a>, as they always measure chunks in bytes. Attempting to construct a byte stream with a <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy③">ByteLengthQueuingStrategy</a></code> will fail. </p>
   <h4 class="heading settled" data-level="7.2.1" id="blqs-class-definition"><span class="secno">7.2.1. </span><span class="content">Interface definition</span><a class="self-link" href="#blqs-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy④">ByteLengthQueuingStrategy</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①①"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="bytelengthqueuingstrategy"><code><c- g>ByteLengthQueuingStrategy</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#blqs-constructor" id="ref-for-blqs-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-queuingstrategyinit" id="ref-for-dictdef-queuingstrategyinit"><c- n>QueuingStrategyInit</c-></a> <dfn class="idl-code" data-dfn-for="ByteLengthQueuingStrategy/ByteLengthQueuingStrategy(init), ByteLengthQueuingStrategy/constructor(init)" data-dfn-type="argument" data-export id="dom-bytelengthqueuingstrategy-bytelengthqueuingstrategy-init-init"><code><c- g>init</c-></code><a class="self-link" href="#dom-bytelengthqueuingstrategy-bytelengthqueuingstrategy-init-init"></a></dfn>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double⑨"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double" href="#blqs-high-water-mark" id="ref-for-blqs-high-water-mark"><c- g>highWaterMark</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function"><c- n>Function</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Function" href="#blqs-size" id="ref-for-blqs-size"><c- g>size</c-></a>;
};
</pre>
   <h4 class="heading settled" data-level="7.2.2" id="blqs-internal-slots"><span class="secno">7.2.2. </span><span class="content">Internal slots</span><a class="self-link" href="#blqs-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy⑤">ByteLengthQueuingStrategy</a></code> have a <dfn class="dfn-paneled" data-dfn-for="ByteLengthQueuingStrategy" data-dfn-type="dfn" data-noexport id="bytelengthqueuingstrategy-highwatermark">[[highWaterMark]]</dfn> internal slot, storing the value given
in the constructor.</p>
   <div class="algorithm" data-algorithm="byte length queuing strategy size function">
     Additionally, every <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object">global object</a> <var>globalObject</var> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="byte length queuing strategy size function" data-noexport id="byte-length-queuing-strategy-size-function">byte length queuing
 strategy size function</dfn>, which is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function①">Function</a></code> whose value must be initialized as follows: 
    <ol>
     <li data-md>
      <p>Let <var>steps</var> be the following steps, given <var>chunk</var>:</p>
      <ol>
       <li data-md>
        <p>Return ? <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-getv" id="ref-for-sec-getv">GetV</a>(<var>chunk</var>, "<code>byteLength</code>").</p>
      </ol>
     <li data-md>
      <p>Let <var>F</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createbuiltinfunction" id="ref-for-sec-createbuiltinfunction">CreateBuiltinFunction</a>(<var>steps</var>, « », <var>globalObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" id="ref-for-concept-relevant-realm">relevant Realm</a>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-setfunctionname" id="ref-for-sec-setfunctionname">SetFunctionName</a>(<var>F</var>, "<code>size</code>").</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-setfunctionlength" id="ref-for-sec-setfunctionlength">SetFunctionLength</a>(<var>F</var>, 1).</p>
     <li data-md>
      <p>Set <var>globalObject</var>’s <a data-link-type="dfn" href="#byte-length-queuing-strategy-size-function" id="ref-for-byte-length-queuing-strategy-size-function">byte length queuing strategy size function</a> to a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function②">Function</a></code> that
  represents a reference to <var>F</var>, with <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-context" id="ref-for-dfn-callback-context">callback context</a> equal to <var>globalObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object">relevant
  settings object</a>.</p>
    </ol>
    <p class="note" role="note">This design is somewhat historical. It is motivated by the desire to ensure that <code class="idl"><a data-link-type="idl" href="#blqs-size" id="ref-for-blqs-size①">size</a></code> is a function, not a method, i.e. it does not check its <code>this</code> value. See <a href="https://github.com/whatwg/streams/issues/1005">whatwg/streams#1005</a> and <a href="https://github.com/heycam/webidl/issues/819">heycam/webidl#819</a> for more background. </p>
   </div>
   <h4 class="heading settled" data-level="7.2.3" id="blqs-prototype"><span class="secno">7.2.3. </span><span class="content">Constructor and properties</span><a class="self-link" href="#blqs-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>strategy</var> = new <code class="idl"><a data-link-type="idl" href="#blqs-constructor" id="ref-for-blqs-constructor①">ByteLengthQueuingStrategy</a></code>({ <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategyinit-highwatermark" id="ref-for-dom-queuingstrategyinit-highwatermark">highWaterMark</a></code> })</code> 
    <dd>
     <p>Creates a new <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy⑥">ByteLengthQueuingStrategy</a></code> with the provided <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark⑦">high water mark</a>. </p>
     <p>Note that the provided high water mark will not be validated ahead of time. Instead, if it is
   negative, NaN, or not a number, the resulting <code class="idl"><a data-link-type="idl" href="#bytelengthqueuingstrategy" id="ref-for-bytelengthqueuingstrategy⑦">ByteLengthQueuingStrategy</a></code> will cause the
   corresponding stream constructor to throw. </p>
    <dt><code><var>highWaterMark</var> = <var>strategy</var>.<code class="idl"><a data-link-type="idl" href="#blqs-high-water-mark" id="ref-for-blqs-high-water-mark①">highWaterMark</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark⑧">high water mark</a> provided to the constructor. </p>
    <dt><code><var>strategy</var>.<code class="idl"><a data-link-type="idl" href="#blqs-size" id="ref-for-blqs-size②">size</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Measures the size of <var>chunk</var> by returning the value of its <code>byteLength</code> property. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ByteLengthQueuingStrategy/ByteLengthQueuingStrategy" title="The ByteLengthQueuingStrategy() constructor creates and returns a ByteLengthQueuingStrategy object instance.">ByteLengthQueuingStrategy/ByteLengthQueuingStrategy</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="ByteLengthQueuingStrategy(init)" data-algorithm-for="ByteLengthQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ByteLengthQueuingStrategy" data-dfn-type="constructor" data-export data-lt="ByteLengthQueuingStrategy(init)|constructor(init)" id="blqs-constructor"><code>new ByteLengthQueuingStrategy(<var>init</var>)</code></dfn> constructor steps
 are: 
    <ol>
     <li data-md>
      <p>Set <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①①⑨">this</a>.<a data-link-type="dfn" href="#bytelengthqueuingstrategy-highwatermark" id="ref-for-bytelengthqueuingstrategy-highwatermark">[[highWaterMark]]</a> to <var>init</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategyinit-highwatermark" id="ref-for-dom-queuingstrategyinit-highwatermark①">highWaterMark</a></code>"].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="highWaterMark" data-algorithm-for="ByteLengthQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ByteLengthQueuingStrategy" data-dfn-type="attribute" data-export id="blqs-high-water-mark"><code>highWaterMark</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⓪">this</a>.<a data-link-type="dfn" href="#bytelengthqueuingstrategy-highwatermark" id="ref-for-bytelengthqueuingstrategy-highwatermark①">[[highWaterMark]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/ByteLengthQueuingStrategy/size" title="The size() method of the ByteLengthQueuingStrategy interface returns the given chunk’s byteLength property.">ByteLengthQueuingStrategy/size</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="size" data-algorithm-for="ByteLengthQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="ByteLengthQueuingStrategy" data-dfn-type="attribute" data-export id="blqs-size"><code>size</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②①">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global">relevant global object</a>'s <a data-link-type="dfn" href="#byte-length-queuing-strategy-size-function" id="ref-for-byte-length-queuing-strategy-size-function①">byte length queuing strategy size function</a>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="7.3" id="cqs-class"><span class="secno">7.3. </span><span class="content">The <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy⑤">CountQueuingStrategy</a></code> class</span><a class="self-link" href="#cqs-class"></a></h3>
   <div class="mdn-anno wrapped after">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CountQueuingStrategy" title="The CountQueuingStrategy interface of the Streams API provides a built-in chunk counting queuing strategy that can be used when constructing streams.">CountQueuingStrategy</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <p>A common <a data-link-type="dfn" href="#queuing-strategy" id="ref-for-queuing-strategy①①">queuing strategy</a> when dealing with streams of generic objects is to simply count the
number of chunks that have been accumulated so far, waiting until this number reaches a specified
high-water mark. As such, this strategy is also provided out of the box.</p>
   <div class="example" id="example-cqs">
    <a class="self-link" href="#example-cqs"></a> When creating a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⑧">readable stream</a> or <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①②">writable stream</a>, you can supply a count queuing
 strategy directly: 
<pre class="highlight"><c- a>const</c-> stream <c- o>=</c-> <c- ow>new</c-> ReadableStream<c- p>(</c->
  <c- p>{</c-> <c- p>...</c-> <c- p>},</c->
  <c- ow>new</c-> CountQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>10</c-> <c- p>})</c->
<c- p>);</c->
</pre>
    <p>In this case, 10 <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⑤">chunks</a> (of any kind) can be enqueued by the readable stream’s <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source②⑨">underlying
 source</a> before the readable stream implementation starts sending <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⑧">backpressure</a> signals to the
 underlying source.</p>
<pre class="highlight"><c- a>const</c-> stream <c- o>=</c-> <c- ow>new</c-> WritableStream<c- p>(</c->
  <c- p>{</c-> <c- p>...</c-> <c- p>},</c->
  <c- ow>new</c-> CountQueuingStrategy<c- p>({</c-> highWaterMark<c- o>:</c-> <c- mf>5</c-> <c- p>})</c->
<c- p>);</c->
</pre>
    <p>In this case, five <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⑥">chunks</a> (of any kind) can be accumulated in the writable stream’s internal
 queue, waiting for previous writes to the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink③②">underlying sink</a> to finish, before the writable
 stream starts sending <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure①⑨">backpressure</a> signals to any <a data-link-type="dfn" href="#producer" id="ref-for-producer⑦">producers</a>.</p>
   </div>
   <h4 class="heading settled" data-level="7.3.1" id="cqs-class-definition"><span class="secno">7.3.1. </span><span class="content">Interface definition</span><a class="self-link" href="#cqs-class-definition"></a></h4>
   <p>The Web IDL definition for the <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy⑥">CountQueuingStrategy</a></code> class is given as follows:</p>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed" id="ref-for-Exposed①②"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="countqueuingstrategy"><code><c- g>CountQueuingStrategy</c-></code></dfn> {
  <a class="idl-code" data-link-type="constructor" href="#cqs-constructor" id="ref-for-cqs-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-queuingstrategyinit" id="ref-for-dictdef-queuingstrategyinit①"><c- n>QueuingStrategyInit</c-></a> <dfn class="idl-code" data-dfn-for="CountQueuingStrategy/CountQueuingStrategy(init), CountQueuingStrategy/constructor(init)" data-dfn-type="argument" data-export id="dom-countqueuingstrategy-countqueuingstrategy-init-init"><code><c- g>init</c-></code><a class="self-link" href="#dom-countqueuingstrategy-countqueuingstrategy-init-init"></a></dfn>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double" id="ref-for-idl-unrestricted-double①⓪"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double" href="#cqs-high-water-mark" id="ref-for-cqs-high-water-mark"><c- g>highWaterMark</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function③"><c- n>Function</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Function" href="#cqs-size" id="ref-for-cqs-size"><c- g>size</c-></a>;
};
</pre>
   <h4 class="heading settled" data-level="7.3.2" id="cqs-internal-slots"><span class="secno">7.3.2. </span><span class="content">Internal slots</span><a class="self-link" href="#cqs-internal-slots"></a></h4>
   <p>Instances of <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy⑦">CountQueuingStrategy</a></code> have a <dfn class="dfn-paneled" data-dfn-for="CountQueuingStrategy" data-dfn-type="dfn" data-noexport id="countqueuingstrategy-highwatermark">[[highWaterMark]]</dfn> internal slot, storing the value given in the constructor.</p>
   <div class="algorithm" data-algorithm="count queuing strategy size function">
     Additionally, every <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object" id="ref-for-global-object①">global object</a> <var>globalObject</var> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="count queuing strategy size function" data-noexport id="count-queuing-strategy-size-function">count queuing strategy
 size function</dfn>, which is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function④">Function</a></code> whose value must be initialized as follows: 
    <ol>
     <li data-md>
      <p>Let <var>steps</var> be the following steps:</p>
      <ol>
       <li data-md>
        <p>Return 1.</p>
      </ol>
     <li data-md>
      <p>Let <var>F</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createbuiltinfunction" id="ref-for-sec-createbuiltinfunction①">CreateBuiltinFunction</a>(<var>steps</var>, « », <var>globalObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm" id="ref-for-concept-relevant-realm①">relevant Realm</a>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-setfunctionname" id="ref-for-sec-setfunctionname①">SetFunctionName</a>(<var>F</var>, "<code>size</code>").</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-setfunctionlength" id="ref-for-sec-setfunctionlength①">SetFunctionLength</a>(<var>F</var>, 0).</p>
     <li data-md>
      <p>Set <var>globalObject</var>’s <a data-link-type="dfn" href="#count-queuing-strategy-size-function" id="ref-for-count-queuing-strategy-size-function">count queuing strategy size function</a> to a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#Function" id="ref-for-Function⑤">Function</a></code> that represents
  a reference to <var>F</var>, with <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-callback-context" id="ref-for-dfn-callback-context①">callback context</a> equal to <var>globalObject</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object" id="ref-for-relevant-settings-object①">relevant settings
  object</a>.</p>
    </ol>
    <p class="note" role="note">This design is somewhat historical. It is motivated by the desire to ensure that <code class="idl"><a data-link-type="idl" href="#cqs-size" id="ref-for-cqs-size①">size</a></code> is a function, not a method, i.e. it does not check its <code>this</code> value. See <a href="https://github.com/whatwg/streams/issues/1005">whatwg/streams#1005</a> and <a href="https://github.com/heycam/webidl/issues/819">heycam/webidl#819</a> for more background. </p>
   </div>
   <h4 class="heading settled" data-level="7.3.3" id="cqs-prototype"><span class="secno">7.3.3. </span><span class="content">Constructor and properties</span><a class="self-link" href="#cqs-prototype"></a></h4>
   <dl class="domintro non-normative">
    <dt><code><var>strategy</var> = new <code class="idl"><a data-link-type="idl" href="#cqs-constructor" id="ref-for-cqs-constructor①">CountQueuingStrategy</a></code>({ <code class="idl"><a data-link-type="idl" href="#dom-queuingstrategyinit-highwatermark" id="ref-for-dom-queuingstrategyinit-highwatermark②">highWaterMark</a></code> })</code> 
    <dd>
     <p>Creates a new <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy⑧">CountQueuingStrategy</a></code> with the provided <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark⑨">high water mark</a>. </p>
     <p>Note that the provided high water mark will not be validated ahead of time. Instead, if it is
   negative, NaN, or not a number, the resulting <code class="idl"><a data-link-type="idl" href="#countqueuingstrategy" id="ref-for-countqueuingstrategy⑨">CountQueuingStrategy</a></code> will cause the
   corresponding stream constructor to throw. </p>
    <dt><code><var>highWaterMark</var> = <var>strategy</var>.<code class="idl"><a data-link-type="idl" href="#cqs-high-water-mark" id="ref-for-cqs-high-water-mark①">highWaterMark</a></code></code> 
    <dd>
     <p>Returns the <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark①⓪">high water mark</a> provided to the constructor. </p>
    <dt><code><var>strategy</var>.<code class="idl"><a data-link-type="idl" href="#cqs-size" id="ref-for-cqs-size②">size</a></code>(<var>chunk</var>)</code> 
    <dd>
     <p>Measures the size of <var>chunk</var> by always returning 1. This ensures that the total
  queue size is a count of the number of chunks in the queue. </p>
   </dl>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CountQueuingStrategy/CountQueuingStrategy" title="The CountQueuingStrategy() constructor creates and returns a CountQueuingStrategy object instance.">CountQueuingStrategy/CountQueuingStrategy</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="CountQueuingStrategy(init)" data-algorithm-for="CountQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="CountQueuingStrategy" data-dfn-type="constructor" data-export data-lt="CountQueuingStrategy(init)|constructor(init)" id="cqs-constructor"><code>new CountQueuingStrategy(<var>init</var>)</code></dfn> constructor steps are: 
    <ol>
     <li data-md>
      <p>Set <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②②">this</a>.<a data-link-type="dfn" href="#countqueuingstrategy-highwatermark" id="ref-for-countqueuingstrategy-highwatermark">[[highWaterMark]]</a> to <var>init</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategyinit-highwatermark" id="ref-for-dom-queuingstrategyinit-highwatermark③">highWaterMark</a></code>"].</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="highWaterMark" data-algorithm-for="CountQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="CountQueuingStrategy" data-dfn-type="attribute" data-export id="cqs-high-water-mark"><code>highWaterMark</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②③">this</a>.<a data-link-type="dfn" href="#countqueuingstrategy-highwatermark" id="ref-for-countqueuingstrategy-highwatermark①">[[highWaterMark]]</a>.</p>
    </ol>
   </div>
   <div class="mdn-anno wrapped">
    <button class="mdn-anno-btn"><b class="all-engines-flag" title="This feature is in all current engines.">✔</b><span>MDN</span></button>
    <div class="feature">
     <p><a href="https://developer.mozilla.org/en-US/docs/Web/API/CountQueuingStrategy/size" title="The size() method of the CountQueuingStrategy interface always returns 1, so that the total queue size is a count of the number of chunks in the queue.">CountQueuingStrategy/size</a></p>
     <p class="all-engines-text">In all current engines.</p>
     <div class="support">
      <span class="firefox yes"><span>Firefox</span><span>65+</span></span><span class="safari yes"><span>Safari</span><span>10.1+</span></span><span class="chrome yes"><span>Chrome</span><span>59+</span></span>
      <hr>
      <span class="opera yes"><span>Opera</span><span>46+</span></span><span class="edge_blink yes"><span>Edge</span><span>79+</span></span>
      <hr>
      <span class="edge yes"><span>Edge (Legacy)</span><span>16+</span></span><span class="ie no"><span>IE</span><span>None</span></span>
      <hr>
      <span class="firefox_android yes"><span>Firefox for Android</span><span>65+</span></span><span class="safari_ios yes"><span>iOS Safari</span><span>10.3+</span></span><span class="chrome_android yes"><span>Chrome for Android</span><span>59+</span></span><span class="webview_android yes"><span>Android WebView</span><span>59+</span></span><span class="samsunginternet_android yes"><span>Samsung Internet</span><span>7.0+</span></span><span class="opera_android yes"><span>Opera Mobile</span><span>43+</span></span>
     </div>
    </div>
   </div>
   <div class="algorithm" data-algorithm="size" data-algorithm-for="CountQueuingStrategy">
     The <dfn class="dfn-paneled idl-code" data-dfn-for="CountQueuingStrategy" data-dfn-type="attribute" data-export id="cqs-size"><code>size</code></dfn> getter steps are: 
    <ol>
     <li data-md>
      <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②④">this</a>'s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global" id="ref-for-concept-relevant-global①">relevant global object</a>'s <a data-link-type="dfn" href="#count-queuing-strategy-size-function" id="ref-for-count-queuing-strategy-size-function①">count queuing strategy size function</a>.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="7.4" id="qs-abstract-ops"><span class="secno">7.4. </span><span class="content">Abstract operations</span><a class="self-link" href="#qs-abstract-ops"></a></h3>
   <p>The following algorithms are used by the stream constructors to extract the relevant pieces from
a <code class="idl"><a data-link-type="idl" href="#dictdef-queuingstrategy" id="ref-for-dictdef-queuingstrategy④">QueuingStrategy</a></code> dictionary.</p>
   <div class="algorithm" data-algorithm="ExtractHighWaterMark">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ExtractHighWaterMark" id="validate-and-normalize-high-water-mark">ExtractHighWaterMark(<var>strategy</var>, <var>defaultHWM</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>strategy</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark④">highWaterMark</a></code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②②">exist</a>, return <var>defaultHWM</var>.</p>
     <li data-md>
      <p>Let <var>highWaterMark</var> be <var>strategy</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-highwatermark" id="ref-for-dom-queuingstrategy-highwatermark⑤">highWaterMark</a></code>"].</p>
     <li data-md>
      <p>If <var>highWaterMark</var> is NaN or <var>highWaterMark</var> &lt; 0, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror⑦">RangeError</a></code> exception.</p>
     <li data-md>
      <p>Return <var>highWaterMark</var>.</p>
    </ol>
    <p class="note" role="note">+∞ is explicitly allowed as a valid <a data-link-type="dfn" href="#high-water-mark" id="ref-for-high-water-mark①①">high water mark</a>. It causes <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure②⓪">backpressure</a> to never be applied. </p>
   </div>
   <div class="algorithm" data-algorithm="ExtractSizeAlgorithm">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ExtractSizeAlgorithm" id="make-size-algorithm-from-size-function">ExtractSizeAlgorithm(<var>strategy</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <var>strategy</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-size" id="ref-for-dom-queuingstrategy-size③">size</a></code>"] does not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#map-exists" id="ref-for-map-exists②③">exist</a>, return an algorithm that
  returns 1.</p>
     <li data-md>
      <p>Return an algorithm that performs the following steps, taking a <var>chunk</var> argument:</p>
      <ol>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#invoke-a-callback-function" id="ref-for-invoke-a-callback-function①⑥">invoking</a> <var>strategy</var>["<code class="idl"><a data-link-type="idl" href="#dom-queuingstrategy-size" id="ref-for-dom-queuingstrategy-size④">size</a></code>"] with argument
  list « <var>chunk</var> ».</p>
      </ol>
    </ol>
   </div>
   <h2 class="heading settled" data-level="8" id="other-stuff"><span class="secno">8. </span><span class="content">Supporting abstract operations</span><a class="self-link" href="#other-stuff"></a></h2>
   <p>The following abstract operations each support the implementation of more than one type of stream,
and as such are not grouped under the major sections above.</p>
   <h3 class="heading settled" data-level="8.1" id="queue-with-sizes"><span class="secno">8.1. </span><span class="content">Queue-with-sizes</span><a class="self-link" href="#queue-with-sizes"></a></h3>
   <p>The streams in this specification use a "queue-with-sizes" data structure to store queued up
values, along with their determined sizes. Various specification objects contain a
queue-with-sizes, represented by the object having two paired internal slots, always named
[[queue]] and [[queueTotalSize]]. [[queue]] is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①⑥">list</a> of <a data-link-type="dfn" href="#value-with-size" id="ref-for-value-with-size">value-with-sizes</a>, and
[[queueTotalSize]] is a JavaScript <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type" id="ref-for-sec-ecmascript-language-types-number-type①">Number</a></code>, i.e. a double-precision floating point number.</p>
   <p>The following abstract operations are used when operating on objects that contain
queues-with-sizes, in order to ensure that the two internal slots stay synchronized.</p>
   <p class="warning">Due to the limited precision of floating-point arithmetic, the framework
specified here, of keeping a running total in the [[queueTotalSize]] slot, is <em>not</em> equivalent to adding up the size of all <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⑦">chunks</a> in [[queue]]. (However, this only makes a
difference when there is a huge (~10<sup>15</sup>) variance in size between chunks, or when
trillions of chunks are enqueued.) </p>
   <p>In what follows, a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="value-with-size">value-with-size</dfn> is a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct" id="ref-for-struct⑤">struct</a> with the two <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item⑨">items</a> <dfn class="dfn-paneled" data-dfn-for="value-with-size" data-dfn-type="dfn" data-noexport id="value-with-size-value">value</dfn> and <dfn class="dfn-paneled" data-dfn-for="value-with-size" data-dfn-type="dfn" data-noexport id="value-with-size-size">size</dfn>.</p>
   <div class="algorithm" data-algorithm="DequeueValue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="DequeueValue" id="dequeue-value">DequeueValue(<var>container</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>container</var> has [[queue]] and [[queueTotalSize]] internal slots.</p>
     <li data-md>
      <p class="assertion">Assert: <var>container</var>.[[queue]] is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①④">empty</a>.</p>
     <li data-md>
      <p>Let <var>valueWithSize</var> be <var>container</var>.[[queue]][0].</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-remove" id="ref-for-list-remove⑥">Remove</a> <var>valueWithSize</var> from <var>container</var>.[[queue]].</p>
     <li data-md>
      <p>Set <var>container</var>.[[queueTotalSize]] to <var>container</var>.[[queueTotalSize]] − <var>valueWithSize</var>’s <a data-link-type="dfn" href="#value-with-size-size" id="ref-for-value-with-size-size">size</a>.</p>
     <li data-md>
      <p>If <var>container</var>.[[queueTotalSize]] &lt; 0, set <var>container</var>.[[queueTotalSize]] to 0. (This can
  occur due to rounding errors.)</p>
     <li data-md>
      <p>Return <var>valueWithSize</var>’s <a data-link-type="dfn" href="#value-with-size-value" id="ref-for-value-with-size-value">value</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="EnqueueValueWithSize">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="EnqueueValueWithSize" id="enqueue-value-with-size">EnqueueValueWithSize(<var>container</var>, <var>value</var>, <var>size</var>)</dfn> performs the
 following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>container</var> has [[queue]] and [[queueTotalSize]] internal slots.</p>
     <li data-md>
      <p>If ! <a data-link-type="abstract-op" href="#is-non-negative-number" id="ref-for-is-non-negative-number②">IsNonNegativeNumber</a>(<var>size</var>) is false, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror⑧">RangeError</a></code> exception.</p>
     <li data-md>
      <p>If <var>size</var> is +∞, throw a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror" id="ref-for-exceptiondef-rangeerror⑨">RangeError</a></code> exception.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-append" id="ref-for-list-append⑦">Append</a> a new <a data-link-type="dfn" href="#value-with-size" id="ref-for-value-with-size①">value-with-size</a> with <a data-link-type="dfn" href="#value-with-size-value" id="ref-for-value-with-size-value①">value</a> <var>value</var> and <a data-link-type="dfn" href="#value-with-size-size" id="ref-for-value-with-size-size①">size</a> <var>size</var> to <var>container</var>.[[queue]].</p>
     <li data-md>
      <p>Set <var>container</var>.[[queueTotalSize]] to <var>container</var>.[[queueTotalSize]] + <var>size</var>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="PeekQueueValue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="PeekQueueValue" id="peek-queue-value">PeekQueueValue(<var>container</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>container</var> has [[queue]] and [[queueTotalSize]] internal slots.</p>
     <li data-md>
      <p class="assertion">Assert: <var>container</var>.[[queue]] is not <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list-is-empty" id="ref-for-list-is-empty①⑤">empty</a>.</p>
     <li data-md>
      <p>Let <var>valueWithSize</var> be <var>container</var>.[[queue]][0].</p>
     <li data-md>
      <p>Return <var>valueWithSize</var>’s <a data-link-type="dfn" href="#value-with-size-value" id="ref-for-value-with-size-value②">value</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="ResetQueue">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="ResetQueue" id="reset-queue">ResetQueue(<var>container</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <var>container</var> has [[queue]] and [[queueTotalSize]] internal slots.</p>
     <li data-md>
      <p>Set <var>container</var>.[[queue]] to a new empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#list" id="ref-for-list①⑦">list</a>.</p>
     <li data-md>
      <p>Set <var>container</var>.[[queueTotalSize]] to 0.</p>
    </ol>
   </div>
   <h3 class="heading settled" data-level="8.2" id="transferrable-streams"><span class="secno">8.2. </span><span class="content">Transferable streams</span><a class="self-link" href="#transferrable-streams"></a></h3>
   <p>Transferable streams are implemented using a special kind of identity transform which has the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①②">writable side</a> in one <a data-link-type="dfn" href="https://tc39.es/ecma262/#sec-code-realms" id="ref-for-sec-code-realms">realm</a> and the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①③">readable side</a> in another realm. The following
abstract operations are used to implement these "cross-realm transforms".</p>
   <div class="algorithm" data-algorithm="CrossRealmTransformSendError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="CrossRealmTransformSendError" id="abstract-opdef-crossrealmtransformsenderror">CrossRealmTransformSendError(<var>port</var>, <var>error</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessage" id="ref-for-abstract-opdef-packandpostmessage">PackAndPostMessage</a>(<var>port</var>, "<code>error</code>", <var>error</var>), discarding the result.</p>
    </ol>
    <p class="note" role="note">As we are already in an errored state when this abstract operation is performed, we
 cannot handle further errors, so we just discard them.</p>
   </div>
   <div class="algorithm" data-algorithm="PackAndPostMessage">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="PackAndPostMessage" id="abstract-opdef-packandpostmessage">PackAndPostMessage(<var>port</var>, <var>type</var>, <var>value</var>)</dfn> performs
 the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>message</var> be <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ordinaryobjectcreate" id="ref-for-sec-ordinaryobjectcreate">OrdinaryObjectCreate</a>(null).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createdataproperty" id="ref-for-sec-createdataproperty">CreateDataProperty</a>(<var>message</var>, "<code>type</code>", <var>type</var>).</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-createdataproperty" id="ref-for-sec-createdataproperty①">CreateDataProperty</a>(<var>message</var>, "<code>value</code>", <var>value</var>).</p>
     <li data-md>
      <p>Let <var>targetPort</var> be the port with which <var>port</var> is entangled, if any; otherwise let it be null.</p>
     <li data-md>
      <p>Let <var>options</var> be «[ "<code>transfer</code>" → « » ]».</p>
     <li data-md>
      <p>Run the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#message-port-post-message-steps" id="ref-for-message-port-post-message-steps">message port post message steps</a> providing <var>targetPort</var>, <var>message</var>, and <var>options</var>.</p>
    </ol>
    <p class="note" role="note">A JavaScript object is used for transfer to avoid having to duplicate the <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#message-port-post-message-steps" id="ref-for-message-port-post-message-steps①">message
 port post message steps</a>. The prototype of the object is set to null to avoid interference from <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-properties-of-the-object-prototype-object" id="ref-for-sec-properties-of-the-object-prototype-object">%Object.prototype%</a></code>.</p>
   </div>
   <div class="algorithm" data-algorithm="PackAndPostMessageHandlingError">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="PackAndPostMessageHandlingError" id="abstract-opdef-packandpostmessagehandlingerror">PackAndPostMessageHandlingError(<var>port</var>, <var>type</var>, <var>value</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Let <var>result</var> be <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessage" id="ref-for-abstract-opdef-packandpostmessage①">PackAndPostMessage</a>(<var>port</var>, <var>type</var>, <var>value</var>).</p>
     <li data-md>
      <p>If <var>result</var> is an abrupt completion,</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-crossrealmtransformsenderror" id="ref-for-abstract-opdef-crossrealmtransformsenderror">CrossRealmTransformSendError</a>(<var>port</var>, <var>result</var>.[[Value]]).</p>
      </ol>
     <li data-md>
      <p>Return <var>result</var> as a completion record.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="SetUpCrossRealmTransformReadable">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpCrossRealmTransformReadable" id="abstract-opdef-setupcrossrealmtransformreadable">SetUpCrossRealmTransformReadable(<var>stream</var>, <var>port</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-readable-stream" id="ref-for-initialize-readable-stream②">InitializeReadableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⑧">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①③">ReadableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Add a handler for <var>port</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-message" id="ref-for-event-message">message</a></code> event with the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>data</var> be the data of the message.</p>
       <li data-md>
        <p class="assertion">Assert: <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values">Type</a>(<var>data</var>) is Object.</p>
       <li data-md>
        <p>Let <var>type</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p">Get</a>(<var>data</var>, "<code>type</code>").</p>
       <li data-md>
        <p>Let <var>value</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p①">Get</a>(<var>data</var>, "<code>value</code>").</p>
       <li data-md>
        <p class="assertion">Assert: <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values①">Type</a>(<var>type</var>) is String.</p>
       <li data-md>
        <p>If <var>type</var> is "<code>chunk</code>",</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue④">ReadableStreamDefaultControllerEnqueue</a>(<var>controller</var>, <var>value</var>).</p>
        </ol>
       <li data-md>
        <p>Otherwise, if <var>type</var> is "<code>close</code>",</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close⑤">ReadableStreamDefaultControllerClose</a>(<var>controller</var>).</p>
         <li data-md>
          <p>Disentangle <var>port</var>.</p>
        </ol>
       <li data-md>
        <p>Otherwise, if <var>type</var> is "<code>error</code>",</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error⑧">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>value</var>).</p>
         <li data-md>
          <p>Disentangle <var>port</var>.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Add a handler for <var>port</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-messageerror" id="ref-for-event-messageerror">messageerror</a></code> event with the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>error</var> be a new "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror④">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException⑤">DOMException</a></code>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-crossrealmtransformsenderror" id="ref-for-abstract-opdef-crossrealmtransformsenderror①">CrossRealmTransformSendError</a>(<var>port</var>, <var>error</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error⑨">ReadableStreamDefaultControllerError</a>(<var>controller</var>, <var>error</var>).</p>
       <li data-md>
        <p>Disentangle <var>port</var>.</p>
      </ol>
     <li data-md>
      <p>Enable <var>port</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#port-message-queue" id="ref-for-port-message-queue">port message queue</a>.</p>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>pullAlgorithm</var> be the following steps:</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessage" id="ref-for-abstract-opdef-packandpostmessage②">PackAndPostMessage</a>(<var>port</var>, "<code>pull</code>", undefined).</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⑦">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>cancelAlgorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessagehandlingerror" id="ref-for-abstract-opdef-packandpostmessagehandlingerror">PackAndPostMessageHandlingError</a>(<var>port</var>, "<code>error</code>", <var>reason</var>).</p>
       <li data-md>
        <p>Disentangle <var>port</var>.</p>
       <li data-md>
        <p>If <var>result</var> is an abrupt completion, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③①">a promise rejected with</a> <var>result</var>.[[Value]].</p>
       <li data-md>
        <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⑧">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>sizeAlgorithm</var> be an algorithm that returns 1.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-readable-stream-default-controller" id="ref-for-set-up-readable-stream-default-controller②">SetUpReadableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithm</var>, <var>cancelAlgorithm</var>, 0, <var>sizeAlgorithm</var>).</p>
    </ol>
    <p class="note" role="note">Implementations are encouraged to explicitly handle failures from the asserts in
 this algorithm, as the input might come from an untrusted context. Failure to do so could lead to
 security issues.</p>
   </div>
   <div class="algorithm" data-algorithm="SetUpCrossRealmTransformWritable">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="SetUpCrossRealmTransformWritable" id="abstract-opdef-setupcrossrealmtransformwritable">SetUpCrossRealmTransformWritable(<var>stream</var>, <var>port</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-writable-stream" id="ref-for-initialize-writable-stream②">InitializeWritableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new①⑨">new</a> <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①⑤">WritableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Let <var>backpressurePromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①⑤">a new promise</a>.</p>
     <li data-md>
      <p>Add a handler for <var>port</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-message" id="ref-for-event-message①">message</a></code> event with the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>data</var> be the data of the message.</p>
       <li data-md>
        <p class="assertion">Assert: <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values②">Type</a>(<var>data</var>) is Object.</p>
       <li data-md>
        <p>Let <var>type</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p②">Get</a>(<var>data</var>, "<code>type</code>").</p>
       <li data-md>
        <p>Let <var>value</var> be ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-get-o-p" id="ref-for-sec-get-o-p③">Get</a>(<var>data</var>, "<code>value</code>").</p>
       <li data-md>
        <p class="assertion">Assert: <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values③">Type</a>(<var>type</var>) is String.</p>
       <li data-md>
        <p>If <var>type</var> is "<code>pull</code>",</p>
        <ol>
         <li data-md>
          <p>If <var>backpressurePromise</var> is not undefined,</p>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②②">Resolve</a> <var>backpressurePromise</var> with undefined.</p>
           <li data-md>
            <p>Set <var>backpressurePromise</var> to undefined.</p>
          </ol>
        </ol>
       <li data-md>
        <p>Otherwise, if <var>type</var> is "<code>error</code>",</p>
        <ol>
         <li data-md>
          <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error-if-needed" id="ref-for-writable-stream-default-controller-error-if-needed③">WritableStreamDefaultControllerErrorIfNeeded</a>(<var>controller</var>, <var>value</var>).</p>
         <li data-md>
          <p>If <var>backpressurePromise</var> is not undefined,</p>
          <ol>
           <li data-md>
            <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②③">Resolve</a> <var>backpressurePromise</var> with undefined.</p>
           <li data-md>
            <p>Set <var>backpressurePromise</var> to undefined.</p>
          </ol>
        </ol>
      </ol>
     <li data-md>
      <p>Add a handler for <var>port</var>’s <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/indices.html#event-messageerror" id="ref-for-event-messageerror①">messageerror</a></code> event with the following steps:</p>
      <ol>
       <li data-md>
        <p>Let <var>error</var> be a new "<code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#datacloneerror" id="ref-for-datacloneerror⑤">DataCloneError</a></code>" <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-DOMException" id="ref-for-idl-DOMException⑥">DOMException</a></code>.</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-crossrealmtransformsenderror" id="ref-for-abstract-opdef-crossrealmtransformsenderror②">CrossRealmTransformSendError</a>(<var>port</var>, <var>error</var>).</p>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#writable-stream-default-controller-error-if-needed" id="ref-for-writable-stream-default-controller-error-if-needed④">WritableStreamDefaultControllerErrorIfNeeded</a>(<var>controller</var>, <var>error</var>).</p>
       <li data-md>
        <p>Disentangle <var>port</var>.</p>
      </ol>
     <li data-md>
      <p>Enable <var>port</var>’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/web-messaging.html#port-message-queue" id="ref-for-port-message-queue①">port message queue</a>.</p>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>writeAlgorithm</var> be the following steps, taking a <var>chunk</var> argument:</p>
      <ol>
       <li data-md>
        <p>If <var>backpressurePromise</var> is undefined, set <var>backpressurePromise</var> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with②⑨">a promise resolved with</a> undefined.</p>
       <li data-md>
        <p>Return the result of <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled" id="ref-for-dfn-perform-steps-once-promise-is-settled④">reacting</a> to <var>backpressurePromise</var> with the following
  fulfillment steps:</p>
        <ol>
         <li data-md>
          <p>Set <var>backpressurePromise</var> to <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①⑥">a new promise</a>.</p>
         <li data-md>
          <p>Let <var>result</var> be <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessagehandlingerror" id="ref-for-abstract-opdef-packandpostmessagehandlingerror①">PackAndPostMessageHandlingError</a>(<var>port</var>, "<code>chunk</code>", <var>chunk</var>).</p>
         <li data-md>
          <p>If <var>result</var> is an abrupt completion,</p>
          <ol>
           <li data-md>
            <p>Disentangle <var>port</var>.</p>
           <li data-md>
            <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③②">a promise rejected with</a> <var>result</var>.[[Value]].</p>
          </ol>
         <li data-md>
          <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⓪">a promise resolved with</a> undefined.</p>
        </ol>
      </ol>
     <li data-md>
      <p>Let <var>closeAlgorithm</var> be the folowing steps:</p>
      <ol>
       <li data-md>
        <p>Perform ! <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessage" id="ref-for-abstract-opdef-packandpostmessage③">PackAndPostMessage</a>(<var>port</var>, "<code>close</code>", undefined).</p>
       <li data-md>
        <p>Disentangle <var>port</var>.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③①">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>abortAlgorithm</var> be the following steps, taking a <var>reason</var> argument:</p>
      <ol>
       <li data-md>
        <p>Let <var>result</var> be <a data-link-type="abstract-op" href="#abstract-opdef-packandpostmessagehandlingerror" id="ref-for-abstract-opdef-packandpostmessagehandlingerror②">PackAndPostMessageHandlingError</a>(<var>port</var>, "<code>error</code>", <var>reason</var>).</p>
       <li data-md>
        <p>Disentangle <var>port</var>.</p>
       <li data-md>
        <p>If <var>result</var> is an abrupt completion, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③③">a promise rejected with</a> <var>result</var>.[[Value]].</p>
       <li data-md>
        <p>Otherwise, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③②">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>sizeAlgorithm</var> be an algorithm that returns 1.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-writable-stream-default-controller" id="ref-for-set-up-writable-stream-default-controller②">SetUpWritableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithm</var>, <var>abortAlgorithm</var>, 1, <var>sizeAlgorithm</var>).</p>
    </ol>
    <p class="note" role="note">Implementations are encouraged to explicitly handle failures from the asserts in
 this algorithm, as the input might come from an untrusted context. Failure to do so could lead to
 security issues.</p>
   </div>
   <h3 class="heading settled" data-level="8.3" id="misc-abstract-ops"><span class="secno">8.3. </span><span class="content">Miscellaneous</span><a class="self-link" href="#misc-abstract-ops"></a></h3>
   <p>The following abstract operations are a grab-bag of utilities.</p>
   <div class="algorithm" data-algorithm="IsNonNegativeNumber">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="IsNonNegativeNumber" id="is-non-negative-number">IsNonNegativeNumber(<var>v</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p>If <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values④">Type</a>(<var>v</var>) is not Number, return false.</p>
     <li data-md>
      <p>If <var>v</var> is NaN, return false.</p>
     <li data-md>
      <p>If <var>v</var> &lt; 0, return false.</p>
     <li data-md>
      <p>Return true.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="TransferArrayBuffer">
     <dfn class="dfn-paneled" data-dfn-type="abstract-op" data-export data-lt="TransferArrayBuffer" id="transfer-array-buffer">TransferArrayBuffer(<var>O</var>)</dfn> performs the following steps: 
    <ol>
     <li data-md>
      <p class="assertion">Assert: <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values" id="ref-for-sec-ecmascript-data-types-and-values⑤">Type</a>(<var>O</var>) is Object.</p>
     <li data-md>
      <p class="assertion">Assert: <var>O</var> has an [[ArrayBufferData]] internal slot.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-isdetachedbuffer" id="ref-for-sec-isdetachedbuffer①">IsDetachedBuffer</a>(<var>O</var>) is false.</p>
     <li data-md>
      <p>Let <var>arrayBufferData</var> be <var>O</var>.[[ArrayBufferData]].</p>
     <li data-md>
      <p>Let <var>arrayBufferByteLength</var> be <var>O</var>.[[ArrayBufferByteLength]].</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="https://tc39.es/ecma262/#sec-detacharraybuffer" id="ref-for-sec-detacharraybuffer">DetachArrayBuffer</a>(<var>O</var>).</p>
     <li data-md>
      <p>Return a new <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-arraybuffer-objects" id="ref-for-sec-arraybuffer-objects⑤">ArrayBuffer</a></code> object, created in <a data-link-type="dfn" href="https://tc39.es/ecma262/#current-realm" id="ref-for-current-realm①①">the current Realm</a>, whose
  [[ArrayBufferData]] internal slot value is <var>arrayBufferData</var> and whose
  [[ArrayBufferByteLength]] internal slot value is <var>arrayBufferByteLength</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="9" id="other-specs"><span class="secno">9. </span><span class="content">Using streams in other specifications</span><a class="self-link" href="#other-specs"></a></h2>
   <p>Much of this standard concerns itself with the internal machinery of streams. Other specifications
generally do not need to worry about these details. Instead, they should interface with this
standard via the various IDL types it defines, along with the following definitions.</p>
   <p>Specifications should not directly inspect or manipulate the various internal slots defined in this
standard. Similarly, they should not use the abstract operations defined here. Such direct usage can
break invariants that this standard otherwise maintains.</p>
   <p class="note" role="note">If your specification wants to interface with streams in a way not supported here, <a href="https://github.com/whatwg/streams/issues/new">file an issue</a>. This section is intended
to grow organically as needed. </p>
   <h3 class="heading settled" data-level="9.1" id="other-specs-rs"><span class="secno">9.1. </span><span class="content">Readable streams</span><a class="self-link" href="#other-specs-rs"></a></h3>
   <h4 class="heading settled" data-level="9.1.1" id="other-specs-rs-create"><span class="secno">9.1.1. </span><span class="content">Creation and manipulation</span><a class="self-link" href="#other-specs-rs-create"></a></h4>
   <div class="algorithm" data-algorithm="set up a ReadableStream">
     To <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-set-up">set up</dfn> a newly-<a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⓪">created-via-Web IDL</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream④⑨">ReadableStream</a></code> object <var>stream</var>, given an optional algorithm <dfn data-dfn-for="ReadableStream/set
 up" data-dfn-type="dfn" data-export id="readablestream-set-up-pullalgorithm"><var>pullAlgorithm</var><a class="self-link" href="#readablestream-set-up-pullalgorithm"></a></dfn>, an optional algorithm <dfn class="dfn-paneled" data-dfn-for="ReadableStream/set
 up" data-dfn-type="dfn" data-export id="readablestream-set-up-cancelalgorithm"><var>cancelAlgorithm</var></dfn>, an optional number <dfn data-dfn-for="ReadableStream/set
 up" data-dfn-type="dfn" data-export id="readablestream-set-up-highwatermark"><var>highWaterMark</var><a class="self-link" href="#readablestream-set-up-highwatermark"></a></dfn> (default 1), an optional algorithm <dfn data-dfn-for="ReadableStream/set up" data-dfn-type="dfn" data-export id="readablestream-set-up-sizealgorithm"><var>sizeAlgorithm</var><a class="self-link" href="#readablestream-set-up-sizealgorithm"></a></dfn>, perform the following steps. If given, <var>sizeAlgorithm</var> must be an algorithm accepting <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⑧">chunk</a> objects and returning a number; and if
 given, <var>highWaterMark</var> must be a non-negative, non-NaN number. 
    <ol>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>pullAlgorithmWrapper</var> be an algorithm that runs these steps:</p>
      <ol>
       <li data-md>
        <p>If <var>pullAlgorithm</var> was given, run it.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③③">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>cancelAlgorithmWrapper</var> be an algorithm that runs these steps:</p>
      <ol>
       <li data-md>
        <p>If <var>cancelAlgorithm</var> was given, run it.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③④">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>If <var>sizeAlgorithm</var> was not given, then set it to an algorithm that returns 1.</p>
     <li data-md>
      <p>Perform <a data-link-type="abstract-op" href="#initialize-readable-stream" id="ref-for-initialize-readable-stream③">InitializeReadableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②①">new</a> <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultcontroller" id="ref-for-readablestreamdefaultcontroller①④">ReadableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-readable-stream-default-controller" id="ref-for-set-up-readable-stream-default-controller③">SetUpReadableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>pullAlgorithmWrapper</var>, <var>cancelAlgorithmWrapper</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
    </ol>
    <div class="example" id="example-set-up-rs">
     <a class="self-link" href="#example-set-up-rs"></a> Creating a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⓪">ReadableStream</a></code> from other specifications is thus a two-step process, like so: 
     <ol>
      <li data-md>
       <p>Let <var>readableStream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②②">new</a> <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤①">ReadableStream</a></code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#readablestream-set-up" id="ref-for-readablestream-set-up">Set up</a> <var>readableStream</var> given….</p>
     </ol>
    </div>
    <p class="note" role="note">Subclasses of <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤②">ReadableStream</a></code> will use the <a data-link-type="dfn" href="#readablestream-set-up" id="ref-for-readablestream-set-up①">set up</a> operation
 directly on the <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⑤">this</a> value inside their constructor steps.</p>
   </div>
   <hr>
   <p>The following algorithms must only be used on <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤③">ReadableStream</a></code> instances initialized via the above <a data-link-type="dfn" href="#readablestream-set-up" id="ref-for-readablestream-set-up②">set up</a> algorithm:</p>
   <p class="algorithm" data-algorithm="need more data" data-algorithm-for="ReadableStream">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤④">ReadableStream</a></code> <var>stream</var> <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="need more
data|needs more data" id="readablestream-need-more-data">needs more data<a class="self-link" href="#readablestream-need-more-data"></a></dfn> if <var>stream</var> is <a data-link-type="dfn" href="#readablestream-readable" id="ref-for-readablestream-readable">readable</a> and ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-get-desired-size" id="ref-for-readable-stream-default-controller-get-desired-size③">ReadableStreamDefaultControllerGetDesiredSize</a>(<var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller②⓪">[[controller]]</a>)
returns a positive number. </p>
   <p class="algorithm" data-algorithm="enqueue" data-algorithm-for="ReadableStream">To <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-enqueue">enqueue<a class="self-link" href="#readablestream-enqueue"></a></dfn> the JavaScript value <var>chunk</var> into a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⑤">ReadableStream</a></code> <var>stream</var>, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-enqueue" id="ref-for-readable-stream-default-controller-enqueue⑤">ReadableStreamDefaultControllerEnqueue</a>(<var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller②①">[[controller]]</a>, <var>chunk</var>). </p>
   <p class="algorithm" data-algorithm="close" data-algorithm-for="ReadableStream">To <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-close">close<a class="self-link" href="#readablestream-close"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⑥">ReadableStream</a></code> <var>stream</var>, perform
! <a data-link-type="abstract-op" href="#readable-stream-default-controller-close" id="ref-for-readable-stream-default-controller-close⑥">ReadableStreamDefaultControllerClose</a>(<var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller②②">[[controller]]</a>). </p>
   <p class="algorithm" data-algorithm="error" data-algorithm-for="ReadableStream">To <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-error">error<a class="self-link" href="#readablestream-error"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⑦">ReadableStream</a></code> <var>stream</var> given a
JavaScript value <var>e</var>, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-controller-error" id="ref-for-readable-stream-default-controller-error①⓪">ReadableStreamDefaultControllerError</a>(<var>stream</var>.<a data-link-type="dfn" href="#readablestream-controller" id="ref-for-readablestream-controller②③">[[controller]]</a>, <var>e</var>). </p>
   <h4 class="heading settled" data-level="9.1.2" id="other-specs-rs-reading"><span class="secno">9.1.2. </span><span class="content">Reading</span><a class="self-link" href="#other-specs-rs-reading"></a></h4>
   <p>The following algorithms can be used on arbitrary <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⑧">ReadableStream</a></code> instances, including ones that
are created by web developers. They can all fail in various operation-specific ways, and these
failures should be handled by the calling specification.</p>
   <div class="algorithm" data-algorithm="get a reader" data-algorithm-for="ReadableStream">
    <p>To <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="get a reader|getting a reader" id="readablestream-get-a-reader">get a reader</dfn> for a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑤⑨">ReadableStream</a></code> <var>stream</var>, return ? <a data-link-type="abstract-op" href="#acquire-readable-stream-reader" id="ref-for-acquire-readable-stream-reader⑤">AcquireReadableStreamDefaultReader</a>(<var>stream</var>). The result
 will be a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⑥">ReadableStreamDefaultReader</a></code>. </p>
    <p class="note" role="note">This will throw an exception if <var>stream</var> is already <a data-link-type="dfn" href="#readablestream-locked" id="ref-for-readablestream-locked">locked</a>. </p>
   </div>
   <p class="algorithm" data-algorithm="read a chunk" data-algorithm-for="ReadableStreamDefaultReader">To <dfn data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="dfn" data-export data-lt="read a chunk|reading a chunk" id="readablestreamdefaultreader-read-a-chunk">read
a chunk<a class="self-link" href="#readablestreamdefaultreader-read-a-chunk"></a></dfn> from a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⑦">ReadableStreamDefaultReader</a></code> <var>reader</var>, given a <a data-link-type="dfn" href="#read-request" id="ref-for-read-request④">read request</a> <var>readRequest</var>, perform ! <a data-link-type="abstract-op" href="#readable-stream-default-reader-read" id="ref-for-readable-stream-default-reader-read③">ReadableStreamDefaultReaderRead</a>(<var>reader</var>, <var>readRequest</var>). </p>
   <div class="algorithm" data-algorithm="read all bytes">
    <p>To <dfn data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="dfn" data-export data-lt="read all bytes|reading all bytes" id="readablestreamdefaultreader-read-all-bytes">read all
 bytes<a class="self-link" href="#readablestreamdefaultreader-read-all-bytes"></a></dfn> from a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⑧">ReadableStreamDefaultReader</a></code> <var>reader</var>, perform the following steps. The
 result will be a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②⓪">Promise</a></code> for a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence">byte sequence</a>. </p>
    <ol>
     <li data-md>
      <p>Let <var>promise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-new-promise" id="ref-for-a-new-promise①⑦">a new promise</a>.</p>
     <li data-md>
      <p>Let <var>bytes</var> be an empty <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte-sequence" id="ref-for-byte-sequence①">byte sequence</a>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#read-loop" id="ref-for-read-loop">Read-loop</a> given <var>reader</var>, <var>bytes</var>, and <var>promise</var>.</p>
     <li data-md>
      <p>Return <var>promise</var>.</p>
    </ol>
    <div class="algorithm" data-algorithm="read-loop">
      For the purposes of the above algorithm, to <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport id="read-loop">read-loop</dfn> given <var>reader</var>, <var>bytes</var>, and <var>promise</var>: 
     <ol>
      <li data-md>
       <p>Let <var>readRequest</var> be a new <a data-link-type="dfn" href="#read-request" id="ref-for-read-request⑤">read request</a> with the following <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#struct-item" id="ref-for-struct-item①⓪">items</a>:</p>
       <dl>
        <dt data-md><a data-link-type="dfn" href="#read-request-chunk-steps" id="ref-for-read-request-chunk-steps⑥">chunk steps</a>, given <var>chunk</var>
        <dd data-md>
         <ol>
          <li data-md>
           <p>If <var>chunk</var> is not a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-typedarray-objects" id="ref-for-sec-typedarray-objects⑦">Uint8Array</a></code> object, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①⑥">reject</a> <var>promise</var> with a <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror" id="ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑧">TypeError</a></code> and
  abort these steps.</p>
          <li data-md>
           <p>Append the bytes represented by <var>chunk</var> to <var>bytes</var>.</p>
          <li data-md>
           <p><a data-link-type="dfn" href="#read-loop" id="ref-for-read-loop①">Read-loop</a> given <var>reader</var>, <var>bytes</var>, and <var>promise</var>.</p>
           <p class="note" role="note">This recursion could potentially cause a stack overflow if implemented
  directly. Implementations will need to mitigate this, e.g. by using a non-recursive variant
  of this algorithm, or <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask" id="ref-for-queue-a-microtask①">queuing a microtask</a>, or using a more direct
  method of byte-reading as noted below. </p>
         </ol>
        <dt data-md><a data-link-type="dfn" href="#read-request-close-steps" id="ref-for-read-request-close-steps⑥">close steps</a>
        <dd data-md>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#resolve" id="ref-for-resolve②④">Resolve</a> <var>promise</var> with <var>bytes</var>.</p>
         </ol>
        <dt data-md><a data-link-type="dfn" href="#read-request-error-steps" id="ref-for-read-request-error-steps⑥">error steps</a>, given <var>e</var>
        <dd data-md>
         <ol>
          <li data-md>
           <p><a data-link-type="dfn" href="https://heycam.github.io/webidl/#reject" id="ref-for-reject①⑦">Reject</a> <var>promise</var> with <var>e</var>.</p>
         </ol>
       </dl>
      <li data-md>
       <p>Perform ! <a data-link-type="abstract-op" href="#readable-stream-default-reader-read" id="ref-for-readable-stream-default-reader-read④">ReadableStreamDefaultReaderRead</a>(<var>reader</var>, <var>readRequest</var>).</p>
     </ol>
    </div>
    <p class="note" role="note">Because <var>reader</var> grants exclusive access to its corresponding <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥⓪">ReadableStream</a></code>,
 the actual mechanism of how to read cannot be observed. Implementations could use a more direct
 mechanism if convenient. </p>
   </div>
   <p class="algorithm" data-algorithm="release" data-algorithm-for="ReadableStreamDefaultReader">To <dfn data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="dfn" data-export id="readablestreamdefaultreader-release">release<a class="self-link" href="#readablestreamdefaultreader-release"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader①⑨">ReadableStreamDefaultReader</a></code> <var>reader</var>, perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-release" id="ref-for-readable-stream-reader-generic-release⑦">ReadableStreamReaderGenericRelease</a>(<var>reader</var>). </p>
   <p class="algorithm" data-algorithm="cancel" data-algorithm-for="ReadableStreamDefaultReader">To <dfn data-dfn-for="ReadableStreamDefaultReader" data-dfn-type="dfn" data-export id="readablestreamdefaultreader-cancel">cancel<a class="self-link" href="#readablestreamdefaultreader-cancel"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#readablestreamdefaultreader" id="ref-for-readablestreamdefaultreader②⓪">ReadableStreamDefaultReader</a></code> <var>reader</var> with <var>reason</var>, perform ! <a data-link-type="abstract-op" href="#readable-stream-reader-generic-cancel" id="ref-for-readable-stream-reader-generic-cancel②">ReadableStreamReaderGenericCancel</a>(<var>reader</var>, <var>reason</var>). The return value will be a promise
that either fulfills with undefined, or rejects with a failure reason. </p>
   <p class="algorithm" data-algorithm="cancel" data-algorithm-for="ReadableStream">To <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-cancel">cancel<a class="self-link" href="#readablestream-cancel"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥①">ReadableStream</a></code> <var>stream</var> with <var>reason</var>, return ! <a data-link-type="abstract-op" href="#readable-stream-cancel" id="ref-for-readable-stream-cancel⑦">ReadableStreamCancel</a>(<var>stream</var>, <var>reason</var>). The return value will be a promise
that either fulfills with undefined, or rejects with a failure reason. </p>
   <div class="algorithm" data-algorithm="tee" data-algorithm-for="ReadableStream">
    <p>To <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="tee|teeing" id="readablestream-tee">tee</dfn> a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥②">ReadableStream</a></code> <var>stream</var>,
 return ? <a data-link-type="abstract-op" href="#readable-stream-tee" id="ref-for-readable-stream-tee①">ReadableStreamTee</a>(<var>stream</var>, true). </p>
    <p class="note" role="note">Because we pass true as the second argument to <a data-link-type="abstract-op" href="#readable-stream-tee" id="ref-for-readable-stream-tee②">ReadableStreamTee</a>, the second
 branch returned will have its <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑦⑨">chunks</a> cloned (using HTML’s <a data-link-type="dfn" href="https://html.spec.whatwg.org/multipage/structured-data.html#serializable-objects" id="ref-for-serializable-objects①">serializable objects</a> framework)
 from those of the first branch. This prevents consumption of one of the branches from interfering
 with the other. </p>
   </div>
   <h4 class="heading settled" data-level="9.1.3" id="other-specs-rs-introspect"><span class="secno">9.1.3. </span><span class="content">Introspection</span><a class="self-link" href="#other-specs-rs-introspect"></a></h4>
   <p>The following predicates can be used on arbitrary <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥③">ReadableStream</a></code> objects. However, note that
apart from checking whether or not the stream is <a data-link-type="dfn" href="#readablestream-locked" id="ref-for-readablestream-locked①">locked</a>, this direct
introspection is not possible via the public JavaScript API, and so specifications should instead
use the algorithms in <a href="#other-specs-rs-reading">§ 9.1.2 Reading</a>. (For example, instead of testing if the stream is <a data-link-type="dfn" href="#readablestream-readable" id="ref-for-readablestream-readable①">readable</a>, attempt to <a data-link-type="dfn" href="#readablestream-get-a-reader" id="ref-for-readablestream-get-a-reader">get a reader</a> and handle any exception.)</p>
   <p class="algorithm" data-algorithm="readable" data-algorithm-for="ReadableStream">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥④">ReadableStream</a></code> <var>stream</var> is <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-readable">readable</dfn> if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③⑥">[[state]]</a> is "<code>readable</code>". </p>
   <p class="algorithm" data-algorithm="closed" data-algorithm-for="ReadableStream">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥⑤">ReadableStream</a></code> <var>stream</var> is <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-closed">closed<a class="self-link" href="#readablestream-closed"></a></dfn> if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③⑦">[[state]]</a> is "<code>closed</code>". </p>
   <p class="algorithm" data-algorithm="errored" data-algorithm-for="ReadableStream">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥⑥">ReadableStream</a></code> <var>stream</var> is <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-errored">errored<a class="self-link" href="#readablestream-errored"></a></dfn> if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-state" id="ref-for-readablestream-state③⑧">[[state]]</a> is "<code>errored</code>". </p>
   <p class="algorithm" data-algorithm="ReadableStream locked">A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥⑦">ReadableStream</a></code> <var>stream</var> is <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="readablestream-locked">locked</dfn> if ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①②">IsReadableStreamLocked</a>(<var>stream</var>) returns true. </p>
   <div class="algorithm" data-algorithm="disturbed" data-algorithm-for="ReadableStream">
    <p>A <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑥⑧">ReadableStream</a></code> <var>stream</var> is <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export id="is-readable-stream-disturbed">disturbed</dfn> if <var>stream</var>.<a data-link-type="dfn" href="#readablestream-disturbed" id="ref-for-readablestream-disturbed⑤">[[disturbed]]</a> is
 true. </p>
    <p class="note" role="note">This indicates whether the stream has ever been read from or canceled. Even more so
 than other predicates in this section, it is best consulted sparingly, since this is not
 information web developers have access to even indirectly. As such, branching platform behavior on
 it is undesirable. </p>
   </div>
   <h3 class="heading settled" data-level="9.2" id="other-specs-ws"><span class="secno">9.2. </span><span class="content">Writable streams</span><a class="self-link" href="#other-specs-ws"></a></h3>
   <h4 class="heading settled" data-level="9.2.1" id="other-specs-ws-creation"><span class="secno">9.2.1. </span><span class="content">Creation</span><a class="self-link" href="#other-specs-ws-creation"></a></h4>
   <div class="algorithm" data-algorithm="set up a WritableStream">
     To <dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-export id="writablestream-set-up">set up</dfn> a newly-<a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②③">created-via-Web IDL</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③③">WritableStream</a></code> object <var>stream</var>, given an algorithm <dfn data-dfn-for="WritableStream/set
 up" data-dfn-type="dfn" data-export id="writablestream-set-up-writealgorithm"><var>writeAlgorithm</var><a class="self-link" href="#writablestream-set-up-writealgorithm"></a></dfn>, an optional algorithm <dfn data-dfn-for="WritableStream/set
 up" data-dfn-type="dfn" data-export id="writablestream-set-up-closealgorithm"><var>closeAlgorithm</var><a class="self-link" href="#writablestream-set-up-closealgorithm"></a></dfn>, an optional algorithm <dfn data-dfn-for="WritableStream/set
 up" data-dfn-type="dfn" data-export id="writablestream-set-up-abortalgorithm"><var>abortAlgorithm</var><a class="self-link" href="#writablestream-set-up-abortalgorithm"></a></dfn>, an optional number <dfn data-dfn-for="WritableStream/set
 up" data-dfn-type="dfn" data-export id="writablestream-set-up-highwatermark"><var>highWaterMark</var><a class="self-link" href="#writablestream-set-up-highwatermark"></a></dfn> (default 1), an optional algorithm <dfn data-dfn-for="WritableStream/set up" data-dfn-type="dfn" data-export id="writablestream-set-up-sizealgorithm"><var>sizeAlgorithm</var><a class="self-link" href="#writablestream-set-up-sizealgorithm"></a></dfn>, perform the following steps. <var>writeAlgorithm</var> must be an algorithm that accepts a <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧⓪">chunk</a> object and returns a promise. If
 given, <var>closeAlgorithm</var> and <var>abortAlgorithm</var> must return a promise. If given, <var>sizeAlgorithm</var> must
 be an algorithm accepting <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧①">chunk</a> objects and returning a number; and if given, <var>highWaterMark</var> must be a non-negative, non-NaN number. 
    <ol>
     <li data-md>
      <p>Let <var>startAlgorithm</var> be an algorithm that returns undefined.</p>
     <li data-md>
      <p>Let <var>closeAlgorithmWrapper</var> be an algorithm that runs these steps:</p>
      <ol>
       <li data-md>
        <p>If <var>closeAlgorithm</var> was given, return the result of running it.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⑤">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>abortAlgorithmWrapper</var> be an algorithm that runs these steps:</p>
      <ol>
       <li data-md>
        <p>If <var>abortAlgorithm</var> was given, return the result of running it.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⑥">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>If <var>sizeAlgorithm</var> was not given, then set it to an algorithm that returns 1.</p>
     <li data-md>
      <p>Perform <a data-link-type="abstract-op" href="#initialize-writable-stream" id="ref-for-initialize-writable-stream③">InitializeWritableStream</a>(<var>stream</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②④">new</a> <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultcontroller" id="ref-for-writablestreamdefaultcontroller①⑥">WritableStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-writable-stream-default-controller" id="ref-for-set-up-writable-stream-default-controller③">SetUpWritableStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>startAlgorithm</var>, <var>writeAlgorithm</var>, <var>closeAlgorithmWrapper</var>, <var>abortAlgorithmWrapper</var>, <var>highWaterMark</var>, <var>sizeAlgorithm</var>).</p>
    </ol>
    <div class="example" id="example-set-up-ws">
     <a class="self-link" href="#example-set-up-ws"></a> Creating a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③④">WritableStream</a></code> from other specifications is thus a two-step process, like so: 
     <ol>
      <li data-md>
       <p>Let <var>writableStream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⑤">new</a> <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⑤">WritableStream</a></code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#writablestream-set-up" id="ref-for-writablestream-set-up">Set up</a> <var>writableStream</var> given….</p>
     </ol>
    </div>
    <p class="note" role="note">Subclasses of <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⑥">WritableStream</a></code> will use the <a data-link-type="dfn" href="#writablestream-set-up" id="ref-for-writablestream-set-up①">set up</a> operation
 directly on the <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⑥">this</a> value inside their constructor steps.</p>
   </div>
   <h4 class="heading settled" data-level="9.2.2" id="other-specs-ws-writing"><span class="secno">9.2.2. </span><span class="content">Writing</span><a class="self-link" href="#other-specs-ws-writing"></a></h4>
   <p>The following algorithms can be used on arbitrary <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⑦">WritableStream</a></code> instances, including ones that
are created by web developers. They can all fail in various operation-specific ways, and these
failures should be handled by the calling specification.</p>
   <div class="algorithm" data-algorithm="get a writer" data-algorithm-for="WritableStream">
    <p>To <dfn data-dfn-for="WritableStream" data-dfn-type="dfn" data-export data-lt="get a writer|getting a writer" id="writablestream-get-a-writer">get a writer<a class="self-link" href="#writablestream-get-a-writer"></a></dfn> for a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⑧">WritableStream</a></code> <var>stream</var>, return ? <a data-link-type="abstract-op" href="#acquire-writable-stream-default-writer" id="ref-for-acquire-writable-stream-default-writer②">AcquireWritableStreamDefaultWriter</a>(<var>stream</var>). The result
 will be a <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter①①">WritableStreamDefaultWriter</a></code>. </p>
    <p class="note" role="note">This will throw an exception if <var>stream</var> is already locked. </p>
   </div>
   <p class="algorithm" data-algorithm="write a chunk" data-algorithm-for="WritableStreamDefaultWriter">To <dfn data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="dfn" data-export data-lt="write a chunk|writing a
chunk" id="writablestreamdefaultwriter-write-a-chunk">write a chunk<a class="self-link" href="#writablestreamdefaultwriter-write-a-chunk"></a></dfn> to a <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter①②">WritableStreamDefaultWriter</a></code> <var>writer</var>, given a value <var>chunk</var>,
return ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-write" id="ref-for-writable-stream-default-writer-write①">WritableStreamDefaultWriterWrite</a>(<var>writer</var>, <var>chunk</var>). </p>
   <p class="algorithm" data-algorithm="release" data-algorithm-for="WritableStreamDefaultWriter">To <dfn data-dfn-for="WritableStreamDefaultWriter" data-dfn-type="dfn" data-export id="writablestreamdefaultwriter-release">release<a class="self-link" href="#writablestreamdefaultwriter-release"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#writablestreamdefaultwriter" id="ref-for-writablestreamdefaultwriter①③">WritableStreamDefaultWriter</a></code> <var>writer</var>, perform ! <a data-link-type="abstract-op" href="#writable-stream-default-writer-release" id="ref-for-writable-stream-default-writer-release②">WritableStreamDefaultWriterRelease</a>(<var>writer</var>). </p>
   <p class="algorithm" data-algorithm="close" data-algorithm-for="WritableStream">To <dfn class="dfn-paneled" data-dfn-for="WritableStream" data-dfn-type="dfn" data-export data-lt="close|closing" id="writablestream-close">close</dfn> a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream③⑨">WritableStream</a></code> <var>stream</var>, return ! <a data-link-type="abstract-op" href="#writable-stream-close" id="ref-for-writable-stream-close②">WritableStreamClose</a>(<var>stream</var>). The return value will be a promise that either
fulfills with undefined, or rejects with a failure reason. </p>
   <p class="algorithm" data-algorithm="abort" data-algorithm-for="WritableStream">To <dfn data-dfn-for="WritableStream" data-dfn-type="dfn" data-export data-lt="abort|aborting" id="writablestream-abort">abort<a class="self-link" href="#writablestream-abort"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream④⓪">WritableStream</a></code> <var>stream</var> with <var>reason</var>, return ! <a data-link-type="abstract-op" href="#writable-stream-abort" id="ref-for-writable-stream-abort⑦">WritableStreamAbort</a>(<var>stream</var>, <var>reason</var>). The
return value will be a promise that either fulfills with undefined, or rejects with a failure
reason. </p>
   <h3 class="heading settled" data-level="9.3" id="other-specs-ts"><span class="secno">9.3. </span><span class="content">Transform streams</span><a class="self-link" href="#other-specs-ts"></a></h3>
   <h4 class="heading settled" data-level="9.3.1" id="other-specs-ts-creation"><span class="secno">9.3.1. </span><span class="content">Creation and manipulation</span><a class="self-link" href="#other-specs-ts-creation"></a></h4>
   <div class="algorithm" data-algorithm="create a TransformStream">
     To <dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-export data-lt="set up|setting up" id="transformstream-set-up">set up</dfn> a
 newly-<a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⑥">created-via-Web IDL</a> <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⑧">TransformStream</a></code> <var>stream</var> given an algorithm <dfn class="dfn-paneled" data-dfn-for="TransformStream/set up" data-dfn-type="dfn" data-export id="transformstream-set-up-transformalgorithm"><var>transformAlgorithm</var></dfn> and an optional algorithm <dfn class="dfn-paneled" data-dfn-for="TransformStream/set up" data-dfn-type="dfn" data-export id="transformstream-set-up-flushalgorithm"><var>flushAlgorithm</var></dfn>: 
    <ol>
     <li data-md>
      <p>Let <var>writableHighWaterMark</var> be 1.</p>
     <li data-md>
      <p>Let <var>writableSizeAlgorithm</var> be an algorithm that returns 1.</p>
     <li data-md>
      <p>Let <var>readableHighWaterMark</var> be 0.</p>
     <li data-md>
      <p>Let <var>readableSizeAlgorithm</var> be an algorithm that returns 1.</p>
     <li data-md>
      <p>Let <var>transformAlgorithmWrapper</var> be an algorithm that runs these steps given a value <var>chunk</var>:</p>
      <ol>
       <li data-md>
        <p>Run <var>transformAlgorithm</var> given <var>chunk</var>. If this throws an exception <var>e</var>, return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-rejected-with" id="ref-for-a-promise-rejected-with③④">a promise
  rejected with</a> <var>e</var>.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⑦">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>flushAlgorithmWrapper</var> be an algorithm that runs these steps:</p>
      <ol>
       <li data-md>
        <p>If <var>flushAlgorithm</var> was given, run it.</p>
       <li data-md>
        <p>Return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⑧">a promise resolved with</a> undefined.</p>
      </ol>
     <li data-md>
      <p>Let <var>startPromise</var> be <a data-link-type="dfn" href="https://heycam.github.io/webidl/#a-promise-resolved-with" id="ref-for-a-promise-resolved-with③⑨">a promise resolved with</a> undefined.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#initialize-transform-stream" id="ref-for-initialize-transform-stream①">InitializeTransformStream</a>(<var>stream</var>, <var>startPromise</var>, <var>writableHighWaterMark</var>, <var>writableSizeAlgorithm</var>, <var>readableHighWaterMark</var>, <var>readableSizeAlgorithm</var>).</p>
     <li data-md>
      <p>Let <var>controller</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⑦">new</a> <code class="idl"><a data-link-type="idl" href="#transformstreamdefaultcontroller" id="ref-for-transformstreamdefaultcontroller①②">TransformStreamDefaultController</a></code>.</p>
     <li data-md>
      <p>Perform ! <a data-link-type="abstract-op" href="#set-up-transform-stream-default-controller" id="ref-for-set-up-transform-stream-default-controller①">SetUpTransformStreamDefaultController</a>(<var>stream</var>, <var>controller</var>, <var>transformAlgorithmWrapper</var>, <var>flushAlgorithmWrapper</var>).</p>
    </ol>
    <div class="example" id="example-set-up-ts">
     <a class="self-link" href="#example-set-up-ts"></a> Creating a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream①⑨">TransformStream</a></code> from other specifications is thus a two-step process, like so: 
     <ol>
      <li data-md>
       <p>Let <var>transformStream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⑧">new</a> <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⓪">TransformStream</a></code>.</p>
      <li data-md>
       <p><a data-link-type="dfn" href="#transformstream-set-up" id="ref-for-transformstream-set-up">Set up</a> <var>transformStream</var> given….</p>
     </ol>
    </div>
    <p class="note" role="note">Subclasses of <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②①">TransformStream</a></code> will use the <a data-link-type="dfn" href="#transformstream-set-up" id="ref-for-transformstream-set-up①">set up</a> operation
 directly on the <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⑦">this</a> value inside their constructor steps.</p>
   </div>
   <div class="algorithm" data-algorithm="create an identity TransformStream">
     To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export data-lt="create an identity TransformStream|creating an identity TransformStream" id="create-an-identity-transformstream">create
 an identity <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②②">TransformStream</a></code></dfn>: 
    <ol>
     <li data-md>
      <p>Let <var>transformStream</var> be a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new②⑨">new</a> <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②③">TransformStream</a></code>.</p>
     <li data-md>
      <p><a data-link-type="dfn" href="#transformstream-set-up" id="ref-for-transformstream-set-up②">Set up</a> <var>transformStream</var> with <var><a data-link-type="dfn" href="#transformstream-set-up-transformalgorithm" id="ref-for-transformstream-set-up-transformalgorithm">transformAlgorithm</a></var> set to an algorithm which, given <var>chunk</var>, <a data-link-type="dfn" href="#transformstream-enqueue" id="ref-for-transformstream-enqueue">enqueues</a> <var>chunk</var> in <var>transformStream</var>.</p>
     <li data-md>
      <p>Return <var>transformStream</var>.</p>
    </ol>
   </div>
   <hr>
   <p>The following algorithms must only be used on <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②④">TransformStream</a></code> instances initialized via the
above <a data-link-type="dfn" href="#transformstream-set-up" id="ref-for-transformstream-set-up③">set up</a> algorithm. Usually they are called as part of <var><a data-link-type="dfn" href="#transformstream-set-up-transformalgorithm" id="ref-for-transformstream-set-up-transformalgorithm①">transformAlgorithm</a></var> or <var><a data-link-type="dfn" href="#transformstream-set-up-flushalgorithm" id="ref-for-transformstream-set-up-flushalgorithm">flushAlgorithm</a></var>.</p>
   <p class="algorithm" data-algorithm="enqueue" data-algorithm-for="TransformStream">To <dfn class="dfn-paneled" data-dfn-for="TransformStream" data-dfn-type="dfn" data-export id="transformstream-enqueue">enqueue</dfn> the JavaScript value <var>chunk</var> into a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⑤">TransformStream</a></code> <var>stream</var>, perform ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-enqueue" id="ref-for-transform-stream-default-controller-enqueue②">TransformStreamDefaultControllerEnqueue</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller⑨">[[controller]]</a>, <var>chunk</var>). </p>
   <p class="algorithm" data-algorithm="terminate" data-algorithm-for="TransformStream">To <dfn data-dfn-for="TransformStream" data-dfn-type="dfn" data-export id="transformstream-terminate">terminate<a class="self-link" href="#transformstream-terminate"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⑥">TransformStream</a></code> <var>stream</var>,
perform ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-terminate" id="ref-for-transform-stream-default-controller-terminate①">TransformStreamDefaultControllerTerminate</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller①⓪">[[controller]]</a>). </p>
   <p class="algorithm" data-algorithm="error" data-algorithm-for="TransformStream">To <dfn data-dfn-for="TransformStream" data-dfn-type="dfn" data-export id="transformstream-error">error<a class="self-link" href="#transformstream-error"></a></dfn> a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⑦">TransformStream</a></code> <var>stream</var> given a
JavaScript value <var>e</var>, perform ! <a data-link-type="abstract-op" href="#transform-stream-default-controller-error" id="ref-for-transform-stream-default-controller-error①">TransformStreamDefaultControllerError</a>(<var>stream</var>.<a data-link-type="dfn" href="#transformstream-controller" id="ref-for-transformstream-controller①①">[[controller]]</a>, <var>e</var>). </p>
   <h4 class="heading settled" data-level="9.3.2" id="other-specs-ts-wrapping"><span class="secno">9.3.2. </span><span class="content">Wrapping into a custom class</span><a class="self-link" href="#other-specs-ts-wrapping"></a></h4>
   <p>Other specifications which mean to define custom <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream⑤">transform streams</a> might not want to subclass
from the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⑧">TransformStream</a></code> interface directly. Instead, if they need a new class, they can create
their own independent Web IDL interfaces, and use the following mixin:</p>
<pre class="idl highlight def"><c- b>interface</c-> <c- b>mixin</c-> <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export id="generictransformstream"><code><c- g>GenericTransformStream</c-></code></dfn> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestream" id="ref-for-readablestream⑥⑨"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-generictransformstream-readable" id="ref-for-dom-generictransformstream-readable"><c- g>readable</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#writablestream" id="ref-for-writablestream④①"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-generictransformstream-writable" id="ref-for-dom-generictransformstream-writable"><c- g>writable</c-></a>;
};
</pre>
   <p>Any <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-platform-object" id="ref-for-dfn-platform-object①">platform object</a> that <a data-link-type="dfn" href="https://heycam.github.io/webidl/#include" id="ref-for-include">includes</a> the <code class="idl"><a data-link-type="idl" href="#generictransformstream" id="ref-for-generictransformstream①">GenericTransformStream</a></code> mixin has an associated <dfn class="dfn-paneled" data-dfn-for="GenericTransformStream" data-dfn-type="dfn" data-export id="generictransformstream-transform">transform</dfn>, which is an actual <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream②⑨">TransformStream</a></code>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="GenericTransformStream" data-dfn-type="attribute" data-export id="dom-generictransformstream-readable"><code>readable</code></dfn> getter steps are to return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⑧">this</a>'s <a data-link-type="dfn" href="#generictransformstream-transform" id="ref-for-generictransformstream-transform">transform</a>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable①②">[[readable]]</a>.</p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="GenericTransformStream" data-dfn-type="attribute" data-export id="dom-generictransformstream-writable"><code>writable</code></dfn> getter steps are to return <a data-link-type="dfn" href="https://heycam.github.io/webidl/#this" id="ref-for-this①②⑨">this</a>'s <a data-link-type="dfn" href="#generictransformstream-transform" id="ref-for-generictransformstream-transform①">transform</a>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable⑧">[[writable]]</a>.</p>
   <hr>
   <p>Including the <code class="idl"><a data-link-type="idl" href="#generictransformstream" id="ref-for-generictransformstream②">GenericTransformStream</a></code> mixin will give an IDL interface the appropriate <code class="idl"><a data-link-type="idl" href="#dom-generictransformstream-readable" id="ref-for-dom-generictransformstream-readable①">readable</a></code> and <code class="idl"><a data-link-type="idl" href="#dom-generictransformstream-writable" id="ref-for-dom-generictransformstream-writable①">writable</a></code> properties. To customize
the behavior of the resulting interface, its constructor (or other initialization code) must set
each instance’s <a data-link-type="dfn" href="#generictransformstream-transform" id="ref-for-generictransformstream-transform②">transform</a> to a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#new" id="ref-for-new③⓪">new</a> <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③⓪">TransformStream</a></code>, and then <a data-link-type="dfn" href="#transformstream-set-up" id="ref-for-transformstream-set-up④">set it up</a> with appropriate customizations via the <var><a data-link-type="dfn" href="#transformstream-set-up-transformalgorithm" id="ref-for-transformstream-set-up-transformalgorithm②">transformAlgorithm</a></var> and optionally <var><a data-link-type="dfn" href="#transformstream-set-up-flushalgorithm" id="ref-for-transformstream-set-up-flushalgorithm①">flushAlgorithm</a></var> arguments.</p>
   <p>Existing examples of this pattern on the web platform include <code class="idl"><a data-link-type="idl" href="https://wicg.github.io/compression/#compressionstream" id="ref-for-compressionstream">CompressionStream</a></code> and <code class="idl"><a data-link-type="idl" href="https://encoding.spec.whatwg.org/#textdecoderstream" id="ref-for-textdecoderstream">TextDecoderStream</a></code>. <a data-link-type="biblio" href="#biblio-compression" title="Compression Streams">[COMPRESSION]</a> <a data-link-type="biblio" href="#biblio-encoding" title="Encoding Standard">[ENCODING]</a></p>
   <p class="note" role="note">There’s no need to create a wrapper class if you don’t need any API beyond what the
base <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③①">TransformStream</a></code> class provides. The most common driver for such a wrapper is needing a
custom <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-constructors" id="ref-for-idl-constructors">constructor operation</a>, but if your conceptual transform stream isn’t meant to be
constructed, then using <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③②">TransformStream</a></code> directly is fine. </p>
   <h3 class="heading settled" data-level="9.4" id="other-specs-pairs"><span class="secno">9.4. </span><span class="content">Other stream pairs</span><a class="self-link" href="#other-specs-pairs"></a></h3>
   <p>Apart from <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream⑥">transform streams</a>, discussed above, specifications often create pairs of <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream①⑨">readable</a> and <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①③">writable</a> streams. This section gives some guidance for
such situations.</p>
   <p>In all such cases, specifications should use the names <code>readable</code> and <code>writable</code> for the two
properties exposing the streams in question. They should not use other names (such as <code>input</code>/<code>output</code> or <code>readableStream</code>/<code>writableStream</code>), and they should not use methods or other
non-property means of access to the streams.</p>
   <h4 class="heading settled" data-level="9.4.1" id="other-specs-duplex"><span class="secno">9.4.1. </span><span class="content">Duplex streams</span><a class="self-link" href="#other-specs-duplex"></a></h4>
   <p>The most common readable/writable pair is a <dfn data-dfn-type="dfn" data-export id="duplex-stream">duplex stream<a class="self-link" href="#duplex-stream"></a></dfn>, where the readable and
writable streams represent two sides of a single shared resource, such as a socket, connection, or
device.</p>
   <p>The trickiest thing to consider when specifying duplex streams is how to handle operations like <a data-link-type="dfn" href="#cancel-a-readable-stream" id="ref-for-cancel-a-readable-stream①⓪">canceling</a> the readable side, or closing or <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream⑥">aborting</a> the writable side. It might make sense to leave duplex streams "half open", with
such operations one one side not impacting the other side. Or it might be best to carry over their
effects to the other side, e.g. by specifying that your readable side’s <var><a data-link-type="dfn" href="#readablestream-set-up-cancelalgorithm" id="ref-for-readablestream-set-up-cancelalgorithm">cancelAlgorithm</a></var> will <a data-link-type="dfn" href="#writablestream-close" id="ref-for-writablestream-close">close</a> the
writable side.</p>
   <p class="example" id="example-basic-duplex"><a class="self-link" href="#example-basic-duplex"></a>A basic example of a duplex stream, created through
JavaScript instead of through specification prose, is found in <a href="#example-both">§ 10.8 A { readable, writable } stream pair wrapping the same underlying
resource</a>. It illustrates
this carry-over behavior. </p>
   <p>Another consideration is how to handle the creation of duplex streams which need to be acquired
asynchronously, e.g. via establishing a connection. The preferred pattern here is to have a
constructible class with a promise-returning property that fulfills with the actual duplex stream
object. That duplex stream object can also then expose any information that is only available
asynchronously, e.g. connection data. The container class can then provide convenience APIs, such as
a function to close the entire connection instead of only closing individual sides.</p>
   <p class="example" id="example-duplex-with-container"><a class="self-link" href="#example-duplex-with-container"></a>An example of this more complex type of duplex
stream is the still-being-specified <code>WebSocketStream</code>. See its <a href="https://github.com/ricea/websocketstream-explainer/blob/master/README.md">explainer</a> and <a href="https://docs.google.com/document/d/1La1ehXw76HP6n1uUeks-WJGFgAnpX2tCjKts7QFJ57Y/edit#">design
notes</a>. </p>
   <p>Because duplex streams obey the <code>readable</code>/<code>writable</code> property contract, they can be used with <code class="idl"><a data-link-type="idl" href="#rs-pipe-through" id="ref-for-rs-pipe-through④">pipeThrough()</a></code>. This doesn’t always make sense, but it could in cases where the
underlying resource is in fact performing some sort of transformation.</p>
   <p class="example" id="example-duplex-pipethrough"><a class="self-link" href="#example-duplex-pipethrough"></a>For an arbitrary WebSocket, piping through a
WebSocket-derived duplex stream doesn’t make sense. However, if the WebSocket server is specifically
written so that it responds to incoming messages by sending the same data back in some transformed
form, then this could be useful and convenient. </p>
   <h4 class="heading settled" data-level="9.4.2" id="other-specs-endpoints"><span class="secno">9.4.2. </span><span class="content">Endpoint pairs</span><a class="self-link" href="#other-specs-endpoints"></a></h4>
   <p>Another type of readable/writable pair is an <dfn data-dfn-type="dfn" data-export id="endpoint-pair">endpoint pair<a class="self-link" href="#endpoint-pair"></a></dfn>. In these cases the
readable and writable streams represent the two ends of a longer pipeline, with the intention that
web developer code insert <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream⑦">transform streams</a> into the middle of them.</p>
   <div class="example" id="example-endpoint-pair-usage">
    <a class="self-link" href="#example-endpoint-pair-usage"></a> Assuming we had a web-platform-provided function <code>createEndpointPair()</code>, web developers would write
 code like so: 
<pre class="highlight"><c- a>const</c-> <c- p>{</c-> readable<c- p>,</c-> writable <c- p>}</c-> <c- o>=</c-> createEndpointPair<c- p>();</c->
readable<c- p>.</c->pipeThrough<c- p>(</c-><c- ow>new</c-> TransformStream<c- p>(...)).</c->pipeTo<c- p>(</c->writable<c- p>);</c->
</pre>
   </div>
   <p class="example" id="example-endpoint-pair-webrtc"><a class="self-link" href="#example-endpoint-pair-webrtc"></a><cite>WebRTC Insertable Media using
Streams</cite> is an example of this technique, with its <code>sender.createEncodedStreams()</code> and <code>receiver.createEncodedStreams()</code> methods. </p>
   <p>Despite such endpoint pairs obeying the <code>readable</code>/<code>writable</code> property contract, it never makes
sense to pass them to <code class="idl"><a data-link-type="idl" href="#rs-pipe-through" id="ref-for-rs-pipe-through⑤">pipeThrough()</a></code>.</p>
   <h3 class="heading settled" data-level="9.5" id="other-specs-piping"><span class="secno">9.5. </span><span class="content">Piping</span><a class="self-link" href="#other-specs-piping"></a></h3>
   <div class="algorithm" data-algorithm="ReadableStream pipe to">
     The result of a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦⓪">ReadableStream</a></code> <var>readable</var> <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="pipe|pipe
 to|piped to|piping to" id="readablestream-pipe">piped to</dfn> a <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream④②">WritableStream</a></code> <var>writable</var>, given an optional boolean <dfn data-dfn-for="ReadableStream/pipe to,ReadableStream/piped to" data-dfn-type="dfn" data-export id="readablestream-pipe-to-preventclose"><var>preventClose</var><a class="self-link" href="#readablestream-pipe-to-preventclose"></a></dfn> (default false), an optional boolean <dfn data-dfn-for="ReadableStream/pipe to,ReadableStream/piped
 to" data-dfn-type="dfn" data-export id="readablestream-pipe-to-preventabort"><var>preventAbort</var><a class="self-link" href="#readablestream-pipe-to-preventabort"></a></dfn> (default false), an optional boolean <dfn data-dfn-for="ReadableStream/pipe to,ReadableStream/piped to" data-dfn-type="dfn" data-export id="readablestream-pipe-to-preventcancel"><var>preventCancel</var><a class="self-link" href="#readablestream-pipe-to-preventcancel"></a></dfn> (default
 false), and an optional <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal④">AbortSignal</a></code> <dfn data-dfn-for="ReadableStream/pipe
 to,ReadableStream/piped to" data-dfn-type="dfn" data-export id="readablestream-pipe-to-signal"><var>signal</var><a class="self-link" href="#readablestream-pipe-to-signal"></a></dfn>, is given by performing the following steps.
 They will return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-promise" id="ref-for-idl-promise②①">Promise</a></code> that fulfills when the pipe completes, or rejects with an exception
 if it fails. 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①③">IsReadableStreamLocked</a>(<var>readable</var>) is false.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked①⓪">IsWritableStreamLocked</a>(<var>writable</var>) is false.</p>
     <li data-md>
      <p>Let <var>signalArg</var> be <var>signal</var> if <var>signal</var> was given, or undefined otherwise.</p>
     <li data-md>
      <p>Return ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to④">ReadableStreamPipeTo</a>(<var>readable</var>, <var>writable</var>, <var>preventClose</var>, <var>preventAbort</var>, <var>preventCancel</var>, <var>signalArg</var>).</p>
    </ol>
    <p class="note" role="note">If one doesn’t care about the promise returned, referencing this concept can be a
 bit awkward. The best we can suggest is "<a data-link-type="dfn" href="#readablestream-pipe" id="ref-for-readablestream-pipe③">pipe</a> <var>readable</var> to <var>writable</var>".</p>
   </div>
   <div class="algorithm" data-algorithm="ReadableStream pipe through">
     The result of a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦①">ReadableStream</a></code> <var>readable</var> <dfn class="dfn-paneled" data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="pipe
 through|piped through|piping through" id="readablestream-pipe-through">piped through</dfn> a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③③">TransformStream</a></code> <var>transform</var>, given
 an optional boolean <dfn data-dfn-for="ReadableStream/pipe through,ReadableStream/piped
 through" data-dfn-type="dfn" data-export id="readablestream-pipe-through-preventclose"><var>preventClose</var><a class="self-link" href="#readablestream-pipe-through-preventclose"></a></dfn> (default false), an optional boolean <dfn data-dfn-for="ReadableStream/pipe through,ReadableStream/piped through" data-dfn-type="dfn" data-export id="readablestream-pipe-through-preventabort"><var>preventAbort</var><a class="self-link" href="#readablestream-pipe-through-preventabort"></a></dfn> (default false), an optional boolean <dfn data-dfn-for="ReadableStream/pipe
 through,ReadableStream/piped through" data-dfn-type="dfn" data-export id="readablestream-pipe-through-preventcancel"><var>preventCancel</var><a class="self-link" href="#readablestream-pipe-through-preventcancel"></a></dfn> (default false), and an
 optional <code class="idl"><a data-link-type="idl" href="https://dom.spec.whatwg.org/#abortsignal" id="ref-for-abortsignal⑤">AbortSignal</a></code> <dfn data-dfn-for="ReadableStream/pipe through,ReadableStream/piped
 through" data-dfn-type="dfn" data-export id="readablestream-pipe-through-signal"><var>signal</var><a class="self-link" href="#readablestream-pipe-through-signal"></a></dfn>, is given by performing the following steps. The result will be
 the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①④">readable side</a> of <var>transform</var>. 
    <ol>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-readable-stream-locked" id="ref-for-is-readable-stream-locked①④">IsReadableStreamLocked</a>(<var>readable</var>) is false.</p>
     <li data-md>
      <p class="assertion">Assert: ! <a data-link-type="abstract-op" href="#is-writable-stream-locked" id="ref-for-is-writable-stream-locked①①">IsWritableStreamLocked</a>(<var>transform</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable⑨">[[writable]]</a>) is false.</p>
     <li data-md>
      <p>Let <var>signalArg</var> be <var>signal</var> if <var>signal</var> was given, or undefined otherwise.</p>
     <li data-md>
      <p>Let <var>promise</var> be ! <a data-link-type="abstract-op" href="#readable-stream-pipe-to" id="ref-for-readable-stream-pipe-to⑤">ReadableStreamPipeTo</a>(<var>readable</var>, <var>transform</var>.<a data-link-type="dfn" href="#transformstream-writable" id="ref-for-transformstream-writable①⓪">[[writable]]</a>, <var>preventClose</var>, <var>preventAbort</var>, <var>preventCancel</var>, <var>signalArg</var>).</p>
     <li data-md>
      <p>Set <var>promise</var>.[[PromiseIsHandled]] to true.</p>
     <li data-md>
      <p>Return <var>transform</var>.<a data-link-type="dfn" href="#transformstream-readable" id="ref-for-transformstream-readable①③">[[readable]]</a>.</p>
    </ol>
   </div>
   <div class="algorithm" data-algorithm="create a proxy" data-algorithm-for="ReadableStream">
     To <dfn data-dfn-for="ReadableStream" data-dfn-type="dfn" data-export data-lt="create a proxy|creating a proxy" id="readablestream-create-a-proxy">create a proxy<a class="self-link" href="#readablestream-create-a-proxy"></a></dfn> for a <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦②">ReadableStream</a></code> <var>stream</var>, perform the following steps. The result will be a new <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦③">ReadableStream</a></code> object which pulls its data from <var>stream</var>, while <var>stream</var> itself becomes
 immediately <a data-link-type="dfn" href="#readablestream-locked" id="ref-for-readablestream-locked②">locked</a> and <a data-link-type="dfn" href="#is-readable-stream-disturbed" id="ref-for-is-readable-stream-disturbed">disturbed</a>. 
    <ol>
     <li data-md>
      <p>Let <var>identityTransform</var> be the result of <a data-link-type="dfn" href="#create-an-identity-transformstream" id="ref-for-create-an-identity-transformstream">creating an identity <code>TransformStream</code></a>.</p>
     <li data-md>
      <p>Return the result of <var>stream</var> <a data-link-type="dfn" href="#readablestream-pipe-through" id="ref-for-readablestream-pipe-through">piped through</a> <var>identityTransform</var>.</p>
    </ol>
   </div>
   <h2 class="heading settled" data-level="10" id="creating-examples"><span class="secno">10. </span><span class="content">Examples of creating streams</span><a class="self-link" href="#creating-examples"></a></h2>
   <div class="non-normative">
    <p><em>This section, and all its subsections, are non-normative.</em></p>
    <p>The previous examples throughout the standard have focused on how to use streams. Here we show how
to create a stream, using the <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦④">ReadableStream</a></code>, <code class="idl"><a data-link-type="idl" href="#writablestream" id="ref-for-writablestream④③">WritableStream</a></code>, and <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③④">TransformStream</a></code> constructors.</p>
    <h3 class="heading settled" data-level="10.1" id="example-rs-push-no-backpressure"><span class="secno">10.1. </span><span class="content">A readable stream with an underlying push source (no
backpressure support)</span><a class="self-link" href="#example-rs-push-no-backpressure"></a></h3>
    <p>The following function creates <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream②⓪">readable streams</a> that wrap <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-sockets.html#websocket" id="ref-for-websocket">WebSocket</a></code> instances <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>,
which are <a data-link-type="dfn" href="#push-source" id="ref-for-push-source②">push sources</a> that do not support backpressure signals. It illustrates how, when
adapting a push source, usually most of the work happens in the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start⑧">start()</a></code> method.</p>
<pre class="highlight"><c- a>function</c-> makeReadableWebSocketStream<c- p>(</c->url<c- p>,</c-> protocols<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> ws <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c->url<c- p>,</c-> protocols<c- p>);</c->
  ws<c- p>.</c->binaryType <c- o>=</c-> <c- u>"arraybuffer"</c-><c- p>;</c->

  <c- k>return</c-> <c- ow>new</c-> ReadableStream<c- p>({</c->
    start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      ws<c- p>.</c->onmessage <c- o>=</c-> event <c- p>=></c-> controller<c- p>.</c->enqueue<c- p>(</c->event<c- p>.</c->data<c- p>);</c->
      ws<c- p>.</c->onclose <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->close<c- p>();</c->
      ws<c- p>.</c->onerror <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The WebSocket errored!"</c-><c- p>));</c->
    <c- p>},</c->

    cancel<c- p>()</c-> <c- p>{</c->
      ws<c- p>.</c->close<c- p>();</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p>We can then use this function to create readable streams for a web socket, and pipe that stream to
an arbitrary writable stream:</p>
<pre class="highlight"><c- a>const</c-> webSocketStream <c- o>=</c-> makeReadableWebSocketStream<c- p>(</c-><c- u>"wss://example.com:443/"</c-><c- p>,</c-> <c- u>"protocol"</c-><c- p>);</c->

webSocketStream<c- p>.</c->pipeTo<c- p>(</c->writableStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully written!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
    <div class="note" id="note-web-socket-wrapping-examples" role="note">
     <a class="self-link" href="#note-web-socket-wrapping-examples"></a> This specific style of wrapping a web socket interprets web socket messages directly as <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧②">chunks</a>. This can be a convenient abstraction, for example when <a data-link-type="dfn" href="#piping" id="ref-for-piping①①">piping</a> to a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①④">writable
 stream</a> or <a data-link-type="dfn" href="#transform-stream" id="ref-for-transform-stream⑧">transform stream</a> for which each web socket message makes sense as a chunk to
 consume or transform. 
     <p>However, often when people talk about "adding streams support to web sockets", they are hoping
 instead for a new capability to send an individual web socket message in a streaming fashion, so
 that e.g. a file could be transferred in a single message without holding all of its contents in
 memory on the client side. To accomplish this goal, we’d instead want to allow individual web
 socket messages to themselves be <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦⑤">ReadableStream</a></code> instances. That isn’t what we show in the
 above example.</p>
     <p>For more background, see <a href="https://github.com/w3c/webrtc-pc/issues/1732#issuecomment-358428651">this discussion</a>.</p>
    </div>
    <h3 class="heading settled" data-level="10.2" id="example-rs-push-backpressure"><span class="secno">10.2. </span><span class="content">A readable stream with an underlying push source and
backpressure support</span><a class="self-link" href="#example-rs-push-backpressure"></a></h3>
    <p>The following function returns <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream②①">readable streams</a> that wrap "backpressure sockets," which are
hypothetical objects that have the same API as web sockets, but also provide the ability to pause
and resume the flow of data with their <code>readStop</code> and <code>readStart</code> methods. In
doing so, this example shows how to apply <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure②①">backpressure</a> to <a data-link-type="dfn" href="#underlying-source" id="ref-for-underlying-source③⓪">underlying sources</a> that support
it.</p>
<pre class="highlight"><c- a>function</c-> makeReadableBackpressureSocketStream<c- p>(</c->host<c- p>,</c-> port<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> socket <c- o>=</c-> createBackpressureSocket<c- p>(</c->host<c- p>,</c-> port<c- p>);</c->

  <c- k>return</c-> <c- ow>new</c-> ReadableStream<c- p>({</c->
    start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      socket<c- p>.</c->ondata <c- o>=</c-> event <c- p>=></c-> <c- p>{</c->
        controller<c- p>.</c->enqueue<c- p>(</c->event<c- p>.</c->data<c- p>);</c->

        <c- k>if</c-> <c- p>(</c->controller<c- p>.</c->desiredSize <c- o>&lt;=</c-> <c- mf>0</c-><c- p>)</c-> <c- p>{</c->
          <c- c1>// The internal queue is full, so propagate</c->
          <c- c1>// the backpressure signal to the underlying source.</c->
          socket<c- p>.</c->readStop<c- p>();</c->
        <c- p>}</c->
      <c- p>};</c->

      socket<c- p>.</c->onend <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->close<c- p>();</c->
      socket<c- p>.</c->onerror <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The socket errored!"</c-><c- p>));</c->
    <c- p>},</c->

    pull<c- p>()</c-> <c- p>{</c->
      <c- c1>// This is called if the internal queue has been emptied, but the</c->
      <c- c1>// stream’s consumer still wants more data. In that case, restart</c->
      <c- c1>// the flow of data if we have previously paused it.</c->
      socket<c- p>.</c->readStart<c- p>();</c->
    <c- p>},</c->

    cancel<c- p>()</c-> <c- p>{</c->
      socket<c- p>.</c->close<c- p>();</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p>We can then use this function to create readable streams for such "backpressure sockets" in the
same way we do for web sockets. This time, however, when we pipe to a destination that cannot
accept data as fast as the socket is producing it, or if we leave the stream alone without reading
from it for some time, a backpressure signal will be sent to the socket.</p>
    <h3 class="heading settled" data-level="10.3" id="example-rbs-push"><span class="secno">10.3. </span><span class="content">A readable byte stream with an underlying push source (no backpressure
support)</span><a class="self-link" href="#example-rbs-push"></a></h3>
    <p>The following function returns <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①⑤">readable byte streams</a> that wraps a hypothetical UDP socket API,
including a promise-returning <code>select2()</code> method that is meant to be evocative of the
POSIX select(2) system call.</p>
    <p>Since the UDP protocol does not have any built-in backpressure support, the backpressure signal
given by <code class="idl"><a data-link-type="idl" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size④">desiredSize</a></code> is ignored, and the stream ensures that when
data is available from the socket but not yet requested by the developer, it is enqueued in the
stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues①⓪">internal queue</a>, to avoid overflow of the kernel-space queue and a consequent loss of
data.</p>
    <p>This has some interesting consequences for how <a data-link-type="dfn" href="#consumer" id="ref-for-consumer⑨">consumers</a> interact with the stream. If the
consumer does not read data as fast as the socket produces it, the <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧③">chunks</a> will remain in the
stream’s <a data-link-type="dfn" href="#internal-queues" id="ref-for-internal-queues①①">internal queue</a> indefinitely. In this case, using a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers⑦">BYOB reader</a> will cause an extra
copy, to move the data from the stream’s internal queue to the developer-supplied buffer. However,
if the consumer consumes the data quickly enough, a <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers⑧">BYOB reader</a> will allow zero-copy reading
directly into developer-supplied buffers.</p>
    <p>(You can imagine a more complex version of this example which uses <code class="idl"><a data-link-type="idl" href="#rbs-controller-desired-size" id="ref-for-rbs-controller-desired-size⑤">desiredSize</a></code> to inform an out-of-band backpressure signaling
mechanism, for example by sending a message down the socket to adjust the rate of data being sent.
That is left as an exercise for the reader.)</p>
<pre class="highlight"><c- a>const</c-> DEFAULT_CHUNK_SIZE <c- o>=</c-> <c- mf>65536</c-><c- p>;</c->

<c- a>function</c-> makeUDPSocketStream<c- p>(</c->host<c- p>,</c-> port<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> socket <c- o>=</c-> createUDPSocket<c- p>(</c->host<c- p>,</c-> port<c- p>);</c->

  <c- k>return</c-> <c- ow>new</c-> ReadableStream<c- p>({</c->
    type<c- o>:</c-> <c- u>"bytes"</c-><c- p>,</c->

    start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      readRepeatedly<c- p>().</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> controller<c- p>.</c->error<c- p>(</c->e<c- p>));</c->

      <c- a>function</c-> readRepeatedly<c- p>()</c-> <c- p>{</c->
        <c- k>return</c-> socket<c- p>.</c->select2<c- p>().</c->then<c- p>(()</c-> <c- p>=></c-> <c- p>{</c->
          <c- c1>// Since the socket can become readable even when there’s</c->
          <c- c1>// no pending BYOB requests, we need to handle both cases.</c->
          <c- a>let</c-> bytesRead<c- p>;</c->
          <c- k>if</c-> <c- p>(</c->controller<c- p>.</c->byobRequest<c- p>)</c-> <c- p>{</c->
            <c- a>const</c-> v <c- o>=</c-> controller<c- p>.</c->byobRequest<c- p>.</c->view<c- p>;</c->
            bytesRead <c- o>=</c-> socket<c- p>.</c->readInto<c- p>(</c->v<c- p>.</c->buffer<c- p>,</c-> v<c- p>.</c->byteOffset<c- p>,</c-> v<c- p>.</c->byteLength<c- p>);</c->
            controller<c- p>.</c->byobRequest<c- p>.</c->respond<c- p>(</c->bytesRead<c- p>);</c->
          <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
            <c- a>const</c-> buffer <c- o>=</c-> <c- ow>new</c-> ArrayBuffer<c- p>(</c->DEFAULT_CHUNK_SIZE<c- p>);</c->
            bytesRead <c- o>=</c-> socket<c- p>.</c->readInto<c- p>(</c->buffer<c- p>,</c-> <c- mf>0</c-><c- p>,</c-> DEFAULT_CHUNK_SIZE<c- p>);</c->
            controller<c- p>.</c->enqueue<c- p>(</c-><c- ow>new</c-> Uint8Array<c- p>(</c->buffer<c- p>,</c-> <c- mf>0</c-><c- p>,</c-> bytesRead<c- p>));</c->
          <c- p>}</c->

          <c- k>if</c-> <c- p>(</c->bytesRead <c- o>===</c-> <c- mf>0</c-><c- p>)</c-> <c- p>{</c->
            controller<c- p>.</c->close<c- p>();</c->
            <c- k>return</c-><c- p>;</c->
          <c- p>}</c->

          <c- k>return</c-> readRepeatedly<c- p>();</c->
        <c- p>});</c->
      <c- p>}</c->
    <c- p>},</c->

    cancel<c- p>()</c-> <c- p>{</c->
      socket<c- p>.</c->close<c- p>();</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p><code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦⑥">ReadableStream</a></code> instances returned from this function can now vend <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers⑨">BYOB readers</a>, with all of
the aforementioned benefits and caveats.</p>
    <h3 class="heading settled" data-level="10.4" id="example-rs-pull"><span class="secno">10.4. </span><span class="content">A readable stream with an underlying pull source</span><a class="self-link" href="#example-rs-pull"></a></h3>
    <p>The following function returns <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream②②">readable streams</a> that wrap portions of the <a href="https://nodejs.org/api/fs.html">Node.js file system API</a> (which themselves map fairly
directly to C’s <code>fopen</code>, <code>fread</code>, and <code>fclose</code> trio). Files are a
typical example of <a data-link-type="dfn" href="#pull-source" id="ref-for-pull-source②">pull sources</a>. Note how in contrast to the examples with push sources, most
of the work here happens on-demand in the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-pull" id="ref-for-dom-underlyingsource-pull⑨">pull()</a></code> function, and not at
startup time in the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-start" id="ref-for-dom-underlyingsource-start⑨">start()</a></code> function.</p>
<pre class="highlight"><c- a>const</c-> fs <c- o>=</c-> require<c- p>(</c-><c- u>"fs"</c-><c- p>).</c->promises<c- p>;</c->
<c- a>const</c-> CHUNK_SIZE <c- o>=</c-> <c- mf>1024</c-><c- p>;</c->

<c- a>function</c-> makeReadableFileStream<c- p>(</c->filename<c- p>)</c-> <c- p>{</c->
  <c- a>let</c-> fileHandle<c- p>;</c->
  <c- a>let</c-> position <c- o>=</c-> <c- mf>0</c-><c- p>;</c->

  <c- k>return</c-> <c- ow>new</c-> ReadableStream<c- p>({</c->
    <c- k>async</c-> start<c- p>()</c-> <c- p>{</c->
      fileHandle <c- o>=</c-> <c- k>await</c-> fs<c- p>.</c->open<c- p>(</c->filename<c- p>,</c-> <c- u>"r"</c-><c- p>);</c->
    <c- p>},</c->

    <c- k>async</c-> pull<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      <c- a>const</c-> buffer <c- o>=</c-> <c- ow>new</c-> ArrayBuffer<c- p>(</c->CHUNK_SIZE<c- p>);</c->

      <c- a>const</c-> <c- p>{</c-> bytesRead <c- p>}</c-> <c- o>=</c-> <c- k>await</c-> fileHandle<c- p>.</c->read<c- p>(</c->buffer<c- p>,</c-> <c- mf>0</c-><c- p>,</c-> CHUNK_SIZE<c- p>,</c-> position<c- p>);</c->
      <c- k>if</c-> <c- p>(</c->bytesRead <c- o>===</c-> <c- mf>0</c-><c- p>)</c-> <c- p>{</c->
        <c- k>await</c-> fileHandle<c- p>.</c->close<c- p>();</c->
        controller<c- p>.</c->close<c- p>();</c->
      <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
        position <c- o>+=</c-> bytesRead<c- p>;</c->
        controller<c- p>.</c->enqueue<c- p>(</c-><c- ow>new</c-> Uint8Array<c- p>(</c->buffer<c- p>,</c-> <c- mf>0</c-><c- p>,</c-> bytesRead<c- p>));</c->
      <c- p>}</c->
    <c- p>},</c->

    cancel<c- p>()</c-> <c- p>{</c->
      <c- k>return</c-> fileHandle<c- p>.</c->close<c- p>();</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p>We can then create and use readable streams for files just as we could before for sockets.</p>
    <h3 class="heading settled" data-level="10.5" id="example-rbs-pull"><span class="secno">10.5. </span><span class="content">A readable byte stream with an underlying pull source</span><a class="self-link" href="#example-rbs-pull"></a></h3>
    <p>The following function returns <a data-link-type="dfn" href="#readable-byte-stream" id="ref-for-readable-byte-stream①⑥">readable byte streams</a> that allow efficient zero-copy reading of
files, again using the <a href="https://nodejs.org/api/fs.html">Node.js file system API</a>.
Instead of using a predetermined chunk size of 1024, it attempts to fill the developer-supplied
buffer, allowing full control.</p>
<pre class="highlight"><c- a>const</c-> fs <c- o>=</c-> require<c- p>(</c-><c- u>"fs"</c-><c- p>).</c->promises<c- p>;</c->
<c- a>const</c-> DEFAULT_CHUNK_SIZE <c- o>=</c-> <c- mf>1024</c-><c- p>;</c->

<c- a>function</c-> makeReadableByteFileStream<c- p>(</c->filename<c- p>)</c-> <c- p>{</c->
 <c- a>let</c-> fileHandle<c- p>;</c->
 <c- a>let</c-> position <c- o>=</c-> <c- mf>0</c-><c- p>;</c->

  <c- k>return</c-> <c- ow>new</c-> ReadableStream<c- p>({</c->
    type<c- o>:</c-> <c- u>"bytes"</c-><c- p>,</c->

    <c- k>async</c-> start<c- p>()</c-> <c- p>{</c->
      fileHandle <c- o>=</c-> <c- k>await</c-> fs<c- p>.</c->open<c- p>(</c->filename<c- p>,</c-> <c- u>"r"</c-><c- p>);</c->
    <c- p>},</c->

    <c- k>async</c-> pull<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      <c- c1>// Even when the consumer is using the default reader, the auto-allocation</c->
      <c- c1>// feature allocates a buffer and passes it to us via byobRequest.</c->
      <c- a>const</c-> v <c- o>=</c-> controller<c- p>.</c->byobRequest<c- p>.</c->view<c- p>;</c->

      <c- a>const</c-> <c- p>{</c-> bytesRead <c- p>}</c-> <c- o>=</c-> <c- k>await</c-> fileHandle<c- p>.</c->read<c- p>(</c->v<c- p>.</c->buffer<c- p>,</c-> v<c- p>.</c->byteOffset<c- p>,</c-> v<c- p>.</c->byteLength<c- p>);</c->
      <c- k>if</c-> <c- p>(</c->bytesRead <c- o>===</c-> <c- mf>0</c-><c- p>)</c-> <c- p>{</c->
        <c- k>await</c-> fileHandle<c- p>.</c->close<c- p>();</c->
        controller<c- p>.</c->close<c- p>();</c->
      <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
        position <c- o>+=</c-> bytesRead<c- p>;</c->
        controller<c- p>.</c->byobRequest<c- p>.</c->respond<c- p>(</c->bytesRead<c- p>);</c->
      <c- p>}</c->
    <c- p>},</c->

    cancel<c- p>()</c-> <c- p>{</c->
      <c- k>return</c-> fs<c- p>.</c->close<c- p>(</c->fd<c- p>);</c->
    <c- p>},</c->

    autoAllocateChunkSize<c- o>:</c-> DEFAULT_CHUNK_SIZE
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p>With this in hand, we can create and use <a data-link-type="dfn" href="#byob-readers" id="ref-for-byob-readers①⓪">BYOB readers</a> for the returned <code class="idl"><a data-link-type="idl" href="#readablestream" id="ref-for-readablestream⑦⑦">ReadableStream</a></code>. But
we can also create <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers④">default readers</a>, using them in the same simple and generic manner as usual.
The adaptation between the low-level byte tracking of the <a data-link-type="dfn" href="#underlying-byte-source" id="ref-for-underlying-byte-source①⑤">underlying byte source</a> shown here,
and the higher-level chunk-based consumption of a <a data-link-type="dfn" href="#default-readers" id="ref-for-default-readers⑤">default reader</a>, is all taken care of
automatically by the streams implementation. The auto-allocation feature, via the <code class="idl"><a data-link-type="idl" href="#dom-underlyingsource-autoallocatechunksize" id="ref-for-dom-underlyingsource-autoallocatechunksize②">autoAllocateChunkSize</a></code> option, even allows us to write less code, compared to
the manual branching in <a href="#example-rbs-push">§ 10.3 A readable byte stream with an underlying push source (no backpressure
support)</a>.</p>
    <h3 class="heading settled" data-level="10.6" id="example-ws-no-backpressure"><span class="secno">10.6. </span><span class="content">A writable stream with no backpressure or success signals</span><a class="self-link" href="#example-ws-no-backpressure"></a></h3>
    <p>The following function returns a <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①⑤">writable stream</a> that wraps a <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-sockets.html#websocket" id="ref-for-websocket①">WebSocket</a></code> <a data-link-type="biblio" href="#biblio-html" title="HTML Standard">[HTML]</a>. Web
sockets do not provide any way to tell when a given chunk of data has been successfully sent
(without awkward polling of <code class="idl"><a data-link-type="idl" href="https://html.spec.whatwg.org/multipage/web-sockets.html#dom-websocket-bufferedamount" id="ref-for-dom-websocket-bufferedamount">bufferedAmount</a></code>, which we leave as an exercise to the
reader). As such, this writable stream has no ability to communicate accurate <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure②②">backpressure</a> signals or write success/failure to its <a data-link-type="dfn" href="#producer" id="ref-for-producer⑧">producers</a>. That is, the promises returned by its <a data-link-type="dfn" href="#writer" id="ref-for-writer⑥">writer</a>'s <code class="idl"><a data-link-type="idl" href="#default-writer-write" id="ref-for-default-writer-write①④">write()</a></code> method and <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready①⓪">ready</a></code> getter will always fulfill immediately.</p>
<pre class="highlight"><c- a>function</c-> makeWritableWebSocketStream<c- p>(</c->url<c- p>,</c-> protocols<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> ws <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c->url<c- p>,</c-> protocols<c- p>);</c->

  <c- k>return</c-> <c- ow>new</c-> WritableStream<c- p>({</c->
    start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
      ws<c- p>.</c->onerror <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
        controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The WebSocket errored!"</c-><c- p>));</c->
        ws<c- p>.</c->onclose <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
      <c- p>};</c->
      ws<c- p>.</c->onclose <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The server closed the connection unexpectedly!"</c-><c- p>));</c->
      <c- k>return</c-> <c- ow>new</c-> Promise<c- p>(</c->resolve <c- p>=></c-> ws<c- p>.</c->onopen <c- o>=</c-> resolve<c- p>);</c->
    <c- p>},</c->

    write<c- p>(</c->chunk<c- p>)</c-> <c- p>{</c->
      ws<c- p>.</c->send<c- p>(</c->chunk<c- p>);</c->
      <c- c1>// Return immediately, since the web socket gives us no easy way to tell</c->
      <c- c1>// when the write completes.</c->
    <c- p>},</c->

    close<c- p>()</c-> <c- p>{</c->
      <c- k>return</c-> closeWS<c- p>(</c-><c- mf>1000</c-><c- p>);</c->
    <c- p>},</c->

    abort<c- p>(</c->reason<c- p>)</c-> <c- p>{</c->
      <c- k>return</c-> closeWS<c- p>(</c-><c- mf>4000</c-><c- p>,</c-> reason <c- o>&amp;&amp;</c-> reason<c- p>.</c->message<c- p>);</c->
    <c- p>},</c->
  <c- p>});</c->

  <c- a>function</c-> closeWS<c- p>(</c->code<c- p>,</c-> reasonString<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-> <c- ow>new</c-> Promise<c- p>((</c->resolve<c- p>,</c-> reject<c- p>)</c-> <c- p>=></c-> <c- p>{</c->
      ws<c- p>.</c->onclose <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
        <c- k>if</c-> <c- p>(</c->e<c- p>.</c->wasClean<c- p>)</c-> <c- p>{</c->
          resolve<c- p>();</c->
        <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          reject<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The connection was not closed cleanly"</c-><c- p>));</c->
        <c- p>}</c->
      <c- p>};</c->
      ws<c- p>.</c->close<c- p>(</c->code<c- p>,</c-> reasonString<c- p>);</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>We can then use this function to create writable streams for a web socket, and pipe an arbitrary
readable stream to it:</p>
<pre class="highlight"><c- a>const</c-> webSocketStream <c- o>=</c-> makeWritableWebSocketStream<c- p>(</c-><c- u>"wss://example.com:443/"</c-><c- p>,</c-> <c- u>"protocol"</c-><c- p>);</c->

readableStream<c- p>.</c->pipeTo<c- p>(</c->webSocketStream<c- p>)</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"All data successfully written!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c-><c- u>"Something went wrong!"</c-><c- p>,</c-> e<c- p>));</c->
</pre>
    <p class="note" role="note">See <a href="#note-web-socket-wrapping-examples">the earlier note</a> about this
style of wrapping web sockets into streams. </p>
    <h3 class="heading settled" data-level="10.7" id="example-ws-backpressure"><span class="secno">10.7. </span><span class="content">A writable stream with backpressure and success signals</span><a class="self-link" href="#example-ws-backpressure"></a></h3>
    <p>The following function returns <a data-link-type="dfn" href="#writable-stream" id="ref-for-writable-stream①⑥">writable streams</a> that wrap portions of the <a href="https://nodejs.org/api/fs.html">Node.js file system API</a> (which themselves map fairly
directly to C’s <code>fopen</code>, <code>fwrite</code>, and <code>fclose</code> trio). Since the
API we are wrapping provides a way to tell when a given write succeeds, this stream will be able to
communicate <a data-link-type="dfn" href="#backpressure" id="ref-for-backpressure②③">backpressure</a> signals as well as whether an individual write succeeded or failed.</p>
<pre class="highlight"><c- a>const</c-> fs <c- o>=</c-> require<c- p>(</c-><c- u>"fs"</c-><c- p>).</c->promises<c- p>;</c->

<c- a>function</c-> makeWritableFileStream<c- p>(</c->filename<c- p>)</c-> <c- p>{</c->
  <c- a>let</c-> fileHandle<c- p>;</c->

  <c- k>return</c-> <c- ow>new</c-> WritableStream<c- p>({</c->
    <c- k>async</c-> start<c- p>()</c-> <c- p>{</c->
      fileHandle <c- o>=</c-> <c- k>await</c-> fs<c- p>.</c->open<c- p>(</c->filename<c- p>,</c-> <c- u>"w"</c-><c- p>);</c->
    <c- p>},</c->

    write<c- p>(</c->chunk<c- p>)</c-> <c- p>{</c->
      <c- k>return</c-> fileHandle<c- p>.</c->write<c- p>(</c->chunk<c- p>,</c-> <c- mf>0</c-><c- p>,</c-> chunk<c- p>.</c->length<c- p>);</c->
    <c- p>},</c->

    close<c- p>()</c-> <c- p>{</c->
      <c- k>return</c-> fs<c- p>.</c->close<c- p>(</c->fd<c- p>);</c->
    <c- p>},</c->

    abort<c- p>()</c-> <c- p>{</c->
      <c- k>return</c-> fs<c- p>.</c->close<c- p>(</c->fd<c- p>);</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
    <p>We can then use this function to create a writable stream for a file, and write individual <a data-link-type="dfn" href="#chunk" id="ref-for-chunk⑧④">chunks</a> of data to it:</p>
<pre class="highlight"><c- a>const</c-> fileStream <c- o>=</c-> makeWritableFileStream<c- p>(</c-><c- u>"/example/path/on/fs.txt"</c-><c- p>);</c->
<c- a>const</c-> writer <c- o>=</c-> fileStream<c- p>.</c->getWriter<c- p>();</c->

writer<c- p>.</c->write<c- p>(</c-><c- u>"To stream, or not to stream\n"</c-><c- p>);</c->
writer<c- p>.</c->write<c- p>(</c-><c- u>"That is the question\n"</c-><c- p>);</c->

writer<c- p>.</c->close<c- p>()</c->
  <c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c-><c- u>"chunks written and stream closed successfully!"</c-><c- p>))</c->
  <c- p>.</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c->e<c- p>));</c->
</pre>
    <p>Note that if a particular call to <code>fileHandle.write</code> takes a longer time, the returned
promise will fulfill later. In the meantime, additional writes can be queued up, which are stored
in the stream’s internal queue. The accumulation of chunks in this queue can change the stream to
return a pending promise from the <code class="idl"><a data-link-type="idl" href="#default-writer-ready" id="ref-for-default-writer-ready①①">ready</a></code> getter, which is a signal
to <a data-link-type="dfn" href="#producer" id="ref-for-producer⑨">producers</a> that they would benefit from backing off and stopping writing, if possible.</p>
    <p>The way in which the writable stream queues up writes is especially important in this case, since
as stated in <a href="https://nodejs.org/api/fs.html#fs_filehandle_write_buffer_offset_length_position">the
documentation for <code>fileHandle.write</code></a>, "it is unsafe to use <code>filehandle.write</code> multiple times on the same file without waiting for the promise." But
we don’t have to worry about that when writing the <code>makeWritableFileStream</code> function,
since the stream implementation guarantees that the <a data-link-type="dfn" href="#underlying-sink" id="ref-for-underlying-sink③③">underlying sink</a>'s <code class="idl"><a data-link-type="idl" href="#dom-underlyingsink-write" id="ref-for-dom-underlyingsink-write⑥">write()</a></code> method will not be called until any promises returned by previous
calls have fulfilled!</p>
    <h3 class="heading settled" data-level="10.8" id="example-both"><span class="secno">10.8. </span><span class="content">A { readable, writable } stream pair wrapping the same underlying
resource</span><a class="self-link" href="#example-both"></a></h3>
    <p>The following function returns an object of the form <code>{ readable, writable }</code>, with the <code>readable</code> property containing a readable stream and the <code>writable</code> property
containing a writable stream, where both streams wrap the same underlying web socket resource. In
essence, this combines <a href="#example-rs-push-no-backpressure">§ 10.1 A readable stream with an underlying push source (no
backpressure support)</a> and <a href="#example-ws-no-backpressure">§ 10.6 A writable stream with no backpressure or success signals</a>.</p>
    <p>While doing so, it illustrates how you can use JavaScript classes to create reusable underlying
sink and underlying source abstractions.</p>
<pre class="highlight"><c- a>function</c-> streamifyWebSocket<c- p>(</c->url<c- p>,</c-> protocol<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> ws <c- o>=</c-> <c- ow>new</c-> WebSocket<c- p>(</c->url<c- p>,</c-> protocols<c- p>);</c->
  ws<c- p>.</c->binaryType <c- o>=</c-> <c- u>"arraybuffer"</c-><c- p>;</c->

  <c- k>return</c-> <c- p>{</c->
    readable<c- o>:</c-> <c- ow>new</c-> ReadableStream<c- p>(</c-><c- ow>new</c-> WebSocketSource<c- p>(</c->ws<c- p>)),</c->
    writable<c- o>:</c-> <c- ow>new</c-> WritableStream<c- p>(</c-><c- ow>new</c-> WebSocketSink<c- p>(</c->ws<c- p>))</c->
  <c- p>};</c->
<c- p>}</c->

<c- a>class</c-> WebSocketSource <c- p>{</c->
  <c- kr>constructor</c-><c- p>(</c->ws<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws <c- o>=</c-> ws<c- p>;</c->
  <c- p>}</c->

  start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onmessage <c- o>=</c-> event <c- p>=></c-> controller<c- p>.</c->enqueue<c- p>(</c->event<c- p>.</c->data<c- p>);</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onclose <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->close<c- p>();</c->

    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->addEventListener<c- p>(</c-><c- u>"error"</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
      controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The WebSocket errored!"</c-><c- p>));</c->
    <c- p>});</c->
  <c- p>}</c->

  cancel<c- p>()</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->close<c- p>();</c->
  <c- p>}</c->
<c- p>}</c->

<c- a>class</c-> WebSocketSink <c- p>{</c->
  <c- kr>constructor</c-><c- p>(</c->ws<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws <c- o>=</c-> ws<c- p>;</c->
  <c- p>}</c->

  start<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onclose <c- o>=</c-> <c- p>()</c-> <c- p>=></c-> controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The server closed the connection unexpectedly!"</c-><c- p>));</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->addEventListener<c- p>(</c-><c- u>"error"</c-><c- p>,</c-> <c- p>()</c-> <c- p>=></c-> <c- p>{</c->
      controller<c- p>.</c->error<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The WebSocket errored!"</c-><c- p>));</c->
      <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onclose <c- o>=</c-> <c- kc>null</c-><c- p>;</c->
    <c- p>});</c->

    <c- k>return</c-> <c- ow>new</c-> Promise<c- p>(</c->resolve <c- p>=></c-> <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onopen <c- o>=</c-> resolve<c- p>);</c->
  <c- p>}</c->

  write<c- p>(</c->chunk<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->send<c- p>(</c->chunk<c- p>);</c->
  <c- p>}</c->

  close<c- p>()</c-> <c- p>{</c->
    <c- k>return</c-> <c- k>this</c-><c- p>.</c->_closeWS<c- p>(</c-><c- mf>1000</c-><c- p>);</c->
  <c- p>}</c->

  abort<c- p>(</c->reason<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-> <c- k>this</c-><c- p>.</c->_closeWS<c- p>(</c-><c- mf>4000</c-><c- p>,</c-> reason <c- o>&amp;&amp;</c-> reason<c- p>.</c->message<c- p>);</c->
  <c- p>}</c->

  _closeWS<c- p>(</c->code<c- p>,</c-> reasonString<c- p>)</c-> <c- p>{</c->
    <c- k>return</c-> <c- ow>new</c-> Promise<c- p>((</c->resolve<c- p>,</c-> reject<c- p>)</c-> <c- p>=></c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->onclose <c- o>=</c-> e <c- p>=></c-> <c- p>{</c->
        <c- k>if</c-> <c- p>(</c->e<c- p>.</c->wasClean<c- p>)</c-> <c- p>{</c->
          resolve<c- p>();</c->
        <c- p>}</c-> <c- k>else</c-> <c- p>{</c->
          reject<c- p>(</c-><c- ow>new</c-> <c- ne>Error</c-><c- p>(</c-><c- u>"The connection was not closed cleanly"</c-><c- p>));</c->
        <c- p>}</c->
      <c- p>};</c->
      <c- k>this</c-><c- p>.</c->_ws<c- p>.</c->close<c- p>(</c->code<c- p>,</c-> reasonString<c- p>);</c->
    <c- p>});</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
    <p>We can then use the objects created by this function to communicate with a remote web socket, using
the standard stream APIs:</p>
<pre class="highlight"><c- a>const</c-> streamyWS <c- o>=</c-> streamifyWebSocket<c- p>(</c-><c- u>"wss://example.com:443/"</c-><c- p>,</c-> <c- u>"protocol"</c-><c- p>);</c->
<c- a>const</c-> writer <c- o>=</c-> streamyWS<c- p>.</c->writable<c- p>.</c->getWriter<c- p>();</c->
<c- a>const</c-> reader <c- o>=</c-> streamyWS<c- p>.</c->readable<c- p>.</c->getReader<c- p>();</c->

writer<c- p>.</c->write<c- p>(</c-><c- u>"Hello"</c-><c- p>);</c->
writer<c- p>.</c->write<c- p>(</c-><c- u>"web socket!"</c-><c- p>);</c->

reader<c- p>.</c->read<c- p>().</c->then<c- p>(({</c-> value<c- p>,</c-> done <c- p>})</c-> <c- p>=></c-> <c- p>{</c->
  console<c- p>.</c->log<c- p>(</c-><c- u>"The web socket says: "</c-><c- p>,</c-> value<c- p>);</c->
<c- p>});</c->
</pre>
    <p>Note how in this setup canceling the <code>readable</code> side will implicitly close the <code>writable</code> side, and similarly, closing or aborting the <code>writable</code> side will
implicitly close the <code>readable</code> side.</p>
    <p class="note" role="note">See <a href="#note-web-socket-wrapping-examples">the earlier note</a> about this
style of wrapping web sockets into streams. </p>
   </div>
   <h3 class="heading settled" data-level="10.9" id="example-ts-lipfuzz"><span class="secno">10.9. </span><span class="content">A transform stream that replaces template tags</span><a class="self-link" href="#example-ts-lipfuzz"></a></h3>
   <p>It’s often useful to substitute tags with variables on a stream of data, where the parts that need
to be replaced are small compared to the overall data size. This example presents a simple way to
do that. It maps strings to strings, transforming a template like <code>"Time: {{time}} Message:
{{message}}"</code> to <code>"Time: 15:36 Message: hello"</code> assuming that <code>{ time:
"15:36", message: "hello" }</code> was passed in the <code>substitutions</code> parameter to <code>LipFuzzTransformer</code>.</p>
   <p>This example also demonstrates one way to deal with a situation where a chunk contains partial data
that cannot be transformed until more data is received. In this case, a partial template tag will
be accumulated in the <code>partialChunk</code> property until either the end of the tag is found or
the end of the stream is reached.</p>
<pre class="highlight"><c- a>class</c-> LipFuzzTransformer <c- p>{</c->
  <c- kr>constructor</c-><c- p>(</c->substitutions<c- p>)</c-> <c- p>{</c->
    <c- k>this</c-><c- p>.</c->substitutions <c- o>=</c-> substitutions<c- p>;</c->
    <c- k>this</c-><c- p>.</c->partialChunk <c- o>=</c-> <c- u>""</c-><c- p>;</c->
    <c- k>this</c-><c- p>.</c->lastIndex <c- o>=</c-> <c- kc>undefined</c-><c- p>;</c->
  <c- p>}</c->

  transform<c- p>(</c->chunk<c- p>,</c-> controller<c- p>)</c-> <c- p>{</c->
    chunk <c- o>=</c-> <c- k>this</c-><c- p>.</c->partialChunk <c- o>+</c-> chunk<c- p>;</c->
    <c- k>this</c-><c- p>.</c->partialChunk <c- o>=</c-> <c- u>""</c-><c- p>;</c->
    <c- c1>// lastIndex is the index of the first character after the last substitution.</c->
    <c- k>this</c-><c- p>.</c->lastIndex <c- o>=</c-> <c- mf>0</c-><c- p>;</c->
    chunk <c- o>=</c-> chunk<c- p>.</c->replace<c- p>(</c-><c- sr>/\{\{([a-zA-Z0-9_-]+)\}\}/g</c-><c- p>,</c-> <c- k>this</c-><c- p>.</c->replaceTag<c- p>.</c->bind<c- p>(</c-><c- k>this</c-><c- p>));</c->
    <c- c1>// Regular expression for an incomplete template at the end of a string.</c->
    <c- a>const</c-> partialAtEndRegexp <c- o>=</c-> <c- sr>/\{(\{([a-zA-Z0-9_-]+(\})?)?)?$/g</c-><c- p>;</c->
    <c- c1>// Avoid looking at any characters that have already been substituted.</c->
    partialAtEndRegexp<c- p>.</c->lastIndex <c- o>=</c-> <c- k>this</c-><c- p>.</c->lastIndex<c- p>;</c->
    <c- k>this</c-><c- p>.</c->lastIndex <c- o>=</c-> <c- kc>undefined</c-><c- p>;</c->
    <c- a>const</c-> match <c- o>=</c-> partialAtEndRegexp<c- p>.</c->exec<c- p>(</c->chunk<c- p>);</c->
    <c- k>if</c-> <c- p>(</c->match<c- p>)</c-> <c- p>{</c->
      <c- k>this</c-><c- p>.</c->partialChunk <c- o>=</c-> chunk<c- p>.</c->substring<c- p>(</c->match<c- p>.</c->index<c- p>);</c->
      chunk <c- o>=</c-> chunk<c- p>.</c->substring<c- p>(</c-><c- mf>0</c-><c- p>,</c-> match<c- p>.</c->index<c- p>);</c->
    <c- p>}</c->
    controller<c- p>.</c->enqueue<c- p>(</c->chunk<c- p>);</c->
  <c- p>}</c->

  flush<c- p>(</c->controller<c- p>)</c-> <c- p>{</c->
    <c- k>if</c-> <c- p>(</c-><c- k>this</c-><c- p>.</c->partialChunk<c- p>.</c->length <c- o>></c-> <c- mf>0</c-><c- p>)</c-> <c- p>{</c->
      controller<c- p>.</c->enqueue<c- p>(</c-><c- k>this</c-><c- p>.</c->partialChunk<c- p>);</c->
    <c- p>}</c->
  <c- p>}</c->

  replaceTag<c- p>(</c->match<c- p>,</c-> p1<c- p>,</c-> offset<c- p>)</c-> <c- p>{</c->
    <c- a>let</c-> replacement <c- o>=</c-> <c- k>this</c-><c- p>.</c->substitutions<c- p>[</c->p1<c- p>];</c->
    <c- k>if</c-> <c- p>(</c->replacement <c- o>===</c-> <c- kc>undefined</c-><c- p>)</c-> <c- p>{</c->
      replacement <c- o>=</c-> <c- u>""</c-><c- p>;</c->
    <c- p>}</c->
    <c- k>this</c-><c- p>.</c->lastIndex <c- o>=</c-> offset <c- o>+</c-> replacement<c- p>.</c->length<c- p>;</c->
    <c- k>return</c-> replacement<c- p>;</c->
  <c- p>}</c->
<c- p>}</c->
</pre>
   <p>In this case we define the <a data-link-type="dfn" href="#transformer" id="ref-for-transformer⑧">transformer</a> to be passed to the <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③⑤">TransformStream</a></code> constructor as a
class. This is useful when there is instance data to track.</p>
   <p>The class would be used in code like:</p>
<pre class="highlight"><c- a>const</c-> data <c- o>=</c-> <c- p>{</c-> userName<c- p>,</c-> displayName<c- p>,</c-> icon<c- p>,</c-> date <c- p>};</c->
<c- a>const</c-> ts <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>(</c-><c- ow>new</c-> LipFuzzTransformer<c- p>(</c->data<c- p>));</c->

fetchEvent<c- p>.</c->respondWith<c- p>(</c->
  fetch<c- p>(</c->fetchEvent<c- p>.</c->request<c- p>.</c->url<c- p>).</c->then<c- p>(</c->response <c- p>=></c-> <c- p>{</c->
    <c- a>const</c-> transformedBody <c- o>=</c-> response<c- p>.</c->body
      <c- c1>// Decode the binary-encoded response to string</c->
      <c- p>.</c->pipeThrough<c- p>(</c-><c- ow>new</c-> TextDecoderStream<c- p>())</c->
      <c- c1>// Apply the LipFuzzTransformer</c->
      <c- p>.</c->pipeThrough<c- p>(</c->ts<c- p>)</c->
      <c- c1>// Encode the transformed string</c->
      <c- p>.</c->pipeThrough<c- p>(</c-><c- ow>new</c-> TextEncoderStream<c- p>());</c->
    <c- k>return</c-> <c- ow>new</c-> Response<c- p>(</c->transformedBody<c- p>);</c->
  <c- p>})</c->
<c- p>);</c->
</pre>
   <p class="warning">For simplicity, <code>LipFuzzTransformer</code> performs unescaped text
substitutions. In real applications, a template system that performs context-aware escaping is good
practice for security and robustness. </p>
   <h3 class="heading settled" data-level="10.10" id="example-ts-sync-mapper"><span class="secno">10.10. </span><span class="content">A transform stream created from a sync mapper function</span><a class="self-link" href="#example-ts-sync-mapper"></a></h3>
   <p>The following function allows creating new <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③⑥">TransformStream</a></code> instances from synchronous "mapper"
functions, of the type you would normally pass to <code class="idl"><a data-link-type="idl" href="https://tc39.es/ecma262/#sec-array.prototype.map" id="ref-for-sec-array.prototype.map">Array.prototype.map</a></code>. It
demonstrates that the API is concise even for trivial transforms.</p>
<pre class="highlight"><c- a>function</c-> mapperTransformStream<c- p>(</c->mapperFunction<c- p>)</c-> <c- p>{</c->
  <c- k>return</c-> <c- ow>new</c-> TransformStream<c- p>({</c->
    transform<c- p>(</c->chunk<c- p>,</c-> controller<c- p>)</c-> <c- p>{</c->
      controller<c- p>.</c->enqueue<c- p>(</c->mapperFunction<c- p>(</c->chunk<c- p>));</c->
    <c- p>}</c->
  <c- p>});</c->
<c- p>}</c->
</pre>
   <p>This function can then be used to create a <code class="idl"><a data-link-type="idl" href="#transformstream" id="ref-for-transformstream③⑦">TransformStream</a></code> that uppercases all its inputs:</p>
<pre class="highlight"><c- a>const</c-> ts <c- o>=</c-> mapperTransformStream<c- p>(</c->chunk <c- p>=></c-> chunk<c- p>.</c->toUpperCase<c- p>());</c->
<c- a>const</c-> writer <c- o>=</c-> ts<c- p>.</c->writable<c- p>.</c->getWriter<c- p>();</c->
<c- a>const</c-> reader <c- o>=</c-> ts<c- p>.</c->readable<c- p>.</c->getReader<c- p>();</c->

writer<c- p>.</c->write<c- p>(</c-><c- u>"No need to shout"</c-><c- p>);</c->

<c- c1>// Logs "NO NEED TO SHOUT":</c->
reader<c- p>.</c->read<c- p>().</c->then<c- p>(({</c-> value <c- p>})</c-> <c- p>=></c-> console<c- p>.</c->log<c- p>(</c->value<c- p>));</c->
</pre>
   <p>Although a synchronous transform never causes backpressure itself, it will only transform chunks as
long as there is no backpressure, so resources will not be wasted.</p>
   <p>Exceptions error the stream in a natural way:</p>
<pre class="highlight"><c- a>const</c-> ts <c- o>=</c-> mapperTransformStream<c- p>(</c->chunk <c- p>=></c-> JSON<c- p>.</c->parse<c- p>(</c->chunk<c- p>));</c->
<c- a>const</c-> writer <c- o>=</c-> ts<c- p>.</c->writable<c- p>.</c->getWriter<c- p>();</c->
<c- a>const</c-> reader <c- o>=</c-> ts<c- p>.</c->readable<c- p>.</c->getReader<c- p>();</c->

writer<c- p>.</c->write<c- p>(</c-><c- u>"[1, "</c-><c- p>);</c->

<c- c1>// Logs a SyntaxError, twice:</c->
reader<c- p>.</c->read<c- p>().</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c->e<c- p>));</c->
writer<c- p>.</c->write<c- p>(</c-><c- u>"{}"</c-><c- p>).</c-><c- k>catch</c-><c- p>(</c->e <c- p>=></c-> console<c- p>.</c->error<c- p>(</c->e<c- p>));</c->
</pre>
   <h3 class="heading settled" data-level="10.11" id="example-identity-transform-usages"><span class="secno">10.11. </span><span class="content">Using an identity transform stream as a primitive to
create new readable streams</span><a class="self-link" href="#example-identity-transform-usages"></a></h3>
   <p>Combining an <a data-link-type="dfn" href="#identity-transform-stream" id="ref-for-identity-transform-stream②">identity transform stream</a> with <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to⑧">pipeTo()</a></code> is a powerful way to manipulate
streams. This section contains a couple of examples of this general technique.</p>
   <p>It’s sometimes natural to treat a promise for a <a data-link-type="dfn" href="#readable-stream" id="ref-for-readable-stream②③">readable stream</a> as if it were a readable stream.
A simple adapter function is all that’s needed:</p>
<pre class="highlight"><c- a>function</c-> promiseToReadable<c- p>(</c->promiseForReadable<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> ts <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>();</c->

  promiseForReadable
      <c- p>.</c->then<c- p>(</c->readable <c- p>=></c-> readable<c- p>.</c->pipeTo<c- p>(</c->ts<c- p>.</c->writable<c- p>))</c->
      <c- p>.</c-><c- k>catch</c-><c- p>(</c->reason <c- p>=></c-> ts<c- p>.</c->writable<c- p>.</c->abort<c- p>(</c->reason<c- p>))</c->
      <c- p>.</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{});</c->

  <c- k>return</c-> ts<c- p>.</c->readable<c- p>;</c->
<c- p>}</c->
</pre>
   <p>Here, we pipe the data to the <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①③">writable side</a> and return the <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①⑤">readable side</a>. If the pipe
errors, we <a data-link-type="dfn" href="#abort-a-writable-stream" id="ref-for-abort-a-writable-stream⑦">abort</a> the writable side, which automatically propagates the
error to the returned readable side. If the writable side had already been errored by <code class="idl"><a data-link-type="idl" href="#rs-pipe-to" id="ref-for-rs-pipe-to⑨">pipeTo()</a></code>, then the <code class="idl"><a data-link-type="idl" href="#ws-abort" id="ref-for-ws-abort⑤">abort()</a></code> call will return a rejection, which
we can safely ignore.</p>
   <p>A more complex extension of this is concatenating multiple readable streams into one:</p>
<pre class="highlight"><c- a>function</c-> concatenateReadables<c- p>(</c->readables<c- p>)</c-> <c- p>{</c->
  <c- a>const</c-> ts <c- o>=</c-> <c- ow>new</c-> TransformStream<c- p>();</c->
  <c- a>let</c-> promise <c- o>=</c-> Promise<c- p>.</c->resolve<c- p>();</c->

  <c- k>for</c-> <c- p>(</c-><c- a>const</c-> readable <c- k>of</c-> readables<c- p>)</c-> <c- p>{</c->
    promise <c- o>=</c-> promise<c- p>.</c->then<c- p>(</c->
     <c- p>()</c-> <c- p>=></c-> readable<c- p>.</c->pipeTo<c- p>(</c->ts<c- p>.</c->writable<c- p>,</c-> <c- p>{</c-> preventClose<c- o>:</c-> <c- kc>true</c-> <c- p>}),</c->
     reason <c- p>=></c-> <c- p>{</c->
       <c- k>return</c-> Promise<c- p>.</c->all<c- p>([</c->
         ts<c- p>.</c->writable<c- p>.</c->abort<c- p>(</c->reason<c- p>),</c->
         readable<c- p>.</c->cancel<c- p>(</c->reason<c- p>)</c->
       <c- p>]);</c->
     <c- p>}</c->
   <c- p>);</c->
  <c- p>}</c->

  promise<c- p>.</c->then<c- p>(()</c-> <c- p>=></c-> ts<c- p>.</c->writable<c- p>.</c->close<c- p>(),</c->
               reason <c- p>=></c-> ts<c- p>.</c->writable<c- p>.</c->abort<c- p>(</c->reason<c- p>))</c->
         <c- p>.</c-><c- k>catch</c-><c- p>(()</c-> <c- p>=></c-> <c- p>{});</c->

  <c- k>return</c-> ts<c- p>.</c->readable<c- p>;</c->
<c- p>}</c->
</pre>
   <p>The error handling here is subtle because canceling the concatenated stream has to cancel all the
input streams. However, the success case is simple enough. We just pipe each stream in the <code>readables</code> iterable one at a time to the <a data-link-type="dfn" href="#identity-transform-stream" id="ref-for-identity-transform-stream③">identity transform stream</a>'s <a data-link-type="dfn" href="#writable-side" id="ref-for-writable-side①④">writable
side</a>, and then close it when we are done. The <a data-link-type="dfn" href="#readable-side" id="ref-for-readable-side①⑥">readable side</a> is then a concatenation of all the
chunks from all of of the streams. We return it from the function. Backpressure is applied as usual.</p>
   <h2 class="no-num heading settled" id="acks"><span class="content">Acknowledgments</span><a class="self-link" href="#acks"></a></h2>
   <p>The editors would like to thank
Anne van Kesteren,
AnthumChris,
Arthur Langereis,
Ben Kelly,
Bert Belder,
Brian di Palma,
Calvin Metcalf,
Dominic Tarr,
Ed Hager,
Forbes Lindesay,
Forrest Norvell,
Gary Blackwood,
Gorgi Kosev,
Gus Caplan,
贺师俊 (hax),
Isaac Schlueter,
isonmad,
Jake Archibald,
Jake Verbaten,
Janessa Det,
Jason Orendorff,
Jeffrey Yasskin,
Jens Nockert,
Lennart Grahl,
Mangala Sadhu Sangeet Singh Khalsa,
Marcos Caceres,
Marvin Hagemeister,
Mattias Buelens,
Michael Mior,
Mihai Potra,
Nidhi Jaju,
Romain Bellessort, 
Simon Menke,
Stephen Sugden,
Surma,
Tab Atkins,
Tanguy Krotoff,
Thorsten Lorenz,
Till Schneidereit,
Tim Caswell,
Trevor Norris,
tzik,
Will Chan,
Youenn Fablet,
平野裕 (Yutaka Hirano),
and
Xabier Rodríguez
for their contributions to this specification. Community involvement in this specification has been
above and beyond; we couldn’t have done it without you.</p>
   <p>This standard is written by Adam Rice (<a href="https://google.com">Google</a>, <a href="mailto:ricea@chromium.org">ricea@chromium.org</a>), <a href="https://domenic.me/">Domenic
Denicola</a> (<a href="https://google.com">Google</a>, <a href="mailto:d@domenic.me">d@domenic.me</a>), and 吉野剛史 (Takeshi Yoshino, <a href="https://google.com">Google</a>, <a href="mailto:tyoshino@chromium.org">tyoshino@chromium.org</a>).</p>
   <h2 class="no-num heading settled" id="ipr"><span class="content">Intellectual property rights</span><a class="self-link" href="#ipr"></a></h2>
   <p>Copyright © WHATWG (Apple, Google, Mozilla, Microsoft). This work is licensed under a <a href="https://creativecommons.org/licenses/by/4.0/" rel="license">Creative Commons Attribution 4.0
International License</a>. To the extent portions of it are incorporated into source code, such
portions in the source code are licensed under the <a href="https://opensource.org/licenses/BSD-3-Clause" rel="license">BSD 3-Clause License</a> instead.</p>
   <p>This is the Living Standard. Those
interested in the patent-review version should view the <a href="/review-drafts/2021-02/">Living Standard Review Draft</a>.</p>
  </main>
<script>
"use strict";
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("/service-worker.js");
}
</script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li>
    abort
    <ul>
     <li><a href="#writablestream-abort">dfn for WritableStream</a><span>, in § 9.2.2</span>
     <li><a href="#dom-underlyingsink-abort">dict-member for UnderlyingSink</a><span>, in § 5.2.3</span>
    </ul>
   <li>
    abort()
    <ul>
     <li><a href="#ws-abort">method for WritableStream</a><span>, in § 5.2.4</span>
     <li><a href="#default-writer-abort">method for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li><a href="#writablestreamdefaultcontroller-abortalgorithm">[[abortAlgorithm]]</a><span>, in § 5.4.2</span>
   <li><a href="#writablestream-set-up-abortalgorithm">abortAlgorithm</a><span>, in § 9.2.1</span>
   <li><a href="#abort-a-writable-stream">abort a writable stream</a><span>, in § 2.2</span>
   <li><a href="#writablestream-abort">aborting</a><span>, in § 9.2.2</span>
   <li>
    abort(reason)
    <ul>
     <li><a href="#ws-abort">method for WritableStream</a><span>, in § 5.2.4</span>
     <li><a href="#default-writer-abort">method for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li>
    [[AbortSteps]]
    <ul>
     <li><a href="#abstract-opdef-writablestreamcontroller-abortsteps">abstract-op for WritableStreamController</a><span>, in § 5.5.2</span>
     <li><a href="#ws-default-controller-private-abort">abstract-op for WritableStreamDefaultController</a><span>, in § 5.4.4</span>
    </ul>
   <li><a href="#acquire-readable-stream-byob-reader">AcquireReadableStreamBYOBReader</a><span>, in § 4.9.1</span>
   <li><a href="#acquire-readable-stream-reader">AcquireReadableStreamDefaultReader</a><span>, in § 4.9.1</span>
   <li><a href="#acquire-writable-stream-default-writer">AcquireWritableStreamDefaultWriter</a><span>, in § 5.5.1</span>
   <li><a href="#active">active</a><span>, in § 2.6</span>
   <li><a href="#active">active reader</a><span>, in § 2.6</span>
   <li><a href="#active">active writer</a><span>, in § 2.6</span>
   <li><a href="#readablebytestreamcontroller-autoallocatechunksize">[[autoAllocateChunkSize]]</a><span>, in § 4.7.2</span>
   <li><a href="#dom-underlyingsource-autoallocatechunksize">autoAllocateChunkSize</a><span>, in § 4.2.3</span>
   <li>
    [[backpressure]]
    <ul>
     <li><a href="#transformstream-backpressure">dfn for TransformStream</a><span>, in § 6.2.2</span>
     <li><a href="#writablestream-backpressure">dfn for WritableStream</a><span>, in § 5.2.2</span>
    </ul>
   <li><a href="#backpressure">backpressure</a><span>, in § 2.4</span>
   <li><a href="#transformstream-backpressurechangepromise">[[backpressureChangePromise]]</a><span>, in § 6.2.2</span>
   <li><a href="#branches-of-a-readable-stream-tee">branches of a readable stream tee</a><span>, in § 2.1</span>
   <li>
    buffer
    <ul>
     <li><a href="#pull-into-descriptor-buffer">dfn for pull-into descriptor</a><span>, in § 4.7.2</span>
     <li><a href="#readable-byte-stream-queue-entry-buffer">dfn for readable byte stream queue entry</a><span>, in § 4.7.2</span>
    </ul>
   <li><a href="#dom-readablestreamreadermode-byob">"byob"</a><span>, in § 4.2.1</span>
   <li><a href="#byob-readers">BYOB readers</a><span>, in § 2.6</span>
   <li><a href="#readablebytestreamcontroller-byobrequest">[[byobRequest]]</a><span>, in § 4.7.2</span>
   <li><a href="#rbs-controller-byob-request">byobRequest</a><span>, in § 4.7.3</span>
   <li>
    byte length
    <ul>
     <li><a href="#pull-into-descriptor-byte-length">dfn for pull-into descriptor</a><span>, in § 4.7.2</span>
     <li><a href="#readable-byte-stream-queue-entry-byte-length">dfn for readable byte stream queue entry</a><span>, in § 4.7.2</span>
    </ul>
   <li><a href="#bytelengthqueuingstrategy">ByteLengthQueuingStrategy</a><span>, in § 7.2.1</span>
   <li><a href="#blqs-constructor">ByteLengthQueuingStrategy(init)</a><span>, in § 7.2.3</span>
   <li><a href="#byte-length-queuing-strategy-size-function">byte length queuing strategy size function</a><span>, in § 7.2.2</span>
   <li>
    byte offset
    <ul>
     <li><a href="#pull-into-descriptor-byte-offset">dfn for pull-into descriptor</a><span>, in § 4.7.2</span>
     <li><a href="#readable-byte-stream-queue-entry-byte-offset">dfn for readable byte stream queue entry</a><span>, in § 4.7.2</span>
    </ul>
   <li><a href="#dom-readablestreamtype-bytes">"bytes"</a><span>, in § 4.2.3</span>
   <li><a href="#dom-readablestreamtype-bytes">bytes</a><span>, in § 4.2.3</span>
   <li><a href="#pull-into-descriptor-bytes-filled">bytes filled</a><span>, in § 4.7.2</span>
   <li>
    cancel
    <ul>
     <li><a href="#readablestream-cancel">dfn for ReadableStream</a><span>, in § 9.1.2</span>
     <li><a href="#readablestreamdefaultreader-cancel">dfn for ReadableStreamDefaultReader</a><span>, in § 9.1.2</span>
     <li><a href="#dom-underlyingsource-cancel">dict-member for UnderlyingSource</a><span>, in § 4.2.3</span>
    </ul>
   <li>
    cancel()
    <ul>
     <li><a href="#rs-cancel">method for ReadableStream</a><span>, in § 4.2.4</span>
     <li><a href="#generic-reader-cancel">method for ReadableStreamGenericReader</a><span>, in § 4.3.3</span>
    </ul>
   <li>
    [[cancelAlgorithm]]
    <ul>
     <li><a href="#readablebytestreamcontroller-cancelalgorithm">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-cancelalgorithm">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
    </ul>
   <li><a href="#readablestream-set-up-cancelalgorithm">cancelAlgorithm</a><span>, in § 9.1.1</span>
   <li><a href="#cancel-a-readable-stream">cancel a readable stream</a><span>, in § 2.1</span>
   <li>
    cancel(reason)
    <ul>
     <li><a href="#rs-cancel">method for ReadableStream</a><span>, in § 4.2.4</span>
     <li><a href="#generic-reader-cancel">method for ReadableStreamGenericReader</a><span>, in § 4.3.3</span>
    </ul>
   <li>
    [[CancelSteps]]
    <ul>
     <li><a href="#rbs-controller-private-cancel">abstract-op for ReadableByteStreamController</a><span>, in § 4.7.4</span>
     <li><a href="#abstract-opdef-readablestreamcontroller-cancelsteps">abstract-op for ReadableStreamController</a><span>, in § 4.9.2</span>
     <li><a href="#rs-default-controller-private-cancel">abstract-op for ReadableStreamDefaultController</a><span>, in § 4.6.4</span>
    </ul>
   <li><a href="#chunk">chunk</a><span>, in § 2</span>
   <li>
    chunk steps
    <ul>
     <li><a href="#read-request-chunk-steps">dfn for read request</a><span>, in § 4.4.2</span>
     <li><a href="#read-into-request-chunk-steps">dfn for read-into request</a><span>, in § 4.5.2</span>
    </ul>
   <li>
    close
    <ul>
     <li><a href="#readablestream-close">dfn for ReadableStream</a><span>, in § 9.1.1</span>
     <li><a href="#writablestream-close">dfn for WritableStream</a><span>, in § 9.2.2</span>
     <li><a href="#dom-underlyingsink-close">dict-member for UnderlyingSink</a><span>, in § 5.2.3</span>
    </ul>
   <li>
    close()
    <ul>
     <li><a href="#rbs-controller-close">method for ReadableByteStreamController</a><span>, in § 4.7.3</span>
     <li><a href="#rs-default-controller-close">method for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ws-close">method for WritableStream</a><span>, in § 5.2.4</span>
     <li><a href="#default-writer-close">method for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li><a href="#writablestreamdefaultcontroller-closealgorithm">[[closeAlgorithm]]</a><span>, in § 5.4.2</span>
   <li><a href="#writablestream-set-up-closealgorithm">closeAlgorithm</a><span>, in § 9.2.1</span>
   <li>
    closed
    <ul>
     <li><a href="#generic-reader-closed">attribute for ReadableStreamGenericReader</a><span>, in § 4.3.3</span>
     <li><a href="#default-writer-closed">attribute for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
     <li><a href="#readablestream-closed">dfn for ReadableStream</a><span>, in § 9.1.3</span>
    </ul>
   <li>
    [[closedPromise]]
    <ul>
     <li><a href="#readablestreamgenericreader-closedpromise">dfn for ReadableStreamGenericReader</a><span>, in § 4.3.2</span>
     <li><a href="#writablestreamdefaultwriter-closedpromise">dfn for WritableStreamDefaultWriter</a><span>, in § 5.3.2</span>
    </ul>
   <li><a href="#writablestream-closerequest">[[closeRequest]]</a><span>, in § 5.2.2</span>
   <li>
    [[closeRequested]]
    <ul>
     <li><a href="#readablebytestreamcontroller-closerequested">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-closerequested">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
    </ul>
   <li><a href="#close-sentinel">close sentinel</a><span>, in § 5.4.2</span>
   <li>
    close steps
    <ul>
     <li><a href="#read-request-close-steps">dfn for read request</a><span>, in § 4.4.2</span>
     <li><a href="#read-into-request-close-steps">dfn for read-into request</a><span>, in § 4.5.2</span>
    </ul>
   <li><a href="#writablestream-close">closing</a><span>, in § 9.2.2</span>
   <li>
    constructor()
    <ul>
     <li><a href="#rs-constructor">constructor for ReadableStream</a><span>, in § 4.2.4</span>
     <li><a href="#ts-constructor">constructor for TransformStream</a><span>, in § 6.2.4</span>
     <li><a href="#ws-constructor">constructor for WritableStream</a><span>, in § 5.2.4</span>
    </ul>
   <li>
    constructor(init)
    <ul>
     <li><a href="#blqs-constructor">constructor for ByteLengthQueuingStrategy</a><span>, in § 7.2.3</span>
     <li><a href="#cqs-constructor">constructor for CountQueuingStrategy</a><span>, in § 7.3.3</span>
    </ul>
   <li>
    constructor(stream)
    <ul>
     <li><a href="#byob-reader-constructor">constructor for ReadableStreamBYOBReader</a><span>, in § 4.5.3</span>
     <li><a href="#default-reader-constructor">constructor for ReadableStreamDefaultReader</a><span>, in § 4.4.3</span>
     <li><a href="#default-writer-constructor">constructor for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li><a href="#ts-constructor">constructor(transformer)</a><span>, in § 6.2.4</span>
   <li><a href="#ts-constructor">constructor(transformer, writableStrategy)</a><span>, in § 6.2.4</span>
   <li><a href="#ts-constructor">constructor(transformer, writableStrategy, readableStrategy)</a><span>, in § 6.2.4</span>
   <li><a href="#ws-constructor">constructor(underlyingSink)</a><span>, in § 5.2.4</span>
   <li><a href="#ws-constructor">constructor(underlyingSink, strategy)</a><span>, in § 5.2.4</span>
   <li><a href="#rs-constructor">constructor(underlyingSource)</a><span>, in § 4.2.4</span>
   <li><a href="#rs-constructor">constructor(underlyingSource, strategy)</a><span>, in § 4.2.4</span>
   <li><a href="#consumer">consumer</a><span>, in § 2.1</span>
   <li>
    [[controller]]
    <ul>
     <li><a href="#readablestream-controller">dfn for ReadableStream</a><span>, in § 4.2.2</span>
     <li><a href="#readablestreambyobrequest-controller">dfn for ReadableStreamBYOBRequest</a><span>, in § 4.8.2</span>
     <li><a href="#transformstream-controller">dfn for TransformStream</a><span>, in § 6.2.2</span>
     <li><a href="#writablestream-controller">dfn for WritableStream</a><span>, in § 5.2.2</span>
    </ul>
   <li><a href="#countqueuingstrategy">CountQueuingStrategy</a><span>, in § 7.3.1</span>
   <li><a href="#cqs-constructor">CountQueuingStrategy(init)</a><span>, in § 7.3.3</span>
   <li><a href="#count-queuing-strategy-size-function">count queuing strategy size function</a><span>, in § 7.3.2</span>
   <li><a href="#create-an-identity-transformstream">create an identity TransformStream</a><span>, in § 9.3.1</span>
   <li><a href="#readablestream-create-a-proxy">create a proxy</a><span>, in § 9.5</span>
   <li><a href="#create-readable-stream">CreateReadableStream</a><span>, in § 4.9.1</span>
   <li><a href="#create-writable-stream">CreateWritableStream</a><span>, in § 5.5.1</span>
   <li><a href="#create-an-identity-transformstream">creating an identity TransformStream</a><span>, in § 9.3.1</span>
   <li><a href="#readablestream-create-a-proxy">creating a proxy</a><span>, in § 9.5</span>
   <li><a href="#abstract-opdef-crossrealmtransformsenderror">CrossRealmTransformSendError</a><span>, in § 8.2</span>
   <li><a href="#default-readers">default readers</a><span>, in § 2.6</span>
   <li><a href="#dequeue-value">DequeueValue</a><span>, in § 8.1</span>
   <li>
    desiredSize
    <ul>
     <li><a href="#rbs-controller-desired-size">attribute for ReadableByteStreamController</a><span>, in § 4.7.3</span>
     <li><a href="#rs-default-controller-desired-size">attribute for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ts-default-controller-desired-size">attribute for TransformStreamDefaultController</a><span>, in § 6.3.3</span>
     <li><a href="#default-writer-desired-size">attribute for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li><a href="#desired-size-to-fill-a-streams-internal-queue">desired size to fill a stream’s internal queue</a><span>, in § 2.5</span>
   <li>
    [[Detached]]
    <ul>
     <li><a href="#readablestream-detached">dfn for ReadableStream</a><span>, in § 4.2.2</span>
     <li><a href="#transformstream-detached">dfn for TransformStream</a><span>, in § 6.2.2</span>
     <li><a href="#writablestream-detached">dfn for WritableStream</a><span>, in § 5.2.2</span>
    </ul>
   <li><a href="#readablestream-disturbed">[[disturbed]]</a><span>, in § 4.2.2</span>
   <li><a href="#is-readable-stream-disturbed">disturbed</a><span>, in § 9.1.3</span>
   <li>
    done
    <ul>
     <li><a href="#dom-readablestreambyobreadresult-done">dict-member for ReadableStreamBYOBReadResult</a><span>, in § 4.5.1</span>
     <li><a href="#dom-readablestreamdefaultreadresult-done">dict-member for ReadableStreamDefaultReadResult</a><span>, in § 4.4.1</span>
    </ul>
   <li><a href="#duplex-stream">duplex stream</a><span>, in § 9.4.1</span>
   <li><a href="#pull-into-descriptor-element-size">element size</a><span>, in § 4.7.2</span>
   <li><a href="#endpoint-pair">endpoint pair</a><span>, in § 9.4.2</span>
   <li>
    enqueue
    <ul>
     <li><a href="#readablestream-enqueue">dfn for ReadableStream</a><span>, in § 9.1.1</span>
     <li><a href="#transformstream-enqueue">dfn for TransformStream</a><span>, in § 9.3.1</span>
    </ul>
   <li>
    enqueue()
    <ul>
     <li><a href="#rs-default-controller-enqueue">method for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ts-default-controller-enqueue">method for TransformStreamDefaultController</a><span>, in § 6.3.3</span>
    </ul>
   <li>
    enqueue(chunk)
    <ul>
     <li><a href="#rbs-controller-enqueue">method for ReadableByteStreamController</a><span>, in § 4.7.3</span>
     <li><a href="#rs-default-controller-enqueue">method for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ts-default-controller-enqueue">method for TransformStreamDefaultController</a><span>, in § 6.3.3</span>
    </ul>
   <li><a href="#enqueue-value-with-size">EnqueueValueWithSize</a><span>, in § 8.1</span>
   <li>
    error
    <ul>
     <li><a href="#readablestream-error">dfn for ReadableStream</a><span>, in § 9.1.1</span>
     <li><a href="#transformstream-error">dfn for TransformStream</a><span>, in § 9.3.1</span>
    </ul>
   <li>
    error()
    <ul>
     <li><a href="#rbs-controller-error">method for ReadableByteStreamController</a><span>, in § 4.7.3</span>
     <li><a href="#rs-default-controller-error">method for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ts-default-controller-error">method for TransformStreamDefaultController</a><span>, in § 6.3.3</span>
     <li><a href="#ws-default-controller-error">method for WritableStreamDefaultController</a><span>, in § 5.4.3</span>
    </ul>
   <li>
    error(e)
    <ul>
     <li><a href="#rbs-controller-error">method for ReadableByteStreamController</a><span>, in § 4.7.3</span>
     <li><a href="#rs-default-controller-error">method for ReadableStreamDefaultController</a><span>, in § 4.6.3</span>
     <li><a href="#ts-default-controller-error">method for TransformStreamDefaultController</a><span>, in § 6.3.3</span>
     <li><a href="#ws-default-controller-error">method for WritableStreamDefaultController</a><span>, in § 5.4.3</span>
    </ul>
   <li><a href="#readablestream-errored">errored</a><span>, in § 9.1.3</span>
   <li><a href="#ts-default-controller-error">error(reason)</a><span>, in § 6.3.3</span>
   <li>
    [[ErrorSteps]]
    <ul>
     <li><a href="#abstract-opdef-writablestreamcontroller-errorsteps">abstract-op for WritableStreamController</a><span>, in § 5.5.2</span>
     <li><a href="#ws-default-controller-private-error">abstract-op for WritableStreamDefaultController</a><span>, in § 5.4.4</span>
    </ul>
   <li>
    error steps
    <ul>
     <li><a href="#read-request-error-steps">dfn for read request</a><span>, in § 4.4.2</span>
     <li><a href="#read-into-request-error-steps">dfn for read-into request</a><span>, in § 4.5.2</span>
    </ul>
   <li><a href="#validate-and-normalize-high-water-mark">ExtractHighWaterMark</a><span>, in § 7.4</span>
   <li><a href="#make-size-algorithm-from-size-function">ExtractSizeAlgorithm</a><span>, in § 7.4</span>
   <li><a href="#rs-pipeTo-finalize">Finalize</a><span>, in § 4.9.1</span>
   <li><a href="#dom-transformer-flush">flush</a><span>, in § 6.2.3</span>
   <li><a href="#transformstreamdefaultcontroller-flushalgorithm">[[flushAlgorithm]]</a><span>, in § 6.3.2</span>
   <li><a href="#transformstream-set-up-flushalgorithm">flushAlgorithm</a><span>, in § 9.3.1</span>
   <li><a href="#generictransformstream">GenericTransformStream</a><span>, in § 9.3.2</span>
   <li><a href="#readablestream-get-a-reader">get a reader</a><span>, in § 9.1.2</span>
   <li><a href="#writablestream-get-a-writer">get a writer</a><span>, in § 9.2.2</span>
   <li><a href="#rs-get-reader">getReader()</a><span>, in § 4.2.4</span>
   <li><a href="#rs-get-reader">getReader(options)</a><span>, in § 4.2.4</span>
   <li><a href="#readablestream-get-a-reader">getting a reader</a><span>, in § 9.1.2</span>
   <li><a href="#writablestream-get-a-writer">getting a writer</a><span>, in § 9.2.2</span>
   <li><a href="#ws-get-writer">getWriter()</a><span>, in § 5.2.4</span>
   <li>
    [[highWaterMark]]
    <ul>
     <li><a href="#bytelengthqueuingstrategy-highwatermark">dfn for ByteLengthQueuingStrategy</a><span>, in § 7.2.2</span>
     <li><a href="#countqueuingstrategy-highwatermark">dfn for CountQueuingStrategy</a><span>, in § 7.3.2</span>
    </ul>
   <li><a href="#high-water-mark">high water mark</a><span>, in § 2.5</span>
   <li>
    highWaterMark
    <ul>
     <li><a href="#blqs-high-water-mark">attribute for ByteLengthQueuingStrategy</a><span>, in § 7.2.3</span>
     <li><a href="#cqs-high-water-mark">attribute for CountQueuingStrategy</a><span>, in § 7.3.3</span>
     <li><a href="#readablestream-set-up-highwatermark">dfn for ReadableStream/set up</a><span>, in § 9.1.1</span>
     <li><a href="#writablestream-set-up-highwatermark">dfn for WritableStream/set up</a><span>, in § 9.2.1</span>
     <li><a href="#dom-queuingstrategy-highwatermark">dict-member for QueuingStrategy</a><span>, in § 7.1</span>
     <li><a href="#dom-queuingstrategyinit-highwatermark">dict-member for QueuingStrategyInit</a><span>, in § 7.1</span>
    </ul>
   <li><a href="#identity-transform-stream">identity transform stream</a><span>, in § 2.3</span>
   <li><a href="#writablestream-inflightcloserequest">[[inFlightCloseRequest]]</a><span>, in § 5.2.2</span>
   <li><a href="#writablestream-inflightwriterequest">[[inFlightWriteRequest]]</a><span>, in § 5.2.2</span>
   <li><a href="#initialize-readable-stream">InitializeReadableStream</a><span>, in § 4.9.1</span>
   <li><a href="#initialize-transform-stream">InitializeTransformStream</a><span>, in § 6.4.1</span>
   <li><a href="#initialize-writable-stream">InitializeWritableStream</a><span>, in § 5.5.1</span>
   <li><a href="#internal-queues">internal queues</a><span>, in § 2.5</span>
   <li><a href="#is-non-negative-number">IsNonNegativeNumber</a><span>, in § 8.3</span>
   <li><a href="#is-readable-stream-locked">IsReadableStreamLocked</a><span>, in § 4.9.1</span>
   <li><a href="#is-writable-stream-locked">IsWritableStreamLocked</a><span>, in § 5.5.1</span>
   <li><a href="#lock">lock</a><span>, in § 2.6</span>
   <li>
    locked
    <ul>
     <li><a href="#rs-locked">attribute for ReadableStream</a><span>, in § 4.2.4</span>
     <li><a href="#ws-locked">attribute for WritableStream</a><span>, in § 5.2.4</span>
     <li><a href="#readablestream-locked">dfn for ReadableStream</a><span>, in § 9.1.3</span>
    </ul>
   <li><a href="#lock">locked to a reader</a><span>, in § 2.6</span>
   <li><a href="#lock">locked to a writer</a><span>, in § 2.6</span>
   <li><a href="#dom-readablestreamgetreaderoptions-mode">mode</a><span>, in § 4.2.1</span>
   <li><a href="#readablestream-need-more-data">need more data</a><span>, in § 9.1.1</span>
   <li><a href="#readablestream-need-more-data">needs more data</a><span>, in § 9.1.1</span>
   <li><a href="#original-source">original source</a><span>, in § 2.4</span>
   <li><a href="#abstract-opdef-packandpostmessage">PackAndPostMessage</a><span>, in § 8.2</span>
   <li><a href="#abstract-opdef-packandpostmessagehandlingerror">PackAndPostMessageHandlingError</a><span>, in § 8.2</span>
   <li><a href="#peek-queue-value">PeekQueueValue</a><span>, in § 8.1</span>
   <li><a href="#writablestream-pendingabortrequest">[[pendingAbortRequest]]</a><span>, in § 5.2.2</span>
   <li><a href="#pending-abort-request">pending abort request</a><span>, in § 5.2.2</span>
   <li><a href="#readablebytestreamcontroller-pendingpullintos">[[pendingPullIntos]]</a><span>, in § 4.7.2</span>
   <li><a href="#readablestream-pipe">pipe</a><span>, in § 9.5</span>
   <li><a href="#pipe-chain">pipe chain</a><span>, in § 2.4</span>
   <li><a href="#readablestream-pipe-through">piped through</a><span>, in § 9.5</span>
   <li><a href="#readablestream-pipe">piped to</a><span>, in § 9.5</span>
   <li><a href="#readablestream-pipe-through">pipe through</a><span>, in § 9.5</span>
   <li><a href="#rs-pipe-through">pipeThrough(transform)</a><span>, in § 4.2.4</span>
   <li><a href="#rs-pipe-through">pipeThrough(transform, options)</a><span>, in § 4.2.4</span>
   <li><a href="#readablestream-pipe">pipe to</a><span>, in § 9.5</span>
   <li><a href="#rs-pipe-to">pipeTo(destination)</a><span>, in § 4.2.4</span>
   <li><a href="#rs-pipe-to">pipeTo(destination, options)</a><span>, in § 4.2.4</span>
   <li><a href="#piping">piping</a><span>, in § 2.4</span>
   <li><a href="#readablestream-pipe-through">piping through</a><span>, in § 9.5</span>
   <li><a href="#readablestream-pipe">piping to</a><span>, in § 9.5</span>
   <li>
    preventAbort
    <ul>
     <li><a href="#readablestream-pipe-through-preventabort">dfn for ReadableStream/pipe through, ReadableStream/piped through</a><span>, in § 9.5</span>
     <li><a href="#readablestream-pipe-to-preventabort">dfn for ReadableStream/pipe to, ReadableStream/piped to</a><span>, in § 9.5</span>
     <li><a href="#dom-streampipeoptions-preventabort">dict-member for StreamPipeOptions</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#readablestream-async-iterator-prevent-cancel">prevent cancel</a><span>, in § 4.2.5</span>
   <li>
    preventCancel
    <ul>
     <li><a href="#readablestream-pipe-through-preventcancel">dfn for ReadableStream/pipe through, ReadableStream/piped through</a><span>, in § 9.5</span>
     <li><a href="#readablestream-pipe-to-preventcancel">dfn for ReadableStream/pipe to, ReadableStream/piped to</a><span>, in § 9.5</span>
     <li><a href="#dom-readablestreamiteratoroptions-preventcancel">dict-member for ReadableStreamIteratorOptions</a><span>, in § 4.2.1</span>
     <li><a href="#dom-streampipeoptions-preventcancel">dict-member for StreamPipeOptions</a><span>, in § 4.2.1</span>
    </ul>
   <li>
    preventClose
    <ul>
     <li><a href="#readablestream-pipe-through-preventclose">dfn for ReadableStream/pipe through, ReadableStream/piped through</a><span>, in § 9.5</span>
     <li><a href="#readablestream-pipe-to-preventclose">dfn for ReadableStream/pipe to, ReadableStream/piped to</a><span>, in § 9.5</span>
     <li><a href="#dom-streampipeoptions-preventclose">dict-member for StreamPipeOptions</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#producer">producer</a><span>, in § 2.2</span>
   <li><a href="#pending-abort-request-promise">promise</a><span>, in § 5.2.2</span>
   <li><a href="#dom-underlyingsource-pull">pull</a><span>, in § 4.2.3</span>
   <li>
    [[pullAgain]]
    <ul>
     <li><a href="#readablebytestreamcontroller-pullagain">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-pullagain">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
    </ul>
   <li>
    [[pullAlgorithm]]
    <ul>
     <li><a href="#readablebytestreamcontroller-pullalgorithm">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-pullalgorithm">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
    </ul>
   <li><a href="#readablestream-set-up-pullalgorithm">pullAlgorithm</a><span>, in § 9.1.1</span>
   <li>
    [[pulling]]
    <ul>
     <li><a href="#readablebytestreamcontroller-pulling">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-pulling">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
    </ul>
   <li><a href="#pull-into-descriptor">pull-into descriptor</a><span>, in § 4.7.2</span>
   <li><a href="#pull-source">pull source</a><span>, in § 2.1</span>
   <li>
    [[PullSteps]]
    <ul>
     <li><a href="#rbs-controller-private-pull">abstract-op for ReadableByteStreamController</a><span>, in § 4.7.4</span>
     <li><a href="#abstract-opdef-readablestreamcontroller-pullsteps">abstract-op for ReadableStreamController</a><span>, in § 4.9.2</span>
     <li><a href="#rs-default-controller-private-pull">abstract-op for ReadableStreamDefaultController</a><span>, in § 4.6.4</span>
    </ul>
   <li><a href="#push-source">push source</a><span>, in § 2.1</span>
   <li>
    [[queue]]
    <ul>
     <li><a href="#readablebytestreamcontroller-queue">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-queue">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#writablestreamdefaultcontroller-queue">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
    </ul>
   <li>
    [[queueTotalSize]]
    <ul>
     <li><a href="#readablebytestreamcontroller-queuetotalsize">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-queuetotalsize">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#writablestreamdefaultcontroller-queuetotalsize">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
    </ul>
   <li><a href="#queuing-strategy">queuing strategy</a><span>, in § 2.5</span>
   <li><a href="#dictdef-queuingstrategy">QueuingStrategy</a><span>, in § 7.1</span>
   <li><a href="#dictdef-queuingstrategyinit">QueuingStrategyInit</a><span>, in § 7.1</span>
   <li><a href="#callbackdef-queuingstrategysize">QueuingStrategySize</a><span>, in § 7.1</span>
   <li><a href="#default-reader-read">read()</a><span>, in § 4.4.3</span>
   <li><a href="#transformstream-readable">[[readable]]</a><span>, in § 6.2.2</span>
   <li>
    readable
    <ul>
     <li><a href="#dom-generictransformstream-readable">attribute for GenericTransformStream</a><span>, in § 9.3.2</span>
     <li><a href="#ts-readable">attribute for TransformStream</a><span>, in § 6.2.4</span>
     <li><a href="#readablestream-readable">dfn for ReadableStream</a><span>, in § 9.1.3</span>
     <li><a href="#dom-readablewritablepair-readable">dict-member for ReadableWritablePair</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#readable-byte-stream">readable byte stream</a><span>, in § 2.1</span>
   <li><a href="#readablebytestreamcontroller">ReadableByteStreamController</a><span>, in § 4.7.1</span>
   <li><a href="#readable-byte-stream-controller-call-pull-if-needed">ReadableByteStreamControllerCallPullIfNeeded</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-clear-algorithms">ReadableByteStreamControllerClearAlgorithms</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-clear-pending-pull-intos">ReadableByteStreamControllerClearPendingPullIntos</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-close">ReadableByteStreamControllerClose</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-commit-pull-into-descriptor">ReadableByteStreamControllerCommitPullIntoDescriptor</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-convert-pull-into-descriptor">ReadableByteStreamControllerConvertPullIntoDescriptor</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-enqueue">ReadableByteStreamControllerEnqueue</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-enqueue-chunk-to-queue">ReadableByteStreamControllerEnqueueChunkToQueue</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-error">ReadableByteStreamControllerError</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-fill-head-pull-into-descriptor">ReadableByteStreamControllerFillHeadPullIntoDescriptor</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">ReadableByteStreamControllerFillPullIntoDescriptorFromQueue</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-get-desired-size">ReadableByteStreamControllerGetDesiredSize</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-handle-queue-drain">ReadableByteStreamControllerHandleQueueDrain</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-invalidate-byob-request">ReadableByteStreamControllerInvalidateBYOBRequest</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-process-pull-into-descriptors-using-queue">ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-pull-into">ReadableByteStreamControllerPullInto</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-respond">ReadableByteStreamControllerRespond</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-respond-in-closed-state">ReadableByteStreamControllerRespondInClosedState</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-respond-in-readable-state">ReadableByteStreamControllerRespondInReadableState</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-respond-internal">ReadableByteStreamControllerRespondInternal</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-respond-with-new-view">ReadableByteStreamControllerRespondWithNewView</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-shift-pending-pull-into">ReadableByteStreamControllerShiftPendingPullInto</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-controller-should-call-pull">ReadableByteStreamControllerShouldCallPull</a><span>, in § 4.9.5</span>
   <li><a href="#readable-byte-stream-queue-entry">readable byte stream queue entry</a><span>, in § 4.7.2</span>
   <li><a href="#readable-side">readable side</a><span>, in § 2.3</span>
   <li><a href="#readable-stream">readable stream</a><span>, in § 2.1</span>
   <li><a href="#readablestream">ReadableStream</a><span>, in § 4.2.1</span>
   <li><a href="#rs-constructor">ReadableStream()</a><span>, in § 4.2.4</span>
   <li><a href="#readable-stream-add-read-into-request">ReadableStreamAddReadIntoRequest</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-add-read-request">ReadableStreamAddReadRequest</a><span>, in § 4.9.2</span>
   <li><a href="#readablestreambyobreader">ReadableStreamBYOBReader</a><span>, in § 4.5.1</span>
   <li><a href="#readable-stream-byob-reader-read">ReadableStreamBYOBReaderRead</a><span>, in § 4.9.3</span>
   <li><a href="#byob-reader-constructor">ReadableStreamBYOBReader(stream)</a><span>, in § 4.5.3</span>
   <li><a href="#dictdef-readablestreambyobreadresult">ReadableStreamBYOBReadResult</a><span>, in § 4.5.1</span>
   <li><a href="#readablestreambyobrequest">ReadableStreamBYOBRequest</a><span>, in § 4.8.1</span>
   <li><a href="#readable-stream-cancel">ReadableStreamCancel</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-close">ReadableStreamClose</a><span>, in § 4.9.2</span>
   <li><a href="#typedefdef-readablestreamcontroller">ReadableStreamController</a><span>, in § 4.2.3</span>
   <li><a href="#readablestreamdefaultcontroller">ReadableStreamDefaultController</a><span>, in § 4.6.1</span>
   <li><a href="#readable-stream-default-controller-call-pull-if-needed">ReadableStreamDefaultControllerCallPullIfNeeded</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-can-close-or-enqueue">ReadableStreamDefaultControllerCanCloseOrEnqueue</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-clear-algorithms">ReadableStreamDefaultControllerClearAlgorithms</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-close">ReadableStreamDefaultControllerClose</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-enqueue">ReadableStreamDefaultControllerEnqueue</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-error">ReadableStreamDefaultControllerError</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-get-desired-size">ReadableStreamDefaultControllerGetDesiredSize</a><span>, in § 4.9.4</span>
   <li><a href="#rs-default-controller-has-backpressure">ReadableStreamDefaultControllerHasBackpressure</a><span>, in § 4.9.4</span>
   <li><a href="#readable-stream-default-controller-should-call-pull">ReadableStreamDefaultControllerShouldCallPull</a><span>, in § 4.9.4</span>
   <li><a href="#readablestreamdefaultreader">ReadableStreamDefaultReader</a><span>, in § 4.4.1</span>
   <li><a href="#readable-stream-default-reader-read">ReadableStreamDefaultReaderRead</a><span>, in § 4.9.3</span>
   <li><a href="#default-reader-constructor">ReadableStreamDefaultReader(stream)</a><span>, in § 4.4.3</span>
   <li><a href="#dictdef-readablestreamdefaultreadresult">ReadableStreamDefaultReadResult</a><span>, in § 4.4.1</span>
   <li><a href="#readable-stream-error">ReadableStreamError</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-fulfill-read-into-request">ReadableStreamFulfillReadIntoRequest</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-fulfill-read-request">ReadableStreamFulfillReadRequest</a><span>, in § 4.9.2</span>
   <li><a href="#readablestreamgenericreader">ReadableStreamGenericReader</a><span>, in § 4.3.1</span>
   <li><a href="#readable-stream-get-num-read-into-requests">ReadableStreamGetNumReadIntoRequests</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-get-num-read-requests">ReadableStreamGetNumReadRequests</a><span>, in § 4.9.2</span>
   <li><a href="#dictdef-readablestreamgetreaderoptions">ReadableStreamGetReaderOptions</a><span>, in § 4.2.1</span>
   <li><a href="#readable-stream-has-byob-reader">ReadableStreamHasBYOBReader</a><span>, in § 4.9.2</span>
   <li><a href="#readable-stream-has-default-reader">ReadableStreamHasDefaultReader</a><span>, in § 4.9.2</span>
   <li><a href="#dictdef-readablestreamiteratoroptions">ReadableStreamIteratorOptions</a><span>, in § 4.2.1</span>
   <li><a href="#readable-stream-pipe-to">ReadableStreamPipeTo</a><span>, in § 4.9.1</span>
   <li><a href="#reader">readable stream reader</a><span>, in § 2.6</span>
   <li><a href="#typedefdef-readablestreamreader">ReadableStreamReader</a><span>, in § 4.2.1</span>
   <li><a href="#readable-stream-reader-generic-cancel">ReadableStreamReaderGenericCancel</a><span>, in § 4.9.3</span>
   <li><a href="#readable-stream-reader-generic-initialize">ReadableStreamReaderGenericInitialize</a><span>, in § 4.9.3</span>
   <li><a href="#readable-stream-reader-generic-release">ReadableStreamReaderGenericRelease</a><span>, in § 4.9.3</span>
   <li><a href="#enumdef-readablestreamreadermode">ReadableStreamReaderMode</a><span>, in § 4.2.1</span>
   <li><a href="#readable-stream-tee">ReadableStreamTee</a><span>, in § 4.9.1</span>
   <li><a href="#enumdef-readablestreamtype">ReadableStreamType</a><span>, in § 4.2.3</span>
   <li><a href="#rs-constructor">ReadableStream(underlyingSource)</a><span>, in § 4.2.4</span>
   <li><a href="#rs-constructor">ReadableStream(underlyingSource, strategy)</a><span>, in § 4.2.4</span>
   <li><a href="#dom-transformer-readabletype">readableType</a><span>, in § 6.2.3</span>
   <li><a href="#dictdef-readablewritablepair">ReadableWritablePair</a><span>, in § 4.2.1</span>
   <li><a href="#readablestreamdefaultreader-read-a-chunk">read a chunk</a><span>, in § 9.1.2</span>
   <li><a href="#readablestreamdefaultreader-read-all-bytes">read all bytes</a><span>, in § 9.1.2</span>
   <li><a href="#readablestream-reader">[[reader]]</a><span>, in § 4.2.2</span>
   <li>
    reader
    <ul>
     <li><a href="#reader">definition of</a><span>, in § 2.6</span>
     <li><a href="#readablestream-async-iterator-reader">dfn for ReadableStream async iterator</a><span>, in § 4.2.5</span>
    </ul>
   <li><a href="#pull-into-descriptor-reader-type">reader type</a><span>, in § 4.7.2</span>
   <li><a href="#readablestreamdefaultreader-read-a-chunk">reading a chunk</a><span>, in § 9.1.2</span>
   <li><a href="#readablestreamdefaultreader-read-all-bytes">reading all bytes</a><span>, in § 9.1.2</span>
   <li><a href="#read-into-request">read-into request</a><span>, in § 4.5.2</span>
   <li><a href="#readablestreambyobreader-readintorequests">[[readIntoRequests]]</a><span>, in § 4.5.2</span>
   <li><a href="#read-loop">read-loop</a><span>, in § 9.1.2</span>
   <li><a href="#read-request">read request</a><span>, in § 4.4.2</span>
   <li><a href="#readablestreamdefaultreader-readrequests">[[readRequests]]</a><span>, in § 4.4.2</span>
   <li><a href="#byob-reader-read">read(view)</a><span>, in § 4.5.3</span>
   <li><a href="#default-writer-ready">ready</a><span>, in § 5.3.3</span>
   <li><a href="#writablestreamdefaultwriter-readypromise">[[readyPromise]]</a><span>, in § 5.3.2</span>
   <li><a href="#pending-abort-request-reason">reason</a><span>, in § 5.2.2</span>
   <li>
    release
    <ul>
     <li><a href="#readablestreamdefaultreader-release">dfn for ReadableStreamDefaultReader</a><span>, in § 9.1.2</span>
     <li><a href="#writablestreamdefaultwriter-release">dfn for WritableStreamDefaultWriter</a><span>, in § 9.2.2</span>
    </ul>
   <li><a href="#release-a-lock">release a lock</a><span>, in § 2.6</span>
   <li><a href="#release-a-lock">release a read lock</a><span>, in § 2.6</span>
   <li><a href="#release-a-lock">release a write lock</a><span>, in § 2.6</span>
   <li>
    releaseLock()
    <ul>
     <li><a href="#byob-reader-release-lock">method for ReadableStreamBYOBReader</a><span>, in § 4.5.3</span>
     <li><a href="#default-reader-release-lock">method for ReadableStreamDefaultReader</a><span>, in § 4.4.3</span>
     <li><a href="#default-writer-release-lock">method for WritableStreamDefaultWriter</a><span>, in § 5.3.3</span>
    </ul>
   <li><a href="#reset-queue">ResetQueue</a><span>, in § 8.1</span>
   <li><a href="#rs-byob-request-respond">respond(bytesWritten)</a><span>, in § 4.8.3</span>
   <li><a href="#rs-byob-request-respond-with-new-view">respondWithNewView(view)</a><span>, in § 4.8.3</span>
   <li><a href="#transformstream-set-up">setting up</a><span>, in § 9.3.1</span>
   <li>
    set up
    <ul>
     <li><a href="#readablestream-set-up">dfn for ReadableStream</a><span>, in § 9.1.1</span>
     <li><a href="#transformstream-set-up">dfn for TransformStream</a><span>, in § 9.3.1</span>
     <li><a href="#writablestream-set-up">dfn for WritableStream</a><span>, in § 9.2.1</span>
    </ul>
   <li><a href="#abstract-opdef-setupcrossrealmtransformreadable">SetUpCrossRealmTransformReadable</a><span>, in § 8.2</span>
   <li><a href="#abstract-opdef-setupcrossrealmtransformwritable">SetUpCrossRealmTransformWritable</a><span>, in § 8.2</span>
   <li><a href="#set-up-readable-byte-stream-controller">SetUpReadableByteStreamController</a><span>, in § 4.9.5</span>
   <li><a href="#set-up-readable-byte-stream-controller-from-underlying-source">SetUpReadableByteStreamControllerFromUnderlyingSource</a><span>, in § 4.9.5</span>
   <li><a href="#set-up-readable-stream-byob-reader">SetUpReadableStreamBYOBReader</a><span>, in § 4.9.3</span>
   <li><a href="#set-up-readable-stream-default-controller">SetUpReadableStreamDefaultController</a><span>, in § 4.9.4</span>
   <li><a href="#set-up-readable-stream-default-controller-from-underlying-source">SetUpReadableStreamDefaultControllerFromUnderlyingSource</a><span>, in § 4.9.4</span>
   <li><a href="#set-up-readable-stream-default-reader">SetUpReadableStreamDefaultReader</a><span>, in § 4.9.3</span>
   <li><a href="#set-up-transform-stream-default-controller">SetUpTransformStreamDefaultController</a><span>, in § 6.4.2</span>
   <li><a href="#set-up-transform-stream-default-controller-from-transformer">SetUpTransformStreamDefaultControllerFromTransformer</a><span>, in § 6.4.2</span>
   <li><a href="#set-up-writable-stream-default-controller">SetUpWritableStreamDefaultController</a><span>, in § 5.5.4</span>
   <li><a href="#set-up-writable-stream-default-controller-from-underlying-sink">SetUpWritableStreamDefaultControllerFromUnderlyingSink</a><span>, in § 5.5.4</span>
   <li><a href="#set-up-writable-stream-default-writer">SetUpWritableStreamDefaultWriter</a><span>, in § 5.5.1</span>
   <li><a href="#rs-pipeTo-shutdown">Shutdown</a><span>, in § 4.9.1</span>
   <li><a href="#rs-pipeTo-shutdown-with-action">Shutdown with an action</a><span>, in § 4.9.1</span>
   <li>
    signal
    <ul>
     <li><a href="#readablestream-pipe-through-signal">dfn for ReadableStream/pipe through, ReadableStream/piped through</a><span>, in § 9.5</span>
     <li><a href="#readablestream-pipe-to-signal">dfn for ReadableStream/pipe to, ReadableStream/piped to</a><span>, in § 9.5</span>
     <li><a href="#dom-streampipeoptions-signal">dict-member for StreamPipeOptions</a><span>, in § 4.2.1</span>
    </ul>
   <li>
    size
    <ul>
     <li><a href="#blqs-size">attribute for ByteLengthQueuingStrategy</a><span>, in § 7.2.3</span>
     <li><a href="#cqs-size">attribute for CountQueuingStrategy</a><span>, in § 7.3.3</span>
     <li><a href="#value-with-size-size">dfn for value-with-size</a><span>, in § 8.1</span>
     <li><a href="#dom-queuingstrategy-size">dict-member for QueuingStrategy</a><span>, in § 7.1</span>
    </ul>
   <li>
    sizeAlgorithm
    <ul>
     <li><a href="#readablestream-set-up-sizealgorithm">dfn for ReadableStream/set up</a><span>, in § 9.1.1</span>
     <li><a href="#writablestream-set-up-sizealgorithm">dfn for WritableStream/set up</a><span>, in § 9.2.1</span>
    </ul>
   <li>
    start
    <ul>
     <li><a href="#dom-transformer-start">dict-member for Transformer</a><span>, in § 6.2.3</span>
     <li><a href="#dom-underlyingsink-start">dict-member for UnderlyingSink</a><span>, in § 5.2.3</span>
     <li><a href="#dom-underlyingsource-start">dict-member for UnderlyingSource</a><span>, in § 4.2.3</span>
    </ul>
   <li>
    [[started]]
    <ul>
     <li><a href="#readablebytestreamcontroller-started">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-started">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#writablestreamdefaultcontroller-started">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
    </ul>
   <li>
    [[state]]
    <ul>
     <li><a href="#readablestream-state">dfn for ReadableStream</a><span>, in § 4.2.2</span>
     <li><a href="#writablestream-state">dfn for WritableStream</a><span>, in § 5.2.2</span>
    </ul>
   <li>
    [[storedError]]
    <ul>
     <li><a href="#readablestream-storederror">dfn for ReadableStream</a><span>, in § 4.2.2</span>
     <li><a href="#writablestream-storederror">dfn for WritableStream</a><span>, in § 5.2.2</span>
    </ul>
   <li>
    [[strategyHWM]]
    <ul>
     <li><a href="#readablebytestreamcontroller-strategyhwm">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-strategyhwm">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#writablestreamdefaultcontroller-strategyhwm">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
    </ul>
   <li>
    [[strategySizeAlgorithm]]
    <ul>
     <li><a href="#readablestreamdefaultcontroller-strategysizealgorithm">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#writablestreamdefaultcontroller-strategysizealgorithm">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
    </ul>
   <li>
    [[stream]]
    <ul>
     <li><a href="#readablebytestreamcontroller-stream">dfn for ReadableByteStreamController</a><span>, in § 4.7.2</span>
     <li><a href="#readablestreamdefaultcontroller-stream">dfn for ReadableStreamDefaultController</a><span>, in § 4.6.2</span>
     <li><a href="#readablestreamgenericreader-stream">dfn for ReadableStreamGenericReader</a><span>, in § 4.3.2</span>
     <li><a href="#transformstreamdefaultcontroller-stream">dfn for TransformStreamDefaultController</a><span>, in § 6.3.2</span>
     <li><a href="#writablestreamdefaultcontroller-stream">dfn for WritableStreamDefaultController</a><span>, in § 5.4.2</span>
     <li><a href="#writablestreamdefaultwriter-stream">dfn for WritableStreamDefaultWriter</a><span>, in § 5.3.2</span>
    </ul>
   <li><a href="#dictdef-streampipeoptions">StreamPipeOptions</a><span>, in § 4.2.1</span>
   <li><a href="#readablestream-tee">tee</a><span>, in § 9.1.2</span>
   <li><a href="#rs-tee">tee()</a><span>, in § 4.2.4</span>
   <li><a href="#tee-a-readable-stream">tee a readable stream</a><span>, in § 2.1</span>
   <li><a href="#readablestream-tee">teeing</a><span>, in § 9.1.2</span>
   <li><a href="#transformstream-terminate">terminate</a><span>, in § 9.3.1</span>
   <li><a href="#ts-default-controller-terminate">terminate()</a><span>, in § 6.3.3</span>
   <li><a href="#transfer-array-buffer">TransferArrayBuffer</a><span>, in § 8.3</span>
   <li>
    transform
    <ul>
     <li><a href="#generictransformstream-transform">dfn for GenericTransformStream</a><span>, in § 9.3.2</span>
     <li><a href="#dom-transformer-transform">dict-member for Transformer</a><span>, in § 6.2.3</span>
    </ul>
   <li><a href="#transformstreamdefaultcontroller-transformalgorithm">[[transformAlgorithm]]</a><span>, in § 6.3.2</span>
   <li><a href="#transformstream-set-up-transformalgorithm">transformAlgorithm</a><span>, in § 9.3.1</span>
   <li><a href="#dictdef-transformer">Transformer</a><span>, in § 6.2.3</span>
   <li><a href="#transformer">transformer</a><span>, in § 2.3</span>
   <li><a href="#callbackdef-transformerflushcallback">TransformerFlushCallback</a><span>, in § 6.2.3</span>
   <li><a href="#callbackdef-transformerstartcallback">TransformerStartCallback</a><span>, in § 6.2.3</span>
   <li><a href="#callbackdef-transformertransformcallback">TransformerTransformCallback</a><span>, in § 6.2.3</span>
   <li><a href="#transform-stream">transform stream</a><span>, in § 2.3</span>
   <li><a href="#transformstream">TransformStream</a><span>, in § 6.2.1</span>
   <li><a href="#ts-constructor">TransformStream()</a><span>, in § 6.2.4</span>
   <li><a href="#transformstreamdefaultcontroller">TransformStreamDefaultController</a><span>, in § 6.3.1</span>
   <li><a href="#transform-stream-default-controller-clear-algorithms">TransformStreamDefaultControllerClearAlgorithms</a><span>, in § 6.4.2</span>
   <li><a href="#transform-stream-default-controller-enqueue">TransformStreamDefaultControllerEnqueue</a><span>, in § 6.4.2</span>
   <li><a href="#transform-stream-default-controller-error">TransformStreamDefaultControllerError</a><span>, in § 6.4.2</span>
   <li><a href="#transform-stream-default-controller-perform-transform">TransformStreamDefaultControllerPerformTransform</a><span>, in § 6.4.2</span>
   <li><a href="#transform-stream-default-controller-terminate">TransformStreamDefaultControllerTerminate</a><span>, in § 6.4.2</span>
   <li><a href="#transform-stream-default-sink-abort-algorithm">TransformStreamDefaultSinkAbortAlgorithm</a><span>, in § 6.4.3</span>
   <li><a href="#transform-stream-default-sink-close-algorithm">TransformStreamDefaultSinkCloseAlgorithm</a><span>, in § 6.4.3</span>
   <li><a href="#transform-stream-default-sink-write-algorithm">TransformStreamDefaultSinkWriteAlgorithm</a><span>, in § 6.4.3</span>
   <li><a href="#transform-stream-default-source-pull">TransformStreamDefaultSourcePullAlgorithm</a><span>, in § 6.4.4</span>
   <li><a href="#transform-stream-error">TransformStreamError</a><span>, in § 6.4.1</span>
   <li><a href="#transform-stream-error-writable-and-unblock-write">TransformStreamErrorWritableAndUnblockWrite</a><span>, in § 6.4.1</span>
   <li><a href="#transform-stream-set-backpressure">TransformStreamSetBackpressure</a><span>, in § 6.4.1</span>
   <li><a href="#ts-constructor">TransformStream(transformer)</a><span>, in § 6.2.4</span>
   <li><a href="#ts-constructor">TransformStream(transformer, writableStrategy)</a><span>, in § 6.2.4</span>
   <li><a href="#ts-constructor">TransformStream(transformer, writableStrategy, readableStrategy)</a><span>, in § 6.2.4</span>
   <li>
    type
    <ul>
     <li><a href="#dom-underlyingsink-type">dict-member for UnderlyingSink</a><span>, in § 5.2.3</span>
     <li><a href="#dom-underlyingsource-type">dict-member for UnderlyingSource</a><span>, in § 4.2.3</span>
    </ul>
   <li><a href="#ultimate-sink">ultimate sink</a><span>, in § 2.4</span>
   <li><a href="#underlying-byte-source">underlying byte source</a><span>, in § 2.1</span>
   <li><a href="#underlying-sink">underlying sink</a><span>, in § 2.2</span>
   <li><a href="#dictdef-underlyingsink">UnderlyingSink</a><span>, in § 5.2.3</span>
   <li><a href="#callbackdef-underlyingsinkabortcallback">UnderlyingSinkAbortCallback</a><span>, in § 5.2.3</span>
   <li><a href="#callbackdef-underlyingsinkclosecallback">UnderlyingSinkCloseCallback</a><span>, in § 5.2.3</span>
   <li><a href="#callbackdef-underlyingsinkstartcallback">UnderlyingSinkStartCallback</a><span>, in § 5.2.3</span>
   <li><a href="#callbackdef-underlyingsinkwritecallback">UnderlyingSinkWriteCallback</a><span>, in § 5.2.3</span>
   <li><a href="#underlying-source">underlying source</a><span>, in § 2.1</span>
   <li><a href="#dictdef-underlyingsource">UnderlyingSource</a><span>, in § 4.2.3</span>
   <li><a href="#callbackdef-underlyingsourcecancelcallback">UnderlyingSourceCancelCallback</a><span>, in § 4.2.3</span>
   <li><a href="#callbackdef-underlyingsourcepullcallback">UnderlyingSourcePullCallback</a><span>, in § 4.2.3</span>
   <li><a href="#callbackdef-underlyingsourcestartcallback">UnderlyingSourceStartCallback</a><span>, in § 4.2.3</span>
   <li>
    value
    <ul>
     <li><a href="#value-with-size-value">dfn for value-with-size</a><span>, in § 8.1</span>
     <li><a href="#dom-readablestreambyobreadresult-value">dict-member for ReadableStreamBYOBReadResult</a><span>, in § 4.5.1</span>
     <li><a href="#dom-readablestreamdefaultreadresult-value">dict-member for ReadableStreamDefaultReadResult</a><span>, in § 4.4.1</span>
    </ul>
   <li><a href="#value-with-size">value-with-size</a><span>, in § 8.1</span>
   <li><a href="#readablestreambyobrequest-view">[[view]]</a><span>, in § 4.8.2</span>
   <li><a href="#rs-byob-request-view">view</a><span>, in § 4.8.3</span>
   <li><a href="#pull-into-descriptor-view-constructor">view constructor</a><span>, in § 4.7.2</span>
   <li><a href="#pending-abort-request-was-already-erroring">was already erroring</a><span>, in § 5.2.2</span>
   <li><a href="#transformstream-writable">[[writable]]</a><span>, in § 6.2.2</span>
   <li>
    writable
    <ul>
     <li><a href="#dom-generictransformstream-writable">attribute for GenericTransformStream</a><span>, in § 9.3.2</span>
     <li><a href="#ts-writable">attribute for TransformStream</a><span>, in § 6.2.4</span>
     <li><a href="#dom-readablewritablepair-writable">dict-member for ReadableWritablePair</a><span>, in § 4.2.1</span>
    </ul>
   <li><a href="#writable-side">writable side</a><span>, in § 2.3</span>
   <li><a href="#writable-stream">writable stream</a><span>, in § 2.2</span>
   <li><a href="#writablestream">WritableStream</a><span>, in § 5.2.1</span>
   <li><a href="#ws-constructor">WritableStream()</a><span>, in § 5.2.4</span>
   <li><a href="#writable-stream-abort">WritableStreamAbort</a><span>, in § 5.5.1</span>
   <li><a href="#writable-stream-add-write-request">WritableStreamAddWriteRequest</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-close">WritableStreamClose</a><span>, in § 5.5.1</span>
   <li><a href="#writable-stream-close-queued-or-in-flight">WritableStreamCloseQueuedOrInFlight</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-deal-with-rejection">WritableStreamDealWithRejection</a><span>, in § 5.5.2</span>
   <li><a href="#writablestreamdefaultcontroller">WritableStreamDefaultController</a><span>, in § 5.4.1</span>
   <li><a href="#writable-stream-default-controller-advance-queue-if-needed">WritableStreamDefaultControllerAdvanceQueueIfNeeded</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-clear-algorithms">WritableStreamDefaultControllerClearAlgorithms</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-close">WritableStreamDefaultControllerClose</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-error">WritableStreamDefaultControllerError</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-error-if-needed">WritableStreamDefaultControllerErrorIfNeeded</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-get-backpressure">WritableStreamDefaultControllerGetBackpressure</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-get-chunk-size">WritableStreamDefaultControllerGetChunkSize</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-get-desired-size">WritableStreamDefaultControllerGetDesiredSize</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-process-close">WritableStreamDefaultControllerProcessClose</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-process-write">WritableStreamDefaultControllerProcessWrite</a><span>, in § 5.5.4</span>
   <li><a href="#writable-stream-default-controller-write">WritableStreamDefaultControllerWrite</a><span>, in § 5.5.4</span>
   <li><a href="#writablestreamdefaultwriter">WritableStreamDefaultWriter</a><span>, in § 5.3.1</span>
   <li><a href="#writable-stream-default-writer-abort">WritableStreamDefaultWriterAbort</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-close">WritableStreamDefaultWriterClose</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-close-with-error-propagation">WritableStreamDefaultWriterCloseWithErrorPropagation</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-ensure-closed-promise-rejected">WritableStreamDefaultWriterEnsureClosedPromiseRejected</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-ensure-ready-promise-rejected">WritableStreamDefaultWriterEnsureReadyPromiseRejected</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-get-desired-size">WritableStreamDefaultWriterGetDesiredSize</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-default-writer-release">WritableStreamDefaultWriterRelease</a><span>, in § 5.5.3</span>
   <li><a href="#default-writer-constructor">WritableStreamDefaultWriter(stream)</a><span>, in § 5.3.3</span>
   <li><a href="#writable-stream-default-writer-write">WritableStreamDefaultWriterWrite</a><span>, in § 5.5.3</span>
   <li><a href="#writable-stream-finish-erroring">WritableStreamFinishErroring</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-finish-in-flight-close">WritableStreamFinishInFlightClose</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-finish-in-flight-close-with-error">WritableStreamFinishInFlightCloseWithError</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-finish-in-flight-write">WritableStreamFinishInFlightWrite</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-finish-in-flight-write-with-error">WritableStreamFinishInFlightWriteWithError</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-has-operation-marked-in-flight">WritableStreamHasOperationMarkedInFlight</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-mark-close-request-in-flight">WritableStreamMarkCloseRequestInFlight</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-mark-first-write-request-in-flight">WritableStreamMarkFirstWriteRequestInFlight</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-reject-close-and-closed-promise-if-needed">WritableStreamRejectCloseAndClosedPromiseIfNeeded</a><span>, in § 5.5.2</span>
   <li><a href="#writable-stream-start-erroring">WritableStreamStartErroring</a><span>, in § 5.5.2</span>
   <li><a href="#ws-constructor">WritableStream(underlyingSink)</a><span>, in § 5.2.4</span>
   <li><a href="#ws-constructor">WritableStream(underlyingSink, strategy)</a><span>, in § 5.2.4</span>
   <li><a href="#writable-stream-update-backpressure">WritableStreamUpdateBackpressure</a><span>, in § 5.5.2</span>
   <li><a href="#writer">writable stream writer</a><span>, in § 2.6</span>
   <li><a href="#dom-transformer-writabletype">writableType</a><span>, in § 6.2.3</span>
   <li><a href="#dom-underlyingsink-write">write</a><span>, in § 5.2.3</span>
   <li><a href="#default-writer-write">write()</a><span>, in § 5.3.3</span>
   <li><a href="#writablestreamdefaultwriter-write-a-chunk">write a chunk</a><span>, in § 9.2.2</span>
   <li><a href="#writablestreamdefaultcontroller-writealgorithm">[[writeAlgorithm]]</a><span>, in § 5.4.2</span>
   <li><a href="#writablestream-set-up-writealgorithm">writeAlgorithm</a><span>, in § 9.2.1</span>
   <li><a href="#default-writer-write">write(chunk)</a><span>, in § 5.3.3</span>
   <li><a href="#writablestream-writer">[[writer]]</a><span>, in § 5.2.2</span>
   <li><a href="#writer">writer</a><span>, in § 2.6</span>
   <li><a href="#writablestream-writerequests">[[writeRequests]]</a><span>, in § 5.2.2</span>
   <li><a href="#writablestreamdefaultwriter-write-a-chunk">writing a chunk</a><span>, in § 9.2.2</span>
  </ul>
  <aside class="dfn-panel" data-for="term-for-compressionstream">
   <a href="https://wicg.github.io/compression/#compressionstream">https://wicg.github.io/compression/#compressionstream</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-compressionstream">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortcontroller">
   <a href="https://dom.spec.whatwg.org/#abortcontroller">https://dom.spec.whatwg.org/#abortcontroller</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abortcontroller">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortsignal">
   <a href="https://dom.spec.whatwg.org/#abortsignal">https://dom.spec.whatwg.org/#abortsignal</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abortsignal">4.2.1. Interface definition</a>
    <li><a href="#ref-for-abortsignal①">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-abortsignal②">(2)</a>
    <li><a href="#ref-for-abortsignal③">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-abortsignal④">9.5. Piping</a> <a href="#ref-for-abortsignal⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortsignal-aborted-flag">
   <a href="https://dom.spec.whatwg.org/#abortsignal-aborted-flag">https://dom.spec.whatwg.org/#abortsignal-aborted-flag</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abortsignal-aborted-flag">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortsignal-add">
   <a href="https://dom.spec.whatwg.org/#abortsignal-add">https://dom.spec.whatwg.org/#abortsignal-add</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abortsignal-add">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-abortsignal-remove">
   <a href="https://dom.spec.whatwg.org/#abortsignal-remove">https://dom.spec.whatwg.org/#abortsignal-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abortsignal-remove">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-arraybuffer-constructor">
   <a href="https://tc39.es/ecma262/#sec-arraybuffer-constructor">https://tc39.es/ecma262/#sec-arraybuffer-constructor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-arraybuffer-constructor">4.7.4. Internal methods</a>
    <li><a href="#ref-for-sec-arraybuffer-constructor①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-dataview-constructor">
   <a href="https://tc39.es/ecma262/#sec-dataview-constructor">https://tc39.es/ecma262/#sec-dataview-constructor</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-dataview-constructor">4.7.2. Internal slots</a>
    <li><a href="#ref-for-sec-dataview-constructor①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-properties-of-the-object-prototype-object">
   <a href="https://tc39.es/ecma262/#sec-properties-of-the-object-prototype-object">https://tc39.es/ecma262/#sec-properties-of-the-object-prototype-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-properties-of-the-object-prototype-object">8.2. Transferable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-typedarray-objects">
   <a href="https://tc39.es/ecma262/#sec-typedarray-objects">https://tc39.es/ecma262/#sec-typedarray-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-typedarray-objects">2. Model</a>
    <li><a href="#ref-for-sec-typedarray-objects①">4.1. Using readable streams</a>
    <li><a href="#ref-for-sec-typedarray-objects②">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-sec-typedarray-objects③">4.7.4. Internal methods</a> <a href="#ref-for-sec-typedarray-objects④">(2)</a>
    <li><a href="#ref-for-sec-typedarray-objects⑤">4.8.2. Internal slots</a>
    <li><a href="#ref-for-sec-typedarray-objects⑥">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-sec-typedarray-objects⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-arraybuffer-objects">
   <a href="https://tc39.es/ecma262/#sec-arraybuffer-objects">https://tc39.es/ecma262/#sec-arraybuffer-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-arraybuffer-objects">4.1. Using readable streams</a> <a href="#ref-for-sec-arraybuffer-objects①">(2)</a>
    <li><a href="#ref-for-sec-arraybuffer-objects②">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-sec-arraybuffer-objects③">4.7.2. Internal slots</a> <a href="#ref-for-sec-arraybuffer-objects④">(2)</a>
    <li><a href="#ref-for-sec-arraybuffer-objects⑤">8.3. Miscellaneous</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-clonearraybuffer">
   <a href="https://tc39.es/ecma262/#sec-clonearraybuffer">https://tc39.es/ecma262/#sec-clonearraybuffer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-clonearraybuffer">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-construct">
   <a href="https://tc39.es/ecma262/#sec-construct">https://tc39.es/ecma262/#sec-construct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-construct">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-sec-construct①">4.7.4. Internal methods</a> <a href="#ref-for-sec-construct②">(2)</a>
    <li><a href="#ref-for-sec-construct③">4.9.5. Byte stream controllers</a> <a href="#ref-for-sec-construct④">(2)</a> <a href="#ref-for-sec-construct⑤">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-copydatablockbytes">
   <a href="https://tc39.es/ecma262/#sec-copydatablockbytes">https://tc39.es/ecma262/#sec-copydatablockbytes</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-copydatablockbytes">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-createarrayfromlist">
   <a href="https://tc39.es/ecma262/#sec-createarrayfromlist">https://tc39.es/ecma262/#sec-createarrayfromlist</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-createarrayfromlist">4.9.1. Working with readable streams</a> <a href="#ref-for-sec-createarrayfromlist①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-createbuiltinfunction">
   <a href="https://tc39.es/ecma262/#sec-createbuiltinfunction">https://tc39.es/ecma262/#sec-createbuiltinfunction</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-createbuiltinfunction">7.2.2. Internal slots</a>
    <li><a href="#ref-for-sec-createbuiltinfunction①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-createdataproperty">
   <a href="https://tc39.es/ecma262/#sec-createdataproperty">https://tc39.es/ecma262/#sec-createdataproperty</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-createdataproperty">8.2. Transferable streams</a> <a href="#ref-for-sec-createdataproperty①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-dataview-objects">
   <a href="https://tc39.es/ecma262/#sec-dataview-objects">https://tc39.es/ecma262/#sec-dataview-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-dataview-objects">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-detacharraybuffer">
   <a href="https://tc39.es/ecma262/#sec-detacharraybuffer">https://tc39.es/ecma262/#sec-detacharraybuffer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-detacharraybuffer">8.3. Miscellaneous</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-get-o-p">
   <a href="https://tc39.es/ecma262/#sec-get-o-p">https://tc39.es/ecma262/#sec-get-o-p</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-get-o-p">8.2. Transferable streams</a> <a href="#ref-for-sec-get-o-p①">(2)</a> <a href="#ref-for-sec-get-o-p②">(3)</a> <a href="#ref-for-sec-get-o-p③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-getv">
   <a href="https://tc39.es/ecma262/#sec-getv">https://tc39.es/ecma262/#sec-getv</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-getv">7.2.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-isdetachedbuffer">
   <a href="https://tc39.es/ecma262/#sec-isdetachedbuffer">https://tc39.es/ecma262/#sec-isdetachedbuffer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-isdetachedbuffer">4.8.3. Methods and properties</a>
    <li><a href="#ref-for-sec-isdetachedbuffer①">8.3. Miscellaneous</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-isinteger">
   <a href="https://tc39.es/ecma262/#sec-isinteger">https://tc39.es/ecma262/#sec-isinteger</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-isinteger">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-ecmascript-language-types-number-type">
   <a href="https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type">https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-ecmascript-language-types-number-type">3. Conventions</a>
    <li><a href="#ref-for-sec-ecmascript-language-types-number-type①">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-ordinaryobjectcreate">
   <a href="https://tc39.es/ecma262/#sec-ordinaryobjectcreate">https://tc39.es/ecma262/#sec-ordinaryobjectcreate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-ordinaryobjectcreate">8.2. Transferable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-setfunctionlength">
   <a href="https://tc39.es/ecma262/#sec-setfunctionlength">https://tc39.es/ecma262/#sec-setfunctionlength</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-setfunctionlength">7.2.2. Internal slots</a>
    <li><a href="#ref-for-sec-setfunctionlength①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-setfunctionname">
   <a href="https://tc39.es/ecma262/#sec-setfunctionname">https://tc39.es/ecma262/#sec-setfunctionname</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-setfunctionname">7.2.2. Internal slots</a>
    <li><a href="#ref-for-sec-setfunctionname①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-ecmascript-data-types-and-values">
   <a href="https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values">https://tc39.es/ecma262/#sec-ecmascript-data-types-and-values</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-ecmascript-data-types-and-values">8.2. Transferable streams</a> <a href="#ref-for-sec-ecmascript-data-types-and-values①">(2)</a> <a href="#ref-for-sec-ecmascript-data-types-and-values②">(3)</a> <a href="#ref-for-sec-ecmascript-data-types-and-values③">(4)</a>
    <li><a href="#ref-for-sec-ecmascript-data-types-and-values④">8.3. Miscellaneous</a> <a href="#ref-for-sec-ecmascript-data-types-and-values⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-native-error-types-used-in-this-standard-typeerror">
   <a href="https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror">https://tc39.es/ecma262/#sec-native-error-types-used-in-this-standard-typeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④">(5)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤">(6)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑥">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑦">4.3.3. Methods and properties</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑧">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑨">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⓪">(3)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①①">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①②">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①③">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①④">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑤">(5)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑥">4.6.3. Methods and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑦">(2)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑧">4.7.3. Methods and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror①⑨">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⓪">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②①">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②②">(5)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②③">(6)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②④">(7)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑤">4.8.3. Methods and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑥">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑦">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑧">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror②⑨">(5)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⓪">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③①">4.9.3. Readers</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③②">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③③">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③④">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑤">(5)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑥">4.9.5. Byte stream controllers</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑦">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑧">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror③⑨">(4)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⓪">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④①">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④②">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④③">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④④">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑤">(5)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑥">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑦">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑧">(3)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror④⑨">(4)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⓪">(5)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤①">5.5.1. Working with writable streams</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤②">(2)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤③">5.5.3. Writers</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤④">(2)</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑤">(3)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑥">6.4.2. Default controllers</a> <a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑦">(2)</a>
    <li><a href="#ref-for-sec-native-error-types-used-in-this-standard-typeerror⑤⑧">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-typedarray-objects">
   <a href="https://tc39.es/ecma262/#sec-typedarray-objects">https://tc39.es/ecma262/#sec-typedarray-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-typedarray-objects">2. Model</a>
    <li><a href="#ref-for-sec-typedarray-objects①">4.1. Using readable streams</a>
    <li><a href="#ref-for-sec-typedarray-objects②">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-sec-typedarray-objects③">4.7.4. Internal methods</a> <a href="#ref-for-sec-typedarray-objects④">(2)</a>
    <li><a href="#ref-for-sec-typedarray-objects⑤">4.8.2. Internal slots</a>
    <li><a href="#ref-for-sec-typedarray-objects⑥">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-sec-typedarray-objects⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-algorithm-conventions-abstract-operations">
   <a href="https://tc39.es/ecma262/#sec-algorithm-conventions-abstract-operations">https://tc39.es/ecma262/#sec-algorithm-conventions-abstract-operations</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-algorithm-conventions-abstract-operations">3. Conventions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-completion-record-specification-type">
   <a href="https://tc39.es/ecma262/#sec-completion-record-specification-type">https://tc39.es/ecma262/#sec-completion-record-specification-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-completion-record-specification-type">3. Conventions</a>
    <li><a href="#ref-for-sec-completion-record-specification-type①">4.9.4. Default controllers</a>
    <li><a href="#ref-for-sec-completion-record-specification-type②">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-object-internal-methods-and-internal-slots">
   <a href="https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots">https://tc39.es/ecma262/#sec-object-internal-methods-and-internal-slots</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-object-internal-methods-and-internal-slots">3. Conventions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-array.prototype.map">
   <a href="https://tc39.es/ecma262/#sec-array.prototype.map">https://tc39.es/ecma262/#sec-array.prototype.map</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-array.prototype.map">10.10. A transform stream created from a sync mapper function</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-ecmascript-language-types-number-type">
   <a href="https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type">https://tc39.es/ecma262/#sec-ecmascript-language-types-number-type</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-ecmascript-language-types-number-type">3. Conventions</a>
    <li><a href="#ref-for-sec-ecmascript-language-types-number-type①">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-code-realms">
   <a href="https://tc39.es/ecma262/#sec-code-realms">https://tc39.es/ecma262/#sec-code-realms</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-code-realms">8.2. Transferable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-current-realm">
   <a href="https://tc39.es/ecma262/#current-realm">https://tc39.es/ecma262/#current-realm</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-current-realm">4.2.6. Transfer via postMessage()</a> <a href="#ref-for-current-realm①">(2)</a> <a href="#ref-for-current-realm②">(3)</a> <a href="#ref-for-current-realm③">(4)</a>
    <li><a href="#ref-for-current-realm④">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-current-realm⑤">5.2.5. Transfer via postMessage()</a> <a href="#ref-for-current-realm⑥">(2)</a> <a href="#ref-for-current-realm⑦">(3)</a> <a href="#ref-for-current-realm⑧">(4)</a>
    <li><a href="#ref-for-current-realm⑨">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-current-realm①⓪">(2)</a>
    <li><a href="#ref-for-current-realm①①">8.3. Miscellaneous</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-table-49">
   <a href="https://tc39.es/ecma262/#table-49">https://tc39.es/ecma262/#table-49</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-table-49">4.7.2. Internal slots</a>
    <li><a href="#ref-for-table-49①">4.9.5. Byte stream controllers</a> <a href="#ref-for-table-49②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-sec-typedarray-objects">
   <a href="https://tc39.es/ecma262/#sec-typedarray-objects">https://tc39.es/ecma262/#sec-typedarray-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-sec-typedarray-objects">2. Model</a>
    <li><a href="#ref-for-sec-typedarray-objects①">4.1. Using readable streams</a>
    <li><a href="#ref-for-sec-typedarray-objects②">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-sec-typedarray-objects③">4.7.4. Internal methods</a> <a href="#ref-for-sec-typedarray-objects④">(2)</a>
    <li><a href="#ref-for-sec-typedarray-objects⑤">4.8.2. Internal slots</a>
    <li><a href="#ref-for-sec-typedarray-objects⑥">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-sec-typedarray-objects⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-textdecoderstream">
   <a href="https://encoding.spec.whatwg.org/#textdecoderstream">https://encoding.spec.whatwg.org/#textdecoderstream</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoderstream">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-response">
   <a href="https://fetch.spec.whatwg.org/#response">https://fetch.spec.whatwg.org/#response</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-response">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-request-body">
   <a href="https://fetch.spec.whatwg.org/#concept-request-body">https://fetch.spec.whatwg.org/#concept-request-body</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-request-body">6.1. Using transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-global-fetch">
   <a href="https://fetch.spec.whatwg.org/#dom-global-fetch">https://fetch.spec.whatwg.org/#dom-global-fetch</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-global-fetch">6.1. Using transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-messageport">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#messageport">https://html.spec.whatwg.org/multipage/web-messaging.html#messageport</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-messageport">4.2.6. Transfer via postMessage()</a> <a href="#ref-for-messageport①">(2)</a>
    <li><a href="#ref-for-messageport②">5.2.5. Transfer via postMessage()</a> <a href="#ref-for-messageport③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structureddeserialize">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize">https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserialize</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-structureddeserialize">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structureddeserializewithtransfer">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer">https://html.spec.whatwg.org/multipage/structured-data.html#structureddeserializewithtransfer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-structureddeserializewithtransfer">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-structureddeserializewithtransfer①">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-structureddeserializewithtransfer②">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-structureddeserializewithtransfer③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structuredserialize">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserialize">https://html.spec.whatwg.org/multipage/structured-data.html#structuredserialize</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-structuredserialize">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-structuredserializewithtransfer">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer">https://html.spec.whatwg.org/multipage/structured-data.html#structuredserializewithtransfer</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-structuredserializewithtransfer">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-structuredserializewithtransfer①">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-structuredserializewithtransfer②">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-structuredserializewithtransfer③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transferable">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable">https://html.spec.whatwg.org/multipage/structured-data.html#transferable</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transferable">4.2.1. Interface definition</a>
    <li><a href="#ref-for-transferable①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-transferable②">6.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-websocket">
   <a href="https://html.spec.whatwg.org/multipage/web-sockets.html#websocket">https://html.spec.whatwg.org/multipage/web-sockets.html#websocket</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-websocket">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-websocket①">10.6. A writable stream with no backpressure or success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dom-websocket-bufferedamount">
   <a href="https://html.spec.whatwg.org/multipage/web-sockets.html#dom-websocket-bufferedamount">https://html.spec.whatwg.org/multipage/web-sockets.html#dom-websocket-bufferedamount</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-websocket-bufferedamount">10.6. A writable stream with no backpressure or success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-entangle">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#entangle">https://html.spec.whatwg.org/multipage/web-messaging.html#entangle</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-entangle">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-entangle①">5.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-global-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#global-object">https://html.spec.whatwg.org/multipage/webappapis.html#global-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-global-object">7.2.2. Internal slots</a>
    <li><a href="#ref-for-global-object①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-the-img-element">
   <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element">https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-the-img-element">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-in-parallel">
   <a href="https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel">https://html.spec.whatwg.org/multipage/infrastructure.html#in-parallel</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-in-parallel">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-message">
   <a href="https://html.spec.whatwg.org/multipage/indices.html#event-message">https://html.spec.whatwg.org/multipage/indices.html#event-message</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-message">8.2. Transferable streams</a> <a href="#ref-for-event-message①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-message-port-post-message-steps">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#message-port-post-message-steps">https://html.spec.whatwg.org/multipage/web-messaging.html#message-port-post-message-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-message-port-post-message-steps">8.2. Transferable streams</a> <a href="#ref-for-message-port-post-message-steps①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-messageerror">
   <a href="https://html.spec.whatwg.org/multipage/indices.html#event-messageerror">https://html.spec.whatwg.org/multipage/indices.html#event-messageerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-messageerror">8.2. Transferable streams</a> <a href="#ref-for-event-messageerror①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-port-message-queue">
   <a href="https://html.spec.whatwg.org/multipage/web-messaging.html#port-message-queue">https://html.spec.whatwg.org/multipage/web-messaging.html#port-message-queue</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-port-message-queue">8.2. Transferable streams</a> <a href="#ref-for-port-message-queue①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-queue-a-microtask">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask">https://html.spec.whatwg.org/multipage/webappapis.html#queue-a-microtask</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queue-a-microtask">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-queue-a-microtask①">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-global">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-global</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-global">7.2.3. Constructor and properties</a>
    <li><a href="#ref-for-concept-relevant-global①">7.3.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-concept-relevant-realm">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm">https://html.spec.whatwg.org/multipage/webappapis.html#concept-relevant-realm</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-relevant-realm">7.2.2. Internal slots</a>
    <li><a href="#ref-for-concept-relevant-realm①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-relevant-settings-object">
   <a href="https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object">https://html.spec.whatwg.org/multipage/webappapis.html#relevant-settings-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relevant-settings-object">7.2.2. Internal slots</a>
    <li><a href="#ref-for-relevant-settings-object①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-serializable-objects">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#serializable-objects">https://html.spec.whatwg.org/multipage/structured-data.html#serializable-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-serializable-objects">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-serializable-objects①">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transfer-steps">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-steps">https://html.spec.whatwg.org/multipage/structured-data.html#transfer-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transfer-steps">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-transfer-steps①">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-transfer-steps②">6.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transfer-receiving-steps">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#transfer-receiving-steps">https://html.spec.whatwg.org/multipage/structured-data.html#transfer-receiving-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transfer-receiving-steps">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-transfer-receiving-steps①">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-transfer-receiving-steps②">6.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-transferable-objects">
   <a href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects">https://html.spec.whatwg.org/multipage/structured-data.html#transferable-objects</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transferable-objects">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-transferable-objects①">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-transferable-objects②">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-transferable-objects③">6.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-event-unhandledrejection">
   <a href="https://html.spec.whatwg.org/multipage/indices.html#event-unhandledrejection">https://html.spec.whatwg.org/multipage/indices.html#event-unhandledrejection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-event-unhandledrejection">5.1. Using writable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-append">
   <a href="https://infra.spec.whatwg.org/#list-append">https://infra.spec.whatwg.org/#list-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-append">4.7.4. Internal methods</a>
    <li><a href="#ref-for-list-append①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list-append②">(2)</a>
    <li><a href="#ref-for-list-append③">4.9.5. Byte stream controllers</a> <a href="#ref-for-list-append④">(2)</a> <a href="#ref-for-list-append⑤">(3)</a>
    <li><a href="#ref-for-list-append⑥">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-list-append⑦">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-set-append">
   <a href="https://infra.spec.whatwg.org/#set-append">https://infra.spec.whatwg.org/#set-append</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-append">4.9.1. Working with readable streams</a> <a href="#ref-for-set-append①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-byte-sequence">
   <a href="https://infra.spec.whatwg.org/#byte-sequence">https://infra.spec.whatwg.org/#byte-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byte-sequence">9.1.2. Reading</a> <a href="#ref-for-byte-sequence①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-map-exists">
   <a href="https://infra.spec.whatwg.org/#map-exists">https://infra.spec.whatwg.org/#map-exists</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-map-exists">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-map-exists①">(2)</a> <a href="#ref-for-map-exists②">(3)</a> <a href="#ref-for-map-exists③">(4)</a> <a href="#ref-for-map-exists④">(5)</a>
    <li><a href="#ref-for-map-exists⑤">4.9.4. Default controllers</a> <a href="#ref-for-map-exists⑥">(2)</a> <a href="#ref-for-map-exists⑦">(3)</a>
    <li><a href="#ref-for-map-exists⑧">4.9.5. Byte stream controllers</a> <a href="#ref-for-map-exists⑨">(2)</a> <a href="#ref-for-map-exists①⓪">(3)</a> <a href="#ref-for-map-exists①①">(4)</a>
    <li><a href="#ref-for-map-exists①②">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-map-exists①③">5.5.4. Default controllers</a> <a href="#ref-for-map-exists①④">(2)</a> <a href="#ref-for-map-exists①⑤">(3)</a> <a href="#ref-for-map-exists①⑥">(4)</a>
    <li><a href="#ref-for-map-exists①⑦">6.2.4. Constructor and properties</a> <a href="#ref-for-map-exists①⑧">(2)</a> <a href="#ref-for-map-exists①⑨">(3)</a>
    <li><a href="#ref-for-map-exists②⓪">6.4.2. Default controllers</a> <a href="#ref-for-map-exists②①">(2)</a>
    <li><a href="#ref-for-map-exists②②">7.4. Abstract operations</a> <a href="#ref-for-map-exists②③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-iterate">
   <a href="https://infra.spec.whatwg.org/#list-iterate">https://infra.spec.whatwg.org/#list-iterate</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-iterate">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list-iterate①">(2)</a> <a href="#ref-for-list-iterate②">(3)</a>
    <li><a href="#ref-for-list-iterate③">5.5.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-is-empty">
   <a href="https://infra.spec.whatwg.org/#list-is-empty">https://infra.spec.whatwg.org/#list-is-empty</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-is-empty">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-list-is-empty①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-list-is-empty②">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-list-is-empty③">4.6.4. Internal methods</a> <a href="#ref-for-list-is-empty④">(2)</a>
    <li><a href="#ref-for-list-is-empty⑤">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-list-is-empty⑥">4.7.4. Internal methods</a>
    <li><a href="#ref-for-list-is-empty⑦">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list-is-empty⑧">(2)</a>
    <li><a href="#ref-for-list-is-empty⑨">4.9.4. Default controllers</a>
    <li><a href="#ref-for-list-is-empty①⓪">4.9.5. Byte stream controllers</a> <a href="#ref-for-list-is-empty①①">(2)</a> <a href="#ref-for-list-is-empty①②">(3)</a> <a href="#ref-for-list-is-empty①③">(4)</a>
    <li><a href="#ref-for-list-is-empty①④">8.1. Queue-with-sizes</a> <a href="#ref-for-list-is-empty①⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct-item">
   <a href="https://infra.spec.whatwg.org/#struct-item">https://infra.spec.whatwg.org/#struct-item</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct-item">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-struct-item①">4.4.2. Internal slots</a>
    <li><a href="#ref-for-struct-item②">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-struct-item③">4.5.2. Internal slots</a>
    <li><a href="#ref-for-struct-item④">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-struct-item⑤">4.7.2. Internal slots</a> <a href="#ref-for-struct-item⑥">(2)</a>
    <li><a href="#ref-for-struct-item⑦">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-struct-item⑧">5.2.2. Internal slots</a>
    <li><a href="#ref-for-struct-item⑨">8.1. Queue-with-sizes</a>
    <li><a href="#ref-for-struct-item①⓪">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list">
   <a href="https://infra.spec.whatwg.org/#list">https://infra.spec.whatwg.org/#list</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list">4.4.2. Internal slots</a>
    <li><a href="#ref-for-list①">4.5.2. Internal slots</a>
    <li><a href="#ref-for-list②">4.6.2. Internal slots</a>
    <li><a href="#ref-for-list③">4.7.2. Internal slots</a> <a href="#ref-for-list④">(2)</a>
    <li><a href="#ref-for-list⑤">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list⑥">(2)</a> <a href="#ref-for-list⑦">(3)</a>
    <li><a href="#ref-for-list⑧">4.9.3. Readers</a> <a href="#ref-for-list⑨">(2)</a>
    <li><a href="#ref-for-list①⓪">4.9.5. Byte stream controllers</a> <a href="#ref-for-list①①">(2)</a>
    <li><a href="#ref-for-list①②">5.2.2. Internal slots</a>
    <li><a href="#ref-for-list①③">5.4.2. Internal slots</a>
    <li><a href="#ref-for-list①④">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-list①⑤">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-list①⑥">8.1. Queue-with-sizes</a> <a href="#ref-for-list①⑦">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ordered-set">
   <a href="https://infra.spec.whatwg.org/#ordered-set">https://infra.spec.whatwg.org/#ordered-set</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ordered-set">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-remove">
   <a href="https://infra.spec.whatwg.org/#list-remove">https://infra.spec.whatwg.org/#list-remove</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-remove">4.7.4. Internal methods</a>
    <li><a href="#ref-for-list-remove①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list-remove②">(2)</a>
    <li><a href="#ref-for-list-remove③">4.9.5. Byte stream controllers</a> <a href="#ref-for-list-remove④">(2)</a>
    <li><a href="#ref-for-list-remove⑤">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-list-remove⑥">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-list-size">
   <a href="https://infra.spec.whatwg.org/#list-size">https://infra.spec.whatwg.org/#list-size</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-list-size">4.9.2. Interfacing with controllers</a> <a href="#ref-for-list-size①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-struct">
   <a href="https://infra.spec.whatwg.org/#struct">https://infra.spec.whatwg.org/#struct</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-struct">4.4.2. Internal slots</a>
    <li><a href="#ref-for-struct①">4.5.2. Internal slots</a>
    <li><a href="#ref-for-struct②">4.7.2. Internal slots</a> <a href="#ref-for-struct③">(2)</a>
    <li><a href="#ref-for-struct④">5.2.2. Internal slots</a>
    <li><a href="#ref-for-struct⑤">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-iteration-while">
   <a href="https://infra.spec.whatwg.org/#iteration-while">https://infra.spec.whatwg.org/#iteration-while</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iteration-while">4.9.5. Byte stream controllers</a> <a href="#ref-for-iteration-while①">(2)</a> <a href="#ref-for-iteration-while②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-service-worker-global-scope-fetch-event">
   <a href="https://w3c.github.io/ServiceWorker/#service-worker-global-scope-fetch-event">https://w3c.github.io/ServiceWorker/#service-worker-global-scope-fetch-event</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-service-worker-global-scope-fetch-event">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-aborterror">
   <a href="https://heycam.github.io/webidl/#aborterror">https://heycam.github.io/webidl/#aborterror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-aborterror">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-ArrayBufferView">
   <a href="https://heycam.github.io/webidl/#ArrayBufferView">https://heycam.github.io/webidl/#ArrayBufferView</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ArrayBufferView">4.5.1. Interface definition</a> <a href="#ref-for-ArrayBufferView①">(2)</a>
    <li><a href="#ref-for-ArrayBufferView②">4.7.1. Interface definition</a>
    <li><a href="#ref-for-ArrayBufferView③">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-ArrayBufferView④">4.8.1. Interface definition</a> <a href="#ref-for-ArrayBufferView⑤">(2)</a>
    <li><a href="#ref-for-ArrayBufferView⑥">4.8.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-DOMException">
   <a href="https://heycam.github.io/webidl/#idl-DOMException">https://heycam.github.io/webidl/#idl-DOMException</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-DOMException">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-idl-DOMException①">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-idl-DOMException②">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-idl-DOMException③">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-idl-DOMException④">(2)</a>
    <li><a href="#ref-for-idl-DOMException⑤">8.2. Transferable streams</a> <a href="#ref-for-idl-DOMException⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-datacloneerror">
   <a href="https://heycam.github.io/webidl/#datacloneerror">https://heycam.github.io/webidl/#datacloneerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-datacloneerror">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-datacloneerror①">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-datacloneerror②">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-datacloneerror③">(2)</a>
    <li><a href="#ref-for-datacloneerror④">8.2. Transferable streams</a> <a href="#ref-for-datacloneerror⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-EnforceRange">
   <a href="https://heycam.github.io/webidl/#EnforceRange">https://heycam.github.io/webidl/#EnforceRange</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-EnforceRange">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-EnforceRange①">4.8.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Exposed">
   <a href="https://heycam.github.io/webidl/#Exposed">https://heycam.github.io/webidl/#Exposed</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Exposed">4.2.1. Interface definition</a>
    <li><a href="#ref-for-Exposed①">4.4.1. Interface definition</a>
    <li><a href="#ref-for-Exposed②">4.5.1. Interface definition</a>
    <li><a href="#ref-for-Exposed③">4.6.1. Interface definition</a>
    <li><a href="#ref-for-Exposed④">4.7.1. Interface definition</a>
    <li><a href="#ref-for-Exposed⑤">4.8.1. Interface definition</a>
    <li><a href="#ref-for-Exposed⑥">5.2.1. Interface definition</a>
    <li><a href="#ref-for-Exposed⑦">5.3.1. Interface definition</a>
    <li><a href="#ref-for-Exposed⑧">5.4.1. Interface definition</a>
    <li><a href="#ref-for-Exposed⑨">6.2.1. Interface definition</a>
    <li><a href="#ref-for-Exposed①⓪">6.3.1. Interface definition</a>
    <li><a href="#ref-for-Exposed①①">7.2.1. Interface definition</a>
    <li><a href="#ref-for-Exposed①②">7.3.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-Function">
   <a href="https://heycam.github.io/webidl/#Function">https://heycam.github.io/webidl/#Function</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-Function">7.2.1. Interface definition</a>
    <li><a href="#ref-for-Function①">7.2.2. Internal slots</a> <a href="#ref-for-Function②">(2)</a>
    <li><a href="#ref-for-Function③">7.3.1. Interface definition</a>
    <li><a href="#ref-for-Function④">7.3.2. Internal slots</a> <a href="#ref-for-Function⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-promise">
   <a href="https://heycam.github.io/webidl/#idl-promise">https://heycam.github.io/webidl/#idl-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-promise">4.2.1. Interface definition</a> <a href="#ref-for-idl-promise①">(2)</a>
    <li><a href="#ref-for-idl-promise②">4.2.3. The underlying source API</a> <a href="#ref-for-idl-promise③">(2)</a>
    <li><a href="#ref-for-idl-promise④">4.3.1. Mixin definition</a> <a href="#ref-for-idl-promise⑤">(2)</a>
    <li><a href="#ref-for-idl-promise⑥">4.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-promise⑦">4.5.1. Interface definition</a>
    <li><a href="#ref-for-idl-promise⑧">5.2.1. Interface definition</a> <a href="#ref-for-idl-promise⑨">(2)</a>
    <li><a href="#ref-for-idl-promise①⓪">5.2.3. The underlying sink API</a> <a href="#ref-for-idl-promise①①">(2)</a> <a href="#ref-for-idl-promise①②">(3)</a>
    <li><a href="#ref-for-idl-promise①③">5.3.1. Interface definition</a> <a href="#ref-for-idl-promise①④">(2)</a> <a href="#ref-for-idl-promise①⑤">(3)</a> <a href="#ref-for-idl-promise①⑥">(4)</a> <a href="#ref-for-idl-promise①⑦">(5)</a>
    <li><a href="#ref-for-idl-promise①⑧">6.2.3. The transformer API</a> <a href="#ref-for-idl-promise①⑨">(2)</a>
    <li><a href="#ref-for-idl-promise②⓪">9.1.2. Reading</a>
    <li><a href="#ref-for-idl-promise②①">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-exceptiondef-rangeerror">
   <a href="https://heycam.github.io/webidl/#exceptiondef-rangeerror">https://heycam.github.io/webidl/#exceptiondef-rangeerror</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-exceptiondef-rangeerror">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-exceptiondef-rangeerror①">4.9.5. Byte stream controllers</a> <a href="#ref-for-exceptiondef-rangeerror②">(2)</a> <a href="#ref-for-exceptiondef-rangeerror③">(3)</a>
    <li><a href="#ref-for-exceptiondef-rangeerror④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-exceptiondef-rangeerror⑤">6.2.4. Constructor and properties</a> <a href="#ref-for-exceptiondef-rangeerror⑥">(2)</a>
    <li><a href="#ref-for-exceptiondef-rangeerror⑦">7.4. Abstract operations</a>
    <li><a href="#ref-for-exceptiondef-rangeerror⑧">8.1. Queue-with-sizes</a> <a href="#ref-for-exceptiondef-rangeerror⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-new-promise">
   <a href="https://heycam.github.io/webidl/#a-new-promise">https://heycam.github.io/webidl/#a-new-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-new-promise">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-a-new-promise①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-a-new-promise②">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-a-new-promise③">4.9.1. Working with readable streams</a> <a href="#ref-for-a-new-promise④">(2)</a>
    <li><a href="#ref-for-a-new-promise⑤">4.9.3. Readers</a>
    <li><a href="#ref-for-a-new-promise⑥">5.5.1. Working with writable streams</a> <a href="#ref-for-a-new-promise⑦">(2)</a> <a href="#ref-for-a-new-promise⑧">(3)</a> <a href="#ref-for-a-new-promise⑨">(4)</a> <a href="#ref-for-a-new-promise①⓪">(5)</a>
    <li><a href="#ref-for-a-new-promise①①">5.5.2. Interfacing with controllers</a> <a href="#ref-for-a-new-promise①②">(2)</a>
    <li><a href="#ref-for-a-new-promise①③">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-a-new-promise①④">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-a-new-promise①⑤">8.2. Transferable streams</a> <a href="#ref-for-a-new-promise①⑥">(2)</a>
    <li><a href="#ref-for-a-new-promise①⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-rejected-with">
   <a href="https://heycam.github.io/webidl/#a-promise-rejected-with">https://heycam.github.io/webidl/#a-promise-rejected-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-rejected-with">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-a-promise-rejected-with①">(2)</a> <a href="#ref-for-a-promise-rejected-with②">(3)</a>
    <li><a href="#ref-for-a-promise-rejected-with③">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-a-promise-rejected-with④">4.3.3. Methods and properties</a>
    <li><a href="#ref-for-a-promise-rejected-with⑤">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-a-promise-rejected-with⑥">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-a-promise-rejected-with⑦">(2)</a> <a href="#ref-for-a-promise-rejected-with⑧">(3)</a>
    <li><a href="#ref-for-a-promise-rejected-with⑨">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-a-promise-rejected-with①⓪">4.9.3. Readers</a> <a href="#ref-for-a-promise-rejected-with①①">(2)</a>
    <li><a href="#ref-for-a-promise-rejected-with①②">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-a-promise-rejected-with①③">(2)</a> <a href="#ref-for-a-promise-rejected-with①④">(3)</a>
    <li><a href="#ref-for-a-promise-rejected-with①⑤">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-a-promise-rejected-with①⑥">(2)</a> <a href="#ref-for-a-promise-rejected-with①⑦">(3)</a> <a href="#ref-for-a-promise-rejected-with①⑧">(4)</a>
    <li><a href="#ref-for-a-promise-rejected-with①⑨">5.5.1. Working with writable streams</a> <a href="#ref-for-a-promise-rejected-with②⓪">(2)</a> <a href="#ref-for-a-promise-rejected-with②①">(3)</a> <a href="#ref-for-a-promise-rejected-with②②">(4)</a>
    <li><a href="#ref-for-a-promise-rejected-with②③">5.5.3. Writers</a> <a href="#ref-for-a-promise-rejected-with②④">(2)</a> <a href="#ref-for-a-promise-rejected-with②⑤">(3)</a> <a href="#ref-for-a-promise-rejected-with②⑥">(4)</a> <a href="#ref-for-a-promise-rejected-with②⑦">(5)</a> <a href="#ref-for-a-promise-rejected-with②⑧">(6)</a> <a href="#ref-for-a-promise-rejected-with②⑨">(7)</a>
    <li><a href="#ref-for-a-promise-rejected-with③⓪">6.4.2. Default controllers</a>
    <li><a href="#ref-for-a-promise-rejected-with③①">8.2. Transferable streams</a> <a href="#ref-for-a-promise-rejected-with③②">(2)</a> <a href="#ref-for-a-promise-rejected-with③③">(3)</a>
    <li><a href="#ref-for-a-promise-rejected-with③④">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-a-promise-resolved-with">
   <a href="https://heycam.github.io/webidl/#a-promise-resolved-with">https://heycam.github.io/webidl/#a-promise-resolved-with</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-a-promise-resolved-with">4.2.5. Asynchronous iteration</a> <a href="#ref-for-a-promise-resolved-with①">(2)</a>
    <li><a href="#ref-for-a-promise-resolved-with②">4.9.1. Working with readable streams</a> <a href="#ref-for-a-promise-resolved-with③">(2)</a> <a href="#ref-for-a-promise-resolved-with④">(3)</a> <a href="#ref-for-a-promise-resolved-with⑤">(4)</a>
    <li><a href="#ref-for-a-promise-resolved-with⑥">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-a-promise-resolved-with⑦">4.9.3. Readers</a>
    <li><a href="#ref-for-a-promise-resolved-with⑧">4.9.4. Default controllers</a> <a href="#ref-for-a-promise-resolved-with⑨">(2)</a> <a href="#ref-for-a-promise-resolved-with①⓪">(3)</a>
    <li><a href="#ref-for-a-promise-resolved-with①①">4.9.5. Byte stream controllers</a> <a href="#ref-for-a-promise-resolved-with①②">(2)</a> <a href="#ref-for-a-promise-resolved-with①③">(3)</a>
    <li><a href="#ref-for-a-promise-resolved-with①④">5.5.1. Working with writable streams</a> <a href="#ref-for-a-promise-resolved-with①⑤">(2)</a> <a href="#ref-for-a-promise-resolved-with①⑥">(3)</a> <a href="#ref-for-a-promise-resolved-with①⑦">(4)</a>
    <li><a href="#ref-for-a-promise-resolved-with①⑧">5.5.3. Writers</a>
    <li><a href="#ref-for-a-promise-resolved-with①⑨">5.5.4. Default controllers</a> <a href="#ref-for-a-promise-resolved-with②⓪">(2)</a> <a href="#ref-for-a-promise-resolved-with②①">(3)</a> <a href="#ref-for-a-promise-resolved-with②②">(4)</a>
    <li><a href="#ref-for-a-promise-resolved-with②③">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-a-promise-resolved-with②④">6.4.2. Default controllers</a> <a href="#ref-for-a-promise-resolved-with②⑤">(2)</a>
    <li><a href="#ref-for-a-promise-resolved-with②⑥">6.4.3. Default sinks</a>
    <li><a href="#ref-for-a-promise-resolved-with②⑦">8.2. Transferable streams</a> <a href="#ref-for-a-promise-resolved-with②⑧">(2)</a> <a href="#ref-for-a-promise-resolved-with②⑨">(3)</a> <a href="#ref-for-a-promise-resolved-with③⓪">(4)</a> <a href="#ref-for-a-promise-resolved-with③①">(5)</a> <a href="#ref-for-a-promise-resolved-with③②">(6)</a>
    <li><a href="#ref-for-a-promise-resolved-with③③">9.1.1. Creation and manipulation</a> <a href="#ref-for-a-promise-resolved-with③④">(2)</a>
    <li><a href="#ref-for-a-promise-resolved-with③⑤">9.2.1. Creation</a> <a href="#ref-for-a-promise-resolved-with③⑥">(2)</a>
    <li><a href="#ref-for-a-promise-resolved-with③⑦">9.3.1. Creation and manipulation</a> <a href="#ref-for-a-promise-resolved-with③⑧">(2)</a> <a href="#ref-for-a-promise-resolved-with③⑨">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-any">
   <a href="https://heycam.github.io/webidl/#idl-any">https://heycam.github.io/webidl/#idl-any</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-any">4.2.1. Interface definition</a> <a href="#ref-for-idl-any①">(2)</a>
    <li><a href="#ref-for-idl-any②">4.2.3. The underlying source API</a> <a href="#ref-for-idl-any③">(2)</a>
    <li><a href="#ref-for-idl-any④">4.3.1. Mixin definition</a>
    <li><a href="#ref-for-idl-any⑤">4.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-any⑥">4.6.1. Interface definition</a> <a href="#ref-for-idl-any⑦">(2)</a>
    <li><a href="#ref-for-idl-any⑧">4.7.1. Interface definition</a>
    <li><a href="#ref-for-idl-any⑨">5.2.1. Interface definition</a>
    <li><a href="#ref-for-idl-any①⓪">5.2.3. The underlying sink API</a> <a href="#ref-for-idl-any①①">(2)</a> <a href="#ref-for-idl-any①②">(3)</a> <a href="#ref-for-idl-any①③">(4)</a> <a href="#ref-for-idl-any①④">(5)</a>
    <li><a href="#ref-for-idl-any①⑤">5.3.1. Interface definition</a> <a href="#ref-for-idl-any①⑥">(2)</a>
    <li><a href="#ref-for-idl-any①⑦">5.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-any①⑧">6.2.3. The transformer API</a> <a href="#ref-for-idl-any①⑨">(2)</a> <a href="#ref-for-idl-any②⓪">(3)</a> <a href="#ref-for-idl-any②①">(4)</a> <a href="#ref-for-idl-any②②">(5)</a> <a href="#ref-for-idl-any②③">(6)</a>
    <li><a href="#ref-for-idl-any②④">6.3.1. Interface definition</a> <a href="#ref-for-idl-any②⑤">(2)</a>
    <li><a href="#ref-for-idl-any②⑥">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-asynchronous-iterator-initialization-steps">
   <a href="https://heycam.github.io/webidl/#asynchronous-iterator-initialization-steps">https://heycam.github.io/webidl/#asynchronous-iterator-initialization-steps</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-asynchronous-iterator-initialization-steps">4.2.5. Asynchronous iteration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-asynchronous-iterator-return">
   <a href="https://heycam.github.io/webidl/#asynchronous-iterator-return">https://heycam.github.io/webidl/#asynchronous-iterator-return</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-asynchronous-iterator-return">4.2.5. Asynchronous iteration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-boolean">
   <a href="https://heycam.github.io/webidl/#idl-boolean">https://heycam.github.io/webidl/#idl-boolean</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-boolean">4.2.1. Interface definition</a> <a href="#ref-for-idl-boolean①">(2)</a> <a href="#ref-for-idl-boolean②">(3)</a> <a href="#ref-for-idl-boolean③">(4)</a> <a href="#ref-for-idl-boolean④">(5)</a>
    <li><a href="#ref-for-idl-boolean⑤">4.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-boolean⑥">4.5.1. Interface definition</a>
    <li><a href="#ref-for-idl-boolean⑦">5.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-callback-context">
   <a href="https://heycam.github.io/webidl/#dfn-callback-context">https://heycam.github.io/webidl/#dfn-callback-context</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-callback-context">7.2.2. Internal slots</a>
    <li><a href="#ref-for-dfn-callback-context①">7.3.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-callback-this-value">
   <a href="https://heycam.github.io/webidl/#dfn-callback-this-value">https://heycam.github.io/webidl/#dfn-callback-this-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-callback-this-value">4.9.4. Default controllers</a> <a href="#ref-for-dfn-callback-this-value①">(2)</a> <a href="#ref-for-dfn-callback-this-value②">(3)</a>
    <li><a href="#ref-for-dfn-callback-this-value③">4.9.5. Byte stream controllers</a> <a href="#ref-for-dfn-callback-this-value④">(2)</a> <a href="#ref-for-dfn-callback-this-value⑤">(3)</a>
    <li><a href="#ref-for-dfn-callback-this-value⑥">5.5.4. Default controllers</a> <a href="#ref-for-dfn-callback-this-value⑦">(2)</a> <a href="#ref-for-dfn-callback-this-value⑧">(3)</a> <a href="#ref-for-dfn-callback-this-value⑨">(4)</a>
    <li><a href="#ref-for-dfn-callback-this-value①⓪">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-dfn-callback-this-value①①">6.4.2. Default controllers</a> <a href="#ref-for-dfn-callback-this-value①②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-constructors">
   <a href="https://heycam.github.io/webidl/#idl-constructors">https://heycam.github.io/webidl/#idl-constructors</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-constructors">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-convert-ecmascript-to-idl-value">
   <a href="https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value">https://heycam.github.io/webidl/#dfn-convert-ecmascript-to-idl-value</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-convert-ecmascript-to-idl-value">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-dfn-convert-ecmascript-to-idl-value①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-dfn-convert-ecmascript-to-idl-value②">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-detach">
   <a href="https://heycam.github.io/webidl/#dfn-detach">https://heycam.github.io/webidl/#dfn-detach</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-detach">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-dfn-detach①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-end-of-iteration">
   <a href="https://heycam.github.io/webidl/#end-of-iteration">https://heycam.github.io/webidl/#end-of-iteration</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-end-of-iteration">4.2.5. Asynchronous iteration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-get-the-next-iteration-result">
   <a href="https://heycam.github.io/webidl/#dfn-get-the-next-iteration-result">https://heycam.github.io/webidl/#dfn-get-the-next-iteration-result</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-get-the-next-iteration-result">4.2.5. Asynchronous iteration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-waiting-for-all-promise">
   <a href="https://heycam.github.io/webidl/#waiting-for-all-promise">https://heycam.github.io/webidl/#waiting-for-all-promise</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-waiting-for-all-promise">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-implements">
   <a href="https://heycam.github.io/webidl/#implements">https://heycam.github.io/webidl/#implements</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-implements">4.9.1. Working with readable streams</a> <a href="#ref-for-implements①">(2)</a> <a href="#ref-for-implements②">(3)</a> <a href="#ref-for-implements③">(4)</a> <a href="#ref-for-implements④">(5)</a>
    <li><a href="#ref-for-implements⑤">4.9.2. Interfacing with controllers</a> <a href="#ref-for-implements⑥">(2)</a> <a href="#ref-for-implements⑦">(3)</a> <a href="#ref-for-implements⑧">(4)</a> <a href="#ref-for-implements⑨">(5)</a> <a href="#ref-for-implements①⓪">(6)</a> <a href="#ref-for-implements①①">(7)</a>
    <li><a href="#ref-for-implements①②">4.9.3. Readers</a>
    <li><a href="#ref-for-implements①③">5.5.4. Default controllers</a>
    <li><a href="#ref-for-implements①④">6.4.2. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-include">
   <a href="https://heycam.github.io/webidl/#include">https://heycam.github.io/webidl/#include</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-include">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-invoke-a-callback-function">
   <a href="https://heycam.github.io/webidl/#invoke-a-callback-function">https://heycam.github.io/webidl/#invoke-a-callback-function</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-invoke-a-callback-function">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-invoke-a-callback-function①">4.9.4. Default controllers</a> <a href="#ref-for-invoke-a-callback-function②">(2)</a> <a href="#ref-for-invoke-a-callback-function③">(3)</a>
    <li><a href="#ref-for-invoke-a-callback-function④">4.9.5. Byte stream controllers</a> <a href="#ref-for-invoke-a-callback-function⑤">(2)</a> <a href="#ref-for-invoke-a-callback-function⑥">(3)</a>
    <li><a href="#ref-for-invoke-a-callback-function⑦">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-invoke-a-callback-function⑧">5.5.4. Default controllers</a> <a href="#ref-for-invoke-a-callback-function⑨">(2)</a> <a href="#ref-for-invoke-a-callback-function①⓪">(3)</a> <a href="#ref-for-invoke-a-callback-function①①">(4)</a>
    <li><a href="#ref-for-invoke-a-callback-function①②">6.2.4. Constructor and properties</a> <a href="#ref-for-invoke-a-callback-function①③">(2)</a>
    <li><a href="#ref-for-invoke-a-callback-function①④">6.4.2. Default controllers</a> <a href="#ref-for-invoke-a-callback-function①⑤">(2)</a>
    <li><a href="#ref-for-invoke-a-callback-function①⑥">7.4. Abstract operations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-new">
   <a href="https://heycam.github.io/webidl/#new">https://heycam.github.io/webidl/#new</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-new">4.2.6. Transfer via postMessage()</a> <a href="#ref-for-new①">(2)</a> <a href="#ref-for-new②">(3)</a>
    <li><a href="#ref-for-new③">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-new④">4.9.1. Working with readable streams</a> <a href="#ref-for-new⑤">(2)</a> <a href="#ref-for-new⑥">(3)</a> <a href="#ref-for-new⑦">(4)</a>
    <li><a href="#ref-for-new⑧">4.9.4. Default controllers</a>
    <li><a href="#ref-for-new⑨">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-new①⓪">5.2.5. Transfer via postMessage()</a> <a href="#ref-for-new①①">(2)</a> <a href="#ref-for-new①②">(3)</a>
    <li><a href="#ref-for-new①③">5.5.1. Working with writable streams</a> <a href="#ref-for-new①④">(2)</a> <a href="#ref-for-new①⑤">(3)</a>
    <li><a href="#ref-for-new①⑥">5.5.4. Default controllers</a>
    <li><a href="#ref-for-new①⑦">6.4.2. Default controllers</a>
    <li><a href="#ref-for-new①⑧">8.2. Transferable streams</a> <a href="#ref-for-new①⑨">(2)</a>
    <li><a href="#ref-for-new②⓪">9.1.1. Creation and manipulation</a> <a href="#ref-for-new②①">(2)</a> <a href="#ref-for-new②②">(3)</a>
    <li><a href="#ref-for-new②③">9.2.1. Creation</a> <a href="#ref-for-new②④">(2)</a> <a href="#ref-for-new②⑤">(3)</a>
    <li><a href="#ref-for-new②⑥">9.3.1. Creation and manipulation</a> <a href="#ref-for-new②⑦">(2)</a> <a href="#ref-for-new②⑧">(3)</a> <a href="#ref-for-new②⑨">(4)</a>
    <li><a href="#ref-for-new③⓪">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-object">
   <a href="https://heycam.github.io/webidl/#idl-object">https://heycam.github.io/webidl/#idl-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-object">4.2.1. Interface definition</a>
    <li><a href="#ref-for-idl-object①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-idl-object②">6.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-platform-object">
   <a href="https://heycam.github.io/webidl/#dfn-platform-object">https://heycam.github.io/webidl/#dfn-platform-object</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-platform-object">3. Conventions</a>
    <li><a href="#ref-for-dfn-platform-object①">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-dfn-perform-steps-once-promise-is-settled">
   <a href="https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled">https://heycam.github.io/webidl/#dfn-perform-steps-once-promise-is-settled</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled①">6.4.2. Default controllers</a>
    <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled②">6.4.3. Default sinks</a> <a href="#ref-for-dfn-perform-steps-once-promise-is-settled③">(2)</a>
    <li><a href="#ref-for-dfn-perform-steps-once-promise-is-settled④">8.2. Transferable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-reject">
   <a href="https://heycam.github.io/webidl/#reject">https://heycam.github.io/webidl/#reject</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reject">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-reject①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-reject②">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-reject③">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-reject④">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-reject⑤">4.9.3. Readers</a>
    <li><a href="#ref-for-reject⑥">5.5.2. Interfacing with controllers</a> <a href="#ref-for-reject⑦">(2)</a> <a href="#ref-for-reject⑧">(3)</a> <a href="#ref-for-reject⑨">(4)</a> <a href="#ref-for-reject①⓪">(5)</a> <a href="#ref-for-reject①①">(6)</a> <a href="#ref-for-reject①②">(7)</a> <a href="#ref-for-reject①③">(8)</a>
    <li><a href="#ref-for-reject①④">5.5.3. Writers</a> <a href="#ref-for-reject①⑤">(2)</a>
    <li><a href="#ref-for-reject①⑥">9.1.2. Reading</a> <a href="#ref-for-reject①⑦">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-resolve">
   <a href="https://heycam.github.io/webidl/#resolve">https://heycam.github.io/webidl/#resolve</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-resolve">4.2.5. Asynchronous iteration</a> <a href="#ref-for-resolve①">(2)</a>
    <li><a href="#ref-for-resolve②">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-resolve③">(2)</a>
    <li><a href="#ref-for-resolve④">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-resolve⑤">(2)</a>
    <li><a href="#ref-for-resolve⑥">4.9.1. Working with readable streams</a> <a href="#ref-for-resolve⑦">(2)</a> <a href="#ref-for-resolve⑧">(3)</a> <a href="#ref-for-resolve⑨">(4)</a> <a href="#ref-for-resolve①⓪">(5)</a>
    <li><a href="#ref-for-resolve①①">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-resolve①②">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-resolve①③">5.5.2. Interfacing with controllers</a> <a href="#ref-for-resolve①④">(2)</a> <a href="#ref-for-resolve①⑤">(3)</a> <a href="#ref-for-resolve①⑥">(4)</a> <a href="#ref-for-resolve①⑦">(5)</a> <a href="#ref-for-resolve①⑧">(6)</a>
    <li><a href="#ref-for-resolve①⑨">6.2.4. Constructor and properties</a> <a href="#ref-for-resolve②⓪">(2)</a>
    <li><a href="#ref-for-resolve②①">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-resolve②②">8.2. Transferable streams</a> <a href="#ref-for-resolve②③">(2)</a>
    <li><a href="#ref-for-resolve②④">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-sequence">
   <a href="https://heycam.github.io/webidl/#idl-sequence">https://heycam.github.io/webidl/#idl-sequence</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-sequence">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-this">
   <a href="https://heycam.github.io/webidl/#this">https://heycam.github.io/webidl/#this</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-this">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-this①">(2)</a> <a href="#ref-for-this②">(3)</a> <a href="#ref-for-this③">(4)</a> <a href="#ref-for-this④">(5)</a> <a href="#ref-for-this⑤">(6)</a> <a href="#ref-for-this⑥">(7)</a> <a href="#ref-for-this⑦">(8)</a> <a href="#ref-for-this⑧">(9)</a> <a href="#ref-for-this⑨">(10)</a> <a href="#ref-for-this①⓪">(11)</a> <a href="#ref-for-this①①">(12)</a> <a href="#ref-for-this①②">(13)</a>
    <li><a href="#ref-for-this①③">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-this①④">4.3.3. Methods and properties</a> <a href="#ref-for-this①⑤">(2)</a> <a href="#ref-for-this①⑥">(3)</a>
    <li><a href="#ref-for-this①⑦">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-this①⑧">(2)</a> <a href="#ref-for-this①⑨">(3)</a> <a href="#ref-for-this②⓪">(4)</a> <a href="#ref-for-this②①">(5)</a> <a href="#ref-for-this②②">(6)</a>
    <li><a href="#ref-for-this②③">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-this②④">(2)</a> <a href="#ref-for-this②⑤">(3)</a> <a href="#ref-for-this②⑥">(4)</a> <a href="#ref-for-this②⑦">(5)</a> <a href="#ref-for-this②⑧">(6)</a>
    <li><a href="#ref-for-this②⑨">4.6.3. Methods and properties</a> <a href="#ref-for-this③⓪">(2)</a> <a href="#ref-for-this③①">(3)</a> <a href="#ref-for-this③②">(4)</a> <a href="#ref-for-this③③">(5)</a> <a href="#ref-for-this③④">(6)</a>
    <li><a href="#ref-for-this③⑤">4.6.4. Internal methods</a> <a href="#ref-for-this③⑥">(2)</a> <a href="#ref-for-this③⑦">(3)</a> <a href="#ref-for-this③⑧">(4)</a> <a href="#ref-for-this③⑨">(5)</a> <a href="#ref-for-this④⓪">(6)</a> <a href="#ref-for-this④①">(7)</a> <a href="#ref-for-this④②">(8)</a> <a href="#ref-for-this④③">(9)</a> <a href="#ref-for-this④④">(10)</a> <a href="#ref-for-this④⑤">(11)</a>
    <li><a href="#ref-for-this④⑥">4.7.3. Methods and properties</a> <a href="#ref-for-this④⑦">(2)</a> <a href="#ref-for-this④⑧">(3)</a> <a href="#ref-for-this④⑨">(4)</a> <a href="#ref-for-this⑤⓪">(5)</a> <a href="#ref-for-this⑤①">(6)</a> <a href="#ref-for-this⑤②">(7)</a> <a href="#ref-for-this⑤③">(8)</a> <a href="#ref-for-this⑤④">(9)</a> <a href="#ref-for-this⑤⑤">(10)</a> <a href="#ref-for-this⑤⑥">(11)</a> <a href="#ref-for-this⑤⑦">(12)</a> <a href="#ref-for-this⑤⑧">(13)</a> <a href="#ref-for-this⑤⑨">(14)</a>
    <li><a href="#ref-for-this⑥⓪">4.7.4. Internal methods</a> <a href="#ref-for-this⑥①">(2)</a> <a href="#ref-for-this⑥②">(3)</a> <a href="#ref-for-this⑥③">(4)</a> <a href="#ref-for-this⑥④">(5)</a> <a href="#ref-for-this⑥⑤">(6)</a> <a href="#ref-for-this⑥⑥">(7)</a> <a href="#ref-for-this⑥⑦">(8)</a> <a href="#ref-for-this⑥⑧">(9)</a> <a href="#ref-for-this⑥⑨">(10)</a> <a href="#ref-for-this⑦⓪">(11)</a> <a href="#ref-for-this⑦①">(12)</a> <a href="#ref-for-this⑦②">(13)</a> <a href="#ref-for-this⑦③">(14)</a> <a href="#ref-for-this⑦④">(15)</a>
    <li><a href="#ref-for-this⑦⑤">4.8.3. Methods and properties</a> <a href="#ref-for-this⑦⑥">(2)</a> <a href="#ref-for-this⑦⑦">(3)</a> <a href="#ref-for-this⑦⑧">(4)</a> <a href="#ref-for-this⑦⑨">(5)</a> <a href="#ref-for-this⑧⓪">(6)</a> <a href="#ref-for-this⑧①">(7)</a> <a href="#ref-for-this⑧②">(8)</a>
    <li><a href="#ref-for-this⑧③">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-this⑧④">(2)</a> <a href="#ref-for-this⑧⑤">(3)</a> <a href="#ref-for-this⑧⑥">(4)</a> <a href="#ref-for-this⑧⑦">(5)</a> <a href="#ref-for-this⑧⑧">(6)</a> <a href="#ref-for-this⑧⑨">(7)</a> <a href="#ref-for-this⑨⓪">(8)</a> <a href="#ref-for-this⑨①">(9)</a>
    <li><a href="#ref-for-this⑨②">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-this⑨③">(2)</a> <a href="#ref-for-this⑨④">(3)</a> <a href="#ref-for-this⑨⑤">(4)</a> <a href="#ref-for-this⑨⑥">(5)</a> <a href="#ref-for-this⑨⑦">(6)</a> <a href="#ref-for-this⑨⑧">(7)</a> <a href="#ref-for-this⑨⑨">(8)</a> <a href="#ref-for-this①⓪⓪">(9)</a> <a href="#ref-for-this①⓪①">(10)</a> <a href="#ref-for-this①⓪②">(11)</a> <a href="#ref-for-this①⓪③">(12)</a> <a href="#ref-for-this①⓪④">(13)</a>
    <li><a href="#ref-for-this①⓪⑤">5.4.3. Methods</a> <a href="#ref-for-this①⓪⑥">(2)</a>
    <li><a href="#ref-for-this①⓪⑦">5.4.4. Internal methods</a> <a href="#ref-for-this①⓪⑧">(2)</a> <a href="#ref-for-this①⓪⑨">(3)</a>
    <li><a href="#ref-for-this①①⓪">6.2.4. Constructor and properties</a> <a href="#ref-for-this①①①">(2)</a> <a href="#ref-for-this①①②">(3)</a> <a href="#ref-for-this①①③">(4)</a> <a href="#ref-for-this①①④">(5)</a>
    <li><a href="#ref-for-this①①⑤">6.3.3. Methods and properties</a> <a href="#ref-for-this①①⑥">(2)</a> <a href="#ref-for-this①①⑦">(3)</a> <a href="#ref-for-this①①⑧">(4)</a>
    <li><a href="#ref-for-this①①⑨">7.2.3. Constructor and properties</a> <a href="#ref-for-this①②⓪">(2)</a> <a href="#ref-for-this①②①">(3)</a>
    <li><a href="#ref-for-this①②②">7.3.3. Constructor and properties</a> <a href="#ref-for-this①②③">(2)</a> <a href="#ref-for-this①②④">(3)</a>
    <li><a href="#ref-for-this①②⑤">9.1.1. Creation and manipulation</a>
    <li><a href="#ref-for-this①②⑥">9.2.1. Creation</a>
    <li><a href="#ref-for-this①②⑦">9.3.1. Creation and manipulation</a>
    <li><a href="#ref-for-this①②⑧">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-this①②⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-undefined">
   <a href="https://heycam.github.io/webidl/#idl-undefined">https://heycam.github.io/webidl/#idl-undefined</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-undefined">4.2.1. Interface definition</a> <a href="#ref-for-idl-undefined①">(2)</a>
    <li><a href="#ref-for-idl-undefined②">4.2.3. The underlying source API</a> <a href="#ref-for-idl-undefined③">(2)</a>
    <li><a href="#ref-for-idl-undefined④">4.3.1. Mixin definition</a> <a href="#ref-for-idl-undefined⑤">(2)</a>
    <li><a href="#ref-for-idl-undefined⑥">4.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-undefined⑦">4.5.1. Interface definition</a>
    <li><a href="#ref-for-idl-undefined⑧">4.6.1. Interface definition</a> <a href="#ref-for-idl-undefined⑨">(2)</a> <a href="#ref-for-idl-undefined①⓪">(3)</a>
    <li><a href="#ref-for-idl-undefined①①">4.7.1. Interface definition</a> <a href="#ref-for-idl-undefined①②">(2)</a> <a href="#ref-for-idl-undefined①③">(3)</a>
    <li><a href="#ref-for-idl-undefined①④">4.8.1. Interface definition</a> <a href="#ref-for-idl-undefined①⑤">(2)</a>
    <li><a href="#ref-for-idl-undefined①⑥">5.2.1. Interface definition</a> <a href="#ref-for-idl-undefined①⑦">(2)</a>
    <li><a href="#ref-for-idl-undefined①⑧">5.2.3. The underlying sink API</a> <a href="#ref-for-idl-undefined①⑨">(2)</a> <a href="#ref-for-idl-undefined②⓪">(3)</a>
    <li><a href="#ref-for-idl-undefined②①">5.3.1. Interface definition</a> <a href="#ref-for-idl-undefined②②">(2)</a> <a href="#ref-for-idl-undefined②③">(3)</a> <a href="#ref-for-idl-undefined②④">(4)</a> <a href="#ref-for-idl-undefined②⑤">(5)</a> <a href="#ref-for-idl-undefined②⑥">(6)</a>
    <li><a href="#ref-for-idl-undefined②⑦">5.4.1. Interface definition</a>
    <li><a href="#ref-for-idl-undefined②⑧">6.2.3. The transformer API</a> <a href="#ref-for-idl-undefined②⑨">(2)</a>
    <li><a href="#ref-for-idl-undefined③⓪">6.3.1. Interface definition</a> <a href="#ref-for-idl-undefined③①">(2)</a> <a href="#ref-for-idl-undefined③②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unrestricted-double">
   <a href="https://heycam.github.io/webidl/#idl-unrestricted-double">https://heycam.github.io/webidl/#idl-unrestricted-double</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unrestricted-double">3. Conventions</a>
    <li><a href="#ref-for-idl-unrestricted-double①">4.6.1. Interface definition</a>
    <li><a href="#ref-for-idl-unrestricted-double②">4.7.1. Interface definition</a>
    <li><a href="#ref-for-idl-unrestricted-double③">5.3.1. Interface definition</a>
    <li><a href="#ref-for-idl-unrestricted-double④">6.3.1. Interface definition</a>
    <li><a href="#ref-for-idl-unrestricted-double⑤">7.1. The queuing strategy API</a> <a href="#ref-for-idl-unrestricted-double⑥">(2)</a> <a href="#ref-for-idl-unrestricted-double⑦">(3)</a> <a href="#ref-for-idl-unrestricted-double⑧">(4)</a>
    <li><a href="#ref-for-idl-unrestricted-double⑨">7.2.1. Interface definition</a>
    <li><a href="#ref-for-idl-unrestricted-double①⓪">7.3.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-idl-unsigned-long-long">
   <a href="https://heycam.github.io/webidl/#idl-unsigned-long-long">https://heycam.github.io/webidl/#idl-unsigned-long-long</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-idl-unsigned-long-long">4.2.3. The underlying source API</a> <a href="#ref-for-idl-unsigned-long-long①">(2)</a>
    <li><a href="#ref-for-idl-unsigned-long-long②">4.8.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-upon-fulfillment">
   <a href="https://heycam.github.io/webidl/#upon-fulfillment">https://heycam.github.io/webidl/#upon-fulfillment</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-upon-fulfillment">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-upon-fulfillment①">4.9.4. Default controllers</a> <a href="#ref-for-upon-fulfillment②">(2)</a>
    <li><a href="#ref-for-upon-fulfillment③">4.9.5. Byte stream controllers</a> <a href="#ref-for-upon-fulfillment④">(2)</a>
    <li><a href="#ref-for-upon-fulfillment⑤">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-upon-fulfillment⑥">5.5.4. Default controllers</a> <a href="#ref-for-upon-fulfillment⑦">(2)</a> <a href="#ref-for-upon-fulfillment⑧">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="term-for-upon-rejection">
   <a href="https://heycam.github.io/webidl/#upon-rejection">https://heycam.github.io/webidl/#upon-rejection</a><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-upon-rejection">4.9.1. Working with readable streams</a> <a href="#ref-for-upon-rejection①">(2)</a>
    <li><a href="#ref-for-upon-rejection②">4.9.4. Default controllers</a> <a href="#ref-for-upon-rejection③">(2)</a>
    <li><a href="#ref-for-upon-rejection④">4.9.5. Byte stream controllers</a> <a href="#ref-for-upon-rejection⑤">(2)</a>
    <li><a href="#ref-for-upon-rejection⑥">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-upon-rejection⑦">5.5.4. Default controllers</a> <a href="#ref-for-upon-rejection⑧">(2)</a> <a href="#ref-for-upon-rejection⑨">(3)</a>
   </ul>
  </aside>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[COMPRESSION]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-compressionstream">CompressionStream</span>
    </ul>
   <li>
    <a data-link-type="biblio">[DOM]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-abortcontroller">AbortController</span>
     <li><span class="dfn-paneled" id="term-for-abortsignal">AbortSignal</span>
     <li><span class="dfn-paneled" id="term-for-abortsignal-aborted-flag">aborted flag</span>
     <li><span class="dfn-paneled" id="term-for-abortsignal-add">add</span>
     <li><span class="dfn-paneled" id="term-for-abortsignal-remove">remove</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ECMASCRIPT]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-sec-arraybuffer-constructor">%ArrayBuffer%</span>
     <li><span class="dfn-paneled" id="term-for-sec-dataview-constructor">%DataView%</span>
     <li><span class="dfn-paneled" id="term-for-sec-properties-of-the-object-prototype-object">%Object.prototype%</span>
     <li><span class="dfn-paneled" id="term-for-sec-typedarray-objects">%Uint8Array%</span>
     <li><span class="dfn-paneled" id="term-for-sec-arraybuffer-objects">ArrayBuffer</span>
     <li><span class="dfn-paneled" id="term-for-sec-clonearraybuffer">CloneArrayBuffer</span>
     <li><span class="dfn-paneled" id="term-for-sec-construct">Construct</span>
     <li><span class="dfn-paneled" id="term-for-sec-copydatablockbytes">CopyDataBlockBytes</span>
     <li><span class="dfn-paneled" id="term-for-sec-createarrayfromlist">CreateArrayFromList</span>
     <li><span class="dfn-paneled" id="term-for-sec-createbuiltinfunction">CreateBuiltinFunction</span>
     <li><span class="dfn-paneled" id="term-for-sec-createdataproperty">CreateDataProperty</span>
     <li><span class="dfn-paneled" id="term-for-sec-dataview-objects">DataView</span>
     <li><span class="dfn-paneled" id="term-for-sec-detacharraybuffer">DetachArrayBuffer</span>
     <li><span class="dfn-paneled" id="term-for-sec-get-o-p">Get</span>
     <li><span class="dfn-paneled" id="term-for-sec-getv">GetV</span>
     <li><span class="dfn-paneled" id="term-for-sec-isdetachedbuffer">IsDetachedBuffer</span>
     <li><span class="dfn-paneled" id="term-for-sec-isinteger">IsInteger</span>
     <li><span class="dfn-paneled" id="term-for-sec-ecmascript-language-types-number-type">Number</span>
     <li><span class="dfn-paneled" id="term-for-sec-ordinaryobjectcreate">OrdinaryObjectCreate</span>
     <li><span class="dfn-paneled" id="term-for-sec-setfunctionlength">SetFunctionLength</span>
     <li><span class="dfn-paneled" id="term-for-sec-setfunctionname">SetFunctionName</span>
     <li><span class="dfn-paneled" id="term-for-sec-ecmascript-data-types-and-values">Type</span>
     <li><span class="dfn-paneled" id="term-for-sec-native-error-types-used-in-this-standard-typeerror">TypeError</span>
     <li><span class="dfn-paneled" id="term-for-sec-typedarray-objects①">Uint8Array</span>
     <li><span class="dfn-paneled" id="term-for-sec-algorithm-conventions-abstract-operations">abstract operation</span>
     <li><span class="dfn-paneled" id="term-for-sec-completion-record-specification-type">completion record</span>
     <li><span class="dfn-paneled" id="term-for-sec-object-internal-methods-and-internal-slots">internal slot</span>
     <li><span class="dfn-paneled" id="term-for-sec-array.prototype.map">map</span>
     <li><span class="dfn-paneled" id="term-for-sec-ecmascript-language-types-number-type①">number type</span>
     <li><span class="dfn-paneled" id="term-for-sec-code-realms">realm</span>
     <li><span class="dfn-paneled" id="term-for-current-realm">the current realm</span>
     <li><span class="dfn-paneled" id="term-for-table-49">the typed array constructors table</span>
     <li><span class="dfn-paneled" id="term-for-sec-typedarray-objects②">typed array</span>
    </ul>
   <li>
    <a data-link-type="biblio">[ENCODING]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-textdecoderstream">TextDecoderStream</span>
    </ul>
   <li>
    <a data-link-type="biblio">[FETCH]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-response">Response</span>
     <li><span class="dfn-paneled" id="term-for-concept-request-body">body</span>
     <li><span class="dfn-paneled" id="term-for-dom-global-fetch">fetch(input)</span>
    </ul>
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-messageport">MessagePort</span>
     <li><span class="dfn-paneled" id="term-for-structureddeserialize">StructuredDeserialize</span>
     <li><span class="dfn-paneled" id="term-for-structureddeserializewithtransfer">StructuredDeserializeWithTransfer</span>
     <li><span class="dfn-paneled" id="term-for-structuredserialize">StructuredSerialize</span>
     <li><span class="dfn-paneled" id="term-for-structuredserializewithtransfer">StructuredSerializeWithTransfer</span>
     <li><span class="dfn-paneled" id="term-for-transferable">Transferable</span>
     <li><span class="dfn-paneled" id="term-for-websocket">WebSocket</span>
     <li><span class="dfn-paneled" id="term-for-dom-websocket-bufferedamount">bufferedAmount</span>
     <li><span class="dfn-paneled" id="term-for-entangle">entangle</span>
     <li><span class="dfn-paneled" id="term-for-global-object">global object</span>
     <li><span class="dfn-paneled" id="term-for-the-img-element">img</span>
     <li><span class="dfn-paneled" id="term-for-in-parallel">in parallel</span>
     <li><span class="dfn-paneled" id="term-for-event-message">message</span>
     <li><span class="dfn-paneled" id="term-for-message-port-post-message-steps">message port post message steps</span>
     <li><span class="dfn-paneled" id="term-for-event-messageerror">messageerror</span>
     <li><span class="dfn-paneled" id="term-for-port-message-queue">port message queue</span>
     <li><span class="dfn-paneled" id="term-for-queue-a-microtask">queue a microtask</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-global">relevant global object</span>
     <li><span class="dfn-paneled" id="term-for-concept-relevant-realm">relevant realm</span>
     <li><span class="dfn-paneled" id="term-for-relevant-settings-object">relevant settings object</span>
     <li><span class="dfn-paneled" id="term-for-serializable-objects">serializable objects</span>
     <li><span class="dfn-paneled" id="term-for-transfer-steps">transfer steps</span>
     <li><span class="dfn-paneled" id="term-for-transfer-receiving-steps">transfer-receiving steps</span>
     <li><span class="dfn-paneled" id="term-for-transferable-objects">transferable objects</span>
     <li><span class="dfn-paneled" id="term-for-event-unhandledrejection">unhandledrejection</span>
    </ul>
   <li>
    <a data-link-type="biblio">[INFRA]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-list-append">append <small>(for list)</small></span>
     <li><span class="dfn-paneled" id="term-for-set-append">append <small>(for set)</small></span>
     <li><span class="dfn-paneled" id="term-for-byte-sequence">byte sequence</span>
     <li><span class="dfn-paneled" id="term-for-map-exists">exist</span>
     <li><span class="dfn-paneled" id="term-for-list-iterate">for each</span>
     <li><span class="dfn-paneled" id="term-for-list-is-empty">is empty</span>
     <li><span class="dfn-paneled" id="term-for-struct-item">item</span>
     <li><span class="dfn-paneled" id="term-for-list">list</span>
     <li><span class="dfn-paneled" id="term-for-ordered-set">ordered set</span>
     <li><span class="dfn-paneled" id="term-for-list-remove">remove</span>
     <li><span class="dfn-paneled" id="term-for-list-size">size</span>
     <li><span class="dfn-paneled" id="term-for-struct">struct</span>
     <li><span class="dfn-paneled" id="term-for-iteration-while">while</span>
    </ul>
   <li>
    <a data-link-type="biblio">[SERVICE-WORKERS]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-service-worker-global-scope-fetch-event">fetch</span>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL]</a> defines the following terms:
    <ul>
     <li><span class="dfn-paneled" id="term-for-aborterror">AbortError</span>
     <li><span class="dfn-paneled" id="term-for-ArrayBufferView">ArrayBufferView</span>
     <li><span class="dfn-paneled" id="term-for-idl-DOMException">DOMException</span>
     <li><span class="dfn-paneled" id="term-for-datacloneerror">DataCloneError</span>
     <li><span class="dfn-paneled" id="term-for-EnforceRange">EnforceRange</span>
     <li><span class="dfn-paneled" id="term-for-Exposed">Exposed</span>
     <li><span class="dfn-paneled" id="term-for-Function">Function</span>
     <li><span class="dfn-paneled" id="term-for-idl-promise">Promise</span>
     <li><span class="dfn-paneled" id="term-for-exceptiondef-rangeerror">RangeError</span>
     <li><span class="dfn-paneled" id="term-for-a-new-promise">a new promise</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-rejected-with">a promise rejected with</span>
     <li><span class="dfn-paneled" id="term-for-a-promise-resolved-with">a promise resolved with</span>
     <li><span class="dfn-paneled" id="term-for-idl-any">any</span>
     <li><span class="dfn-paneled" id="term-for-asynchronous-iterator-initialization-steps">asynchronous iterator initialization steps</span>
     <li><span class="dfn-paneled" id="term-for-asynchronous-iterator-return">asynchronous iterator return</span>
     <li><span class="dfn-paneled" id="term-for-idl-boolean">boolean</span>
     <li><span class="dfn-paneled" id="term-for-dfn-callback-context">callback context</span>
     <li><span class="dfn-paneled" id="term-for-dfn-callback-this-value">callback this value</span>
     <li><span class="dfn-paneled" id="term-for-idl-constructors">constructor operations</span>
     <li><span class="dfn-paneled" id="term-for-dfn-convert-ecmascript-to-idl-value">converted to an idl value</span>
     <li><span class="dfn-paneled" id="term-for-dfn-detach">detach</span>
     <li><span class="dfn-paneled" id="term-for-end-of-iteration">end of iteration</span>
     <li><span class="dfn-paneled" id="term-for-dfn-get-the-next-iteration-result">get the next iteration result</span>
     <li><span class="dfn-paneled" id="term-for-waiting-for-all-promise">getting a promise to wait for all</span>
     <li><span class="dfn-paneled" id="term-for-implements">implements</span>
     <li><span class="dfn-paneled" id="term-for-include">include</span>
     <li><span class="dfn-paneled" id="term-for-invoke-a-callback-function">invoke</span>
     <li><span class="dfn-paneled" id="term-for-new">new</span>
     <li><span class="dfn-paneled" id="term-for-idl-object">object</span>
     <li><span class="dfn-paneled" id="term-for-dfn-platform-object">platform object</span>
     <li><span class="dfn-paneled" id="term-for-dfn-perform-steps-once-promise-is-settled">reacting</span>
     <li><span class="dfn-paneled" id="term-for-reject">reject</span>
     <li><span class="dfn-paneled" id="term-for-resolve">resolve</span>
     <li><span class="dfn-paneled" id="term-for-idl-sequence">sequence</span>
     <li><span class="dfn-paneled" id="term-for-this">this</span>
     <li><span class="dfn-paneled" id="term-for-idl-undefined">undefined</span>
     <li><span class="dfn-paneled" id="term-for-idl-unrestricted-double">unrestricted double</span>
     <li><span class="dfn-paneled" id="term-for-idl-unsigned-long-long">unsigned long long</span>
     <li><span class="dfn-paneled" id="term-for-upon-fulfillment">upon fulfillment</span>
     <li><span class="dfn-paneled" id="term-for-upon-rejection">upon rejection</span>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-compression">[COMPRESSION]
   <dd><a href="https://wicg.github.io/compression/"><cite>Compression Streams</cite></a>. cg-draft. URL: <a href="https://wicg.github.io/compression/">https://wicg.github.io/compression/</a>
   <dt id="biblio-dom">[DOM]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/"><cite>DOM Standard</cite></a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-ecmascript">[ECMASCRIPT]
   <dd><a href="https://tc39.es/ecma262/"><cite>ECMAScript Language Specification</cite></a>. URL: <a href="https://tc39.es/ecma262/">https://tc39.es/ecma262/</a>
   <dt id="biblio-encoding">[ENCODING]
   <dd>Anne van Kesteren. <a href="https://encoding.spec.whatwg.org/"><cite>Encoding Standard</cite></a>. Living Standard. URL: <a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
   <dt id="biblio-html">[HTML]
   <dd>Anne van Kesteren; et al. <a href="https://html.spec.whatwg.org/multipage/"><cite>HTML Standard</cite></a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-ieee-754">[IEEE-754]
   <dd><a href="http://ieeexplore.ieee.org/servlet/opac?punumber=4610933"><cite>IEEE Standard for Floating-Point Arithmetic</cite></a>. 29 August 2008. URL: <a href="http://ieeexplore.ieee.org/servlet/opac?punumber=4610933">http://ieeexplore.ieee.org/servlet/opac?punumber=4610933</a>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/"><cite>Infra Standard</cite></a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-webidl">[WebIDL]
   <dd>Boris Zbarsky. <a href="https://heycam.github.io/webidl/"><cite>Web IDL</cite></a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-fetch">[FETCH]
   <dd>Anne van Kesteren. <a href="https://fetch.spec.whatwg.org/"><cite>Fetch Standard</cite></a>. Living Standard. URL: <a href="https://fetch.spec.whatwg.org/">https://fetch.spec.whatwg.org/</a>
   <dt id="biblio-service-workers">[SERVICE-WORKERS]
   <dd>Alex Russell; et al. <a href="https://w3c.github.io/ServiceWorker/"><cite>Service Workers 1</cite></a>. URL: <a href="https://w3c.github.io/ServiceWorker/">https://w3c.github.io/ServiceWorker/</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl highlight def">[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <a href="#readablestream"><code><c- g>ReadableStream</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#rs-constructor"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object"><c- b>object</c-></a> <a href="#dom-readablestream-readablestream-underlyingsource-strategy-underlyingsource"><code><c- g>underlyingSource</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy"><c- n>QueuingStrategy</c-></a> <a href="#dom-readablestream-readablestream-underlyingsource-strategy-strategy"><code><c- g>strategy</c-></code></a> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#rs-locked"><c- g>locked</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-cancel"><c- g>cancel</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-readablestream-cancel-reason-reason"><code><c- g>reason</c-></code></a>);
  <a data-link-type="idl-name" href="#typedefdef-readablestreamreader"><c- n>ReadableStreamReader</c-></a> <a class="idl-code" data-link-type="method" href="#rs-get-reader"><c- g>getReader</c-></a>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-readablestreamgetreaderoptions"><c- n>ReadableStreamGetReaderOptions</c-></a> <a href="#dom-readablestream-getreader-options-options"><code><c- g>options</c-></code></a> = {});
  <a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="method" href="#rs-pipe-through"><c- g>pipeThrough</c-></a>(<a data-link-type="idl-name" href="#dictdef-readablewritablepair"><c- n>ReadableWritablePair</c-></a> <a href="#dom-readablestream-pipethrough-transform-options-transform"><code><c- g>transform</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-streampipeoptions"><c- n>StreamPipeOptions</c-></a> <a href="#dom-readablestream-pipethrough-transform-options-options"><code><c- g>options</c-></code></a> = {});
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-pipe-to"><c- g>pipeTo</c-></a>(<a data-link-type="idl-name" href="#writablestream"><c- n>WritableStream</c-></a> <a href="#dom-readablestream-pipeto-destination-options-destination"><code><c- g>destination</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-streampipeoptions"><c- n>StreamPipeOptions</c-></a> <a href="#dom-readablestream-pipeto-destination-options-options"><code><c- g>options</c-></code></a> = {});
  <a data-link-type="dfn" href="https://heycam.github.io/webidl/#idl-sequence"><c- b>sequence</c-></a>&lt;<a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a>> <a class="idl-code" data-link-type="method" href="#rs-tee"><c- g>tee</c-></a>();

  <c- b>async</c-> <c- b>iterable</c->&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a>>(<c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-readablestreamiteratoroptions"><c- n>ReadableStreamIteratorOptions</c-></a> <a href="#dom-readablestream-options"><code><c- g>options</c-></code></a> = {});
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#readablestreamdefaultreader"><c- n>ReadableStreamDefaultReader</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#readablestreambyobreader"><c- n>ReadableStreamBYOBReader</c-></a>) <a href="#typedefdef-readablestreamreader"><code><c- g>ReadableStreamReader</c-></code></a>;

<c- b>enum</c-> <a href="#enumdef-readablestreamreadermode"><code><c- g>ReadableStreamReaderMode</c-></code></a> { <a href="#dom-readablestreamreadermode-byob"><code><c- s>"byob"</c-></code></a> };

<c- b>dictionary</c-> <a href="#dictdef-readablestreamgetreaderoptions"><code><c- g>ReadableStreamGetReaderOptions</c-></code></a> {
  <a data-link-type="idl-name" href="#enumdef-readablestreamreadermode"><c- n>ReadableStreamReaderMode</c-></a> <a data-type="ReadableStreamReaderMode " href="#dom-readablestreamgetreaderoptions-mode"><code><c- g>mode</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-readablestreamiteratoroptions"><code><c- g>ReadableStreamIteratorOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-readablestreamiteratoroptions-preventcancel"><code><c- g>preventCancel</c-></code></a> = <c- b>false</c->;
};

<c- b>dictionary</c-> <a href="#dictdef-readablewritablepair"><code><c- g>ReadableWritablePair</c-></code></a> {
  <c- b>required</c-> <a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a data-type="ReadableStream " href="#dom-readablewritablepair-readable"><code><c- g>readable</c-></code></a>;
  <c- b>required</c-> <a data-link-type="idl-name" href="#writablestream"><c- n>WritableStream</c-></a> <a data-type="WritableStream " href="#dom-readablewritablepair-writable"><code><c- g>writable</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-streampipeoptions"><code><c- g>StreamPipeOptions</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-streampipeoptions-preventclose"><code><c- g>preventClose</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-streampipeoptions-preventabort"><code><c- g>preventAbort</c-></code></a> = <c- b>false</c->;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-default="false" data-type="boolean " href="#dom-streampipeoptions-preventcancel"><code><c- g>preventCancel</c-></code></a> = <c- b>false</c->;
  <a data-link-type="idl-name" href="https://dom.spec.whatwg.org/#abortsignal"><c- n>AbortSignal</c-></a> <a data-type="AbortSignal " href="#dom-streampipeoptions-signal"><code><c- g>signal</c-></code></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-underlyingsource"><code><c- g>UnderlyingSource</c-></code></a> {
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcestartcallback"><c- n>UnderlyingSourceStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourceStartCallback " href="#dom-underlyingsource-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcepullcallback"><c- n>UnderlyingSourcePullCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourcePullCallback " href="#dom-underlyingsource-pull"><c- g>pull</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsourcecancelcallback"><c- n>UnderlyingSourceCancelCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSourceCancelCallback " href="#dom-underlyingsource-cancel"><c- g>cancel</c-></a>;
  <a data-link-type="idl-name" href="#enumdef-readablestreamtype"><c- n>ReadableStreamType</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="ReadableStreamType " href="#dom-underlyingsource-type"><c- g>type</c-></a>;
  [<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="unsigned long long " href="#dom-underlyingsource-autoallocatechunksize"><c- g>autoAllocateChunkSize</c-></a>;
};

<c- b>typedef</c-> (<a data-link-type="idl-name" href="#readablestreamdefaultcontroller"><c- n>ReadableStreamDefaultController</c-></a> <c- b>or</c-> <a data-link-type="idl-name" href="#readablebytestreamcontroller"><c- n>ReadableByteStreamController</c-></a>) <a href="#typedefdef-readablestreamcontroller"><code><c- g>ReadableStreamController</c-></code></a>;

<c- b>callback</c-> <a href="#callbackdef-underlyingsourcestartcallback"><code><c- g>UnderlyingSourceStartCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#typedefdef-readablestreamcontroller"><c- n>ReadableStreamController</c-></a> <a href="#dom-underlyingsourcestartcallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-underlyingsourcepullcallback"><code><c- g>UnderlyingSourcePullCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<a data-link-type="idl-name" href="#typedefdef-readablestreamcontroller"><c- n>ReadableStreamController</c-></a> <a href="#dom-underlyingsourcepullcallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-underlyingsourcecancelcallback"><code><c- g>UnderlyingSourceCancelCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-underlyingsourcecancelcallback-reason"><code><c- g>reason</c-></code></a>);

<c- b>enum</c-> <a href="#enumdef-readablestreamtype"><code><c- g>ReadableStreamType</c-></code></a> { <a class="idl-code" data-link-type="enum-value" href="#dom-readablestreamtype-bytes"><c- s>"bytes"</c-></a> };

<c- b>interface</c-> <c- b>mixin</c-> <a href="#readablestreamgenericreader"><code><c- g>ReadableStreamGenericReader</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#generic-reader-closed"><c- g>closed</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#generic-reader-cancel"><c- g>cancel</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-readablestreamgenericreader-cancel-reason-reason"><code><c- g>reason</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#readablestreamdefaultreader"><code><c- g>ReadableStreamDefaultReader</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#default-reader-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a href="#dom-readablestreamdefaultreader-readablestreamdefaultreader-stream-stream"><code><c- g>stream</c-></code></a>);

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-readablestreamdefaultreadresult"><c- n>ReadableStreamDefaultReadResult</c-></a>> <a class="idl-code" data-link-type="method" href="#default-reader-read"><c- g>read</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#default-reader-release-lock"><c- g>releaseLock</c-></a>();
};
<a data-link-type="idl-name" href="#readablestreamdefaultreader"><c- n>ReadableStreamDefaultReader</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#readablestreamgenericreader"><c- n>ReadableStreamGenericReader</c-></a>;

<c- b>dictionary</c-> <a href="#dictdef-readablestreamdefaultreadresult"><code><c- g>ReadableStreamDefaultReadResult</c-></code></a> {
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a data-type="any " href="#dom-readablestreamdefaultreadresult-value"><code><c- g>value</c-></code></a>;
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean " href="#dom-readablestreamdefaultreadresult-done"><code><c- g>done</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#readablestreambyobreader"><code><c- g>ReadableStreamBYOBReader</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#byob-reader-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a href="#dom-readablestreambyobreader-readablestreambyobreader-stream-stream"><code><c- g>stream</c-></code></a>);

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a data-link-type="idl-name" href="#dictdef-readablestreambyobreadresult"><c- n>ReadableStreamBYOBReadResult</c-></a>> <a class="idl-code" data-link-type="method" href="#byob-reader-read"><c- g>read</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView"><c- n>ArrayBufferView</c-></a> <a href="#dom-readablestreambyobreader-read-view-view"><code><c- g>view</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#byob-reader-release-lock"><c- g>releaseLock</c-></a>();
};
<a data-link-type="idl-name" href="#readablestreambyobreader"><c- n>ReadableStreamBYOBReader</c-></a> <c- b>includes</c-> <a data-link-type="idl-name" href="#readablestreamgenericreader"><c- n>ReadableStreamGenericReader</c-></a>;

<c- b>dictionary</c-> <a href="#dictdef-readablestreambyobreadresult"><code><c- g>ReadableStreamBYOBReadResult</c-></code></a> {
 <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView"><c- n>ArrayBufferView</c-></a> <a data-type="ArrayBufferView " href="#dom-readablestreambyobreadresult-value"><code><c- g>value</c-></code></a>;
 <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a data-type="boolean " href="#dom-readablestreambyobreadresult-done"><code><c- g>done</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#readablestreamdefaultcontroller"><code><c- g>ReadableStreamDefaultController</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#rs-default-controller-desired-size"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-close"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-enqueue"><c- g>enqueue</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-readablestreamdefaultcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-readablestreamdefaultcontroller-error-e-e"><code><c- g>e</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#readablebytestreamcontroller"><code><c- g>ReadableByteStreamController</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestreambyobrequest"><c- n>ReadableStreamBYOBRequest</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStreamBYOBRequest?" href="#rbs-controller-byob-request"><c- g>byobRequest</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#rbs-controller-desired-size"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-close"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-enqueue"><c- g>enqueue</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView"><c- n>ArrayBufferView</c-></a> <a href="#dom-readablebytestreamcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rbs-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-readablebytestreamcontroller-error-e-e"><code><c- g>e</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#readablestreambyobrequest"><code><c- g>ReadableStreamBYOBRequest</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView"><c- n>ArrayBufferView</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="ArrayBufferView?" href="#rs-byob-request-view"><c- g>view</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-byob-request-respond"><c- g>respond</c-></a>([<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#EnforceRange"><c- g>EnforceRange</c-></a>] <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unsigned-long-long"><c- b>unsigned</c-> <c- b>long</c-> <c- b>long</c-></a> <a href="#dom-readablestreambyobrequest-respond-byteswritten-byteswritten"><code><c- g>bytesWritten</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#rs-byob-request-respond-with-new-view"><c- g>respondWithNewView</c-></a>(<a data-link-type="idl-name" href="https://heycam.github.io/webidl/#ArrayBufferView"><c- n>ArrayBufferView</c-></a> <a href="#dom-readablestreambyobrequest-respondwithnewview-view-view"><code><c- g>view</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <a href="#writablestream"><code><c- g>WritableStream</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#ws-constructor"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object"><c- b>object</c-></a> <a href="#dom-writablestream-writablestream-underlyingsink-strategy-underlyingsink"><code><c- g>underlyingSink</c-></code></a>, <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy"><c- n>QueuingStrategy</c-></a> <a href="#dom-writablestream-writablestream-underlyingsink-strategy-strategy"><code><c- g>strategy</c-></code></a> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><c- b>boolean</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="boolean" href="#ws-locked"><c- g>locked</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#ws-abort"><c- g>abort</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-writablestream-abort-reason-reason"><code><c- g>reason</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#ws-close"><c- g>close</c-></a>();
  <a data-link-type="idl-name" href="#writablestreamdefaultwriter"><c- n>WritableStreamDefaultWriter</c-></a> <a class="idl-code" data-link-type="method" href="#ws-get-writer"><c- g>getWriter</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-underlyingsink"><code><c- g>UnderlyingSink</c-></code></a> {
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkstartcallback"><c- n>UnderlyingSinkStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkStartCallback " href="#dom-underlyingsink-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkwritecallback"><c- n>UnderlyingSinkWriteCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkWriteCallback " href="#dom-underlyingsink-write"><c- g>write</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkclosecallback"><c- n>UnderlyingSinkCloseCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkCloseCallback " href="#dom-underlyingsink-close"><c- g>close</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-underlyingsinkabortcallback"><c- n>UnderlyingSinkAbortCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="UnderlyingSinkAbortCallback " href="#dom-underlyingsink-abort"><c- g>abort</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-underlyingsink-type"><c- g>type</c-></a>;
};

<c- b>callback</c-> <a href="#callbackdef-underlyingsinkstartcallback"><code><c- g>UnderlyingSinkStartCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#writablestreamdefaultcontroller"><c- n>WritableStreamDefaultController</c-></a> <a href="#dom-underlyingsinkstartcallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-underlyingsinkwritecallback"><code><c- g>UnderlyingSinkWriteCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-underlyingsinkwritecallback-chunk"><code><c- g>chunk</c-></code></a>, <a data-link-type="idl-name" href="#writablestreamdefaultcontroller"><c- n>WritableStreamDefaultController</c-></a> <a href="#dom-underlyingsinkwritecallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-underlyingsinkclosecallback"><code><c- g>UnderlyingSinkCloseCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> ();
<c- b>callback</c-> <a href="#callbackdef-underlyingsinkabortcallback"><code><c- g>UnderlyingSinkAbortCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-underlyingsinkabortcallback-reason"><code><c- g>reason</c-></code></a>);

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#writablestreamdefaultwriter"><code><c- g>WritableStreamDefaultWriter</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#default-writer-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#writablestream"><c- n>WritableStream</c-></a> <a href="#dom-writablestreamdefaultwriter-writablestreamdefaultwriter-stream-stream"><code><c- g>stream</c-></code></a>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#default-writer-closed"><c- g>closed</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#default-writer-desired-size"><c- g>desiredSize</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Promise<undefined>" href="#default-writer-ready"><c- g>ready</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-abort"><c- g>abort</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-writablestreamdefaultwriter-abort-reason-reason"><code><c- g>reason</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-close"><c- g>close</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#default-writer-release-lock"><c- g>releaseLock</c-></a>();
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> <a class="idl-code" data-link-type="method" href="#default-writer-write"><c- g>write</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-writablestreamdefaultwriter-write-chunk-chunk"><code><c- g>chunk</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#writablestreamdefaultcontroller"><code><c- g>WritableStreamDefaultController</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ws-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-writablestreamdefaultcontroller-error-e-e"><code><c- g>e</c-></code></a>);
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->), <a class="idl-code" data-link-type="extended-attribute" href="https://html.spec.whatwg.org/multipage/structured-data.html#transferable"><c- g>Transferable</c-></a>]
<c- b>interface</c-> <a href="#transformstream"><code><c- g>TransformStream</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#ts-constructor"><c- g>constructor</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-object"><c- b>object</c-></a> <a href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-transformer"><code><c- g>transformer</c-></code></a>,
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy"><c- n>QueuingStrategy</c-></a> <a href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-writablestrategy"><code><c- g>writableStrategy</c-></code></a> = {},
              <c- b>optional</c-> <a data-link-type="idl-name" href="#dictdef-queuingstrategy"><c- n>QueuingStrategy</c-></a> <a href="#dom-transformstream-transformstream-transformer-writablestrategy-readablestrategy-readablestrategy"><code><c- g>readableStrategy</c-></code></a> = {});

  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#ts-readable"><c- g>readable</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#writablestream"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#ts-writable"><c- g>writable</c-></a>;
};

<c- b>dictionary</c-> <a href="#dictdef-transformer"><code><c- g>Transformer</c-></code></a> {
  <a data-link-type="idl-name" href="#callbackdef-transformerstartcallback"><c- n>TransformerStartCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerStartCallback " href="#dom-transformer-start"><c- g>start</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-transformertransformcallback"><c- n>TransformerTransformCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerTransformCallback " href="#dom-transformer-transform"><c- g>transform</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-transformerflushcallback"><c- n>TransformerFlushCallback</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="TransformerFlushCallback " href="#dom-transformer-flush"><c- g>flush</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-transformer-readabletype"><c- g>readableType</c-></a>;
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="any " href="#dom-transformer-writabletype"><c- g>writableType</c-></a>;
};

<c- b>callback</c-> <a href="#callbackdef-transformerstartcallback"><code><c- g>TransformerStartCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> (<a data-link-type="idl-name" href="#transformstreamdefaultcontroller"><c- n>TransformStreamDefaultController</c-></a> <a href="#dom-transformerstartcallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-transformerflushcallback"><code><c- g>TransformerFlushCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<a data-link-type="idl-name" href="#transformstreamdefaultcontroller"><c- n>TransformStreamDefaultController</c-></a> <a href="#dom-transformerflushcallback-controller"><code><c- g>controller</c-></code></a>);
<c- b>callback</c-> <a href="#callbackdef-transformertransformcallback"><code><c- g>TransformerTransformCallback</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-promise"><c- b>Promise</c-></a>&lt;<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a>> (<a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-transformertransformcallback-chunk"><code><c- g>chunk</c-></code></a>, <a data-link-type="idl-name" href="#transformstreamdefaultcontroller"><c- n>TransformStreamDefaultController</c-></a> <a href="#dom-transformertransformcallback-controller"><code><c- g>controller</c-></code></a>);

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#transformstreamdefaultcontroller"><code><c- g>TransformStreamDefaultController</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a>? <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double?" href="#ts-default-controller-desired-size"><c- g>desiredSize</c-></a>;

  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-enqueue"><c- g>enqueue</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-transformstreamdefaultcontroller-enqueue-chunk-chunk"><code><c- g>chunk</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-error"><c- g>error</c-></a>(<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-transformstreamdefaultcontroller-error-reason-reason"><code><c- g>reason</c-></code></a>);
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-undefined"><c- b>undefined</c-></a> <a class="idl-code" data-link-type="method" href="#ts-default-controller-terminate"><c- g>terminate</c-></a>();
};

<c- b>dictionary</c-> <a href="#dictdef-queuingstrategy"><code><c- g>QueuingStrategy</c-></code></a> {
  <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="unrestricted double " href="#dom-queuingstrategy-highwatermark"><c- g>highWaterMark</c-></a>;
  <a data-link-type="idl-name" href="#callbackdef-queuingstrategysize"><c- n>QueuingStrategySize</c-></a> <a class="idl-code" data-link-type="dict-member" data-type="QueuingStrategySize " href="#dom-queuingstrategy-size"><c- g>size</c-></a>;
};

<c- b>callback</c-> <a href="#callbackdef-queuingstrategysize"><code><c- g>QueuingStrategySize</c-></code></a> = <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a> (<c- b>optional</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-any"><c- b>any</c-></a> <a href="#dom-queuingstrategysize-chunk"><code><c- g>chunk</c-></code></a>);

<c- b>dictionary</c-> <a href="#dictdef-queuingstrategyinit"><code><c- g>QueuingStrategyInit</c-></code></a> {
  <c- b>required</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a> <a data-type="unrestricted double " href="#dom-queuingstrategyinit-highwatermark"><code><c- g>highWaterMark</c-></code></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#bytelengthqueuingstrategy"><code><c- g>ByteLengthQueuingStrategy</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#blqs-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-queuingstrategyinit"><c- n>QueuingStrategyInit</c-></a> <a href="#dom-bytelengthqueuingstrategy-bytelengthqueuingstrategy-init-init"><code><c- g>init</c-></code></a>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double" href="#blqs-high-water-mark"><c- g>highWaterMark</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#Function"><c- n>Function</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Function" href="#blqs-size"><c- g>size</c-></a>;
};

[<a class="idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed"><c- g>Exposed</c-></a>=(<c- n>Window</c->,<c- n>Worker</c->,<c- n>Worklet</c->)]
<c- b>interface</c-> <a href="#countqueuingstrategy"><code><c- g>CountQueuingStrategy</c-></code></a> {
  <a class="idl-code" data-link-type="constructor" href="#cqs-constructor"><c- g>constructor</c-></a>(<a data-link-type="idl-name" href="#dictdef-queuingstrategyinit"><c- n>QueuingStrategyInit</c-></a> <a href="#dom-countqueuingstrategy-countqueuingstrategy-init-init"><code><c- g>init</c-></code></a>);

  <c- b>readonly</c-> <c- b>attribute</c-> <a class="idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-unrestricted-double"><c- b>unrestricted</c-> <c- b>double</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="unrestricted double" href="#cqs-high-water-mark"><c- g>highWaterMark</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="https://heycam.github.io/webidl/#Function"><c- n>Function</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="Function" href="#cqs-size"><c- g>size</c-></a>;
};

<c- b>interface</c-> <c- b>mixin</c-> <a href="#generictransformstream"><code><c- g>GenericTransformStream</c-></code></a> {
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#readablestream"><c- n>ReadableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="ReadableStream" href="#dom-generictransformstream-readable"><c- g>readable</c-></a>;
  <c- b>readonly</c-> <c- b>attribute</c-> <a data-link-type="idl-name" href="#writablestream"><c- n>WritableStream</c-></a> <a class="idl-code" data-link-type="attribute" data-readonly data-type="WritableStream" href="#dom-generictransformstream-writable"><c- g>writable</c-></a>;
};

</pre>
  <aside class="dfn-panel" data-for="chunk">
   <b><a href="#chunk">#chunk</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-chunk">2.1. Readable streams</a> <a href="#ref-for-chunk①">(2)</a>
    <li><a href="#ref-for-chunk②">2.2. Writable streams</a>
    <li><a href="#ref-for-chunk③">2.3. Transform streams</a>
    <li><a href="#ref-for-chunk④">2.4. Pipe chains and backpressure</a> <a href="#ref-for-chunk⑤">(2)</a>
    <li><a href="#ref-for-chunk⑥">2.5. Internal queues and queuing strategies</a> <a href="#ref-for-chunk⑦">(2)</a> <a href="#ref-for-chunk⑧">(3)</a> <a href="#ref-for-chunk⑨">(4)</a>
    <li><a href="#ref-for-chunk①⓪">2.6. Locking</a> <a href="#ref-for-chunk①①">(2)</a>
    <li><a href="#ref-for-chunk①②">4.1. Using readable streams</a>
    <li><a href="#ref-for-chunk①③">4.2. The ReadableStream class</a>
    <li><a href="#ref-for-chunk①④">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-chunk①⑤">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-chunk①⑥">(2)</a> <a href="#ref-for-chunk①⑦">(3)</a>
    <li><a href="#ref-for-chunk①⑧">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-chunk①⑨">4.4.2. Internal slots</a> <a href="#ref-for-chunk②⓪">(2)</a> <a href="#ref-for-chunk②①">(3)</a> <a href="#ref-for-chunk②②">(4)</a>
    <li><a href="#ref-for-chunk②③">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-chunk②④">4.5.2. Internal slots</a> <a href="#ref-for-chunk②⑤">(2)</a> <a href="#ref-for-chunk②⑥">(3)</a> <a href="#ref-for-chunk②⑦">(4)</a> <a href="#ref-for-chunk②⑧">(5)</a>
    <li><a href="#ref-for-chunk②⑨">4.6.2. Internal slots</a> <a href="#ref-for-chunk③⓪">(2)</a> <a href="#ref-for-chunk③①">(3)</a>
    <li><a href="#ref-for-chunk③②">4.6.3. Methods and properties</a> <a href="#ref-for-chunk③③">(2)</a>
    <li><a href="#ref-for-chunk③④">4.7.2. Internal slots</a> <a href="#ref-for-chunk③⑤">(2)</a> <a href="#ref-for-chunk③⑥">(3)</a>
    <li><a href="#ref-for-chunk③⑦">4.7.3. Methods and properties</a> <a href="#ref-for-chunk③⑧">(2)</a>
    <li><a href="#ref-for-chunk③⑨">4.9.1. Working with readable streams</a> <a href="#ref-for-chunk④⓪">(2)</a> <a href="#ref-for-chunk④①">(3)</a> <a href="#ref-for-chunk④②">(4)</a> <a href="#ref-for-chunk④③">(5)</a> <a href="#ref-for-chunk④④">(6)</a> <a href="#ref-for-chunk④⑤">(7)</a> <a href="#ref-for-chunk④⑥">(8)</a> <a href="#ref-for-chunk④⑦">(9)</a> <a href="#ref-for-chunk④⑧">(10)</a>
    <li><a href="#ref-for-chunk④⑨">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-chunk⑤⓪">5.1. Using writable streams</a>
    <li><a href="#ref-for-chunk⑤①">5.2.3. The underlying sink API</a> <a href="#ref-for-chunk⑤②">(2)</a>
    <li><a href="#ref-for-chunk⑤③">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-chunk⑤④">(2)</a>
    <li><a href="#ref-for-chunk⑤⑤">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-chunk⑤⑥">(2)</a> <a href="#ref-for-chunk⑤⑦">(3)</a>
    <li><a href="#ref-for-chunk⑤⑧">5.4.2. Internal slots</a> <a href="#ref-for-chunk⑤⑨">(2)</a> <a href="#ref-for-chunk⑥⓪">(3)</a> <a href="#ref-for-chunk⑥①">(4)</a>
    <li><a href="#ref-for-chunk⑥②">6.1. Using transform streams</a>
    <li><a href="#ref-for-chunk⑥③">6.2.3. The transformer API</a> <a href="#ref-for-chunk⑥④">(2)</a> <a href="#ref-for-chunk⑥⑤">(3)</a> <a href="#ref-for-chunk⑥⑥">(4)</a>
    <li><a href="#ref-for-chunk⑥⑦">6.3.2. Internal slots</a>
    <li><a href="#ref-for-chunk⑥⑧">6.3.3. Methods and properties</a> <a href="#ref-for-chunk⑥⑨">(2)</a> <a href="#ref-for-chunk⑦⓪">(3)</a>
    <li><a href="#ref-for-chunk⑦①">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-chunk⑦②">7.2. The ByteLengthQueuingStrategy class</a> <a href="#ref-for-chunk⑦③">(2)</a> <a href="#ref-for-chunk⑦④">(3)</a>
    <li><a href="#ref-for-chunk⑦⑤">7.3. The CountQueuingStrategy class</a> <a href="#ref-for-chunk⑦⑥">(2)</a>
    <li><a href="#ref-for-chunk⑦⑦">8.1. Queue-with-sizes</a>
    <li><a href="#ref-for-chunk⑦⑧">9.1.1. Creation and manipulation</a>
    <li><a href="#ref-for-chunk⑦⑨">9.1.2. Reading</a>
    <li><a href="#ref-for-chunk⑧⓪">9.2.1. Creation</a> <a href="#ref-for-chunk⑧①">(2)</a>
    <li><a href="#ref-for-chunk⑧②">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-chunk⑧③">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a>
    <li><a href="#ref-for-chunk⑧④">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream">
   <b><a href="#readable-stream">#readable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream">1. Introduction</a>
    <li><a href="#ref-for-readable-stream①">2.1. Readable streams</a>
    <li><a href="#ref-for-readable-stream②">2.3. Transform streams</a>
    <li><a href="#ref-for-readable-stream③">2.6. Locking</a>
    <li><a href="#ref-for-readable-stream④">4.2. The ReadableStream class</a>
    <li><a href="#ref-for-readable-stream⑤">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-readable-stream⑥">(2)</a> <a href="#ref-for-readable-stream⑦">(3)</a> <a href="#ref-for-readable-stream⑧">(4)</a> <a href="#ref-for-readable-stream⑨">(5)</a> <a href="#ref-for-readable-stream①⓪">(6)</a> <a href="#ref-for-readable-stream①①">(7)</a>
    <li><a href="#ref-for-readable-stream①②">4.4.2. Internal slots</a>
    <li><a href="#ref-for-readable-stream①③">5.1. Using writable streams</a>
    <li><a href="#ref-for-readable-stream①④">6.1. Using transform streams</a> <a href="#ref-for-readable-stream①⑤">(2)</a> <a href="#ref-for-readable-stream①⑥">(3)</a>
    <li><a href="#ref-for-readable-stream①⑦">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-readable-stream①⑧">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-readable-stream①⑨">9.4. Other stream pairs</a>
    <li><a href="#ref-for-readable-stream②⓪">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-readable-stream②①">10.2. A readable stream with an underlying push source and
backpressure support</a>
    <li><a href="#ref-for-readable-stream②②">10.4. A readable stream with an underlying pull source</a>
    <li><a href="#ref-for-readable-stream②③">10.11. Using an identity transform stream as a primitive to
create new readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="underlying-source">
   <b><a href="#underlying-source">#underlying-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-underlying-source">2.1. Readable streams</a> <a href="#ref-for-underlying-source①">(2)</a> <a href="#ref-for-underlying-source②">(3)</a>
    <li><a href="#ref-for-underlying-source③">2.4. Pipe chains and backpressure</a> <a href="#ref-for-underlying-source④">(2)</a>
    <li><a href="#ref-for-underlying-source⑤">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-underlying-source⑥">4.2. The ReadableStream class</a>
    <li><a href="#ref-for-underlying-source⑦">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-underlying-source⑧">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-underlying-source⑨">(2)</a>
    <li><a href="#ref-for-underlying-source①⓪">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-underlying-source①①">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-underlying-source①②">4.6. The ReadableStreamDefaultController class</a>
    <li><a href="#ref-for-underlying-source①③">4.6.2. Internal slots</a> <a href="#ref-for-underlying-source①④">(2)</a> <a href="#ref-for-underlying-source①⑤">(3)</a> <a href="#ref-for-underlying-source①⑥">(4)</a> <a href="#ref-for-underlying-source①⑦">(5)</a> <a href="#ref-for-underlying-source①⑧">(6)</a> <a href="#ref-for-underlying-source①⑨">(7)</a>
    <li><a href="#ref-for-underlying-source②⓪">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-underlying-source②①">4.7. The ReadableByteStreamController class</a>
    <li><a href="#ref-for-underlying-source②②">4.9.2. Interfacing with controllers</a> <a href="#ref-for-underlying-source②③">(2)</a> <a href="#ref-for-underlying-source②④">(3)</a>
    <li><a href="#ref-for-underlying-source②⑤">4.9.4. Default controllers</a>
    <li><a href="#ref-for-underlying-source②⑥">6.4.4. Default sources</a>
    <li><a href="#ref-for-underlying-source②⑦">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-underlying-source②⑧">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-underlying-source②⑨">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-underlying-source③⓪">10.2. A readable stream with an underlying push source and
backpressure support</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="push-source">
   <b><a href="#push-source">#push-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-push-source">4.2.3. The underlying source API</a> <a href="#ref-for-push-source①">(2)</a>
    <li><a href="#ref-for-push-source②">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-source">
   <b><a href="#pull-source">#pull-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-source">4.2.3. The underlying source API</a> <a href="#ref-for-pull-source①">(2)</a>
    <li><a href="#ref-for-pull-source②">10.4. A readable stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="consumer">
   <b><a href="#consumer">#consumer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-consumer">2.6. Locking</a>
    <li><a href="#ref-for-consumer①">4.2.3. The underlying source API</a> <a href="#ref-for-consumer②">(2)</a>
    <li><a href="#ref-for-consumer③">4.4.2. Internal slots</a>
    <li><a href="#ref-for-consumer④">4.5.2. Internal slots</a>
    <li><a href="#ref-for-consumer⑤">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-consumer⑥">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-consumer⑦">4.8.3. Methods and properties</a> <a href="#ref-for-consumer⑧">(2)</a>
    <li><a href="#ref-for-consumer⑨">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cancel-a-readable-stream">
   <b><a href="#cancel-a-readable-stream">#cancel-a-readable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cancel-a-readable-stream">2.6. Locking</a>
    <li><a href="#ref-for-cancel-a-readable-stream①">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-cancel-a-readable-stream②">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-cancel-a-readable-stream③">(2)</a> <a href="#ref-for-cancel-a-readable-stream④">(3)</a> <a href="#ref-for-cancel-a-readable-stream⑤">(4)</a> <a href="#ref-for-cancel-a-readable-stream⑥">(5)</a> <a href="#ref-for-cancel-a-readable-stream⑦">(6)</a>
    <li><a href="#ref-for-cancel-a-readable-stream⑧">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-cancel-a-readable-stream⑨">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-cancel-a-readable-stream①⓪">9.4.1. Duplex streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="tee-a-readable-stream">
   <b><a href="#tee-a-readable-stream">#tee-a-readable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-tee-a-readable-stream">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-tee-a-readable-stream①">4.1. Using readable streams</a>
    <li><a href="#ref-for-tee-a-readable-stream②">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-tee-a-readable-stream③">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="branches-of-a-readable-stream-tee">
   <b><a href="#branches-of-a-readable-stream-tee">#branches-of-a-readable-stream-tee</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-branches-of-a-readable-stream-tee">2.4. Pipe chains and backpressure</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="underlying-byte-source">
   <b><a href="#underlying-byte-source">#underlying-byte-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-underlying-byte-source">4.7.2. Internal slots</a> <a href="#ref-for-underlying-byte-source①">(2)</a> <a href="#ref-for-underlying-byte-source②">(3)</a> <a href="#ref-for-underlying-byte-source③">(4)</a> <a href="#ref-for-underlying-byte-source④">(5)</a> <a href="#ref-for-underlying-byte-source⑤">(6)</a> <a href="#ref-for-underlying-byte-source⑥">(7)</a> <a href="#ref-for-underlying-byte-source⑦">(8)</a> <a href="#ref-for-underlying-byte-source⑧">(9)</a> <a href="#ref-for-underlying-byte-source⑨">(10)</a> <a href="#ref-for-underlying-byte-source①⓪">(11)</a>
    <li><a href="#ref-for-underlying-byte-source①①">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-underlying-byte-source①②">4.8.3. Methods and properties</a>
    <li><a href="#ref-for-underlying-byte-source①③">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-underlying-byte-source①④">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-underlying-byte-source①⑤">10.5. A readable byte stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream">
   <b><a href="#readable-byte-stream">#readable-byte-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream">2.6. Locking</a>
    <li><a href="#ref-for-readable-byte-stream①">4.1. Using readable streams</a>
    <li><a href="#ref-for-readable-byte-stream②">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-readable-byte-stream③">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-byte-stream④">4.5.2. Internal slots</a>
    <li><a href="#ref-for-readable-byte-stream⑤">4.6. The ReadableStreamDefaultController class</a>
    <li><a href="#ref-for-readable-byte-stream⑥">4.7. The ReadableByteStreamController class</a>
    <li><a href="#ref-for-readable-byte-stream⑦">4.7.2. Internal slots</a>
    <li><a href="#ref-for-readable-byte-stream⑧">4.8.3. Methods and properties</a> <a href="#ref-for-readable-byte-stream⑨">(2)</a> <a href="#ref-for-readable-byte-stream①⓪">(3)</a>
    <li><a href="#ref-for-readable-byte-stream①①">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readable-byte-stream①②">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readable-byte-stream①③">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-readable-byte-stream①④">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-readable-byte-stream①⑤">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a>
    <li><a href="#ref-for-readable-byte-stream①⑥">10.5. A readable byte stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream">
   <b><a href="#writable-stream">#writable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream">1. Introduction</a>
    <li><a href="#ref-for-writable-stream①">2.3. Transform streams</a>
    <li><a href="#ref-for-writable-stream②">2.6. Locking</a>
    <li><a href="#ref-for-writable-stream③">4.1. Using readable streams</a> <a href="#ref-for-writable-stream④">(2)</a>
    <li><a href="#ref-for-writable-stream⑤">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream⑥">5.2. The WritableStream class</a>
    <li><a href="#ref-for-writable-stream⑦">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writable-stream⑧">6.1. Using transform streams</a> <a href="#ref-for-writable-stream⑨">(2)</a> <a href="#ref-for-writable-stream①⓪">(3)</a>
    <li><a href="#ref-for-writable-stream①①">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-writable-stream①②">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-writable-stream①③">9.4. Other stream pairs</a>
    <li><a href="#ref-for-writable-stream①④">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-writable-stream①⑤">10.6. A writable stream with no backpressure or success signals</a>
    <li><a href="#ref-for-writable-stream①⑥">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="underlying-sink">
   <b><a href="#underlying-sink">#underlying-sink</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-underlying-sink">2.2. Writable streams</a> <a href="#ref-for-underlying-sink①">(2)</a>
    <li><a href="#ref-for-underlying-sink②">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-underlying-sink③">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-underlying-sink④">5.1. Using writable streams</a> <a href="#ref-for-underlying-sink⑤">(2)</a> <a href="#ref-for-underlying-sink⑥">(3)</a>
    <li><a href="#ref-for-underlying-sink⑦">5.2.2. Internal slots</a> <a href="#ref-for-underlying-sink⑧">(2)</a> <a href="#ref-for-underlying-sink⑨">(3)</a>
    <li><a href="#ref-for-underlying-sink①⓪">5.2.3. The underlying sink API</a> <a href="#ref-for-underlying-sink①①">(2)</a> <a href="#ref-for-underlying-sink①②">(3)</a> <a href="#ref-for-underlying-sink①③">(4)</a> <a href="#ref-for-underlying-sink①④">(5)</a>
    <li><a href="#ref-for-underlying-sink①⑤">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-underlying-sink①⑥">(2)</a> <a href="#ref-for-underlying-sink①⑦">(3)</a>
    <li><a href="#ref-for-underlying-sink①⑧">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-underlying-sink①⑨">(2)</a>
    <li><a href="#ref-for-underlying-sink②⓪">5.4. The WritableStreamDefaultController class</a>
    <li><a href="#ref-for-underlying-sink②①">5.4.2. Internal slots</a> <a href="#ref-for-underlying-sink②②">(2)</a> <a href="#ref-for-underlying-sink②③">(3)</a> <a href="#ref-for-underlying-sink②④">(4)</a> <a href="#ref-for-underlying-sink②⑤">(5)</a>
    <li><a href="#ref-for-underlying-sink②⑥">5.4.3. Methods</a> <a href="#ref-for-underlying-sink②⑦">(2)</a>
    <li><a href="#ref-for-underlying-sink②⑧">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-underlying-sink②⑨">5.5.4. Default controllers</a>
    <li><a href="#ref-for-underlying-sink③⓪">6.4.3. Default sinks</a>
    <li><a href="#ref-for-underlying-sink③①">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-underlying-sink③②">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-underlying-sink③③">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="producer">
   <b><a href="#producer">#producer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-producer">2.6. Locking</a>
    <li><a href="#ref-for-producer①">5.1. Using writable streams</a>
    <li><a href="#ref-for-producer②">5.2.3. The underlying sink API</a> <a href="#ref-for-producer③">(2)</a>
    <li><a href="#ref-for-producer④">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-producer⑤">(2)</a>
    <li><a href="#ref-for-producer⑥">7.2. The ByteLengthQueuingStrategy class</a>
    <li><a href="#ref-for-producer⑦">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-producer⑧">10.6. A writable stream with no backpressure or success signals</a>
    <li><a href="#ref-for-producer⑨">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abort-a-writable-stream">
   <b><a href="#abort-a-writable-stream">#abort-a-writable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abort-a-writable-stream">2.6. Locking</a>
    <li><a href="#ref-for-abort-a-writable-stream①">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-abort-a-writable-stream②">(2)</a>
    <li><a href="#ref-for-abort-a-writable-stream③">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-abort-a-writable-stream④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-abort-a-writable-stream⑤">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-abort-a-writable-stream⑥">9.4.1. Duplex streams</a>
    <li><a href="#ref-for-abort-a-writable-stream⑦">10.11. Using an identity transform stream as a primitive to
create new readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream">
   <b><a href="#transform-stream">#transform-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream">1. Introduction</a>
    <li><a href="#ref-for-transform-stream①">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-transform-stream②">6.2. The TransformStream class</a>
    <li><a href="#ref-for-transform-stream③">6.4.3. Default sinks</a>
    <li><a href="#ref-for-transform-stream④">6.4.4. Default sources</a>
    <li><a href="#ref-for-transform-stream⑤">9.3.2. Wrapping into a custom class</a>
    <li><a href="#ref-for-transform-stream⑥">9.4. Other stream pairs</a>
    <li><a href="#ref-for-transform-stream⑦">9.4.2. Endpoint pairs</a>
    <li><a href="#ref-for-transform-stream⑧">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-side">
   <b><a href="#writable-side">#writable-side</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-side">2.3. Transform streams</a>
    <li><a href="#ref-for-writable-side①">6.1. Using transform streams</a>
    <li><a href="#ref-for-writable-side②">6.2.3. The transformer API</a> <a href="#ref-for-writable-side③">(2)</a> <a href="#ref-for-writable-side④">(3)</a>
    <li><a href="#ref-for-writable-side⑤">6.2.4. Constructor and properties</a> <a href="#ref-for-writable-side⑥">(2)</a>
    <li><a href="#ref-for-writable-side⑦">6.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-writable-side⑧">6.3.3. Methods and properties</a> <a href="#ref-for-writable-side⑨">(2)</a> <a href="#ref-for-writable-side①⓪">(3)</a>
    <li><a href="#ref-for-writable-side①①">6.4.3. Default sinks</a>
    <li><a href="#ref-for-writable-side①②">8.2. Transferable streams</a>
    <li><a href="#ref-for-writable-side①③">10.11. Using an identity transform stream as a primitive to
create new readable streams</a> <a href="#ref-for-writable-side①④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-side">
   <b><a href="#readable-side">#readable-side</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-side">2.3. Transform streams</a>
    <li><a href="#ref-for-readable-side①">6.1. Using transform streams</a>
    <li><a href="#ref-for-readable-side②">6.2.3. The transformer API</a> <a href="#ref-for-readable-side③">(2)</a> <a href="#ref-for-readable-side④">(3)</a> <a href="#ref-for-readable-side⑤">(4)</a>
    <li><a href="#ref-for-readable-side⑥">6.2.4. Constructor and properties</a> <a href="#ref-for-readable-side⑦">(2)</a>
    <li><a href="#ref-for-readable-side⑧">6.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-readable-side⑨">6.3.3. Methods and properties</a> <a href="#ref-for-readable-side①⓪">(2)</a> <a href="#ref-for-readable-side①①">(3)</a>
    <li><a href="#ref-for-readable-side①②">6.4.4. Default sources</a>
    <li><a href="#ref-for-readable-side①③">8.2. Transferable streams</a>
    <li><a href="#ref-for-readable-side①④">9.5. Piping</a>
    <li><a href="#ref-for-readable-side①⑤">10.11. Using an identity transform stream as a primitive to
create new readable streams</a> <a href="#ref-for-readable-side①⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformer">
   <b><a href="#transformer">#transformer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformer">2.3. Transform streams</a>
    <li><a href="#ref-for-transformer①">6.2.3. The transformer API</a>
    <li><a href="#ref-for-transformer②">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-transformer③">6.3. The TransformStreamDefaultController class</a>
    <li><a href="#ref-for-transformer④">6.3.2. Internal slots</a> <a href="#ref-for-transformer⑤">(2)</a>
    <li><a href="#ref-for-transformer⑥">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transformer⑦">6.4.2. Default controllers</a>
    <li><a href="#ref-for-transformer⑧">10.9. A transform stream that replaces template tags</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="identity-transform-stream">
   <b><a href="#identity-transform-stream">#identity-transform-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-identity-transform-stream">6.1. Using transform streams</a>
    <li><a href="#ref-for-identity-transform-stream①">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-identity-transform-stream②">10.11. Using an identity transform stream as a primitive to
create new readable streams</a> <a href="#ref-for-identity-transform-stream③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="piping">
   <b><a href="#piping">#piping</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-piping">2.6. Locking</a> <a href="#ref-for-piping①">(2)</a>
    <li><a href="#ref-for-piping②">4.1. Using readable streams</a> <a href="#ref-for-piping③">(2)</a> <a href="#ref-for-piping④">(3)</a>
    <li><a href="#ref-for-piping⑤">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-piping⑥">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-piping⑦">(2)</a>
    <li><a href="#ref-for-piping⑧">5.1. Using writable streams</a>
    <li><a href="#ref-for-piping⑨">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-piping①⓪">6.1. Using transform streams</a>
    <li><a href="#ref-for-piping①①">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pipe-chain">
   <b><a href="#pipe-chain">#pipe-chain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pipe-chain">1. Introduction</a>
    <li><a href="#ref-for-pipe-chain①">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-pipe-chain②">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="original-source">
   <b><a href="#original-source">#original-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-original-source">2.4. Pipe chains and backpressure</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ultimate-sink">
   <b><a href="#ultimate-sink">#ultimate-sink</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ultimate-sink">2.4. Pipe chains and backpressure</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="backpressure">
   <b><a href="#backpressure">#backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-backpressure">1. Introduction</a>
    <li><a href="#ref-for-backpressure①">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-backpressure②">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-backpressure③">4.1. Using readable streams</a> <a href="#ref-for-backpressure④">(2)</a>
    <li><a href="#ref-for-backpressure⑤">4.6.2. Internal slots</a>
    <li><a href="#ref-for-backpressure⑥">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-backpressure⑦">4.7.2. Internal slots</a>
    <li><a href="#ref-for-backpressure⑧">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-backpressure⑨">5.1. Using writable streams</a> <a href="#ref-for-backpressure①⓪">(2)</a> <a href="#ref-for-backpressure①①">(3)</a>
    <li><a href="#ref-for-backpressure①②">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-backpressure①③">5.4.2. Internal slots</a>
    <li><a href="#ref-for-backpressure①④">6.1. Using transform streams</a>
    <li><a href="#ref-for-backpressure①⑤">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-backpressure①⑥">7.2. The ByteLengthQueuingStrategy class</a> <a href="#ref-for-backpressure①⑦">(2)</a>
    <li><a href="#ref-for-backpressure①⑧">7.3. The CountQueuingStrategy class</a> <a href="#ref-for-backpressure①⑨">(2)</a>
    <li><a href="#ref-for-backpressure②⓪">7.4. Abstract operations</a>
    <li><a href="#ref-for-backpressure②①">10.2. A readable stream with an underlying push source and
backpressure support</a>
    <li><a href="#ref-for-backpressure②②">10.6. A writable stream with no backpressure or success signals</a>
    <li><a href="#ref-for-backpressure②③">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="internal-queues">
   <b><a href="#internal-queues">#internal-queues</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-internal-queues">2.2. Writable streams</a>
    <li><a href="#ref-for-internal-queues①">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-internal-queues②">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-internal-queues③">4.4.2. Internal slots</a>
    <li><a href="#ref-for-internal-queues④">4.5.2. Internal slots</a>
    <li><a href="#ref-for-internal-queues⑤">4.6. The ReadableStreamDefaultController class</a>
    <li><a href="#ref-for-internal-queues⑥">4.7. The ReadableByteStreamController class</a>
    <li><a href="#ref-for-internal-queues⑦">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-internal-queues⑧">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-internal-queues⑨">5.1. Using writable streams</a>
    <li><a href="#ref-for-internal-queues①⓪">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a> <a href="#ref-for-internal-queues①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="queuing-strategy">
   <b><a href="#queuing-strategy">#queuing-strategy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-queuing-strategy">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-queuing-strategy①">4.6.2. Internal slots</a> <a href="#ref-for-queuing-strategy②">(2)</a>
    <li><a href="#ref-for-queuing-strategy③">4.7.2. Internal slots</a>
    <li><a href="#ref-for-queuing-strategy④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-queuing-strategy⑤">5.4.2. Internal slots</a> <a href="#ref-for-queuing-strategy⑥">(2)</a>
    <li><a href="#ref-for-queuing-strategy⑦">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-queuing-strategy⑧">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-queuing-strategy⑨">7.2. The ByteLengthQueuingStrategy class</a> <a href="#ref-for-queuing-strategy①⓪">(2)</a>
    <li><a href="#ref-for-queuing-strategy①①">7.3. The CountQueuingStrategy class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="high-water-mark">
   <b><a href="#high-water-mark">#high-water-mark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-high-water-mark">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-high-water-mark①">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-high-water-mark②">5.1. Using writable streams</a> <a href="#ref-for-high-water-mark③">(2)</a>
    <li><a href="#ref-for-high-water-mark④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-high-water-mark⑤">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-high-water-mark⑥">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-high-water-mark⑦">7.2.3. Constructor and properties</a> <a href="#ref-for-high-water-mark⑧">(2)</a>
    <li><a href="#ref-for-high-water-mark⑨">7.3.3. Constructor and properties</a> <a href="#ref-for-high-water-mark①⓪">(2)</a>
    <li><a href="#ref-for-high-water-mark①①">7.4. Abstract operations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="desired-size-to-fill-a-streams-internal-queue">
   <b><a href="#desired-size-to-fill-a-streams-internal-queue">#desired-size-to-fill-a-streams-internal-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue">4.2.3. The underlying source API</a> <a href="#ref-for-desired-size-to-fill-a-streams-internal-queue①">(2)</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue②">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue③">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue④">5.1. Using writable streams</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue⑤">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue⑥">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-desired-size-to-fill-a-streams-internal-queue⑦">(2)</a> <a href="#ref-for-desired-size-to-fill-a-streams-internal-queue⑧">(3)</a>
    <li><a href="#ref-for-desired-size-to-fill-a-streams-internal-queue⑨">6.3.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reader">
   <b><a href="#reader">#reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reader">1. Introduction</a>
    <li><a href="#ref-for-reader①">2.1. Readable streams</a>
    <li><a href="#ref-for-reader②">4.1. Using readable streams</a>
    <li><a href="#ref-for-reader③">4.7.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-readers">
   <b><a href="#default-readers">#default-readers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-readers">4.1. Using readable streams</a>
    <li><a href="#ref-for-default-readers①">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-default-readers②">4.4. The ReadableStreamDefaultReader class</a>
    <li><a href="#ref-for-default-readers③">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-default-readers④">10.5. A readable byte stream with an underlying pull source</a> <a href="#ref-for-default-readers⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="byob-readers">
   <b><a href="#byob-readers">#byob-readers</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byob-readers">2.1. Readable streams</a>
    <li><a href="#ref-for-byob-readers①">4.1. Using readable streams</a>
    <li><a href="#ref-for-byob-readers②">4.2.3. The underlying source API</a> <a href="#ref-for-byob-readers③">(2)</a>
    <li><a href="#ref-for-byob-readers④">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-byob-readers⑤">4.5. The ReadableStreamBYOBReader class</a>
    <li><a href="#ref-for-byob-readers⑥">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-byob-readers⑦">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a> <a href="#ref-for-byob-readers⑧">(2)</a> <a href="#ref-for-byob-readers⑨">(3)</a>
    <li><a href="#ref-for-byob-readers①⓪">10.5. A readable byte stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writer">
   <b><a href="#writer">#writer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writer">1. Introduction</a>
    <li><a href="#ref-for-writer①">5.1. Using writable streams</a> <a href="#ref-for-writer②">(2)</a>
    <li><a href="#ref-for-writer③">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writer④">5.3. The WritableStreamDefaultWriter class</a>
    <li><a href="#ref-for-writer⑤">6.1. Using transform streams</a>
    <li><a href="#ref-for-writer⑥">10.6. A writable stream with no backpressure or success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="lock">
   <b><a href="#lock">#lock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-lock">2.1. Readable streams</a>
    <li><a href="#ref-for-lock①">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-lock②">4.2.2. Internal slots</a>
    <li><a href="#ref-for-lock③">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-lock④">(2)</a> <a href="#ref-for-lock⑤">(3)</a> <a href="#ref-for-lock⑥">(4)</a> <a href="#ref-for-lock⑦">(5)</a> <a href="#ref-for-lock⑧">(6)</a> <a href="#ref-for-lock⑨">(7)</a>
    <li><a href="#ref-for-lock①⓪">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-lock①①">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-lock①②">5.2.2. Internal slots</a>
    <li><a href="#ref-for-lock①③">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-lock①④">(2)</a> <a href="#ref-for-lock①⑤">(3)</a> <a href="#ref-for-lock①⑥">(4)</a>
    <li><a href="#ref-for-lock①⑦">5.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="active">
   <b><a href="#active">#active</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-active">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-active①">(2)</a>
    <li><a href="#ref-for-active②">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-active③">(2)</a>
    <li><a href="#ref-for-active④">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-active⑤">(2)</a> <a href="#ref-for-active⑥">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="release-a-lock">
   <b><a href="#release-a-lock">#release-a-lock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-release-a-lock">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-release-a-lock①">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-release-a-lock②">(2)</a>
    <li><a href="#ref-for-release-a-lock③">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-release-a-lock④">(2)</a>
    <li><a href="#ref-for-release-a-lock⑤">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-release-a-lock⑥">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-release-a-lock⑦">(2)</a> <a href="#ref-for-release-a-lock⑧">(3)</a> <a href="#ref-for-release-a-lock⑨">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream">
   <b><a href="#readablestream">#readablestream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream">1. Introduction</a>
    <li><a href="#ref-for-readablestream①">2.1. Readable streams</a>
    <li><a href="#ref-for-readablestream②">4.2. The ReadableStream class</a> <a href="#ref-for-readablestream③">(2)</a>
    <li><a href="#ref-for-readablestream④">4.2.1. Interface definition</a> <a href="#ref-for-readablestream⑤">(2)</a> <a href="#ref-for-readablestream⑥">(3)</a> <a href="#ref-for-readablestream⑦">(4)</a>
    <li><a href="#ref-for-readablestream⑧">4.2.2. Internal slots</a>
    <li><a href="#ref-for-readablestream⑨">4.2.3. The underlying source API</a> <a href="#ref-for-readablestream①⓪">(2)</a> <a href="#ref-for-readablestream①①">(3)</a>
    <li><a href="#ref-for-readablestream①②">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-readablestream①③">(2)</a> <a href="#ref-for-readablestream①④">(3)</a>
    <li><a href="#ref-for-readablestream①⑤">4.2.5. Asynchronous iteration</a> <a href="#ref-for-readablestream①⑥">(2)</a> <a href="#ref-for-readablestream①⑦">(3)</a>
    <li><a href="#ref-for-readablestream①⑧">4.2.6. Transfer via postMessage()</a> <a href="#ref-for-readablestream①⑨">(2)</a>
    <li><a href="#ref-for-readablestream②⓪">4.3.2. Internal slots</a>
    <li><a href="#ref-for-readablestream②①">4.4. The ReadableStreamDefaultReader class</a>
    <li><a href="#ref-for-readablestream②②">4.4.1. Interface definition</a>
    <li><a href="#ref-for-readablestream②③">4.5. The ReadableStreamBYOBReader class</a>
    <li><a href="#ref-for-readablestream②④">4.5.1. Interface definition</a>
    <li><a href="#ref-for-readablestream②⑤">4.6. The ReadableStreamDefaultController class</a> <a href="#ref-for-readablestream②⑥">(2)</a>
    <li><a href="#ref-for-readablestream②⑦">4.6.2. Internal slots</a>
    <li><a href="#ref-for-readablestream②⑧">4.7. The ReadableByteStreamController class</a> <a href="#ref-for-readablestream②⑨">(2)</a>
    <li><a href="#ref-for-readablestream③⓪">4.7.2. Internal slots</a>
    <li><a href="#ref-for-readablestream③①">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream③②">(2)</a> <a href="#ref-for-readablestream③③">(3)</a> <a href="#ref-for-readablestream③④">(4)</a>
    <li><a href="#ref-for-readablestream③⑤">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestream③⑥">(2)</a> <a href="#ref-for-readablestream③⑦">(3)</a> <a href="#ref-for-readablestream③⑧">(4)</a> <a href="#ref-for-readablestream③⑨">(5)</a>
    <li><a href="#ref-for-readablestream④⓪">4.9.4. Default controllers</a>
    <li><a href="#ref-for-readablestream④①">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-readablestream④②">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-readablestream④③">5.5.3. Writers</a>
    <li><a href="#ref-for-readablestream④④">6.2.1. Interface definition</a>
    <li><a href="#ref-for-readablestream④⑤">6.2.2. Internal slots</a>
    <li><a href="#ref-for-readablestream④⑥">6.2.4. Constructor and properties</a> <a href="#ref-for-readablestream④⑦">(2)</a>
    <li><a href="#ref-for-readablestream④⑧">6.3. The TransformStreamDefaultController class</a>
    <li><a href="#ref-for-readablestream④⑨">9.1.1. Creation and manipulation</a> <a href="#ref-for-readablestream⑤⓪">(2)</a> <a href="#ref-for-readablestream⑤①">(3)</a> <a href="#ref-for-readablestream⑤②">(4)</a> <a href="#ref-for-readablestream⑤③">(5)</a> <a href="#ref-for-readablestream⑤④">(6)</a> <a href="#ref-for-readablestream⑤⑤">(7)</a> <a href="#ref-for-readablestream⑤⑥">(8)</a> <a href="#ref-for-readablestream⑤⑦">(9)</a>
    <li><a href="#ref-for-readablestream⑤⑧">9.1.2. Reading</a> <a href="#ref-for-readablestream⑤⑨">(2)</a> <a href="#ref-for-readablestream⑥⓪">(3)</a> <a href="#ref-for-readablestream⑥①">(4)</a> <a href="#ref-for-readablestream⑥②">(5)</a>
    <li><a href="#ref-for-readablestream⑥③">9.1.3. Introspection</a> <a href="#ref-for-readablestream⑥④">(2)</a> <a href="#ref-for-readablestream⑥⑤">(3)</a> <a href="#ref-for-readablestream⑥⑥">(4)</a> <a href="#ref-for-readablestream⑥⑦">(5)</a> <a href="#ref-for-readablestream⑥⑧">(6)</a>
    <li><a href="#ref-for-readablestream⑥⑨">9.3.2. Wrapping into a custom class</a>
    <li><a href="#ref-for-readablestream⑦⓪">9.5. Piping</a> <a href="#ref-for-readablestream⑦①">(2)</a> <a href="#ref-for-readablestream⑦②">(3)</a> <a href="#ref-for-readablestream⑦③">(4)</a>
    <li><a href="#ref-for-readablestream⑦④">10. Examples of creating streams</a>
    <li><a href="#ref-for-readablestream⑦⑤">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-readablestream⑦⑥">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a>
    <li><a href="#ref-for-readablestream⑦⑦">10.5. A readable byte stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-readablestreamreader">
   <b><a href="#typedefdef-readablestreamreader">#typedefdef-readablestreamreader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-readablestreamreader">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-readablestreamreadermode">
   <b><a href="#enumdef-readablestreamreadermode">#enumdef-readablestreamreadermode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-readablestreamreadermode">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamreadermode-byob">
   <b><a href="#dom-readablestreamreadermode-byob">#dom-readablestreamreadermode-byob</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamreadermode-byob">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreamreadermode-byob①">(2)</a>
    <li><a href="#ref-for-dom-readablestreamreadermode-byob②">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-readablestreamgetreaderoptions">
   <b><a href="#dictdef-readablestreamgetreaderoptions">#dictdef-readablestreamgetreaderoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-readablestreamgetreaderoptions">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamgetreaderoptions-mode">
   <b><a href="#dom-readablestreamgetreaderoptions-mode">#dom-readablestreamgetreaderoptions-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamgetreaderoptions-mode">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreamgetreaderoptions-mode①">(2)</a> <a href="#ref-for-dom-readablestreamgetreaderoptions-mode②">(3)</a>
    <li><a href="#ref-for-dom-readablestreamgetreaderoptions-mode③">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-readablestreamiteratoroptions">
   <b><a href="#dictdef-readablestreamiteratoroptions">#dictdef-readablestreamiteratoroptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-readablestreamiteratoroptions">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamiteratoroptions-preventcancel">
   <b><a href="#dom-readablestreamiteratoroptions-preventcancel">#dom-readablestreamiteratoroptions-preventcancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamiteratoroptions-preventcancel">4.2.5. Asynchronous iteration</a> <a href="#ref-for-dom-readablestreamiteratoroptions-preventcancel①">(2)</a> <a href="#ref-for-dom-readablestreamiteratoroptions-preventcancel②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-readablewritablepair">
   <b><a href="#dictdef-readablewritablepair">#dictdef-readablewritablepair</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-readablewritablepair">4.2.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablewritablepair-readable">
   <b><a href="#dom-readablewritablepair-readable">#dom-readablewritablepair-readable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablewritablepair-readable">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablewritablepair-readable①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablewritablepair-writable">
   <b><a href="#dom-readablewritablepair-writable">#dom-readablewritablepair-writable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablewritablepair-writable">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablewritablepair-writable①">(2)</a> <a href="#ref-for-dom-readablewritablepair-writable②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-streampipeoptions">
   <b><a href="#dictdef-streampipeoptions">#dictdef-streampipeoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-streampipeoptions">4.2.1. Interface definition</a> <a href="#ref-for-dictdef-streampipeoptions①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-streampipeoptions-preventclose">
   <b><a href="#dom-streampipeoptions-preventclose">#dom-streampipeoptions-preventclose</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-streampipeoptions-preventclose">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-streampipeoptions-preventclose①">(2)</a> <a href="#ref-for-dom-streampipeoptions-preventclose②">(3)</a> <a href="#ref-for-dom-streampipeoptions-preventclose③">(4)</a> <a href="#ref-for-dom-streampipeoptions-preventclose④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-streampipeoptions-preventabort">
   <b><a href="#dom-streampipeoptions-preventabort">#dom-streampipeoptions-preventabort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-streampipeoptions-preventabort">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-streampipeoptions-preventabort①">(2)</a> <a href="#ref-for-dom-streampipeoptions-preventabort②">(3)</a> <a href="#ref-for-dom-streampipeoptions-preventabort③">(4)</a> <a href="#ref-for-dom-streampipeoptions-preventabort④">(5)</a> <a href="#ref-for-dom-streampipeoptions-preventabort⑤">(6)</a> <a href="#ref-for-dom-streampipeoptions-preventabort⑥">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-streampipeoptions-preventcancel">
   <b><a href="#dom-streampipeoptions-preventcancel">#dom-streampipeoptions-preventcancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-streampipeoptions-preventcancel">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-streampipeoptions-preventcancel①">(2)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel②">(3)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel③">(4)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel④">(5)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel⑤">(6)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel⑥">(7)</a> <a href="#ref-for-dom-streampipeoptions-preventcancel⑦">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-streampipeoptions-signal">
   <b><a href="#dom-streampipeoptions-signal">#dom-streampipeoptions-signal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-streampipeoptions-signal">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-streampipeoptions-signal①">(2)</a> <a href="#ref-for-dom-streampipeoptions-signal②">(3)</a> <a href="#ref-for-dom-streampipeoptions-signal③">(4)</a> <a href="#ref-for-dom-streampipeoptions-signal④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-controller">
   <b><a href="#readablestream-controller">#readablestream-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-controller">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream-controller①">(2)</a> <a href="#ref-for-readablestream-controller②">(3)</a> <a href="#ref-for-readablestream-controller③">(4)</a> <a href="#ref-for-readablestream-controller④">(5)</a> <a href="#ref-for-readablestream-controller⑤">(6)</a> <a href="#ref-for-readablestream-controller⑥">(7)</a>
    <li><a href="#ref-for-readablestream-controller⑦">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readablestream-controller⑧">4.9.3. Readers</a> <a href="#ref-for-readablestream-controller⑨">(2)</a> <a href="#ref-for-readablestream-controller①⓪">(3)</a>
    <li><a href="#ref-for-readablestream-controller①①">4.9.4. Default controllers</a> <a href="#ref-for-readablestream-controller①②">(2)</a>
    <li><a href="#ref-for-readablestream-controller①③">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablestream-controller①④">(2)</a>
    <li><a href="#ref-for-readablestream-controller①⑤">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-readablestream-controller①⑥">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-readablestream-controller①⑦">6.4.2. Default controllers</a> <a href="#ref-for-readablestream-controller①⑧">(2)</a>
    <li><a href="#ref-for-readablestream-controller①⑨">6.4.3. Default sinks</a>
    <li><a href="#ref-for-readablestream-controller②⓪">9.1.1. Creation and manipulation</a> <a href="#ref-for-readablestream-controller②①">(2)</a> <a href="#ref-for-readablestream-controller②②">(3)</a> <a href="#ref-for-readablestream-controller②③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-disturbed">
   <b><a href="#readablestream-disturbed">#readablestream-disturbed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-disturbed">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream-disturbed①">(2)</a>
    <li><a href="#ref-for-readablestream-disturbed②">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readablestream-disturbed③">4.9.3. Readers</a> <a href="#ref-for-readablestream-disturbed④">(2)</a>
    <li><a href="#ref-for-readablestream-disturbed⑤">9.1.3. Introspection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-reader">
   <b><a href="#readablestream-reader">#readablestream-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-reader">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream-reader①">(2)</a>
    <li><a href="#ref-for-readablestream-reader②">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestream-reader③">(2)</a> <a href="#ref-for-readablestream-reader④">(3)</a> <a href="#ref-for-readablestream-reader⑤">(4)</a> <a href="#ref-for-readablestream-reader⑥">(5)</a> <a href="#ref-for-readablestream-reader⑦">(6)</a> <a href="#ref-for-readablestream-reader⑧">(7)</a> <a href="#ref-for-readablestream-reader⑨">(8)</a> <a href="#ref-for-readablestream-reader①⓪">(9)</a> <a href="#ref-for-readablestream-reader①①">(10)</a> <a href="#ref-for-readablestream-reader①②">(11)</a> <a href="#ref-for-readablestream-reader①③">(12)</a>
    <li><a href="#ref-for-readablestream-reader①④">4.9.3. Readers</a> <a href="#ref-for-readablestream-reader①⑤">(2)</a> <a href="#ref-for-readablestream-reader①⑥">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-state">
   <b><a href="#readablestream-state">#readablestream-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-state">4.7.3. Methods and properties</a> <a href="#ref-for-readablestream-state①">(2)</a>
    <li><a href="#ref-for-readablestream-state②">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream-state③">(2)</a> <a href="#ref-for-readablestream-state④">(3)</a> <a href="#ref-for-readablestream-state⑤">(4)</a>
    <li><a href="#ref-for-readablestream-state⑥">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestream-state⑦">(2)</a> <a href="#ref-for-readablestream-state⑧">(3)</a> <a href="#ref-for-readablestream-state⑨">(4)</a> <a href="#ref-for-readablestream-state①⓪">(5)</a> <a href="#ref-for-readablestream-state①①">(6)</a> <a href="#ref-for-readablestream-state①②">(7)</a> <a href="#ref-for-readablestream-state①③">(8)</a>
    <li><a href="#ref-for-readablestream-state①④">4.9.3. Readers</a> <a href="#ref-for-readablestream-state①⑤">(2)</a> <a href="#ref-for-readablestream-state①⑥">(3)</a> <a href="#ref-for-readablestream-state①⑦">(4)</a> <a href="#ref-for-readablestream-state①⑧">(5)</a> <a href="#ref-for-readablestream-state①⑨">(6)</a> <a href="#ref-for-readablestream-state②⓪">(7)</a> <a href="#ref-for-readablestream-state②①">(8)</a>
    <li><a href="#ref-for-readablestream-state②②">4.9.4. Default controllers</a> <a href="#ref-for-readablestream-state②③">(2)</a> <a href="#ref-for-readablestream-state②④">(3)</a>
    <li><a href="#ref-for-readablestream-state②⑤">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablestream-state②⑥">(2)</a> <a href="#ref-for-readablestream-state②⑦">(3)</a> <a href="#ref-for-readablestream-state②⑧">(4)</a> <a href="#ref-for-readablestream-state②⑨">(5)</a> <a href="#ref-for-readablestream-state③⓪">(6)</a> <a href="#ref-for-readablestream-state③①">(7)</a> <a href="#ref-for-readablestream-state③②">(8)</a> <a href="#ref-for-readablestream-state③③">(9)</a> <a href="#ref-for-readablestream-state③④">(10)</a>
    <li><a href="#ref-for-readablestream-state③⑤">6.4.3. Default sinks</a>
    <li><a href="#ref-for-readablestream-state③⑥">9.1.3. Introspection</a> <a href="#ref-for-readablestream-state③⑦">(2)</a> <a href="#ref-for-readablestream-state③⑧">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-storederror">
   <b><a href="#readablestream-storederror">#readablestream-storederror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-storederror">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestream-storederror①">(2)</a> <a href="#ref-for-readablestream-storederror②">(3)</a> <a href="#ref-for-readablestream-storederror③">(4)</a>
    <li><a href="#ref-for-readablestream-storederror④">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestream-storederror⑤">(2)</a>
    <li><a href="#ref-for-readablestream-storederror⑥">4.9.3. Readers</a> <a href="#ref-for-readablestream-storederror⑦">(2)</a> <a href="#ref-for-readablestream-storederror⑧">(3)</a>
    <li><a href="#ref-for-readablestream-storederror⑨">6.4.2. Default controllers</a>
    <li><a href="#ref-for-readablestream-storederror①⓪">6.4.3. Default sinks</a> <a href="#ref-for-readablestream-storederror①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-underlyingsource">
   <b><a href="#dictdef-underlyingsource">#dictdef-underlyingsource</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-underlyingsource">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dictdef-underlyingsource①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-readablestreamcontroller">
   <b><a href="#typedefdef-readablestreamcontroller">#typedefdef-readablestreamcontroller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-readablestreamcontroller">4.2.3. The underlying source API</a> <a href="#ref-for-typedefdef-readablestreamcontroller①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsourcestartcallback">
   <b><a href="#callbackdef-underlyingsourcestartcallback">#callbackdef-underlyingsourcestartcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsourcestartcallback">4.2.3. The underlying source API</a> <a href="#ref-for-callbackdef-underlyingsourcestartcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsourcepullcallback">
   <b><a href="#callbackdef-underlyingsourcepullcallback">#callbackdef-underlyingsourcepullcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsourcepullcallback">4.2.3. The underlying source API</a> <a href="#ref-for-callbackdef-underlyingsourcepullcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsourcecancelcallback">
   <b><a href="#callbackdef-underlyingsourcecancelcallback">#callbackdef-underlyingsourcecancelcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsourcecancelcallback">4.2.3. The underlying source API</a> <a href="#ref-for-callbackdef-underlyingsourcecancelcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-readablestreamtype">
   <b><a href="#enumdef-readablestreamtype">#enumdef-readablestreamtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-readablestreamtype">4.2.3. The underlying source API</a> <a href="#ref-for-enumdef-readablestreamtype①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsource-start">
   <b><a href="#dom-underlyingsource-start">#dom-underlyingsource-start</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsource-start">4.2.3. The underlying source API</a> <a href="#ref-for-dom-underlyingsource-start①">(2)</a> <a href="#ref-for-dom-underlyingsource-start②">(3)</a> <a href="#ref-for-dom-underlyingsource-start③">(4)</a>
    <li><a href="#ref-for-dom-underlyingsource-start④">4.9.4. Default controllers</a> <a href="#ref-for-dom-underlyingsource-start⑤">(2)</a>
    <li><a href="#ref-for-dom-underlyingsource-start⑥">4.9.5. Byte stream controllers</a> <a href="#ref-for-dom-underlyingsource-start⑦">(2)</a>
    <li><a href="#ref-for-dom-underlyingsource-start⑧">10.1. A readable stream with an underlying push source (no
backpressure support)</a>
    <li><a href="#ref-for-dom-underlyingsource-start⑨">10.4. A readable stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsource-pull">
   <b><a href="#dom-underlyingsource-pull">#dom-underlyingsource-pull</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsource-pull">4.2.3. The underlying source API</a> <a href="#ref-for-dom-underlyingsource-pull①">(2)</a> <a href="#ref-for-dom-underlyingsource-pull②">(3)</a> <a href="#ref-for-dom-underlyingsource-pull③">(4)</a>
    <li><a href="#ref-for-dom-underlyingsource-pull④">4.9.4. Default controllers</a> <a href="#ref-for-dom-underlyingsource-pull⑤">(2)</a>
    <li><a href="#ref-for-dom-underlyingsource-pull⑥">4.9.5. Byte stream controllers</a> <a href="#ref-for-dom-underlyingsource-pull⑦">(2)</a>
    <li><a href="#ref-for-dom-underlyingsource-pull⑧">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-dom-underlyingsource-pull⑨">10.4. A readable stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsource-cancel">
   <b><a href="#dom-underlyingsource-cancel">#dom-underlyingsource-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsource-cancel">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-dom-underlyingsource-cancel①">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-dom-underlyingsource-cancel②">4.9.4. Default controllers</a> <a href="#ref-for-dom-underlyingsource-cancel③">(2)</a>
    <li><a href="#ref-for-dom-underlyingsource-cancel④">4.9.5. Byte stream controllers</a> <a href="#ref-for-dom-underlyingsource-cancel⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsource-type">
   <b><a href="#dom-underlyingsource-type">#dom-underlyingsource-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsource-type">4.2.3. The underlying source API</a> <a href="#ref-for-dom-underlyingsource-type①">(2)</a> <a href="#ref-for-dom-underlyingsource-type②">(3)</a>
    <li><a href="#ref-for-dom-underlyingsource-type③">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dom-underlyingsource-type④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamtype-bytes">
   <b><a href="#dom-readablestreamtype-bytes">#dom-readablestreamtype-bytes</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamtype-bytes">4.2.3. The underlying source API</a> <a href="#ref-for-dom-readablestreamtype-bytes①">(2)</a> <a href="#ref-for-dom-readablestreamtype-bytes②">(3)</a>
    <li><a href="#ref-for-dom-readablestreamtype-bytes③">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsource-autoallocatechunksize">
   <b><a href="#dom-underlyingsource-autoallocatechunksize">#dom-underlyingsource-autoallocatechunksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsource-autoallocatechunksize">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-dom-underlyingsource-autoallocatechunksize①">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-dom-underlyingsource-autoallocatechunksize②">10.5. A readable byte stream with an underlying pull source</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-constructor">
   <b><a href="#rs-constructor">#rs-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-constructor">2.1. Readable streams</a>
    <li><a href="#ref-for-rs-constructor①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-constructor②">4.2.3. The underlying source API</a> <a href="#ref-for-rs-constructor③">(2)</a> <a href="#ref-for-rs-constructor④">(3)</a>
    <li><a href="#ref-for-rs-constructor⑤">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-rs-constructor⑥">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-locked">
   <b><a href="#rs-locked">#rs-locked</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-locked">2.6. Locking</a>
    <li><a href="#ref-for-rs-locked①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-locked②">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-cancel">
   <b><a href="#rs-cancel">#rs-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-cancel">2.1. Readable streams</a>
    <li><a href="#ref-for-rs-cancel①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-cancel②">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-rs-cancel③">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-rs-cancel④">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-rs-cancel⑤">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-rs-cancel⑥">4.9.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-get-reader">
   <b><a href="#rs-get-reader">#rs-get-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-get-reader">2.1. Readable streams</a> <a href="#ref-for-rs-get-reader①">(2)</a>
    <li><a href="#ref-for-rs-get-reader②">2.6. Locking</a>
    <li><a href="#ref-for-rs-get-reader③">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-get-reader④">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-rs-get-reader⑤">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-rs-get-reader⑥">(2)</a>
    <li><a href="#ref-for-rs-get-reader⑦">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-rs-get-reader⑧">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-pipe-through">
   <b><a href="#rs-pipe-through">#rs-pipe-through</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-pipe-through">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-rs-pipe-through①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-pipe-through②">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-rs-pipe-through③">(2)</a>
    <li><a href="#ref-for-rs-pipe-through④">9.4.1. Duplex streams</a>
    <li><a href="#ref-for-rs-pipe-through⑤">9.4.2. Endpoint pairs</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-pipe-to">
   <b><a href="#rs-pipe-to">#rs-pipe-to</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-pipe-to">2.4. Pipe chains and backpressure</a> <a href="#ref-for-rs-pipe-to①">(2)</a>
    <li><a href="#ref-for-rs-pipe-to②">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-pipe-to③">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-rs-pipe-to④">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-rs-pipe-to⑤">(2)</a>
    <li><a href="#ref-for-rs-pipe-to⑥">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-rs-pipe-to⑦">5.5.3. Writers</a>
    <li><a href="#ref-for-rs-pipe-to⑧">10.11. Using an identity transform stream as a primitive to
create new readable streams</a> <a href="#ref-for-rs-pipe-to⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-tee">
   <b><a href="#rs-tee">#rs-tee</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-tee">2.1. Readable streams</a>
    <li><a href="#ref-for-rs-tee①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-rs-tee②">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-async-iterator-reader">
   <b><a href="#readablestream-async-iterator-reader">#readablestream-async-iterator-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-async-iterator-reader">4.2.5. Asynchronous iteration</a> <a href="#ref-for-readablestream-async-iterator-reader①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-async-iterator-prevent-cancel">
   <b><a href="#readablestream-async-iterator-prevent-cancel">#readablestream-async-iterator-prevent-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-async-iterator-prevent-cancel">4.2.5. Asynchronous iteration</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamgenericreader">
   <b><a href="#readablestreamgenericreader">#readablestreamgenericreader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamgenericreader">4.3. The ReadableStreamGenericReader mixin</a> <a href="#ref-for-readablestreamgenericreader①">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader②">4.3.1. Mixin definition</a>
    <li><a href="#ref-for-readablestreamgenericreader③">4.3.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamgenericreader④">4.4.1. Interface definition</a>
    <li><a href="#ref-for-readablestreamgenericreader⑤">4.4.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamgenericreader⑥">4.5.1. Interface definition</a>
    <li><a href="#ref-for-readablestreamgenericreader⑦">4.5.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamgenericreader-closedpromise">
   <b><a href="#readablestreamgenericreader-closedpromise">#readablestreamgenericreader-closedpromise</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamgenericreader-closedpromise">4.3.3. Methods and properties</a>
    <li><a href="#ref-for-readablestreamgenericreader-closedpromise①">4.9.1. Working with readable streams</a> <a href="#ref-for-readablestreamgenericreader-closedpromise②">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader-closedpromise③">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestreamgenericreader-closedpromise④">(2)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise⑤">(3)</a>
    <li><a href="#ref-for-readablestreamgenericreader-closedpromise⑥">4.9.3. Readers</a> <a href="#ref-for-readablestreamgenericreader-closedpromise⑦">(2)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise⑧">(3)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise⑨">(4)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise①⓪">(5)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise①①">(6)</a> <a href="#ref-for-readablestreamgenericreader-closedpromise①②">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamgenericreader-stream">
   <b><a href="#readablestreamgenericreader-stream">#readablestreamgenericreader-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamgenericreader-stream">4.2.5. Asynchronous iteration</a> <a href="#ref-for-readablestreamgenericreader-stream①">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream②">4.3.3. Methods and properties</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream③">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-readablestreamgenericreader-stream④">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream⑤">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-readablestreamgenericreader-stream⑥">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream⑦">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream⑧">4.7.3. Methods and properties</a> <a href="#ref-for-readablestreamgenericreader-stream⑨">(2)</a>
    <li><a href="#ref-for-readablestreamgenericreader-stream①⓪">4.9.3. Readers</a> <a href="#ref-for-readablestreamgenericreader-stream①①">(2)</a> <a href="#ref-for-readablestreamgenericreader-stream①②">(3)</a> <a href="#ref-for-readablestreamgenericreader-stream①③">(4)</a> <a href="#ref-for-readablestreamgenericreader-stream①④">(5)</a> <a href="#ref-for-readablestreamgenericreader-stream①⑤">(6)</a> <a href="#ref-for-readablestreamgenericreader-stream①⑥">(7)</a> <a href="#ref-for-readablestreamgenericreader-stream①⑦">(8)</a> <a href="#ref-for-readablestreamgenericreader-stream①⑧">(9)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generic-reader-closed">
   <b><a href="#generic-reader-closed">#generic-reader-closed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generic-reader-closed">4.3.1. Mixin definition</a>
    <li><a href="#ref-for-generic-reader-closed①">4.3.2. Internal slots</a>
    <li><a href="#ref-for-generic-reader-closed②">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-generic-reader-closed③">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generic-reader-cancel">
   <b><a href="#generic-reader-cancel">#generic-reader-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generic-reader-cancel">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-generic-reader-cancel①">4.3.1. Mixin definition</a>
    <li><a href="#ref-for-generic-reader-cancel②">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-generic-reader-cancel③">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultreader">
   <b><a href="#readablestreamdefaultreader">#readablestreamdefaultreader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultreader">2.6. Locking</a>
    <li><a href="#ref-for-readablestreamdefaultreader①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-readablestreamdefaultreader②">4.2.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamdefaultreader③">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readablestreamdefaultreader④">4.3. The ReadableStreamGenericReader mixin</a>
    <li><a href="#ref-for-readablestreamdefaultreader⑤">4.4. The ReadableStreamDefaultReader class</a> <a href="#ref-for-readablestreamdefaultreader⑥">(2)</a>
    <li><a href="#ref-for-readablestreamdefaultreader⑦">4.4.1. Interface definition</a> <a href="#ref-for-readablestreamdefaultreader⑧">(2)</a>
    <li><a href="#ref-for-readablestreamdefaultreader⑨">4.4.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamdefaultreader①⓪">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readablestreamdefaultreader①①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestreamdefaultreader①②">(2)</a> <a href="#ref-for-readablestreamdefaultreader①③">(3)</a> <a href="#ref-for-readablestreamdefaultreader①④">(4)</a>
    <li><a href="#ref-for-readablestreamdefaultreader①⑤">4.9.3. Readers</a>
    <li><a href="#ref-for-readablestreamdefaultreader①⑥">9.1.2. Reading</a> <a href="#ref-for-readablestreamdefaultreader①⑦">(2)</a> <a href="#ref-for-readablestreamdefaultreader①⑧">(3)</a> <a href="#ref-for-readablestreamdefaultreader①⑨">(4)</a> <a href="#ref-for-readablestreamdefaultreader②⓪">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-readablestreamdefaultreadresult">
   <b><a href="#dictdef-readablestreamdefaultreadresult">#dictdef-readablestreamdefaultreadresult</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-readablestreamdefaultreadresult">4.4.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamdefaultreadresult-value">
   <b><a href="#dom-readablestreamdefaultreadresult-value">#dom-readablestreamdefaultreadresult-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamdefaultreadresult-value">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreamdefaultreadresult-value①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreamdefaultreadresult-done">
   <b><a href="#dom-readablestreamdefaultreadresult-done">#dom-readablestreamdefaultreadresult-done</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreamdefaultreadresult-done">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreamdefaultreadresult-done①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultreader-readrequests">
   <b><a href="#readablestreamdefaultreader-readrequests">#readablestreamdefaultreader-readrequests</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultreader-readrequests">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-readablestreamdefaultreader-readrequests①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readablestreamdefaultreader-readrequests②">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestreamdefaultreader-readrequests③">(2)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests④">(3)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests⑤">(4)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests⑥">(5)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests⑦">(6)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests⑧">(7)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests⑨">(8)</a> <a href="#ref-for-readablestreamdefaultreader-readrequests①⓪">(9)</a>
    <li><a href="#ref-for-readablestreamdefaultreader-readrequests①①">4.9.3. Readers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-request">
   <b><a href="#read-request">#read-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-request">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-read-request①">4.4.2. Internal slots</a>
    <li><a href="#ref-for-read-request②">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-request③">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-read-request④">9.1.2. Reading</a> <a href="#ref-for-read-request⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-request-chunk-steps">
   <b><a href="#read-request-chunk-steps">#read-request-chunk-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-request-chunk-steps">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-read-request-chunk-steps①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-request-chunk-steps②">4.6.4. Internal methods</a>
    <li><a href="#ref-for-read-request-chunk-steps③">4.7.4. Internal methods</a>
    <li><a href="#ref-for-read-request-chunk-steps④">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-read-request-chunk-steps⑤">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-read-request-chunk-steps⑥">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-request-close-steps">
   <b><a href="#read-request-close-steps">#read-request-close-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-request-close-steps">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-read-request-close-steps①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-request-close-steps②">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-read-request-close-steps③">4.9.2. Interfacing with controllers</a> <a href="#ref-for-read-request-close-steps④">(2)</a>
    <li><a href="#ref-for-read-request-close-steps⑤">4.9.3. Readers</a>
    <li><a href="#ref-for-read-request-close-steps⑥">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-request-error-steps">
   <b><a href="#read-request-error-steps">#read-request-error-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-request-error-steps">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-read-request-error-steps①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-request-error-steps②">4.7.4. Internal methods</a>
    <li><a href="#ref-for-read-request-error-steps③">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-read-request-error-steps④">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-read-request-error-steps⑤">4.9.3. Readers</a>
    <li><a href="#ref-for-read-request-error-steps⑥">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-reader-constructor">
   <b><a href="#default-reader-constructor">#default-reader-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-reader-constructor">4.4.1. Interface definition</a>
    <li><a href="#ref-for-default-reader-constructor①">4.4.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-reader-read">
   <b><a href="#default-reader-read">#default-reader-read</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-reader-read">4.4.1. Interface definition</a>
    <li><a href="#ref-for-default-reader-read①">4.4.3. Constructor, methods, and properties</a> <a href="#ref-for-default-reader-read②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-reader-release-lock">
   <b><a href="#default-reader-release-lock">#default-reader-release-lock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-reader-release-lock">2.6. Locking</a>
    <li><a href="#ref-for-default-reader-release-lock①">4.4.1. Interface definition</a>
    <li><a href="#ref-for-default-reader-release-lock②">4.4.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreambyobreader">
   <b><a href="#readablestreambyobreader">#readablestreambyobreader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreambyobreader">2.6. Locking</a>
    <li><a href="#ref-for-readablestreambyobreader①">4.2.1. Interface definition</a>
    <li><a href="#ref-for-readablestreambyobreader②">4.2.2. Internal slots</a>
    <li><a href="#ref-for-readablestreambyobreader③">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readablestreambyobreader④">4.3. The ReadableStreamGenericReader mixin</a>
    <li><a href="#ref-for-readablestreambyobreader⑤">4.5. The ReadableStreamBYOBReader class</a> <a href="#ref-for-readablestreambyobreader⑥">(2)</a>
    <li><a href="#ref-for-readablestreambyobreader⑦">4.5.1. Interface definition</a> <a href="#ref-for-readablestreambyobreader⑧">(2)</a>
    <li><a href="#ref-for-readablestreambyobreader⑨">4.5.2. Internal slots</a>
    <li><a href="#ref-for-readablestreambyobreader①⓪">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readablestreambyobreader①①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestreambyobreader①②">(2)</a> <a href="#ref-for-readablestreambyobreader①③">(3)</a>
    <li><a href="#ref-for-readablestreambyobreader①④">4.9.3. Readers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-readablestreambyobreadresult">
   <b><a href="#dictdef-readablestreambyobreadresult">#dictdef-readablestreambyobreadresult</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-readablestreambyobreadresult">4.5.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreambyobreadresult-value">
   <b><a href="#dom-readablestreambyobreadresult-value">#dom-readablestreambyobreadresult-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreambyobreadresult-value">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreambyobreadresult-value①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-readablestreambyobreadresult-done">
   <b><a href="#dom-readablestreambyobreadresult-done">#dom-readablestreambyobreadresult-done</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-readablestreambyobreadresult-done">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-dom-readablestreambyobreadresult-done①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreambyobreader-readintorequests">
   <b><a href="#readablestreambyobreader-readintorequests">#readablestreambyobreader-readintorequests</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreambyobreader-readintorequests">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readablestreambyobreader-readintorequests①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readablestreambyobreader-readintorequests②">(2)</a> <a href="#ref-for-readablestreambyobreader-readintorequests③">(3)</a> <a href="#ref-for-readablestreambyobreader-readintorequests④">(4)</a> <a href="#ref-for-readablestreambyobreader-readintorequests⑤">(5)</a> <a href="#ref-for-readablestreambyobreader-readintorequests⑥">(6)</a> <a href="#ref-for-readablestreambyobreader-readintorequests⑦">(7)</a>
    <li><a href="#ref-for-readablestreambyobreader-readintorequests⑧">4.9.3. Readers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-into-request">
   <b><a href="#read-into-request">#read-into-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-into-request">4.5.2. Internal slots</a>
    <li><a href="#ref-for-read-into-request①">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-into-request-chunk-steps">
   <b><a href="#read-into-request-chunk-steps">#read-into-request-chunk-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-into-request-chunk-steps">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-into-request-chunk-steps①">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-read-into-request-chunk-steps②">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-into-request-close-steps">
   <b><a href="#read-into-request-close-steps">#read-into-request-close-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-into-request-close-steps">4.5.2. Internal slots</a>
    <li><a href="#ref-for-read-into-request-close-steps①">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-into-request-close-steps②">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-read-into-request-close-steps③">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-into-request-error-steps">
   <b><a href="#read-into-request-error-steps">#read-into-request-error-steps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-into-request-error-steps">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-read-into-request-error-steps①">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-read-into-request-error-steps②">4.9.3. Readers</a>
    <li><a href="#ref-for-read-into-request-error-steps③">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="byob-reader-constructor">
   <b><a href="#byob-reader-constructor">#byob-reader-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byob-reader-constructor">4.5.1. Interface definition</a>
    <li><a href="#ref-for-byob-reader-constructor①">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="byob-reader-read">
   <b><a href="#byob-reader-read">#byob-reader-read</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byob-reader-read">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-byob-reader-read①">4.5.1. Interface definition</a>
    <li><a href="#ref-for-byob-reader-read②">4.5.2. Internal slots</a>
    <li><a href="#ref-for-byob-reader-read③">4.5.3. Constructor, methods, and properties</a> <a href="#ref-for-byob-reader-read④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="byob-reader-release-lock">
   <b><a href="#byob-reader-release-lock">#byob-reader-release-lock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byob-reader-release-lock">2.6. Locking</a>
    <li><a href="#ref-for-byob-reader-release-lock①">4.5.1. Interface definition</a>
    <li><a href="#ref-for-byob-reader-release-lock②">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller">
   <b><a href="#readablestreamdefaultcontroller">#readablestreamdefaultcontroller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller">4.2.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller①">4.2.3. The underlying source API</a> <a href="#ref-for-readablestreamdefaultcontroller②">(2)</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller③">4.6. The ReadableStreamDefaultController class</a> <a href="#ref-for-readablestreamdefaultcontroller④">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller⑤">(3)</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller⑥">4.6.1. Interface definition</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller⑦">4.6.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller⑧">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller⑨">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller①⓪">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller①①">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller①②">(2)</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller①③">8.2. Transferable streams</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller①④">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-cancelalgorithm">
   <b><a href="#readablestreamdefaultcontroller-cancelalgorithm">#readablestreamdefaultcontroller-cancelalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-cancelalgorithm">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller-cancelalgorithm①">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-cancelalgorithm②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-closerequested">
   <b><a href="#readablestreamdefaultcontroller-closerequested">#readablestreamdefaultcontroller-closerequested</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-closerequested">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller-closerequested①">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-closerequested②">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-closerequested③">(3)</a> <a href="#ref-for-readablestreamdefaultcontroller-closerequested④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-pullagain">
   <b><a href="#readablestreamdefaultcontroller-pullagain">#readablestreamdefaultcontroller-pullagain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-pullagain">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-pullagain①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-pullagain②">(3)</a> <a href="#ref-for-readablestreamdefaultcontroller-pullagain③">(4)</a> <a href="#ref-for-readablestreamdefaultcontroller-pullagain④">(5)</a> <a href="#ref-for-readablestreamdefaultcontroller-pullagain⑤">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-pullalgorithm">
   <b><a href="#readablestreamdefaultcontroller-pullalgorithm">#readablestreamdefaultcontroller-pullalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-pullalgorithm">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-pullalgorithm①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-pullalgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-pulling">
   <b><a href="#readablestreamdefaultcontroller-pulling">#readablestreamdefaultcontroller-pulling</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-pulling">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-pulling①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-pulling②">(3)</a> <a href="#ref-for-readablestreamdefaultcontroller-pulling③">(4)</a> <a href="#ref-for-readablestreamdefaultcontroller-pulling④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-queue">
   <b><a href="#readablestreamdefaultcontroller-queue">#readablestreamdefaultcontroller-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-queue">4.6.2. Internal slots</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller-queue①">4.6.4. Internal methods</a> <a href="#ref-for-readablestreamdefaultcontroller-queue②">(2)</a>
    <li><a href="#ref-for-readablestreamdefaultcontroller-queue③">4.9.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-queuetotalsize">
   <b><a href="#readablestreamdefaultcontroller-queuetotalsize">#readablestreamdefaultcontroller-queuetotalsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-queuetotalsize">4.9.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-started">
   <b><a href="#readablestreamdefaultcontroller-started">#readablestreamdefaultcontroller-started</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-started">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-started①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-started②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-strategyhwm">
   <b><a href="#readablestreamdefaultcontroller-strategyhwm">#readablestreamdefaultcontroller-strategyhwm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-strategyhwm">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-strategyhwm①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-strategysizealgorithm">
   <b><a href="#readablestreamdefaultcontroller-strategysizealgorithm">#readablestreamdefaultcontroller-strategysizealgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-strategysizealgorithm">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-strategysizealgorithm①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-strategysizealgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreamdefaultcontroller-stream">
   <b><a href="#readablestreamdefaultcontroller-stream">#readablestreamdefaultcontroller-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreamdefaultcontroller-stream">4.9.4. Default controllers</a> <a href="#ref-for-readablestreamdefaultcontroller-stream①">(2)</a> <a href="#ref-for-readablestreamdefaultcontroller-stream②">(3)</a> <a href="#ref-for-readablestreamdefaultcontroller-stream③">(4)</a> <a href="#ref-for-readablestreamdefaultcontroller-stream④">(5)</a> <a href="#ref-for-readablestreamdefaultcontroller-stream⑤">(6)</a> <a href="#ref-for-readablestreamdefaultcontroller-stream⑥">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-default-controller-desired-size">
   <b><a href="#rs-default-controller-desired-size">#rs-default-controller-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-default-controller-desired-size">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-rs-default-controller-desired-size①">4.6.1. Interface definition</a>
    <li><a href="#ref-for-rs-default-controller-desired-size②">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-rs-default-controller-desired-size③">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-default-controller-close">
   <b><a href="#rs-default-controller-close">#rs-default-controller-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-default-controller-close">4.6.1. Interface definition</a>
    <li><a href="#ref-for-rs-default-controller-close①">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-rs-default-controller-close②">4.9.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-default-controller-enqueue">
   <b><a href="#rs-default-controller-enqueue">#rs-default-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-default-controller-enqueue">4.6.1. Interface definition</a>
    <li><a href="#ref-for-rs-default-controller-enqueue①">4.6.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-default-controller-error">
   <b><a href="#rs-default-controller-error">#rs-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-default-controller-error">4.6.1. Interface definition</a>
    <li><a href="#ref-for-rs-default-controller-error①">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-rs-default-controller-error②">4.9.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller">
   <b><a href="#readablebytestreamcontroller">#readablebytestreamcontroller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller">4.2.2. Internal slots</a>
    <li><a href="#ref-for-readablebytestreamcontroller①">4.2.3. The underlying source API</a> <a href="#ref-for-readablebytestreamcontroller②">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller③">4.7. The ReadableByteStreamController class</a> <a href="#ref-for-readablebytestreamcontroller④">(2)</a> <a href="#ref-for-readablebytestreamcontroller⑤">(3)</a>
    <li><a href="#ref-for-readablebytestreamcontroller⑥">4.7.1. Interface definition</a>
    <li><a href="#ref-for-readablebytestreamcontroller⑦">4.7.2. Internal slots</a> <a href="#ref-for-readablebytestreamcontroller⑧">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller⑨">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readablebytestreamcontroller①⓪">4.8. The ReadableStreamBYOBRequest class</a>
    <li><a href="#ref-for-readablebytestreamcontroller①①">4.8.2. Internal slots</a>
    <li><a href="#ref-for-readablebytestreamcontroller①②">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readablebytestreamcontroller①③">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readablebytestreamcontroller①④">4.9.3. Readers</a>
    <li><a href="#ref-for-readablebytestreamcontroller①⑤">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-autoallocatechunksize">
   <b><a href="#readablebytestreamcontroller-autoallocatechunksize">#readablebytestreamcontroller-autoallocatechunksize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-autoallocatechunksize">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readablebytestreamcontroller-autoallocatechunksize①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-byobrequest">
   <b><a href="#readablebytestreamcontroller-byobrequest">#readablebytestreamcontroller-byobrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-byobrequest">4.7.3. Methods and properties</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest①">(2)</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest②">(3)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-byobrequest③">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest④">(2)</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest⑤">(3)</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest⑥">(4)</a> <a href="#ref-for-readablebytestreamcontroller-byobrequest⑦">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-cancelalgorithm">
   <b><a href="#readablebytestreamcontroller-cancelalgorithm">#readablebytestreamcontroller-cancelalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-cancelalgorithm">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readablebytestreamcontroller-cancelalgorithm①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-cancelalgorithm②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-closerequested">
   <b><a href="#readablebytestreamcontroller-closerequested">#readablebytestreamcontroller-closerequested</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-closerequested">4.7.3. Methods and properties</a> <a href="#ref-for-readablebytestreamcontroller-closerequested①">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-closerequested②">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-closerequested③">(2)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested④">(3)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested⑤">(4)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested⑥">(5)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested⑦">(6)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested⑧">(7)</a> <a href="#ref-for-readablebytestreamcontroller-closerequested⑨">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-pullagain">
   <b><a href="#readablebytestreamcontroller-pullagain">#readablebytestreamcontroller-pullagain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-pullagain">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-pullagain①">(2)</a> <a href="#ref-for-readablebytestreamcontroller-pullagain②">(3)</a> <a href="#ref-for-readablebytestreamcontroller-pullagain③">(4)</a> <a href="#ref-for-readablebytestreamcontroller-pullagain④">(5)</a> <a href="#ref-for-readablebytestreamcontroller-pullagain⑤">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-pullalgorithm">
   <b><a href="#readablebytestreamcontroller-pullalgorithm">#readablebytestreamcontroller-pullalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-pullalgorithm">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-pullalgorithm①">(2)</a> <a href="#ref-for-readablebytestreamcontroller-pullalgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-pulling">
   <b><a href="#readablebytestreamcontroller-pulling">#readablebytestreamcontroller-pulling</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-pulling">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-pulling①">(2)</a> <a href="#ref-for-readablebytestreamcontroller-pulling②">(3)</a> <a href="#ref-for-readablebytestreamcontroller-pulling③">(4)</a> <a href="#ref-for-readablebytestreamcontroller-pulling④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-pendingpullintos">
   <b><a href="#readablebytestreamcontroller-pendingpullintos">#readablebytestreamcontroller-pendingpullintos</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-pendingpullintos">4.7.3. Methods and properties</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-pendingpullintos②">4.7.4. Internal methods</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos③">(2)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos④">(3)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-pendingpullintos⑤">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos⑥">(2)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos⑦">(3)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos⑧">(4)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos⑨">(5)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⓪">(6)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①①">(7)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①②">(8)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①③">(9)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①④">(10)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⑤">(11)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⑥">(12)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⑦">(13)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⑧">(14)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos①⑨">(15)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos②⓪">(16)</a> <a href="#ref-for-readablebytestreamcontroller-pendingpullintos②①">(17)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-queue">
   <b><a href="#readablebytestreamcontroller-queue">#readablebytestreamcontroller-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-queue">4.7.2. Internal slots</a> <a href="#ref-for-readablebytestreamcontroller-queue①">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-queue②">4.7.4. Internal methods</a> <a href="#ref-for-readablebytestreamcontroller-queue③">(2)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-queue④">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-queue⑤">(2)</a> <a href="#ref-for-readablebytestreamcontroller-queue⑥">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-queuetotalsize">
   <b><a href="#readablebytestreamcontroller-queuetotalsize">#readablebytestreamcontroller-queuetotalsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-queuetotalsize">4.7.2. Internal slots</a>
    <li><a href="#ref-for-readablebytestreamcontroller-queuetotalsize①">4.7.4. Internal methods</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize②">(2)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize③">(3)</a>
    <li><a href="#ref-for-readablebytestreamcontroller-queuetotalsize④">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize⑤">(2)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize⑥">(3)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize⑦">(4)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize⑧">(5)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize⑨">(6)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize①⓪">(7)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize①①">(8)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize①②">(9)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize①③">(10)</a> <a href="#ref-for-readablebytestreamcontroller-queuetotalsize①④">(11)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-started">
   <b><a href="#readablebytestreamcontroller-started">#readablebytestreamcontroller-started</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-started">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-started①">(2)</a> <a href="#ref-for-readablebytestreamcontroller-started②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-strategyhwm">
   <b><a href="#readablebytestreamcontroller-strategyhwm">#readablebytestreamcontroller-strategyhwm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-strategyhwm">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-strategyhwm①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablebytestreamcontroller-stream">
   <b><a href="#readablebytestreamcontroller-stream">#readablebytestreamcontroller-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablebytestreamcontroller-stream">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readablebytestreamcontroller-stream①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readablebytestreamcontroller-stream②">(2)</a> <a href="#ref-for-readablebytestreamcontroller-stream③">(3)</a> <a href="#ref-for-readablebytestreamcontroller-stream④">(4)</a> <a href="#ref-for-readablebytestreamcontroller-stream⑤">(5)</a> <a href="#ref-for-readablebytestreamcontroller-stream⑥">(6)</a> <a href="#ref-for-readablebytestreamcontroller-stream⑦">(7)</a> <a href="#ref-for-readablebytestreamcontroller-stream⑧">(8)</a> <a href="#ref-for-readablebytestreamcontroller-stream⑨">(9)</a> <a href="#ref-for-readablebytestreamcontroller-stream①⓪">(10)</a> <a href="#ref-for-readablebytestreamcontroller-stream①①">(11)</a> <a href="#ref-for-readablebytestreamcontroller-stream①②">(12)</a> <a href="#ref-for-readablebytestreamcontroller-stream①③">(13)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-queue-entry">
   <b><a href="#readable-byte-stream-queue-entry">#readable-byte-stream-queue-entry</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-queue-entry">4.7.2. Internal slots</a>
    <li><a href="#ref-for-readable-byte-stream-queue-entry①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-queue-entry-buffer">
   <b><a href="#readable-byte-stream-queue-entry-buffer">#readable-byte-stream-queue-entry-buffer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-buffer">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-buffer①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-queue-entry-buffer②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-queue-entry-byte-offset">
   <b><a href="#readable-byte-stream-queue-entry-byte-offset">#readable-byte-stream-queue-entry-byte-offset</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-byte-offset">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-byte-offset①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-offset②">(2)</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-offset③">(3)</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-offset④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-queue-entry-byte-length">
   <b><a href="#readable-byte-stream-queue-entry-byte-length">#readable-byte-stream-queue-entry-byte-length</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-byte-length">4.7.4. Internal methods</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-length①">(2)</a>
    <li><a href="#ref-for-readable-byte-stream-queue-entry-byte-length②">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-length③">(2)</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-length④">(3)</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-length⑤">(4)</a> <a href="#ref-for-readable-byte-stream-queue-entry-byte-length⑥">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor">
   <b><a href="#pull-into-descriptor">#pull-into-descriptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor">4.7.2. Internal slots</a>
    <li><a href="#ref-for-pull-into-descriptor①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor②">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-buffer">
   <b><a href="#pull-into-descriptor-buffer">#pull-into-descriptor-buffer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-buffer">4.7.2. Internal slots</a> <a href="#ref-for-pull-into-descriptor-buffer①">(2)</a> <a href="#ref-for-pull-into-descriptor-buffer②">(3)</a> <a href="#ref-for-pull-into-descriptor-buffer③">(4)</a> <a href="#ref-for-pull-into-descriptor-buffer④">(5)</a>
    <li><a href="#ref-for-pull-into-descriptor-buffer⑤">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-pull-into-descriptor-buffer⑥">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-buffer⑦">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-buffer⑧">(2)</a> <a href="#ref-for-pull-into-descriptor-buffer⑨">(3)</a> <a href="#ref-for-pull-into-descriptor-buffer①⓪">(4)</a> <a href="#ref-for-pull-into-descriptor-buffer①①">(5)</a> <a href="#ref-for-pull-into-descriptor-buffer①②">(6)</a> <a href="#ref-for-pull-into-descriptor-buffer①③">(7)</a> <a href="#ref-for-pull-into-descriptor-buffer①④">(8)</a> <a href="#ref-for-pull-into-descriptor-buffer①⑤">(9)</a> <a href="#ref-for-pull-into-descriptor-buffer①⑥">(10)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-byte-offset">
   <b><a href="#pull-into-descriptor-byte-offset">#pull-into-descriptor-byte-offset</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-byte-offset">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-pull-into-descriptor-byte-offset①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-byte-offset②">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-byte-offset③">(2)</a> <a href="#ref-for-pull-into-descriptor-byte-offset④">(3)</a> <a href="#ref-for-pull-into-descriptor-byte-offset⑤">(4)</a> <a href="#ref-for-pull-into-descriptor-byte-offset⑥">(5)</a> <a href="#ref-for-pull-into-descriptor-byte-offset⑦">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-byte-length">
   <b><a href="#pull-into-descriptor-byte-length">#pull-into-descriptor-byte-length</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-byte-length">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-pull-into-descriptor-byte-length①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-byte-length②">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-byte-length③">(2)</a> <a href="#ref-for-pull-into-descriptor-byte-length④">(3)</a> <a href="#ref-for-pull-into-descriptor-byte-length⑤">(4)</a> <a href="#ref-for-pull-into-descriptor-byte-length⑥">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-bytes-filled">
   <b><a href="#pull-into-descriptor-bytes-filled">#pull-into-descriptor-bytes-filled</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-bytes-filled">4.7.3. Methods and properties</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①">(2)</a>
    <li><a href="#ref-for-pull-into-descriptor-bytes-filled②">4.7.4. Internal methods</a> <a href="#ref-for-pull-into-descriptor-bytes-filled③">(2)</a>
    <li><a href="#ref-for-pull-into-descriptor-bytes-filled④">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-bytes-filled⑤">(2)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled⑥">(3)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled⑦">(4)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled⑧">(5)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled⑨">(6)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⓪">(7)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①①">(8)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①②">(9)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①③">(10)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①④">(11)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⑤">(12)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⑥">(13)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⑦">(14)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⑧">(15)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled①⑨">(16)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②⓪">(17)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②①">(18)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②②">(19)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②③">(20)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②④">(21)</a> <a href="#ref-for-pull-into-descriptor-bytes-filled②⑤">(22)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-element-size">
   <b><a href="#pull-into-descriptor-element-size">#pull-into-descriptor-element-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-element-size">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-element-size①">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-element-size②">(2)</a> <a href="#ref-for-pull-into-descriptor-element-size③">(3)</a> <a href="#ref-for-pull-into-descriptor-element-size④">(4)</a> <a href="#ref-for-pull-into-descriptor-element-size⑤">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-view-constructor">
   <b><a href="#pull-into-descriptor-view-constructor">#pull-into-descriptor-view-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-view-constructor">4.7.2. Internal slots</a>
    <li><a href="#ref-for-pull-into-descriptor-view-constructor①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-view-constructor②">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-view-constructor③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pull-into-descriptor-reader-type">
   <b><a href="#pull-into-descriptor-reader-type">#pull-into-descriptor-reader-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pull-into-descriptor-reader-type">4.7.4. Internal methods</a>
    <li><a href="#ref-for-pull-into-descriptor-reader-type①">4.9.5. Byte stream controllers</a> <a href="#ref-for-pull-into-descriptor-reader-type②">(2)</a> <a href="#ref-for-pull-into-descriptor-reader-type③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rbs-controller-byob-request">
   <b><a href="#rbs-controller-byob-request">#rbs-controller-byob-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rbs-controller-byob-request">4.2.3. The underlying source API</a>
    <li><a href="#ref-for-rbs-controller-byob-request①">4.7.1. Interface definition</a>
    <li><a href="#ref-for-rbs-controller-byob-request②">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rbs-controller-desired-size">
   <b><a href="#rbs-controller-desired-size">#rbs-controller-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rbs-controller-desired-size">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-rbs-controller-desired-size①">4.7.1. Interface definition</a>
    <li><a href="#ref-for-rbs-controller-desired-size②">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-rbs-controller-desired-size③">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-rbs-controller-desired-size④">10.3. A readable byte stream with an underlying push source (no backpressure
support)</a> <a href="#ref-for-rbs-controller-desired-size⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rbs-controller-close">
   <b><a href="#rbs-controller-close">#rbs-controller-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rbs-controller-close">4.7.1. Interface definition</a>
    <li><a href="#ref-for-rbs-controller-close①">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rbs-controller-enqueue">
   <b><a href="#rbs-controller-enqueue">#rbs-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rbs-controller-enqueue">4.7.1. Interface definition</a>
    <li><a href="#ref-for-rbs-controller-enqueue①">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rbs-controller-error">
   <b><a href="#rbs-controller-error">#rbs-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rbs-controller-error">4.7.1. Interface definition</a>
    <li><a href="#ref-for-rbs-controller-error①">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreambyobrequest">
   <b><a href="#readablestreambyobrequest">#readablestreambyobrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreambyobrequest">4.7.1. Interface definition</a>
    <li><a href="#ref-for-readablestreambyobrequest①">4.7.2. Internal slots</a>
    <li><a href="#ref-for-readablestreambyobrequest②">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-readablestreambyobrequest③">4.8. The ReadableStreamBYOBRequest class</a> <a href="#ref-for-readablestreambyobrequest④">(2)</a>
    <li><a href="#ref-for-readablestreambyobrequest⑤">4.8.1. Interface definition</a>
    <li><a href="#ref-for-readablestreambyobrequest⑥">4.8.2. Internal slots</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreambyobrequest-controller">
   <b><a href="#readablestreambyobrequest-controller">#readablestreambyobrequest-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreambyobrequest-controller">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-readablestreambyobrequest-controller①">4.8.3. Methods and properties</a> <a href="#ref-for-readablestreambyobrequest-controller②">(2)</a> <a href="#ref-for-readablestreambyobrequest-controller③">(3)</a> <a href="#ref-for-readablestreambyobrequest-controller④">(4)</a>
    <li><a href="#ref-for-readablestreambyobrequest-controller⑤">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestreambyobrequest-view">
   <b><a href="#readablestreambyobrequest-view">#readablestreambyobrequest-view</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestreambyobrequest-view">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-readablestreambyobrequest-view①">4.8.3. Methods and properties</a> <a href="#ref-for-readablestreambyobrequest-view②">(2)</a> <a href="#ref-for-readablestreambyobrequest-view③">(3)</a> <a href="#ref-for-readablestreambyobrequest-view④">(4)</a>
    <li><a href="#ref-for-readablestreambyobrequest-view⑤">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-byob-request-view">
   <b><a href="#rs-byob-request-view">#rs-byob-request-view</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-byob-request-view">4.8.1. Interface definition</a>
    <li><a href="#ref-for-rs-byob-request-view①">4.8.3. Methods and properties</a> <a href="#ref-for-rs-byob-request-view②">(2)</a> <a href="#ref-for-rs-byob-request-view③">(3)</a> <a href="#ref-for-rs-byob-request-view④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-byob-request-respond">
   <b><a href="#rs-byob-request-respond">#rs-byob-request-respond</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-byob-request-respond">4.8.1. Interface definition</a>
    <li><a href="#ref-for-rs-byob-request-respond①">4.8.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-byob-request-respond-with-new-view">
   <b><a href="#rs-byob-request-respond-with-new-view">#rs-byob-request-respond-with-new-view</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-byob-request-respond-with-new-view">4.8.1. Interface definition</a>
    <li><a href="#ref-for-rs-byob-request-respond-with-new-view①">4.8.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="acquire-readable-stream-byob-reader">
   <b><a href="#acquire-readable-stream-byob-reader">#acquire-readable-stream-byob-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-acquire-readable-stream-byob-reader">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-acquire-readable-stream-byob-reader①">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="acquire-readable-stream-reader">
   <b><a href="#acquire-readable-stream-reader">#acquire-readable-stream-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-acquire-readable-stream-reader">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-acquire-readable-stream-reader①">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-acquire-readable-stream-reader②">4.9.1. Working with readable streams</a> <a href="#ref-for-acquire-readable-stream-reader③">(2)</a> <a href="#ref-for-acquire-readable-stream-reader④">(3)</a>
    <li><a href="#ref-for-acquire-readable-stream-reader⑤">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-readable-stream">
   <b><a href="#create-readable-stream">#create-readable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-readable-stream">4.9.1. Working with readable streams</a> <a href="#ref-for-create-readable-stream①">(2)</a>
    <li><a href="#ref-for-create-readable-stream②">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="initialize-readable-stream">
   <b><a href="#initialize-readable-stream">#initialize-readable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initialize-readable-stream">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-initialize-readable-stream①">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-initialize-readable-stream②">8.2. Transferable streams</a>
    <li><a href="#ref-for-initialize-readable-stream③">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="is-readable-stream-locked">
   <b><a href="#is-readable-stream-locked">#is-readable-stream-locked</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-is-readable-stream-locked">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-is-readable-stream-locked①">(2)</a> <a href="#ref-for-is-readable-stream-locked②">(3)</a> <a href="#ref-for-is-readable-stream-locked③">(4)</a>
    <li><a href="#ref-for-is-readable-stream-locked④">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-is-readable-stream-locked⑤">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-is-readable-stream-locked⑥">4.9.3. Readers</a> <a href="#ref-for-is-readable-stream-locked⑦">(2)</a>
    <li><a href="#ref-for-is-readable-stream-locked⑧">4.9.4. Default controllers</a> <a href="#ref-for-is-readable-stream-locked⑨">(2)</a>
    <li><a href="#ref-for-is-readable-stream-locked①⓪">4.9.5. Byte stream controllers</a>
    <li><a href="#ref-for-is-readable-stream-locked①①">6.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-is-readable-stream-locked①②">9.1.3. Introspection</a>
    <li><a href="#ref-for-is-readable-stream-locked①③">9.5. Piping</a> <a href="#ref-for-is-readable-stream-locked①④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-pipe-to">
   <b><a href="#readable-stream-pipe-to">#readable-stream-pipe-to</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-pipe-to">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-readable-stream-pipe-to①">(2)</a>
    <li><a href="#ref-for-readable-stream-pipe-to②">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-readable-stream-pipe-to③">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-readable-stream-pipe-to④">9.5. Piping</a> <a href="#ref-for-readable-stream-pipe-to⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-pipeTo-shutdown-with-action">
   <b><a href="#rs-pipeTo-shutdown-with-action">#rs-pipeTo-shutdown-with-action</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-pipeTo-shutdown-with-action">4.9.1. Working with readable streams</a> <a href="#ref-for-rs-pipeTo-shutdown-with-action①">(2)</a> <a href="#ref-for-rs-pipeTo-shutdown-with-action②">(3)</a> <a href="#ref-for-rs-pipeTo-shutdown-with-action③">(4)</a> <a href="#ref-for-rs-pipeTo-shutdown-with-action④">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-pipeTo-shutdown">
   <b><a href="#rs-pipeTo-shutdown">#rs-pipeTo-shutdown</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-pipeTo-shutdown">4.9.1. Working with readable streams</a> <a href="#ref-for-rs-pipeTo-shutdown①">(2)</a> <a href="#ref-for-rs-pipeTo-shutdown②">(3)</a> <a href="#ref-for-rs-pipeTo-shutdown③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-pipeTo-finalize">
   <b><a href="#rs-pipeTo-finalize">#rs-pipeTo-finalize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-pipeTo-finalize">4.9.1. Working with readable streams</a> <a href="#ref-for-rs-pipeTo-finalize①">(2)</a> <a href="#ref-for-rs-pipeTo-finalize②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-tee">
   <b><a href="#readable-stream-tee">#readable-stream-tee</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-tee">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-stream-tee①">9.1.2. Reading</a> <a href="#ref-for-readable-stream-tee②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-readablestreamcontroller-cancelsteps">
   <b><a href="#abstract-opdef-readablestreamcontroller-cancelsteps">#abstract-opdef-readablestreamcontroller-cancelsteps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-cancelsteps">4.6.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-cancelsteps①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-cancelsteps②">4.9.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-readablestreamcontroller-pullsteps">
   <b><a href="#abstract-opdef-readablestreamcontroller-pullsteps">#abstract-opdef-readablestreamcontroller-pullsteps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-pullsteps">4.6.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-pullsteps①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-readablestreamcontroller-pullsteps②">4.9.3. Readers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-add-read-into-request">
   <b><a href="#readable-stream-add-read-into-request">#readable-stream-add-read-into-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-add-read-into-request">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-add-read-into-request①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-add-read-request">
   <b><a href="#readable-stream-add-read-request">#readable-stream-add-read-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-add-read-request">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readable-stream-add-read-request①">4.7.4. Internal methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-cancel">
   <b><a href="#readable-stream-cancel">#readable-stream-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-cancel">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-stream-cancel①">4.9.1. Working with readable streams</a> <a href="#ref-for-readable-stream-cancel②">(2)</a> <a href="#ref-for-readable-stream-cancel③">(3)</a> <a href="#ref-for-readable-stream-cancel④">(4)</a> <a href="#ref-for-readable-stream-cancel⑤">(5)</a>
    <li><a href="#ref-for-readable-stream-cancel⑥">4.9.3. Readers</a>
    <li><a href="#ref-for-readable-stream-cancel⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-close">
   <b><a href="#readable-stream-close">#readable-stream-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-close">4.6.4. Internal methods</a>
    <li><a href="#ref-for-readable-stream-close①">4.9.2. Interfacing with controllers</a>
    <li><a href="#ref-for-readable-stream-close②">4.9.4. Default controllers</a>
    <li><a href="#ref-for-readable-stream-close③">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-close④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-error">
   <b><a href="#readable-stream-error">#readable-stream-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-error">4.9.4. Default controllers</a>
    <li><a href="#ref-for-readable-stream-error①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-fulfill-read-into-request">
   <b><a href="#readable-stream-fulfill-read-into-request">#readable-stream-fulfill-read-into-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-fulfill-read-into-request">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-fulfill-read-request">
   <b><a href="#readable-stream-fulfill-read-request">#readable-stream-fulfill-read-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-fulfill-read-request">4.9.4. Default controllers</a>
    <li><a href="#ref-for-readable-stream-fulfill-read-request①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-fulfill-read-request②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-get-num-read-into-requests">
   <b><a href="#readable-stream-get-num-read-into-requests">#readable-stream-get-num-read-into-requests</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-get-num-read-into-requests">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-get-num-read-into-requests①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-get-num-read-requests">
   <b><a href="#readable-stream-get-num-read-requests">#readable-stream-get-num-read-requests</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-get-num-read-requests">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-stream-get-num-read-requests①">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-get-num-read-requests②">(2)</a>
    <li><a href="#ref-for-readable-stream-get-num-read-requests③">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-get-num-read-requests④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-has-byob-reader">
   <b><a href="#readable-stream-has-byob-reader">#readable-stream-has-byob-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-has-byob-reader">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readable-stream-has-byob-reader①">(2)</a>
    <li><a href="#ref-for-readable-stream-has-byob-reader②">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-has-byob-reader③">(2)</a> <a href="#ref-for-readable-stream-has-byob-reader④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-has-default-reader">
   <b><a href="#readable-stream-has-default-reader">#readable-stream-has-default-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-has-default-reader">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-stream-has-default-reader①">4.9.2. Interfacing with controllers</a> <a href="#ref-for-readable-stream-has-default-reader②">(2)</a>
    <li><a href="#ref-for-readable-stream-has-default-reader③">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-stream-has-default-reader④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-reader-generic-cancel">
   <b><a href="#readable-stream-reader-generic-cancel">#readable-stream-reader-generic-cancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-reader-generic-cancel">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-readable-stream-reader-generic-cancel①">4.3.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-reader-generic-cancel②">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-reader-generic-initialize">
   <b><a href="#readable-stream-reader-generic-initialize">#readable-stream-reader-generic-initialize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-reader-generic-initialize">4.9.3. Readers</a> <a href="#ref-for-readable-stream-reader-generic-initialize①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-reader-generic-release">
   <b><a href="#readable-stream-reader-generic-release">#readable-stream-reader-generic-release</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-reader-generic-release">4.2.5. Asynchronous iteration</a> <a href="#ref-for-readable-stream-reader-generic-release①">(2)</a> <a href="#ref-for-readable-stream-reader-generic-release②">(3)</a> <a href="#ref-for-readable-stream-reader-generic-release③">(4)</a>
    <li><a href="#ref-for-readable-stream-reader-generic-release④">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-stream-reader-generic-release⑤">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-stream-reader-generic-release⑥">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readable-stream-reader-generic-release⑦">9.1.2. Reading</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-byob-reader-read">
   <b><a href="#readable-stream-byob-reader-read">#readable-stream-byob-reader-read</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-byob-reader-read">4.5.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-reader-read">
   <b><a href="#readable-stream-default-reader-read">#readable-stream-default-reader-read</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-reader-read">4.2.5. Asynchronous iteration</a>
    <li><a href="#ref-for-readable-stream-default-reader-read①">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readable-stream-default-reader-read②">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-readable-stream-default-reader-read③">9.1.2. Reading</a> <a href="#ref-for-readable-stream-default-reader-read④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-stream-byob-reader">
   <b><a href="#set-up-readable-stream-byob-reader">#set-up-readable-stream-byob-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-stream-byob-reader">4.5.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-set-up-readable-stream-byob-reader①">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-stream-default-reader">
   <b><a href="#set-up-readable-stream-default-reader">#set-up-readable-stream-default-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-stream-default-reader">4.4.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-set-up-readable-stream-default-reader①">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-call-pull-if-needed">
   <b><a href="#readable-stream-default-controller-call-pull-if-needed">#readable-stream-default-controller-call-pull-if-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-call-pull-if-needed">4.6.4. Internal methods</a> <a href="#ref-for-readable-stream-default-controller-call-pull-if-needed①">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-call-pull-if-needed②">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-default-controller-call-pull-if-needed③">(2)</a> <a href="#ref-for-readable-stream-default-controller-call-pull-if-needed④">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-should-call-pull">
   <b><a href="#readable-stream-default-controller-should-call-pull">#readable-stream-default-controller-should-call-pull</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-should-call-pull">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-default-controller-should-call-pull①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-clear-algorithms">
   <b><a href="#readable-stream-default-controller-clear-algorithms">#readable-stream-default-controller-clear-algorithms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-clear-algorithms">4.6.4. Internal methods</a> <a href="#ref-for-readable-stream-default-controller-clear-algorithms①">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-clear-algorithms②">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-default-controller-clear-algorithms③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-close">
   <b><a href="#readable-stream-default-controller-close">#readable-stream-default-controller-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-close">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-default-controller-close①">4.9.1. Working with readable streams</a> <a href="#ref-for-readable-stream-default-controller-close②">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-close③">6.4.2. Default controllers</a>
    <li><a href="#ref-for-readable-stream-default-controller-close④">6.4.3. Default sinks</a>
    <li><a href="#ref-for-readable-stream-default-controller-close⑤">8.2. Transferable streams</a>
    <li><a href="#ref-for-readable-stream-default-controller-close⑥">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-enqueue">
   <b><a href="#readable-stream-default-controller-enqueue">#readable-stream-default-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-enqueue">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-default-controller-enqueue①">4.9.1. Working with readable streams</a> <a href="#ref-for-readable-stream-default-controller-enqueue②">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-enqueue③">6.4.2. Default controllers</a>
    <li><a href="#ref-for-readable-stream-default-controller-enqueue④">8.2. Transferable streams</a>
    <li><a href="#ref-for-readable-stream-default-controller-enqueue⑤">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-error">
   <b><a href="#readable-stream-default-controller-error">#readable-stream-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-error">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-default-controller-error①">4.9.1. Working with readable streams</a> <a href="#ref-for-readable-stream-default-controller-error②">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-error③">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-default-controller-error④">(2)</a> <a href="#ref-for-readable-stream-default-controller-error⑤">(3)</a> <a href="#ref-for-readable-stream-default-controller-error⑥">(4)</a>
    <li><a href="#ref-for-readable-stream-default-controller-error⑦">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-readable-stream-default-controller-error⑧">8.2. Transferable streams</a> <a href="#ref-for-readable-stream-default-controller-error⑨">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-error①⓪">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-get-desired-size">
   <b><a href="#readable-stream-default-controller-get-desired-size">#readable-stream-default-controller-get-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-get-desired-size">4.6.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-default-controller-get-desired-size①">4.9.4. Default controllers</a>
    <li><a href="#ref-for-readable-stream-default-controller-get-desired-size②">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-readable-stream-default-controller-get-desired-size③">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rs-default-controller-has-backpressure">
   <b><a href="#rs-default-controller-has-backpressure">#rs-default-controller-has-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rs-default-controller-has-backpressure">6.4.2. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-stream-default-controller-can-close-or-enqueue">
   <b><a href="#readable-stream-default-controller-can-close-or-enqueue">#readable-stream-default-controller-can-close-or-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue">4.6.3. Methods and properties</a> <a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue①">(2)</a>
    <li><a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue②">4.9.4. Default controllers</a> <a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue③">(2)</a> <a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue④">(3)</a>
    <li><a href="#ref-for-readable-stream-default-controller-can-close-or-enqueue⑤">6.4.2. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-stream-default-controller">
   <b><a href="#set-up-readable-stream-default-controller">#set-up-readable-stream-default-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-stream-default-controller">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-set-up-readable-stream-default-controller①">4.9.4. Default controllers</a>
    <li><a href="#ref-for-set-up-readable-stream-default-controller②">8.2. Transferable streams</a>
    <li><a href="#ref-for-set-up-readable-stream-default-controller③">9.1.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-stream-default-controller-from-underlying-source">
   <b><a href="#set-up-readable-stream-default-controller-from-underlying-source">#set-up-readable-stream-default-controller-from-underlying-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-stream-default-controller-from-underlying-source">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-call-pull-if-needed">
   <b><a href="#readable-byte-stream-controller-call-pull-if-needed">#readable-byte-stream-controller-call-pull-if-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed②">(2)</a> <a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed③">(3)</a> <a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed④">(4)</a> <a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed⑤">(5)</a> <a href="#ref-for-readable-byte-stream-controller-call-pull-if-needed⑥">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-clear-algorithms">
   <b><a href="#readable-byte-stream-controller-clear-algorithms">#readable-byte-stream-controller-clear-algorithms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-clear-algorithms">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-byte-stream-controller-clear-algorithms①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-clear-algorithms②">(2)</a> <a href="#ref-for-readable-byte-stream-controller-clear-algorithms③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-clear-pending-pull-intos">
   <b><a href="#readable-byte-stream-controller-clear-pending-pull-intos">#readable-byte-stream-controller-clear-pending-pull-intos</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-clear-pending-pull-intos">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-close">
   <b><a href="#readable-byte-stream-controller-close">#readable-byte-stream-controller-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-close">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-commit-pull-into-descriptor">
   <b><a href="#readable-byte-stream-controller-commit-pull-into-descriptor">#readable-byte-stream-controller-commit-pull-into-descriptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-commit-pull-into-descriptor">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-commit-pull-into-descriptor①">(2)</a> <a href="#ref-for-readable-byte-stream-controller-commit-pull-into-descriptor②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-convert-pull-into-descriptor">
   <b><a href="#readable-byte-stream-controller-convert-pull-into-descriptor">#readable-byte-stream-controller-convert-pull-into-descriptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-convert-pull-into-descriptor">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-convert-pull-into-descriptor①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-enqueue">
   <b><a href="#readable-byte-stream-controller-enqueue">#readable-byte-stream-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-enqueue">4.7.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-enqueue-chunk-to-queue">
   <b><a href="#readable-byte-stream-controller-enqueue-chunk-to-queue">#readable-byte-stream-controller-enqueue-chunk-to-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue①">(2)</a> <a href="#ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue②">(3)</a> <a href="#ref-for-readable-byte-stream-controller-enqueue-chunk-to-queue③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-error">
   <b><a href="#readable-byte-stream-controller-error">#readable-byte-stream-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-error">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-readable-byte-stream-controller-error①">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-error②">(2)</a> <a href="#ref-for-readable-byte-stream-controller-error③">(3)</a> <a href="#ref-for-readable-byte-stream-controller-error④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-fill-head-pull-into-descriptor">
   <b><a href="#readable-byte-stream-controller-fill-head-pull-into-descriptor">#readable-byte-stream-controller-fill-head-pull-into-descriptor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-fill-head-pull-into-descriptor">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-fill-head-pull-into-descriptor①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">
   <b><a href="#readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">#readable-byte-stream-controller-fill-pull-into-descriptor-from-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-fill-pull-into-descriptor-from-queue">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-fill-pull-into-descriptor-from-queue①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-get-desired-size">
   <b><a href="#readable-byte-stream-controller-get-desired-size">#readable-byte-stream-controller-get-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-get-desired-size">4.7.3. Methods and properties</a>
    <li><a href="#ref-for-readable-byte-stream-controller-get-desired-size①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-handle-queue-drain">
   <b><a href="#readable-byte-stream-controller-handle-queue-drain">#readable-byte-stream-controller-handle-queue-drain</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-handle-queue-drain">4.7.4. Internal methods</a>
    <li><a href="#ref-for-readable-byte-stream-controller-handle-queue-drain①">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-invalidate-byob-request">
   <b><a href="#readable-byte-stream-controller-invalidate-byob-request">#readable-byte-stream-controller-invalidate-byob-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-invalidate-byob-request">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-invalidate-byob-request①">(2)</a> <a href="#ref-for-readable-byte-stream-controller-invalidate-byob-request②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-process-pull-into-descriptors-using-queue">
   <b><a href="#readable-byte-stream-controller-process-pull-into-descriptors-using-queue">#readable-byte-stream-controller-process-pull-into-descriptors-using-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-process-pull-into-descriptors-using-queue">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-process-pull-into-descriptors-using-queue①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-pull-into">
   <b><a href="#readable-byte-stream-controller-pull-into">#readable-byte-stream-controller-pull-into</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-pull-into">4.9.3. Readers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-respond">
   <b><a href="#readable-byte-stream-controller-respond">#readable-byte-stream-controller-respond</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-respond">4.8.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-respond-in-closed-state">
   <b><a href="#readable-byte-stream-controller-respond-in-closed-state">#readable-byte-stream-controller-respond-in-closed-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-respond-in-closed-state">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-respond-in-readable-state">
   <b><a href="#readable-byte-stream-controller-respond-in-readable-state">#readable-byte-stream-controller-respond-in-readable-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-respond-in-readable-state">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-respond-internal">
   <b><a href="#readable-byte-stream-controller-respond-internal">#readable-byte-stream-controller-respond-internal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-respond-internal">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-respond-internal①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-respond-with-new-view">
   <b><a href="#readable-byte-stream-controller-respond-with-new-view">#readable-byte-stream-controller-respond-with-new-view</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-respond-with-new-view">4.8.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-shift-pending-pull-into">
   <b><a href="#readable-byte-stream-controller-shift-pending-pull-into">#readable-byte-stream-controller-shift-pending-pull-into</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-shift-pending-pull-into">4.9.5. Byte stream controllers</a> <a href="#ref-for-readable-byte-stream-controller-shift-pending-pull-into①">(2)</a> <a href="#ref-for-readable-byte-stream-controller-shift-pending-pull-into②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readable-byte-stream-controller-should-call-pull">
   <b><a href="#readable-byte-stream-controller-should-call-pull">#readable-byte-stream-controller-should-call-pull</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readable-byte-stream-controller-should-call-pull">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-byte-stream-controller">
   <b><a href="#set-up-readable-byte-stream-controller">#set-up-readable-byte-stream-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-byte-stream-controller">4.9.5. Byte stream controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-readable-byte-stream-controller-from-underlying-source">
   <b><a href="#set-up-readable-byte-stream-controller-from-underlying-source">#set-up-readable-byte-stream-controller-from-underlying-source</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-readable-byte-stream-controller-from-underlying-source">4.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream">
   <b><a href="#writablestream">#writablestream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream">2.2. Writable streams</a>
    <li><a href="#ref-for-writablestream①">4.2.1. Interface definition</a> <a href="#ref-for-writablestream②">(2)</a>
    <li><a href="#ref-for-writablestream③">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestream④">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-writablestream⑤">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-writablestream⑥">5.2. The WritableStream class</a> <a href="#ref-for-writablestream⑦">(2)</a>
    <li><a href="#ref-for-writablestream⑧">5.2.1. Interface definition</a>
    <li><a href="#ref-for-writablestream⑨">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream①⓪">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-writablestream①①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestream①②">5.2.5. Transfer via postMessage()</a> <a href="#ref-for-writablestream①③">(2)</a>
    <li><a href="#ref-for-writablestream①④">5.3. The WritableStreamDefaultWriter class</a>
    <li><a href="#ref-for-writablestream①⑤">5.3.1. Interface definition</a>
    <li><a href="#ref-for-writablestream①⑥">5.3.2. Internal slots</a>
    <li><a href="#ref-for-writablestream①⑦">5.4. The WritableStreamDefaultController class</a> <a href="#ref-for-writablestream①⑧">(2)</a>
    <li><a href="#ref-for-writablestream①⑨">5.4.2. Internal slots</a>
    <li><a href="#ref-for-writablestream②⓪">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream②①">(2)</a>
    <li><a href="#ref-for-writablestream②②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream②③">(2)</a> <a href="#ref-for-writablestream②④">(3)</a> <a href="#ref-for-writablestream②⑤">(4)</a>
    <li><a href="#ref-for-writablestream②⑥">5.5.4. Default controllers</a> <a href="#ref-for-writablestream②⑦">(2)</a>
    <li><a href="#ref-for-writablestream②⑧">6.2.1. Interface definition</a>
    <li><a href="#ref-for-writablestream②⑨">6.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream③⓪">6.2.4. Constructor and properties</a> <a href="#ref-for-writablestream③①">(2)</a>
    <li><a href="#ref-for-writablestream③②">6.3. The TransformStreamDefaultController class</a>
    <li><a href="#ref-for-writablestream③③">9.2.1. Creation</a> <a href="#ref-for-writablestream③④">(2)</a> <a href="#ref-for-writablestream③⑤">(3)</a> <a href="#ref-for-writablestream③⑥">(4)</a>
    <li><a href="#ref-for-writablestream③⑦">9.2.2. Writing</a> <a href="#ref-for-writablestream③⑧">(2)</a> <a href="#ref-for-writablestream③⑨">(3)</a> <a href="#ref-for-writablestream④⓪">(4)</a>
    <li><a href="#ref-for-writablestream④①">9.3.2. Wrapping into a custom class</a>
    <li><a href="#ref-for-writablestream④②">9.5. Piping</a>
    <li><a href="#ref-for-writablestream④③">10. Examples of creating streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-backpressure">
   <b><a href="#writablestream-backpressure">#writablestream-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-backpressure">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-backpressure①">(2)</a> <a href="#ref-for-writablestream-backpressure②">(3)</a>
    <li><a href="#ref-for-writablestream-backpressure③">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-backpressure④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-closerequest">
   <b><a href="#writablestream-closerequest">#writablestream-closerequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-closerequest">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream-closerequest①">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-closerequest②">(2)</a>
    <li><a href="#ref-for-writablestream-closerequest③">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-closerequest④">(2)</a> <a href="#ref-for-writablestream-closerequest⑤">(3)</a> <a href="#ref-for-writablestream-closerequest⑥">(4)</a> <a href="#ref-for-writablestream-closerequest⑦">(5)</a> <a href="#ref-for-writablestream-closerequest⑧">(6)</a> <a href="#ref-for-writablestream-closerequest⑨">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-controller">
   <b><a href="#writablestream-controller">#writablestream-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-controller">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-controller①">(2)</a>
    <li><a href="#ref-for-writablestream-controller②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-controller③">(2)</a> <a href="#ref-for-writablestream-controller④">(3)</a> <a href="#ref-for-writablestream-controller⑤">(4)</a>
    <li><a href="#ref-for-writablestream-controller⑥">5.5.3. Writers</a> <a href="#ref-for-writablestream-controller⑦">(2)</a>
    <li><a href="#ref-for-writablestream-controller⑧">5.5.4. Default controllers</a> <a href="#ref-for-writablestream-controller⑨">(2)</a>
    <li><a href="#ref-for-writablestream-controller①⓪">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-inflightwriterequest">
   <b><a href="#writablestream-inflightwriterequest">#writablestream-inflightwriterequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-inflightwriterequest">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream-inflightwriterequest①">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestream-inflightwriterequest②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-inflightwriterequest③">(2)</a> <a href="#ref-for-writablestream-inflightwriterequest④">(3)</a> <a href="#ref-for-writablestream-inflightwriterequest⑤">(4)</a> <a href="#ref-for-writablestream-inflightwriterequest⑥">(5)</a> <a href="#ref-for-writablestream-inflightwriterequest⑦">(6)</a> <a href="#ref-for-writablestream-inflightwriterequest⑧">(7)</a> <a href="#ref-for-writablestream-inflightwriterequest⑨">(8)</a> <a href="#ref-for-writablestream-inflightwriterequest①⓪">(9)</a>
    <li><a href="#ref-for-writablestream-inflightwriterequest①①">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-inflightcloserequest">
   <b><a href="#writablestream-inflightcloserequest">#writablestream-inflightcloserequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-inflightcloserequest">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream-inflightcloserequest①">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestream-inflightcloserequest②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-inflightcloserequest③">(2)</a> <a href="#ref-for-writablestream-inflightcloserequest④">(3)</a> <a href="#ref-for-writablestream-inflightcloserequest⑤">(4)</a> <a href="#ref-for-writablestream-inflightcloserequest⑥">(5)</a> <a href="#ref-for-writablestream-inflightcloserequest⑦">(6)</a> <a href="#ref-for-writablestream-inflightcloserequest⑧">(7)</a> <a href="#ref-for-writablestream-inflightcloserequest⑨">(8)</a> <a href="#ref-for-writablestream-inflightcloserequest①⓪">(9)</a> <a href="#ref-for-writablestream-inflightcloserequest①①">(10)</a> <a href="#ref-for-writablestream-inflightcloserequest①②">(11)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-pendingabortrequest">
   <b><a href="#writablestream-pendingabortrequest">#writablestream-pendingabortrequest</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-pendingabortrequest">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-pendingabortrequest①">(2)</a> <a href="#ref-for-writablestream-pendingabortrequest②">(3)</a> <a href="#ref-for-writablestream-pendingabortrequest③">(4)</a>
    <li><a href="#ref-for-writablestream-pendingabortrequest④">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-pendingabortrequest⑤">(2)</a> <a href="#ref-for-writablestream-pendingabortrequest⑥">(3)</a> <a href="#ref-for-writablestream-pendingabortrequest⑦">(4)</a> <a href="#ref-for-writablestream-pendingabortrequest⑧">(5)</a> <a href="#ref-for-writablestream-pendingabortrequest⑨">(6)</a> <a href="#ref-for-writablestream-pendingabortrequest①⓪">(7)</a> <a href="#ref-for-writablestream-pendingabortrequest①①">(8)</a> <a href="#ref-for-writablestream-pendingabortrequest①②">(9)</a> <a href="#ref-for-writablestream-pendingabortrequest①③">(10)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-state">
   <b><a href="#writablestream-state">#writablestream-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-state">4.9.1. Working with readable streams</a> <a href="#ref-for-writablestream-state①">(2)</a> <a href="#ref-for-writablestream-state②">(3)</a> <a href="#ref-for-writablestream-state③">(4)</a> <a href="#ref-for-writablestream-state④">(5)</a>
    <li><a href="#ref-for-writablestream-state⑤">5.4.3. Methods</a>
    <li><a href="#ref-for-writablestream-state⑥">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-state⑦">(2)</a> <a href="#ref-for-writablestream-state⑧">(3)</a> <a href="#ref-for-writablestream-state⑨">(4)</a>
    <li><a href="#ref-for-writablestream-state①⓪">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-state①①">(2)</a> <a href="#ref-for-writablestream-state①②">(3)</a> <a href="#ref-for-writablestream-state①③">(4)</a> <a href="#ref-for-writablestream-state①④">(5)</a> <a href="#ref-for-writablestream-state①⑤">(6)</a> <a href="#ref-for-writablestream-state①⑥">(7)</a> <a href="#ref-for-writablestream-state①⑦">(8)</a> <a href="#ref-for-writablestream-state①⑧">(9)</a> <a href="#ref-for-writablestream-state①⑨">(10)</a> <a href="#ref-for-writablestream-state②⓪">(11)</a> <a href="#ref-for-writablestream-state②①">(12)</a> <a href="#ref-for-writablestream-state②②">(13)</a>
    <li><a href="#ref-for-writablestream-state②③">5.5.3. Writers</a> <a href="#ref-for-writablestream-state②④">(2)</a> <a href="#ref-for-writablestream-state②⑤">(3)</a>
    <li><a href="#ref-for-writablestream-state②⑥">5.5.4. Default controllers</a> <a href="#ref-for-writablestream-state②⑦">(2)</a> <a href="#ref-for-writablestream-state②⑧">(3)</a> <a href="#ref-for-writablestream-state②⑨">(4)</a> <a href="#ref-for-writablestream-state③⓪">(5)</a> <a href="#ref-for-writablestream-state③①">(6)</a> <a href="#ref-for-writablestream-state③②">(7)</a> <a href="#ref-for-writablestream-state③③">(8)</a>
    <li><a href="#ref-for-writablestream-state③④">6.4.3. Default sinks</a> <a href="#ref-for-writablestream-state③⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-storederror">
   <b><a href="#writablestream-storederror">#writablestream-storederror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-storederror">4.9.1. Working with readable streams</a> <a href="#ref-for-writablestream-storederror①">(2)</a> <a href="#ref-for-writablestream-storederror②">(3)</a>
    <li><a href="#ref-for-writablestream-storederror③">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-storederror④">(2)</a> <a href="#ref-for-writablestream-storederror⑤">(3)</a>
    <li><a href="#ref-for-writablestream-storederror⑥">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-storederror⑦">(2)</a> <a href="#ref-for-writablestream-storederror⑧">(3)</a> <a href="#ref-for-writablestream-storederror⑨">(4)</a> <a href="#ref-for-writablestream-storederror①⓪">(5)</a> <a href="#ref-for-writablestream-storederror①①">(6)</a> <a href="#ref-for-writablestream-storederror①②">(7)</a>
    <li><a href="#ref-for-writablestream-storederror①③">5.5.3. Writers</a> <a href="#ref-for-writablestream-storederror①④">(2)</a> <a href="#ref-for-writablestream-storederror①⑤">(3)</a>
    <li><a href="#ref-for-writablestream-storederror①⑥">6.4.3. Default sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-writer">
   <b><a href="#writablestream-writer">#writablestream-writer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-writer">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestream-writer①">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestream-writer②">(2)</a> <a href="#ref-for-writablestream-writer③">(3)</a> <a href="#ref-for-writablestream-writer④">(4)</a>
    <li><a href="#ref-for-writablestream-writer⑤">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-writer⑥">(2)</a> <a href="#ref-for-writablestream-writer⑦">(3)</a> <a href="#ref-for-writablestream-writer⑧">(4)</a>
    <li><a href="#ref-for-writablestream-writer⑨">5.5.3. Writers</a> <a href="#ref-for-writablestream-writer①⓪">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-writerequests">
   <b><a href="#writablestream-writerequests">#writablestream-writerequests</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-writerequests">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestream-writerequests①">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestream-writerequests②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestream-writerequests③">(2)</a> <a href="#ref-for-writablestream-writerequests④">(3)</a> <a href="#ref-for-writablestream-writerequests⑤">(4)</a> <a href="#ref-for-writablestream-writerequests⑥">(5)</a> <a href="#ref-for-writablestream-writerequests⑦">(6)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pending-abort-request">
   <b><a href="#pending-abort-request">#pending-abort-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pending-abort-request">5.2.2. Internal slots</a>
    <li><a href="#ref-for-pending-abort-request①">5.5.1. Working with writable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pending-abort-request-promise">
   <b><a href="#pending-abort-request-promise">#pending-abort-request-promise</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pending-abort-request-promise">5.5.1. Working with writable streams</a> <a href="#ref-for-pending-abort-request-promise①">(2)</a>
    <li><a href="#ref-for-pending-abort-request-promise②">5.5.2. Interfacing with controllers</a> <a href="#ref-for-pending-abort-request-promise③">(2)</a> <a href="#ref-for-pending-abort-request-promise④">(3)</a> <a href="#ref-for-pending-abort-request-promise⑤">(4)</a> <a href="#ref-for-pending-abort-request-promise⑥">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pending-abort-request-reason">
   <b><a href="#pending-abort-request-reason">#pending-abort-request-reason</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pending-abort-request-reason">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-pending-abort-request-reason①">5.5.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="pending-abort-request-was-already-erroring">
   <b><a href="#pending-abort-request-was-already-erroring">#pending-abort-request-was-already-erroring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-pending-abort-request-was-already-erroring">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-pending-abort-request-was-already-erroring①">5.5.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-underlyingsink">
   <b><a href="#dictdef-underlyingsink">#dictdef-underlyingsink</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-underlyingsink">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-dictdef-underlyingsink①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsinkstartcallback">
   <b><a href="#callbackdef-underlyingsinkstartcallback">#callbackdef-underlyingsinkstartcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsinkstartcallback">5.2.3. The underlying sink API</a> <a href="#ref-for-callbackdef-underlyingsinkstartcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsinkwritecallback">
   <b><a href="#callbackdef-underlyingsinkwritecallback">#callbackdef-underlyingsinkwritecallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsinkwritecallback">5.2.3. The underlying sink API</a> <a href="#ref-for-callbackdef-underlyingsinkwritecallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsinkclosecallback">
   <b><a href="#callbackdef-underlyingsinkclosecallback">#callbackdef-underlyingsinkclosecallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsinkclosecallback">5.2.3. The underlying sink API</a> <a href="#ref-for-callbackdef-underlyingsinkclosecallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-underlyingsinkabortcallback">
   <b><a href="#callbackdef-underlyingsinkabortcallback">#callbackdef-underlyingsinkabortcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-underlyingsinkabortcallback">5.2.3. The underlying sink API</a> <a href="#ref-for-callbackdef-underlyingsinkabortcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsink-start">
   <b><a href="#dom-underlyingsink-start">#dom-underlyingsink-start</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsink-start">5.2.3. The underlying sink API</a> <a href="#ref-for-dom-underlyingsink-start①">(2)</a> <a href="#ref-for-dom-underlyingsink-start②">(3)</a>
    <li><a href="#ref-for-dom-underlyingsink-start③">5.5.4. Default controllers</a> <a href="#ref-for-dom-underlyingsink-start④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsink-write">
   <b><a href="#dom-underlyingsink-write">#dom-underlyingsink-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsink-write">4.1. Using readable streams</a>
    <li><a href="#ref-for-dom-underlyingsink-write①">5.2.3. The underlying sink API</a> <a href="#ref-for-dom-underlyingsink-write②">(2)</a>
    <li><a href="#ref-for-dom-underlyingsink-write③">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-dom-underlyingsink-write④">5.5.4. Default controllers</a> <a href="#ref-for-dom-underlyingsink-write⑤">(2)</a>
    <li><a href="#ref-for-dom-underlyingsink-write⑥">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsink-close">
   <b><a href="#dom-underlyingsink-close">#dom-underlyingsink-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsink-close">5.2.3. The underlying sink API</a> <a href="#ref-for-dom-underlyingsink-close①">(2)</a> <a href="#ref-for-dom-underlyingsink-close②">(3)</a>
    <li><a href="#ref-for-dom-underlyingsink-close③">5.5.4. Default controllers</a> <a href="#ref-for-dom-underlyingsink-close④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsink-abort">
   <b><a href="#dom-underlyingsink-abort">#dom-underlyingsink-abort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsink-abort">5.2.3. The underlying sink API</a> <a href="#ref-for-dom-underlyingsink-abort①">(2)</a>
    <li><a href="#ref-for-dom-underlyingsink-abort②">5.5.4. Default controllers</a> <a href="#ref-for-dom-underlyingsink-abort③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-underlyingsink-type">
   <b><a href="#dom-underlyingsink-type">#dom-underlyingsink-type</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-underlyingsink-type">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-dom-underlyingsink-type①">5.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-constructor">
   <b><a href="#ws-constructor">#ws-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-constructor">2.2. Writable streams</a>
    <li><a href="#ref-for-ws-constructor①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-ws-constructor②">5.2.3. The underlying sink API</a> <a href="#ref-for-ws-constructor③">(2)</a>
    <li><a href="#ref-for-ws-constructor④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-ws-constructor⑤">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-locked">
   <b><a href="#ws-locked">#ws-locked</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-locked">2.6. Locking</a>
    <li><a href="#ref-for-ws-locked①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-ws-locked②">5.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-abort">
   <b><a href="#ws-abort">#ws-abort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-abort">2.2. Writable streams</a>
    <li><a href="#ref-for-ws-abort①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-ws-abort②">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-ws-abort③">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-ws-abort④">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-ws-abort⑤">10.11. Using an identity transform stream as a primitive to
create new readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-close">
   <b><a href="#ws-close">#ws-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-close">5.2.1. Interface definition</a>
    <li><a href="#ref-for-ws-close①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-ws-close②">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-get-writer">
   <b><a href="#ws-get-writer">#ws-get-writer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-get-writer">5.2.1. Interface definition</a>
    <li><a href="#ref-for-ws-get-writer①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-ws-get-writer②">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultwriter">
   <b><a href="#writablestreamdefaultwriter">#writablestreamdefaultwriter</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultwriter">2.6. Locking</a>
    <li><a href="#ref-for-writablestreamdefaultwriter①">5.1. Using writable streams</a>
    <li><a href="#ref-for-writablestreamdefaultwriter②">5.2.1. Interface definition</a>
    <li><a href="#ref-for-writablestreamdefaultwriter③">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestreamdefaultwriter④">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestreamdefaultwriter⑤">5.3. The WritableStreamDefaultWriter class</a> <a href="#ref-for-writablestreamdefaultwriter⑥">(2)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter⑦">5.3.1. Interface definition</a>
    <li><a href="#ref-for-writablestreamdefaultwriter⑧">5.3.2. Internal slots</a>
    <li><a href="#ref-for-writablestreamdefaultwriter⑨">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestreamdefaultwriter①⓪">5.5.3. Writers</a>
    <li><a href="#ref-for-writablestreamdefaultwriter①①">9.2.2. Writing</a> <a href="#ref-for-writablestreamdefaultwriter①②">(2)</a> <a href="#ref-for-writablestreamdefaultwriter①③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultwriter-closedpromise">
   <b><a href="#writablestreamdefaultwriter-closedpromise">#writablestreamdefaultwriter-closedpromise</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultwriter-closedpromise">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-closedpromise①">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise②">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise③">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise④">(4)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise⑤">(5)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-closedpromise⑥">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise⑦">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise⑧">(3)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-closedpromise⑨">5.5.3. Writers</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise①⓪">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise①①">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-closedpromise①②">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultwriter-readypromise">
   <b><a href="#writablestreamdefaultwriter-readypromise">#writablestreamdefaultwriter-readypromise</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultwriter-readypromise">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-readypromise①">5.5.1. Working with writable streams</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise②">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise③">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise④">(4)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise⑤">(5)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise⑥">(6)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise⑦">(7)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise⑧">(8)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-readypromise⑨">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise①⓪">(2)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-readypromise①①">5.5.3. Writers</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise①②">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise①③">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-readypromise①④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultwriter-stream">
   <b><a href="#writablestreamdefaultwriter-stream">#writablestreamdefaultwriter-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultwriter-stream">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-writablestreamdefaultwriter-stream①">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-stream②">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-stream③">(4)</a> <a href="#ref-for-writablestreamdefaultwriter-stream④">(5)</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-stream⑤">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestreamdefaultwriter-stream⑥">5.5.3. Writers</a> <a href="#ref-for-writablestreamdefaultwriter-stream⑦">(2)</a> <a href="#ref-for-writablestreamdefaultwriter-stream⑧">(3)</a> <a href="#ref-for-writablestreamdefaultwriter-stream⑨">(4)</a> <a href="#ref-for-writablestreamdefaultwriter-stream①⓪">(5)</a> <a href="#ref-for-writablestreamdefaultwriter-stream①①">(6)</a> <a href="#ref-for-writablestreamdefaultwriter-stream①②">(7)</a> <a href="#ref-for-writablestreamdefaultwriter-stream①③">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-constructor">
   <b><a href="#default-writer-constructor">#default-writer-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-constructor">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-constructor①">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-closed">
   <b><a href="#default-writer-closed">#default-writer-closed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-closed">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-closed①">5.3.2. Internal slots</a>
    <li><a href="#ref-for-default-writer-closed②">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-desired-size">
   <b><a href="#default-writer-desired-size">#default-writer-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-desired-size">2.4. Pipe chains and backpressure</a>
    <li><a href="#ref-for-default-writer-desired-size①">5.1. Using writable streams</a> <a href="#ref-for-default-writer-desired-size②">(2)</a> <a href="#ref-for-default-writer-desired-size③">(3)</a>
    <li><a href="#ref-for-default-writer-desired-size④">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-default-writer-desired-size⑤">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-desired-size⑥">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-default-writer-desired-size⑦">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-ready">
   <b><a href="#default-writer-ready">#default-writer-ready</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-ready">5.1. Using writable streams</a> <a href="#ref-for-default-writer-ready①">(2)</a> <a href="#ref-for-default-writer-ready②">(3)</a> <a href="#ref-for-default-writer-ready③">(4)</a> <a href="#ref-for-default-writer-ready④">(5)</a> <a href="#ref-for-default-writer-ready⑤">(6)</a> <a href="#ref-for-default-writer-ready⑥">(7)</a>
    <li><a href="#ref-for-default-writer-ready⑦">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-ready⑧">5.3.2. Internal slots</a>
    <li><a href="#ref-for-default-writer-ready⑨">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-default-writer-ready①⓪">10.6. A writable stream with no backpressure or success signals</a>
    <li><a href="#ref-for-default-writer-ready①①">10.7. A writable stream with backpressure and success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-abort">
   <b><a href="#default-writer-abort">#default-writer-abort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-abort">5.2.2. Internal slots</a>
    <li><a href="#ref-for-default-writer-abort①">5.2.3. The underlying sink API</a> <a href="#ref-for-default-writer-abort②">(2)</a>
    <li><a href="#ref-for-default-writer-abort③">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-abort④">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-close">
   <b><a href="#default-writer-close">#default-writer-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-close">5.1. Using writable streams</a> <a href="#ref-for-default-writer-close①">(2)</a> <a href="#ref-for-default-writer-close②">(3)</a>
    <li><a href="#ref-for-default-writer-close③">5.2.2. Internal slots</a>
    <li><a href="#ref-for-default-writer-close④">5.2.3. The underlying sink API</a> <a href="#ref-for-default-writer-close⑤">(2)</a>
    <li><a href="#ref-for-default-writer-close⑥">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-close⑦">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-release-lock">
   <b><a href="#default-writer-release-lock">#default-writer-release-lock</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-release-lock">2.6. Locking</a>
    <li><a href="#ref-for-default-writer-release-lock①">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-release-lock②">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="default-writer-write">
   <b><a href="#default-writer-write">#default-writer-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-default-writer-write">5.1. Using writable streams</a> <a href="#ref-for-default-writer-write①">(2)</a> <a href="#ref-for-default-writer-write②">(3)</a> <a href="#ref-for-default-writer-write③">(4)</a> <a href="#ref-for-default-writer-write④">(5)</a> <a href="#ref-for-default-writer-write⑤">(6)</a> <a href="#ref-for-default-writer-write⑥">(7)</a> <a href="#ref-for-default-writer-write⑦">(8)</a> <a href="#ref-for-default-writer-write⑧">(9)</a>
    <li><a href="#ref-for-default-writer-write⑨">5.2.3. The underlying sink API</a>
    <li><a href="#ref-for-default-writer-write①⓪">5.3.1. Interface definition</a>
    <li><a href="#ref-for-default-writer-write①①">5.3.3. Constructor, methods, and properties</a> <a href="#ref-for-default-writer-write①②">(2)</a>
    <li><a href="#ref-for-default-writer-write①③">6.2.3. The transformer API</a>
    <li><a href="#ref-for-default-writer-write①④">10.6. A writable stream with no backpressure or success signals</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller">
   <b><a href="#writablestreamdefaultcontroller">#writablestreamdefaultcontroller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller">5.2.2. Internal slots</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①">5.2.3. The underlying sink API</a> <a href="#ref-for-writablestreamdefaultcontroller②">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller③">(3)</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller④">5.4. The WritableStreamDefaultController class</a> <a href="#ref-for-writablestreamdefaultcontroller⑤">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller⑥">(3)</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller⑦">5.4.1. Interface definition</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller⑧">5.4.2. Internal slots</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller⑨">5.4.4. Internal methods</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①⓪">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①①">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writablestreamdefaultcontroller①②">(2)</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①③">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller①④">(2)</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①⑤">8.2. Transferable streams</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller①⑥">9.2.1. Creation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-abortalgorithm">
   <b><a href="#writablestreamdefaultcontroller-abortalgorithm">#writablestreamdefaultcontroller-abortalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-abortalgorithm">5.4.4. Internal methods</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller-abortalgorithm①">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-abortalgorithm②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-closealgorithm">
   <b><a href="#writablestreamdefaultcontroller-closealgorithm">#writablestreamdefaultcontroller-closealgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-closealgorithm">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-closealgorithm①">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller-closealgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-queue">
   <b><a href="#writablestreamdefaultcontroller-queue">#writablestreamdefaultcontroller-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-queue">5.4.2. Internal slots</a> <a href="#ref-for-writablestreamdefaultcontroller-queue①">(2)</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller-queue②">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-queue③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-queuetotalsize">
   <b><a href="#writablestreamdefaultcontroller-queuetotalsize">#writablestreamdefaultcontroller-queuetotalsize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-queuetotalsize">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-started">
   <b><a href="#writablestreamdefaultcontroller-started">#writablestreamdefaultcontroller-started</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-started">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller-started①">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-started②">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller-started③">(3)</a> <a href="#ref-for-writablestreamdefaultcontroller-started④">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-strategyhwm">
   <b><a href="#writablestreamdefaultcontroller-strategyhwm">#writablestreamdefaultcontroller-strategyhwm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-strategyhwm">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-strategyhwm①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-strategysizealgorithm">
   <b><a href="#writablestreamdefaultcontroller-strategysizealgorithm">#writablestreamdefaultcontroller-strategysizealgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-strategysizealgorithm">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-strategysizealgorithm①">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller-strategysizealgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-stream">
   <b><a href="#writablestreamdefaultcontroller-stream">#writablestreamdefaultcontroller-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-stream">5.4.3. Methods</a>
    <li><a href="#ref-for-writablestreamdefaultcontroller-stream①">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-stream②">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller-stream③">(3)</a> <a href="#ref-for-writablestreamdefaultcontroller-stream④">(4)</a> <a href="#ref-for-writablestreamdefaultcontroller-stream⑤">(5)</a> <a href="#ref-for-writablestreamdefaultcontroller-stream⑥">(6)</a> <a href="#ref-for-writablestreamdefaultcontroller-stream⑦">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestreamdefaultcontroller-writealgorithm">
   <b><a href="#writablestreamdefaultcontroller-writealgorithm">#writablestreamdefaultcontroller-writealgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestreamdefaultcontroller-writealgorithm">5.5.4. Default controllers</a> <a href="#ref-for-writablestreamdefaultcontroller-writealgorithm①">(2)</a> <a href="#ref-for-writablestreamdefaultcontroller-writealgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="close-sentinel">
   <b><a href="#close-sentinel">#close-sentinel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-close-sentinel">5.5.4. Default controllers</a> <a href="#ref-for-close-sentinel①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ws-default-controller-error">
   <b><a href="#ws-default-controller-error">#ws-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ws-default-controller-error">5.4.1. Interface definition</a>
    <li><a href="#ref-for-ws-default-controller-error①">5.4.3. Methods</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="acquire-writable-stream-default-writer">
   <b><a href="#acquire-writable-stream-default-writer">#acquire-writable-stream-default-writer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-acquire-writable-stream-default-writer">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-acquire-writable-stream-default-writer①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-acquire-writable-stream-default-writer②">9.2.2. Writing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-writable-stream">
   <b><a href="#create-writable-stream">#create-writable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-writable-stream">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="initialize-writable-stream">
   <b><a href="#initialize-writable-stream">#initialize-writable-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initialize-writable-stream">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-initialize-writable-stream①">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-initialize-writable-stream②">8.2. Transferable streams</a>
    <li><a href="#ref-for-initialize-writable-stream③">9.2.1. Creation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="is-writable-stream-locked">
   <b><a href="#is-writable-stream-locked">#is-writable-stream-locked</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-is-writable-stream-locked">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-is-writable-stream-locked①">(2)</a>
    <li><a href="#ref-for-is-writable-stream-locked②">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-is-writable-stream-locked③">5.2.4. Constructor, methods, and properties</a> <a href="#ref-for-is-writable-stream-locked④">(2)</a> <a href="#ref-for-is-writable-stream-locked⑤">(3)</a>
    <li><a href="#ref-for-is-writable-stream-locked⑥">5.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-is-writable-stream-locked⑦">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-is-writable-stream-locked⑧">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-is-writable-stream-locked⑨">6.2.5. Transfer via postMessage()</a>
    <li><a href="#ref-for-is-writable-stream-locked①⓪">9.5. Piping</a> <a href="#ref-for-is-writable-stream-locked①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-writable-stream-default-writer">
   <b><a href="#set-up-writable-stream-default-writer">#set-up-writable-stream-default-writer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-writable-stream-default-writer">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-set-up-writable-stream-default-writer①">5.5.1. Working with writable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-abort">
   <b><a href="#writable-stream-abort">#writable-stream-abort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-abort">4.9.1. Working with readable streams</a> <a href="#ref-for-writable-stream-abort①">(2)</a>
    <li><a href="#ref-for-writable-stream-abort②">5.2.2. Internal slots</a> <a href="#ref-for-writable-stream-abort③">(2)</a> <a href="#ref-for-writable-stream-abort④">(3)</a>
    <li><a href="#ref-for-writable-stream-abort⑤">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-abort⑥">5.5.3. Writers</a>
    <li><a href="#ref-for-writable-stream-abort⑦">9.2.2. Writing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-close">
   <b><a href="#writable-stream-close">#writable-stream-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-close">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-close①">5.5.3. Writers</a>
    <li><a href="#ref-for-writable-stream-close②">9.2.2. Writing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-writablestreamcontroller-abortsteps">
   <b><a href="#abstract-opdef-writablestreamcontroller-abortsteps">#abstract-opdef-writablestreamcontroller-abortsteps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-writablestreamcontroller-abortsteps">5.4.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-writablestreamcontroller-abortsteps①">5.5.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-writablestreamcontroller-errorsteps">
   <b><a href="#abstract-opdef-writablestreamcontroller-errorsteps">#abstract-opdef-writablestreamcontroller-errorsteps</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-writablestreamcontroller-errorsteps">5.4.4. Internal methods</a>
    <li><a href="#ref-for-abstract-opdef-writablestreamcontroller-errorsteps①">5.5.2. Interfacing with controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-add-write-request">
   <b><a href="#writable-stream-add-write-request">#writable-stream-add-write-request</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-add-write-request">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-close-queued-or-in-flight">
   <b><a href="#writable-stream-close-queued-or-in-flight">#writable-stream-close-queued-or-in-flight</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight">4.9.1. Working with readable streams</a> <a href="#ref-for-writable-stream-close-queued-or-in-flight①">(2)</a> <a href="#ref-for-writable-stream-close-queued-or-in-flight②">(3)</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight③">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight④">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight⑤">5.5.1. Working with writable streams</a> <a href="#ref-for-writable-stream-close-queued-or-in-flight⑥">(2)</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight⑦">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight⑧">5.5.3. Writers</a> <a href="#ref-for-writable-stream-close-queued-or-in-flight⑨">(2)</a>
    <li><a href="#ref-for-writable-stream-close-queued-or-in-flight①⓪">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-close-queued-or-in-flight①①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-deal-with-rejection">
   <b><a href="#writable-stream-deal-with-rejection">#writable-stream-deal-with-rejection</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-deal-with-rejection">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writable-stream-deal-with-rejection①">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-finish-erroring">
   <b><a href="#writable-stream-finish-erroring">#writable-stream-finish-erroring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-finish-erroring">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writable-stream-finish-erroring①">(2)</a>
    <li><a href="#ref-for-writable-stream-finish-erroring②">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-finish-in-flight-close">
   <b><a href="#writable-stream-finish-in-flight-close">#writable-stream-finish-in-flight-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-finish-in-flight-close">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-finish-in-flight-close-with-error">
   <b><a href="#writable-stream-finish-in-flight-close-with-error">#writable-stream-finish-in-flight-close-with-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-finish-in-flight-close-with-error">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-finish-in-flight-write">
   <b><a href="#writable-stream-finish-in-flight-write">#writable-stream-finish-in-flight-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-finish-in-flight-write">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-finish-in-flight-write-with-error">
   <b><a href="#writable-stream-finish-in-flight-write-with-error">#writable-stream-finish-in-flight-write-with-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-finish-in-flight-write-with-error">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-has-operation-marked-in-flight">
   <b><a href="#writable-stream-has-operation-marked-in-flight">#writable-stream-has-operation-marked-in-flight</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-has-operation-marked-in-flight">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writable-stream-has-operation-marked-in-flight①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-mark-close-request-in-flight">
   <b><a href="#writable-stream-mark-close-request-in-flight">#writable-stream-mark-close-request-in-flight</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-mark-close-request-in-flight">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-mark-first-write-request-in-flight">
   <b><a href="#writable-stream-mark-first-write-request-in-flight">#writable-stream-mark-first-write-request-in-flight</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-mark-first-write-request-in-flight">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-reject-close-and-closed-promise-if-needed">
   <b><a href="#writable-stream-reject-close-and-closed-promise-if-needed">#writable-stream-reject-close-and-closed-promise-if-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-reject-close-and-closed-promise-if-needed">5.5.2. Interfacing with controllers</a> <a href="#ref-for-writable-stream-reject-close-and-closed-promise-if-needed①">(2)</a> <a href="#ref-for-writable-stream-reject-close-and-closed-promise-if-needed②">(3)</a> <a href="#ref-for-writable-stream-reject-close-and-closed-promise-if-needed③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-start-erroring">
   <b><a href="#writable-stream-start-erroring">#writable-stream-start-erroring</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-start-erroring">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-writable-stream-start-erroring①">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writable-stream-start-erroring②">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-update-backpressure">
   <b><a href="#writable-stream-update-backpressure">#writable-stream-update-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-update-backpressure">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-update-backpressure①">(2)</a> <a href="#ref-for-writable-stream-update-backpressure②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-abort">
   <b><a href="#writable-stream-default-writer-abort">#writable-stream-default-writer-abort</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-abort">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-close">
   <b><a href="#writable-stream-default-writer-close">#writable-stream-default-writer-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-close">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-default-writer-close①">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-close-with-error-propagation">
   <b><a href="#writable-stream-default-writer-close-with-error-propagation">#writable-stream-default-writer-close-with-error-propagation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-close-with-error-propagation">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-ensure-closed-promise-rejected">
   <b><a href="#writable-stream-default-writer-ensure-closed-promise-rejected">#writable-stream-default-writer-ensure-closed-promise-rejected</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-ensure-closed-promise-rejected">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-ensure-ready-promise-rejected">
   <b><a href="#writable-stream-default-writer-ensure-ready-promise-rejected">#writable-stream-default-writer-ensure-ready-promise-rejected</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-ensure-ready-promise-rejected">5.5.2. Interfacing with controllers</a>
    <li><a href="#ref-for-writable-stream-default-writer-ensure-ready-promise-rejected①">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-get-desired-size">
   <b><a href="#writable-stream-default-writer-get-desired-size">#writable-stream-default-writer-get-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-get-desired-size">4.9.1. Working with readable streams</a> <a href="#ref-for-writable-stream-default-writer-get-desired-size①">(2)</a>
    <li><a href="#ref-for-writable-stream-default-writer-get-desired-size②">5.3.3. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-release">
   <b><a href="#writable-stream-default-writer-release">#writable-stream-default-writer-release</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-release">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-writable-stream-default-writer-release①">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-default-writer-release②">9.2.2. Writing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-writer-write">
   <b><a href="#writable-stream-default-writer-write">#writable-stream-default-writer-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-writer-write">5.3.3. Constructor, methods, and properties</a>
    <li><a href="#ref-for-writable-stream-default-writer-write①">9.2.2. Writing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-writable-stream-default-controller">
   <b><a href="#set-up-writable-stream-default-controller">#set-up-writable-stream-default-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-writable-stream-default-controller">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-set-up-writable-stream-default-controller①">5.5.4. Default controllers</a>
    <li><a href="#ref-for-set-up-writable-stream-default-controller②">8.2. Transferable streams</a>
    <li><a href="#ref-for-set-up-writable-stream-default-controller③">9.2.1. Creation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-writable-stream-default-controller-from-underlying-sink">
   <b><a href="#set-up-writable-stream-default-controller-from-underlying-sink">#set-up-writable-stream-default-controller-from-underlying-sink</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-writable-stream-default-controller-from-underlying-sink">5.2.4. Constructor, methods, and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-advance-queue-if-needed">
   <b><a href="#writable-stream-default-controller-advance-queue-if-needed">#writable-stream-default-controller-advance-queue-if-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-advance-queue-if-needed">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-default-controller-advance-queue-if-needed①">(2)</a> <a href="#ref-for-writable-stream-default-controller-advance-queue-if-needed②">(3)</a> <a href="#ref-for-writable-stream-default-controller-advance-queue-if-needed③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-clear-algorithms">
   <b><a href="#writable-stream-default-controller-clear-algorithms">#writable-stream-default-controller-clear-algorithms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-clear-algorithms">5.4.4. Internal methods</a>
    <li><a href="#ref-for-writable-stream-default-controller-clear-algorithms①">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-default-controller-clear-algorithms②">(2)</a> <a href="#ref-for-writable-stream-default-controller-clear-algorithms③">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-close">
   <b><a href="#writable-stream-default-controller-close">#writable-stream-default-controller-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-close">5.5.1. Working with writable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-error">
   <b><a href="#writable-stream-default-controller-error">#writable-stream-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-error">5.4.3. Methods</a>
    <li><a href="#ref-for-writable-stream-default-controller-error①">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-error-if-needed">
   <b><a href="#writable-stream-default-controller-error-if-needed">#writable-stream-default-controller-error-if-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-error-if-needed">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-default-controller-error-if-needed①">(2)</a>
    <li><a href="#ref-for-writable-stream-default-controller-error-if-needed②">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-writable-stream-default-controller-error-if-needed③">8.2. Transferable streams</a> <a href="#ref-for-writable-stream-default-controller-error-if-needed④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-get-backpressure">
   <b><a href="#writable-stream-default-controller-get-backpressure">#writable-stream-default-controller-get-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-get-backpressure">5.5.4. Default controllers</a> <a href="#ref-for-writable-stream-default-controller-get-backpressure①">(2)</a> <a href="#ref-for-writable-stream-default-controller-get-backpressure②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-get-chunk-size">
   <b><a href="#writable-stream-default-controller-get-chunk-size">#writable-stream-default-controller-get-chunk-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-get-chunk-size">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-get-desired-size">
   <b><a href="#writable-stream-default-controller-get-desired-size">#writable-stream-default-controller-get-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-get-desired-size">5.5.3. Writers</a>
    <li><a href="#ref-for-writable-stream-default-controller-get-desired-size①">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-process-close">
   <b><a href="#writable-stream-default-controller-process-close">#writable-stream-default-controller-process-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-process-close">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-process-write">
   <b><a href="#writable-stream-default-controller-process-write">#writable-stream-default-controller-process-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-process-write">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writable-stream-default-controller-write">
   <b><a href="#writable-stream-default-controller-write">#writable-stream-default-controller-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writable-stream-default-controller-write">5.5.3. Writers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream">
   <b><a href="#transformstream">#transformstream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream">2.3. Transform streams</a> <a href="#ref-for-transformstream①">(2)</a>
    <li><a href="#ref-for-transformstream②">4.9.4. Default controllers</a>
    <li><a href="#ref-for-transformstream③">6.2. The TransformStream class</a> <a href="#ref-for-transformstream④">(2)</a>
    <li><a href="#ref-for-transformstream⑤">6.2.1. Interface definition</a>
    <li><a href="#ref-for-transformstream⑥">6.2.2. Internal slots</a>
    <li><a href="#ref-for-transformstream⑦">6.2.3. The transformer API</a>
    <li><a href="#ref-for-transformstream⑧">6.2.4. Constructor and properties</a> <a href="#ref-for-transformstream⑨">(2)</a>
    <li><a href="#ref-for-transformstream①⓪">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream①①">(2)</a> <a href="#ref-for-transformstream①②">(3)</a>
    <li><a href="#ref-for-transformstream①③">6.3. The TransformStreamDefaultController class</a>
    <li><a href="#ref-for-transformstream①④">6.3.2. Internal slots</a>
    <li><a href="#ref-for-transformstream①⑤">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-transformstream①⑥">6.4.2. Default controllers</a> <a href="#ref-for-transformstream①⑦">(2)</a>
    <li><a href="#ref-for-transformstream①⑧">9.3.1. Creation and manipulation</a> <a href="#ref-for-transformstream①⑨">(2)</a> <a href="#ref-for-transformstream②⓪">(3)</a> <a href="#ref-for-transformstream②①">(4)</a> <a href="#ref-for-transformstream②②">(5)</a> <a href="#ref-for-transformstream②③">(6)</a> <a href="#ref-for-transformstream②④">(7)</a> <a href="#ref-for-transformstream②⑤">(8)</a> <a href="#ref-for-transformstream②⑥">(9)</a> <a href="#ref-for-transformstream②⑦">(10)</a>
    <li><a href="#ref-for-transformstream②⑧">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-transformstream②⑨">(2)</a> <a href="#ref-for-transformstream③⓪">(3)</a> <a href="#ref-for-transformstream③①">(4)</a> <a href="#ref-for-transformstream③②">(5)</a>
    <li><a href="#ref-for-transformstream③③">9.5. Piping</a>
    <li><a href="#ref-for-transformstream③④">10. Examples of creating streams</a>
    <li><a href="#ref-for-transformstream③⑤">10.9. A transform stream that replaces template tags</a>
    <li><a href="#ref-for-transformstream③⑥">10.10. A transform stream created from a sync mapper function</a> <a href="#ref-for-transformstream③⑦">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-backpressure">
   <b><a href="#transformstream-backpressure">#transformstream-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-backpressure">6.2.2. Internal slots</a>
    <li><a href="#ref-for-transformstream-backpressure①">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream-backpressure②">(2)</a>
    <li><a href="#ref-for-transformstream-backpressure③">6.4.1. Working with transform streams</a> <a href="#ref-for-transformstream-backpressure④">(2)</a> <a href="#ref-for-transformstream-backpressure⑤">(3)</a> <a href="#ref-for-transformstream-backpressure⑥">(4)</a> <a href="#ref-for-transformstream-backpressure⑦">(5)</a> <a href="#ref-for-transformstream-backpressure⑧">(6)</a>
    <li><a href="#ref-for-transformstream-backpressure⑨">6.4.2. Default controllers</a>
    <li><a href="#ref-for-transformstream-backpressure①⓪">6.4.3. Default sinks</a>
    <li><a href="#ref-for-transformstream-backpressure①①">6.4.4. Default sources</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-backpressurechangepromise">
   <b><a href="#transformstream-backpressurechangepromise">#transformstream-backpressurechangepromise</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-backpressurechangepromise">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream-backpressurechangepromise①">(2)</a>
    <li><a href="#ref-for-transformstream-backpressurechangepromise②">6.4.1. Working with transform streams</a> <a href="#ref-for-transformstream-backpressurechangepromise③">(2)</a> <a href="#ref-for-transformstream-backpressurechangepromise④">(3)</a> <a href="#ref-for-transformstream-backpressurechangepromise⑤">(4)</a> <a href="#ref-for-transformstream-backpressurechangepromise⑥">(5)</a>
    <li><a href="#ref-for-transformstream-backpressurechangepromise⑦">6.4.3. Default sinks</a>
    <li><a href="#ref-for-transformstream-backpressurechangepromise⑧">6.4.4. Default sources</a> <a href="#ref-for-transformstream-backpressurechangepromise⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-controller">
   <b><a href="#transformstream-controller">#transformstream-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-controller">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-transformstream-controller①">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream-controller②">(2)</a>
    <li><a href="#ref-for-transformstream-controller③">6.4.1. Working with transform streams</a> <a href="#ref-for-transformstream-controller④">(2)</a>
    <li><a href="#ref-for-transformstream-controller⑤">6.4.2. Default controllers</a> <a href="#ref-for-transformstream-controller⑥">(2)</a>
    <li><a href="#ref-for-transformstream-controller⑦">6.4.3. Default sinks</a> <a href="#ref-for-transformstream-controller⑧">(2)</a>
    <li><a href="#ref-for-transformstream-controller⑨">9.3.1. Creation and manipulation</a> <a href="#ref-for-transformstream-controller①⓪">(2)</a> <a href="#ref-for-transformstream-controller①①">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-readable">
   <b><a href="#transformstream-readable">#transformstream-readable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-readable">6.2.2. Internal slots</a> <a href="#ref-for-transformstream-readable①">(2)</a>
    <li><a href="#ref-for-transformstream-readable②">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-transformstream-readable③">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream-readable④">(2)</a>
    <li><a href="#ref-for-transformstream-readable⑤">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transformstream-readable⑥">6.4.1. Working with transform streams</a> <a href="#ref-for-transformstream-readable⑦">(2)</a>
    <li><a href="#ref-for-transformstream-readable⑧">6.4.2. Default controllers</a> <a href="#ref-for-transformstream-readable⑨">(2)</a> <a href="#ref-for-transformstream-readable①⓪">(3)</a>
    <li><a href="#ref-for-transformstream-readable①①">6.4.3. Default sinks</a>
    <li><a href="#ref-for-transformstream-readable①②">9.3.2. Wrapping into a custom class</a>
    <li><a href="#ref-for-transformstream-readable①③">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-writable">
   <b><a href="#transformstream-writable">#transformstream-writable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-writable">6.2.2. Internal slots</a>
    <li><a href="#ref-for-transformstream-writable①">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-transformstream-writable②">6.2.5. Transfer via postMessage()</a> <a href="#ref-for-transformstream-writable③">(2)</a>
    <li><a href="#ref-for-transformstream-writable④">6.4.1. Working with transform streams</a> <a href="#ref-for-transformstream-writable⑤">(2)</a>
    <li><a href="#ref-for-transformstream-writable⑥">6.4.3. Default sinks</a> <a href="#ref-for-transformstream-writable⑦">(2)</a>
    <li><a href="#ref-for-transformstream-writable⑧">9.3.2. Wrapping into a custom class</a>
    <li><a href="#ref-for-transformstream-writable⑨">9.5. Piping</a> <a href="#ref-for-transformstream-writable①⓪">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-transformer">
   <b><a href="#dictdef-transformer">#dictdef-transformer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-transformer">6.2.4. Constructor and properties</a> <a href="#ref-for-dictdef-transformer①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-transformerstartcallback">
   <b><a href="#callbackdef-transformerstartcallback">#callbackdef-transformerstartcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-transformerstartcallback">6.2.3. The transformer API</a> <a href="#ref-for-callbackdef-transformerstartcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-transformerflushcallback">
   <b><a href="#callbackdef-transformerflushcallback">#callbackdef-transformerflushcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-transformerflushcallback">6.2.3. The transformer API</a> <a href="#ref-for-callbackdef-transformerflushcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-transformertransformcallback">
   <b><a href="#callbackdef-transformertransformcallback">#callbackdef-transformertransformcallback</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-transformertransformcallback">6.2.3. The transformer API</a> <a href="#ref-for-callbackdef-transformertransformcallback①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-transformer-start">
   <b><a href="#dom-transformer-start">#dom-transformer-start</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-transformer-start">6.2.3. The transformer API</a> <a href="#ref-for-dom-transformer-start①">(2)</a> <a href="#ref-for-dom-transformer-start②">(3)</a>
    <li><a href="#ref-for-dom-transformer-start③">6.2.4. Constructor and properties</a> <a href="#ref-for-dom-transformer-start④">(2)</a>
    <li><a href="#ref-for-dom-transformer-start⑤">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-transformer-transform">
   <b><a href="#dom-transformer-transform">#dom-transformer-transform</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-transformer-transform">2.3. Transform streams</a>
    <li><a href="#ref-for-dom-transformer-transform①">6.2.3. The transformer API</a> <a href="#ref-for-dom-transformer-transform②">(2)</a> <a href="#ref-for-dom-transformer-transform③">(3)</a> <a href="#ref-for-dom-transformer-transform④">(4)</a>
    <li><a href="#ref-for-dom-transformer-transform⑤">6.4.2. Default controllers</a> <a href="#ref-for-dom-transformer-transform⑥">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-transformer-flush">
   <b><a href="#dom-transformer-flush">#dom-transformer-flush</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-transformer-flush">6.2.3. The transformer API</a> <a href="#ref-for-dom-transformer-flush①">(2)</a> <a href="#ref-for-dom-transformer-flush②">(3)</a> <a href="#ref-for-dom-transformer-flush③">(4)</a>
    <li><a href="#ref-for-dom-transformer-flush④">6.4.2. Default controllers</a> <a href="#ref-for-dom-transformer-flush⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-transformer-readabletype">
   <b><a href="#dom-transformer-readabletype">#dom-transformer-readabletype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-transformer-readabletype">6.2.3. The transformer API</a>
    <li><a href="#ref-for-dom-transformer-readabletype①">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-transformer-writabletype">
   <b><a href="#dom-transformer-writabletype">#dom-transformer-writabletype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-transformer-writabletype">6.2.3. The transformer API</a>
    <li><a href="#ref-for-dom-transformer-writabletype①">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-constructor">
   <b><a href="#ts-constructor">#ts-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-constructor">2.3. Transform streams</a>
    <li><a href="#ref-for-ts-constructor①">6.2.1. Interface definition</a>
    <li><a href="#ref-for-ts-constructor②">6.2.3. The transformer API</a> <a href="#ref-for-ts-constructor③">(2)</a>
    <li><a href="#ref-for-ts-constructor④">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-ts-constructor⑤">7.1. The queuing strategy API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-readable">
   <b><a href="#ts-readable">#ts-readable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-readable">6.1. Using transform streams</a>
    <li><a href="#ref-for-ts-readable①">6.2.1. Interface definition</a>
    <li><a href="#ref-for-ts-readable②">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-writable">
   <b><a href="#ts-writable">#ts-writable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-writable">6.1. Using transform streams</a>
    <li><a href="#ref-for-ts-writable①">6.2.1. Interface definition</a>
    <li><a href="#ref-for-ts-writable②">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstreamdefaultcontroller">
   <b><a href="#transformstreamdefaultcontroller">#transformstreamdefaultcontroller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstreamdefaultcontroller">6.2.2. Internal slots</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller①">6.2.3. The transformer API</a> <a href="#ref-for-transformstreamdefaultcontroller②">(2)</a> <a href="#ref-for-transformstreamdefaultcontroller③">(3)</a> <a href="#ref-for-transformstreamdefaultcontroller④">(4)</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller⑤">6.3. The TransformStreamDefaultController class</a> <a href="#ref-for-transformstreamdefaultcontroller⑥">(2)</a> <a href="#ref-for-transformstreamdefaultcontroller⑦">(3)</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller⑧">6.3.1. Interface definition</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller⑨">6.3.2. Internal slots</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller①⓪">6.4.2. Default controllers</a> <a href="#ref-for-transformstreamdefaultcontroller①①">(2)</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller①②">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstreamdefaultcontroller-flushalgorithm">
   <b><a href="#transformstreamdefaultcontroller-flushalgorithm">#transformstreamdefaultcontroller-flushalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstreamdefaultcontroller-flushalgorithm">6.4.2. Default controllers</a> <a href="#ref-for-transformstreamdefaultcontroller-flushalgorithm①">(2)</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller-flushalgorithm②">6.4.3. Default sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstreamdefaultcontroller-stream">
   <b><a href="#transformstreamdefaultcontroller-stream">#transformstreamdefaultcontroller-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstreamdefaultcontroller-stream">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transformstreamdefaultcontroller-stream①">6.4.2. Default controllers</a> <a href="#ref-for-transformstreamdefaultcontroller-stream②">(2)</a> <a href="#ref-for-transformstreamdefaultcontroller-stream③">(3)</a> <a href="#ref-for-transformstreamdefaultcontroller-stream④">(4)</a> <a href="#ref-for-transformstreamdefaultcontroller-stream⑤">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstreamdefaultcontroller-transformalgorithm">
   <b><a href="#transformstreamdefaultcontroller-transformalgorithm">#transformstreamdefaultcontroller-transformalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstreamdefaultcontroller-transformalgorithm">6.4.2. Default controllers</a> <a href="#ref-for-transformstreamdefaultcontroller-transformalgorithm①">(2)</a> <a href="#ref-for-transformstreamdefaultcontroller-transformalgorithm②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-default-controller-desired-size">
   <b><a href="#ts-default-controller-desired-size">#ts-default-controller-desired-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-default-controller-desired-size">6.3.1. Interface definition</a>
    <li><a href="#ref-for-ts-default-controller-desired-size①">6.3.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-default-controller-enqueue">
   <b><a href="#ts-default-controller-enqueue">#ts-default-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-default-controller-enqueue">6.2.3. The transformer API</a> <a href="#ref-for-ts-default-controller-enqueue①">(2)</a> <a href="#ref-for-ts-default-controller-enqueue②">(3)</a>
    <li><a href="#ref-for-ts-default-controller-enqueue③">6.3.1. Interface definition</a>
    <li><a href="#ref-for-ts-default-controller-enqueue④">6.3.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-default-controller-error">
   <b><a href="#ts-default-controller-error">#ts-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-default-controller-error">6.3.1. Interface definition</a>
    <li><a href="#ref-for-ts-default-controller-error①">6.3.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ts-default-controller-terminate">
   <b><a href="#ts-default-controller-terminate">#ts-default-controller-terminate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ts-default-controller-terminate">6.2.3. The transformer API</a>
    <li><a href="#ref-for-ts-default-controller-terminate①">6.3.1. Interface definition</a>
    <li><a href="#ref-for-ts-default-controller-terminate②">6.3.3. Methods and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="initialize-transform-stream">
   <b><a href="#initialize-transform-stream">#initialize-transform-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-initialize-transform-stream">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-initialize-transform-stream①">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-error">
   <b><a href="#transform-stream-error">#transform-stream-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-error">6.4.2. Default controllers</a> <a href="#ref-for-transform-stream-error①">(2)</a>
    <li><a href="#ref-for-transform-stream-error②">6.4.3. Default sinks</a> <a href="#ref-for-transform-stream-error③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-error-writable-and-unblock-write">
   <b><a href="#transform-stream-error-writable-and-unblock-write">#transform-stream-error-writable-and-unblock-write</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-error-writable-and-unblock-write">6.4.1. Working with transform streams</a> <a href="#ref-for-transform-stream-error-writable-and-unblock-write①">(2)</a>
    <li><a href="#ref-for-transform-stream-error-writable-and-unblock-write②">6.4.2. Default controllers</a> <a href="#ref-for-transform-stream-error-writable-and-unblock-write③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-set-backpressure">
   <b><a href="#transform-stream-set-backpressure">#transform-stream-set-backpressure</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-set-backpressure">6.4.1. Working with transform streams</a> <a href="#ref-for-transform-stream-set-backpressure①">(2)</a> <a href="#ref-for-transform-stream-set-backpressure②">(3)</a> <a href="#ref-for-transform-stream-set-backpressure③">(4)</a>
    <li><a href="#ref-for-transform-stream-set-backpressure④">6.4.2. Default controllers</a>
    <li><a href="#ref-for-transform-stream-set-backpressure⑤">6.4.4. Default sources</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-transform-stream-default-controller">
   <b><a href="#set-up-transform-stream-default-controller">#set-up-transform-stream-default-controller</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-transform-stream-default-controller">6.4.2. Default controllers</a>
    <li><a href="#ref-for-set-up-transform-stream-default-controller①">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="set-up-transform-stream-default-controller-from-transformer">
   <b><a href="#set-up-transform-stream-default-controller-from-transformer">#set-up-transform-stream-default-controller-from-transformer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-set-up-transform-stream-default-controller-from-transformer">6.2.4. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-controller-clear-algorithms">
   <b><a href="#transform-stream-default-controller-clear-algorithms">#transform-stream-default-controller-clear-algorithms</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-controller-clear-algorithms">6.4.1. Working with transform streams</a>
    <li><a href="#ref-for-transform-stream-default-controller-clear-algorithms①">6.4.3. Default sinks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-controller-enqueue">
   <b><a href="#transform-stream-default-controller-enqueue">#transform-stream-default-controller-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-controller-enqueue">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transform-stream-default-controller-enqueue①">6.4.2. Default controllers</a>
    <li><a href="#ref-for-transform-stream-default-controller-enqueue②">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-controller-error">
   <b><a href="#transform-stream-default-controller-error">#transform-stream-default-controller-error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-controller-error">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transform-stream-default-controller-error①">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-controller-perform-transform">
   <b><a href="#transform-stream-default-controller-perform-transform">#transform-stream-default-controller-perform-transform</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-controller-perform-transform">6.4.3. Default sinks</a> <a href="#ref-for-transform-stream-default-controller-perform-transform①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-controller-terminate">
   <b><a href="#transform-stream-default-controller-terminate">#transform-stream-default-controller-terminate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-controller-terminate">6.3.3. Methods and properties</a>
    <li><a href="#ref-for-transform-stream-default-controller-terminate①">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-sink-write-algorithm">
   <b><a href="#transform-stream-default-sink-write-algorithm">#transform-stream-default-sink-write-algorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-sink-write-algorithm">6.4.1. Working with transform streams</a> <a href="#ref-for-transform-stream-default-sink-write-algorithm①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-sink-abort-algorithm">
   <b><a href="#transform-stream-default-sink-abort-algorithm">#transform-stream-default-sink-abort-algorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-sink-abort-algorithm">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-sink-close-algorithm">
   <b><a href="#transform-stream-default-sink-close-algorithm">#transform-stream-default-sink-close-algorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-sink-close-algorithm">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transform-stream-default-source-pull">
   <b><a href="#transform-stream-default-source-pull">#transform-stream-default-source-pull</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transform-stream-default-source-pull">6.4.1. Working with transform streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-queuingstrategy">
   <b><a href="#dictdef-queuingstrategy">#dictdef-queuingstrategy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-queuingstrategy">4.2.1. Interface definition</a>
    <li><a href="#ref-for-dictdef-queuingstrategy①">5.2.1. Interface definition</a>
    <li><a href="#ref-for-dictdef-queuingstrategy②">6.2.1. Interface definition</a> <a href="#ref-for-dictdef-queuingstrategy③">(2)</a>
    <li><a href="#ref-for-dictdef-queuingstrategy④">7.4. Abstract operations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="callbackdef-queuingstrategysize">
   <b><a href="#callbackdef-queuingstrategysize">#callbackdef-queuingstrategysize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-callbackdef-queuingstrategysize">7.1. The queuing strategy API</a> <a href="#ref-for-callbackdef-queuingstrategysize①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-queuingstrategy-highwatermark">
   <b><a href="#dom-queuingstrategy-highwatermark">#dom-queuingstrategy-highwatermark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-queuingstrategy-highwatermark">2.5. Internal queues and queuing strategies</a> <a href="#ref-for-dom-queuingstrategy-highwatermark①">(2)</a> <a href="#ref-for-dom-queuingstrategy-highwatermark②">(3)</a>
    <li><a href="#ref-for-dom-queuingstrategy-highwatermark③">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-dom-queuingstrategy-highwatermark④">7.4. Abstract operations</a> <a href="#ref-for-dom-queuingstrategy-highwatermark⑤">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-queuingstrategy-size">
   <b><a href="#dom-queuingstrategy-size">#dom-queuingstrategy-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-queuingstrategy-size">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-dom-queuingstrategy-size①">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-dom-queuingstrategy-size②">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-dom-queuingstrategy-size③">7.4. Abstract operations</a> <a href="#ref-for-dom-queuingstrategy-size④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-queuingstrategyinit">
   <b><a href="#dictdef-queuingstrategyinit">#dictdef-queuingstrategyinit</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-queuingstrategyinit">7.2.1. Interface definition</a>
    <li><a href="#ref-for-dictdef-queuingstrategyinit①">7.3.1. Interface definition</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-queuingstrategyinit-highwatermark">
   <b><a href="#dom-queuingstrategyinit-highwatermark">#dom-queuingstrategyinit-highwatermark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-queuingstrategyinit-highwatermark">7.2.3. Constructor and properties</a> <a href="#ref-for-dom-queuingstrategyinit-highwatermark①">(2)</a>
    <li><a href="#ref-for-dom-queuingstrategyinit-highwatermark②">7.3.3. Constructor and properties</a> <a href="#ref-for-dom-queuingstrategyinit-highwatermark③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="bytelengthqueuingstrategy">
   <b><a href="#bytelengthqueuingstrategy">#bytelengthqueuingstrategy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bytelengthqueuingstrategy">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-bytelengthqueuingstrategy①">7.2. The ByteLengthQueuingStrategy class</a> <a href="#ref-for-bytelengthqueuingstrategy②">(2)</a> <a href="#ref-for-bytelengthqueuingstrategy③">(3)</a>
    <li><a href="#ref-for-bytelengthqueuingstrategy④">7.2.1. Interface definition</a>
    <li><a href="#ref-for-bytelengthqueuingstrategy⑤">7.2.2. Internal slots</a>
    <li><a href="#ref-for-bytelengthqueuingstrategy⑥">7.2.3. Constructor and properties</a> <a href="#ref-for-bytelengthqueuingstrategy⑦">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="bytelengthqueuingstrategy-highwatermark">
   <b><a href="#bytelengthqueuingstrategy-highwatermark">#bytelengthqueuingstrategy-highwatermark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-bytelengthqueuingstrategy-highwatermark">7.2.3. Constructor and properties</a> <a href="#ref-for-bytelengthqueuingstrategy-highwatermark①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="byte-length-queuing-strategy-size-function">
   <b><a href="#byte-length-queuing-strategy-size-function">#byte-length-queuing-strategy-size-function</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-byte-length-queuing-strategy-size-function">7.2.2. Internal slots</a>
    <li><a href="#ref-for-byte-length-queuing-strategy-size-function①">7.2.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="blqs-constructor">
   <b><a href="#blqs-constructor">#blqs-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-blqs-constructor">7.2.1. Interface definition</a>
    <li><a href="#ref-for-blqs-constructor①">7.2.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="blqs-high-water-mark">
   <b><a href="#blqs-high-water-mark">#blqs-high-water-mark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-blqs-high-water-mark">7.2.1. Interface definition</a>
    <li><a href="#ref-for-blqs-high-water-mark①">7.2.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="blqs-size">
   <b><a href="#blqs-size">#blqs-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-blqs-size">7.2.1. Interface definition</a>
    <li><a href="#ref-for-blqs-size①">7.2.2. Internal slots</a>
    <li><a href="#ref-for-blqs-size②">7.2.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="countqueuingstrategy">
   <b><a href="#countqueuingstrategy">#countqueuingstrategy</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-countqueuingstrategy">2.5. Internal queues and queuing strategies</a>
    <li><a href="#ref-for-countqueuingstrategy①">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-countqueuingstrategy②">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-countqueuingstrategy③">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-countqueuingstrategy④">7.1. The queuing strategy API</a>
    <li><a href="#ref-for-countqueuingstrategy⑤">7.3. The CountQueuingStrategy class</a>
    <li><a href="#ref-for-countqueuingstrategy⑥">7.3.1. Interface definition</a>
    <li><a href="#ref-for-countqueuingstrategy⑦">7.3.2. Internal slots</a>
    <li><a href="#ref-for-countqueuingstrategy⑧">7.3.3. Constructor and properties</a> <a href="#ref-for-countqueuingstrategy⑨">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="countqueuingstrategy-highwatermark">
   <b><a href="#countqueuingstrategy-highwatermark">#countqueuingstrategy-highwatermark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-countqueuingstrategy-highwatermark">7.3.3. Constructor and properties</a> <a href="#ref-for-countqueuingstrategy-highwatermark①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="count-queuing-strategy-size-function">
   <b><a href="#count-queuing-strategy-size-function">#count-queuing-strategy-size-function</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-count-queuing-strategy-size-function">7.3.2. Internal slots</a>
    <li><a href="#ref-for-count-queuing-strategy-size-function①">7.3.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cqs-constructor">
   <b><a href="#cqs-constructor">#cqs-constructor</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cqs-constructor">7.3.1. Interface definition</a>
    <li><a href="#ref-for-cqs-constructor①">7.3.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cqs-high-water-mark">
   <b><a href="#cqs-high-water-mark">#cqs-high-water-mark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cqs-high-water-mark">7.3.1. Interface definition</a>
    <li><a href="#ref-for-cqs-high-water-mark①">7.3.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cqs-size">
   <b><a href="#cqs-size">#cqs-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cqs-size">7.3.1. Interface definition</a>
    <li><a href="#ref-for-cqs-size①">7.3.2. Internal slots</a>
    <li><a href="#ref-for-cqs-size②">7.3.3. Constructor and properties</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="validate-and-normalize-high-water-mark">
   <b><a href="#validate-and-normalize-high-water-mark">#validate-and-normalize-high-water-mark</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-validate-and-normalize-high-water-mark">4.2.4. Constructor, methods, and properties</a> <a href="#ref-for-validate-and-normalize-high-water-mark①">(2)</a>
    <li><a href="#ref-for-validate-and-normalize-high-water-mark②">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-validate-and-normalize-high-water-mark③">6.2.4. Constructor and properties</a> <a href="#ref-for-validate-and-normalize-high-water-mark④">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="make-size-algorithm-from-size-function">
   <b><a href="#make-size-algorithm-from-size-function">#make-size-algorithm-from-size-function</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-make-size-algorithm-from-size-function">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-make-size-algorithm-from-size-function①">5.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-make-size-algorithm-from-size-function②">6.2.4. Constructor and properties</a> <a href="#ref-for-make-size-algorithm-from-size-function③">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="value-with-size">
   <b><a href="#value-with-size">#value-with-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-with-size">8.1. Queue-with-sizes</a> <a href="#ref-for-value-with-size①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="value-with-size-value">
   <b><a href="#value-with-size-value">#value-with-size-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-with-size-value">8.1. Queue-with-sizes</a> <a href="#ref-for-value-with-size-value①">(2)</a> <a href="#ref-for-value-with-size-value②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="value-with-size-size">
   <b><a href="#value-with-size-size">#value-with-size-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-value-with-size-size">8.1. Queue-with-sizes</a> <a href="#ref-for-value-with-size-size①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dequeue-value">
   <b><a href="#dequeue-value">#dequeue-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dequeue-value">4.6.4. Internal methods</a>
    <li><a href="#ref-for-dequeue-value①">5.5.4. Default controllers</a> <a href="#ref-for-dequeue-value②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enqueue-value-with-size">
   <b><a href="#enqueue-value-with-size">#enqueue-value-with-size</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enqueue-value-with-size">4.9.4. Default controllers</a>
    <li><a href="#ref-for-enqueue-value-with-size①">5.5.4. Default controllers</a> <a href="#ref-for-enqueue-value-with-size②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="peek-queue-value">
   <b><a href="#peek-queue-value">#peek-queue-value</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-peek-queue-value">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="reset-queue">
   <b><a href="#reset-queue">#reset-queue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-reset-queue">4.6.4. Internal methods</a>
    <li><a href="#ref-for-reset-queue①">4.7.4. Internal methods</a>
    <li><a href="#ref-for-reset-queue②">4.9.4. Default controllers</a> <a href="#ref-for-reset-queue③">(2)</a>
    <li><a href="#ref-for-reset-queue④">4.9.5. Byte stream controllers</a> <a href="#ref-for-reset-queue⑤">(2)</a>
    <li><a href="#ref-for-reset-queue⑥">5.4.4. Internal methods</a>
    <li><a href="#ref-for-reset-queue⑦">5.5.4. Default controllers</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-crossrealmtransformsenderror">
   <b><a href="#abstract-opdef-crossrealmtransformsenderror">#abstract-opdef-crossrealmtransformsenderror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-crossrealmtransformsenderror">8.2. Transferable streams</a> <a href="#ref-for-abstract-opdef-crossrealmtransformsenderror①">(2)</a> <a href="#ref-for-abstract-opdef-crossrealmtransformsenderror②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-packandpostmessage">
   <b><a href="#abstract-opdef-packandpostmessage">#abstract-opdef-packandpostmessage</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-packandpostmessage">8.2. Transferable streams</a> <a href="#ref-for-abstract-opdef-packandpostmessage①">(2)</a> <a href="#ref-for-abstract-opdef-packandpostmessage②">(3)</a> <a href="#ref-for-abstract-opdef-packandpostmessage③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-packandpostmessagehandlingerror">
   <b><a href="#abstract-opdef-packandpostmessagehandlingerror">#abstract-opdef-packandpostmessagehandlingerror</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-packandpostmessagehandlingerror">8.2. Transferable streams</a> <a href="#ref-for-abstract-opdef-packandpostmessagehandlingerror①">(2)</a> <a href="#ref-for-abstract-opdef-packandpostmessagehandlingerror②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-setupcrossrealmtransformreadable">
   <b><a href="#abstract-opdef-setupcrossrealmtransformreadable">#abstract-opdef-setupcrossrealmtransformreadable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-setupcrossrealmtransformreadable">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-abstract-opdef-setupcrossrealmtransformreadable①">5.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="abstract-opdef-setupcrossrealmtransformwritable">
   <b><a href="#abstract-opdef-setupcrossrealmtransformwritable">#abstract-opdef-setupcrossrealmtransformwritable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-abstract-opdef-setupcrossrealmtransformwritable">4.2.6. Transfer via postMessage()</a>
    <li><a href="#ref-for-abstract-opdef-setupcrossrealmtransformwritable①">5.2.5. Transfer via postMessage()</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="is-non-negative-number">
   <b><a href="#is-non-negative-number">#is-non-negative-number</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-is-non-negative-number">4.9.1. Working with readable streams</a>
    <li><a href="#ref-for-is-non-negative-number①">5.5.1. Working with writable streams</a>
    <li><a href="#ref-for-is-non-negative-number②">8.1. Queue-with-sizes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transfer-array-buffer">
   <b><a href="#transfer-array-buffer">#transfer-array-buffer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transfer-array-buffer">4.1. Using readable streams</a>
    <li><a href="#ref-for-transfer-array-buffer">4.7.2. Internal slots</a>
    <li><a href="#ref-for-transfer-array-buffer">4.8.3. Methods and properties</a> <a href="#ref-for-transfer-array-buffer">(2)</a>
    <li><a href="#ref-for-transfer-array-buffer">4.9.5. Byte stream controllers</a> <a href="#ref-for-transfer-array-buffer①">(2)</a> <a href="#ref-for-transfer-array-buffer②">(3)</a> <a href="#ref-for-transfer-array-buffer③">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-set-up">
   <b><a href="#readablestream-set-up">#readablestream-set-up</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-set-up">9.1.1. Creation and manipulation</a> <a href="#ref-for-readablestream-set-up①">(2)</a> <a href="#ref-for-readablestream-set-up②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-set-up-cancelalgorithm">
   <b><a href="#readablestream-set-up-cancelalgorithm">#readablestream-set-up-cancelalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-set-up-cancelalgorithm">9.4.1. Duplex streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-get-a-reader">
   <b><a href="#readablestream-get-a-reader">#readablestream-get-a-reader</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-get-a-reader">9.1.3. Introspection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="read-loop">
   <b><a href="#read-loop">#read-loop</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-read-loop">9.1.2. Reading</a> <a href="#ref-for-read-loop①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-tee">
   <b><a href="#readablestream-tee">#readablestream-tee</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-tee">4.9.1. Working with readable streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-readable">
   <b><a href="#readablestream-readable">#readablestream-readable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-readable">9.1.1. Creation and manipulation</a>
    <li><a href="#ref-for-readablestream-readable①">9.1.3. Introspection</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-locked">
   <b><a href="#readablestream-locked">#readablestream-locked</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-locked">9.1.2. Reading</a>
    <li><a href="#ref-for-readablestream-locked①">9.1.3. Introspection</a>
    <li><a href="#ref-for-readablestream-locked②">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="is-readable-stream-disturbed">
   <b><a href="#is-readable-stream-disturbed">#is-readable-stream-disturbed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-is-readable-stream-disturbed">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-set-up">
   <b><a href="#writablestream-set-up">#writablestream-set-up</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-set-up">9.2.1. Creation</a> <a href="#ref-for-writablestream-set-up①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="writablestream-close">
   <b><a href="#writablestream-close">#writablestream-close</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-writablestream-close">9.4.1. Duplex streams</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-set-up">
   <b><a href="#transformstream-set-up">#transformstream-set-up</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-set-up">9.3.1. Creation and manipulation</a> <a href="#ref-for-transformstream-set-up①">(2)</a> <a href="#ref-for-transformstream-set-up②">(3)</a> <a href="#ref-for-transformstream-set-up③">(4)</a>
    <li><a href="#ref-for-transformstream-set-up④">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-set-up-transformalgorithm">
   <b><a href="#transformstream-set-up-transformalgorithm">#transformstream-set-up-transformalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-set-up-transformalgorithm">9.3.1. Creation and manipulation</a> <a href="#ref-for-transformstream-set-up-transformalgorithm①">(2)</a>
    <li><a href="#ref-for-transformstream-set-up-transformalgorithm②">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-set-up-flushalgorithm">
   <b><a href="#transformstream-set-up-flushalgorithm">#transformstream-set-up-flushalgorithm</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-set-up-flushalgorithm">9.3.1. Creation and manipulation</a>
    <li><a href="#ref-for-transformstream-set-up-flushalgorithm①">9.3.2. Wrapping into a custom class</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="create-an-identity-transformstream">
   <b><a href="#create-an-identity-transformstream">#create-an-identity-transformstream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-create-an-identity-transformstream">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="transformstream-enqueue">
   <b><a href="#transformstream-enqueue">#transformstream-enqueue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-transformstream-enqueue">9.3.1. Creation and manipulation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generictransformstream">
   <b><a href="#generictransformstream">#generictransformstream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generictransformstream">2.3. Transform streams</a>
    <li><a href="#ref-for-generictransformstream①">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-generictransformstream②">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="generictransformstream-transform">
   <b><a href="#generictransformstream-transform">#generictransformstream-transform</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-generictransformstream-transform">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-generictransformstream-transform①">(2)</a> <a href="#ref-for-generictransformstream-transform②">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-generictransformstream-readable">
   <b><a href="#dom-generictransformstream-readable">#dom-generictransformstream-readable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-generictransformstream-readable">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-dom-generictransformstream-readable①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-generictransformstream-writable">
   <b><a href="#dom-generictransformstream-writable">#dom-generictransformstream-writable</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-generictransformstream-writable">9.3.2. Wrapping into a custom class</a> <a href="#ref-for-dom-generictransformstream-writable①">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-pipe">
   <b><a href="#readablestream-pipe">#readablestream-pipe</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-pipe">4.2.4. Constructor, methods, and properties</a>
    <li><a href="#ref-for-readablestream-pipe①">6.1. Using transform streams</a>
    <li><a href="#ref-for-readablestream-pipe②">6.2.4. Constructor and properties</a>
    <li><a href="#ref-for-readablestream-pipe③">9.5. Piping</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="readablestream-pipe-through">
   <b><a href="#readablestream-pipe-through">#readablestream-pipe-through</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-readablestream-pipe-through">9.5. Piping</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

document.body.addEventListener("click", function(e) {
    var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
    // Find the dfn element or panel, if any, that was clicked on.
    var el = e.target;
    var target;
    var hitALink = false;
    while(el.parentElement) {
        if(el.tagName == "A") {
            // Clicking on a link in a <dfn> shouldn't summon the panel
            hitALink = true;
        }
        if(el.classList.contains("dfn-paneled")) {
            target = "dfn";
            break;
        }
        if(el.classList.contains("dfn-panel")) {
            target = "dfn-panel";
            break;
        }
        el = el.parentElement;
    }
    if(target != "dfn-panel") {
        // Turn off any currently "on" or "activated" panels.
        queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
            el.classList.remove("on");
            el.classList.remove("activated");
        });
    }
    if(target == "dfn" && !hitALink) {
        // open the panel
        var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
        if(dfnPanel) {
            dfnPanel.classList.add("on");
            var rect = el.getBoundingClientRect();
            dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
            dfnPanel.style.top = window.scrollY + rect.top + "px";
            var panelRect = dfnPanel.getBoundingClientRect();
            var panelWidth = panelRect.right - panelRect.left;
            if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                // Reposition, because the panel is overflowing
                dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
            }
        } else {
            console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
        }
    } else if(target == "dfn-panel") {
        // Switch it to "activated" state, which pins it.
        el.classList.add("activated");
        el.style.left = null;
        el.style.top = null;
    }

});
</script>
<script>/* script-var-click-highlighting */

    "use strict";
    {
        document.addEventListener("click", e=>{
            if(e.target.nodeName == "VAR") {
                highlightSameAlgoVars(e.target);
            }
        });
        const indexCounts = new Map();
        const indexNames = new Map();
        function highlightSameAlgoVars(v) {
            // Find the algorithm container.
            let algoContainer = null;
            let searchEl = v;
            while(algoContainer == null && searchEl != document.body) {
                searchEl = searchEl.parentNode;
                if(searchEl.hasAttribute("data-algorithm")) {
                    algoContainer = searchEl;
                }
            }

            // Not highlighting document-global vars,
            // too likely to be unrelated.
            if(algoContainer == null) return;

            const algoName = algoContainer.getAttribute("data-algorithm");
            const varName = getVarName(v);
            const addClass = !v.classList.contains("selected");
            let highlightClass = null;
            if(addClass) {
                const index = chooseHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] += 1;
                indexNames.set(algoName+"///"+varName, index);
                highlightClass = nameFromIndex(index);
            } else {
                const index = previousHighlightIndex(algoName, varName);
                indexCounts.get(algoName)[index] -= 1;
                highlightClass = nameFromIndex(index);
            }

            // Find all same-name vars, and toggle their class appropriately.
            for(const el of algoContainer.querySelectorAll("var")) {
                if(getVarName(el) == varName) {
                    el.classList.toggle("selected", addClass);
                    el.classList.toggle(highlightClass, addClass);
                }
            }
        }
        function getVarName(el) {
            return el.textContent.replace(/(\s|\xa0)+/, " ").trim();
        }
        function chooseHighlightIndex(algoName, varName) {
            let indexes = null;
            if(indexCounts.has(algoName)) {
                indexes = indexCounts.get(algoName);
            } else {
                // 7 classes right now
                indexes = [0,0,0,0,0,0,0];
                indexCounts.set(algoName, indexes);
            }

            // If the element was recently unclicked,
            // *and* that color is still unclaimed,
            // give it back the same color.
            const lastIndex = previousHighlightIndex(algoName, varName);
            if(indexes[lastIndex] === 0) return lastIndex;

            // Find the earliest index with the lowest count.
            const minCount = Math.min.apply(null, indexes);
            let index = null;
            for(var i = 0; i < indexes.length; i++) {
                if(indexes[i] == minCount) {
                    return i;
                }
            }
        }
        function previousHighlightIndex(algoName, varName) {
            return indexNames.get(algoName+"///"+varName);
        }
        function nameFromIndex(index) {
            return "selected" + index;
        }
    }
    </script>